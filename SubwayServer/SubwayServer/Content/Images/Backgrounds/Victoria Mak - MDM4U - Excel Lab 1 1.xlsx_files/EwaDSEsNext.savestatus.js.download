'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1195:function(n,C,a){n=a(0);var c=a(84),b=a(15),d=a(159),f=a(39);class e{constructor(z){this.aga=this.Vfa=this.ega=this.dga=null;this.G8d=this.Uae=this.hx=this.WL=!1;this.XPc=this.jbe=null;this.bbe=0;this.nb=this.hbe=null;this.t1=z;this.pA=3;this.gjb=!0}initialize(z,A,I){this.dga=this.Sgd(z,A);this.ega=CommonUIStrings.l_SavingStatus;this.Vfa=CommonUIStrings.l_ReadOnlyStatus;this.aga=CommonUIStrings.l_ReviewModeStatus;
this.t1&&this.t1.execute(F=>{F.IVc(Object(c.a)(this,this.zPb,"updateToSavingStatus"))});this.hx=!0;this.nb=I;return!0}Bea(z,A){this.WL=z;this.pA=A;this.qS(this.gjb)}qS(z){!this.gjb&&z&&(this.hbe=new Date);this.gjb=z;z=null;3===this.pA&&(z=this.gjb?this.dga:this.ega);this.ihh(z)}Sgd(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}zPb(){this.qS(!1)}HSh(){switch(this.pA){case 1:return this.Vfa;
case 2:return this.aga;default:return null}}ahi(z){return this.Uae===this.WL&&this.bbe===this.pA&&this.jbe===z}g7c(z){appChrome.getHeaderApi().then(A=>{A.updateDocumentTitleStatus(this.WL,z,this.HSh(),this.hbe,this.gjb);this.G8d=!0;return null});this.XPc=null}ihh(z){this.hx&&d.c()&&!this.ahi(z)&&(!this.G8d&&this.nb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",!1)?this.g7c(z):f.a.dUf()?(this.XPc&&b.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),
this.XPc=window.requestIdleCallback(()=>{this.g7c(z)})):window.requestAnimationFrame(()=>{this.g7c(z)}),this.Uae=this.WL,this.jbe=z,this.bbe=this.pA)}}Object(n.a)(e,"ReactSaveStatusUIHandler",null,[441]);var k=a(164);class l{constructor(z,A){this.ks=null;this.dga=CommonUIStrings.l_SavedStatus;this.ega=CommonUIStrings.l_SavingStatus;this.Vfa=CommonUIStrings.l_ReadOnlyStatus;this.aga=CommonUIStrings.l_ReviewModeStatus;this.ATb=A;this.t1=z;this.pA=3;this.lra=!0}Av(){this.t1&&this.t1.execute(z=>{z.IVc(Object(c.a)(this,
this.zPb,"updateToSavingStatus"))});this.ATb.execute(z=>{this.ks=z})}Bea(z,A){this.pA=A;3===A?this.qS(this.lra):2===A?this.VYd(this.aga):this.VYd(this.Vfa)}zPb(){this.qS(!1)}qS(z){this.lra=z;this.VYd(this.lra?this.dga:this.ega)}VYd(z){this.ks&&this.ks.Mj(k.a.rOj,this.M2g(z))}M2g(z){const A={};A.StatusText=z;return A}}Object(n.a)(l,"SaveStatusPostMessageHandler",null,[441]);var m=a(92),u=a(123),t=a(56);class w{constructor(z,A,I,F){this.aga=this.Vfa=this.ega=this.dga=null;this.oEa=0;this.qE=this.JQc=
this.ECa=this.rFc=this.mFa=null;this.Md=z;this.J8=A;this.t1=I;this.oj=F;this.t$d=!0;this.WL=!1;this.pA=3;this.lra=!0}initialize(z,A){if(!this.Md)return!1;this.dga=this.Sgd(z,A);this.ega=CommonUIStrings.l_SavingStatus;this.Vfa=CommonUIStrings.l_ReadOnlyStatus;this.aga=CommonUIStrings.l_ReviewModeStatus;this.Av();return!0}Sgd(z,A){return z?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):A&&A.length?String.format(CommonUIStrings.l_SavedToStatus,A):CommonUIStrings.l_SavedStatus}Av(){this.J8&&
this.J8.execute(z=>{z.LHg(Object(c.a)(this,this.lGe,"createStatusAndModeElements"));z.CHg(Object(c.a)(this,this.tAj,"showHideSaveStatusElement"));z.hLj&&this.lGe(null,null)});this.t1&&this.t1.execute(z=>{z.IVc(Object(c.a)(this,this.zPb,"updateToSavingStatus"))})}Iv(){this.qE&&this.Md&&this.Md.yG(this.qE)}tAj(z,A){this.Bea("true"===A,this.pA)}Bea(z,A){this.WL=z;this.pA=A;this.rFc&&(this.rFc.style.display=this.WL||3===this.pA||!this.mFa?"none":"");this.ECa&&(this.ECa.style.display=this.WL||3===this.pA?
"none":"",this.ECa.innerText=1===this.pA?this.Vfa:this.aga,this.ECa.title=1===this.pA?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.JQc&&(this.JQc.style.display=this.WL||1===this.pA||!this.mFa&&!this.ECa?"none":"");this.qE&&(this.qE.style.display=this.WL||1===this.pA?"none":"",this.qS(this.lra),this.qE.title=CommonUIStrings.l_SaveStatusTooltip)}lGe(z,A){z=document.getElementById(m.CuiHelper.M8e);A&&A.BXj||!z||""===this.dga||""===this.ega||""===this.Vfa||""===
this.aga||(this.mFa=document.getElementById(m.CuiHelper.k1b),this.rFc=m.CuiHelper.pta(z,"BreadcrumbAppModeDash","-",null,!1),this.ECa=m.CuiHelper.pta(z,"BreadcrumbAppModeStatus",1===this.pA?this.Vfa:this.aga,null,!1),this.meg(this.ECa),this.JQc=m.CuiHelper.pta(z,"BreadcrumbSaveStatusDash","-",null,!1),this.qE=m.CuiHelper.pta(z,"BreadcrumbSaveStatus",this.dga,null,!1),this.meg(this.qE),this.Bea(this.WL,this.pA))}zPb(){this.qS(!1)}qS(z){this.lra=z;this.tTj(this.lra?this.dga:this.ega)}tTj(z){!this.qE||
3!==this.pA&&2!==this.pA||(this.t$d&&!this.lra?(this.oEa=this.qE.offsetWidth<this.oEa?this.oEa:this.qE.offsetWidth,this.rQj(this.ega),this.t$d=!1):this.qE.innerText=z)}meg(z){z.style.direction=this.oj?"rtl":"ltr";z.style.width="auto";z.style.textAlign=this.oj?"right":"left";z.style.display=this.WL?"none":"";z.setAttribute("Unselectable","on")}rQj(z){this.qE&&(this.qE.style.width="",this.qE.innerText=z,this.oEa=this.qE.offsetWidth<this.oEa?this.oEa:this.qE.offsetWidth,z=u.a.jB(this.qE),this.qE.style.width=
this.oEa-t.a.BD(z.paddingLeft)-t.a.BD(z.paddingRight)+1+"px")}}Object(n.a)(w,"SaveStatusUIHandler",null,[441]);var r=a(4),v=a(91);class y{constructor(){this.KQc=this.LPc=this.xlb=this.gb=null}get name(){return"Common.App.SaveStatus"}Wh(z){this.gb=z;r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.gb.register(l,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").wc().Fc(()=>new l(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),
this.gb.Ub("Postmessage.IHostPostmessenger"))):r.AFrameworkApplication.ta.Oa.Iif||(r.AFrameworkApplication.ta.Oa.ps?this.gb.register(e,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").wc().Fc(()=>new e(this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"))):this.gb.register(w,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").wc().Fc(()=>new w(v.EventHandlerManager.instance,this.gb.Ub("Common.App.Header.HeaderEventSource"),
this.gb.Ub("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)))}init(){r.AFrameworkApplication.fa.qv(Object(c.a)(this,this.zB,"onFullAppSettingsReady"))}zB(){const z=r.AFrameworkApplication.fa,A=!!r.AFrameworkApplication.ta.Oa&&4===r.AFrameworkApplication.ta.Oa.Dj;if(z.qa("WordEditorAutoSaveImprovementIsEnabled")||z.qa("PptEditorSaveStatusInHeaderEnabled")||A&&z.qa("SimplifiedReactRibbonUxIsEnabled")||z.qa("ExcelSaveStatusInHeaderEnabled")||z.qa("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.fa.qa("PostMessageEmbedded")&&
r.AFrameworkApplication.hideHeaderEmbedded?(this.KQc=this.gb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.KQc.Av():r.AFrameworkApplication.ta.Oa.Iif||(r.AFrameworkApplication.ta.Oa.ps?(this.LPc=this.gb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.LPc.initialize(z.qa("IsSkyDrive"),z.Xa("HostNameToIncludeInSavedStatus"),r.AFrameworkApplication.fa):(this.xlb=this.gb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.xlb.initialize(z.qa("IsSkyDrive"),
z.Xa("HostNameToIncludeInSavedStatus")))}dispose(){this.xlb&&this.xlb.Iv()}}Object(n.a)(y,"PackageManager",null,[3,4]);var x=a(247);a.d(C,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.SaveStatus");x.a.instance.Gi(new y)}},1250:function(n,C,a){var c=a(9);n=a(0);var b=a(83),d=a(222),f=a(225),e=a(29),k=a(21);class l{constructor(w,r){this.Xge=this.aLc=!1;this.eza=(v,y)=>{(null===y||void 0===y?0:y.oH)&&e.a.EMg([y.oH])&&(this.qKb=!0)};this.Lo=()=>{this.qKb=!1};this.Wc=(v,y)=>
{f.b(y)&&this.Bea(!0);this.qKb=!1};this.dd=()=>{this.hN=this.$.hN;this.Bea()};this.tDf=()=>{this.qS()};this.wCf=()=>{this.hN=this.$.hN};this.xAd=()=>{k.g(this.$).Ea.Rw(this.xAd);this.hN=this.$.hN};this.hXf=r;this.$=w;this.$.userOperationManager.nr(this.wCf);this.$.kl(this.dd);this.$.ea.lIg(this.tDf);this.$.ea.rk(this.Wc);this.$.YZb(this.eza);this.$.ea.jM(this.Lo);this.Bea()}get Zqi(){return this.$.ea?this.$.ea.mlf:!1}get hN(){return this.aLc}set hN(w){w?this.aLc=!0:k.g(this.$)&&k.g(this.$).Ea&&(k.g(this.$).Ea.K4()?
this.aLc=!1:k.g(this.$).Ea.Wv(this.xAd));this.qS()}get qKb(){return this.Xge}set qKb(w){this.Xge=w;this.qS()}dispose(){this.$&&(this.$.Hl(this.dd),this.$.utc(this.eza),this.$.userOperationManager&&this.$.userOperationManager.ho(this.wCf),this.$.ea&&(this.$.ea.Zcj(this.tDf),this.$.ea.Pk(this.Wc),this.$.ea.GR(this.Lo)),k.g(this.$)&&k.g(this.$).Ea&&k.g(this.$).Ea.Rw(this.xAd))}Bea(w=!1){w=!this.$.isEditMode||w;this.hXf.Bea(w,this.$.isEditMode?3:1);this.qS()}qS(){this.$.isEditMode&&this.hXf.qS(!this.hN&&
!this.Zqi&&!this.qKb)}}Object(n.a)(l,"SaveStatusManager",null,[10]);var m=a(699);class u extends d.a{constructor(w){super();this.Jc=w;this.Eb()}create(){const w=b.a.instance;w.Ub("Common.App.SaveStatus.ISaveStatusUIHandler").execute(r=>{const v=new l(this.Jc,r);w.register(l,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").wc().Fc(()=>v);r=Object(m.b)(this.Jc.da,300,()=>w.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"));this.pb(r)})}static ka(w){w.da.Ga(299,
new u(w))}}Object(n.a)(u,"SaveStatusFactory",d.a,[]);a.d(C,"a",function(){return t});const t=()=>{c.a.Fa(u.ka)}},1393:function(n,C,a){a.r(C);n=a(1195);a=a(1250);Type.registerNamespace("_Ewa");Object(n.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.savestatus.js.map/23e540b429ec9a51513e946ee119dc80/EwaDSEsNext.savestatus.js.map