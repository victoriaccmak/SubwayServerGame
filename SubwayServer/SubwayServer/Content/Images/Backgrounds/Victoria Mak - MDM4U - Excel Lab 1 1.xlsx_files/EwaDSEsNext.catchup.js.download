'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1256:function(n,C,a){n=a(0);var c=a(15),b=a(80),d=a(819),f=a(82),e=a(187),k=a(8),l=a(211),m=a(65),u=a(43),t=a(515),w=a(171),r=a(109),v=a(282),y=a(1),x=a(11),B=a(100),z=a(14),A=a(281);a(97);var I=a(21),F=a(341);class U{constructor(H,R,Q){this.LFa=H;this.Jk=R;this.aDc=Q}}Object(n.a)(U,"UserActivityLocation",null,[]);var X=a(984),T=a(61);const G=(H,R,Q,O,V,W=null)=>{W=H.Na(1,W);return T.g(H,"GetVersionHistoryHighlightActivitiesData",
W,R,Q,O,V,4)};var D=a(761),J=a(55);a.d(C,"a",function(){return L});class L{constructor(H,R,Q,O){this.authorColor=this.b2=this.Fea=null;this.H7a=!1;this.B1a=-1;this.s5c=0;this.zIa=100;this.Xka=-1;this.r0d=null;this.Uob=k.a.mWj;this.FHe=k.a.nWj;this.yi=V=>{(V=v.a(V)?null:V.Result)?V.OperationWaitingForFileDownload?20>this.s5c?(this.zIa*=2,J.Task.delay(this.zIa).continueWith(()=>{this.FYd()})):(this.tCc(),c.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
V.ActivityList?(this.initialize(V.ActivityList,V.VersionAuthors),y.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?this.wPa():this.FMb(!0),this.r0d.stop(),c.ULS.sendTraceTag(41743369,0,50,`VersionHistoryHighlightManager: Time taken For showing diffs in Ms:${this.r0d.yc.toString()}`)):(this.tCc(),c.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(this.zIa*=2,J.Task.delay(this.zIa).continueWith(()=>
{this.FYd()}),c.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.fza=()=>{this.tCc();c.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Fsd=V=>{c.ULS.sendTraceTag(537150400,0,50,`VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:${V.MessageId}`);switch(V.MessageId){case X.a.iterateNext:this.iterateNext();this.Xka=(this.Xka+1)%this.hS.length;
this.VKb(X.a.setCurrentChangeCount,this.Xka+1);break;case X.a.Exa:this.Exa();this.Xka=0>this.Xka?0:this.Xka;this.Xka=(this.Xka+this.hS.length-1)%this.hS.length;this.VKb(X.a.setCurrentChangeCount,this.Xka+1);break;case X.a.tOb:this.FMb(V.Values.ToggleValue)}};this.y1g=(V,W)=>this.y3b(V.Jk,W.Jk);this.x1g=(V,W)=>this.y3b(V.Jk,W);this.Vc=()=>{this.w6b()};this.Bn=()=>{this.w6b()};this.qh=()=>{this.w6b()};c.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=H;this.ariaLiveNotifier=
O;this.gridView=I.g(this.$);this.gridView.ha.YG(this.Vc);this.gridView.rC(this.Bn);this.gridView.Xb.Vk(this.qh);this.gSj();R&&(this.r0d=H.Jb.Bc("UserAction","VersionHistoryDiffManagerStopWatch"),this.FYd());if(this.ks=Q)H=b.a.Oaa(this.$.ya.VersionHistoryActionUrl)||D.a.R9,H!==D.a.R9&&this.ks.OFa(H),this.ks.qo(X.a.iterateNext),this.ks.qo(X.a.Exa),this.ks.qo(X.a.tOb),this.ks.$l(X.a.iterateNext,this.Fsd),this.ks.$l(X.a.Exa,this.Fsd),this.ks.$l(X.a.tOb,this.Fsd)}get dgb(){return this.b2}get OKb(){return-1===
this.B1a?null:this.hS[this.B1a]}get hS(){this.H7a||(this.Fea.sort(this.y1g),this.H7a=!0);return this.Fea}dispose(){this.MQa();this.Fea=this.b2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.cG(this.Vc),this.gridView.MD(this.Bn),this.gridView.Xb&&this.gridView.Xb.Ak(this.qh),this.ks&&(this.ks.Hoa(X.a.Exa),this.ks.Hoa(X.a.iterateNext),this.ks.Hoa(X.a.tOb)))}initialize(H,R){H?(this.MQa(),this.B1a=-1,this.Fea=[],this.H7a=!1,this.b2={},this.authorColor={},this.Uyi(R),this.a5c(H)):c.ULS.shipAssertTag(537150410,
0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")}FYd(){c.ULS.sendTraceTag(537150409,0,50,`VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: ${this.s5c.toString()} --${this.zIa.toString()}`);this.s5c++;const H=(R,Q,O)=>G(this.$.pa.va,A.b(R,this.yi),A.a(Q,this.fza),O,null);y.EwaSettings.$b()?this.$.userOperationManager.Wb(new w.a(537,0,H,80),null):this.$.userOperationManager.Wb(new t.a(537,0,H,16),null)}FMb(H){const R=this.b2;for(let O in R){var Q=
O;const V=R[O];V?V.HMb(H):c.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+Q+"view was Null")}}MQa(){const H=this.b2;for(let Q in H){var R=Q;const O=H[Q];O?O.GJd():c.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+R+"view was Null")}this.Fea=this.b2=null}tYf(H){let R;if(({laf:R,igg:H}=this.vTh(H,this.B1a)).returnValue)if(c.ULS.shipAssertTag(537150402,0,!!H,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),
this.w6b(),H.LFa.toString()in this.b2){this.b2[H.LFa.toString()].cmj(H.Jk);var Q=u.D(H.Jk);this.ariaLiveNotifier.setEnabled(!1);this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.readText(String.format(z.a.instance.mb(158),R+1,this.hS.length,Q.pz(!1),H.aDc.DisplayName));this.B1a=R}else c.ULS.shipAssertTag(537150401,0,!1,`VersionHistoryHighlightManager.SelectNextOrPreviousChange - ${H.LFa.toString()} view not present in views dictionary`)}VKb(H,R){if(y.EwaSettings.ma(319))if(this.ks){var Q=
{};Q.count=R;H=new d.a(H);H.Values=Q;this.ks.send(H)}else c.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else c.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")}vTh(H,R){let Q,O=!1;Q=null;let V=0;for(;!O&&V<this.hS.length;){R=H?this.mTh(R):this.eVh(R);Q=this.hS[R];const W=Object(f.a)(B.a,this.$.xa.getItemByName(Q.Jk.SheetName));if(!W)return c.ULS.shipAssertTag(537150369,
0,!1,"VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet"),{returnValue:!1,laf:R,igg:Q};W.visible&&(O=!0);V++}return{returnValue:O,laf:R,igg:Q}}mTh(H){return-1===H?this.l1e():(H+1)%this.hS.length}eVh(H){-1===H&&(H=this.l1e());return H=(H+this.hS.length-1)%this.hS.length}a5c(H){this.gbh(H);this.G4c()}F_h(H,R){const Q=[];if(!H.RangeList)return c.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),
Q;for(const O of H.RangeList)O&&this.$.xa.Lk(O.SheetName)?(H=new U(0,O,R),Q.push(H)):c.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+O.SheetName);return Q}gbh(H){for(const R of H)if(!R||r.e(R.LocationList))c.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(const Q of R.LocationList)if(Q)switch(Q.Type){case 0:this.Fea.push(...this.F_h(Q,R.Person));break;default:c.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else c.ULS.shipAssertTag(537150365,
0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")}G4c(){var H={};const R=new e.a,Q=[];for(const O of this.Fea){R.contains(O.aDc)||R.add(O.aDc);if(0!==O.LFa)continue;const V=new F.a(u.D(O.Jk),m.d(this.$.xa.getItemByName(O.Jk.SheetName))),W=L.yxc(V);W in H||Q.push(V);H[W]=this.tLh(O.aDc)}c.ULS.sendTraceTag(42541534,0,15,`VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : ${this.Fea.length}, Highlightable activities: ${Q.length},Total userlist in activities : ${this.Fea.length}, Total userlist from pane: ${Q.length} `);
this.tCc();0<Q.length&&(H=new (a(1357).RangeVersionHistoryHighlightView)(this.$,Q,H,this.Uob),this.b2["0"]=H)}tCc(){const H=this.Fea?this.hS.length:0;this.VKb(X.a.setCurrentChangeCount,0);this.VKb(X.a.setTotalChangesCount,H)}wPa(){this.VKb(X.a.wPa,0)}Uyi(H){if(H)for(let V=0;V<H.length;++V)if(y.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!H[V].InitialsColor)c.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");
else{var R=H[V].EmailAddress;var Q=H[V].UserName;var O=null;if(H[V].LoginName){const W=H[V].LoginName.split("|");3===W.length&&(O=W[2])}O?this.authorColor[O]=H[V].InitialsColor:R?(c.ULS.sendTraceTag(537150361,0,15,"VersionHistoryHighlightManager Map Author Color: LoginName is null"),this.authorColor[R]=H[V].InitialsColor):Q?(c.ULS.sendTraceTag(537150360,0,15,"VersionHistoryHighlightManager Map Author Color: Email Address is null"),this.authorColor[Q]=H[V].InitialsColor):c.ULS.sendTraceTag(537150359,
0,10,"VersionHistoryHighlightManager Map Author Color: User name is null")}else c.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")}gSj(){if(this.$.ya.VersionHistoryHighlightsSettings){var H=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null;for(let Q=0;Q<H.length;Q++){var R=H[Q];const O=
R.key?R.key:R.Key?R.Key:"";R=R.value?R.value:R.Value?R.Value:"";"DefaultColor"===O?this.FHe=R:"InitialTint"===O?this.Uob=R:c.ULS.sendTraceTag(537150357,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect")}}else c.ULS.sendTraceTag(537150358,0,15,"VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null")}tLh(H){if(H.Email in this.authorColor)return this.authorColor[H.Email];if(H.DisplayName in this.authorColor)return this.authorColor[H.DisplayName];
c.ULS.sendTraceTag(537150356,0,15,"VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary");return this.FHe}y3b(H,R){var Q=Object(f.a)(B.a,this.$.xa.getItemByName(H.SheetName));const O=Object(f.a)(B.a,this.$.xa.getItemByName(R.SheetName));return Q&&O?(Q=(Q=x.HelperMethods.sD(Q.index,O.index))||x.HelperMethods.sD(H.FirstRow,R.FirstRow))||x.HelperMethods.sD(H.FirstColumn,R.FirstColumn):(c.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),
0)}l1e(){var H=u.m(this.gridView.ha.sa.activeRange,this.$.xa.oa);if(!H)return c.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;H=x.HelperMethods.wx(new l.a(this.hS),0,this.hS.length,H,this.x1g);0>H&&(H=~H);return H%this.hS.length}w6b(){if(this.OKb){if(!(this.OKb.LFa.toString()in this.b2)){c.ULS.shipAssertTag(537150353,0,!1,`VersionHistoryHighlightManager.DeselectCurrentlySelectedView - ${this.OKb.LFa.toString()} view not present in views dictionary`);
return}this.b2[this.OKb.LFa.toString()].Xeh(this.OKb.Jk)}this.B1a=-1}iterateNext(){this.tYf(!0)}Exa(){this.tYf(!1)}static yxc(H){return`${H.range}${H.sheetId}`}}Object(n.a)(L,"VersionHistoryHighlightManager",null,[753,10])},1357:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(8);class d{}d.pth="ewa-vhr-rectinnerborder";Object(n.a)(d,"CssClassNames",null,[]);var f=a(65),e=a(43),k=a(197),l=a(97),m=a(21),u=a(341),t=a(1256);a.d(C,"RangeVersionHistoryHighlightView",function(){return w});class w{constructor(r,
v,y,x){this.Pib=null;this.$=r;this.ixg=v;this.ESa=y;this.FSa={};this.Uob=x;this.ybi()}get vF(){return[w.z4]}get ob(){return this.Pib||(this.Pib=m.g(this.$).ob)}HMb(r){r?this.ob.Jn(this.vF):this.ob.Pg(this.vF)}GJd(){this.HMb(!1);this.ob.mSa(new u.a(null,f.d(this.$.oa)),this.vF)}cmj(r){if(this.ESa){var v=new u.a(e.D(r),f.d(this.$.xa.getItemByName(r.SheetName))),y=t.a.yxc(v);if(y in this.ESa)if(y in this.FSa){v=k.a.pp(this.ESa[y]);y=this.FSa[y];for(let x in y)y[x].style.backgroundColor=`rgba(${v.r},${v.g},${v.b},${b.a.oWj})`;
m.g(this.$).ha.Qa.lH(null);m.g(this.$).L5e(r,60,!0,l.a.T4i)}else c.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+y);else c.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+y)}else c.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")}Xeh(r){r=new u.a(e.D(r),f.d(this.$.xa.getItemByName(r.SheetName)));
var v=t.a.yxc(r);if(v in this.FSa)if(v in this.ESa){r=k.a.pp(this.ESa[v]);v=this.FSa[v];for(let y in v)v[y].style.backgroundColor=`rgba(${r.r},${r.g},${r.b},${this.Uob})`}else c.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+v);else c.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+v)}ybi(){this.ob.Ww(this.ixg,[w.z4],!1,(r,v)=>{if(r&&r.range&&
r.sheetId&&v){var y=new u.a(r.range,r.sheetId);y=t.a.yxc(y);y in this.FSa||(this.FSa[y]={});this.FSa[y][r.paneType.toString()]=v;y in this.ESa?(r=this.ESa[y],y=k.a.pp(r),v.style.borderColor=r,v.style.backgroundColor=`rgba(${y.r},${y.g},${y.b},${this.Uob})`,r=document.createElement("div"),r.className=d.pth,v.appendChild(r)):c.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+y)}else c.ULS.shipAssertTag(537150423,
0,!!r,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),c.ULS.shipAssertTag(537150422,0,!r||!!r.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),c.ULS.shipAssertTag(537150421,0,!r||!!r.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),c.ULS.shipAssertTag(537150420,0,!!v,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})}}w.z4=23;Object(n.a)(w,"RangeVersionHistoryHighlightView",null,[784])},1422:function(n,
C,a){a.r(C);var c=a(9),b=a(0),d=a(4),f=a(222),e=a(15),k=a(114),l=a(172),m=a(41);class u extends k.a{constructor(Pa,Ab,Aa,rb,Lb){super(Pa,Ab);this.executionContext=null;this.retryCount=0;this.MQi=oc=>{({HMd:oc}=this.uNj(oc)).returnValue?oc.Success?(l.c(2138207060,!0),e.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(l.c(2138207060,!1),e.ULS.sendTraceTag(42287317,0,10,`RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message ${oc.Output}`),
this.gh(this.YJ)):(l.c(2138207060,!1),this.gh(this.YJ));(oc=this.executionContext.activityState[u.xvd])&&oc();this.Dp();this.executionContext.yM()};this.LQi=()=>{if(0<this.retryCount)e.ULS.sendTraceTag(537150418,0,15,`RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : ${this.retryCount}`),this.retryCount--,this.kVf();else{e.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");l.c(2138207060,!1);this.gh(this.YJ);
var oc=this.executionContext.activityState[u.xvd];oc&&oc();this.Dp();this.executionContext.yM()}};this.YJ=Aa;this.W2=rb;this.baseUrl=Lb}execute(Pa){this.executionContext=Pa;this.retryCount=3;this.kVf();return 1}kVf(){var Pa=this.executionContext.activityState[u.yrc];const Ab=`${this.baseUrl}${"restoreversion.ashx"}`,Aa={};Aa.VersionId=this.executionContext.activityState[u.hhg];Aa.QuerySignature=Pa;Pa=m.c(Aa);this.W2.Jm(Ab,2,Pa,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.MQi,this.LQi,
null)}uNj(Pa){let Ab;Ab=null;Pa=Pa?Pa.data?Pa.data.Xd:null:null;return Pa&&Pa.length?({fu:Ab}=m.d(Pa)).returnValue?{returnValue:!0,HMd:Ab}:(e.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,HMd:Ab}):(e.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,HMd:Ab})}}u.hhg="RVAvi";u.yrc="RVAqs";u.xvd=
"RVlvrt";Object(b.a)(u,"RestoreVersionActivity",k.a,[]);var t=a(6);class w extends f.a{constructor(Pa,Ab,Aa){super();this.activityName=Pa;this.RJ=Ab;this.YJ=Aa;this.Eb()}create(){this.pb(new u(this.activityName,this.RJ,this.YJ,d.AFrameworkApplication.yd,d.AFrameworkApplication.ta.Oa.AV))}static ka(Pa){Pa.da.Ga(320,new w(t.a.KMd,t.a.hj,t.a.LMd))}}Object(b.a)(w,"RestoreVersionActivityFactory",f.a,[]);class r extends k.a{constructor(Pa,Ab){super(Pa,Ab)}execute(Pa){(0,Pa.activityState[r.A5f])(()=>{this.Dp();
Pa.yM()});return 1}}r.A5f="RVEAssea";Object(b.a)(r,"RestoreVersionErrorActivity",k.a,[]);class v extends f.a{constructor(Pa,Ab){super();this.activityName=Pa;this.RJ=Ab;this.Eb()}create(){this.pb(new r(this.activityName,this.RJ))}static ka(Pa){Pa.da.Ga(321,new v(t.a.LMd,t.a.hj))}}Object(b.a)(v,"RestoreVersionErrorActivityFactory",f.a,[]);var y=a(80),x=a(694),B=a(50),z=a(37),A=a(183),I=a(371),F=a(55);class U{constructor(Pa,Ab){this.$=Pa;this.rWj=Ab}Lc(){return d.AFrameworkApplication.fa.qa("IsAnonymousUser")?
(e.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1}executeCommand(Pa,Ab){e.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");Pa=!1;switch(Ab.command){case -1112508866:I.a(this.$)&&this.$.da.za(423).wyc(!1),Pa=this.rWj.$Bj()}e.ULS.sendTraceTag(537150413,0,50,`VersionHistoryCommandHandler:ExecuteCommand response${Pa}.`);return Pa?F.Task.Ta(Pa):A.a(Ab.command)}Ac(Pa,Ab){return-1112508866===Ab.command&&this.$.isVersionHistoryEnabled()}Oc(){return!1}}
Object(b.a)(U,"VersionHistoryCommandHandler",null,[164]);var X=a(7),T=a(251),G=a(164),D=a(382);class J{static addAppPLTEventToLog(Pa){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(Pa)}catch(Ab){}}static setIsPageLoadForFirstTime(Pa){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(Pa)}catch(Ab){}}}Object(b.a)(J,"VersionHistoryLogConnector",null,[]);var L=a(27),H=a(819),R=a(1235),Q=a(153),O=a(90),V=a(29),W=a(1),da=a(42),ta=a(249),K=a(984),na=
a(259),P=a(246),ka=a(12);class pa{constructor(Pa){this.Jw=Pa}di(){na.a(this.Jw.$).nB(this.ee)||na.a(this.Jw.$).di(this)}U7(){na.a(this.Jw.$).nB(this.ee)&&na.a(this.Jw.$).Tz(this)}get ee(){return P.a.ehg}get nc(){return document.querySelector('[id="vhHeader"]')}get Jf(){return!0}mh(Pa){return ka.DOMElementExtensions.xf(this.nc,Pa)}sj(){this.Jw.$.frame.He.Zj(this.Jw.$.frame.He.eF)}Vj(){}hg(Pa,Ab){Ab||this.Jw.QOb.then(Aa=>{Aa.enterHeaderFocusTrapZone();return null});return!Ab}}Object(b.a)(pa,"VersionHistoryHeader",
null,[107]);class Na{constructor(Pa){this.Jw=Pa}di(){na.a(this.Jw.$).nB(this.ee)||na.a(this.Jw.$).di(this)}U7(){na.a(this.Jw.$).nB(this.ee)&&na.a(this.Jw.$).Tz(this)}get ee(){return P.a.fhg}get nc(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}get Jf(){return!0}mh(Pa){return ka.DOMElementExtensions.xf(this.nc,Pa)}sj(){this.Jw.$.frame.He.Zj(this.Jw.$.frame.He.eF)}Vj(){}hg(Pa,Ab){Ab||this.Jw.QOb.then(Aa=>{Aa.enterFocusTrapZone();return null});return!Ab}}Object(b.a)(Na,"VersionHistoryPane",
null,[107]);class Z{constructor(Pa){this.Jw=Pa}di(){na.a(this.Jw.$).nB(this.ee)||na.a(this.Jw.$).di(this)}U7(){na.a(this.Jw.$).nB(this.ee)&&na.a(this.Jw.$).Tz(this)}get ee(){return P.a.ghg}get nc(){return document.querySelector('[id="vhViewer"]')}get Jf(){return!0}mh(Pa){return ka.DOMElementExtensions.xf(this.nc,Pa)}sj(){this.Jw.$.frame.He.Zj(this.Jw.$.frame.He.eF)}Vj(){}hg(Pa,Ab){Ab||this.Jw.QOb.then(Aa=>{Aa.enterViewerFocusTrapZone();return null});return!Ab}}Object(b.a)(Z,"VersionHistoryViewer",
null,[107]);var Ra=a(141),Da=a(252),Ba=a(68),ea=a(420),Y=a(761);class ja{constructor(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}}Object(b.a)(ja,"AppBootSettings",null,[]);class ca{constructor(){this.rootDiv=this.appBootSettings=null}}Object(b.a)(ca,"AppVersionControllerFactoryParameters",null,[]);class ba{constructor(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}}Object(b.a)(ba,"OnVersionSelectedParams",null,[]);class ua{constructor(){this.appName=
0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}
Object(b.a)(ua,"AppSettings",null,[]);class wa{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}}Object(b.a)(wa,"ControllerFactoryParameters",null,[]);var ia=a(300);class xa{constructor(Pa){this.baseVersionInfo=this.q3=this.Uoa=this.Am=this.ewaAccessibilityManager=this.QOb=null;this.nJd=this.Atf=!1;this.YGe=!0;this.dialog=this.VB=this.PUe=this.QD=this.u0d=this.s0d=this.t0d=null;this.aDf=Ab=>{e.ULS.sendTraceTag(42553885,
0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(this.Lyj()){var Aa=Lb=>{l.c(2138207060,!1);this.Am.setRestoreFailedAtServer(Lb)};this.QD&&this.QD.startTimer(xa.O$f);var rb=()=>{this.QD.endTimer(xa.O$f);this.iye(this.QD)};this.Am.setRestoreInProgress();da.a(this.$).Bs(new ta.a(t.a.Ux,5,()=>{const Lb=Ba.a(this.$).kd.activityState;Lb[Da.a.Aq]=t.a.VAe;Lb[Ra.a.XX]=!0;Lb[Ra.a.nT]=0;Lb[u.hhg]=Ab;Lb[u.yrc]=d.AFrameworkApplication.qj;Lb[u.xvd]=rb;Lb[r.A5f]=Aa;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RestoreVersionForConvergenceExcelOnline",
!1)&&(Lb[ia.a.kDd]=!0)}))}else l.c(2138207060,!1)};this.KFf=Ab=>{this.QOb.then(Aa=>{Aa.enterFocusTrapZone();return null});e.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");this.QD.endTimer(xa.YWd);this.QD.incrementCounter(xa.c5g);e.ULS.sendTraceTag(537150348,0,50,`VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:${this.QD.getTimerDuration(xa.YWd)}`);this.Vfj(Ab.containerDiv);Ab.versions&&0<Ab.versions.length&&(this.PUe=xa.sF(Ab.versions[Ab.versions.length-
1]));this.q3&&this.Uoa&&this.uOd(this.q3);e.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=Ab=>{e.ULS.sendTraceTag(537150345,0,50,`VersionHistoryPaneActor:OnVersionSelected called. for Version:${xa.sF(Ab.currentVersion)}, LastSelected:${xa.sF(this.q3)}`);this.QD.incrementCounter(xa.b5g);this.q3=Ab.currentVersion;this.baseVersionInfo=Ab.baseVersion;this.Atf=Ab.noBaseToCompareTo;this.Uoa&&this.KVj()&&(this.uOd(Ab.currentVersion),e.ULS.sendTraceTag(537150344,
0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Mxf=Ab=>{e.ULS.sendTraceTag(537150337,0,50,`VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:${(null===Ab||void 0===Ab?0:Ab.versionSelected)?xa.sF(Ab.versionSelected.currentVersion):null} UpdatedVersionsCount${(null===Ab||void 0===Ab?0:Ab.updatedVersions)?Ab.updatedVersions.length:0}, LastSelected:${xa.sF(this.q3)}`);this.QD.incrementCounter(xa.a5g);if(this.baseVersionInfo){if((null===Ab||void 0===Ab?0:Ab.updatedVersions)&&
2<=Ab.updatedVersions.length){let Aa=null,rb=null;const Lb=xa.sF(this.q3),oc=xa.sF(this.baseVersionInfo);for(const $c of Ab.updatedVersions)if(Ab=xa.sF($c),Lb===Ab?Aa=$c:oc===Ab&&(rb=$c),Aa&&rb)break;Aa&&rb?(this.q3=Aa,this.baseVersionInfo=rb,e.ULS.sendTraceTag(537150307,0,50,`VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: ${xa.sF(this.q3)}, RevisionID[N-1]: ${xa.sF(this.baseVersionInfo)}.`),this.uOd(this.q3)):e.ULS.sendTraceTag(537150306,
0,50,`VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: ${Lb}, RevisionID[N-1]: ${oc}.`)}else e.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");e.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else e.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};
this.Mwf=()=>{e.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");this.G_g();const Ab=new O.a(1470556788,0,this.$.Kc,0,null);this.$.Ka.Lb(Ab)};this.sDf=Ab=>{e.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");let Aa=new O.a(-1244760097,0,this.$.Kc,0,null);this.$.pe.get(51)&&(e.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Aa=new O.a(-309686558,0,this.$.Kc,0,null));l.c(1604651619,!0);
this.$.Ka.Lb(Aa,{["FileDownloadUrl"]:Ab})};this.Nxf=Ab=>{e.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");if(!W.EwaSettings.isChangeGateEnabled("OfficeVSO:6794681_VHDisableDownloadACopy")||this.Kyj())Ab=new T.QueryStringBuilder(Ab),Ab.Zi("fn",d.AFrameworkApplication.fileName),e.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Ab.toString().length),8===this.$.frame.w9a(Ab.toString(),!0)?(e.ULS.sendTraceTag(587830283,0,10,
"VersionHistoryPaneActor:OnDownloadVersion failed"),l.c(1316171850,!1)):l.c(1316171850,!0)};this.rvf=Ab=>{this.Am.setFullAppErrorCode(Ab)};this.Wyf=Ab=>{switch(Ab){case 101:Ab="VHFailedToGetDownloadToken";break;case 100:Ab="VHFailedToLoadVersionList";break;case 104:Ab="VHVersioningNotEnabled";break;case 105:Ab="VHFileNotFound";break;case 106:Ab="VHVersionTooOld";break;default:Ab="None"}this.QD.addEvent("OnFullAppError",Ab);e.ULS.sendTraceTag(537150291,0,10,`FullApp Error Event: ${Ab}`)};this.MCd=
Ab=>{this.YGe=Ab;e.ULS.sendTraceTag(537150290,0,50,`VersionHistoryPaneActor:Show Changes toggled to:${Ab.toString()}`);this.ROd(K.a.tOb,{["ToggleValue"]:Ab})};this.oAf=Ab=>{e.ULS.sendTraceTag(50405840,0,50,`VersionHistoryPaneActor:OnIteratorSelected next: ${Ab}`);l.c(1488635506,!0);const Aa={};Ab?this.ROd(K.a.iterateNext,Aa):this.ROd(K.a.Exa,Aa)};this.SHb=Ab=>{switch(Ab.MessageId){case G.a.NUa:e.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");
W.EwaSettings.ma(420)&&this.Am.setVersionLoadComplete();break;case G.a.OUa:e.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case K.a.setCurrentChangeCount:Ab=Ab.Values.count;e.ULS.sendTraceTag(537150288,0,50,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : ${Ab}`);this.Am.setCurrentChangeCount(Ab);break;case K.a.setTotalChangesCount:Ab=Ab.Values.count;e.ULS.sendTraceTag(537150287,0,50,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : ${Ab}`);
this.Am.setTotalChangesCount(Ab);break;case K.a.wPa:this.MCd(this.YGe);break;default:e.ULS.sendTraceTag(537150286,0,15,`VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:${Ab.MessageId}`)}};this.$=Pa;this.e9b=this.$.Cb+xa.Mxh;this.mJd=!1;W.EwaSettings.ma(386)&&this.kbh();this.PBb="";this.ttd=0;this.perfTelemetryInfos=[]}dispose(){this.Ize()}JZi(){this.$.da.Za(15,Pa=>{this.ewaAccessibilityManager=Pa;this.ewaAccessibilityManager.mode=2})}kbh(){this.t0d=new Na(this);this.s0d=new pa(this);
this.u0d=new Z(this)}$Bj(){e.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");d.AFrameworkApplication.uN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");d.AFrameworkApplication.uN("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");d.AFrameworkApplication.uN("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");d.AFrameworkApplication.cI("8492a557;72ff4572");
this.QD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.QD.startTimer(xa.N$f);if(!this.Am&&(ea.a(()=>{this.Am=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object(X.a)(new wa,{ulsLogger:new D.a,docId:d.AFrameworkApplication.qj,appSettings:Object(X.a)(new ua,{appName:120,userSessionId:d.AFrameworkApplication.userSessionId,wdEnableSaveACopy:W.EwaSettings.ma(355),wdEnableDownloadTokens:W.EwaSettings.ma(350),wacCluster:d.AFrameworkApplication.yd.UO,
uiLocale:d.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:W.EwaSettings.ma(321)&&this.$.isEditMode,wdEnableIterator:W.EwaSettings.ma(318)&&W.EwaSettings.ma(319),useXhr:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:W.EwaSettings.ma(420),disableSaveACopy:this.ZRd(),wdEnableShowVersionChanges:W.EwaSettings.ma(318)&&W.EwaSettings.ma(320),disabledChangeGates:this.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:W.EwaSettings.ma(536),isRtl:d.AFrameworkApplication.isRtl,wdExperimentWithIteratorLocation:W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VersionHistoryIteratorInPane",
!1)}),perfTelemetryInfos:this.perfTelemetryInfos}))}),!this.Am))return e.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),l.c(429638140,!1),!1;this.aCj();this.QD.endTimer(xa.N$f);this.QD.startTimer(xa.Q$f);e.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");l.c(429638140,!0);return!0}aCj(){var Pa;this.Ij();if(!document.getElementById(this.e9b)){const Ab=document.createElement("div");
Ab.id=this.e9b;Ab.style.width="100%";Ab.style.zIndex="998";Ab.style.display="block";Ab.style.position="absolute";if(d.AFrameworkApplication.ta.Oa.We){const Aa=(null===(Pa=document.getElementById("HeaderRegion"))||void 0===Pa?void 0:Pa.offsetHeight)||0;Ab.style.top=Aa+"px";Ab.style.bottom="0px";Ab.style.height=`calc(100vh - ${Aa}px)`}else Ab.style.height="100%";this.$.qr.insertBefore(Ab,this.$.qr.firstChild);this.QOb=this.Am.createVersionHistoryDialog(Ab)}document.getElementById(this.e9b).style.display=
"block";this.bJd();this.QD.startTimer(xa.YWd);this.Am.getVersions("")}bJd(){W.EwaSettings.ma(386)&&(this.t0d.di(),this.s0d.di(),this.u0d.di(),this.JZi())}qZd(){W.EwaSettings.ma(386)&&(this.t0d.U7(),this.s0d.U7(),this.u0d.U7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))}Ij(){this.Am.getVersionsReadyEvent().addListener(this.KFf);this.Am.getVersionSelectedEvent().addListener(this.onVersionSelected);this.Am.getCloseSelectedEvent().addListener(this.Mwf);this.Am.getFullAppErrorEvent().addListener(this.Wyf);
this.Am.getIteratorSelectedEvent().addListener(this.oAf);this.Am.getShowVersionChangesToggledEvent().addListener(this.MCd);W.EwaSettings.ma(350)&&(this.Am.getDownloadTokenReadyEvent().addListener(this.Mxf),this.mJd=!0);W.EwaSettings.ma(355)&&(this.Am.getSaveACopySelectedEvent().addListener(this.sDf),this.Am.getDownloadVersionSelectedEvent().addListener(this.Nxf));W.EwaSettings.ma(321)&&this.$.isEditMode&&(this.Am.getRestoreVersionSelectedEvent().addListener(this.aDf),this.nJd=!0);this.Uoa&&this.Uoa.getAppErrorEvent().addListener(this.rvf)}mk(){this.Am.getVersionsReadyEvent().removeListener(this.KFf);
this.Am.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.Am.getCloseSelectedEvent().removeListener(this.Mwf);this.Am.getFullAppErrorEvent().removeListener(this.Wyf);this.Am.getIteratorSelectedEvent().removeListener(this.oAf);this.Am.getShowVersionChangesToggledEvent().removeListener(this.MCd);W.EwaSettings.ma(355)&&(this.Am.getSaveACopySelectedEvent().removeListener(this.sDf),this.Am.getDownloadVersionSelectedEvent().removeListener(this.Nxf));this.mJd&&(this.Am.getDownloadTokenReadyEvent().removeListener(this.Mxf),
this.mJd=!1);this.nJd&&(this.Am.getRestoreVersionSelectedEvent().removeListener(this.aDf),this.nJd=!1);this.Uoa&&this.Uoa.getAppErrorEvent().removeListener(this.rvf)}Dwj(){return this.ZRd()||!d.AFrameworkApplication.OY}Kyj(){return this.Dwj()?(e.ULS.sendTraceTag(520180169,0,15,"VersionHistoryPaneActor:OnDownloadVersion blocked"),l.c(1316171850,!1),!1):!0}Lyj(){let Pa=!0;if(W.EwaSettings.ma(598)&&!this.$.hN)return e.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+
this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!W.EwaSettings.ma(317)){this.vui();this.Am.setCoauthRestoreError();Pa=!1;const Ab=new O.a(-729359593,0,this.$.Kc,0,null);this.$.Ka.Lb(Ab)}this.$.hN&&(e.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),Pa&&(Pa=!1,this.ZBj()));return Pa}ZBj(){var Pa=V.a.Yc(1,0,1901,1900,0,-1603358883,"RestoreVersionUnsavedChangesError");Pa=this.dialog||new Q.ErrorDialog(this.$,Pa);Pa.initialize();
Pa.ig()}KVj(){e.ULS.sendTraceTag(537150343,0,50,`VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion${this.baseVersionInfo?xa.sF(this.baseVersionInfo):""}`);if(xa.sF(this.q3)===this.PUe)return e.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Atf)return e.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return e.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;const Pa=xa.QNh(this.baseVersionInfo);e.ULS.sendTraceTag(537150339,0,50,`downloadURL length ${Pa?Pa.length:0}`);return Pa?!0:(e.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)}ZRd(){return!this.$.wka}G_g(){document.getElementById(this.e9b).style.display="none";const Pa=new O.a(-1423792966,0,
this.$.Kc,0,null);this.$.Ka.Lb(Pa);this.Ize()}Ize(){this.QD&&(this.QD.endTimer(xa.Q$f),this.iye(this.QD),this.QD=null);this.mk();this.qZd();this.perfTelemetryInfos&&(e.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.map(Pa=>JSON.stringify(Pa)).toString()),this.perfTelemetryInfos=null);this.VB&&(this.VB.Hoa(G.a.NUa),this.VB.Hoa(G.a.OUa),this.VB.Hoa(K.a.setCurrentChangeCount),this.VB.Hoa(K.a.setTotalChangesCount),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.VB.Hoa(K.a.wPa),this.VB.dispose(),this.VB=null)}Vfj(Pa){try{this.Uoa?J.setIsPageLoadForFirstTime(!1):(J.setIsPageLoadForFirstTime(!0),ea.a(()=>{const Ab=new ja;Ab.ulsLogger=new D.a;Ab.actionUrl=this.$.ya.VersionHistoryActionUrl;Ab.hideEmbedFooter=!0;Ab.useFetch=W.EwaSettings.ma(415)&&!L.a.tv;this.Uoa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object(X.a)(new ca,{appBootSettings:Ab,rootDiv:Pa}))}))}catch(Ab){e.ULS.sendTraceTag(41239239,0,10,`VersionHistoryPaneActor: ResetAppVersionController failed due to exception. ${Ab}`)}}uOd(Pa){e.ULS.sendTraceTag(537150298,
0,50,`VersionHistoryPaneActor:SelectVersion called. for Version:${xa.sF(Pa)}, LastSelected:${this.PBb}`);if(Pa)if(xa.sF(Pa).length){var Ab=(new Date).getTime();if(xa.sF(Pa)===this.PBb&&1E3>Ab-this.ttd)e.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{xa.sF(Pa)!==this.PBb&&(e.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.Am.setTotalChangesCount(-1),this.Am.setCurrentChangeCount(-1));
var Aa=excelVersionHistory.FactoryGlobal.getTelemetryCollector();Aa.addEvent("SelectVersion",xa.sF(Pa));try{this.jYj(Aa);this.ttd=Ab;this.PBb=xa.sF(Pa);const rb=new ba;rb.selectedVersionInfo=this.q3;rb.baseVersionInfo=this.baseVersionInfo;rb.telemetryCollector=Aa;this.Uoa.onVersionSelectedWithParams(rb);this.Am&&W.EwaSettings.ma(355)&&this.Am.setDisableSaveACopy(this.ZRd());const Lb=document.getElementById(xa.Lxh);Lb&&!this.VB&&(e.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),
this.VB=new K.a(Lb.contentWindow,y.a.Oaa(this.$.ya.VersionHistoryActionUrl)||Y.a.R9),this.VB.$l(G.a.NUa,this.SHb),this.VB.$l(G.a.OUa,this.SHb),this.VB.qo(K.a.setCurrentChangeCount),this.VB.qo(K.a.setTotalChangesCount),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.VB.qo(K.a.wPa),this.VB.$l(K.a.setCurrentChangeCount,this.SHb),this.VB.$l(K.a.setTotalChangesCount,this.SHb),W.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.VB.$l(K.a.wPa,this.SHb))}catch(rb){this.ttd=0,this.PBb="",Aa.addEvent("Exception",rb.toString()),e.ULS.sendTraceTag(42016832,0,10,`VersionHistoryPaneActor: OnVersionSelected failed due to exception. ${rb}`)}finally{e.ULS.sendTraceTag(537150292,0,50,Aa?Aa.getJsonForLogging():"")}}}else e.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else e.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")}jYj(Pa){for(const Ab of this.perfTelemetryInfos){const Aa=
Ab.TelemetryEventKey?Ab.TelemetryEventKey:Ab.telemetryEventKey?Ab.telemetryEventKey:"",rb=Ab.TelemetryEventData?Ab.TelemetryEventData:Ab.telemetryEventData?Ab.telemetryEventData:"";Aa&&rb&&Pa.addEvent(Aa,rb)}this.perfTelemetryInfos.length=0}iye(Pa){e.ULS.sendTraceTag(42553886,0,15,`VersionHistoryPaneActor:CaptureSessionTelemetry - ${Pa?Pa.getJsonForLogging():""} `)}vui(){const Pa=this.$.ea.Rm,Ab={};let Aa=null;for(const rb of Pa)rb.UserEmail&&(Ab[rb.UserEmail]=rb.UserEmail in Ab?Ab[rb.UserEmail]+
1:1),rb.User.UserID===this.$.ea.clientId&&(Aa=rb.UserEmail);e.ULS.sendTraceTag(42522438,0,10,`VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: ${Pa.length}, TotalAuthorsAsYourself ${Aa?Ab[Aa]:-1}`)}ROd(Pa,Ab){e.ULS.sendTraceTag(537150285,0,50,`VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:${Pa}`);if(this.VB){Pa=new H.a(Pa);Pa.Values[R.a.o5c]=this.$.ya.UserSessionId;if(Ab)for(let Aa in Ab)Pa.Values[Aa]=Ab[Aa];this.VB.send(Pa)}else e.ULS.sendTraceTag(537150284,
0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")}static sF(Pa){return Pa?Pa.RevisionID?Pa.RevisionID:Pa.revisionID?Pa.revisionID:"":""}static QNh(Pa){return Pa?Pa.DownloadUrl?Pa.DownloadUrl:Pa.downloadUrl?Pa.downloadUrl:"":""}}xa.Mxh="_excelVersionHistoryOverlay";xa.Lxh="vhs_frame";xa.N$f="TimeTakenShowVersionHistoryDialogAction";xa.Q$f="TimeTillVersionHistoryDialogWasOpenMs";xa.YWd="TimeTakenGetVersionsToOnVersionsReady";xa.b5g="CountOnVersionSelectedCalledinOneVHSession";
xa.c5g="CountOnVersionsReadyCalledinOneVHSession";xa.a5g="CountOnDownloadTokenReadyCalledinOneVHSession";xa.O$f="TimeTakenVersionRestore";Object(b.a)(xa,"VersionHistoryPaneActor",null,[10]);var gb=a(184);class va extends x.a{constructor(Pa){super(Pa)}vd(){const Pa=this.Gti(),Ab=B.GetServiceTaskFactory.Sa(this.$.da,21,137,this.fb);z.TaskExtensions.Aa(z.TaskExtensions.Td([Pa,Ab],this.la,3),()=>{var Aa=Ab.result;const rb=y.a.Oaa(this.$.ya.VersionHistoryActionUrl);rb!==Y.a.R9&&Aa.OFa(rb);Aa=new xa(this.$);
this.$c([new U(this.$,Aa)])},this.la,3)}Gti(){const Pa=B.GetServiceTaskFactory.Eja(this.$.da,283,284,this.fb).then(Ab=>Ab.ko.loadScript("excelVersionHistory"),Ab=>{e.ULS.sendTraceTag(537150412,0,10,`versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. ${Ab}`);return Promise.reject(Ab)});return gb.c(Pa)}static ka(Pa){x.a.Od(304,new va(Pa))}}Object(b.a)(va,"VersionHistoryCommandHandlerFactory",x.a,[]);var sa=a(1256),ab=a(699);class Ua extends f.a{constructor(Pa){super();this.$=
Pa;this.Eb()}create(){const Pa=B.GetServiceTaskFactory.Sa(this.$.da,211,212,this.fb),Ab=B.GetServiceTaskFactory.Sa(this.$.da,21,137,this.fb);z.TaskExtensions.Aa(z.TaskExtensions.Td([Pa,Ab],this.$.la),()=>{const Aa=Object(ab.a)(this.$.da,305,()=>new sa.a(this.$,!0,Ab.result,Pa.result));this.pb(Aa)},this.$.la,3)}static ka(Pa){Pa.da.Ga(306,new Ua(Pa))}}Object(b.a)(Ua,"VersionHistoryHighlightManagerFactory",f.a,[]);var nb=a(510),Ha=a(5),sb=a(160),Qb=a(14);class mb extends k.a{constructor(Pa,Ab,Aa){super(Pa,
Ab);this.lineageManager=Aa}execute(Pa){this.lineageManager.lineageHidePreviousHistory();return super.execute(Pa)}}Object(b.a)(mb,"LineageClearHistoryConfirmedActivity",k.a,[]);var Pb=a(17),gc=a(140);class Xb{constructor(Pa,Ab){this.$=Pa;this.lineageManager=Ab;Pa=[new Pb.a(t.a.fud,1038647878,0,0,2240),new Pb.a(t.a.idle,1038647878,0,1)];Ba.a(this.$).OId(new gc.a(t.a.eud,t.a.idle,Pa),new mb(t.a.fud,t.a.idle,Ab))}Lc(){return!1}executeCommand(Pa,Ab,Aa){Pa=!1;switch(Ab.command){case 1834994092:9===Ab.Re&&
this.pHj();this.zzj(Ab,Aa);Pa=!0;break;case -409942531:this.Bzj(),Pa=!0}return Pa?F.Task.Ta(!0):A.a(Ab.command)}Ac(Pa,Ab){return 1834994092===Ab.command||-409942531===Ab.command}Oc(){return!1}zzj(Pa,Ab){e.ULS.sendTraceTag(537155483,0,50,`LineageActivityCommandHandler::ShowChangesCore command location: ${Ab.MenuItemId||Pa.Re}`);this.lineageManager.Y4f(19===Pa.Re&&!!Ab.MenuItemId,Ab.MenuItemId,Pa.Re,Ab)}pHj(){const Pa=Ha.a.Qrc;Pa!==sb.a(this.$).cm.Yz&&sb.a(this.$).cm.activateRibbonTab(Pa)}Bzj(){da.a(this.$).Bs(new ta.a(t.a.eud,
5,()=>{const Pa=Ba.a(this.$).kd,Ab=V.a.Yc(3,1,2237,2238,2239,1038647878,"LineageConfirmClearHistory");Ab.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";Ab.HelpDescription=Qb.a.instance.ga(1322);Pa.kr([Ab])}))}}Object(b.a)(Xb,"LineageActivityCommandHandler",null,[164]);class Ca extends x.a{constructor(Pa){super(Pa)}vd(){z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,366,367,this.fb),Pa=>{this.$c([new Xb(this.$,Pa.result)])},this.la,3)}static ka(Pa){x.a.Od(363,new Ca(Pa))}}Object(b.a)(Ca,
"LineageActivityCommandHandlerFactory",x.a,[]);class ra{constructor(Pa){this.$db=!0;ra.gdf()?ra.qdf()?(e.ULS.sendTraceTag(526434368,0,50,`LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: ${!Pa}`),this.$db=Pa):this.$db=!1:this.$db=!0}U6a(){return!this.$db}static qdf(){return ra.gdf()&&W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",!1)}static gdf(){return W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",
!1)}}Object(b.a)(ra,"LineageCatchUpExperimentManager",null,[538]);class ma extends f.a{constructor(Pa){super();this.$=Pa;this.Eb()}create(){ra.qdf()?z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,456,457,this.fb),Pa=>{z.TaskExtensions.Aa(Pa.result.Xxj(),Ab=>{this.NEe(Ab.result)},this.$.la,3)},this.$.la,3):this.NEe(!0)}NEe(Pa){this.pb(this.$.da.za(458)||this.$.da.Ga(458,new ra(Pa)))}static ka(Pa){Pa.da.Ga(459,new ma(Pa))}}Object(b.a)(ma,"LineageCatchUpExperimentManagerFactory",f.a,[]);var hb=
a(415),vb=a(33),Va=a(163),db=a(83),oa=a(146),Oa=a(124);class Wa{}Object(b.a)(Wa,"LineageClientParams",null,[]);class Sa{}Object(b.a)(Sa,"LineageFilter",null,[]);var yb=a(65),Ma=a(77),Bb=a(132),Nb=a(43),Ia=a(515),jb=a(171),Ob=a(116),Jb=a(109),Kb=a(282),Qa=a(281),ha=a(97),qa=a(21),pb=a(133),bb=a(61);const eb=(Pa,Ab,Aa,rb,Lb,oc,$c,Fd=null)=>{Fd=Pa.Na(1,Fd);Fd.clientParams=Ab;Fd.lineageFilter=Aa;return bb.g(Pa,"LineageOpenPaneOrChangeFilter",Fd,rb,Lb,oc,$c,0)},Fa=(Pa,Ab,Aa,rb,Lb,oc,$c=null)=>{$c=Pa.Na(1,
$c);$c.fetchFromBelow=Ab;return bb.g(Pa,"LineageLoadMore",$c,Aa,rb,Lb,oc,0)},tb=(Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"LineageRefreshView",oc,Ab,Aa,rb,Lb,0)},dc=(Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"LineageUpdateView",oc,Ab,Aa,rb,Lb,0)},jc=(Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"LineageClosePane",oc,Ab,Aa,rb,Lb,0)},fb=(Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"LineageHidePreviousHistory",oc,Ab,Aa,rb,Lb,0)},ec=(Pa,Ab,Aa,rb,Lb,
oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"LineageLoadInGridBlueDots",oc,Ab,Aa,rb,Lb,0)};var lb=a(51),ac=a(342);class Gb{constructor(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}}Object(b.a)(Gb,"LineageActivitiesResponseDTO",null,[]);class wb extends Gb{constructor(){super();
this.hasNewActivities=!1;this.filterSheetMultiRange=null}}Object(b.a)(wb,"LineageActivitiesUpdateResponseDTO",Gb,[]);class qc{constructor(){this.onDisplayInGridHighlightsChanged=this.areInGridHighlightsEnabled=this.areInGridHighlightsAvailable=this.onDegradedCardGiveFeedbackButtonClicked=this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=
this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}}Object(b.a)(qc,"LineageAppCallbacks",null,[]);class Ya{constructor(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}}Object(b.a)(Ya,"LineageAuthorDTO",null,[]);class xb{constructor(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}}Object(b.a)(xb,"LineageControllerFactoryParams",null,[]);class wc{constructor(){this.lastCol=
this.firstCol=this.lastRow=this.firstRow=0}}Object(b.a)(wc,"LineageSharedRangeDTO",null,[]);class Oc{constructor(){this.sheetName=this.rangeList=null}}Object(b.a)(Oc,"LineageSheetMultiRangeDTO",null,[]);class Cb{constructor(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}}Object(b.a)(Cb,"LineageUserActivityDTO",
null,[]);class Ib{constructor(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}}Object(b.a)(Ib,"LineageValueChangeDTO",null,[]);class fc{constructor(Pa,Ab,Aa,rb){this.g3a=this.MF=null;this.uE=this.iud=0;this.O8h=W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1);this.Y$e=!0;this.dFb=()=>{this.t7&&(this.t7.stop(),this.t7=null);this.yMb.start();this.MF.createLineageTaskPane(this.dud,this.g3a,this.activityGuid)};this.lineageOpenPaneOrChangeFilterRequest=
(Lb,oc)=>{this.yMb.stop();pb.b(this.$).Hd(Bb.a.hOi,{});this.PBj();const $c=Object(X.a)(new Wa,{ClientViewCapacity:Lb.clientViewCapacity});let Fd=null;oc&&(Fd=Object(X.a)(new Sa,{FilterSheetMultiRange:this.cMj(oc.filterSheetMultiRange)}));const Cd=$d=>{$d=Ob.a.ff($d.data);e.ULS.sendTraceTag(537155481,0,50,`LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [${V.a.xc($d)}]`)};Lb=($d,he,ue)=>eb(this.$.pa.va,$c,Fd,Qa.b($d,this.Jfd("LineageOpenPaneOrChangeFilter")),Qa.a(he,Cd),
ue,null);W.EwaSettings.$b()?this.$.userOperationManager.Wb(new jb.a(1010,0,Lb,80),null):this.$.userOperationManager.Wb(new Ia.a(1010,0,Lb,16),null)};this.lineageLoadMoreRequest=Lb=>{pb.b(this.$).Hd(Bb.a.gOi,{});const oc=Fd=>{Fd=Ob.a.ff(Fd.data);e.ULS.sendTraceTag(537155480,0,50,`LineageManager::LineageLoadMore service call failed. Errors: [${V.a.xc(Fd)}]`)},$c=(Fd,Cd,$d)=>Fa(this.$.pa.va,Lb,Qa.b(Fd,this.Jfd("LineageLoadMore")),Qa.a(Cd,oc),$d,null);W.EwaSettings.$b()?this.$.userOperationManager.Wb(new jb.a(1011,
0,$c,80),null):this.$.userOperationManager.Wb(new Ia.a(1011,0,$c,16),null)};this.lineageRefreshViewRequest=()=>{pb.b(this.$).Hd(Bb.a.iOi,{});const Lb=$c=>{$c=Ob.a.ff($c.data);e.ULS.sendTraceTag(537155479,0,50,`LineageManager::LineageRefreshView service call failed. Errors: [${V.a.xc($c)}]`)},oc=($c,Fd,Cd)=>tb(this.$.pa.va,Qa.b($c,this.Jfd("LineageRefreshView")),Qa.a(Fd,Lb),Cd,null);W.EwaSettings.$b()?this.$.userOperationManager.Wb(new jb.a(1012,0,oc,80),null):this.$.userOperationManager.Wb(new Ia.a(1012,
0,oc,16),null)};this.lineageUpdateViewRequest=()=>{dc(this.$.pa.va,Lb=>{if(Lb=Kb.a(Lb)?null:Lb.Result){var oc={["CountOfUpdatedActivities"]:Lb.LineageActivitiesResponse.ActivityList.length};pb.b(this.$).Hd(Bb.a.jOi,oc);Lb=Object(X.a)(new wb,{activityList:this.lrc(Lb.LineageActivitiesResponse.ActivityList),latestActivityId:Lb.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:Lb.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:Lb.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(Lb.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:Lb.HasNewActivities,filterSheetMultiRange:this.TLj(Lb.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:Lb.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:Lb.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:Lb.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:Lb.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(Lb.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:this.pwb(Lb.LineageActivitiesResponse.EolPersonHideHistory)});this.MF.onLineageActivitiesUpdateResponse(Lb)}else e.ULS.shipAssertTag(537155475,0,!!Lb,"LineageManager.LineageUpdateView returned null response.")},Lb=>{Lb=Ob.a.ff(Lb.data);e.ULS.sendTraceTag(537155474,0,50,`LineageManager::LineageUpdateView service call failed. Errors: [${V.a.xc(Lb)}]`)},null,null)};this.areInGridHighlightsAvailable=()=>this.O8h;this.areInGridHighlightsEnabled=()=>this.Y$e;this.onDisplayInGridHighlightsChanged=
Lb=>{e.ULS.sendTraceTag(512340615,0,50,"User toggled in grid highlights, new value {0}.",Lb);const oc={};oc[Ha.a.q4f]=Lb;const $c=new O.a(950288339,0,2,12,null);this.$.Ka.Lb($c,oc);this.Y$e=Lb};this.onCardSelected=(Lb,oc)=>{if(Lb=Lb.rangeHighlightLocation){if(oc){let $c;if(({range:$c}=Nb.Z(oc,null)).returnValue){this.D9e(Lb.sheetName,this.M4a([Nb.j($c)]));return}e.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+oc+" is not valid.")}Lb.rangeList.length?this.D9e(Lb.sheetName,
Lb.rangeList):this.o7h(Lb.sheetName)}};this.onLearnMoreLinkClicked=()=>{if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){const Lb=new O.a(-859308420,Ma.a.Gb,this.$.Kc,12,null);this.$.Ka.Lb(Lb,{[Ma.a.kg]:"HelpID=XLO_LineageTS",["InputMethod"]:Ma.a.Gb,[Ma.a.Qc]:Ha.a.aV,["ShouldCanvasTakeFocus"]:!0})}};this.onVersionHistoryButtonClicked=Lb=>{this.$.Ka.Lb(new O.a(-1112508866,Lb,this.$.Kc,12,null))};this.onDegradedCardGiveFeedbackButtonClicked=()=>{const Lb={};Lb[Ha.a.oQ]=
"LineageDegradedCard";this.$.fd(802602464,0,12,Lb)};this.isFeatureEnabled=()=>!1;this.Vf=()=>{const Lb=this.$.ea.Eo.LineageVersion;Lb!==this.iud&&(e.ULS.sendTraceTag(537155470,0,50,`LineageManager.OnWorkbookMetadataChanged: lineageVersion: ${Lb}, this.lineageVersion: ${this.iud}`),this.iud=Lb,this.B7i())};this.Wc=(Lb,oc)=>{this.MF&&!this.lineageTaskPane.ehc&&oc.LH&&(e.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),this.onStaleActivitiesDetected())};this.Lo=()=>{this.MF&&
!this.lineageTaskPane.ehc&&(e.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),this.onStaleActivitiesDetected())};this.yD=()=>{const Lb=this.R4a();this.MF.onFilterableSheetListChange(Lb)};this.cza=()=>{const Lb=this.R4a();this.MF.onFilterableSheetListChange(Lb)};this.Woc=()=>{const Lb=this.R4a();this.MF.onFilterableSheetListChange(Lb)};this.onPaneClosed=()=>{this.MF.onPaneClosed();jc(this.$.pa.va,null,Lb=>{Lb=Ob.a.ff(Lb.data);e.ULS.sendTraceTag(537155469,0,50,`LineageManager::OnLineageClosePaneFailed service call failed. Errors: [${V.a.xc(Lb)}]`)},
null,null)};this.onRangeFilterInputEnabled=Lb=>{Lb?this.gridView.ha.uT(this.Vc):this.gridView.ha.IR(this.Vc)};this.Vc=()=>{var Lb=Nb.q(this.gridView.ha.sa.activeRange,this.$);Lb=Object(X.a)(new Oc,{rangeList:this.M4a(Lb.Ranges),sheetName:Lb.SheetName});this.MF.onSelectedRangeUpdated(Lb)};this.tryParseRangeInfo=Lb=>{let oc;if(({sheetName:oc,range:Lb}=Nb.Z(Lb,this.$.xa)).returnValue){oc||(oc=this.$.xa.oa.sheetName);const $c=[];$c.push(Lb);Lb=Nb.u(oc,null,$c);return Object(X.a)(new Oc,{rangeList:this.M4a(Lb.Ranges),
sheetName:Lb.SheetName})}return null};this.Mz=()=>{const Lb=this.uE!==this.$.ea.Je;this.MF&&this.lineageTaskPane.isVisible&&Lb&&(this.uE=this.$.ea.Je,this.MF.onRefreshRequired())};this.$=Pa;Ab.Ga(366,this);Ab.Ga(501,this);this.gridView=qa.g(this.$);this.lineageTaskPane=Aa;this.dud=this.lineageTaskPane.CM();this.batchSize=50;this.t7=rb;this.yMb=this.$.Jb.Rg("UserAction","LineagePaneLoadingShimmerStopWatch");this.orc=db.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Vai();this.rCg()}dispose(){this.D$i();
this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.eO(this.onPaneClosed),this.lineageTaskPane.dG(this.Mz),this.lineageTaskPane=null);this.yMb=this.orc=this.g3a=this.dud=this.MF=null}zAj(){return Object(Va.a)(this,void 0,void 0,function*(){return new Promise(Pa=>{e.ULS.sendTraceTag(520717857,0,50,"LineageManager::showInGridBlueDots");pb.b(this.$).Hd(Bb.a.lineageLoadInGridBlueDots,{});const Ab=Lb=>{Lb=Ob.a.ff(Lb.data);e.ULS.sendTraceTag(520717856,0,50,`LineageManager::LineageLoadInGridBlueDots service call failed. Errors: [${V.a.xc(Lb)}]`)},
Aa=Lb=>{if(Lb=Kb.a(Lb)?null:Lb.Result){var oc={["CountOfActivities"]:Lb.ActivityList.length};pb.b(this.$).Hd(Bb.a.Jsi,oc);Lb=this.lrc(Lb.ActivityList);Pa(Lb)}else e.ULS.shipAssertTag(520717854,0,!!Lb,"LineageManager LineageLoadInGridBlueDots returned null response.")},rb=(Lb,oc,$c)=>ec(this.$.pa.va,Qa.b(Lb,Aa),Qa.a(oc,Ab),$c,null);W.EwaSettings.$b()?this.$.userOperationManager.Wb(new jb.a(1024,0,rb,80),null):this.$.userOperationManager.Wb(new Ia.a(1024,0,rb,16),null)})})}Y4f(Pa,Ab,Aa,rb){this.activityGuid=
rb.activityGuid;if(this.lineageTaskPane.isVisible){if(9===Aa){e.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!Pa&&16!==Aa&&18!==Aa&&30!==Aa){this.lineageTaskPane.z1c();return}}vb.a.od(this.$)||(this.yMb.start(),this.t7&&(lb.b().KA(this.yMb.id,this.t7.id,"actions","actions"),this.t7.stop(),this.t7=null));this.lineageTaskPane.ehc||e.ULS.sendTraceTag(537155482,0,50,`LineageManager::ShowLineageTaskPane pane reopened by user via ${Pa?
Ab:Aa}`);this.uE=this.$.ea.Je;this.g3a=null;if(Pa)Pa=Nb.r(this.gridView.ha.sa.selectedRanges,this.$),this.g3a=Object(X.a)(new Oc,{rangeList:Ab.toString()===Ha.a.p4f?this.M4a(Pa.Ranges):null,sheetName:Pa.SheetName});else if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")&&rb.sheetName&&rb.gridLocation){let Lb;({range:Lb}=Nb.Z(rb.gridLocation,rb.sheetName)).returnValue?this.g3a=Object(X.a)(new Oc,{rangeList:this.M4a([Nb.j(Lb)]),sheetName:rb.sheetName}):
e.ULS.shipAssertTag(512266262,0,!1,"Blue dot sheetName/gridLocation is not valid.")}vb.a.od(this.$)&&this.lineageTaskPane.ehc?this.lineageTaskPane.xrj(this.dFb):this.MF.createLineageTaskPane(this.dud,this.g3a,this.activityGuid);this.lineageTaskPane.qg(!0);this.$.fd(-71295319,-1,0,null)}lineageHidePreviousHistory(){var Pa={["paneVisible"]:this.lineageTaskPane.isVisible};oa.a.sendTelemetryEvent(Object(X.a)(new ac.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:Oa.a.Sj(Pa)}));
Pa=(Ab,Aa,rb)=>fb(this.$.pa.va,Ab,Aa,rb,null);W.EwaSettings.$b()?this.$.userOperationManager.Wb(new jb.a(1018,0,Pa,64),null):this.$.userOperationManager.Wb(new Ia.a(1018,0,Pa,0),null);this.lineageTaskPane.isVisible||this.Y4f(!1,null,4,void 0)}Vai(){const Pa=Object(X.a)(new qc,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,
onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,onDegradedCardGiveFeedbackButtonClicked:this.onDegradedCardGiveFeedbackButtonClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest,areInGridHighlightsAvailable:this.areInGridHighlightsAvailable,areInGridHighlightsEnabled:this.areInGridHighlightsEnabled,onDisplayInGridHighlightsChanged:this.onDisplayInGridHighlightsChanged});
ea.a(()=>{this.MF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object(X.a)(new xb,{clientBatchSize:this.batchSize,filterableSheetList:this.R4a(),uiCulture:this.$.ya.UICultureTag,dataCulture:this.$.ya.DataCultureTag,logger:new D.a,lineageAppCallbacks:Pa}))})}Jfd(Pa){return Ab=>{if(Ab=Kb.a(Ab)?null:Ab.Result){var Aa={["CountOfActivities"]:Ab.ActivityList.length};Aa.WebRequestName=Pa;pb.b(this.$).Hd(Bb.a.ELi,Aa);Ab=Object(X.a)(new Gb,{activityList:this.lrc(Ab.ActivityList),
latestActivityId:Ab.LastSearchedActivityId,oldestActivityId:Ab.FirstSearchedActivityId,serverMessageCode:Ab.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Ab.EcmaLastSearchedDate),serverFirstActivityId:Ab.ServerFirstActivityId,serverLastActivityId:Ab.ServerLastActivityId,showLoadPrevious:Ab.ShowLoadPrevious,eolCorrelationId:Ab.EolCorrelationId,eolDateHideHistory:new Date(Ab.EolDateHideHistory),eolPersonHideHistory:this.pwb(Ab.EolPersonHideHistory)});this.MF.onLineageActivitiesResponse(Ab)}else e.ULS.shipAssertTag(537155477,
0,!!Ab,"LineageManager."+Pa+" returned null response.")}}TLj(Pa){return Jb.e(Pa.Ranges)&&!Pa.SheetName?null:Object(X.a)(new Oc,{rangeList:this.M4a(Pa.Ranges),sheetName:Pa.SheetName})}M4a(Pa){const Ab=[];for(const Aa of Pa)Pa=Object(X.a)(new wc,{firstCol:Aa.FirstColumn,firstRow:Aa.FirstRow,lastRow:Aa.LastRow,lastCol:Aa.LastColumn}),Ab.push(Pa);return Ab}cMj(Pa){if(!Pa)return null;const Ab={};Ab.Ranges=this.Hgd(Pa.rangeList);Ab.SheetName=Pa.sheetName;return Ab}Hgd(Pa){const Ab=[];if(Jb.e(Pa))return Ab;
for(const Aa of Pa)Pa={},Pa.FirstColumn=Aa.firstCol,Pa.FirstRow=Aa.firstRow,Pa.LastRow=Aa.lastRow,Pa.LastColumn=Aa.lastCol,Ab.push(Pa);return Ab}o7h(Pa){(Pa=this.$.xa.getItemByName(Pa))&&Pa.visible&&Pa.activate(!0)}D9e(Pa,Ab){const Aa=[];for(var rb of Ab)Ab={},Ab.FirstColumn=rb.firstCol,Ab.FirstRow=rb.firstRow,Ab.LastRow=rb.lastRow,Ab.LastColumn=rb.lastCol,Aa.push(Nb.D(Ab));rb=Aa.length-1;Ab=Aa[rb].topLeft;qa.g(this.$).rZ(Aa,rb,Pa,null,Ab,null,null,3,ha.a.Ksi,void 0,void 0,void 0,!0)}B7i(){this.MF&&
this.lineageTaskPane.isVisible&&(this.uE=this.$.ea.Je,this.MF.onRefreshRequired())}rCg(){this.lineageTaskPane.kM(this.onPaneClosed);this.lineageTaskPane.zE(this.Mz);this.$.ea.Vu(this.Vf);this.$.ea.rk(this.Wc);this.$.ea.jM(this.Lo);const Pa=this.$.xa;Pa.bY(this.yD);Pa.Oga(this.Woc);Pa.YFa(this.cza);Pa.iZa(this.Woc)}D$i(){this.$.ea.Sw(this.Vf);this.gridView.ha.IR(this.Vc);this.$.ea.Pk(this.Wc);this.$.ea.GR(this.Lo);const Pa=this.$.xa;Pa.V6(this.yD);Pa.Vma(this.Woc);Pa.VQa(this.cza);Pa.XIb(this.Woc)}onStaleActivitiesDetected(){this.MF.onStaleActivitiesDetected()}R4a(){const Pa=
this.$.xa.items,Ab=[];for(const Aa of Pa)Aa.visible&&!yb.e(Aa)&&Ab.push(Aa.sheetName);return Ab}PBj(){if(W.EwaSettings.ma(604)){var Pa=this.$.da.za(403);Pa&&Pa.disable();Pa=new O.a(-847286761,Ma.a.Gb,this.$.Kc,0,Ha.a.dW);this.$.Ka.Lb(Pa,{["InputMethod"]:Ma.a.Gb,CalloutName:5})}}lrc(Pa){const Ab=[];for(const Aa of Pa)Pa=Object(X.a)(new Cb,{activityId:Number.parseLocale(Aa.UserActivity.Id),activityGuid:Aa.Uid,activityType:Aa.UserActivity.Type,author:this.pwb(Aa.UserActivity.Person),sheetName:Aa.SheetName,
displayTimestamp:new Date(Aa.UserActivity.DisplayTimestamp),gridLocation:Aa.DisplayLocation,valueChanges:this.Q1i(Aa.LineageValueChangeList),isBulkEditOverflow:Aa.IsBulkEditOverFlow,rangeHighlightLocation:this.E1i(Aa.UserActivity.LocationList,Aa.UserActivity.Type),nestedActivityList:this.x1i(Aa.NestedActivityList),degradedCardTypeBits:Aa.DegradedCardTypeBits}),Ab.push(Pa);return Ab}E1i(Pa,Ab){if(!Pa)return e.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),
null;if(!Pa.length)return e.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;const Aa=[];var rb=[];let Lb="";21===Ab?rb.push(Pa[0]):rb=Pa;for(const oc of rb)switch(oc.Type){case 1:break;case 2:Lb=oc.SheetName;break;case 0:Pa=oc;if(!Pa.RangeList){e.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Lb=Pa.RangeList[0].SheetName;rb=[];21===Ab?rb.push(Pa.RangeList[0]):rb=Pa.RangeList;
for(const $c of rb)Pa=Object(X.a)(new wc,{firstCol:$c.FirstColumn,firstRow:$c.FirstRow,lastRow:$c.LastRow,lastCol:$c.LastColumn}),Aa.push(Pa);break;default:e.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ")}return Object(X.a)(new Oc,{sheetName:Lb,rangeList:Aa})}Q1i(Pa){const Ab=[];for(const Aa of Pa)Pa=Object(X.a)(new Ib,{hasNewValue:Aa.HasNewValue,hasOldValue:Aa.HasOldValue,newValue:Aa.HasNewValue?Aa.NewValue:null,oldValue:Aa.HasOldValue?
Aa.OldValue:null,cellLocation:Aa.CellLocation}),Ab.push(Pa);return Ab}x1i(Pa){return Pa?this.lrc(Pa):null}pwb(Pa){if(!Pa)return null;let Ab=null;W.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&d.AFrameworkApplication.fa.qa("IsUserProfilePictureResolutionEnabled")&&(Ab=this.orc.eIa(Pa.Email,Pa.Provider,d.AFrameworkApplication.qj,0));return Object(X.a)(new Ya,{id:Pa.Id,provider:Pa.Provider,displayName:Pa.DisplayName,email:Pa.Email,imageUrl:Ab})}}Object(b.a)(fc,
"LineageManager",null,[879,880,10]);class vc extends f.a{constructor(Pa){super();this.t7=this.lineageTaskPane=null;this.$=Pa;this.Eb()}oti(Pa){z.TaskExtensions.Aa(Pa,()=>{this.pb(this.$.da.za(366)||new fc(this.$,this.$.da,this.lineageTaskPane,this.t7))},this.$.la,3)}create(){this.t7=this.$.Jb.Bc("UserAction","LineagePaneSeenStopwatch");this.t7.start();const Pa=B.GetServiceTaskFactory.Sa(this.$.da,365,364,this.fb),Ab=hb.a(this.$),Aa=B.GetServiceTaskFactory.Sa(this.$.da,283,284,this.fb);z.TaskExtensions.Aa(z.TaskExtensions.Td([Pa,
Ab,Aa],this.$.la),()=>{this.lineageTaskPane=Pa.result;vb.a.od(this.$)||Ab.result.MQ(this.lineageTaskPane);this.oti(gb.c(Aa.result.ko.loadScript("cellLineage")))},this.$.la,3)}static ka(Pa){Pa.da.Ga(367,new vc(Pa))}}Object(b.a)(vc,"LineageManagerFactory",f.a,[]);var Cc=a(788),fd=a(223),od=a(13),Ub=a(108),Fc=a(260),$b=a(85),zc=a(236),Wc=a(19),yc=a(703);const pd=Ha.a.kAc+"LineageActivityPaneTitle",xd=Ha.a.Deb+"LineageActivityCloseButton";class Vb extends zc.a{constructor(Pa,Ab,Aa){super(Pa);this.dFb=
this.LAe=this.ie=null;this.eqd=!0;this.oq=0;this.Kp=!1;this.Ec=(rb,Lb)=>{Lb.fg||this.z1c()};this.jk=()=>{this.z1c();return!0};this.$=Ab;this.taskPaneManager=Aa;this.$.sk(this.Ec);na.a(this.$).di(this);vb.a.od(this.$)&&(this.isVisible=!1)}sP(Pa){this.get_events().addHandler("LineageTaskPaneRemove",Pa)}HR(Pa){this.get_events().removeHandler("LineageTaskPaneRemove",Pa)}zE(Pa){this.addHandler("LineageTaskPaneVisibilityChanged",Pa)}dG(Pa){this.removeHandler("LineageTaskPaneVisibilityChanged",Pa)}kM(Pa){this.get_events().addHandler("LineageTaskPaneClose",
Pa)}eO(Pa){this.get_events().removeHandler("LineageTaskPaneClose",Pa)}get isVisible(){return super.isVisible}set isVisible(Pa){super.isVisible!==Pa&&(super.isVisible=Pa,this.raiseEvent("LineageTaskPaneVisibilityChanged"))}get ehc(){return this.eqd}get Jf(){return this.isVisible}get hh(){return 15}get ee(){return P.a.Lsi}get $k(){return Wc.a.Ruh}get eN(){return Qb.a.instance.ga(1076)}get Ho(){return 300}get isResizable(){return!1}get nc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get titleText(){return Qb.a.instance.ga(1297)}get QB(){return this.taskPaneManager.eva(this.nc,
this.titleText,this.Ho,this.isResizable,()=>{this.isVisible=!0;this.dFb?this.dFb():e.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Ho)}JH(){}fq(){return this.Kp}ns(){return this.Kp}tR(){}FQ(){return!1}sj(){}Vj(){}dispose(){this.$&&(this.$.Gl(this.Ec),na.a(this.$).Tz(this));this.ie&&(fd.a.instance.Ba(od.a.click,this.ie,this.jk),Ub.KeyInputManager.instance.Hv(this.ie,this.LAe));this.ie=this.taskPaneManager=
this.$=null;super.dispose()}hg(Pa,Ab){if(!Ab){Pa=ka.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!Pa)return!1;ka.DOMElementExtensions.setFocus(Pa)}return!Ab}mh(Pa){return ka.DOMElementExtensions.xf(this.nc,Pa)}qg(Pa){this.Kp=Pa;const Ab=this.taskPaneManager;if(this.isVisible=Pa)this.$.frame.He.Yj("LineagePane"),this.eqd=!1;if(vb.a.od(this.$))Pa?Ab.v6("LineageTaskPane",this.QB):Ab.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.gA();const Aa=!!this.taskPaneManager.oh&&
15===this.taskPaneManager.oh.taskPane.hh;Pa&&0<Ab.PB.length&&(!Aa||Ab.isCollapsed)&&Ab.gG(this,!0)}this.$.$e()}CM(){var Pa=this.$.Cb;Pa=vb.a.od(this.$)?this.domElement:document.getElementById(Pa+Ha.a.hud);var Ab=this.gH();Pa.appendChild(Ab);Ab=yc.b("div","LineagePaneBodyId","LineageActivityBody");Pa.appendChild(Ab);this.yrj();return Ab}z1c(){this.$.frame.He.Yj(this.$.frame.He.eF||Fc.AFrame.zT);this.eqd=!0;this.qg(!1);this.raiseEvent("LineageTaskPaneClose")}xrj(Pa){this.dFb=Pa}yrj(){this.$.frame.He.Zj("LineagePane");
const Pa=this.$.frame.He.Ei("LineagePane");Pa.parent=Fc.AFrame.zT;Pa.sN=!0}gH(){const Pa=yc.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Ab=yc.b("h1","LineagePaneTitleId",pd);Ab.innerText=this.titleText;this.ie=Cc.a.qb("LineagePaneCloseButtonId",xd,Qb.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.ie.classList.add(d.AFrameworkApplication.isRtl?Ha.a.vaa:Ha.a.waa);fd.a.instance.ra(od.a.click,this.ie,this.jk);this.LAe=Ub.KeyInputManager.instance.Ds(this.ie,this.jk,$b.a.fi);Pa.appendChild(Ab);
Pa.appendChild(this.ie);return Pa}static ka(Pa,Ab){const Aa=Pa.Cb;let rb=document.getElementById(Aa+Ha.a.hud);rb||(rb=document.createElement("div"),rb.id=Pa.Cb+Ha.a.hud,rb.classList.add("LineageActivityPane"),vb.a.od(Pa)||document.getElementById(Aa+Ha.a.lR).appendChild(rb));return Pa.da.za(365)||Pa.da.Ga(365,new Vb(rb,Pa,Ab))}}Object(b.a)(Vb,"LineageTaskPane",zc.a,[872,10,420,107]);class Uc extends f.a{constructor(Pa){super();this.fh=this.Bi=null;this.$=Pa;this.Eb()}get AD(){this.Bi||(this.Bi=z.TaskExtensions.Aa(hb.a(this.$),
Pa=>{this.fh=Vb.ka(this.$,Pa.result)},this.la,3));return this.Bi}create(){const Pa=B.GetServiceTaskFactory.create(this.$.da,203,this.la,this.fb),Ab=B.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb);z.TaskExtensions.Aa(z.TaskExtensions.ts(z.TaskExtensions.Td([Pa,Ab],this.la),()=>this.AD,this.la),()=>{this.pb(this.fh)},this.la,3)}dispose(){this.fh=this.Bi=this.$=null;super.dispose()}static ka(Pa){Pa.da.Ga(364,new Uc(Pa))}}Object(b.a)(Uc,"LineageTaskPaneFactory",f.a,[]);class ud{constructor(Pa,
Ab){this.Kqd=!1;this.Vf=()=>{this.mbg()};this.$=Pa;W.EwaSettings.ma(604)&&this.$.ea.C8a&&!ud.rxb&&(Ab&&!Ab.$db||this.cWj(),ud.P7e?e.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):Ab&&!Ab.$db||this.jWj());e.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}dispose(){this.MJd();this.$=null;e.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")}disable(){ud.rxb||
(ud.rxb=!0,e.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.MJd()}jWj(){W.EwaSettings.ma(600)&&!this.$.isAnonymousUser()&&bb.i(this.$.pa.va,Pa=>{this.$?(Pa=Pa.Result,e.ULS.sendTraceTag(578557780,0,50,`CheckLineageWywaChanges service call succeeded, hasnewchanges = ${Pa}.`),ud.P7e=!0,Pa&&this.abg(0)):e.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},
()=>{e.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)}cWj(){W.EwaSettings.ma(599)&&!this.mbg()&&(this.$.ea.Vu(this.Vf),this.Kqd=!0)}mbg(){return this.$.ea&&this.$.ea.Eo&&this.$.ea.Eo.ShouldTriggerLineageCalloutOnMerge?(e.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.abg(1),!0):!1}abg(Pa){ud.rxb?e.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session"):
(ud.rxb=!0,e.ULS.sendTraceTag(578557776,0,50,`LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason ${Pa}.`),this.MJd(),W.EwaSettings.ma(480)&&(Pa=new O.a(-847286761,Ma.a.Gb,this.$.Kc,0,Ha.a.dW),this.$.Ka.Lb(Pa,{["CalloutName"]:4})))}MJd(){this.Kqd&&(this.Kqd=!1,this.$.ea.Sw(this.Vf))}}ud.rxb=!1;ud.P7e=!1;Object(b.a)(ud,"LineageTeachingCalloutTriggerManager",null,[529,10]);class Vc extends f.a{constructor(Pa){super();this.$=Pa;this.Eb()}create(){z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,
458,459,this.fb),Pa=>{const Ab=Pa.result;Pa=Object(ab.b)(this.$.da,403,()=>new ud(this.$,Ab));this.pb(Pa)},this.$.la,3)}static ka(Pa){Pa.da.Ga(402,new Vc(Pa))}}Object(b.a)(Vc,"LineageTeachingCalloutTriggerManagerFactory",f.a,[]);class yd extends f.a{constructor(Pa){super();this.$=Pa;this.Eb()}create(){z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,366,367,0),Pa=>{this.pb(Pa.result)},this.$.la,3)}static ka(Pa){Pa.da.Ga(500,new yd(Pa))}}Object(b.a)(yd,"LineageBlueDotManagerFactory",f.a,[]);
var Sd=a(875),Wd=a(79);class Hd{constructor(Pa,Ab){this.zh=Pa;this.Qu=Ab}BW(Pa,Ab,Aa,rb=null){return this.uih(Pa,rb,Lb=>this.zh.nnb(Lb,2,Aa,Ab,void 0,void 0,void 0,void 0,void 0,"2"))}uih(Pa,Ab,Aa){const rb=!!Ab&&""!==Ab;let Lb=Pa;rb&&(Lb=y.a.qT(Pa,"perfTag",Ab));const oc=new Date;return Sd.a.then(Aa(Lb),$c=>{const Fd=+new Date-+oc;if(!$c||!$c.Lg||!$c.Lg.data)return $c;rb&&$c.Lg.data.request&&this.knj($c.Lg.data.request.getResolvedUrl(),Ab,Fd);return $c})}knj(Pa,Ab,Aa){Pa=this.Qu.CWh(Pa);if(Pa.count&&
(Pa=Wd.last(Pa))){const rb={Message:"Request durations for activities calls."};rb.PerfTag=Ab;rb.CustomDuration=Aa;rb.PerformanceDuration=Pa.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(rb))}}}Object(b.a)(Hd,"CatchUpNetworkingWrapper",null,[770]);var le=a(242);class Le extends le.a{constructor(Pa,Ab){super(Pa,Ab)}Daa(){return 6}}Object(b.a)(Le,"GetActivityFeedRequest",le.a,[]);class Md extends le.a{constructor(Pa,Ab,Aa,rb,Lb,oc){super(Pa,Ab);this.ItemIds=null;this.ActivityStatesToReset=
this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=Aa;this.ActivityStatesToSet=rb;this.ActivityStatesToReset=Lb;this.ResetUnseenCount=oc}Daa(){return 7}}Object(b.a)(Md,"UpdateActivityFeedStateRequest",le.a,[]);var ke=a(384);class ve{constructor(Pa,Ab,Aa){this.$ce=Pa;this.KCa=Ab;this.aDa=Aa}getActivityFeed(Pa){return Sd.a.then(this.aDa.execute(new Le(this.KCa(),null),(Ab,Aa,rb)=>this.$ce.BW(Ab,Aa,rb,"ActivityFeed"),Pa),Ab=>{if(!Ab)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),
null;if(!Ab.Lg)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),null;if(!Ab.Lg.data)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!Ab.Lg.data.Xd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;Ab=ke.a.AIa(Ab.Lg.data.Xd);return Ab?Ab:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}lQj(Pa,Ab,Aa,rb){return Sd.a.then(this.aDa.execute(new Md(this.KCa(),
null,Pa,Ab,Aa,rb),(Lb,oc,$c)=>this.$ce.BW(Lb,oc,$c,"UpdateActivityFeedState"),null),Lb=>{try{return Lb.succeeded}catch(oc){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+oc.message),!1}})}}Object(b.a)(ve,"CatchUpRequestHandler",null,[769]);var ge=a(466);class we{constructor(Pa){this.jga=Pa;this.Pbe=new ge.a}tui(){this.gvi()}gvi(){if(this.jga){var Pa=Ab=>{this.Pbe.contains("CatchUpChangesFeedback")||(this.Pbe.add("CatchUpChangesFeedback"),Ab.logActivity("CatchUpChangesFeedback",
null))};this.jga.execute(Ab=>{window.setTimeout(()=>{Pa(Ab)},2E4)})}else e.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(b.a)(we,"FloodgateEventLogger",null,[]);var De=a(187);class ib{constructor(Pa){this.gvg=Pa}get duration(){return this.gvg.duration}}Object(b.a)(ib,"PerformanceResourceTimingWrapper",null,[]);class Yb{constructor(Pa){this.Qu=Pa}CWh(Pa){const Ab=new De.a;if(!this.Qu)return Ab;Pa=this.Qu.getEntriesByName(Pa,"resource");
if(!Pa)return Ab;for(const Aa of Pa)Ab.add(new ib(Aa));return Ab}}Object(b.a)(Yb,"PerformanceWrapper",null,[]);var pc=a(247);class Jc{constructor(){this.gb=null}get name(){return"Common.App.CatchUpActivity"}Wh(Pa){this.gb=Pa;this.gb.register(Hd,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").wc().Fc(()=>new Hd(d.AFrameworkApplication.yd,new Yb(window.performance)));this.gb.register(ve,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").wc().Fc(()=>
new ve(this.gb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>d.AFrameworkApplication.qj,new ke.a));this.gb.register(we,"Common.App.CatchUpActivity.FloodgateEventLogger").wc().Fc(()=>new we(this.gb.Ub("Common.ISystemInitiatedFeedback")))}init(){this.gb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.gb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){pc.a.instance.Gi(new Jc)}}Object(b.a)(Jc,"CatchUpActivityPackage",null,
[3,4]);class Xc{constructor(Pa,Ab){this.$=Pa;this.catchUpActivityManager=Ab}Lc(Pa,Ab){return this.catchUpActivityManager?-876699925===Ab?!this.catchUpActivityManager.fdf:!1:!0}executeCommand(Pa,Ab,Aa){Pa=!1;switch(Ab.command){case -876699925:Pa=this.catchUpActivityManager.vTi();break;case 950288339:return this.catchUpActivityManager.showHideInGridHighlights(Aa[Ha.a.q4f]),F.Task.Ta(!0)}return Pa?F.Task.Ta(!0):A.a(Ab.command)}Ac(Pa,Ab){return W.EwaSettings.ma(435)?-876699925===Ab.command||950288339===
Ab.command:!1}Oc(){return!1}}Object(b.a)(Xc,"CatchUpActivityCommandHandler",null,[164]);class M extends x.a{constructor(Pa){super(Pa)}vd(){this.$.da.Za(286,Pa=>{this.$c([new Xc(this.$,Pa)])})}static ka(Pa){x.a.Od(285,new M(Pa))}}Object(b.a)(M,"CatchUpActivityCommandHandlerFactory",x.a,[]);var $a=a(263),ob=a(518),Tb=a(86),Dc=a(82),ad=a(25);class ld{constructor(Pa){this.gi=Pa}doesContentExist(Pa){if(!Pa)return e.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),
!1;switch(Pa.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!Pa.navigationId)return e.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;const Ab={};Ab.NavigationId=atob(Pa.navigationId);return 32===this.gi.de(ad.a.OIa,2,Ab);default:return!1}}}Object(b.a)(ld,"CatchUpActivityContentManager",null,[771]);var md=a(820),Wb=a(1232);class Nc{constructor(Pa){this.$Eb=()=>{switch(this.pv.model.state){case 1:this.i5f(!0);break;case 0:this.HMb(!1);
break;case 2:case 3:this.HMb(!0);break;default:e.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+this.pv.model.state)}};this.xrg=Pa;this.pv.boe(this.$Eb);this.sz=[]}get pv(){return this.xrg}dispose(){this.pv.pRf(this.$Eb);this.sz=null}Wqj(Pa){this.sz.push(Pa)}IZg(){this.sz.length=0}i5f(Pa){for(const Ab of this.sz){Ab.className=md.a.CWg;const Aa=document.getElementById(`${Ab.id}-${Ha.a.nye}`);ka.DOMElementExtensions.setVisible(Aa,
Pa)}}HMb(Pa){for(const Ab of this.sz)Ab&&(Pa?Ab.className=2===this.pv.model.state?md.a.J4i:md.a.K4i:this.i5f(!1))}}Object(b.a)(Nc,"RangeCatchUpActivityView",null,[814,10]);var gd=a(22);class Gd extends Wb.a{constructor(Pa,Ab,Aa){super(Pa,Ab,Aa);this.gridView=qa.g(Pa);this.Jma=Ab}dispose(){this.gridView=null;super.dispose()}VEg(Pa){const Ab=this.dgb[0];Ab?Ab.Wqj(Pa):e.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+
this.Jma.activityId)}Hgj(){const Pa=this.dgb[0];Pa&&Pa.IZg()}dDg(Pa){this.Jma.addRange(Pa)}KLh(){if(3!==this.Jma.activityType)return null;e.ULS.shipAssertTag(537168003,0,1===this.Jma.fNb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");return Nb.D(this.Jma.fNb[0])}KKb(Pa){if(Pa){if(!this.Jma)return;this.ryd(this.Qhj())}super.KKb(Pa)}a5c(){const Pa=this.G4c();this.dgb.push(Pa)}G4c(){return new Nc(this)}ryd(Pa){Pa?Pa.SheetName?(this.gridView.ha.Qa.lH(null),
this.gridView.focus(),this.gridView.L5e(Pa,3,!1,ha.a.I4i)):e.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):e.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")}Qhj(){if(Jb.e(this.Jma.fNb))return e.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),
null;var Pa=this.$.xa.oa;e.ULS.shipAssertTag(537167970,0,!!Pa,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");Pa=this.bNj(Pa.sheetName,this.Jma.fNb);if(!Pa&&(Pa=this.j0h(this.Jma.fNb),!Pa))return null;const Ab={};Ab.SheetName=Pa.SheetName;Ab.FirstColumn=Pa.FirstColumn;Ab.FirstRow=Pa.FirstRow;Ab.LastColumn=Pa.FirstColumn;Ab.LastRow=Pa.FirstRow;return Ab}j0h(Pa){if(Jb.e(Pa))return null;let Ab=null;for(let rb=0;rb<Pa.length;rb++){var Aa=Pa[rb].SheetName;
if(!gd.a.equals(Aa,Ab,!1)&&(Ab=Aa,Aa=this.$.xa.getItemByName(Aa),null===Aa||void 0===Aa?0:Aa.visible))return Pa[rb]}return null}bNj(Pa,Ab){if(Ab)for(const Aa of Ab)if(gd.a.equals(Aa.SheetName,Pa,!1))return Aa;return null}}Object(b.a)(Gd,"RangeCatchUpActivityHighlightController",Wb.a,[]);var Zd=a(78);class xe extends Zd.a{constructor(Pa,Ab,Aa,rb){super();this.$=Pa;this.M2d=Ab;this.Qlg=Aa;this.mC=rb;this.state=0}get type(){return this.mC}get activityId(){return this.M2d}get activityType(){return this.Qlg}dispose(){this.M2d=
null;super.dispose()}}Object(b.a)(xe,"CatchUpActivityHighlightModelBase",Zd.a,[]);class Re extends xe{constructor(Pa,Ab,Aa,rb,Lb){super(Pa,Ab,Aa,rb);this.ranges=Lb;this.H7a=!1}get fNb(){this.H7a||(this.ranges.sort(Re.y3b),this.H7a=!0);return this.ranges}addRange(Pa){for(const Ab of Pa)this.ranges.push(Ab)}dispose(){this.ranges=null;super.dispose()}static y3b(Pa,Ab){if(!Pa.SheetName||!Ab.SheetName)return e.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;const Aa=Pa.SheetName.localeCompare(Ab.SheetName);return Aa?Aa:Pa.FirstColumn<Ab.FirstColumn||Pa.FirstColumn===Ab.FirstColumn&&Pa.FirstRow<Ab.FirstRow?-1:Pa.FirstColumn===Ab.FirstColumn&&Pa.FirstRow===Ab.FirstRow?0:1}}Object(b.a)(Re,"RangeCatchUpActivityHighlightModel",xe,[]);var Ue=a(341);class jf{constructor(){this.v2c=[];this.$Lb={};this.Kle={}}dispose(){this.Kle=this.$Lb=this.v2c=null}Mdj(Pa){qa.g(Pa).ob.Jn([24])}N6g(Pa,Ab,Aa){const rb={};for(const oc of Ab){if(!oc||Jb.e(oc.LocationList))continue;
Ab=[];const $c={},Fd=[];for(const Cd of oc.LocationList){if(!Cd){e.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+oc.Id);break}switch(Cd.Type){case 0:var Lb=Cd;let $d;"0"in $c?($d=$c["0"],$d.dDg(Lb.RangeList)):($d=new Gd(Pa,new Re(Pa,oc.Id,oc.Type,0,Lb.RangeList),Aa),Ab.push($d),$c["0"]=$d);for(const he of Lb.RangeList){Lb=new Ue.a(Nb.D(he),yb.d(Pa.xa.getItemByName(he.SheetName)));if(this.xxc(Lb)in this.$Lb)this.$Lb[this.xxc(Lb)].push($d);
else{let ue=[];ue.push($d);this.$Lb[this.xxc(Lb)]=ue}Fd.push(Lb);this.v2c.push(Lb)}break;default:e.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}e.ULS.shipAssertTag(537168011,0,!(oc.Id in rb),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+oc.Id);this.Kle[oc.Id]=Fd;rb[oc.Id]=Ab}this.f8g(Pa,this.v2c,this.$Lb);return rb}AZg(Pa){for(let Ab in Pa){const Aa=
Pa[Ab];for(const rb of Aa)rb.Hgj()}}xxc(Pa){return`${Pa.range}-${Pa.sheetId}`}f8g(Pa,Ab,Aa){this.AZg(Aa);qa.g(Pa).ob.Ww(Ab,[24],!0,(rb,Lb)=>{var oc=new Ue.a(rb.range,rb.sheetId);oc=this.xxc(oc);const $c=Aa[oc];if($c)for(const Fd of $c)Fd.VEg(Lb),rb.metadata=Fd;else e.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+oc)})}}Object(b.a)(jf,"CatchUpHighlightControllersCreator",null,[]);class Bf{constructor(){this.activityIds=
this.container=this.target=null;this.isSticky=!1;this.dirHint=0;this.activityNavigationManager=null}}Object(b.a)(Bf,"CreateIndicatorTooltipParameters",null,[]);class Ae{constructor(){this.clearSticky=!1}}Object(b.a)(Ae,"DismissIndicatorTooltipParameters",null,[]);class Qe{constructor(){this.target=null;this.isSticky=!1}}Object(b.a)(Qe,"UpdateIndicatorTooltipParameters",null,[]);class Je{constructor(Pa,Ab){this.$=Pa;this.gi=Ab}navigateToActivity(Pa){if(Pa.fromSummaryString)return Pa=new O.a(1834994092,
Ma.a.Gb,this.$.Kc,18,null),this.$.Ka.Lb(Pa),this.wCa(1);Pa=Pa.activity;if(W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")&&Pa&&1===Pa.type){var Ab=new O.a(1834994092,Ma.a.Gb,this.$.Kc,30,null);this.$.Ka.Lb(Ab,{["activityGuid"]:Pa.activityId,["sheetName"]:Pa.location.region,["gridLocation"]:Pa.location.subregion[0]});return this.wCa(1)}if(!this.Bei(Pa))return this.wCa(4);if(!this.Eni(Pa))return this.wCa(7);const Aa={};try{Ab=window.self.atob(Pa.navigationId);
if(!Ab)return this.wCa(5);Aa.NavigationId=Ab}catch(rb){return e.ULS.sendTraceTag(537168023,3012,10,`Exception thrown when trying to decode activity NavigationID: ${rb}`),this.wCa(5)}if(8===this.gi.de(ad.a.OIa,2,Aa))return this.gi.processAction(ad.a.G9a,2),this.wCa(2);Pa=32===this.gi.de(ad.a.N0a,2,Aa)?1:6;return this.wCa(Pa)}Bei(Pa){return Pa&&Pa.navigationId?!0:!1}Eni(Pa){switch(Pa.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}}wCa(Pa){return Promise.resolve(Pa)}}Object(b.a)(Je,
"CatchUpActivityNavigationManager",null,[772]);class se{constructor(Pa){this.QRa=this.j4b=this.Sea=null;this.y4={};this.yDa=null;this.Bkd=!1;this.$Eb=(Ab,Aa)=>{switch(Aa.state){case 0:case 1:3===Aa.eGd&&(this.C6h(),this.QRa=null);break;case 2:break;case 3:this.G6c();this.QRa=Aa.activityId;this.Czj();break;default:e.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Aa.state)}};this.Xl=()=>{this.xsb()};this.Vc=()=>{this.xsb()};
this.Bn=()=>{this.xsb()};this.qh=()=>{this.xsb()};this.h4f=(Ab,Aa)=>{this.Sea&&Aa.HH!==this.cka&&(Aa.isSticky&&this.T6b(!0),(Ab=this.rNj(Aa.HH))?(this.Sea.createActivityIndicatorTooltip(Object(X.a)(new Bf,{target:Aa.HH,container:Ab,activityIds:[Aa.activityId],isSticky:Aa.isSticky,dirHint:this.gridView.rtl?12:9,activityNavigationManager:W.EwaSettings.isChangeGateEnabled("OfficeVSO:6883957_InvokeEntryPointForClickingActivityIndicatorTooltip")?this.c2b:void 0})),Aa.isSticky?(this.cka=Aa.HH,e.ULS.sendTraceTag(51172352,
0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(this.gec=Aa.HH,e.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),this.Ggc||(this.gridView.view.Xs(this.RBc),this.gridView.Uu(this.RBc),this.Ggc=!0)):e.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.tJe=
(Ab,Aa)=>{this.T6b(Aa.chh)};this.RBc=()=>{this.Sea?(this.cka&&this.Sea.updateActivityIndicatorTooltip(Object(X.a)(new Qe,{target:this.cka,isSticky:!0})),this.gec&&this.Sea.updateActivityIndicatorTooltip(Object(X.a)(new Qe,{target:this.cka,isSticky:!1}))):e.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};this.$=Pa;this.gridView=qa.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.Xb;this.ha.GZb(this.Xl);this.ha.YG(this.Vc);
this.gridView.rC(this.Bn);this.Ya.Vk(this.qh);this.cka=this.gec=null;this.Ggc=!1;this.Lbd={};this.c2b=new Je(this.$,d.AFrameworkApplication.vb)}get Lle(){return this.Sea}set Lle(Pa){this.Sea=Pa}get excelCommentManager(){this.yDa||(this.yDa=this.$.da.za(65));return this.yDa}get hrb(){this.j4b||(this.j4b=new jf);return this.j4b}set hrb(Pa){this.j4b=Pa}dispose(){this.ha.ctc(this.Xl);this.ha.cG(this.Vc);this.gridView.MD(this.Bn);this.Ya.Ak(this.qh);this.CIe();this.Lbd=this.cka=this.gec=this.QRa=this.Ya=
this.ha=this.gridView=null}Aoj(Pa){this.CIe();if(!Jb.e(Pa)){e.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.y4=this.hrb.N6g(this.$,Pa,this)){Pa=this.y4;for(let Ab in Pa){const Aa=Pa[Ab];for(const rb of Aa)this.qNg(rb)}}this.hrb.Mdj(this.$)}}FMb(Pa){if(Pa&&this.Bkd)e.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(Pa||this.xsb(),
this.y4){const Ab=this.y4;for(let Aa in Ab){const rb=Ab[Aa];for(const Lb of rb)Lb.ZAj(Pa)}}}n7h(Pa){this.cka&&this.T6b(!0);this.G6c();if(Pa=this.y4[Pa.activityId])for(const Ab of Pa)Ab.KKb(!0);else e.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")}CIe(){if(this.y4){const Pa=this.y4;for(let Ab in Pa){const Aa=Pa[Ab];for(const rb of Aa)this.E$i(rb),rb.dispose()}}this.y4={};this.hrb.dispose();this.hrb=null}Czj(){if(this.excelCommentManager){var Pa=
this.y4[this.QRa];Pa&&0<Pa.length&&3===Pa[0].model.activityType&&((Pa=Pa[0])?this.excelCommentManager.fAj(Pa.KLh()):e.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}}C6h(){this.excelCommentManager&&this.excelCommentManager.ttb()}G6c(){if(this.QRa){const Pa=this.y4[this.QRa];if(Pa){for(const Ab of Pa)Ab.KKb(!1);this.QRa=null}else e.ULS.sendTraceTag(537168028,0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}}xsb(){this.G6c();
this.T6b(!0)}rNj(Pa){if(!Pa)return e.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;Pa=`${Pa.id}-${Ha.a.AWg}`;let Ab=this.Lbd[Pa];if(!Ab){if(!this.gridView.domElement)return e.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),null;Ab=document.createElement("Div");Ab.className=md.a.BWg;Ab.id=Pa;this.gridView.domElement.appendChild(Ab);this.Lbd[Pa]=Ab}return Ab}T6b(Pa){this.Sea&&
(this.Sea.dismissActivityIndicatorTooltips(Object(X.a)(new Ae,{clearSticky:Pa})),this.gec=null,Pa&&(this.cka=null),this.Ggc&&!this.cka&&(this.gridView.view.Zq(this.RBc),this.gridView.xy(this.RBc),this.Ggc=!1))}qNg(Pa){Pa.boe(this.$Eb);Pa.yFg(this.h4f);Pa.xFg(this.tJe)}E$i(Pa){Pa.pRf(this.$Eb);Pa.Naj(this.h4f);Pa.Maj(this.tJe)}}Object(b.a)(se,"CatchUpActivityHighlightManager",null,[789,10]);var cb=a(443);class Rb{}Object(b.a)(Rb,"GetRelevantActivitiesDataRequest",null,[]);class uc{constructor(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(b.a)(uc,"Activity",null,[]);class Sc{constructor(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(b.a)(Sc,"ActivityFeedItem",null,[]);class ub{constructor(){this.activityFeedItems=null}}Object(b.a)(ub,"ActivityFeedPayload",null,[]);class Zb{constructor(){this.lowWaterline=
this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(b.a)(Zb,"ActivityRequestPayload",null,[]);class Ec{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(b.a)(Ec,"Person",null,[]);class ed extends uc{constructor(){super();this.relationship=0}}Object(b.a)(ed,"TaskActivity",uc,[]);const Kd=(Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Pa.Na(1,oc);return bb.g(Pa,"GetLineageWywaAuthors",
oc,Ab,Aa,rb,Lb,4)},fe=(Pa,Ab,Aa,rb,Lb,oc,$c=null)=>{$c=Pa.Na(1,$c);$c.getRelevantActivitiesDataRequest=Ab;return bb.g(Pa,"GetRelevantActivitiesData",$c,Aa,rb,Lb,oc,0)};class be{constructor(Pa,Ab,Aa=!1){this.hgg=null;this.$=Pa;this.d2b=Ab;this.EGb=db.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.orc=db.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.U6a=Aa}requestWYWAActivities(){return this.U6a?new Promise((Pa,Ab)=>{Kd(this.$.pa.va,Aa=>{var rb;const Lb=Kb.a(Aa)?
null:Aa.Result;W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)?(Aa=null===(rb=null===Lb||void 0===Lb?void 0:Lb.WywaAuthors)||void 0===rb?void 0:rb.length,null!=Aa&&0<Aa&&z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,501,500,0),oc=>{oc.result.zAj().then($c=>{const Fd=$c.map(Cd=>({activityId:Cd.activityGuid,activityFeedItemId:null,type:1,actors:[{id:Cd.author.id,provider:Cd.author.provider,displayName:Cd.author.displayName,givenName:null,email:Cd.author.email,imageUrl:Cd.author.imageUrl,
color:null}],location:{type:105,region:Cd.sheetName,subregion:[Cd.gridLocation]},displayTimestamp:Cd.displayTimestamp,relevancy:null,navigationId:null,state:0,collectionId:null}));this.hgg=$c.map(Cd=>{const $d=Cd.rangeHighlightLocation.rangeList.map(he=>({Type:0,RangeList:[{SheetName:Cd.sheetName,FirstRow:he.firstRow,LastRow:he.lastRow,FirstColumn:he.firstCol,LastColumn:he.lastCol}]}));return{Id:Cd.activityGuid,Type:null,Person:null,DisplayTimestamp:null,LocationList:$d}});$c={activities:Fd,actors:Lb?
this.Tbc(Lb.WywaAuthors):null,hasMore:!1,highWaterline:be.hia,lowWaterline:be.hia,wywaWaterline:be.hia};Pa($c)},()=>{})},this.$.la,3)):(rb=Object(X.a)(new Zb,{activities:[],actors:Lb?this.Tbc(Lb.WywaAuthors):null,hasMore:!1,highWaterline:be.hia,lowWaterline:be.hia,wywaWaterline:be.hia}),Pa(rb))},()=>{e.ULS.sendTraceTag(537168022,0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");Ab(null)},null,null)}):Promise.resolve(be.j6b)}requestActivities(){return Promise.resolve(be.j6b)}requestRelevantActivities(){if(!this.$.ea.fc||
this.$.ea.v5a)return e.ULS.sendTraceTag(537168021,3012,15,`CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: ${this.$.ea.fc}, HasRaisedSessionEnded: ${this.$.ea.v5a}]`),Promise.resolve(be.j6b);const Pa=Object(X.a)(new Rb,{SetDaysBack:d.AFrameworkApplication.fa.qd("AppWaterlineOverrideDaysValue",0),SetTimestamp:d.AFrameworkApplication.fa.qd("AppWaterlineOverrideTimestampValue",0)});return new Promise((Ab,Aa)=>{fe(this.$.pa.va,Pa,rb=>{let Lb=
be.j6b;rb?Kb.a(rb)?(rb=V.a.xc(rb.Errors),e.ULS.sendTraceTag(578353159,3012,10,`CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: ${rb}`)):Lb=this.hWh(rb.Result):e.ULS.sendTraceTag(537168020,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");Ab(Lb)},rb=>{rb=Ob.a.ff(rb.data);rb=V.a.xc(rb);e.ULS.sendTraceTag(537168019,3012,10,`CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [${rb}]`);Aa(null)},
null,null)})}requestActivityFeed(){return gb.b(this.getActivityFeed()).then(Pa=>Object(X.a)(new ub,{activityFeedItems:this.RLj(Pa)}))}updateActivityState(Pa){return W.EwaSettings.ma(451)?Promise.resolve(!0):this.d2b?gb.b(this.d2b).then(Ab=>{var Aa,rb;return gb.b(Ab.lQj(Pa.itemIds,null!==(Aa=Pa.activityStatesToSet)&&void 0!==Aa?Aa:0,null!==(rb=Pa.activityStatesToReset)&&void 0!==rb?rb:0,Pa.resetUnseenCount))}):Promise.resolve(!1)}getActivityFeed(){return this.d2b?Sd.a.TWd(this.d2b,Pa=>Pa.getActivityFeed(null)):
F.Task.Ta([])}hWh(Pa){if(!Pa)return e.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object(X.a)(new Zb,{activities:[]});const Ab=this.Vag(Pa.NewActivities,2);Pa=this.Vag(Pa.OutstandingActivities,3);for(const Aa of Pa)Ab.push(Aa);return Object(X.a)(new Zb,{activities:Ab})}Vag(Pa,Ab=1){const Aa=[];if(!Pa||!Pa.length)return Aa;for(const rb of Pa)rb?(Pa=be.YLj(rb.Type),6===Pa||7===Pa||9===Pa||8===Pa?Aa.push(Object(X.a)(new ed,
{activityId:rb.Id,type:Pa,displayTimestamp:new Date(rb.DisplayTimestamp),navigationId:rb.NavigationId,actors:this.Tbc(rb.People),relevancy:Ab,relationship:this.XLj(rb.Relationship)})):Aa.push(Object(X.a)(new uc,{activityId:rb.Id,type:Pa,displayTimestamp:new Date(rb.DisplayTimestamp),navigationId:rb.NavigationId,actors:this.Tbc(rb.People),relevancy:Ab}))):e.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return Aa}XLj(Pa){switch(Pa){case 1:return 1;
case 2:return 2;case 3:return 3}e.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1}RLj(Pa){const Ab=[];for(const Aa of Pa)Pa=Object(X.a)(new Sc,{id:Aa.id,type:Aa.type,collectionId:Aa.collectionId,activityState:Aa.activityState,activityFeedItemPayload:Aa.activityFeedItemPayload,timestamp:Aa.timestamp}),Ab.push(Pa);return Ab}Tbc(Pa){const Ab=[];if(!Pa||!Pa.length)return Ab;for(const Aa of Pa)Aa&&Ab.push(this.pwb(Aa));return Ab}pwb(Pa){return Object(X.a)(new Ec,{id:Pa.Id,provider:Pa.Provider,
displayName:Pa.DisplayName,email:Pa.Email,imageUrl:this.orc.eIa(Pa.Email,Pa.Provider,d.AFrameworkApplication.qj,0),color:this.EGb.Thd(new cb.a(null,void 0,Pa.DisplayName),6)})}static YLj(Pa){switch(Pa){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return e.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}}}be.hia="<WywaWaterline>DefaultWaterline</WywaWaterline>";
be.j6b=Object(X.a)(new Zb,{activities:[],actors:[],hasMore:!1,highWaterline:be.hia,lowWaterline:be.hia,wywaWaterline:be.hia});Object(b.a)(be,"CatchUpActivityRequestManager",null,[773]);class me{constructor(Pa){this.$=Pa}shouldShowEmptyExperienceButton(){return this.$.ea.C8a?!0:!1}onButtonClick(){const Pa={["InputMethod"]:Ma.a.Gb};this.$.Ka.Lb(new O.a(1834994092,Ma.a.Gb,this.$.Kc,16,null),Pa)}getExplanationText(){const Pa=this.$.da.za(365);return Qb.a.instance.Va(Pa&&Pa.isVisible?650:649)}getCommandName(){return Qb.a.instance.ga(448)}}
Object(b.a)(me,"CatchUpEmptyExperienceBehaviorManager",null,[774]);const re=Pa=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+Pa)};class Xe{constructor(Pa,Ab=null){this.$=Pa;this.flyoutRibbonButton=Ab;na.a(this.$).di(this);this.hasFocus=!1}dispose(){na.a(this.$).Tz(this)}get nc(){return document.getElementById("catchUpFlyoutContainer")}get Jf(){return this.flyoutRibbonButton.Sef&&!this.hasFocus}get ee(){return P.a.S_c}hg(Pa,Ab){if(Ab)return!1;
Pa=document.getElementById("flyoutItem0");if(!Pa)return e.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;Pa.focus();this.hhh(Pa);return!0}mh(Pa){return this.nc?ka.DOMElementExtensions.xf(this.nc,Pa):!1}sj(){this.hasFocus=!0}Vj(){this.hasFocus=!1}hhh(Pa){if(Sys.Browser.agent===Sys.Browser.Firefox){var Ab=document.createEvent("KeyboardEvent");Ab.initKeyEvent(od.a.Qb,!0,!0,window.self,!1,!1,!1,!1,$b.a.iDc,0);Pa.dispatchEvent(Ab)}else Ab=document.createEvent("Events"),
Ab.initEvent(od.a.Qb,!0,!0),Ab.keyCode=$b.a.iDc,Ab.which=$b.a.iDc,Pa.dispatchEvent(Ab)}}Object(b.a)(Xe,"FlyoutFocus",null,[107,10]);var We=a(418);class ee{constructor(Pa){this.buttonClickedCallback=null;this.ljb=this.Dzb=!1;this.nDh=new Date;this.ZUe=Pa}dispose(){this.ljb=this.Dzb=!1}registerButtonClickedEvent(Pa){this.buttonClickedCallback&&e.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=Pa.buttonClickedCallback}onFlyoutInitialized(){this.Dzb&&
e.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const Pa=(new Date).getTime()-this.nDh.getTime();e.ULS.sendTraceTag(593601546,3012,50,`Time from retrieve activities to initialize Flyout: ${Pa}`);l.c(ad.a.EWg,!0,l.e,0,0,Pa);this.Dzb=!0;We.a.pC&&We.a.pC.updateCommandUI(!0)}logFlightTriggers(){}toggleCatchUpFlyout(){this.Dzb?this.buttonClickedCallback?this.buttonClickedCallback():e.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
e.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")}get Sef(){return this.ljb}onFlyoutVisibilityChanged(Pa){this.ljb!==Pa.flyoutIsVisible&&(this.ljb=Pa.flyoutIsVisible,We.a.pC&&We.a.pC.updateCommandUI(!0),this.ljb||this.ZUe&&this.ZUe.tui())}}Object(b.a)(ee,"FlyoutRibbonButton",null,[788]);var xc=a(522);class jd{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(b.a)(jd,"CatchUpConfiguration",null,[]);class Nd{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(b.a)(Nd,"SharedControllerFactoryParameters",null,[]);class Ld{constructor(Pa,Ab,Aa=null,rb=null){this.jHa=null;this.N7e=!1;this.bGf=Lb=>{W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&!$a.a.Fh(Lb.wywaActivities)&&2!==Lb.wywaActivities[0].type&&(this.iHa.Aoj(this.R_c.hgg),this.iHa.FMb(!0),this.iHa.n7h(Lb.wywaActivities[0]))};this.$=Pa;this.iHa=new se(this.$);this.u4d=new ld(d.AFrameworkApplication.vb,W.EwaSettings.ma(451));Pa=ob.a.xKj(db.a.instance.Ub("Common.App.CatchUpActivity.ICatchUpRequestHandler"));
this.Xlf=rb;this.R_c=new be(this.$,Pa,this.U6a());this.c2b=new Je(this.$,d.AFrameworkApplication.vb);this.emptyCatchUpBehaviorManager=new me(this.$);this.bti(Lb=>{this.eHi(Lb)},Ab);this.$ui();Ab=null;Aa||(Ab=db.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=Aa||new ee(Ab);this.flyoutFocus=new Xe(this.$,this.flyoutRibbonButton)}get fdf(){const Pa=this.flyoutRibbonButton.Dzb;Pa&&!this.N7e&&(e.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),
this.N7e=!0);return Pa}get Lfi(){return this.flyoutRibbonButton.Sef}dispose(){this.jHa&&this.jHa.getWywaEvent().removeListener(this.bGf);this.jHa=this.$=null;Tb.a.Ia(this.iHa);this.flyoutRibbonButton=this.flyoutFocus=this.u4d=this.c2b=this.R_c=this.iHa=null}vTi(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0}showHideInGridHighlights(Pa){this.iHa.FMb(Pa)}$ui(){e.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Bcf()&&e.ULS.sendTraceTag(526718752,
3012,50,"ActivityFeedData is enabled")}bti(Pa,Ab){re("ScriptDownload");z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,283,284,Ab),Aa=>{Pa(gb.c(Aa.result.ko.loadScript("catchUpActivity")))},this.$.da.la,3)}U6a(){return!!this.Xlf&&this.Xlf.U6a()&&this.$.ea.C8a}Bcf(){return W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)}eHi(Pa){z.TaskExtensions.Aa(Pa,()=>{ea.a(()=>{this.jHa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object(X.a)(new Nd,
{activityContentManager:Object(Dc.a)(771,this.u4d),activityNavigationManager:Object(Dc.a)(772,this.c2b),activityRequestManager:Object(Dc.a)(773,this.R_c),dataCulture:this.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Dc.a)(ee,this.flyoutRibbonButton),uiCulture:this.$.ya.UICultureTag,ulsLogger:new D.a,emptyCatchUpBehaviorManager:Object(Dc.a)(774,this.emptyCatchUpBehaviorManager)}))});this.iHa.Lle=this.jHa.getActivityIndicatorTooltipManager();xc.a(this.$);this.jHa.getWywaEvent().addListener(this.bGf);
re("InitializeCatchUpApp");this.jHa.initialize(Object(X.a)(new jd,{featuredActivityGroupsEnabled:!1,summaryStringEnabled:this.U6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:!0,activityFeedDataEnabled:this.Bcf()}))},this.$.la,3)}}Object(b.a)(Ld,"CatchUpActivityManager",null,[775,10]);class Za extends f.a{constructor(Pa){super();this.$=Pa;this.Eb()}create(){z.TaskExtensions.Aa(B.GetServiceTaskFactory.Sa(this.$.da,458,459,this.fb),Pa=>{const Ab=Pa.result;Pa=Object(ab.a)(this.$.da,
286,()=>new Ld(this.$,this.fb,null,Ab));this.pb(Pa)},this.$.la,3)}static ka(Pa){Pa.da.Ga(287,new Za(Pa))}}Object(b.a)(Za,"CatchUpActivityManagerFactory",f.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");c.a.Fa(va.ka);c.a.Fa(Ua.ka);c.a.Fa(v.ka);c.a.Fa(w.ka);nb.a.Qi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(()=>{c.a.Fa(Pa=>{Uc.ka(Pa);vc.ka(Pa);ma.ka(Pa);Vc.ka(Pa);W.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BlueDot",!1)&&yd.ka(Pa);Ca.ka(Pa)})})();Type.registerNamespace("Common.App.CatchUpActivity");Jc.main();(()=>{c.a.Fa(Pa=>{re("Begin");Za.ka(Pa);M.ka(Pa)})})()},984:function(n,C,a){a.d(C,"a",function(){return d});n=a(0);var c=a(164);C=a(1235);var b=a(761);class d extends C.a{constructor(f,e){super(f,e);e!==b.a.R9&&this.OFa(e);this.Fga(d.iterateNext);this.Fga(d.Exa);this.yUc(c.a.NUa);
this.yUc(c.a.OUa)}}d.iterateNext="IterateNext";d.Exa="IteratePrevious";d.tOb="ToggleShowChanges";d.setCurrentChangeCount="SetCurrentChangeCount";d.setTotalChangesCount="SetTotalChangesCount";d.wPa="OnVHDiffReady";Object(n.a)(d,"VersionHistoryMessenger",C.a,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.catchup.js.map/ceec743dddfb80e8fea09b8ebe58ef5d/EwaDSEsNext.catchup.js.map