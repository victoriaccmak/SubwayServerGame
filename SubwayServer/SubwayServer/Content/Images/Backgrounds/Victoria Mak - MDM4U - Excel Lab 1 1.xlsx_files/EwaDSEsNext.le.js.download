'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1231:function(n,C,a){n=a(0);var c=a(7),b=a(15),d=a(27),f=a(86),e=a(13),k=a(82),l=a(414),m=a(78),u=a(8),t=a(67),w=a(457);class r{constructor(ta,K){this.helpId=this.helpText=this.imageAltText=this.urlValue=this.longDescription=this.convertToDomainName=this.cardViewManager=null;this.$=K;this.parentElement=ta}Z5g(){const ta=this.$5g();w.a(this.$,243,242,0,K=>{this.cardViewManager=K;K.z4f(this.parentElement,2,ta)})}f9e(){this.cardViewManager&&
this.cardViewManager.FLa(-1,-1,this.parentElement)}$5g(){const ta={layoutId:"AutoDetectTooltip"};ta.description=this.longDescription;ta.convertToDomainName=this.convertToDomainName;ta.longDescription=this.longDescription;ta.urlValue=this.urlValue;ta.imageAltText=this.imageAltText;ta.helpText=this.helpText;ta.helpId=this.helpId;return ta}}Object(n.a)(r,"AutoDetectCardManager",null,[]);var v=a(31),y=a(211),x=a(30),B=a(223),z=a(19),A=a(53);class I extends m.a{constructor(ta,K){super();this.gd=na=>{if(na.Db.id===
this.PIa.firstChild.id){na=this.gue;const P={};P.Id=na.Nob;this.convertToLinkedEntityManager.i3c(P,!0,na);this.PIa.removeChild(this.PIa.firstChild);return!0}return!1};this.gue=ta;this.convertToLinkedEntityManager=K;this.PIa=document.createElement("div");this.PIa.className="clip16x16";this.zwa=String.format('<input type="image" id="{0}" class="{1}" src="{2}" alt="Convert To Linked Entities Column Header Button">',x.a.zg("autodetectid"+this.gue.left),z.a.n$c,A.a.Ue(11));this.PIa.innerHTML=this.zwa;
ta=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.ra(e.a.click,ta,this.gd)}get domElement(){return this.PIa}dispose(){if(this.PIa){const ta=document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv");B.a.instance.Ba(e.a.click,ta,this.gd)}super.dispose()}static get HTg(){return"clip16x16"}}Object(n.a)(I,"AutoDetectColumnHeaderButton",m.a,[]);var F=a(1),U=a(1087),X=a(11),T=a(21),G=a(165);class D extends m.a{constructor(ta,K){super();this.$=ta;this.gridView=
T.g(ta);this.convertToLinkedEntityManager=K;this.V1c=new G.a}dispose(){super.dispose()}mhh(ta){for(let K of this.gridView.Lha)for(let na of K){const P=na,ka=P.$n,pa=U.a(P.v4);this.YBg(ta,pa,ka);P.ZPd(pa)}}YBg(ta,K,na){if(K.length){var P=na.length;na[P-1]<ta.left||(na=X.HelperMethods.wx(new y.a(na),0,P,ta.left,X.HelperMethods.sD),0>na||!(K=K[na]))||(this.gridView.rtl?K.classList.add(v.a.hvh):K.classList.add(v.a.gvh),this.V1c.lb(ta.left)||this.V1c.add(ta.left,new I(ta,this.convertToLinkedEntityManager)),
ta=this.V1c.na(ta.left).domElement,!K.getElementsByClassName(I.HTg).length&&this.ODj(K)&&K.appendChild(ta))}}ODj(ta){const K=parseInt(ta.style.width,10),na=document.querySelector(".ewrch-col-cellsel")?"bold":"normal";ta=gridRenderer.CanvasRendererGlobals.measureTextWidth(ta.firstChild.innerHTML,D.I7g(na),!0,F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1));return 18.4<K-(K/2+ta/2)?!0:!1}static I7g(ta){return`${"normal"} ${"normal"} ${ta} ${"10pt"}/${"normal"} ${'"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif'}`}}
Object(n.a)(D,"AutoDetectColumnHeaderManager",m.a,[]);var J=a(423),L=a(24),H=a(65),R=a(145),Q=a(12),O=a(14),V=a(172),W=a(69);a.d(C,"a",function(){return da});class da extends m.a{constructor(ta,K,na,P){super();this.isMac=d.a.isMac;this.LYa=-1;this.o5b=null;this.wta=-1;this.tN=this.bjc=this.NTd=this.c_=this.hue=!1;this.DT=null;this.Dg=()=>{this.Kwa&&this.gridView&&this.HW()};this.Ec=()=>{this.ay()};this.gd=()=>{this.PHa();T.g(this.$).hg(!0,!1)};this.Tya=(pa,Na)=>{Na?(this.Hdg(this.o5b),this.Zdb()):
(pa=[29],this.gridView.ob.Pg(pa),this.gridView.ob.zi(null,pa),this.DT&&this.DT.f9e())};this.gj=()=>{this.b7a()&&this.Gh.hide();1===this.gridView.ha.Me&&this.HW()};this.oR=()=>{const pa=this.gridView.ha.Me;this.gridView.ha.sa.activeCell&&1===pa&&this.HW()};this.onKeyUp=pa=>this.YBb?this.c_?!1:17===pa.Ca.keyCode&&this.NTd?(this.tN?(this.Zdb(),this.uda()):this.CLb(),!0):!1:this.c_=!1;this.onKeyDown=pa=>{if(!this.YBb)return this.c_=!1;this.NTd=!1;this.c_=pa.ctrlKey;switch(pa.Ca.keyCode){case 27:return this.tN?
(this.Tya(null,!1),this.uda()):this.DT&&(this.DT.f9e(),this.CLb()),!0;case 13:if(this.tN)return this.tN=!1,this.PHa(),!0;break;case 17:return this.NTd=!0}return!1};const {AutoDetectActionButton:ka}=a(1337);this.$=ta;this.Oob=F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AutoDetectRichTooltip",!1);K||b.ULS.sendTraceTag(537166983,0,15,"AutoDetectManager: SVG icons are enabled, but svgIconProvider is null");this.convertToLinkedEntityManager=P;P.SGb();this.Gh=new ka(ta,K,this.gd,na,
"");this.jOg=new D(this.$,P);this.gridView=T.g(this.$);this.gridView.ha.uT(this.Dg);this.gridView.Xb.cZa(this.Dg);this.gridView.Uu(this.oR);ta.sk(this.Ec);ta.LA(this.gj);this.gridBlockManager=Object(k.a)(425,this.gridView.Ea);this.Pq=ta.frame.Jt;this.HW()}get nc(){return this.Gh.domElement(1)}get YBb(){const ta=this.Gh.domElement(da.Dea);return ta?Q.DOMElementExtensions.isVisible(ta):!1}get Kwa(){return this.$.isEditMode&&F.EwaSettings.ma(135)&&F.EwaSettings.ma(138)&&(new R.a(this.$.xa)).wi?!1:-1!==
this.wta}dispose(){this.gridView&&this.gridView.ha.IR(this.Dg);if(this.$){const ta=this.$;ta.Gl(this.Ec);ta.LD(this.gj);T.g(ta).xy(this.oR)}f.a.Ia(this.Gh);this.Pq=this.$=this.gridView=this.Gh=null;super.dispose()}ay(){this.Tya(null,!1);this.LYa=-1;this.Gh.hide();this.QOj();this.tN=!1}uda(){this.Gh.getButton(da.Dea).gcb();this.tN=!1}CLb(){this.Gh.getButton(da.Dea).MGb();this.Hdg(this.o5b);this.tN=!0;this.$.da.Za(211,ta=>{ta.sQa(O.a.instance.ga(1749))})}onAutoDetectUIShown(){if(this.Kwa&&-1!==this.LYa)this.convertToLinkedEntityManager.onAutoDetectUIShown()}kOg(ta){var K=
new L.Range(1===ta.top?1:ta.top-1,ta.left,ta.bottom,ta.right,!0,!1);K=this.gridView.getRangeInformation(K);for(const na of K)if(Object(l.a)(J.AutoDetectRange,na)&&this.Wfc(ta,!1,na))return!0;return!1}PHa(){if(this.Kwa&&-1!==this.LYa){this.Gh.getButton(da.Dea).MGb();var ta={};ta.Id=this.wta;ta.StringId=null;this.convertToLinkedEntityManager.i3c(ta,!0,this.o5b);b.ULS.sendTraceTag(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)");ta=[Object(c.a)(new W.a,{name:"Domain",
int64:this.wta})];V.a("AssistedAutoConvertMenuConvertClicked",void 0,void 0,ta);this.wta=-1}}eKh(){let ta=O.a.instance.ga(1745);if(-1!==this.wta){ta+=" ";try{ta+=this.convertToLinkedEntityManager.sBb(this.wta.toString())}catch(K){b.ULS.sendTraceTag(537166982,0,10,`AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain ${this.wta}`)}}ta+=" ";return ta=this.Oob?ta+O.a.instance.ga(1748):ta+O.a.instance.ga(this.isMac?1747:1746)}Zdb(){this.Oob&&(this.DT||(this.DT=new r(this.nc,
this.$),this.DT.convertToDomainName=O.a.instance.ga(1750),this.DT.urlValue="https://support.content.office.net/en-us/media/758743e7-a2ca-42db-9f43-a45b05b1b077.png",this.DT.imageAltText=O.a.instance.ga(1752),this.DT.helpId="HID_DataTypes_Wolfram",this.DT.helpText=O.a.instance.ga(1751)),this.DT.longDescription=this.convertToLinkedEntityManager.IXd(this.LYa.toString()),this.DT.Z5g())}Wfc(ta,K,na){if((new L.Range(na.top,na.left,na.bottom===u.a.eh?na.bottom:na.bottom+1,na.right,!0,!1)).Bd(ta)){if(K){if(na&&
na.Nob!==this.LYa){this.LYa=na.Nob;ta=na.Nob.toString();K=this.Oob?"":this.convertToLinkedEntityManager.IXd(ta);const P=this.convertToLinkedEntityManager.b8h(ta);this.Gh.Ofb(this.convertToLinkedEntityManager.sBb(ta),K,P,da.Dea)}this.wta=na.Nob;this.o5b=na}return!0}return!1}HW(){if(this.convertToLinkedEntityManager){var ta=this.gridView.ha.Me;if(this.gridBlockManager&&this.gridBlockManager.xjd){var K=this.gridView.ha.sa.activeCell,na=!this.gridBlockManager.es(K),P=this.gridView.getRangeInformation(this.gridView.mi);
for(const ka of P)if(Object(l.a)(J.AutoDetectRange,ka))switch(P=ka,P.KYg){case 3:if(this.Wfc(K,!0,P)){if(1!==ta||na){this.ay();return}b.ULS.sendTraceTag(537166981,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.aJd();this.Gh.XAa(K,this.Tya);this.hue||(this.hue=!0,this.onAutoDetectUIShown());return}break;case 2:case 1:(F.EwaSettings.ma(471)||F.EwaSettings.ma(472))&&this.jOg.mhh(P);break;default:b.ULS.sendTraceTag(537166980,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (Invalid LinkedEntityClassifierTrigger used)")}}this.ay()}}Hdg(ta){const K=
[29];this.gridView.ob.zi(ta,K);this.gridView.ob.Jn(K)}b7a(){return this.$.ea.isNamedObjectViewMode&&H.f(this.$.oa)}aJd(){this.Oob&&!this.bjc&&this.Pq&&(this.Pq.Dt(e.a.Qb,this.$.domElement,this.onKeyDown,!0),this.Pq.Dt(e.a.Ed,this.$.domElement,this.onKeyUp,!0),this.bjc=!0)}QOj(){this.Oob&&this.bjc&&this.Pq&&(this.Pq.Mt(e.a.Qb,this.$.domElement,this.onKeyDown,!0),this.Pq.Mt(e.a.Ed,this.$.domElement,this.onKeyUp,!0),this.bjc=!1)}static get Dea(){return 1}static kMh(ta){return O.a.instance.ga(1806)+t.a.space+
ta}}Object(n.a)(da,"AutoDetectManager",m.a,[])},1337:function(n,C,a){a.r(C);a.d(C,"AutoDetectActionButton",function(){return e});n=a(0);C=a(78);var c=a(1231),b=a(53),d=a(14),f=a(21);class e extends C.a{constructor(k,l,m,u,t){super();this.$=k;this.uo=u.V4b(k,l,m,"",b.a.Ue(11),t,"AutoDetectPointerDown",d.a.instance.ga(1806)+"...")}get rz(){return this.uo.rz}dispose(){this.uo.dispose();this.$=null;super.dispose()}domElement(k){return this.uo.domElement(k)}getButton(k){return this.uo.getButton(k,!1)}Ofb(k,
l,m,u){this.uo.wUa(c.a.kMh(k),l,u);this.uo.Deg(m,l,u)}XAa(k,l){const m=f.g(this.$),u=m.ib.Oi(k);k=m.dg(k,u);const t=m.Hf(u).wm;if(k&&0<=k.x&&0<=k.y&&t.width>k.width+160){let w=k.bottomRight.x+this.rz,r=k.topLeft.y+this.rz,v=!1;w+160>t.bottomRight.x&&(w=k.topLeft.x-this.rz,v=!0);if(r<t.topLeft.y+this.rz){if(m.ib.cUa){this.hide();return}r=t.topLeft.y+this.rz}this.uo.W7b(l,u);this.Jp(w,r,m.rtl,u,v)}else this.hide()}Jp(k,l,m,u,t){this.uo.Jp(k,l,m,u,!1,t)}hide(){this.uo.hide()}}Object(n.a)(e,"AutoDetectActionButton",
C.a,[])},1445:function(n,C,a){a.r(C);n=a(0);var c=a(694),b=a(15),d=a(5),f=a(77),e=a(37),k=a(1),l=a(183),m=a(21),u=a(172);class t{constructor(H,R){this.$=R;this.convertToLinkedEntityManager=H}Lc(H,R){switch(R){case -1203788282:case 48568533:case -1662108744:return H=m.g(this.$),R=this.convertToLinkedEntityManager.lAi||7E3,(null===H||void 0===H?0:H.ha)&&H.ha.sa.Xc.dH>R?!0:!1;default:return!1}}executeCommand(H,R,Q){H=e.TaskExtensions.ak();R=R.command;switch(R){case -1203788282:this.convertToLinkedEntityManager.s4g(Q[f.a.Qc].toString());
break;case 311599363:this.convertToLinkedEntityManager.convertLinkedEntityToText();break;case 439914789:this.convertToLinkedEntityManager.refreshLinkedEntitiesInRange();break;case 2127195269:this.convertToLinkedEntityManager.launchDisambiguationPaneForSearch();break;case -1662108744:this.convertToLinkedEntityManager.launchLinkedEntityDataTypeSelectorPane(Q[f.a.Qc].toString());break;case 1266950951:this.convertToLinkedEntityManager.tri();break;case 49813714:this.convertToLinkedEntityManager.convertToLinkedEntityFromAutoDetect();
break;case -1081442996:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.fMe();break;case 1702917262:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.showHelpArticle(d.a.gQj);break;case -90814711:k.EwaSettings.ma(648)&&this.convertToLinkedEntityManager.showUntrustedImageBusinessBarIfNecessary();break;case 48568533:case -1027730316:if(48568533===R||Q[f.a.Jlf]&&"ConvertToLinkedEntityGallery"===Q[f.a.Jlf].toString())b.ULS.sendTraceTag(559982275,0,50,"ConvertToLinkedEntityCommandHandler.ExecuteCommand() - Expanding data types preview gallery"),
u.a("ExpandDataTypeGallery");break;default:H=l.a(R)}return H}Ac(H,R){switch(R.command){case -1203788282:case 439914789:case 2127195269:case 49813714:return k.EwaSettings.ma(130);case -1081442996:case 1702917262:case -90814711:return k.EwaSettings.ma(648);case 48568533:case -1027730316:case -1662108744:case 311599363:case 1266950951:return!0;default:return!1}}Oc(H,R,Q){return"PopulateConvertToLinkedEntityMenu"===R&&k.EwaSettings.ma(130)?this.convertToLinkedEntityManager.Oc(H,R,Q):!1}}Object(n.a)(t,
"ConvertToLinkedEntityCommandHandler",null,[164]);var w=a(457);class r extends c.a{constructor(H){super(H)}vd(){w.a(this.$,271,272,this.fb,H=>{this.$c([new t(H,this.$)])})}static ka(H){c.a.Od(273,new r(H))}}Object(n.a)(r,"ConvertToLinkedEntityCommandHandlerFactory",c.a,[]);C=a(222);var v=a(759),y=a(50),x=a(415),B=a(699);class z extends C.a{constructor(H){super();this.$=H;this.Eb()}create(){const H=y.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.fb),R=y.GetServiceTaskFactory.Sa(this.$.da,
5,4,this.fb),Q=y.GetServiceTaskFactory.Sa(this.$.da,388,387,this.fb);if(this.$.Tl)e.TaskExtensions.Aa(e.TaskExtensions.Td([H,R,Q],this.la),()=>{const O=Object(B.a)(this.$.da,271,()=>new v.ConvertToLinkedEntityManager(this.$,H.result,Q.result,null,null,R.result));this.pb(O)},this.$.la,3);else{const O=y.GetServiceTaskFactory.Sa(this.$.da,257,258,this.fb),V=x.a(this.$);e.TaskExtensions.Aa(e.TaskExtensions.Td([H,O,V,R,Q],this.la),()=>{this.pb(this.$.da.za(271)||new v.ConvertToLinkedEntityManager(this.$,
H.result,Q.result,O.result,V.result,R.result))},this.$.la,3)}}static ka(H){H.da.Ga(272,new z(H))}}Object(n.a)(z,"ConvertToLinkedEntityManagerFactory",C.a,[]);var A=a(236),I=a(259),F=a(33),U=a(246),X=a(12),T=a(703);const G=a(19).a.Puh;class D extends A.a{constructor(H,R,Q){super(H);this.oq=0;this.Kp=!1;this.Ec=()=>{this.qg(!1)};this.$=R;this.taskPaneManager=Q;I.a(R).di(this);this.$.sk(this.Ec);F.a.od(this.$)&&(this.isVisible=!1)}sP(H){this.get_events().addHandler("EnrichmentTaskPaneRemoved",H)}HR(H){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",
H)}zE(H){this.addHandler("EnrichmentTaskPaneVilibilityChanged",H)}dG(H){this.removeHandler("EnrichmentTaskPaneVilibilityChanged",H)}uHg(H){this.addHandler("EnrichmentTaskPaneOnFocus",H)}qcj(H){this.removeHandler("EnrichmentTaskPaneOnFocus",H)}get isVisible(){return super.isVisible}set isVisible(H){super.isVisible=H;this.raiseEvent("EnrichmentTaskPaneVilibilityChanged")}get Jf(){return this.isVisible}get ee(){return U.a.emh}get hh(){return 10}get $k(){return G}get eN(){return this.titleText}get titleText(){return"Enrichment"}get Ho(){return 300}get isResizable(){return!1}get nc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get QB(){return this.taskPaneManager.eva(this.nc,
this.titleText,this.Ho,this.isResizable,()=>{this.isVisible=!0},()=>{this.isVisible=!1},()=>{this.isVisible=!0},()=>{this.isVisible=!1},this.Ho)}JH(){}fq(){return this.Kp}ns(){return this.Kp}tR(){}dispose(){this.$&&this.$.Gl(this.Ec);this.taskPaneManager=this.$=null;super.dispose()}hg(H,R){R||this.raiseEvent("EnrichmentTaskPaneOnFocus");return!R}mh(H){return X.DOMElementExtensions.xf(this.nc,H)}sj(){}Vj(){}qg(H){this.Kp=H;const R=this.taskPaneManager;this.isVisible=H;F.a.od(this.$)?H?this.taskPaneManager.v6("EnrichmentTaskPane",
this.QB):this.taskPaneManager.hideTaskPane("EnrichmentTaskPane"):(H&&0<R.PB.length&&(!R.oh||10!==R.oh.taskPane.hh||R.isCollapsed)&&R.gG(this,!0),R.gA());H||(m.g(this.$).hg(!0,!1),this.$.$e())}FQ(){return!1}static ka(H,R){var Q=H.Cb;let O=document.getElementById(Q+d.a.DMe);O||(O=T.a("div",H.Cb+d.a.DMe,"cui-taskpane"),F.a.od(H)||(Q=document.getElementById(Q+d.a.lR),void 0!==Q&&null!==Q?Q.appendChild(O):b.ULS.sendTraceTag(537166720,0,10,`EnrichmentTaskPane.Attach: couldn't find novTaskPaneBodyDiv. IsAppUnloading: ${H.kD}`)));
Q=H.da;return Q.za(257)||Q.Ga(257,new D(O,H,R))}}Object(n.a)(D,"EnrichmentTaskPane",A.a,[423,10,420,107]);class J extends C.a{constructor(H){super();this.fh=this.Bi=null;this.$=H;this.Eb()}get AD(){this.Bi||(this.Bi=e.TaskExtensions.Aa(x.a(this.$),H=>{this.fh=D.ka(this.$,H.result)},this.la,3));return this.Bi}create(){const H=y.GetServiceTaskFactory.create(this.$.da,203,this.la,this.fb),R=y.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb);e.TaskExtensions.Aa(e.TaskExtensions.ts(e.TaskExtensions.Td([H,
R],this.la),()=>this.AD,this.la),()=>{this.pb(this.fh)},this.la,3)}dispose(){this.fh=this.Bi=this.$=null;super.dispose()}static ka(H){H.da.Ga(258,new J(H))}}Object(n.a)(J,"EnrichmentTaskPaneFactory",C.a,[]);var L=a(9);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Enrichment");(()=>{L.a.Fa(H=>{J.ka(H);z.ka(H);r.ka(H)})})()},759:function(n,C,a){a.r(C);var c=a(0),b=a(15),d=a(86),f=a(263),e=a(4),k=a(30),l=a(814),m=a(137),u=a(83),t=a(82),w=a(38),r=a(19),v=a(5),y=a(160),x=a(1231),B=
a(1234),z=a(173),A=a(558),I=a(344),F=a(61);const U=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"GetRichDataClassificationLabels",Ya,ac,Gb,wb,qc,4)},X=(lb,ac,Gb,wb,qc,Ya,xb,wc,Oc=null)=>{Oc=lb.Na(1,Oc);Oc.selectedRanges=ac;Oc.domainId=Gb;Oc.autodetect=wb;return F.g(lb,"ConvertToLinkedEntity",Oc,qc,Ya,xb,wc,4)},T=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"OnAutoDetectUIShown",Ya,ac,Gb,wb,qc,4)},G=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"GetLinkedEntityMetadata",
Ya,ac,Gb,wb,qc,4)},D=(lb,ac,Gb,wb,qc,Ya,xb=null)=>{xb=lb.Na(1,xb);xb.selectedRanges=ac;return F.g(lb,"ConvertLinkedEntityToText",xb,Gb,wb,qc,Ya,4)},J=(lb,ac,Gb,wb,qc,Ya,xb=null)=>{xb=lb.Na(1,xb);xb.selectedRanges=ac;return F.g(lb,"RefreshLinkedEntitiesInRange",xb,Gb,wb,qc,Ya,4)},L=(lb,ac,Gb,wb,qc,Ya,xb,wc,Oc,Cb,Ib=null)=>{Ib=lb.Na(1,Ib);Ib.selectedRanges=ac;Ib.isChangeObject=Gb;Ib.isFloodgateEnabled=wb;Ib.isStarterData=qc;Ib.starterDataDomainId=Ya;return F.g(lb,"GetDataSelectorPaneData",Ib,xb,wc,
Oc,Cb,4)},H=(lb,ac,Gb,wb,qc,Ya,xb,wc=null)=>{wc=lb.Na(9,wc);wc.activeCell=ac;wc.selectionIndex=Gb;return F.g(lb,"SelectLinkedEntityForDisambiguation",wc,wb,qc,Ya,xb,4)},R=(lb,ac,Gb,wb,qc,Ya,xb,wc,Oc,Cb,Ib,fc=null)=>{fc=lb.Na(1,fc);fc.searchCell=ac;fc.searchQuery=Gb;fc.isFloodgateEnabled=wb;fc.isStarterData=qc;fc.starterDataDomainId=Ya;fc.starterDataDomainIdString=xb;return F.g(lb,"LinkedEntitySearch",fc,wc,Oc,Cb,Ib,4)},Q=(lb,ac,Gb,wb,qc,Ya,xb,wc,Oc=null)=>{Oc=lb.Na(1,Oc);Oc.cell=ac;Oc.starterDataDomainId=
Gb;Oc.starterDataDomainIdString=wb;return F.g(lb,"InsertStarterDataTable",Oc,qc,Ya,xb,wc,4)},O=(lb,ac,Gb,wb,qc,Ya,xb,wc=null)=>{wc=lb.Na(1,wc);wc.activeCell=ac;wc.isBackward=Gb;return F.g(lb,"MoveToNextAmbiguousLinkedEntity",wc,wb,qc,Ya,xb,4)},V=(lb,ac,Gb,wb,qc,Ya,xb=null)=>{xb=lb.Na(9,xb);xb.activeCell=ac;return F.g(lb,"CancelSearchLinkedEntity",xb,Gb,wb,qc,Ya,4)},W=(lb,ac,Gb,wb,qc,Ya,xb,wc=null)=>{wc=lb.Na(1,wc);wc.selectedRanges=ac;wc.letyDomainId=Gb;return F.g(lb,"GetDataTypeSelectorData",wc,
wb,qc,Ya,xb,4)},da=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"GetErrorMessageForLinkedDataTypeRefresh",Ya,ac,Gb,wb,qc,4)},ta=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"GetHasUntrustedImageUrls",Ya,ac,Gb,wb,qc,4)},K=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"LinkedEntitiesEnableUntrustedImages",Ya,ac,Gb,wb,qc,0)},na=(lb,ac,Gb,wb,qc,Ya=null)=>{Ya=lb.Na(1,Ya);return F.g(lb,"LinkedEntityTryAutoRefresh",Ya,ac,Gb,wb,qc,0)};var P=a(84),ka=a(703),pa=a(788);class Na{}
Na.W7h="EnrichmentContentFrame";Na.width=320;Object(c.a)(Na,"EnrichmentConstants",null,[]);class Z{constructor(lb){this.messageType=0;this.messageType=lb}}Object(c.a)(Z,"EnrichmentResponseMessage",null,[]);class Ra extends Z{constructor(lb,ac){super(lb);this.messageContent=null;this.messageContent=ac}}Object(c.a)(Ra,"EnrichmentResponseMessageWithContent",Z,[]);class Da extends Ra{constructor(lb,ac,Gb){super(lb,ac);this.telemetryJson=null;this.telemetryJson=Gb}}Object(c.a)(Da,"EnrichmentResponseMessageWithContentAndTelemetryData",
Ra,[]);var Ba=a(260),ea=a(13),Y=a(94),ja=a(44),ca=a(85),ba=a(108),ua=a(41),wa=a(80),ia=a(27),xa=a(106),gb=a(695),va=a(25);class sa{constructor(lb,ac,Gb,wb,qc){this.gr=this.nk=this.z9d=this.y9d=this.Ov=this.Nu=null;this.hx=!1;this.Ii=lb;this.Yd=ac;this.eP=Gb;this.Zb=wb;this.La=qc;this.Xpa=ba.KeyInputManager.zl(ca.a.eCa,0)}get gMb(){return!0}get qtb(){return e.AFrameworkApplication.fa.Xa("EnrichmentPaneUrl")}dispose(){this.gMb&&this.gr&&(this.Ii.Ba(ea.a.click,this.gr,Object(P.a)(this,this.jk,"onClosePaneClick")),
this.Yd.Ba(ea.a.Ed,this.gr,Object(P.a)(this,this.sAf,"onKeyHide")));this.gr=null;this.Ov&&(this.vPj(),this.Ov.parentNode.removeChild(this.Ov),this.Ov=null);this.Zb.Ei("EnrichmentPaneId").Ck(this.Xpa)}show(lb,ac,Gb){this.Nu=lb;this.hx||(this.nk=this.i1a(),this.zda.appendChild(this.nk),this.F8i(),this.La.Nb(va.a.HAe,xa.a.frame,Object(P.a)(this,this.K2h,"handleEscapeKeyAction")),this.zSa(),this.hx=!0);this.Ov.src=this.qtb&&this.qtb.length?this.qtb+"?culture="+ac.market+"&appName="+ac.applicationName+
"&themeId="+ac.themeId+"&featuresBitMask="+ac.featuresBitMask:sa.guf;this.y9d=ac;this.z9d=Gb;this.Tdb()}pCc(lb,ac){lb=new Da(2,lb,ac);this.Dqc(lb)}zSa(){const lb=this.Zb.Ei("EnrichmentPaneId");lb.parent=Ba.AFrame.uOa;this.Ii.fnb("EnrichmentPaneId",this.nk);lb.bindAction(this.Xpa,va.a.HAe)}W_f(){if(this.Ov){Y.FocusManager.Boa(this.Ov.contentWindow);const lb=new Da(4,null,null);this.Dqc(lb)}}jk(){this.d3b();return!0}sAf(lb){lb=lb.Ca.keyCode;return lb===Sys.UI.Key.enter||lb===Sys.UI.Key.space?(this.d3b(),
!0):!1}d3b(){this.hide();if(this.Nu)this.Nu.onPaneClosed()}i1a(){const lb=ka.a("div","EnrichmentPaneId","EnrichmentPane");this.gMb&&lb.appendChild(this.h4c());this.Kai(lb);return lb}h4c(){const lb=ka.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),ac=ka.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle");ac.innerText=CommonUIStrings.l_EnrichmentPaneTitle;ac.title=CommonUIStrings.l_EnrichmentPaneTitle;const Gb=pa.a.qb("CloseEnrichmentPane","EnrichmentPaneCloseButton",
CommonUIStrings.l_Close,"ClosePaneGlyph_16x16x32",!1);this.Ii.ra(ea.a.click,Gb,Object(P.a)(this,this.jk,"onClosePaneClick"));this.Yd.ra(ea.a.Ed,Gb,Object(P.a)(this,this.sAf,"onKeyHide"));lb.appendChild(ac);lb.appendChild(Gb);this.gr=Gb;return lb}Kai(lb){this.Ov=ka.b("iframe","","EnrichmentFrame");lb.appendChild(this.Ov);this.Ov.id=Na.W7h;this.Ov.setAttribute("role","presentation")}F8i(){ja.a.addHandler(this.Ov,"load",Object(P.a)(this,this.Uzf,"onIFrameLoad"));ja.a.addHandler(this.Ov,"error",Object(P.a)(this,
this.Tnc,"onIFrameError"));$addHandler(window,"message",Object(P.a)(this,this.Vzf,"onIFrameMessage"))}vPj(){ja.a.removeHandler(this.Ov,"load",Object(P.a)(this,this.Uzf,"onIFrameLoad"));ja.a.removeHandler(this.Ov,"error",Object(P.a)(this,this.Tnc,"onIFrameError"));$removeHandler(window,"message",Object(P.a)(this,this.Vzf,"onIFrameMessage"))}hdh(){this.Ov.src=sa.guf}hide(){this.Zdc();this.hdh()}K2h(lb,ac,Gb){if(1!==Gb&&(this.hide(),this.Nu))this.Nu.onPaneClosed();return 32}Uzf(){}Tnc(){}Vzf(lb){lb=
lb.rawEvent;if(!this.Ov||-1!==this.Ov.src.indexOf(lb.origin)){try{var ac=ua.a(lb.data)}catch(Gb){return}if(!gb.c(ac.messageType)){lb=window.g_badCastCallback;window.g_badCastCallback=null;switch(ac.messageType){case 2:this.Dqc(new Da(1,ua.c(this.y9d),this.z9d));break;case 1:this.Dqc(new Ra(0,this.CIh()));break;case 3:this.Nu&&this.Nu.selectEntity(ac.messageContent);break;case 5:this.Nu&&this.Nu.zDb(ac.messageContent);break;case 8:this.Nu&&(ac=ua.a(ac.messageContent),0<ac.DomainId?this.Nu.fOd(ac.Query,
ac.TelemetryJson,ac.DomainId,ac.DomainIdString):this.Nu.searchEntity(ac.Query,ac.TelemetryJson));break;case 6:this.Nu&&this.Nu.cancelSearch();break;case 11:ac=ua.a(ac.messageContent);ac=sa.R4b("keydown","f6",ca.a.sEc,!0,!1,ac,!0,!1);this.Ov&&this.Ov.dispatchEvent(ac);break;case 12:if(ua.a(ac.messageContent).keyCode===ca.a.FL&&(ac=sa.R4b("keydown","esc",ca.a.FL,!0,!1,!1,!1,!1),this.Ov&&(this.Ov.dispatchEvent(ac),this.hide(),this.Nu)))this.Nu.onPaneClosed();break;case 13:this.Nu&&this.Nu.selectDataType(ac.messageContent);
break;case 14:this.Nu&&this.Nu.showHelpArticle(ac.messageContent);break;case 15:this.Nu&&this.Nu.showSurveyDialog(ac.messageContent);break;case 16:this.Nu&&(ac=ua.a(ac.messageContent),this.Nu.insertTable(ac.DomainId,ac.DomainIdString))}window.g_badCastCallback=lb}}}CIh(){return ua.c([2,1,3,5,8,6])}Dqc(lb){lb=ua.c(lb);this.Ov.contentWindow.postMessage(lb,wa.a.Oaa(this.qtb))}static R4b(lb,ac,Gb,wb,qc,Ya,xb,wc){ia.a.tv?(Ya=String.format("{0} {1} {2}",Ya?"Shift":"",xb?"Control":"",wc?"Alt":""),Ya.trim(),
Gb=document.createEvent("KeyboardEvent"),Gb.initKeyboardEvent(lb,wb,qc,window.self,ac,0,Ya,!1,"en-US")):(ac={},ac.keyCode=Gb,ac.ctrlKey=xb,ac.shiftKey=Ya,ac.altKey=wc,ac.bubbles=wb,ac.cancelable=qc,Gb=new KeyboardEvent(lb,ac));return Gb}}sa.guf="about:blank";Object(c.a)(sa,"EnrichmentPane",null,[484,10]);class ab extends sa{constructor(lb){super(e.AFrameworkApplication.ta.Iy,e.AFrameworkApplication.ta.Jt,e.AFrameworkApplication.ta.jea,e.AFrameworkApplication.ta.He,e.AFrameworkApplication.vb);this.taskPane=
lb;this.taskPane.uHg(this.W_f)}get zda(){return this.taskPane.nc}set zda(lb){this.taskPane.nc.innerHTML=lb.innerHTML}Tdb(){this.taskPane.isVisible||this.taskPane.qg(!0)}Zdc(){this.taskPane.qg(!1)}dispose(){this.taskPane&&(this.taskPane.qcj(this.W_f),this.taskPane=null);super.dispose()}}Object(c.a)(ab,"EnrichmentTaskPaneWrapper",sa,[]);class Ua{constructor(lb){this.Oy=null;this.pfa=lb}xri(lb,ac){this.Oy=lb;this.pfa&&this.pfa.show(this,ac,null)}pCc(lb,ac){this.pfa&&this.pfa.pCc(lb,ac)}Nxb(){this.pfa&&
this.pfa.hide()}dispose(){this.pfa&&(this.pfa.dispose(),this.pfa=null)}selectEntity(lb){return this.Oy?this.Oy.selectEntity(lb):!1}searchEntity(lb,ac){this.Oy&&this.Oy.searchEntity(lb,ac)}fOd(lb,ac,Gb,wb){this.Oy&&this.Oy.fOd(lb,ac,Gb,wb)}zDb(lb){return this.Oy?this.Oy.zDb(lb):!1}onPaneClosed(){if(this.Oy)this.Oy.onPaneClosed()}cancelSearch(){this.Oy&&this.Oy.cancelSearch()}selectDataType(lb){this.Oy&&this.Oy.selectDataType(lb)}showHelpArticle(lb){this.Oy&&this.Oy.showHelpArticle(lb)}showSurveyDialog(lb){this.Oy&&
this.Oy.showSurveyDialog(lb)}insertTable(lb,ac){this.Oy&&this.Oy.insertTable(lb,ac)}}Object(c.a)(Ua,"EnrichmentManager",null,[482,10]);class nb extends Ua{constructor(lb){super(lb)}dispose(){super.dispose()}}Object(c.a)(nb,"ExcelEnrichmentManager",Ua,[]);var Ha=a(14);class sb{constructor(lb){this.campaignId=this.commentQuestion=null;this.isZeroBased=!1;this.ratingValuesAscending=this.ratingQuestion=this.aditionalDataRequested=null;this.showPrompt=this.showEmailRequest=!1;this.surveyType=0;this.title=
null;this.campaignId=lb;this.commentQuestion=Ha.a.instance.mb(199);this.isZeroBased=!1;this.aditionalDataRequested=["EmailAddress"];this.ratingQuestion=Ha.a.instance.mb(195);this.ratingValuesAscending=[Ha.a.instance.mb(196),Ha.a.instance.mb(197),Ha.a.instance.mb(198)];this.showPrompt=!1;this.showEmailRequest=!0;this.surveyType=4;this.title=Ha.a.instance.mb(194)}}Object(c.a)(sb,"FloodgateSurvey",null,[]);var Qb=a(24),mb=a(77),Pb=a(417),gc=a(43),Xb=a(370),Ca=a(171),ra=a(33),ma=a(90),hb=a(29),vb=a(1),
Va=a(281),db=a(21);class oa{constructor(){this.market=this.appCorrelationId=this.sessionId=this.anid=this.applicationVersion=this.applicationName=null;this.featuresBitMask=this.themeId=0;this.disambiguationJson=this.uiLanguage=null}}Object(c.a)(oa,"EnrichmentMessageContentAppProperties",null,[]);class Oa{constructor(lb,ac,Gb,wb,qc){this.Yta=this.qJe=!1;this.Ncb=this.bxa=!0;this.VFb=this.pMb=!1;this.eeb=null;this.Mpc=0;this.oR=()=>{(this.Ncb||this.Yta)&&2!==this.Mpc&&(this.VFb||this.Mtd(!1))};this.Wc=
()=>{b.ULS.sendTraceTag(537166944,0,15,"Session ID changed while ambiguous linked entities are present")};this.CIi=Ya=>{hb.a.ug(Ya.Errors)?(Ya=hb.a.xc(Ya.Errors),Ya.includes("OperationSucceededWithAlert")?b.ULS.sendTraceTag(537166942,0,50,"Convert to Linked Entity failed with an alert"):b.ULS.sendTraceTag(36975687,0,10,`Failed to Convert to Linked Entity. errors: ${Ya}`)):Ya.Result&&(this.$.ea.Pk(this.Wc),this.$.ea.rk(this.Wc),Ya=Ya.Result,this.eeb=Ya.SkydanceFeatureBitmask,this.Txd(Ya),this.pMb=
!0)};this.Dg=()=>{(this.Ncb||this.Yta)&&this.Mtd(!1)};this.Nnc=(Ya,xb)=>{hb.a.ug(Ya.Errors)?b.ULS.sendTraceTag(36975688,0,10,`Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: ${hb.a.xc(Ya.Errors)}`):Ya.Result&&(Ya=Ya.Result,Ya.DisambiguationJson?(this.pMb=!1,this.U0f(xb),this.eeb=Ya.SkydanceFeatureBitmask,xb=Ya.DisambiguationJson,b.ULS.sendTraceTag(537166940,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.VFb=!1,this.Hlf(xb)):b.ULS.sendTraceTag(537166941,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null"))};this.eLi=(Ya,xb)=>{hb.a.ug(Ya.Errors)?(xb=hb.a.xc(Ya.Errors),b.ULS.sendTraceTag(36975689,0,10,`Failed to retrieve disambiguation data for search. errors: ${xb}`)):Ya.Result&&(Ya=Ya.Result,Ya.DisambiguationJson?(this.U0f(xb),this.eeb=Ya.SkydanceFeatureBitmask,xb=Ya.DisambiguationJson,b.ULS.sendTraceTag(537166938,0,50,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Calling LaunchOrUpdateDisambiguationPane"),
this.VFb=!0,this.Hlf(xb)):b.ULS.sendTraceTag(537166939,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null"))};this.MOi=Ya=>{hb.a.ug(Ya.Errors)?(Ya=hb.a.xc(Ya.Errors),b.ULS.sendTraceTag(36975690,0,10,`Failed to move to the next ambiguous Linked Entity. errors: ${Ya}`),this.Ncb=!0):Ya.Result&&(Ya=Ya.Result,this.eeb=Ya.SkydanceFeatureBitmask,this.Txd(Ya),this.pMb=!0)};this.DRi=Ya=>{if(hb.a.ug(Ya.Errors)){const xb=hb.a.xc(Ya.Errors);b.ULS.sendTraceTag(36975691,
0,10,`Failed to select Linked Entity for Disambiguation.. errors: ${xb}`)}Ya.Result?(this.Txd(Ya.Result),this.pMb=!0):this.Xsa()};this.MDf=Ya=>{hb.a.ug(Ya.Errors)?(Ya=hb.a.xc(Ya.Errors),b.ULS.sendTraceTag(36975692,0,15,`Failed to retrieve data for searching in Disambiguation Pane.  Error id names: ${Ya}`)):Ya.Result?this.d8b.pCc(Ya.Result,null):(b.ULS.sendTraceTag(537166927,0,50,"ConvertToLinkedEntityDisambiguationPane:OnSearchLinkedEntitySucceeded: Calling CloseDisambiguationPane"),this.Xsa())};
this.uNi=Ya=>{hb.a.ug(Ya.Errors)?(Ya=hb.a.xc(Ya.Errors),b.ULS.sendTraceTag(537166926,0,15,`Failed to insert starter data table. Error id names: ${Ya}`)):this.Xsa()};this.$=lb;this.gridView=db.g(this.$);this.gridView.ha.uT(this.Dg);this.gridView.Uu(this.oR);this.cNe=wb;this.convertToLinkedEntityManager=qc;ra.a.od(this.$)||Gb.MQ(ac);lb=new ab(ac);this.d8b=new nb(lb);u.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ya=>{Ya.isFeatureEnabled("mso_sendASmile",!0).then(xb=>
{this.bxa=xb;return null})})}dispose(){this.$&&(this.gridView.ha.IR(this.Dg),this.gridView.xy(this.oR))}selectEntity(lb){const ac=gc.o(this.gridView.ha.sa.activeCell,this.$),Gb=()=>new Pb.a;Xb.a(this.$.userOperationManager,(wb,qc,Ya)=>H(this.$.pa.va,ac,lb,Va.b(wb,this.DRi),qc,Ya,null),wb=>new Ca.a(109,0,wb,void 0,Gb),null);return!0}searchEntity(lb,ac,Gb=!1,wb=0,qc=null){b.ULS.sendTraceTag(38846755,0,50,`ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: ${ac}`);const Ya=
gc.o(this.gridView.ha.sa.activeCell,this.$);Xb.a(this.$.userOperationManager,(xb,wc,Oc)=>R(this.$.pa.va,Ya,lb,this.bxa,Gb,wb,qc,Va.b(xb,this.MDf),wc,Oc,null),xb=>new Ca.a(110,0,xb,16),null)}zDb(lb){const ac=gc.o(this.gridView.ha.sa.activeCell,this.$);this.Ncb=!1;Xb.a(this.$.userOperationManager,(Gb,wb,qc)=>O(this.$.pa.va,ac,lb,Va.b(Gb,this.MOi),wb,qc,null),Gb=>new Ca.a(111,0,Gb,16),null);return!0}onPaneClosed(){this.Yta=!1;this.qJe=!0;this.Mpc=0;this.VFb=!1}cancelSearch(){const lb=this.xOd();lb&&
Xb.a(this.$.userOperationManager,(ac,Gb,wb)=>V(this.$.pa.va,lb,Va.b(ac,this.MDf),Gb,wb,null),ac=>new Ca.a(112,0,ac,16),null)}selectDataType(lb){b.ULS.sendTraceTag(537166977,0,50,"ConvertToLinkedEntityDisambiguationPane:SelectDataType: Calling CloseDisambiguationPane");this.Xsa();if(lb&&lb.length)if(lb=JSON.parse(lb))if(null==lb.domainId)b.ULS.sendTraceTag(537166946,0,10,"Data Selector Pane invoked SelectDataType without passing a DomainId");else{var ac={};ac.Id=lb.domainId;ac.StringId=lb.stringId;
this.convertToLinkedEntityManager.convertToLinkedEntity(ac)}else b.ULS.sendTraceTag(537166947,0,10,"Failed to parse the dataTypeJson from the Data Type Selector Pane");else b.ULS.sendTraceTag(537166976,0,10,"Recevied an empty dataTypeJson payload from the Data Type Selector Pane")}showHelpArticle(lb){const ac=new ma.a(-859308420,mb.a.Gb,this.$.Kc,9,null);this.$.Ka.Lb(ac,{[mb.a.kg]:"HelpID="+lb,["InputMethod"]:mb.a.Gb,["ShouldCanvasTakeFocus"]:!0,[mb.a.Qc]:v.a.aV})}showSurveyDialog(lb){B.a.PMb(new sb(lb))}insertTable(lb,
ac){const Gb=this.xOd();Gb&&Xb.a(this.$.userOperationManager,(wb,qc,Ya)=>Q(this.$.pa.va,Gb,lb,ac,Va.b(wb,this.uNi),qc,Ya,null),wb=>new Ca.a(259,0,wb,1),null)}Mtd(lb){this.launchOrCloseDisambiguationPane(lb)}launchDisambiguationPaneForSearch(){b.ULS.sendTraceTag(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted");const lb=this.gmj();lb&&Xb.a(this.$.userOperationManager,(ac,Gb,wb)=>L(this.$.pa.va,lb,!0,this.bxa,!1,null,
Va.b(ac,this.eLi),Gb,wb,1),ac=>new Ca.a(114,0,ac,16),null)}launchLinkedEntityDataTypeSelectorPane(lb,ac){Xb.a(this.$.userOperationManager,(Gb,wb,qc)=>W(this.$.pa.va,lb,ac,Va.b(Gb,this.Nnc),wb,qc,2),Gb=>new Ca.a(233,0,Gb,16),null)}qri(lb,ac){lb&&Xb.a(this.$.userOperationManager,(Gb,wb,qc)=>L(this.$.pa.va,lb,!1,!1,!0,ac,Va.b(Gb,this.Nnc),wb,qc,2),Gb=>new Ca.a(257,0,Gb,16),null)}U0f(lb){lb&&(this.Mpc=lb)}Hlf(lb){if(vb.EwaSettings.ma(648)){var ac=new ma.a(-90814711,mb.a.Gb,0,10,null);this.$.Ka.Lb(ac,
null)}this.Yta?this.d8b.pCc(lb,null):(ac=3,null!=this.eeb?ac=this.eeb:b.ULS.shipAssertTag(537166937,0,!1,"SkydanceFeatureBitmask was not set"),(lb=this.nOh(lb,ac))||b.ULS.sendTraceTag(537166936,0,15,"LaunchOrUpdateDisambiguationPane: null appProperties"),this.cNe||b.ULS.sendTraceTag(537166935,0,15,"LaunchOrUpdateDisambiguationPane: null entitymanager"),this.d8b.xri(this.cNe,lb),this.Yta=!0)}Xsa(){this.Yta&&(b.ULS.sendTraceTag(537166934,0,100,"ConvertToLinkedEntityDisambiguationPane:CloseDisambiguationPane"),
this.d8b.Nxb(),this.Yta=!1,this.Mpc=0,this.VFb=!1)}Txd(lb){var ac=lb.Row+1;lb=lb.Column+1;0>ac||0>lb?(b.ULS.sendTraceTag(537166933,0,50,"ConvertToLinkedEntityDisambiguationPane:MoveToAmbiguousLinkedEntity: Calling CloseDisambiguationPane"),this.Xsa(),this.$.ea.Pk(this.Wc)):(ac=new Qb.Range(ac,lb,ac,lb,!0,!1),this.gridView.ha.updateSelection(ac,ac,60),this.Ncb=!0)}nOh(lb,ac){const Gb=new oa;Gb.applicationVersion=e.AFrameworkApplication.buildVersion;Gb.applicationName="ExcelWac";Gb.anid="00000000-0000-0000-0000-000000000000";
Gb.sessionId=e.AFrameworkApplication.userSessionId;Gb.appCorrelationId=z.a.create().toString();var wb=A.a.fK(e.AFrameworkApplication.lcid);wb=wb?wb.name:null;Gb.uiLanguage=wb;Gb.market=this.Nac(wb);Gb.themeId=0;Gb.disambiguationJson=lb;ac<=I.a.wS?Gb.featuresBitMask=ac:b.ULS.sendTraceTag(537166932,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties");return Gb}Nac(lb){lb=lb.split("-");return lb[lb.length-1]}launchOrCloseDisambiguationPane(lb){const ac=this.gridView.ha.sa.activeCell;
if(this.xOd()&&ac)if(this.gridView.Fb.Ffc(ac)){if((!this.qJe||lb||this.pMb)&&!this.gridView.eb){lb&&(this.Ncb=!0);var Gb=gc.q(ac,this.$);Xb.a(this.$.userOperationManager,(wb,qc,Ya)=>L(this.$.pa.va,Gb,!1,this.bxa,!1,null,Va.b(wb,this.Nnc),qc,Ya,1),wb=>new Ca.a(114,0,wb,16),null)}}else this.Xsa();else this.Xsa()}s7i(){if(this.Yta){var lb=this.gridView.ha.sa.activeCell;if(lb){var ac=gc.q(lb,this.$);Xb.a(this.$.userOperationManager,(Gb,wb,qc)=>L(this.$.pa.va,ac,!1,this.bxa,!1,null,Va.b(Gb,this.Nnc),wb,
qc,1),Gb=>new Ca.a(114,0,Gb,16),null)}else this.Xsa()}}xOd(){const lb=this.gridView.ha.sa;return lb.Hba()?gc.o(lb.activeCell,this.$):null}gmj(){const lb=this.gridView.ha.sa;return lb.Hba()?gc.q(lb.activeCell,this.$):null}}Object(c.a)(Oa,"ConvertToLinkedEntityDisambiguationPane",null,[10]);var Wa=a(7),Sa=a(374),yb=a(1385),Ma=a(53),Bb=a(712);class Nb{constructor(lb,ac,Gb){this.cmf=2;this.bmf="Size64by48";this.$=lb;this.Ua=ac;this.convertToLinkedEntityManager=Gb;this.vxa=vb.EwaSettings.ma(668)}CGh(lb,
ac){var {ConvertToLinkedEntityManager:Gb}=a(759);this.VRj();ac=this.Ua.Up(ac).yC();let wb=0,qc=0,Ya=!1;for(var xb of lb.Categories){const wc=this.iHh(xb,wb);wc&&(this.vxa&&qc===Gb.D8a&&(Ya=!0),ac.MenuSectionList.push(wc),++wb);++qc}this.vxa&&Ya&&wb<=Gb.dmf&&ac.MenuSectionList.splice(Gb.D8a,1);Gb=this.Ua.Dc().r1b();xb=Ma.a.Ue(11);for(const wc of lb.LongButtons)this.convertToLinkedEntityManager.myj(wc)&&this.XDg(Gb,wc,xb);0<Gb.ControlList.length&&ac.MenuSectionList.push(Gb);return ac}XDg(lb,ac,Gb){if(ac){var wb=
"Data.ConvertToLinkedEntityMenuItem_"+ac.Name,qc=this.convertToLinkedEntityManager.gQ(ac.DomainId);qc&&(ac=Object(Wa.a)(new Sa.a,{Id:wb,ExternalId:wb,Command:"-1662108744",LabelText:ac.Name,Alt:ac.SuperTip,Visible:!0,MenuItemId:a(759).ConvertToLinkedEntityManager.g2a(ac.DomainId),Image16by16:Gb,Image16by16Class:this.E8h(qc.FontLocator)}),lb.ControlList.push(ac))}}cHh(lb,ac){return Object(Wa.a)(new yb.a,{Id:a(759).ConvertToLinkedEntityManager.$Ke+lb.toString(),ExternalId:a(759).ConvertToLinkedEntityManager.$Ke+
lb.toString(),MenuItemId:a(759).ConvertToLinkedEntityManager.V7c+lb.toString(),Command:"-1203788282",QueryCommand:"QueryLinkedEntityGalleryButtons",Icon:this.x$e(ac.FontLocator),LabelText:ac.Name,PreviewIconStyle:{["root"]:{["width"]:24,["min-width"]:24,["height"]:24}},Alt:this.sed(ac)})}lOg(lb){switch(lb){case "Animal":return Bb.a.IKg;case "Apple":return Bb.a.LLg;case "Atom":return Bb.a.gNg;case "Beaker":return Bb.a.bPg;case "Bridge":return Bb.a.CQg;case "Cat":return Bb.a.zWg;case "City":return Bb.a.HYg;
case "Constellation":return Bb.a.E2g;case "Dog":return Bb.a.Nih;case "Finance":return Bb.a.VOg;case "GradCap":return Bb.a.v1h;case "HumanAnatomy":return Bb.a.T7h;case "LocationPointer":return Bb.a.Wti;case "Map":return Bb.a.iVi;case "MedicineNeedle":return Bb.a.pAi;case "Mountain":return Bb.a.IBi;case "Movie":return Bb.a.bCi;case "Music":return Bb.a.nCi;case "OuterSpace":return Bb.a.LVi;case "Planet":return Bb.a.LYi;case "Satellite":return Bb.a.Gjj;case "WolframGeneric":return Bb.a.Bij;default:return Bb.a.r4g}}E8h(lb){if("PowerBIRibbon"!==
lb)return r.a.n$c;switch(lb){case "AnimalRibbon":return r.a.euh;case "AppleRibbon":return r.a.fuh;case "AtomRibbon":return r.a.guh;case "BeakerRibbon":return r.a.huh;case "BridgeRibbon":return r.a.iuh;case "CenterMapRibbon":return r.a.juh;case "CityRibbon":return r.a.kuh;case "CurrencyRibbon":return r.a.luh;case "ExerciseRibbon":return r.a.muh;case "FinanceRibbon":return r.a.$Qe;case "FirstAidRibbon":return r.a.nuh;case "GlobeLightningRibbon":return r.a.ouh;case "GradCapRibbon":return r.a.puh;case "HumanAnatomyRibbon":return r.a.quh;
case "LeafRibbon":return r.a.ruh;case "LocationPointerRibbon":return r.a.tuh;case "MapRibbon":return r.a.YQe;case "MountainRibbon":return r.a.uuh;case "MovieRibbon":return r.a.vuh;case "MusicRibbon":return r.a.wuh;case "NotablePeopleRibbon":return r.a.xuh;case "OuterSpaceRibbon":return r.a.yuh;case "PartlySunnyWeatherRibbon":return r.a.zuh;case "PowerBIRibbon":return r.a.ZQe;case "SatelliteRibbon":return r.a.Auh;case "WolframGenericRibbon":return r.a.suh;case "YogaRibbon":return r.a.Cuh;default:return r.a.XQe}}x$e(lb){switch(lb){case "AnimalRibbon":return"AnimalExcelDataTypes_24";
case "AppleRibbon":return"AppleExcelDataTypes_24";case "AtomRibbon":return"AtomExcelDataTypes_24";case "BeakerRibbon":return"BeakerExcelDataTypes_24";case "BridgeRibbon":return"BridgeExcelDataTypes_24";case "CenterMapRibbon":return"CenterMapExcelDataTypes_24";case "CityRibbon":return"CityExcelDataTypes_24";case "CurrencyRibbon":return"CurrencyExcelDataTypes_24";case "ExerciseRibbon":return"ExerciseExcelDataTypes_24";case "FinanceRibbon":return"Bank_32";case "FirstAidRibbon":return"FirstAidExcelDataTypes_24";
case "GlobeLightningRibbon":return"GlobeLightning_24";case "GradCapRibbon":return"GradCapExcelDataTypes_24";case "HumanAnatomyRibbon":return"HumanAnatomyExcelDataTypes_24";case "LeafRibbon":return"LeafExcelDataTypes_24";case "LocationPointerRibbon":return"LocationPointerExcelDataTypes_24";case "MapRibbon":return"OpenMap_24";case "MountainRibbon":return"MountainExcelDataTypes_24";case "MovieRibbon":return"MovieExcelDataTypes_24";case "MusicRibbon":return"MusicExcelDataTypes_24";case "NotablePeopleRibbon":return"NotablePeopleExcelDataTypes_24";
case "OuterSpaceRibbon":return"OuterSpaceExcelDataTypes_24";case "PartlySunnyWeatherRibbon":return"PartlySunnyWeatherExcelDataTypes_24";case "PowerBIRibbon":return"DataProtectionExcelDataTypes_24";case "SatelliteRibbon":return"SatelliteExcelDataTypes_24";case "WolframGenericRibbon":return"Lightning_24";case "YogaRibbon":return"YogaExcelDataTypes_24";default:return"ConvertToEntity_20"}}iHh(lb,ac){ac=this.Ua.ZA("ConvertToLinkedEntitySection_"+ac,this.cmf,this.bmf);var Gb=!1;for(var wb of lb.DomainIds){const qc=
this.convertToLinkedEntityManager.gQ(wb);if(!qc||qc.DomainBlocked||!qc.ShowInRibbon)continue;Gb=qc.Name;const Ya=a(759).ConvertToLinkedEntityManager.g2a(wb);ac.Vt("Data.ConvertToLinkedEntityMenuItem_"+Ya,-1203788282,"QueryLinkedEntityGalleryIcon",void 0,Ya,this.x$e(qc.FontLocator),void 0,void 0,this.sed(qc),Gb);Gb=!0}if(!Gb)return null;wb=ac.ppb(!0);ac=this.Ua.Dc();ac.title=lb.Name;lb=ac.r1b();lb.ControlList.push(wb);return lb}VRj(){this.cmf=5;this.bmf="Size112by64"}sed(lb){return lb.RibbonTooltipHeader?
lb.RibbonTooltipHeader+"\n\n"+lb.RibbonTooltip:lb.RibbonTooltip}}Object(c.a)(Nb,"ConvertToLinkedEntityMenuRenderer",null,[450]);var Ia=a(58),jb=a(283),Ob=a(116),Jb=a(172),Kb=a(69);class Qa{constructor(lb,ac){this.Qjd=this.Sjd=!1;this.pQi=Gb=>{b.ULS.sendTraceTag(537166680,0,50,"OnReadRoamingStringSuccess called.");this.Sjd=!0;if(hb.a.ug(Gb.Errors))b.ULS.sendTraceTag(537166679,0,10,`OnReadRoamingStringSuccess encountered an error. Errors: ${hb.a.xc(Gb.Errors)}`);else{var wb=0,qc=[],Ya=!1;try{if(!Gb.Result)return;
const xb=Gb.Result;if(!xb){b.ULS.sendTraceTag(537166678,0,50,"OnReadRoamingStringSuccess - Received an empty roamingXml.");return}qc=this.$Wi(xb);if(!qc||!qc.length)return;wb=qc.length;this.EAi(qc);this.nAa.vUf();b.ULS.sendTraceTag(537166677,0,50,`OnReadRoamingStringSuccess MruCount:${this.nAa.obb.length}`);if(vb.EwaSettings.isChangeGateEnabled("OfficeVSO:5199912_LinkedEntityMruWolfram")){for(const wc of this.nAa.obb)if(1===(wc.Id&1048320)>>8){Ya=!0;break}b.ULS.sendTraceTag(537166676,0,50,`OnReadRoamingStringSuccess MruWolframAvailable:${Ya}`)}}finally{b.ULS.sendTraceTag(537166675,
0,50,`ParseRecentlyUsedLinkedDataTypes returned ${wb} data types.`),Gb=[],Gb.push(Object(Wa.a)(new Kb.a,{name:"MruCount",int64:wb})),Gb.push(Object(Wa.a)(new Kb.a,{name:"MruWolframAvailable",bool:Ya})),Jb.a("ReadRecentlyUsedLinkedDataTypes",void 0,void 0,Gb)}this.Qjd&&(this.wig(this.nAa.obb),this.Qjd=!1)}};this.HUi=Gb=>{b.ULS.sendTraceTag(537166674,0,50,"OnWriteRoamingStringSuccess called.");hb.a.ug(Gb.Errors)?b.ULS.sendTraceTag(537166673,0,10,`OnWriteRoamingStringSuccess encountered an error. Errors: ${hb.a.xc(Gb.Errors)}`):
Gb.Result&&(Gb.Result||b.ULS.sendTraceTag(537166672,0,15,"OnWriteRoamingStringSuccess - Failed to write to the roaming service."))};this.qDf=(Gb,wb,qc)=>{Gb=Ob.a.ff(Gb.data);b.ULS.sendTraceTag(537166671,0,10,`OnRoamingOperationFailure: Encountered errors for ${qc}. Errors: ${hb.a.xc(Gb)}.`)};this.$=lb;this.nAa=ac}$Vh(){this.Sjd||vb.EwaSettings.isChangeGateEnabled("OfficeVSO:6422438_RoamingHandlerNoSessionIdPresent")&&!this.$.ea.fc||(b.ULS.sendTraceTag(537166691,0,50,"GetRecentlyUsedLinkedDataTypesFromRoamingService - Invoking the GetRecentlyUsedDataTypes operation."),
jb.u(this.$.pa.va,0,this.pQi,this.qDf,null,null))}wig(lb){lb&&lb.length?this.Sjd?(lb=this.Snj(lb))?(b.ULS.sendTraceTag(537166688,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Invoking the WriteRecentlyUsedDataTypes operation."),jb.A(this.$.pa.va,0,lb,this.HUi,this.qDf,null,null)):b.ULS.sendTraceTag(537166689,0,15,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Created an empty serialized string."):this.Qjd=!0:b.ULS.sendTraceTag(537166690,0,50,"WriteRecentlyUsedLinkedDataTypesToRoamingService - Tried writing an empty list of data types.")}Snj(lb){if(!lb||
!lb.length)return b.ULS.sendTraceTag(537166687,0,15,"SerializeRecentlyUsedLinkedDataTypes - Received an empty list of data types."),null;var ac=[];for(const Gb of lb)lb={},lb.Id=Gb.Id,Gb.StringId&&(lb.StringId=Gb.StringId),ac.push(lb);ac="<DataTypes>"+Ia.a.kc(ac)+"</DataTypes>";return 1906<ac.length?(b.ULS.sendTraceTag(537166686,0,15,"SerializeRecentlyUsedLinkedDataTypes - Exceeded the MaxSize for ridExcelRecentlyUsedLinkedDataTypes."),null):ac}$Wi(lb){if(!lb)return b.ULS.sendTraceTag(537166685,0,
15,"ParseRecentlyUsedLinkedDataTypes - Received an empty roamingXml."),null;if(!lb.startsWith("<DataTypes>")||!lb.endsWith("</DataTypes>"))return b.ULS.sendTraceTag(537166684,0,15,"ParseRecentlyUsedLinkedDataTypes - Received a string without a prefix/postfix."),null;lb=lb.substring(11,lb.length-12);if(!lb)return b.ULS.sendTraceTag(537166683,0,15,"ParseRecentlyUsedLinkedDataTypes - Created an empty substring."),null;let ac=[];try{ac=Ia.a.$h(lb)}catch(Gb){return b.ULS.sendTraceTag(537166682,0,10,`ParseRecentlyUsedLinkedDataTypes - Encountered an exception. Message: ${Gb.message}`),
null}b.ULS.sendTraceTag(537166681,0,50,`ParseRecentlyUsedLinkedDataTypes returned ${ac.length} data types.`);return ac}EAi(lb){const ac=this.nAa.obb,Gb=this.nAa.p6i;if(ac.length!==Gb){for(let wb=0;wb<lb.length&&ac.length<Gb;++wb){const qc=lb[wb];this.nAa.gQ(qc)&&!ac.includes(qc)&&ac.push(qc)}this.nAa.obb=ac}}}Object(c.a)(Qa,"LinkedDataTypeRoamingHandler",null,[]);var ha=a(515),qa=a(59),pb=a(50),bb=a(212),eb=a(37),Fa=a(47),tb=a(28),dc=a(282),jc=a(22),fb=a(99);a.d(C,"ConvertToLinkedEntityManager",function(){return ec});
class ec extends w.a{constructor(lb,ac,Gb,wb,qc,Ya){super();this.Bif=this.Brd=this.xsd=this.rqd=this.qqd=this.m7a=this.nnd=null;this.aEb=this.tjd=0;this.Wba=null;this.xnd=!1;this.Ecd=this.Vn=this.dNd=null;this.us=0;this.lY=null;this.qLa=8;this.j_c=this.amf=this.Ief=this.S$a=!1;this.sza=this.dXe=this.STe=null;this.fYc=0;this.xOg=5;this.K0b=3E4;this.Xag=!1;this.c$=null;this.ria=Array(5);this.xdg=this.AZd=!1;this.JVf=this.kud=0;this.lce=null;this.Q5f=!0;this.Wc=(xb,wc)=>{wc.fc&&!wc.FAb&&this.showUntrustedImageBusinessBarIfNecessary()};
this.eMi=xb=>{if(xb.Result){var wc=xb.Result;if(wc&&wc.length){b.ULS.sendTraceTag(537166922,0,50,`OnGetRichDataClassificationLabelsSuccess: Received ${wc.length} labels`);var Oc=pb.GetServiceTaskFactory.Sa(this.$.da,274,275,0);eb.TaskExtensions.Aa(Oc,()=>{Oc.result.XXc(wc,2)||b.ULS.sendTraceTag(537166921,0,10,"OnGetRichDataClassificationLabelsSuccess - Failed to apply the policy label.")},this.$.la,3)}}else b.ULS.sendTraceTag(537166923,0,50,"OnGetRichDataClassificationLabelsSuccess: Received no result")};
this.Vf=()=>{this.Rzb&&(this.gNj(),this.s3h(this.$.ea.Eo.LinkedEntityAsyncRefreshStateId));this.t7a?this.t4h(this.$.ea.Eo.RichDataClassificationLabelStateId):this.E6a&&this.MYd(!0)};this.IJi=()=>{this.AZd=!0;this.Vn&&this.Vn.s7i()};this.yLi=xb=>{if(xb&&!dc.a(xb))try{xb.Result.HasUntrustedImageUrl&&(this.businessBar.Zf(59,null),this.xdg=!0)}catch(wc){b.ULS.sendTraceTag(574718945,0,10,`ConvertToLinkedEntityManager.OnGetHasUntrustedImageUrlsFromServerSuccess: GetHasUntrustedImageUrls encountered exception ${wc}.`)}};
this.Elf=()=>{if(!this.amf&&this.kzb()&&!this.ood())if(Jb.a("DataTabActive"),qa.a.wg.TQ)if(document.querySelector("#ConvertToLinkedEntityGallery-previewExpandButton")){var xb=this.F4b();if(xb){var wc={};wc.InputMethod=mb.a.Gb;wc.CalloutName=8;wc.Target="[data-unique-id=Ribbon-ConvertToLinkedEntityGallery-previewExpandButton]";this.$.Ka.Lb(xb,wc);this.amf=!0}else b.ULS.sendTraceTag(537166880,0,10,"RibbonCommandInfo is null for LinkedEntityGalleryCallout")}else b.ULS.sendTraceTag(537166881,0,10,"Could not locate anchor for the LinkedEntityGalleryCallout");
else b.ULS.sendTraceTag(537166882,0,50,"ConvertToLinkedEntityManager:LaunchLinkedEntityGalleryCallout() - Attempted to launch linked entity gallery callout but callout not enabled")};this.DIi=xb=>{hb.a.ug(xb.Errors)||(this.t7a||this.MYd(!1),this.raiseEvent("LinkedEntityConverted"))};this.ISi=()=>{this.$.da.Za(211,xb=>{xb.readText(Ha.a.instance.ga(1811))})};this.dd=(xb,wc)=>{b.ULS.sendTraceTag(537166867,0,50,"ConvertToLinkedEntityManager.OnWorkbookOpened called");wc.qV?b.ULS.sendTraceTag(537166865,
0,15,"ConvertToLinkedEntityManager.OnWorkbookOpened called while rendering cached content"):(this.$.isEditMode?this.hze():this.igj(),vb.EwaSettings.ma(648)&&this.AZd&&this.fMe())};this.GLi=xb=>{this.M2b();if(xb.Result){var wc=xb.Result;xb=wc.DomainDataArray;this.Wba=wc.Ribbon;if(this.vxa&&this.Wba){var Oc={};Oc.Name=Ha.a.instance.ga(1801);Oc.DomainIds=this.BK;this.Wba.Categories.splice(ec.D8a,0,Oc)}0<wc.MaximumCellsToConvert&&(this.lce=wc.MaximumCellsToConvert);this.us=2;wc=!1;if(xb){b.ULS.sendTraceTag(39949271,
0,50,`OnGetLinkedEntityServiceDomainsSuccess: Received ${xb.length} domains`);this.VNa||(this.VNa=[]);Oc=Ha.a.instance.ga(1798);const Cb=Ha.a.instance.ga(1800);for(const Ib of xb)Ib.DomainId?(this.VNa.push(Ib),Ib.DomainBlocked?(xb=!!Ib.DomainId.StringId,b.ULS.sendTraceTag(537166861,0,50,`Domain: ${xb?Ib.DomainId.Id.toString():Ib.Name} is telemetry only, do not show in menu (Has String ID: ${xb})`)):(this.qU.ia(ec.g2a(Ib.DomainId),Ib),Ib.Name===Oc||268435456===Ib.DomainId.Id?this.STe=Ib.DomainId.Id.toString():
Ib.Name===Cb||536870912===Ib.DomainId.Id?this.dXe=Ib.DomainId.Id.toString():268435712===Ib.DomainId.Id&&Ib.ShowInRibbon&&(this.j_c=!0),wc=!0)):b.ULS.sendTraceTag(537166862,0,10,"OnGetLinkedEntityServiceDomainsSuccess: DomainId is null.")}wc||(this.VNa=null);this.keg();this.Hqd&&this.dNd.$Vh();this.Xag||(this.cNj(),this.Xag=!0)}else this.VNa=null,this.us=3,-1<this.qLa&&window.setTimeout(()=>{this.SGb()},100*(8-this.qLa)),b.ULS.sendTraceTag(537166863,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");
this.JId();this.lFe();this.j_c&&this.agf&&bb.c(this.Elf,this.$.la,500);this.E6a&&!this.t7a&&this.MYd(!0)};this.FLi=xb=>{xb=Ob.a.ff(xb.data);b.ULS.sendTraceTag(34415007,0,15,`OnGetLinkedEntityServiceDomainsFailure [Errors: ${hb.a.xc(xb)}].`);this.VNa=null;this.us=3;this.S$a=!0;this.JId()};this.onContentReady=()=>{this.icg()&&this.gridView.xy(this.onContentReady);this.Q5f&&this.$.workbookContext.Options&1048576&&(this.businessBar.dCj(),this.Q5f=!1)};this.gj=()=>{this.M2b()};this.lOi=xb=>{if(dc.a(xb)){const wc=
pb.GetServiceTaskFactory.Sa(this.$.da,5,4,0);eb.TaskExtensions.Aa(wc,()=>{let Cb=null;if(null===xb||void 0===xb?0:xb.Errors)Cb=xb.Errors[0];wc.result.v5f(Cb,null)},this.$.la,3);b.ULS.sendTraceTag(537166800,0,15,`ConvertToLinkedEntityManager.OnLinkedEntityTryAutoRefreshSuccessCore. LinkedEntityTryAutoRefresh returned with errors [Errors: ${hb.a.xc(xb.Errors)}].`);const Oc=hb.a.bG(xb.Errors,[-1100324317,-2133389873],"ConvertToLinkedEntityManager:OnLinkedEntityTryAutoRefreshSuccessCore");this.$.ea.Gp(Oc)}};
this.a_c=()=>{b.ULS.sendTraceTag(537166796,0,50,`ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a ${this.K0b} millisecond interval`);this.mcf("Periodic auto-refresh check",this.XGi,this.WGi)};this.XGi=xb=>{dc.a(xb)?(b.ULS.sendTraceTag(537166795,0,15,`ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: ${hb.a.xc(xb.Errors)}].`),++this.fYc):this.fYc=0;d.a.Ia(this.sza);this.fYc>=this.xOg?(b.ULS.sendTraceTag(537166794,
0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh"),this.sza=null):(b.ULS.sendTraceTag(537166793,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext"),this.sza=Fa.a.instance.create(this.a_c,this.K0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck"))};this.WGi=xb=>{xb=Ob.a.ff(xb.data);f.a.Fh(xb)?b.ULS.sendTraceTag(537166791,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):
b.ULS.sendTraceTag(537166792,0,15,`OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: ${hb.a.xc(xb)}].`);d.a.Ia(this.sza);this.sza=Fa.a.instance.create(this.a_c,this.K0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")};this.mPi=xb=>{xb=!!xb.Result&&xb.Result;b.ULS.sendTraceTag(537166790,0,50,`OnNotifyFeatureLicensingStatusSuccess- operationSucceeded? = ${xb.toString()}`);xb?(b.ULS.sendTraceTag(537166789,0,50,`OnNotifyFeatureLicensingStatusSuccess- successful handshake duration = ${tb.a.Pa.me.m-
this.tjd} ms, retry count = ${this.aEb}`),this.SGb()):this.lzc()};this.lPi=()=>{b.ULS.sendTraceTag(537166788,0,15,"OnNotifyFeatureLicensingStatusFailed");this.lzc()};this.iLi=xb=>{xb.Result?(xb=xb.Result)?(this.VJd(),this.businessBar.v5f(null,xb)):b.ULS.sendTraceTag(537166725,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result"):b.ULS.sendTraceTag(537166726,0,50,"OnGetErrorMessageForLinkedDataTypeRefreshSuccess: Received no result")};this.$=lb;this.businessBar=Ya;this.svgIconProvider=
Gb;this.VNa=[];this.BK=[];this.gridView=db.g(this.$);this.xdc=-1;this.Jji=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4294127_LongButtonVisibleWhenAnyDomainOverrideShowsInRibbon");this.E6a=this.$.ma(440)&&this.$.ma(291);this.t7a=this.$.ma(669);this.Rzb=vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityAutoRefresh",!1);this.Hqd=(this.vxa=this.$.ma(668))&&vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadAndWriteRecentlyUsedListToTheRoamingService",!0);this.agf=
vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityGalleryTeachUIEnabled",!1);this.qU=new fb.a;this.j9a=new Nb(lb,ac,this);wb&&(this.Vn=new Oa(lb,wb,qc,this,this));this.$.kl(this.dd);y.a(this.$)&&y.a(this.$).wpj(this);this.hze();(this.Rzb||this.E6a||this.t7a)&&this.$.ea.Vu(this.Vf);vb.EwaSettings.ma(130)&&vb.EwaSettings.ma(138)&&(this.icg()||this.gridView.Uu(this.onContentReady));this.$.LA(this.gj);vb.EwaSettings.ma(648)&&(this.$.ea.rk(this.Wc),this.showUntrustedImageBusinessBarIfNecessary());
this.Hqd&&(this.dNd=new Qa(this.$,this))}dispose(){(this.Rzb||this.E6a||this.t7a)&&this.$.ea.Sw(this.Vf);vb.EwaSettings.ma(648)&&this.$.ea.Pk(this.Wc);!this.c$&&vb.EwaSettings.ma(130)&&vb.EwaSettings.ma(138)&&this.gridView.xy(this.onContentReady);this.Vn&&this.Vn.dispose();this.$.LD(this.gj);this.$.Hl(this.dd);this.E6a&&(this.nnd=null);d.a.Ia(this.sza)}$Gg(lb){this.addHandler("LinkedEntityConverted",lb)}WRf(lb){this.removeHandler("LinkedEntityConverted",lb)}get p6i(){return 5}get obb(){return this.BK}set obb(lb){this.BK=
lb}selectEntity(lb){return this.Vn?this.Vn.selectEntity(lb):!1}searchEntity(lb,ac){this.Vn&&this.Vn.searchEntity(lb,ac)}fOd(lb,ac,Gb,wb){this.Vn&&this.Vn.searchEntity(lb,ac,!0,Gb,wb)}zDb(lb){return this.Vn?this.Vn.zDb(lb):!1}onPaneClosed(){if(this.Vn)this.Vn.onPaneClosed()}cancelSearch(){this.Vn&&this.Vn.cancelSearch()}selectDataType(lb){this.Vn&&this.Vn.selectDataType(lb)}showHelpArticle(lb){this.Vn&&this.Vn.showHelpArticle(lb)}showSurveyDialog(lb){this.Vn&&this.Vn.showSurveyDialog(lb)}insertTable(lb,
ac){this.Vn&&this.Vn.insertTable(lb,ac)}t4h(lb){this.$.isEditMode&&this.JVf!==lb&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&(this.JVf=lb,b.ULS.sendTraceTag(537166925,0,50,"HandleRichDataClassificationLabelStateIdChanged - Getting rich data classification labels"),U(this.$.pa.va,this.eMi,null,null,null))}fMe(){const lb=(ac,Gb,wb)=>K(this.$.pa.va,Va.b(ac,this.IJi),Gb,wb,null);vb.EwaSettings.$b()?this.$.userOperationManager.Wb(new Ca.a(589,0,lb,80),null):this.$.userOperationManager.Wb(new ha.a(589,
0,lb,16),null)}showUntrustedImageBusinessBarIfNecessary(){this.AZd||this.xdg||!this.$.ea.fc||this.Ymj()}Ymj(){const lb=(ac,Gb,wb)=>ta(this.$.pa.va,Va.b(ac,this.yLi),Gb,wb,null);vb.EwaSettings.$b()?this.$.userOperationManager.Wb(new Ca.a(588,0,lb,80),null):this.$.userOperationManager.Wb(new ha.a(588,0,lb,16),null)}MYd(lb){if(this.E6a&&null==this.nnd&&!this.t7a&&e.AFrameworkApplication.fa.qa("SupportsPolicies")&&null!=this.m7a&&this.m7a&&(!lb||this.$.workbookContext.Options&262144)){var ac=pb.GetServiceTaskFactory.Sa(this.$.da,
274,275,0);eb.TaskExtensions.Aa(ac,()=>{this.nnd=ac.result.mPf(2)},this.$.la,3)}}get yOa(){return this.ria.length}get lAi(){return this.lce}s4g(lb){(lb=this.Rih(lb))?this.convertToLinkedEntity(lb):b.ULS.sendTraceTag(537166920,0,10,"Could not convert key into domain ID")}convertToLinkedEntity(lb){b.ULS.sendTraceTag(34415004,0,50,`ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: ${lb.Id}].`);if(this.gridView){var ac=this.gridView.ha.sa.Xc,Gb=ac.Ie(this.gridView.vH);
this.vxa&&this.xnd&&this.KEg(lb);if(Gb){Gb=this.gridView.Fb.pxa(Gb);if(!this.U7e(lb)&&this.Zgf(lb.Id)){b.ULS.sendTraceTag(537166918,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert to organization data type without curated data");if(qa.a.wg.TQ){ac=this.Kdd();if(!ac){b.ULS.sendTraceTag(537166917,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Gb=this.F4b();if(!Gb){b.ULS.sendTraceTag(537166916,0,50,"RibbonCommandInfo is null for blankCellConvert");return}var wb=
{["InputMethod"]:mb.a.Gb,CalloutName:3};wb.Target=ac;wb.RibbonButtonLabel=vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4244626_BlankCellCalloutRibbonButtonLabel")?this.xVf(lb):this.sBb(lb.Id.toString());wb.ExampleEntities=this.XRe(lb);this.$.Ka.Lb(Gb,wb);return}b.ULS.sendTraceTag(537166915,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert to organization data without curated data, teaching callout not enabled")}if(this.Zgf(lb.Id)&&!lb.StringId)this.launchLinkedEntityDataTypeSelectorPane(ec.g2a(lb));
else{if(Gb){b.ULS.sendTraceTag(537166914,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range");if(vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LaunchStarterDataForBlankCell",!1)&&this.aHj(lb)){ac=gc.r(this.gridView.ha.sa.selectedRanges,this.$);this.Vn.qri(ac,lb);return}if(qa.a.wg.TQ){ac=this.Kdd();if(!ac){b.ULS.sendTraceTag(537166913,0,50,"CalloutAnchorElement is null for blankCellConvert");return}Gb=this.F4b();if(!Gb){b.ULS.sendTraceTag(537166912,
0,50,"RibbonCommandInfo is null for blankCellConvert");return}wb={["InputMethod"]:mb.a.Gb,CalloutName:2};wb.Target=ac;wb.RibbonButtonLabel=this.xVf(lb);wb.ExampleEntities=this.XRe(lb);wb.BlankCellResourceId=this.DPg(lb);wb.HasBlankCellWalkthrough=this.e5h(lb);wb.ServiceDomain=lb.Id;this.$.Ka.Lb(Gb,wb);return}b.ULS.sendTraceTag(537166883,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.i3c(lb,!1,ac)}}}else b.ULS.shipAssertTag(537166919,
0,!1,"grid view should not be null")}convertToLinkedEntityFromAutoDetect(){this.c$&&this.c$.PHa()}onAutoDetectUIShown(){const lb=(ac,Gb,wb)=>T(this.$.pa.va,ac,Gb,wb,null);vb.EwaSettings.$b()?Xb.a(this.$.userOperationManager,lb,ac=>new Ca.a(230,0,ac,80),null):Xb.a(this.$.userOperationManager,lb,ac=>new ha.a(230,0,ac,16),null)}i3c(lb,ac,Gb){const wb=gc.q(Gb,this.$),qc=()=>new Pb.a;Xb.a(this.$.userOperationManager,(Ya,xb,wc)=>X(this.$.pa.va,wb,lb,ac,Va.b(Ya,this.DIi,this.ISi,this.Vn.CIi),xb,wc,null),
Ya=>new Ca.a(115,0,Ya,void 0,qc),null)}KEg(lb){if(this.vxa&&this.xnd){var ac={};ac.Id=lb.Id;lb.StringId&&(ac.StringId=lb.StringId);if(!(0<this.BK.length&&this.BK[0].Id===ac.Id&&this.BK[0].StringId===ac.StringId)){lb=!1;this.BK.splice(0,0,ac);for(let Gb=1;Gb<this.BK.length;++Gb)if(this.BK[Gb].Id===ac.Id&&this.BK[Gb].StringId===ac.StringId){this.BK.splice(Gb,1);lb=!0;break}for(;5<this.BK.length;)this.BK.splice(this.BK.length-1,1);this.Wba.Categories[ec.D8a].DomainIds=this.BK;this.vUf();this.Hqd&&!lb&&
this.dNd.wig(this.BK)}}}convertLinkedEntityToText(){b.ULS.sendTraceTag(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted");if(this.gridView){var lb=gc.q(this.gridView.ha.sa.Xc,this.$);Xb.a(this.$.userOperationManager,(ac,Gb,wb)=>D(this.$.pa.va,lb,ac,Gb,wb,null),ac=>new Ca.a(116,0,ac),null)}else b.ULS.shipAssertTag(537166879,0,!1,"grid view should not be null")}refreshLinkedEntitiesInRange(){b.ULS.sendTraceTag(537166878,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange() - refresh attempted");
if(db.g(this.$)){this.$.isEditMode||b.ULS.sendTraceTag(537166876,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntitiesInRange(): Refreshing selection during view mode");this.VJd();var lb=gc.r(this.gridView.ha.sa.selectedRanges,this.$);Xb.a(this.$.userOperationManager,(ac,Gb,wb)=>J(this.$.pa.va,lb,ac,Gb,wb,null),ac=>new Ca.a(248,0,ac),null)}else b.ULS.shipAssertTag(537166877,0,!1,"grid view should not be null")}myj(lb){lb=this.gQ(lb.DomainId);if(!lb||lb.DomainBlocked||vb.EwaSettings.isChangeGateEnabled("OfficeVSO:4465309_NoCuratedDataNoLongButton")&&
!lb.HasCuratedData)return!1;if(this.Jji){for(let ac of this.qU)if(ac.value.DomainId.Id===lb.DomainId.Id&&ac.value.ShowInRibbon)return!0;return!1}return lb.ShowInRibbon}cxj(lb){return 2!==this.us||!this.ria[lb]}launchDisambiguationPaneForSearch(){this.Vn&&this.Vn.launchDisambiguationPaneForSearch()}Oc(lb,ac,Gb){if("PopulateConvertToLinkedEntityMenu"!==ac)return!1;this.Ecd=Gb.MenuId;if(0===this.us||3===this.us)return this.lZi(),!0;if(!this.Wba)return b.ULS.sendTraceTag(537166873,0,10,"PopulateMenu: Encountered null ribbon section info"),
!1;if(!this.qU)return b.ULS.sendTraceTag(537166872,0,10,"PopulateMenu: Encountered null domain collection"),!1;this.lY=this.lY||this.j9a.CGh(this.Wba,Gb.MenuId);Gb.MenuItems=this.lY;return this.xnd=!0}lZi(){-1===this.xdc&&(this.SGb(),this.xdc=window.setInterval(()=>{this.SGb()},2E3))}SGb(){this.$.ea.fc&&2!==this.us&&(this.qLa--,b.ULS.sendTraceTag(537166870,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted."),this.us=1,G(this.$.pa.va,this.GLi,this.FLi,null,null))}ood(){return this.$.isEditMode&&
2!==this.us&&(0<=this.qLa||!this.S$a)}k_d(lb){e.AFrameworkApplication.Qg?b.ULS.sendTraceTag(537166869,0,50,"UpdatePreviewGalleryVisibility bailed out on shutting down."):y.a(this.$)?(this.uSj(),lb&&this.$.$e()):b.ULS.sendTraceTag(537166868,0,50,"UpdatePreviewGalleryVisibility bailed out on null RibbonManager.")}igj(){this.aEb=0;this.qLa=8;this.S$a=!1;this.us=this.xdc=0;this.VNa=this.Wba=null;this.M2b();for(let lb=0;lb<this.yOa;++lb)this.ria[lb]=null;this.kzb()&&this.k_d(!0)}M2b(){this.lY=null}kzb(){const lb=
v.a.LHb,ac=y.a(this.$);return!!ac&&ac.cm.Yz===lb}keg(){if(this.Wba){let wb=0;if(this.vxa){let qc=-1,Ya=-1,xb=0,wc=0,Oc=0;var lb=0,ac=[null,null,null,null,null];for(var Gb of this.Wba.Categories){let Cb=!1;for(const Ib of Gb.DomainIds){let fc=this.gQ(Ib);fc&&!fc.DomainBlocked&&fc.ShowInRibbon&&(wb<this.yOa?(this.ria[wb]=Ib,wc===ec.D8a&&(-1===qc&&(qc=wb),Ya=wb,lb=Ya-qc+1),++wb):wb===this.yOa&&xb<lb&&wc!==ec.D8a&&(ac[xb]=Ib,++xb),Cb=!0)}Cb&&++Oc;++wc}if(-1<qc&&Oc<=ec.dmf){for(Gb=Ya;Gb>=qc;--Gb)this.ria.splice(Gb,
1);for(Gb=0;Gb<lb;++Gb)this.ria.splice(wb+Gb,0,ac[Gb])}}else for(lb of this.Wba.Categories){for(ac of lb.DomainIds)if((Gb=this.gQ(ac))&&!Gb.DomainBlocked&&Gb.ShowInRibbon&&(this.ria[wb]=ac,++wb,wb>=this.yOa))break;if(wb>=this.yOa)break}for(;wb<this.yOa;)this.ria[wb]=null,++wb}}icg(){var lb=Object(t.a)(425,db.g(this.$).Ea);const ac=this.gridView.ha.Me;return lb&&lb.xjd&&1===ac&&this.gridView.ha.sa.activeCell?(lb=pb.GetServiceTaskFactory.Sa(this.$.da,12,477,1),this.c$=new x.a(this.$,this.svgIconProvider,
lb.result,this),!0):!1}tri(){this.Vn&&this.Vn.Mtd(!0)}launchLinkedEntityDataTypeSelectorPane(lb){if(this.Vn)if(lb=this.B7c(lb))if(lb.DomainId.StringId)b.ULS.sendTraceTag(537166855,0,10,"Domain with a string ID used when launching Data Type Selector pane");else{var ac=gc.r(this.gridView.ha.sa.selectedRanges,this.$);this.Vn.launchLinkedEntityDataTypeSelectorPane(ac,lb.DomainId.Id)}else b.ULS.sendTraceTag(537166856,0,10,"Unknown domain used when launching Data Type Selector pane")}I2g(lb){const ac=this.D8h(lb),
Gb=k.a.zg(this.sBb(lb));lb=k.a.zg(this.IXd(lb));return ec.eGh(ac,Ma.a.Ue(11),Gb,lb)}IXd(lb){try{return this.mKe(parseInt(lb,10)).Description}catch(ac){}return Ha.a.instance.ga(1795)}sBb(lb){try{return this.mKe(parseInt(lb,10)).Name}catch(ac){}return Ha.a.instance.ga(1781)}xVf(lb){try{return this.gQ(lb).Name}catch(ac){}return this.sBb(lb.Id.toString())}DPg(lb){try{return this.gQ(lb).BlankCellResourceId}catch(ac){}return null}e5h(lb){try{return this.gQ(lb).HasBlankCellWalkthrough}catch(ac){}return!1}U7e(lb){try{const ac=
ec.g2a(lb);if(this.qU.lb(ac))return this.qU.na(ac).HasCuratedData}catch(ac){}return!1}aHj(lb){try{return this.gQ(lb).SupportsStarterData}catch(ac){}return!1}Zgf(lb){return 268435968===lb}Kdd(){return 2===y.a(this.$).MR?"[data-unique-id=LinkedEntity_MLR]":"[data-unique-id=LinkedEntity]"}F4b(){return new ma.a(-847286761,mb.a.Gb,this.$.Kc,0,v.a.dW)}lFe(){if(this.kzb()&&!this.ood()&&!this.Ief&&vb.EwaSettings.ma(440)&&this.U7e({Id:268435968,StringId:null}))if(b.ULS.sendTraceTag(537166819,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - tried to launch first org data teaching callout"),
qa.a.wg.TQ){const Gb=this.Kdd();if(Gb){var lb=this.F4b();if(lb){var ac={["InputMethod"]:mb.a.Gb,CalloutName:6};ac.Target=Gb;ac.ShouldCanvasTakeFocus=!0;this.$.Ka.Lb(lb,ac);this.Ief=!0}else b.ULS.sendTraceTag(537166817,0,10,"RibbonCommandInfo is null for firstOrgData")}else b.ULS.sendTraceTag(537166818,0,10,"CalloutAnchorElement is null for firstOrgData")}else b.ULS.sendTraceTag(537166816,0,50,"ConvertToLinkedEntityManager:CreateLinkedEntityFirstOrganizationDataCallout() - Attempted to launch firstOrgData callout, teaching callout not enabled")}b8h(lb){lb=
this.B7c(lb);return lb?this.j9a.lOg(lb.SubdomainFontLocator):(b.ULS.sendTraceTag(537166815,0,10,"ConvertToLinkedEntityManager.IconFromDomainFontLocator: Requested domain that doesn't exist in collection"),null)}Wfc(lb){return this.c$?this.c$.kOg(lb):!1}jJh(){return this.c$?this.c$.eKh():""}dfi(){return this.c$?this.c$.YBb:!1}XNh(lb,ac){const Gb=this.jaf(lb);if(0>Gb)b.ULS.sendTraceTag(537166813,0,10,`Unexpected menuItemKey for dynamic preview gallery button: ${lb}`);else if(lb=(lb=this.nKe(lb))?this.gQ(lb):
null)ac[l.a.GalleryButtonProps]=this.j9a.cHh(Gb,lb),ac[l.a.Alt]=this.j9a.sed(lb)}vUf(){this.keg();this.kzb()&&this.k_d(!0);this.M2b()}D8h(lb){return lb===this.STe?r.a.$Qe:lb===this.dXe?r.a.YQe:r.a.XQe}XRe(lb){try{return this.gQ(lb).ExampleEntities}catch(ac){}return Ha.a.instance.ga(1803)}JId(){(0>this.qLa||this.S$a)&&b.ULS.sendTraceTag(537166811,0,15,"RefreshFullGalleryIfOpened: Out of GetLinkedEntityServiceDomain retries");(2===this.us||0>this.qLa||this.S$a)&&window.clearInterval(this.xdc);this.ood()?
this.Ecd&&this.$.frame.ax(this.Ecd):this.k_d(this.kzb())}Hb(lb){return this.$.Cb+lb}uSj(){var lb=!0;const ac=Array(this.yOa),Gb=y.a(this.$)?y.a(this.$).cm:null;if(Gb){for(let wb=0;wb<ac.length;++wb)this.cxj(wb)?ac[wb]=!0:lb=ac[wb]=!1;Gb.$wc(["ConvertToLinkedEntityGallery"],lb);if(!lb)for(lb=0;lb<ac.length;++lb)ac[lb]&&Gb.$wc([this.WNh(lb)],!0)}else b.ULS.sendTraceTag(537166809,0,15,"UpdateLinkedEntityGalleryButtonsVisibility: ribbonUser should not be null")}gQ(lb){const ac=ec.g2a(lb);if(this.qU.lb(ac))return this.qU.na(ac);
b.ULS.sendTraceTag(592729218,0,15,`No domain data for domain ID ${lb.Id} (Has String ID: ${!!lb.StringId})`);return null}WNh(lb){return"ConvertToLinkedEntityPreview"+lb.toString()}b_d(){m.a.get_instance().yk(10,()=>{this.lFe();this.j_c&&this.agf&&bb.c(this.Elf,this.$.la,500)})}ldc(lb,ac){switch(lb){case "QueryLinkedEntityGalleryButtons":if(!ac[l.a.InnerHTML]){lb=ac[mb.a.Qc].toString();const Gb=jc.a.equals(lb,Ha.a.instance.ga(1798),!0)||jc.a.equals(lb,Ha.a.instance.ga(1799),!0),wb=jc.a.equals(lb,Ha.a.instance.ga(1800),
!0);Gb||wb||this.XNh(lb,ac)}break;case "QueryLinkedEntityMenuGalleryButtons":ac[l.a.InnerHTML]||(ac[l.a.InnerHTML]=this.I2g(ac[mb.a.Qc]))}return ac}Rih(lb){var ac=this.nKe(lb);if(ac)return ac;if(ac=this.B7c(lb))return ac.DomainId;b.ULS.sendTraceTag(537166805,0,10,`Could not convert key into domain: ${lb}`);return null}mKe(lb){const ac={};ac.Id=lb;return this.gQ(ac)}B7c(lb){return this.qU.lb(lb)?this.qU.na(lb):null}jaf(lb){if(!lb.startsWith(ec.V7c))return-1;const ac=parseInt(lb.substr(ec.V7c.length),
10);return isNaN(ac)?(b.ULS.sendTraceTag(537166802,0,10,`Unexpected index in preview gallery button key: ${lb}`),-1):ac}nKe(lb){lb=this.jaf(lb);return 0>lb?null:this.ria[lb]}mcf(lb,ac,Gb){this.Rzb&&this.qU&&this.qU.count&&(b.ULS.sendTraceTag(537166801,0,50,`ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. (${lb})`),lb=this.$.pa.va.Tb(),this.$.ea.fc&&na(this.$.pa.va,Va.b(this.lOi,ac),Gb,null,null,lb))}cNj(){this.mcf("Auto-refresh on load",null,null)}gNj(){this.Rzb&&this.qU&&this.qU.count&&
(this.sza?b.ULS.sendTraceTag(537166799,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one"):this.$.ea.Eo.HasAutoRefreshableLinkedEntityDomainsEver?(b.ULS.sendTraceTag(537166797,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context"),this.sza=Fa.a.instance.create(this.a_c,this.K0b,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck")):
b.ULS.sendTraceTag(537166798,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created"))}lzc(){if(this.$.ea.fc&&null!=this.m7a&&null!=this.qqd&&null!=this.rqd&&null!=this.xsd&&null!=this.Brd)if(++this.aEb,12>=this.aEb){1===this.aEb&&(this.tjd=tb.a.Pa.me.m,b.ULS.sendTraceTag(537166752,0,50,"StartLinkedEntityDelayedHandshake - starting handshake."));const lb=this.$.pa.va.Tb();
jb.s(this.$.pa.va,this.Asi,this.Bsi(),this.mPi,this.lPi,null,lb)}else b.ULS.sendTraceTag(537166751,0,15,`StartLinkedEntityDelayedHandshake - Retry count expired - failed handshake duration ${tb.a.Pa.me.m-this.tjd} ms`),this.S$a=!0,this.JId()}hze(){if(this.$.isEditMode)if(null!=this.m7a)this.lzc();else{var lb=tb.a.Pa.me.m,ac=[];u.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Gb=>{Gb.isFeatureEnabled("ExcelPowerBiPro",!1).then(wb=>{b.ULS.sendTraceTag(537166747,
0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPro"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166746,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPro"}] isEnabled=[${wb}]`);return this.m7a=wb}).then(()=>{ac.push(Gb.isFeatureEnabled("ExcelWolframAlpha",!1).then(wb=>{b.ULS.sendTraceTag(590960588,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelWolframAlpha"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166743,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelWolframAlpha"}] isEnabled=[${wb}]`);return this.xsd=wb}))}).then(()=>{ac.push(Gb.isFeatureEnabled("ExcelDisableStockGeographyDataTypes",!1).then(wb=>{b.ULS.sendTraceTag(537166741,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelDisableStockGeographyDataTypes"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166740,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelDisableStockGeographyDataTypes"}] isEnabled=[${wb}]`);
let qc;const Ya=[(qc=new Kb.a,qc.name="IsRestrictedByLicense",qc.bool=wb,qc)];Jb.a("SatoriStockGeographyLicensingRestrictions",void 0,void 0,Ya);this.Bif=wb&&vb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StockGeographyLicensingCheck",!1);return wb}))}).then(()=>{ac.push(Gb.isFeatureEnabled("StockHistory",!1).then(wb=>{b.ULS.sendTraceTag(537166739,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"StockHistory"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166738,
0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"StockHistory"}] isEnabled=[${wb}]`);return this.Brd=wb}))}).then(()=>{ac.push(Gb.isFeatureEnabled("ExcelPowerBiFree",!1).then(wb=>{b.ULS.sendTraceTag(537166736,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiFree"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166735,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiFree"}] isEnabled=[${wb}]`);return this.qqd=wb}))}).then(()=>
{ac.push(Gb.isFeatureEnabled("ExcelPowerBiPremiumPerUser",!1).then(wb=>{b.ULS.sendTraceTag(537166734,0,50,`CheckE5LicensingAndStartDelayedHandshake for ${"ExcelPowerBiPremiumPerUser"} takes ${tb.a.Pa.me.m-lb} Millisecond.`);b.ULS.sendTraceTag(537166733,0,50,`CheckE5LicensingAndStartDelayedHandshake: featureName=[${"ExcelPowerBiPremiumPerUser"}] isEnabled=[${wb}]`);return this.rqd=wb}))}).then(()=>{Promise.all(ac).then(()=>{this.lzc()})})})}}get Asi(){return"ExcelPowerBiPro ExcelWolframAlpha StockHistory ExcelPowerBiFree ExcelPowerBiPremiumPerUser ExcelDisableStockGeographyDataTypes".split(" ")}Bsi(){return[this.m7a,
this.xsd,this.Brd,this.qqd,this.rqd,this.Bif]}VJd(){this.businessBar&&this.businessBar.Aka(58)&&this.businessBar.removeEntry(58)}s3h(lb){this.kud!==lb&&this.businessBar&&((this.kud=lb)?da(this.$.pa.va,this.iLi,null,null,null):this.VJd())}static eGh(lb,ac,Gb,wb){lb=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"></span>',lb,ac,wb);Gb=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}</p></div>',
Gb);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}</div>',lb,Gb)}static g2a(lb){return lb.StringId?lb.Id.toString()+"."+lb.StringId:lb.Id.toString()}}ec.$Ke="ConvertToLinkedEntityPreview";ec.V7c="PreviewGalleryButtonIndex.";ec.D8a=0;ec.dmf=2;Object(c.a)(ec,"ConvertToLinkedEntityManager",w.a,[426,427,10,428])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.le.js.map/eae54a07af6be57846aef0203d3efb98/EwaDSEsNext.le.js.map