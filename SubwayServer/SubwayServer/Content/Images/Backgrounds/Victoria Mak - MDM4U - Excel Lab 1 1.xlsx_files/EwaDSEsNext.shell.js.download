'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1251:function(n,C,a){n=a(0);var c=a(553),b=a(84),d=a(15),f=a(155),e=a(4),k=a(41),l=a(80),m=a(767);class u{constructor(v,y){this.lRc=this.kRc=null;this.aYa=new f.a;this.zh=v;this.AFa=y.appSettings[u.oXj]||""}get Pvj(){return this.aYa.task}get W2(){return this.zh.value}Mfj(){const v={};v[u.Z4h]=e.AFrameworkApplication.qj;v["Content-Type"]="application/json; charset=utf-8";d.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");
const y=l.a.Kl(this.AFa+u.Qvj,u.sFi,e.AFrameworkApplication.ta.Oa.Dj.toString());this.W2.Jm(y,1,"",v,!0,2,Object(b.a)(this,this.GFb,"onSuccessCallback"),Object(b.a)(this,this.REb,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}Pvi(v){try{const y={};y.FlightName=v.FlightName;y.SessionID=v.SessionID;d.ULS.sendTraceTag(594883776,215,50,k.c(y))}catch(y){d.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}GFb(v){if((v=v.data.Xd)&&v.length)try{const y=k.a(v);this.kRc=y.NavBarDataJson;
d.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.kRc?({fu:this.lRc}=k.d(y.NavBarDataJson)).returnValue?(this.Pvi(this.lRc),this.aYa.setResult(this.lRc)):(d.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:m.a.kfb(this.kRc)}),this.aYa.Ht()):(d.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.aYa.Ht())}catch(y){d.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.aYa.Ht()}else d.ULS.sendTraceTag(6362369,
215,10,"Response from O365ShellServiceProxy is null.")}REb(){this.aYa.Ht();d.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return u.Ma||(u.Ma=u.hvb())}static hvb(){return new u(new c.a(()=>e.AFrameworkApplication.yd),e.AFrameworkApplication.fa,e.AFrameworkApplication.ta.Oa.Dj)}}u.Z4h="X-qs";u.sFi="at";u.Qvj="O365ShellServiceProxy.ashx";u.Ma=null;u.oXj="ShellWebServiceBase";Object(n.a)(u,"O365ShellActor",null,[259]);var t=a(247);class w{constructor(){this.gb=
null}get name(){return"Common.App.O365Shell"}Wh(v){this.gb=v;this.gb.register(u,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").wc().Fc(()=>new u(new c.a(()=>e.AFrameworkApplication.yd),e.AFrameworkApplication.fa,e.AFrameworkApplication.ta.Oa.Dj))}init(){e.AFrameworkApplication.fa.qv(Object(b.a)(this,this.zB,"onFullAppSettingsReady"))}zB(){e.AFrameworkApplication.useO365ShellService&&e.AFrameworkApplication.ta.Oa.ps&&this.gb.resolve("Common.App.O365Shell.O365ShellActor").Mfj()}dispose(){}static main(){t.a.instance.Gi(new w)}}
Object(n.a)(w,"PackageManager",null,[3,4]);a.d(C,"a",function(){return r});const r=()=>{Type.registerNamespace("Common.App.O365Shell");w.main()}},1394:function(n,C,a){a.r(C);n=a(1251);Object(n.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.shell.js.map/64d1d97cee6892c240bcc738ce1a54f7/EwaDSEsNext.shell.js.map