'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1078:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}')}},
1079:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b,d){this.command=0;this.selectedRanges=null;this.command=b;this.selectedRanges=d}ot(){return this.command}}Object(n.a)(c,"MacroRecorderRangeOperationAppliedPayload",null,[115])},1080:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}")}},
1081:function(n,C,a){a.d(C,"a",function(){return"FieldInfoListContextLoaded"});a.d(C,"h",function(){return"GetFieldInfoListContextOperationFailed"});a.d(C,"d",function(){return"Days from Today"});a.d(C,"g",function(){return"Years from Today"});a.d(C,"c",function(){return"Day of the Week"});a.d(C,"f",function(){return"Month of the Year"});a.d(C,"e",function(){return"End of Month"});a.d(C,"b",function(){return"Next Day"})},1082:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>
{c.a.Qi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}")}},
1083:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}")}},
1085:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-facp-text-box{position:absolute}")}},1086:function(n,C,a){a.d(C,"b",function(){return"MinorThemeFont"});a.d(C,"a",function(){return"MajorThemeFont"})},1088:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}')}},
1089:function(n,C,a){a.d(C,"a",function(){return l});n=a(0);C=a(236);var c=a(5),b=a(33),d=a(11),f=a(21),e=a(34),k=a(4);class l extends C.a{constructor(m){super(document.createElement("div"));this.aR=this.FIa=this.EIa=this.GIa=this.IIa=this.HIa=!1;this.bJ=null;this.visible=void 0;this.Pnc=(u,t)=>{this.At(u,t)};this.VLa=()=>{this.Ya.textBox.xF=!0};this.aza=()=>{this.Vy(!0)};this.Jvf=()=>{this.Ya.textBox.focus()};this.Hh=()=>{f.g(this.$).inRangePicker||(this.se=!1)};this.$=m;f.g(m)&&f.g(m).ha&&f.g(this.$).ha.vJ(this.Hh);
this.Wk=b.a.J4()}get fI(){return this.Zt.fI}get se(){return this.Zt.se}set se(m){this.Zt.se=m}get Ya(){return this.bJ}set Ya(m){(this.bJ=m)&&this.bJ.K0d.add(this)}get sEh(){return b.a.kN(this.$)?-5:-40}get_visible(){return void 0!==this.visible?this.visible:this.visible=super.get_visible()}set_visible(m){if(this.visible===m)return m;this.visible=m;return super.set_visible(m)}At(){this.SBa(!1);this.Zt.At()}dispose(){this.$&&f.g(this.$)&&f.g(this.$).ha&&f.g(this.$).ha.bL(this.Hh);this.$=null;super.dispose()}Yh(m,
u,t=!1){m=!1;if((this.t1a||t)&&!this.hxa()&&this.get_visible()&&this.se)switch(this.Wk&&this.YBc(u),u){case 1872288872:this.se=!1;m=!0;break;case -798660877:this.Zt.vB(1);m=!0;break;case 137938150:this.Zt.vB(-1);m=!0;break;case 2091832999:this.Zt.vB(this.fI-1);m=!0;break;case 742457698:this.Zt.vB(-(this.fI-1));m=!0;break;case 125627505:m=this.Vy(!1);break;case 267796030:b.a.J4()&&(m=this.Vy(!1))}return m}SBa(m){if(this.se||m){var u=f.g(this.$);m=u.domElement;var t=this.bJ.textBox.domElement,w=e.a(this.$).Ci(t.offsetHeight),
r=e.a(this.$).Ci(t.offsetTop),v=e.a(this.$).Ci(t.offsetWidth);t=e.a(this.$).Ci(t.offsetLeft);u=u.tm;var y=k.AFrameworkApplication.ta&&k.AFrameworkApplication.ta.Oa.We,x=$get(this.$.Cb+c.a.v0a,this.$.domElement);y&&(x=document.getElementById("EditorContainer"));var B=new Sys.UI.Point(u?this.Zt.I$b:0,u?this.sEh:l.Y1h);w=x.offsetTop+B.y+(b.a.kN(this.$)&&u?0:w+r);this.$.MZ||(r=$get(c.a.gsa,this.$.domElement),w+=r&&!y?r.offsetHeight:0);r=this.domElement;r.style.top=d.HelperMethods.pc(w);t=x.offsetLeft+
t+B.x;!b.a.kN(this.$)&&this.$.isChromeRtl?r.style.right=d.HelperMethods.pc(u?this.Zt.I$b:m.offsetLeft+m.offsetWidth-t-v):r.style.left=d.HelperMethods.pc(t)}}yTa(m){this.Zt&&(m&&!this.aR?(this.Zt.C9(this.Jvf),this.Zt.OZb(this.VLa),this.Zt.Fnb(this.aza),this.aR=!0):this.aR&&(this.Zt.mda(this.Jvf),this.Zt.ltc(this.VLa),this.Zt.fJb(this.aza),this.aR=!1))}YBc(m){switch(m){case -798660877:case 137938150:case 2091832999:case 742457698:this.HIa=!0;break;case 125627505:this.GIa=!0;break;case 267796030:b.a.J4()&&
(this.EIa=!0)}}}l.I$b=0;l.Y1h=1;Object(n.a)(l,"AutoCompleteControl",C.a,[600])},1090:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c extends Sys.EventArgs{constructor(b,d=0,f="",e=""){super();this.length=b;this.selectedIndex=d;this.jG=f;this.description=e}}Object(n.a)(c,"ListEventArgs",Sys.EventArgs,[])},1091:function(n,C,a){a.d(C,"a",function(){return r});n=a(0);var c=a(15),b=a(27);C=a(838);var d=a(775),f=a(5),e=a(77),k=a(33),l=a(12),m=a(1),u=a(117),t=a(21),w=a(911);class r extends C.a{constructor(v,
y){super(v,y,new w.a(d.a.listItem,d.a.jCb,d.a.mCb,d.a.nCb));this.bdc=!1;this.Dlb=this.zr=null;this.VVe=!1;this.visible=void 0;this.lBa(!0);this.VVe=m.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash")}get I$b(){if(k.a.kN(this.$)){var v=document.getElementById(this.$.Cb+f.a.UVe);return!this.VVe||v?l.DOMElementExtensions.getBoundingClientRect(v).x:0}v=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(f.a.hyd):document.getElementById(this.$.Cb+
f.a.hyd+"-"+f.a.Isf);c.ULS.shipAssertTag(537170323,0,!!v||this.$.vK,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return v?v.offsetWidth:0}get fe(){return this.Dlb}set fe(v){this.Dlb=v}get se(){return void 0!==this.visible?this.visible&&0<this.zr.length:(this.visible=l.DOMElementExtensions.isVisible(this.gg))&&0<this.zr.length}set se(v){this.visible!==v&&(l.DOMElementExtensions.setVisible(this.gg,v),l.DOMElementExtensions.setVisible(this.ZTa,v),this.visible=
v);const y=t.g(this.$).view;v?this.bdc||(y.Xs(this.FGa.Pnc),this.bdc=!0):(this.zr.length=0,this.bdc&&(y.Zq(this.FGa.Pnc),this.bdc=!1))}tya(){var v=460;const y=t.g(this.$);var x=y.domElement,B=this.ZTa.style;const z=this.gg.offsetTop+this.Lj.offsetHeight*this.Lj.sectionRowIndex-this.gg.scrollTop;B.width="auto";B.whiteSpace="nowrap";B.position="absolute";const A=x.offsetLeft+x.offsetWidth-(this.domElement.offsetLeft+this.gg.offsetLeft+this.gg.offsetWidth+3);x=this.domElement.offsetLeft-3-(x.offsetLeft+
this.I$b);v=Math.min(this.ZTa.offsetWidth,v,Math.max(A,x));l.DOMElementExtensions.Jv(this.ZTa,v);B.whiteSpace="";B.position="absolute";z+3>this.gg.offsetTop+this.gg.offsetHeight||z<this.gg.offsetTop||(v=this.gg.offsetLeft-3-this.ZTa.offsetWidth,B=this.gg.offsetLeft+this.gg.offsetWidth+3,l.DOMElementExtensions.updatePosition(this.ZTa,x>A!==y.rtl?v:B,z,!1))}vB(v){super.vB(v);this.tya()}At(){this.tya()}Zra(){const v=this.zn,y=this.gg,x=3===e.a.Gb||b.a.Ap,B=x?this.eDb:this.fI;this.se=!0;y.style.height=
"auto";this.FGa.set_visible(!0);this.knb(v,x);this.zr.length>B?(l.DOMElementExtensions.TI(y,Math.floor(y.offsetHeight*B/this.zr.length)),y.style.overflowY="auto"):m.EwaSettings.whc()||(y.style.height="auto",y.style.overflowY="hidden");l.DOMElementExtensions.Jv(y,v.offsetWidth+(this.zr.length>B?u.a.xu:0))}}Object(n.a)(r,"AutoCompleteListBox",C.a,[])},1092:function(n,C,a){a.d(C,"a",function(){return t});n=a(0);var c=a(223),b=a(13),d=a(108),f=a(237);C=a(236);var e=a(556),k=a(5),l=a(53),m=a(12),u=a(71);
class t extends C.a{constructor(w,r,v,y,x,B,z,A,I,F){super(document.createElement("a"));this.cn=!1;this.gd=U=>{this.raiseEvent("ClickButton",U);return!0};this.onKeyDown=U=>{this.raiseEvent("KeyDown",U);return!1};this.Gw=()=>{this.hovered=!0;this.raiseEvent("PointerOver");return!1};this.PN=()=>{this.hovered=!1;this.raiseEvent("PointerOut");return!1};this.onBlur=U=>{u.g(U);this.focused=!1;this.raiseEvent("Blur")};this.onFocus=U=>{u.g(U);this.focused=!0;this.raiseEvent("Focus")};this.Glh=A;this.Rgh=
I;this.hJ=t.qb(this.domElement,r,v,y,x,B,z,F);this.Gc.ka("contextmenu",U=>{u.g(U)});this.enable();this.focused=this.hovered=!1;w.appendChild(this.domElement)}sVc(w){this.get_events().addHandler("ClickButton",w)}gKd(w){this.get_events().removeHandler("ClickButton",w)}GVc(w){this.get_events().addHandler("KeyDown",w)}uKd(w){this.get_events().removeHandler("KeyDown",w)}c_b(w){this.get_events().addHandler("PointerOver",w)}FKd(w){this.get_events().removeHandler("PointerOver",w)}b_b(w){this.get_events().addHandler("PointerOut",
w)}EKd(w){this.get_events().removeHandler("PointerOut",w)}rnb(w){this.get_events().addHandler("Blur",w)}RIb(w){this.get_events().removeHandler("Blur",w)}C9(w){this.get_events().addHandler("Focus",w)}mda(w){this.get_events().removeHandler("Focus",w)}get Al(){return this.hJ}get isEnabled(){return this.cn}enable(){this.domElement&&(this.domElement.classList.remove(e.a.dU),this.domElement.style.cursor="",c.a.instance.ra(b.a.click,this.domElement,this.gd),d.KeyInputManager.instance.ra(b.a.Qb,this.domElement,
this.onKeyDown),f.a.instance.ra(b.a.pointerOver,this.domElement,this.Gw),f.a.instance.ra(b.a.pointerOut,this.domElement,this.PN),this.Gc.tn("blur")||this.Gc.ka("blur",this.onBlur),this.Gc.tn("focus")||this.Gc.ka("focus",this.onFocus),this.domElement.title=this.Glh,this.cn=!0)}disable(){this.domElement&&(this.domElement.classList.add(e.a.dU),this.domElement.style.cursor="",this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),d.KeyInputManager.instance.Ba(b.a.Qb,this.domElement,this.onKeyDown),
f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Gw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.PN)),this.domElement.title=this.Rgh,this.cn=!1)}dispose(){this.isEnabled&&(c.a.instance.Ba(b.a.click,this.domElement,this.gd),d.KeyInputManager.instance.Ba(b.a.Qb,this.domElement,this.onKeyDown),f.a.instance.Ba(b.a.pointerOver,this.domElement,this.Gw),f.a.instance.Ba(b.a.pointerOut,this.domElement,this.PN),this.cn=!1);m.DOMElementExtensions.setVisible(this.domElement,!1);super.dispose()}static qb(w,
r,v,y,x,B,z,A){w.removeAttribute("Href");w.setAttribute(k.a.Kd,k.a.Ys);w.className=r;w.tabIndex=A;r=document.createElement("span");r.className=z;r.classList.add(v);r.tabIndex=-1;w.appendChild(r);w=document.createElement("img");w.src=l.a.Ue(y);w.className=x;w.alt=B;w.tabIndex=-1;r.appendChild(w);return w}}Object(n.a)(t,"ListButton",C.a,[680,10])},1134:function(n,C,a){function c(Za){var Pa;if(Za){var Ab=new Xe(0===Za.kind);Za=null===(Pa=null===Za||void 0===Za?void 0:Za.rangeInfo)||void 0===Pa?void 0:
Pa.positionKindInfo;if(!Za)return Ab;Ab.DF=0===Za.firstRow;Ab.CF=0===Za.firstColumn;Ab.rK=0===Za.secondRow;Ab.qK=0===Za.secondColumn;return Ab}}var b=a(9),d=a(0),f=a(694),e=a(50),k=a(37),l=a(15),m=a(19),u=a(381),t=a(77);class w{}w.P$c="!";w.IGf="[";w.HGf="]";w.openParen="(";w.closeParen=")";w.nig=" /.(*\\".split("");w.R7b="...";w.nGb="param_help_link";w.TDd="param_help_udf";w.Kcd="function_list_box";w.mFh="function_param_box";w.Mcd="function_reader_description";w.Gcd="function_description_box";w.pWe=
"function_param_table";w.vWi="param_row_";w.UDd="param_set";w.rHf="param_row_0";w.sHf="param_row_1";w.nFh="<div id='{0}' class='{1}'></div>";w.lFh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";w.tHf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";w.iFh="<div id='{0}' class='{1} {2} {3}'></div>";w.gFh="<div id='{0}' class='{1} {2} {3} {4}'></div>";
w.Klf="[@";w.$4g=1;w.Z4g=3;w.feh=500;w.irf=50;Object(d.a)(w,"FormulaAssistanceConstants",null,[]);var r=a(14),v=a(284),y=a(8),x=a(5),B=a(90),z=a(11),A=a(21),I=a(353),F=a(436),U=a(255);const X=(Za,Pa,Ab)=>{if(Za){const Aa=Za.da.za(491);Aa?Aa.X9.argumentAssistanceLearnMoreCounter++:l.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");Ab?T(Za,Pa,Ab):(Ab=new B.a(-859308420,t.a.Gb,Za.Kc,0,null),Za.Ka.Lb(Ab,{[t.a.Qc]:x.a.aV,
[t.a.kg]:"HelpID="+Pa}))}},T=(Za,Pa,Ab)=>{if(Ab){if(Pa&&(!Pa||Pa.startsWith("http://")||Pa.startsWith("https://"))){if(Za.ma(156)&&(Za=Object(F.a)({sEb:269,new:U.b,registry:Za.da}))&&Za.Doa(Pa))return;z.HelperMethods.Ze(Pa,"_blank",I.a)}}else z.HelperMethods.KV(Za.xG,"XLWAEndUser_"+Pa,Za.sS)},G=Za=>{let Pa=y.a.u_;const Ab=Za.da.za(368);Ab&&!A.g(Za).tm&&(Pa=Ab.zoom);return Pa};var D=a(33),J;(function(Za){Za.CategoryList="categoryList";Za.FunctionsMap="functionsMap";Za.FunctionIdsToDisplay="functionIdsToDisplay";
Za.RefreshListCallback="refreshListCallback";Za.HelpCallback="helpCallback";Za.InitialCategory="initialCategory";Za.AllCategoryName="allFunctionsCategoryName"})(J||(J={}));Object(d.b)("PropsKeys",J);class L extends v.a{constructor(Za){super(Za);this.kWe=(Pa,Ab)=>{1===Pa&&(this.hide(),Pa={[t.a.Qc]:Ab.functionName,["ibdk"]:!0},Ab=D.a.dxa(this.$)?1117706454:-433697611,Ab=new B.a(Ab,0,this.$.Kc,8,null),this.$.Ka.Lb(Ab,Pa))};this.onFunctionInfoLoaded=()=>{this.functionInfoManager.Lbb(this.onFunctionInfoLoaded);
this.Faf()};this.t6h=Pa=>{T(this.$,Pa,!1)};this.Egf=Pa=>!this.functionInfoManager.Mgc(Pa);this.Nl=r.a.instance.ga(1034);this.functionInfoManager=Za.da.za(19);this.Ag()}get uc(){return"FunctionDialog"}Ag(){this.functionInfoManager.eJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0);this.Rb=1;this.functionInfoManager.lV?this.Faf():this.functionInfoManager.XFa(this.onFunctionInfoLoaded)}Faf(){var Za;this.F_b=this.functionInfoManager.P$b.filter(this.Egf);const Pa=null!==(Za=L.Ekf)&&void 0!==
Za?Za:L.k1g;Za=this.functionInfoManager.Fcd;const Ab=this.functionInfoManager.ibc(Pa).map(Aa=>Aa.FunctionIndex);this.Kx={[L.dv]:this.uc,[J.CategoryList]:Za,[J.FunctionsMap]:this.P7g(),[J.FunctionIdsToDisplay]:Ab,[J.RefreshListCallback]:this.nNi.bind(this),[J.HelpCallback]:this.t6h,[J.InitialCategory]:Pa,[J.AllCategoryName]:L.AllCategoryName};this.initializeAndShow(this.Nl,this.kWe,this.Kx)}P7g(){let Za={};this.F_b.forEach(Pa=>{Za[Pa.FunctionIndex]=Pa});return Za}tRj(Za){Za=Za.map(Pa=>Pa.FunctionIndex);
this.Kx[J.FunctionIdsToDisplay]=Za;this.rUa(this.Nl,this.O4a(this.kWe),this.Kx)}nNi(Za,Pa){Pa?Pa=this.MAh(Pa):(Pa=this.functionInfoManager.ibc(Za).filter(this.Egf),L.Ekf=Za);this.tRj(Pa)}MAh(Za=""){Za=Za.toLocaleLowerCase();const Pa=this.F_b.filter(({NameUI:Ab})=>Ab.toLocaleLowerCase().startsWith(Za));3<=Za.length&&(Pa.push(...this.F_b.filter(Ab=>Ab.NameUI.toLocaleLowerCase().includes(Za)&&!Pa.includes(Ab))),Pa.push(...this.F_b.filter(Ab=>Ab.Help.toLocaleLowerCase().includes(Za)&&!Pa.includes(Ab))));
return Pa}}L.AllCategoryName=r.a.instance.ga(1033);L.k1g=r.a.instance.ga(1032);L.Ekf=void 0;Object(d.a)(L,"FunctionDialog",v.a,[]);var H=a(97),R=a(55),Q=a(64),O=a(86),V=a(27),W=a(210),da=a(73),ta=a(119),K=a(225),na=a(53),P=a(727),ka=a(12),pa=a(71),Na=a(1);const Z=da.a.gph,Ra=da.a.jOe,Da=da.a.kOe,Ba=da.a.J9c,ea=da.a.iph,Y=da.a.mph,ja=da.a.gOe,ca=da.a.nOe,ba=da.a.kph,ua=da.a.hOe;class wa extends W.a{constructor(Za,Pa){super(Za,r.a.instance.ga(1034),void 0,void 0,void 0,Na.EwaSettings.ma(395));this.Vub=
this.Omf=this.rWe=this.oWe=this.ija=this.nWe=this.Yub=this.$Ja=this.jja=this.aKa=null;this.Xjd=!1;this.Gxb=this.T5=this.f2b=null;this.onFunctionInfoLoaded=()=>{if(!this.$Ja.count){const Ab=this.functionInfoManager.Fcd;for(let Aa=0,rb=Ab.length;Aa<rb;++Aa)this.$Ja.hM(Ab[Aa],Ab[Aa],!1).className=da.a.hph;this.$Ja.selectedIndex=0;O.a.qc([this.f2b,this.T5,this.Gxb]);this.f2b=this.ve.$d(this.aKa);this.T5=this.ve.$d(this.jja);this.Gxb=this.ve.$d(this.Vub);this.f2b.ka("change",this.Yyf);this.T5.ka("change",
this.LKi);this.T5.ka("dblclick",this.MKi);this.Gxb.ka("click",this.wca);this.Gxb.ka("keyup",this.TMi);ka.DOMElementExtensions.setVisible(this.jja,!0);ka.DOMElementExtensions.setVisible(this.nWe,!1);this.$.O5c&&ka.DOMElementExtensions.setVisible(this.Omf,!0)}this.Yyf(null);this.getButton(0).get_element().disabled=!1;this.aKa.disabled=!1;this.jSa();this.Xjd=!0};this.wca=()=>{this.M$&&X(this.$,this.M$.HelpId,this.M$.IsDynamicUdf)};this.TMi=Ab=>{13!==Ab.keyCode&&32!==Ab.keyCode||this.wca(Ab)};this.Yyf=
()=>{const Ab=this.functionInfoManager.ibc(this.$Ja.fe.value);this.dva(Ab);this.jja.scrollTop=0;this.t_f()};this.LKi=()=>{this.t_f()};this.MKi=Ab=>{this.M$&&(pa.g(Ab),this.close(0))};this.Wc=(Ab,Aa)=>{K.b(Aa)&&this.Zu()};this.functionInfoManager=Za.da.za(19);this.formulaAssistanceControl=Za.da.za(221);if(this.Mub=D.a.hV(this.$))this.formulaAssistanceManager=Za.da.za(464);this.IM=Pa}get uc(){return"FunctionDeprecatedDialog"}get M$(){if(!this.jja||!this.jja.firstChild)return null;const Za=Number.parseInvariant(this.jja.children[this.jja.selectedIndex].value);
return this.functionInfoManager.TPh(Za)}initialize(){this.Pb.classList.add(da.a.eph);this.Pb.innerHTML=wa.hH();this.hf||(this.Co(),this.Iga());super.initialize();const Za=ka.DOMElementExtensions.fk(this.Pb,ua);this.rtl&&(Za.align="right",this.Vub.style.marginLeft="5px");this.hf&&(Za.style.padding="1px");this.functionInfoManager.eJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)}dispose(){this.functionInfoManager&&(this.functionInfoManager.Lbb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.Pk(this.Wc));
O.a.qc([this.f2b,this.T5,this.Gxb,this.$Ja,this.Yub]);super.dispose()}Co(){this.aKa=ka.DOMElementExtensions.fk(this.Pb,Z);this.jja=ka.DOMElementExtensions.fk(this.Pb,Ra);this.aKa.setAttribute(x.a.Kd,x.a.h0b);this.$Ja=new P.a(this.aKa,!0);this.Yub=new P.a(this.jja,!0);this.nWe=ka.DOMElementExtensions.fk(this.Pb,Y);this.Vub=ka.DOMElementExtensions.fk(this.Pb,ea);this.rWe=ka.DOMElementExtensions.fk(this.Pb,ca);this.Omf=ka.DOMElementExtensions.fk(this.Pb,ba);this.oWe=$get(wa.Hcd,this.Pb);this.ija=ka.DOMElementExtensions.fk(this.Pb,
ja);this.hf&&(this.ija.style.paddingLeft="1px");this.functionInfoManager.XFa(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.rk(this.Wc)}KQ(Za){this.$.da.Za(40,()=>{this.$Ja.KQ(Za)})}Po(){this.Mub?this.formulaAssistanceManager.U6b():this.formulaAssistanceControl.set_visible(!1);super.Po();this.Xjd||(this.getButton(0).get_element().disabled=!0)}setFocus(){!this.aKa.disabled&&this.Xjd&&ka.DOMElementExtensions.setFocus(this.aKa)}commit(){return!0}Kqb(){let Za=this.M$.NameDataStrings;const Pa=
new B.a(-433697611,0,this.$.Kc,8,null);this.$.Ka.Lb(Pa,{[t.a.Qc]:Za})}Isa(){this.Mub?this.formulaAssistanceManager.sda():this.formulaAssistanceControl.yob()}dva(Za){this.Yub.clear();const Pa=wa.Hcd+" "+wa.iWe;for(let Ab=0,Aa=Za.length;Ab<Aa;++Ab){const rb=this.Yub.hM(Za[Ab].NameUI,Za[Ab].FunctionIndex.toString(),!1);V.a.tv&&rb.classList.add(Ba);rb.setAttribute(x.a.CE,wa.jWe);rb.setAttribute(x.a.yJ,Pa)}this.Yub.selectedIndex=0}t_f(){if(this.M$){this.Vub.parentNode.className=da.a.hOe+(this.functionInfoManager.Mgc(this.M$)?
"-udf":"");var Za=this.M$.NameDataStrings;this.rWe.innerText=Za;this.Vub.innerText=Za;this.ija.innerText=this.M$.Help;Za=this.M$.Params.split(w.P$c);this.oWe.innerText=w.openParen+(1<Za.length?w.R7b:Za[0])+w.closeParen}}static hH(){return String.format("<div class='"+da.a.fph+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+ta.a.yo+"'>{1}</div>\r\n<div class='"+da.a.fOe+"'>\r\n\t<select id='{16}' class='{17} "+m.a.Xp+" "+
m.a.lp+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+da.a.jph+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+m.a.Xp+"'>\r\n\t\t\t<span class='"+m.a.WA+" "+da.a.lph+"'>\r\n\t\t\t\t<img title='{3}' class='"+m.a.Euh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
r.a.instance.ga(1037),r.a.instance.ga(1038),r.a.instance.ga(741),r.a.instance.mb(3),na.a.Ue(13),r.a.instance.ga(1039),wa.fFh,wa.Hcd,7,Z,ea,Y,ja,ca,ba,ua,wa.jFh,Ra+(V.a.tv?" "+Da:""),wa.iWe,wa.jWe)}}wa.Hcd="function_dialog_param_string";wa.iWe="function_dialog_function_description";wa.jWe="function_dialog_function_name";wa.jFh="function_list";wa.fFh="function_category";Object(d.a)(wa,"FunctionDeprecatedDialog",W.a,[]);var ia=a(261);class xa extends v.a{constructor(Za,Pa,Ab,Aa){super(Za);this.Wub=Pa;
this.formulaAuthoringHelper=Ab;this.W5f=Aa;this.cFh=(rb,Lb)=>{var oc;1===rb&&(this.hide(),rb={[t.a.Qc]:this.Wub.NameUI,["functionArgs"]:null!==(oc=Lb.functionArgs)&&void 0!==oc?oc:[],["ibdk"]:!0},oc=new B.a(-433697611,0,this.$.Kc,8,null),this.$.Ka.Lb(oc,rb))};this.WIh=rb=>this.formulaAuthoringHelper.getFunctionParamByIndex(this.W5f,this.Wub,rb);this.Nl=r.a.instance.ga(1035);this.Ag()}get uc(){return"FunctionArgumentsDialog"}Ag(){this.Rb=1;this.Kx={[ia.a.dv]:this.uc,["functionInfo"]:this.Wub,["initialArgs"]:this.formulaAuthoringHelper.getMinimalParamArray(this.W5f,
this.Wub),["evaluateCallback"]:this.EUg,["generateArgByIndex"]:this.WIh,["helpCallback"]:this.KV,["isModal"]:!1};this.initializeAndShow(this.Nl,this.cFh,this.Kx)}KV(){T(this.$,this.Wub.HelpId,!1)}EUg(){return"42"}}Object(d.a)(xa,"FunctionArgumentsDialog",v.a,[]);var gb=a(22);class va{constructor(Za,Pa,Ab){this.$=Za;this.Ua=Pa;this.functionInfoManager=Ab;this.hFh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");
this.menuId=null;this.onFunctionInfoLoaded=()=>{this.menuId&&this.hFh.includes(this.menuId)&&this.frame.ax(this.menuId)};this.hV=D.a.hV(this.$);this.dxa=D.a.dxa(this.$);this.Fli=D.a.Upd();this.hV&&(this.formulaAssistanceManager=this.$.da.za(464));this.lY={};this.frame=this.$.frame;this.functionInfoManager.XFa(this.onFunctionInfoLoaded);this.formulaAssistanceTelemetryManager=Za.da.za(491)}Lc(Za,Pa){switch(Pa){case 753860909:case -2060563418:case 1117706454:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return Za=
A.g(this.$).Li,Za.V5a||!Za.eb||0>=Za.text.length?!1:!0;default:return!1}}executeCommand(Za,Pa,Ab){var Aa,rb;Za=Pa.command;const Lb=A.g(this.$),oc=Lb.Li;switch(Za){case 753860909:case -2060563418:null===(Aa=this.formulaAssistanceManager)||void 0===Aa?void 0:Aa.U6b();Lb.inRangePicker&&oc.BC(!1);this.Fli?new L(this.$):(new wa(this.$,oc)).ig();this.formulaAssistanceTelemetryManager.F3a.dialogShownCounter++;break;case 1117706454:null===(rb=this.formulaAssistanceManager)||void 0===rb?void 0:rb.U6b();Lb.inRangePicker&&
oc.BC(!1);const $c=this.functionInfoManager.UPh(Ab[t.a.Qc]);Aa=gb.a.fQf($c.Params).split("!")[0];const Fd=""!==Aa?Aa.split(this.$.listSeparator).filter(he=>"..."!==he):[];k.TaskExtensions.KJ(e.GetServiceTaskFactory.Sa(this.$.da,520,521,0),he=>{new xa(this.$,$c,he.result,Fd)},this.$.la,3);Ab.ibdk?this.formulaAssistanceTelemetryManager.F3a.argsDialogOpenedByDialogCounter++:this.formulaAssistanceTelemetryManager.F3a.argsDialogOpenedByRibbonCounter++;break;case -433697611:Ab.ibdk&&(this.dxa?this.formulaAssistanceTelemetryManager.F3a.argsDialogCommitedCounter++:
this.formulaAssistanceTelemetryManager.F3a.dialogCommitedCounter++);let Cd=Ab[t.a.Qc]+w.openParen;this.dxa&&(Cd+=Ab.functionArgs.join(this.$.listSeparator)+w.closeParen);Ab.UILocation&&this.$.fd(-1075437823,-1,0,null);Lb.view.visibleArea.contains(Lb.dg(null))||Lb.tt(Lb.ha.sa.activeCell,3,H.a.hEh);const $d=oc.textBox;Ab=oc.textBox.caretPosition;oc.eb&&oc.text?(Aa=oc.text,rb=Ab?Aa.substring(0,Ab):"=",oc.text=rb+Cd+Aa.substring(Ab+($d.Cy?$d.Cy.length:0),Aa.length),$d.caretPosition=rb.length+Cd.length):
k.TaskExtensions.Aa(Lb.startEdit(!0,1),()=>{oc.text="="+Cd;if(this.dxa)Lb.endEdit(!0,"FormulaAssistanceCommandHandler.ExecuteCommand");else{const he=Cd.length+1;$d.bdb(he);$d.caretPosition=he}},this.$.la,11,Q.a.current);Lb.tm&&(Ab=Lb.Xb,Ab.text=$d.text,Ab.setCaretPosition($d.caretPosition));this.hV?this.formulaAssistanceManager.sda():(Ab=oc.z2.get(u.a.Xub),null===Ab||void 0===Ab?void 0:Ab.sY(!1))}return R.Task.Ta(!0)}Ac(Za,Pa){switch(Pa.command){case 753860909:case -2060563418:case -433697611:return!0;
case 1117706454:return this.dxa;default:return!1}}dGh(Za,Pa){Pa=this.Ua.Up(Pa);const Ab=this.Ua.Dc();var Aa=this.functionInfoManager.ibc(Za);if(!Aa)return l.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),Pa.yC();const rb=this.dxa?1117706454:-433697611;for(let Lb=0;Lb<Aa.length;++Lb){const oc=Aa[Lb].NameUI,$c=this.Ua.WP(280,"Formulas."+Za+"MenuItem_"+Aa[Lb].FunctionIndex.toString(),rb,null,1,"None",0,0,oc,!1,0);$c.label=oc;const Fd=Aa[Lb].Params.split(w.P$c);
$c.$R(oc+" "+(w.openParen+(1<Fd.length?w.R7b:Fd[0])+w.closeParen)+"\n"+Aa[Lb].Help);Ab.buttons.push($c)}Za=this.Ua.Dc();Aa=this.Ua.WP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,m.a.rRe,3,"Image16by16",1036,0,"Formulas.MoreFunctionsMenuItem",!1,0);Za.buttons.push(Aa);Pa.sc.push(Ab);Pa.sc.push(Za);return Pa.yC()}Oc(Za,Pa,Ab){Za=this.SPh(Pa);if(-1===Za)return!1;this.menuId=Ab.MenuId;if(!this.functionInfoManager.lV)return this.functionInfoManager.eJa({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},
!0),!1;Za=this.functionInfoManager.Fcd[Za];this.lY[Za]=this.lY[Za]||this.dGh(Za,Ab.MenuId);Ab.MenuItems=this.lY[Za];return!0}SPh(Za){switch(Za){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;
case "PopulateInformationFnsMenu":return 10;default:return-1}}}Object(d.a)(va,"FormulaAssistanceCommandHandler",null,[164]);class sa extends f.a{constructor(Za){super(Za)}vd(){const Za=e.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb),Pa=e.GetServiceTaskFactory.create(this.$.da,153,this.la,this.fb);k.TaskExtensions.Aa(k.TaskExtensions.Td([Za,Pa],this.la),()=>{this.$c([new va(this.$,Za.result,Pa.result)])},this.la,3)}static ka(Za){f.a.Od(92,new sa(Za))}}Object(d.a)(sa,"FormulaAssistanceCommandHandlerFactory",
f.a,[]);var ab=a(222);class Ua{constructor(Za,Pa){this.bKa=this.Yua=this.dja=null;this.GCf=(Ab,Aa)=>{this.Q5i(Aa.functionName,Aa.Lcd)};this.ICf=(Ab,Aa)=>{this.P5i(Aa.Lcd,Aa.wOd,Aa.wWi)};this.HCf=(Ab,Aa)=>{Ab=[];for(var rb of Aa.wOd)(!this.Lwa||void 0!==rb&&null!==rb)&&(Aa=rb.trim())&&Ab.push(Aa);if(!this.Lwa||Ab.length){rb="";for(Aa=0;Aa<Ab.length;Aa++){const Lb=this.sZc(Ab[Aa]),oc=Ua.ZEd(Aa,Ab.length);rb+=Lb+oc;oc&&(rb+=this.ariaLiveNotifier.Zxa)}this.ariaLiveNotifier.readText(rb)}};this.JCf=(Ab,
Aa)=>{this.ariaLiveNotifier.S5i(Aa.jG,Aa.description,Aa.selectedIndex.toString(),Aa.length.toString())};this.CCf=(Ab,Aa)=>{this.ariaLiveNotifier.HNf(Aa.description,Aa.length)};this.Syf=()=>{this.ariaLiveNotifier.kbb(r.a.instance.ga(888),x.a.XZa)};this.Lyf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(889))};this.Oyf=()=>{this.ariaLiveNotifier.readText(r.a.instance.ga(890))};this.$=Pa;this.ariaLiveNotifier=Za;this.$.da.Ga(219,this);this.Lwa=D.a.J4()}dispose(){this.mZd();this.bKa=this.Yua=this.dja=
null}PXc(Za){Za&&(this.dja=Za,this.dja.Boe(this.GCf),this.dja.qpe(this.ICf),this.Lwa&&this.dja.ppe(this.HCf))}QXc(Za){Za&&(this.Yua=Za,this.Lwa&&(this.Yua.zoe(this.Syf),this.Yua.xoe(this.Lyf)),this.Yua.yoe(this.Oyf))}RXc(Za){Za&&(this.bKa=Za,this.bKa.TVc(this.JCf),this.bKa.SZb(this.CCf))}mZd(){var Za,Pa,Ab;this.dja&&(this.dja.LRf(this.GCf),this.dja.jSf(this.ICf),this.Lwa&&this.dja.iSf(this.HCf));this.bKa&&(this.bKa.IKd(this.JCf),this.bKa.otc(this.CCf));this.Lwa&&(null===(Za=this.Yua)||void 0===Za?
void 0:Za.KRf(this.Syf),null===(Pa=this.Yua)||void 0===Pa?void 0:Pa.IRf(this.Lyf));null===(Ab=this.Yua)||void 0===Ab?void 0:Ab.JRf(this.Oyf)}Q5i(Za,Pa){if(Pa){let Ab="";this.Lwa||(Ab+=r.a.instance.mb(57)+this.ariaLiveNotifier.Zxa);for(let Aa=0;Aa<Pa.length;Aa++)Ab+=Za+this.ariaLiveNotifier.Zxa+this.sZc(Pa[Aa])+Ua.ZEd(Aa,Pa.length);this.Lwa&&(Ab+=r.a.instance.ga(887)+this.ariaLiveNotifier.Zxa);this.ariaLiveNotifier.readText(Ab)}}P5i(Za,Pa,Ab){if(Za){let rb="",Lb=0;if(Pa){for(let oc=0;oc<Pa.length;oc++){if(Ab>=
Za[oc].split(this.$.listSeparator).length){Lb++;continue}var Aa=Pa[oc].trim();if(!Aa)return;Aa=this.sZc(Aa);const $c=Ua.ZEd(oc-Lb,Pa.length-Lb);rb+=Aa+$c;$c&&(rb+=this.ariaLiveNotifier.Zxa)}this.ariaLiveNotifier.readText(rb)}}}sZc(Za){if(!Za)return"";var Pa=Za.split(this.$.listSeparator);Za="";for(const Ab of Pa){if(Ua.zod(Ab))Za+=Ab;else{const Aa=(Pa=Ua.Bki(Ab))?Ab.replace("[","").replace("]",""):Ab;Za+=String.format(Pa?r.a.instance.mb(59):r.a.instance.mb(58),Aa)}Za+=this.ariaLiveNotifier.Zxa}return Za}static ZEd(Za,
Pa){return Za>=Pa||1===Pa?(l.ULS.shipAssertTag(537161997,0,Za<Pa,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""):String.format(r.a.instance.mb(55),Za+1,Pa)+"\r\n"}static zod(Za){return gb.a.contains(Za,w.R7b,!0)}static Bki(Za){return Za.trimStart().startsWith(w.IGf)||Za.trimEnd().endsWith(w.HGf)}}Object(d.a)(Ua,"FormulaAssistanceReadoutHandler",null,[597,10]);class nb extends ab.a{constructor(Za){super();this.$=Za;this.Eb()}create(){const Za=this.$.da;k.TaskExtensions.Aa(e.GetServiceTaskFactory.Sa(Za,
211,212,this.fb),Pa=>{Pa=Za.za(219)||new Ua(Pa.result,this.$);this.pb(Pa)},this.la,3)}static ka(Za){Za.da.Ga(220,new nb(Za))}}Object(d.a)(nb,"FormulaAssistanceReadoutHandlerFactory",ab.a,[]);var Ha=a(642),sb=a(111),Qb=a(980),mb=a(58),Pb=a(43),gc=a(116);class Xb{constructor(){this.oRa={}}thd(Za){return this.oRa&&Za in this.oRa?this.oRa[Za]:null}d8f(Za,Pa){this.oRa||(this.oRa={});this.oRa[Za]=Pa}DZ(){this.oRa=null}}Object(d.a)(Xb,"FormulaAssistanceContextualPreviewCache",null,[]);var Ca=a(61);const ra=
(Za,Pa,Ab,Aa,rb,Lb,oc=null)=>{oc=Za.Na(1,oc);oc.getPartialCalcResultsParameters=Pa;return Ca.g(Za,"GetPartialCalcResults",oc,Ab,Aa,rb,Lb,4)};class ma{constructor(Za){this.Izi=30;this.calcManager=null;this.Ad=!1;this.zPa=this.DGb=this.iab=null;this.oy=()=>{this.uha.DZ()};this.$=Za;this.uha=new Xb;this.hUf=-1;this.$.ea.xE(this.oy)}dispose(){this.Ad||(this.$&&(this.$.ea.ND(this.oy),this.$=null),this.uha=this.DGb=null,this.Ad=!0)}eed(Za,Pa,Ab,Aa){if(Pa&&0>=Pa.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");
if(!Za)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.za(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");let rb="="+Pa.substring(Ab.start,Ab.end);Na.EwaSettings.ma(587)&&(rb=this.calcManager.QYh(A.g(this.$).ha.sa.activeCell,Za,Ab));const Lb=this.bMh(rb,Ab);if(Na.EwaSettings.ma(587)){if(Lb&&!this.calcManager.isFormulaSubExpressionVolatile(Za))return Promise.resolve(Lb)}else if(Lb)return Promise.resolve(Lb);
return this.dMh(rb,Ab).then(oc=>{if(this.z0c(Aa))throw Error.create("OperationCanceledException");if(!oc||oc.Ihj||oc.cna.startsWith("##UNSUPPORTED:"))return this.WYe(Pa,rb,Ab,Aa);this.uha.d8f(rb,oc.cna);return Promise.resolve(oc)})}bMh(Za,Pa){return(Za=this.uha.thd(Za))?new Qb.a(Za,Pa.start,Pa.end,0):null}dMh(Za,Pa){if(!Za||0>=Za.length||!Pa)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.CUg(A.g(this.$).ha.sa.activeCell,
Za,this.Izi,Pa)}WYe(Za,Pa,Ab,Aa){if(!Za||0>=Za.length||!Pa||0>=Pa.length||!Ab)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");if(this.zPa)return this.cMh(Za,Pa,Ab,Aa);const rb={};rb.PartialFormula=Pa;rb.Formula=Za;rb.SourceRange=Pb.v(A.g(this.$).ha.sa.activeCell,this.$);return this.zPa=new Promise((Lb,oc)=>{this.DGb=new Ha.a;this.hUf=this.$.ea.Je;this.iab=ra(this.$.pa.va,rb,$c=>{this.oUi(Pa,Ab,Aa,$c,Lb,oc)},$c=>{this.iab=
this.zPa=null;oc($c)},null,null,null);this.DGb.token.register(()=>{this.eWg(oc)})})}oUi(Za,Pa,Ab,Aa,rb,Lb){this.iab=this.zPa=null;if(this.hUf!==this.$.ea.Je)Lb(Error.create("OperationCanceledException"));else if(Aa.Result)if(Aa=mb.a.$h(Aa.Result),!Aa||sb.a.isEmpty(Aa))rb(null);else{for(let oc in Aa)this.uha.d8f(oc,Aa[oc]);this.z0c(Ab)?Lb(Error.create("OperationCanceledException")):(Za=this.uha.thd(Za))?(""===Za&&(Za=" "),rb(new Qb.a(Za,Pa.start,Pa.end,0))):Lb(Error.create("SubexpressionNotFoundException"))}else rb(null)}cMh(Za,
Pa,Ab,Aa){return new Promise((rb,Lb)=>{this.zPa.then(()=>{this.UUf(Za,Pa,Ab,Aa,rb,Lb)}).catch(()=>{this.UUf(Za,Pa,Ab,Aa,rb,Lb)})})}UUf(Za,Pa,Ab,Aa,rb,Lb){if(this.z0c(Aa))Lb(Error.create("OperationCanceledException"));else{const oc=this.uha.thd(Pa);oc?rb(new Qb.a(oc,Ab.start,Ab.end,0)):this.WYe(Za,Pa,Ab,Aa).then($c=>{rb($c)}).catch($c=>{Lb($c)})}}eWg(Za){this.iab&&(gc.a.Du(this.iab.Yt)?(this.zPa=this.iab=null,Za(Error.create("PendingWebReqeuestCancelled"))):l.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))}DZ(){this.fWg();
this.uha&&this.uha.DZ()}fWg(){this.DGb&&this.DGb.cancel()}z0c(Za){return this.Ad||Za.tK}}Object(d.a)(ma,"FormulaAssistanceContextualPreviewCalculator",null,[10]);var hb=a(155),vb=a(213);class Va{}Va.Vph="ewa-facp-text-box";Object(d.a)(Va,"CssClassNames",null,[]);class db{constructor(Za){this.Dqa=this.ATa=this.I2a=this.VP=this.F$=this.Ya=null;this.Jjd=!1;this.Jc=Za}dispose(){(this.F$||this.VP)&&this.j9e();this.Ya=this.Dqa=null}fRj(Za,Pa,Ab,Aa){Za&&Pa&&Aa&&Pa.cna&&!(1>Pa.cna.length)&&(this.Ya=Za,this.MQf(),
this.I2a=Pa,this.ATa=Aa,this.Fzj(Pa,Ab,Aa))}j9e(){this.F6h();this.MQf();this.ATa=this.I2a=null}Fzj(Za,Pa,Ab){if(Za.cna&&!(1>Za.cna.length)){var Aa=this.Jc.da.za(266);if(Aa){var rb=Aa.cSh();rb&&k.TaskExtensions.Aa(this.sCb,()=>{if(Pa)if(Na.EwaSettings.ma(587)&&this.Ya.eb&&0<Ab.length){this.Sxb(Za.YJa,Ab[0].start,null);var Lb=this.c4e(Ab[0],rb),oc=this.Ya.text.substring(Ab[0].start,Ab[0].end).trim();oc=this.Ya.text.indexOf(oc);oc=this.Ya.text.substring(0,oc).lastIndexOf("\n");this.Sxb(0>oc||1>=Ab.length?
Ab[0].start:oc+1,Ab[0].end,Lb?String.format(Lb,.3):null);for(var $c=1;$c<Ab.length;$c++)Lb=this.c4e(Ab[$c],rb),oc=this.Ya.text.substring(Ab[$c].start,Ab[$c].end).trim(),oc=this.Ya.text.indexOf(oc),oc=this.Ya.text.substring(Ab[$c-1].end,oc).lastIndexOf("\n"),this.Sxb(0>oc?Ab[$c-1].end:oc+1+Ab[$c-1].end,Ab[$c].end,Lb?String.format(Lb,.3):null);oc=this.Ya.text.substring(Ab[Ab.length-1].end,Za.$ua).indexOf("\n");this.Sxb(0>oc?Ab[Ab.length-1].end:oc+1+Ab[Ab.length-1].end,Za.$ua,null);l.ULS.sendTraceTag(537162061,
0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else this.Sxb(Za.YJa,Za.$ua,null),l.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");this.F$||(this.F$=document.createElement(vb.a.div),this.Ya.textBox.domElement.appendChild(this.F$));this.VP||(this.VP=document.createElement(vb.a.div),this.VP.className=
Va.Vph,this.Jc.domElement.appendChild(this.VP));Lb=Za.$ua;Na.EwaSettings.ma(587)&&this.Ya.eb&&Ab&&0<Ab.length&&Ab[0].start<Lb&&Ab[0].start!==Za.YJa&&!this.Ya.textBox.Cy.length&&(Lb=Ab[0].start);$c=gb.a.contains(this.Ya.textBox.Se.id,"FormulaBar",!0)&&gb.a.contains(this.Ya.text.substring(Za.YJa,Za.$ua),"\n",!0);oc=this.Ya.eb?this.Ya.textBox.caretPosition:0;Lb=excelOnline.utils.getBoundingRectForText(this.Ya.textBox.Se,$c?oc:Za.YJa,$c?oc:Lb,Na.EwaSettings.ma(587));this.VP.style.left=z.HelperMethods.pc(Lb.left);
this.VP.style.top=z.HelperMethods.pc(Lb.top);this.VP.style.width=z.HelperMethods.pc(Lb.width);this.VP.style.height=z.HelperMethods.pc(Lb.height);dialogControls.renderToolTip(this.F$,`FormulaAssistancePreviewToolTip_${Za.$ua}_${Za.$ua}`,Za.cna,this.VP,0,!1,!1,1)},this.Jc.la,3)}}}c4e(Za,Pa){const Ab=this.Ya.text;var Aa=Ab.substring(Za.start,Za.end);Aa=Aa.trim();Za=Ab.indexOf(Aa,Za.start);Pa=Ab.indexOf(Pa,Za);Aa=Ab.substring(Za,Pa);Aa=Aa.trim();return this.Ya.colors.getItem(Za+"-"+(Za+Aa.length))}F6h(){this.Ya&&
this.F$&&this.VP&&k.TaskExtensions.Aa(this.sCb,()=>{this.Ya.textBox.domElement.contains(this.F$)&&(dialogControls.clearToolTip(this.F$),this.Ya.textBox.domElement.removeChild(this.F$),this.F$=null);this.Jc.domElement.contains(this.VP)&&(this.Jc.domElement.removeChild(this.VP),this.VP=null)},this.Jc.la,3)}Sxb(Za,Pa,Ab){!this.Ya||Za>=Pa||(this.Ya.textBox.formatText(Za,Pa-Za,{["background"]:Ab||"#E3DDCC"}),this.Jjd=!0)}MQf(){if(this.Ya&&this.I2a&&this.Jjd){var Za=this.I2a.$ua;Na.EwaSettings.ma(587)&&
0<this.ATa.length&&this.ATa[this.ATa.length-1].end>Za&&(Za=this.ATa[this.ATa.length-1].end);this.Ya.textBox.formatText(this.I2a.YJa,Za-this.I2a.YJa,{["background"]:!1});this.Jjd=!1}}get sCb(){if(this.Dqa)return this.Dqa;const Za=new hb.a;this.Jc.Yx(Pa=>{k.TaskExtensions.Aa(Pa.qud(),()=>{Za.setResult(!0)},this.Jc.la,3)});return this.Dqa=Za.task}}Object(d.a)(db,"FormulaAssistanceContextualPreviewControl",null,[10]);var oa=a(82),Oa=a(47),Wa=a(45);class Sa{constructor(Za){this.L7=0;this.mcd=Za}x4f(Za,
Pa,Ab){Ab?this.Y6g(Za,Pa,Ab):this.p6e(Za,Pa,Ab,!0)}jgj(){this.L7=0}Y6g(Za,Pa,Ab){this.L7++;const Aa=this.L7;Oa.a.instance.create(()=>{this.p6e(Za,Pa,Ab,Aa===this.L7)},500,Wa.a.iEh,!0,!0)}p6e(Za,Pa,Ab,Aa){const rb=this.mcd.eed(Za,Pa);rb&&rb.then(Lb=>{Aa&&this.mcd.jpd(Pa)&&this.mcd.eRj(Za,Lb,Ab)}).catch(Lb=>{Lb=Object(oa.a)(Error,Lb);"OperationCanceledException"===Lb.message?l.ULS.sendTraceTag(537162059,0,50,`GetContextualFormulaPreviewResults - caught exception: ${Lb}`):l.ULS.sendTraceTag(537162058,
0,10,`GetContextualFormulaPreviewResults - caught exception: ${Lb}`)})}}Object(d.a)(Sa,"FormulaAssistanceContextualPreviewHoverManager",null,[]);var yb=a(200);class Ma{constructor(Za){this.Qrb=this.sha=this.calcManager=this.Ya=null;this.d$a=()=>{this.A5a(!1,!1)};this.$=Za;this.Lub=new db(Za);this.F$b=new ma(Za);this.G$b=new Sa(this);A.g(Za).Xb.lm(this.d$a);this.$.da.Ga(317,this)}dispose(){this.v_c();O.a.qc([this.Lub,this.F$b]);this.G$b=this.F$b=this.Lub=null;this.$&&A.g(this.$).Xb.Fl(this.d$a);this.sha=
this.Ya=this.$=null}Gzj(Za,Pa){Pa&&yb.f(Pa.text)&&!(Pa.Xwa||Pa.textBox.Cy||this.Ya&&this.Ya.textBox.Cy)&&(this.Ya=Pa,this.calcManager=this.$.da.za(266))&&(l.ULS.sendTraceTag(537162056,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),Za=z.HelperMethods.uvb(Za),Za=this.calcManager.NYh(A.g(this.$).ha.sa.activeCell,this.Ya.text,Za.x,Za.y),Pa=this.calcManager.getSubExpressionSpan(Za),!Pa||Pa.end<=Pa.start||this.jpd(Pa)||
(this.sha=Pa,this.G$b.x4f(Za,Pa,!0)))}hTd(Za){if(Za&&yb.f(Za.text))if(Za.textBox.Cy&&Za.textBox.Cy.trim()){if(this.Ya=Za,this.calcManager=this.$.da.za(266)){l.ULS.sendTraceTag(537162054,0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");Za={};var Pa=this.Ya.textBox.Cy.trim();Za.start=this.Ya.text.indexOf(Pa,this.Ya.textBox.caretPosition);Za.end=Za.start+Pa.length;(Pa=this.calcManager.getFormulaSubExpressionObject(A.g(this.$).ha.sa.activeCell,
this.Ya.text,this.Ya.textBox.Cy))&&!this.jpd(Za)&&(this.sha=Za,this.G$b.x4f(Pa,Za,!1))}}else this.A5a(!1,!0)}A5a(Za,Pa){!this.Ya||Pa&&this.Ya.textBox.Cy||(this.sha=null,Za&&(this.v_c(),this.F$b.DZ(),this.G$b.jgj()),this.Lub&&this.Lub.j9e(),this.Ya.Xwa||(this.Ya.Xwa=!1,this.Ya=null))}eed(Za,Pa){if(!this.Ya||this.Ya.Xwa)return null;this.v_c();this.Qrb=new Ha.a;return this.F$b.eed(Za,this.Ya.text,Pa,this.Qrb.token)}eRj(Za,Pa,Ab){this.Qrb=null;!Za||!Pa||!Pa.cna||0>=Pa.cna.length?this.A5a(!1,!1):(Za=this.calcManager.OYh(A.g(this.$).ha.sa.activeCell,
Za,this.Ya.text),this.Lub.fRj(this.Ya,Pa,Ab,Za))}jpd(Za){return this.sha?Za.start===this.sha.start&&Za.end===this.sha.end&&Za.pre===this.sha.pre&&Za.post===this.sha.post:!1}v_c(){this.Qrb&&this.Qrb.cancel()}}Object(d.a)(Ma,"FormulaAssistanceContextualPreviewManager",null,[639,10,640]);var Bb=a(7),Nb=a(4),Ia=a(223),jb=a(13),Ob=a(187),Jb=a(1089),Kb=a(67),Qa=a(775),ha=a(31),qa=a(24),pb=a(65),bb=a(283),eb=a(246),Fa=a(162);class tb{constructor(Za=!1){this.US=0;this.g$d=!1;this.qWa=this.Cae=null;this.Usg=
Za;this.textEdit=null}d0f(Za){this.US=0;this.g$d=Za.IsCompatibility;this.set_name(Za.NameDataStrings);this.qWa=Za.Help}mqj(Za){this.US=1;this.set_name(Za.Name)}Npj(Za){this.US=2;this.set_name(Za.name);this.qWa=Za.tooltip}prj(Za){this.US=3;this.set_name(Za.name);this.qWa=Za.toolTip}B1f(Za){this.US=4;this.set_name(Za.name)}Gtj(Za){this.US=5;this.set_name(Za.name);this.qWa=Za.toolTip}Ftj(Za){this.US=7;this.set_name(Za.name)}fsj(){this.US=6;this.set_name(r.a.instance.mb(192));this.qWa=r.a.instance.mb(193)}get itemType(){return this.US}get sgi(){return this.g$d}get name(){return this.label}set_name(Za){return this.Cae=
Za}get label(){return this.Cae}get ija(){return this.qWa}get JAb(){return this.Usg}static rah(){return Object(Bb.a)(new tb(!0),{})}}Object(d.a)(tb,"AutoCompleteItem",null,[616]);class dc{constructor(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}}Object(d.a)(dc,"DefinedNameInfo",null,[]);var jc=a(186);class fb{constructor(Za){this.eIe={};this.$=Za}get dIe(){const Za=[];if(!this.$.Ab||!this.$.Ab.items)return Za;let Pa=0;const Ab=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&
D.a.hV(this.$);for(const Aa of this.$.Ab.items)if(Aa&&(3===Aa.type&&Aa.usedRange||Ab&&2===Aa.type)){const rb=new dc;rb.tooltip=Aa.sheetName+Kb.a.exclamation+Aa.usedRange.toString();rb.name=Aa.name;rb.namedRange=this.g4g(Aa.usedRange);rb.sheetName=Aa.sheetName;rb.type=this.Z3g(Aa.type);Za.push(rb);this.eIe[Aa.name.toUpperCase()]=rb;++Pa;if(Pa===w.irf){l.ULS.sendTraceTag(537162076,0,15,`Maximum number of defined names reached for formula assistance: ${w.irf}`);break}}return Za}zNj(Za){var Pa=this.eIe[Za.toUpperCase()];
if(!Pa)return{returnValue:!1,sheetName:"",range:null};Za=Pa.sheetName;Pa=this.R3g(Pa.namedRange);return{returnValue:!0,sheetName:Za,range:Pa}}g4g(Za){if(null!=Za&&void 0!=Za)return{top:Za.top,left:Za.left,bottom:Za.bottom,right:Za.right,maxRows:Za.maxRows,maxColumns:Za.maxColumns,sheetName:void 0}}R3g(Za){if(null!=Za&&void 0!=Za)return new jc.a(Za.top,Za.left,Za.bottom,Za.right,Za.maxRows,Za.maxColumns)}Z3g(Za){switch(Za){case 2:return 0;case 3:return 1;default:return-1}}}Object(d.a)(fb,"DefinedNameInfoManager",
null,[]);var ec=a(129),lb=a(263),ac=a(260),Gb=a(236);class wb extends Sys.EventArgs{constructor(Za,Pa){super();this.functionName=Za;this.Lcd=Pa}}Object(d.a)(wb,"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);class qc extends Sys.EventArgs{constructor(Za){super();this.wOd=Za}}Object(d.a)(qc,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);class Ya extends Sys.EventArgs{constructor(Za,Pa,Ab){super();this.Lcd=Za;this.wOd=Pa;this.wWi=Ab}}Object(d.a)(Ya,"FormulaAssitanceSelectedParameterChangedEventArgs",
Sys.EventArgs,[]);var xb=a(259);class wc{constructor(Za,Pa,Ab,Aa,rb=null){this.sba=this.i_c=!1;this.$=Za;this.formulaAssistanceUIControl=Pa;this.QVe=Ab;this.Nlj=Aa;this.G6e=rb;this.sba=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug")}get Jf(){return this.i_c}set Jf(Za){this.i_c!==Za&&(Za?xb.a(this.$).di(this):xb.a(this.$).Tz(this),this.i_c=Za)}get ee(){return this.Nlj}get nc(){return this.formulaAssistanceUIControl.getRootElement(this.QVe)}hg(Za,Pa){Za=!1;Pa||(A.g(this.$).Li.textBox.xF=
!0,Za=this.formulaAssistanceUIControl.focus(this.QVe));return Za}mh(Za){const Pa=this.nc;return!(void 0===Pa||null===Pa)&&ka.DOMElementExtensions.xf(Pa,Za)}sj(){this.G6e&&this.G6e();if(this.sba){const Za=A.g(this.$).Li.textBox;this.selection=Za.selection;Za.removeSelection()}}Vj(){this.sba&&(A.g(this.$).Li.textBox.selection=this.selection)}dispose(){xb.a(this.$).Tz(this)}}Object(d.a)(wc,"FormulaAssistanceFocusManager",null,[107,10]);var Oc=a(38),Cb=a(370),Ib=a(171),fc=a(35),vc=a(282),Cc=a(281),fd=
a(913);class od extends Oc.a{constructor(Za,Pa){super();this.Fqg=[];this.Ocd={};this.Pcd={};this.NS=null;this.E8=[];this.cKa={};this.nzf=(Ab,Aa)=>{l.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");this.$yf(Ab,!!Aa&&1!==Aa.FilterType,!0)};this.mzf=()=>{l.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");this.NS=null};this.Xyf=Ab=>{l.ULS.sendTraceTag(537161985,
0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");this.DId(Ab.kja,!0,!1)};this.lzf=Ab=>{l.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");this.$yf(Ab,!0,!1)};this.tLc=this.vLc=!1;this.jb=Za;this.pluginScheduler=Pa;this.$.da.Ga(19,this)}XFa(Za){this.addHandler("FunctionInfoLoaded",Za)}Lbb(Za){this.removeHandler("FunctionInfoLoaded",Za)}sGg(Za){this.addHandler("FunctionInfoReset",Za)}Bbj(Za){this.removeHandler("FunctionInfoReset",Za)}get lV(){return this.vLc}get lii(){return this.tLc}get P$b(){var Za=
this.NS,Pa=fd.a(this.$);if(!Pa)return Za;Pa=Pa.iPh();const Ab=Pa.length;if(0>=Ab)return Za;const Aa=[];Aa.push(...Za);for(Za=0;Za<Ab;Za++){const rb=Pa[Za],Lb={};Lb.FunctionIndex=Aa.length;Lb.HelpId=Lb.GroupUI=null;Lb.Help=rb.description;Lb.IsCommonlyUsed=Lb.IsCompatibility=!1;Lb.NameDataStrings=rb.name;Lb.NameUI=rb.name;Lb.Params=null;Lb.ParamsHelp=null;Aa.push(Lb)}return Aa}get Fcd(){return this.E8}get $(){return this.jb}dispose(){const Za=this.$.da.za(268);Za&&Za.oKd(this.Xyf);this.jb=null;super.dispose()}AUf(){this.raiseEvent("FunctionInfoReset")}ZLd(){this.AUf();
this.vLc=!1;this.NS=null;this.tLc=!0}eJa(Za,Pa=!1){if(this.lV)this.mMf();else{l.ULS.sendTraceTag(537161991,0,50,`Retrieving the list of function names for culture '${this.$.ya.UICultureTag}' from the server.`);let Aa=null;(Aa=this.$.da.za(268))||l.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===Aa||void 0===Aa?0:Aa.kja)&&0<Aa.kja.length)Na.EwaSettings.ma(121)?Aa.LDh(this.lzf):this.DId(Aa.kja,!0,!1);else{var Ab=this.$.pa.va.Tb();Za&&(this.$.ea.fc||Pa)&&
!this.lii&&(Pa?Cb.a(this.$.userOperationManager,(rb,Lb,oc)=>Ca.o(this.$.pa.va,Za,Cc.b(rb,this.nzf),Cc.a(Lb,this.mzf),oc,Za,Ab),rb=>new Ib.a(130,0,rb,16),null):Ca.o(this.$.pa.va,Za,this.nzf,this.mzf,null,Za,Ab));!this.lV&&this.$.ea.fc&&(Aa?(l.ULS.sendTraceTag(537161989,0,50,`FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded=${this.lV}, IsSessionActive=${this.$.ea.fc}`),Aa.Aoe(this.Xyf)):(l.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),
Ca.o(this.$.pa.va,{FilterType:0},this.lzf,null,null,null,Ab),this.tLc=!1))}}}TPh(Za){return 0>Za||Za>=this.NS.length?null:this.NS[Za]}hfd(Za){return fc.a.Cc(this.Ocd,Za.toUpperCase())}UPh(Za){return fc.a.Cc(this.Pcd,Za.toUpperCase())}ibc(Za){return fc.a.Cc(this.cKa,Za)}Mgc(Za){return!Za.GroupUI}$yf(Za,Pa,Ab){const Aa=vc.a(Za);l.ULS.sendTraceTag(537161955,0,50,`FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult=${Aa}`);Aa?(A.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),
this.$.ea.Gp(Za.Errors)):(this.DId(Za.Result,Pa,Ab),D.a.jV()&&!D.a.hV(this.$)&&this.uTj())}DId(Za,Pa,Ab){l.ULS.sendTraceTag(537161954,0,50,`FunctionInfoManager.RefreshFunctionList: functionsInfo count = ${Za.length}, isCategorized = ${Pa}, partialResult = ${Ab} IsFullyLoaded = ${this.lV}`);this.lV||(this.NS=Za,this.pRg(Pa),this.vLc=!Ab,this.mMf())}mMf(){this.raiseEvent("FunctionInfoLoaded")}uTj(){const Za=this.P$b;this.pluginScheduler.notifier().setFunctionsInfo(Za);l.ULS.sendTraceTag(512278604,0,
50,`FuntionInfoManager.updateSchedulerFunctionArgumentAssistanceList update functions info with ${null===Za||void 0===Za?void 0:Za.length} functions}`)}pRg(Za){var Pa=r.a.instance.ga(1032),Ab=[];this.cKa={};this.E8=[];this.cKa[Pa]=Ab;const Aa=r.a.instance.ga(1033),rb=[];this.E8.push(Pa);this.E8.push(Aa);for(let oc=0,$c=this.NS.length;oc<$c;oc++){Pa=this.NS[oc];Pa.IsCompatibility||rb.push(Pa);var Lb=Pa.NameUI;const Fd=Pa.NameDataStrings;this.Ocd[Fd.toUpperCase()]||(this.Ocd[Fd.toUpperCase()]=Pa);this.Pcd[Lb.toUpperCase()]||
(this.Pcd[Lb.toUpperCase()]=Pa);if(!this.Mgc(Pa)){if(Za){Lb=Pa.GroupUI;let Cd=fc.a.Cc(this.cKa,Lb);Cd||(Cd=[],this.cKa[Lb]=Cd,this.E8.push(Lb));Cd.push(Pa)}Pa.IsCommonlyUsed&&Ab.push(Pa);Pa.IsCompatibility||this.Fqg.push(Fd)}}this.cKa[Aa]=rb;Za&&(od.$Pf(Ab,[2,3,0,5,4,9,1,7,8,6]),Ab=Array(14),Ab[0]=0,Ab[1]=1,Ab[2]=7,Ab[3]=11,Ab[4]=5,Ab[5]=2,Ab[6]=6,Ab[7]=10,Ab[8]=9,Ab[9]=3,Ab[10]=4,Ab[11]=13,Ab[12]=12,Ab[13]=8,od.$Pf(this.E8,Ab),Ab=[],Ab.push(...this.E8),Ab.splice(13,1),this.E8=Ab);Ab=(oc,$c)=>oc.NameUI.localeCompare($c.NameUI);
this.NS=[...this.NS];this.NS.sort((oc,$c)=>oc.NameDataStrings.localeCompare($c.NameDataStrings));for(let oc=1,$c=this.E8.length;oc<$c&&Za;oc++)this.cKa[this.E8[oc]].sort(Ab);for(let oc=0,$c=this.NS.length;oc<$c;oc++)this.NS[oc].FunctionIndex=oc}static $Pf(Za,Pa){const Ab=[...Za];for(let Aa=0;Aa<Ab.length&&Aa<Pa.length;Aa++)Za[Aa]=Ab[Pa[Aa]]}}Object(d.a)(od,"FunctionInfoManager",Oc.a,[595,596,10]);var Ub=a(237),Fc=a(93),$b=a(49),zc=a(708);class Wc extends Fc.a{constructor(Za,Pa,Ab,Aa=null){super(Za,
Aa);this.B3=null;this.xNb=this.MVd=!1;this.offsetParent=this.B7=this.j2a=null;this.SJc=!1;this.XAd=rb=>this.g6(rb);this.WAd=rb=>this.EN(rb);this.Txf=rb=>{const Lb=z.HelperMethods.Yn(rb);Lb.button===Sys.UI.MouseButton.leftButton&&2===rb.tb&&(this.Hod(Lb.target)||this.nTa(Lb));return!1};this.K6d=Pa;Ab&&(this.MVd=!0,Ub.a.instance.ra(jb.a.pointerDown,this.GKe,this.Txf));this.mfa=!1}get C7b(){return this.mfa}get GKe(){return this.K6d}get B5h(){return this.SJc}dispose(){this.MVd&&(Ub.a.instance.Ba(jb.a.Gj,
this.GKe,this.Txf),this.MVd=!1);this.xNb&&(this.xNb=!1,Ub.a.instance.Ba(jb.a.Nf,this.domElement.ownerDocument.body,this.XAd),Ub.a.instance.Ba(jb.a.Gj,this.domElement.ownerDocument.body,this.WAd));this.B3=this.K6d=null;super.dispose()}Cme(Za){this.B3?this.B3.push(Za):this.B3=[Za]}Hod(Za){if(this.B3)for(let Pa=0,Ab=this.B3.length;Pa<Ab;++Pa)if(ka.DOMElementExtensions.xf(this.B3[Pa],Za))return!0;return!1}nTa(Za){this.C7b||(this.mfa=!0,gb.a.equals(this.domElement.currentStyle.position,"absolute",!0)||
(this.domElement.style.position="absolute"),this.Emh(),Ub.a.instance.ra(jb.a.Nf,this.domElement.ownerDocument.body,this.XAd),Ub.a.instance.ra(jb.a.Gj,this.domElement.ownerDocument.body,this.WAd),this.xNb=!0,this.drag(!0,Za))}drag(Za,Pa){pa.g(Pa);var Ab=new $b.a(0,0),Aa=new Sys.UI.Point(Pa.clientX,Pa.clientY);Pa=this.domElement.parentNode;Aa=zc.a.Js(Ab,Pa,Aa,this.isRtl());Za?(Ab=zc.a.qF(Ab,Pa,this.domElement,this.isRtl()),this.j2a=zc.a.XD(Aa,Ab),this.B7=Aa,this.SJc=!1):!this.B5h&&this.x5h(Aa,this.B7)&&
(this.SJc=!0);Ab=zc.a.XD(Aa,this.j2a);zc.a.gdb(Pa,this.domElement,Ab,this.isRtl(),Za)}cB(Za){this.xNb&&(this.xNb=!1,Ub.a.instance.Ba(jb.a.Nf,this.domElement.ownerDocument.body,this.XAd),Ub.a.instance.Ba(jb.a.Gj,this.domElement.ownerDocument.body,this.WAd));pa.g(Za);this.mfa=!1;this.B7=this.j2a=null}g6(Za){const Pa=z.HelperMethods.Yn(Za);Pa.button===Sys.UI.MouseButton.leftButton&&2===Za.tb&&this.cB(Pa);return!1}EN(Za){2===Za.tb&&this.drag(!1,z.HelperMethods.Yn(Za));return!1}x5h(Za,Pa){return Pa.x<
Za.x-2||Pa.x>Za.x+2||Pa.y<Za.y-2||Pa.y>Za.y+2}Emh(){this.offsetParent=this.domElement.offsetParent||this.domElement.ownerDocument.body;ka.DOMElementExtensions.getLocation(this.offsetParent)}}Object(d.a)(Wc,"BaseDraggableBehavior",Fc.a,[]);class yc extends Wc{constructor(Za,Pa,Ab=null,Aa=!1){super(Za,Pa,!1,Ab);this.tSa(Aa);this.oj=gb.a.equals("rtl",Za.dir,!0)}setVisible(Za){ka.DOMElementExtensions.setVisible(this.domElement,Za);Za||(this.domElement.style.top="auto",this.domElement.style.left="auto")}isRtl(){return this.oj}tSa(Za){const Pa=
this.domElement.style;Pa.cursor="move";Pa.position=Za?"relative":"absolute"}}Object(d.a)(yc,"FunctionParamBoxDraggableItem",Wc,[]);class pd{constructor(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}}Object(d.a)(pd,"FormulaArgumentAssistanceCallbacks",null,[]);class xd{constructor(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}}Object(d.a)(xd,"FormulaArgumentAssistanceRenderingInfo",null,[]);var Vb=a(85),Uc=a(108),ud=a(151);class Vc{constructor(Za){this.mH=
Za;this.yZ=this.hSd=this.tn=!1;this.onKeyDown=Pa=>!this.yZ&&Pa.keyCode===Vb.a.Toa&&Pa.altKey&&Pa.ctrlKey?(this.m8b(),Pa.stopPropagation(),Pa.preventDefault(),!0):!1;this.zNa=Pa=>{if(!this.yZ)return!1;if(Pa.eventName===jb.a.Qb){const Ab=Pa.Ca.ctrlKey?1:Pa.Ca.shiftKey?50:10;switch(Pa.Ca.keyCode){case Vb.a.GUa:this.S5(0,-Ab);break;case Vb.a.Roa:this.S5(0,Ab);break;case Vb.a.Soa:this.S5(-Ab,0);break;case Vb.a.Wfb:this.S5(Ab,0);break;case Vb.a.FL:case Vb.a.fi:this.hSd=!0;break;default:return!1}}Pa.eventName===
jb.a.Ed&&this.hSd&&this.S3(!0);Pa.Ca.preventDefault();return!0};this.NGb=Pa=>{if(!this.yZ)return!1;Pa.Ca.preventDefault();this.S3();return!0};this.onBlur=()=>{if(!this.yZ)return!1;this.S3();return!0};this.Pq=Uc.KeyInputManager.instance;this.pointerInputManager=Ub.a.instance}ka(Za){(this.root=Za)&&!this.tn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.tn=!0)}detach(){this.root&&this.tn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.tn=!1)}m8b(){this.root&&(this.target=
this.mH.QEf("move",!0),this.gVd=this.target.getBoundingClientRect(),this.yZ=!0,this.hSd=!1,this.Av(),this.Olc||this.x4c(),this.target.appendChild(this.Olc))}S3(Za=!1){this.mH.kyf(Za);this.yZ=!1;this.QJd();this.tJd();this.gVd=this.target=void 0}Av(){this.Pq.capture(this.zNa,null);this.pointerInputManager.Dt(jb.a.pointerDown,this.target,this.NGb,!0);this.target.addEventListener("blur",this.onBlur)}tJd(){this.Pq.releaseCapture();this.pointerInputManager.Mt(jb.a.pointerDown,this.target,this.NGb,!0);this.target.removeEventListener("blur",
this.onBlur)}QJd(){var Za;this.target&&(null===(Za=this.Olc)||void 0===Za?void 0:Za.parentNode)===this.target&&this.target.removeChild(this.Olc)}S5(Za,Pa){const Ab=this.target.getBoundingClientRect();Za+=Ab.left-this.gVd.left;Pa+=Ab.top-this.gVd.top;this.mH.onMove(Za,Pa)}x4c(){this.Olc=ud.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")}}Object(d.a)(Vc,"FormulaAssistanceMoveAdapter",null,[]);var yd=a(276);class Sd{constructor(Za){this.mH=Za;this.tn=!1}uba(){return this.tn&&
!!this.Uja}aPa(Za){this.Uja.style.cursor="grabbing";this.qFj=Za.clientPoint.x;this.rFj=Za.clientPoint.y;this.mH.QEf("drag");return!0}Zla(Za){this.mH.onMove(Za.clientPoint.x-this.qFj,Za.clientPoint.y-this.rFj);return!0}Yla(){this.cB()}Xla(){this.cB()}ka(Za){if(this.Uja=Za)this.Uja.style.cursor="grab",yd.a.instance.$_(this.Uja,this),this.tn=!0}detach(){this.tn&&this.Uja&&(this.Uja.style.cursor="",yd.a.instance.T7(this.Uja,this),this.tn=!1)}cB(){this.Uja.style.cursor="grab";this.mH.kyf()}}Object(d.a)(Sd,
"FormulaAssistanceDragAdapter",null,[659]);class Wd{constructor(Za,Pa){this.UJa=Za;this.formulaAssistanceTelemetryManager=Pa;this.tn=!1;this.Eea={[Hd.Drag]:0,[Hd.Move]:0};this.ODc=this.UJa.getWindowEdgeBuffer()+1;this.jsf=new Vc(this);this.CKe=new Sd(this)}ka(Za,Pa,Ab,Aa){this.root=Za;this.render=Ab;this.dismiss=Aa;this.detach();Pa&&(this.CKe.ka(Pa),this.jsf.ka(Za.firstChild),this.tn=!0)}detach(){this.tn&&(this.CKe.detach(),this.jsf.detach(),this.tn=!1);ka.DOMElementExtensions.sf(this.placeholder)}clear(){this.UJa.setOverrideTarget(void 0);
this.detach();this.ILd()}QEf(Za,Pa=!1){this.Eea[Za]+=1;this.nzc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);Za=this.placeholder.firstChild;Za.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);Pa&&(this.VFd=document.activeElement,Za.tabIndex=0,Za.focus());this.dismiss();return Za}onMove(Za,Pa){Za=Math.min(Math.max(Za,this.ODc-this.nzc.left),window.innerWidth-this.nzc.right-this.ODc);Pa=Math.min(Math.max(Pa,this.ODc-this.nzc.top),
window.innerHeight-this.nzc.bottom-this.ODc);this.placeholder.firstChild.style.transform=`translate(${Za}px, ${Pa}px)`}kyf(Za=!0){const Pa=this.placeholder.firstChild.getBoundingClientRect(),Ab=this.UJa.getDirectionalHint({top:Pa.top,left:Pa.left});this.UJa.setOverrideTarget({top:1===Ab?Pa.bottom:Pa.top,left:Pa.left});this.render();window.requestAnimationFrame(()=>{ka.DOMElementExtensions.sf(this.placeholder);this.VFd&&(Za&&this.VFd.focus(),this.VFd=void 0)})}ILd(){const Za=this.formulaAssistanceTelemetryManager.X9,
Pa=this.Eea[Hd.Drag],Ab=this.Eea[Hd.Move];0<Pa&&(Za.argumentAssistanceDragCounter+=1,Za.argumentAssistanceDragTotalCounter+=Pa,this.Eea[Hd.Drag]=0);0<Ab&&(Za.argumentAssistanceMoveCounter+=1,Za.argumentAssistanceMoveTotalCounter+=Ab,this.Eea[Hd.Move]=0)}}Object(d.a)(Wd,"FormulaAssistanceDragControl",null,[]);var Hd;(function(Za){Za.Drag="drag";Za.Move="move"})(Hd||(Hd={}));Object(d.b)("FormulaAssistanceDragMode",Hd);class le extends Gb.a{constructor(Za,Pa,Ab,Aa,rb,Lb){super(le.fKa(D.a.J4()));this.$=
Za;this.zj=Pa;this.functionInfoManager=Ab;this.formulaAssistanceUIControl=Aa;this.formulaAssistanceTelemetryManager=rb;this.pluginScheduler=Lb;this.l2a=null;this.w2=0;this.Br=null;this.qXc=!1;this.dla=this.$q=null;this.HSa=!0;this.PQ=!1;this.xba=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.igf=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.onCardModeChange=oc=>{this.cPb(oc);1===
oc?this.formulaAssistanceTelemetryManager.X9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.X9.argumentAssistanceExpandCounter++};this.WRa=oc=>{const $c={};$c[x.a.oQ]="ArgumentAssistanceCard";const Fd={};Fd.FunctionName=oc.functionName;$c[x.a.xad]=Fd;this.$.fd(802602464,0,8,$c)};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.X9.argumentAssistanceDismissCounter++;this.HSa=!1;this.Esb();this.PQ&&this.mH.clear();0===this.w2&&this.cPb(1)};this.Lf=()=>{this.HSa=
!0;this.PQ&&this.mH.clear()};this.KKi=oc=>{oc.button===Sys.UI.MouseButton.leftButton&&oc.target&&(pa.g(oc),this.l2a&&this.l2a.nTa(oc))};this.At=()=>{void 0!==this.$q&&null!==this.$q&&this.$q()};this.I4=(this.Wk=D.a.J4())&&Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);if(this.Wk){this.aQd();this.Br=new wc(this.$,this.formulaAssistanceUIControl,0,eb.a.lcd);this.I4&&A.g(this.$).hc.lm(this.Lf);if(this.PQ=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",
!1)&&Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!this.formulaAssistanceUIControl)this.mH=new Wd(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}else this.l2a=new yc(this.domElement,this.$.PE,void 0,D.a.kN(this.$)),this.Gc.ka("mousedown",this.KKi),Za=$get(w.Kcd,this.zj),this.zj.insertBefore(this.domElement,
Za);A.g(this.$).view.Xs(this.At)}Boe(Za){this.addHandler("FAFunctionNameUpdated",Za)}LRf(Za){this.removeHandler("FAFunctionNameUpdated",Za)}qpe(Za){this.addHandler("FAParameterSelectionChangedOld",Za)}jSf(Za){this.removeHandler("FAParameterSelectionChangedOld",Za)}ppe(Za){this.addHandler("FAParameterSelectionChanged",Za)}iSf(Za){this.removeHandler("FAParameterSelectionChanged",Za)}set_visible(Za){this.Wk?Za||this.Esb():Sys.UI.Control.prototype.set_visible.call(this,Za);return Za}Esb(){this.formulaAssistanceUIControl&&
(this.$q=null,this.PQ&&this.mH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.dla=null,this.Br.Jf=!1)}show(Za){this.Wk||(this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceRender"]),this.l2a.setVisible(!!Za),this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceRender"]),this.qXc&&(this.qXc=!1,this.formulaAssistanceTelemetryManager.bJa("argumentAssistanceOverall")))}MLd(){if(!this.I4||this.HSa){this.I4||this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceOverall"]);
this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceComputation"]);var Za=A.g(this.$).Li,Pa={content:Za.text,caretPosition:Za.textBox.caretPosition};(this.xba?this.pluginScheduler.getRequester().argumentAssistance(Pa,0):this.pluginScheduler.requester().argumentAssistance(Pa)).then(Ab=>{0===Ab.kind?Ab.payload?(this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceComputation"]),this.kzj(this.qFd(Ab.payload),Za.textBox.domElement)):this.Esb():this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceComputation"],
!1);return null})}}update(Za,Pa,Ab,Aa){if(!this.Wk&&Za){this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.qXc=!0;var rb=this.$.listSeparator;try{var Lb=$get(w.Mcd,this.zj);const oc=$get(w.Gcd,this.zj);Lb.innerText="";oc.innerText="";const $c=$get(w.pWe,this.zj),Fd=Za.Params.split(w.P$c);Lb=[];for(let Cd=0,$d=$c.rows.length;Cd<$d;Cd++){const he=$c.rows[Cd];ka.DOMElementExtensions.setVisible(he,Cd<Fd.length);let ue=Fd[Cd];const Me=w.vWi+Cd+
"_",ff=Za.NameDataStrings;$get(Me+w.nGb,he).innerText=ff;$get(Me+w.TDd,he).innerText=ff;if(ue){const Ve=Fd[Cd].split(rb),Ze=le.zod(Ve[Ve.length-1]),gf=le.Gki(Za);Ze&&(gf&&(2<Ve.length?(Ve[Ve.length-2]+="1",Ve[Ve.length-3]+="1"):l.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",ff,Ve.length.toString(),Pa)),le.BLg(Ve,gf,Pa,Za));ue=Ve.join(rb.toString()+" ");Fd[Cd]=ue;Ab<Ve.length?
(Lb[Cd]=Ve[Ab],l.ULS.shipAssertTag(537162072,0,!!Ve[Ab]&&1<=Ve[Ab].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",Ab,Ve.length,ff,Cd),Ve[Ab]=`${"<b>"}${Ve[Ab]}${"</b>"}`,ue=Ve.join(rb.toString()+" ")):l.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+Ab+"currRowParamsArray.Length = "+Ve.length+", current row = "+Cd);Aa&&
l.ULS.sendTraceTag(558474578,0,50,`formula '${ff}', ${Ve.length} params, isElipsis = ${Ze}, isPairsParamsFormula = ${gf}, currentParameterIndex = ${Pa}`)}$get(Me+w.UDd,he).innerHTML="("+(ue||"")+")"}Aa?this.raiseEvent("FAFunctionNameUpdated",new wb(Za.NameDataStrings,Fd)):this.raiseEvent("FAParameterSelectionChangedOld",new Ya(Fd,Lb,Ab));$c.className=Qa.a.Cqh+(this.functionInfoManager.Mgc(Za)?"-udf":"")}catch(oc){throw l.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
Za.NameDataStrings,Pa,oc),oc;}this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceComputation"])}}dispose(){this.Wk||(this.Gc.UC(),O.a.Ia(this.Gc),A.g(this.$).view.Zq(this.At),O.a.Ia(this.l2a),this.l2a=null);this.Wk&&O.a.Ia(this.Br);this.I4&&A.g(this.$).hc.Fl(this.Lf);this.functionInfoManager=this.$=null;super.dispose()}qFd(Za){const Pa=new xd;Pa.functionRenderingInfo=Za;Pa.cardMode=this.w2;this.jJd(Pa);return Pa}jJd(Za){Za.callbacks=new pd;Za.callbacks.onHelpLink=this.ofd(Za.functionRenderingInfo);
Za.callbacks.onCardModeChange=this.onCardModeChange;Za.callbacks.onFeedback=this.WRa;this.I4&&(Za.callbacks.onDismissClick=this.onDismissClick)}kzj(Za,Pa){if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceRender"]);const Ab={};Ab.zoomLevel=G(this.$);this.formulaAssistanceUIControl.updateContext(Ab);this.$q=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Pa,Za)};this.$q();this.vEd(Za);this.PQ&&this.mH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),
this.formulaAssistanceUIControl.getDraggableElement(0),this.$q,()=>this.formulaAssistanceUIControl.dismiss(this.domElement));this.Br.Jf=!0;this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.bJa("argumentAssistanceOverall")}}ofd(Za){return()=>{X(this.$,Za.helpID,Za.isUDF)}}aQd(){const Za=ec.a.get(x.a.f0b);this.w2=Za?parseInt(Za,10):le.p6c;this.formulaAssistanceTelemetryManager.LZf(this.w2)}vEd(Za){var Pa=Za.functionRenderingInfo.functionName;
this.dla&&gb.a.equals(this.dla,Pa,!0)?(Pa=lb.a.map(Za.functionRenderingInfo.signatures,Ab=>{let Aa="";0<=Ab.signatureParams.activeParam&&Ab.signatureParams.activeParam<Ab.signatureParams.params.length&&(Aa=Ab.signatureParams.params[Ab.signatureParams.activeParam]);return Aa}),this.raiseEvent("FAParameterSelectionChanged",new qc(Pa))):(this.dla=Pa,Za=lb.a.map(Za.functionRenderingInfo.signatures,Ab=>Ab.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new wb(Pa,Za)))}cPb(Za){this.w2=
Za;try{ec.a.Yw(x.a.f0b,Za.toString(),ac.AFrame.uea)}catch(Pa){l.ULS.sendTraceTag(537162070,0,15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Pa.message}`)}}static zod(Za){return gb.a.contains(Za,w.R7b,!0)}static Gki(Za){return!!Za&&gb.a.w2a(Za.NameDataStrings,"IFS")}static BLg(Za,Pa,Ab,Aa){try{if(!Za||2>Za.length)l.ULS.shipAssertTag(537162069,0,!1,`Requested not on elipsis function, formula '${Aa.NameDataStrings}', ${Za?Za.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Pa}, currentParameterIndex = ${Ab}.`);
else{var rb=Za.pop().toString();for(let Lb=Za.length-1;Lb<Ab;Lb++){const oc=Za[Lb].trim();if(Pa){const $c=Za[Lb-1].trim();Za.push(le.WGh($c,oc))}else{const $c=le.haf(oc);Za.push(le.RWe($c))}}Za.push(rb)}}catch(Lb){throw l.ULS.shipAssertTag(537162068,0,!1,`AppendNewOptionalParameters Exception. formula '${Aa.NameDataStrings}', ${Za?Za.length.toString():"currRowParamsArray == null"} params, isPairsParamsFormula = ${Pa}, currentParameterIndex = ${Ab}. 
Exception: ${Lb}`),Lb;}}static WGh(Za,Pa){Za=le.haf(Za);const Ab=le.X1e(Za);Pa=le.X1e(Pa);return le.RWe(Za,!0,!!Ab&&!!Pa&&Ab!==Pa)}static haf(Za){var Pa=Za.match(le.Pzd);Za=gb.a.trimEnd(gb.a.trimStart(Za,w.IGf),w.HGf);if(Pa&&Pa.length){Pa=Pa[Pa.length-1];const Ab=Number.parseLocale(Pa)+1;Za=Za.replace(Pa,Ab.toString())}else Za=`${Za}${1}`;return Za}static RWe(Za,Pa=!1,Ab=!1){let Aa="[{0}]";Pa&&(Aa=Ab?"[{0}":"{0}]");return String.format(Aa,Za)}static X1e(Za){return(Za=Za.match(le.Pzd))&&Za.length?
Za[0]:null}static fKa(Za){if(Za)return document.createElement("div");Za=String.format(w.tHf,w.rHf,w.TDd,Qa.a.DOe,w.nGb,Qa.a.COe,w.UDd);var Pa=String.format(w.tHf,w.sHf,w.TDd,Qa.a.DOe,w.nGb,Qa.a.COe,w.UDd);Za=String.format(w.lFh,w.mFh,Qa.a.xPe,Qa.a.Anh,m.a.Xp,w.pWe,Za,Pa);Pa=document.createElement("div");Pa.innerHTML=Za;return Pa.firstChild}}le.Pzd=RegExp("\\d+");le.p6c=0;Object(d.a)(le,"FormulaArgumentAssistanceControlDeprecated",Gb.a,[615]);class Le{constructor(){this.Iha=this.Ysa=this.Zsa=!1;this.yGf=
40;this.PAe=41;this.y0a=this.yDd=this.zDd=this.oGb=0;this.sxf=!0;this.eCd=!1;this.DUe=this.jOd=-1}}Object(d.a)(Le,"ParseContext",null,[]);var Md=a(414),ke=a(912),ve=a(323);class ge extends ke.a{constructor(Za,Pa,Ab,Aa){super(Za,Pa);this.formulaAssistanceControl=Ab;this.formulaAssistanceTelemetryManager=Aa;this.hGf=!1;this.LSa=null;this.Cld=0;this.qIa=this.oGc=null;this.dQ=0;this.Kob=Pa.textBox;this.Wk=D.a.J4();this.M$i=Na.EwaSettings.xb();this.m2=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance")}get ozb(){return Object(Md.a)(wa,
this.$.rb.ih)}get uK(){return this.formulaAssistanceControl.se}set uK(Za){this.formulaAssistanceControl.se=Za}get V5a(){return this.Ya.V5a}get U8h(){var Za=this.Kob.text;let Pa=!1;if(0>=Za.length)return Pa;const Ab=this.$.Jb.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),Aa=A.g(this.$).ha.sa.activeCell.clone();var rb=Za.charCodeAt(0);this.qIa="";this.dQ=this.xWg(Za,this.Kob.caretPosition);rb=61===rb&&-1!==this.dQ;if(!Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))rb&&
(Pa=!0);else if(rb){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){rb=0;for(var Lb=this.dQ-1;1<=Lb&&!(this.dQ-Lb>ge.frf);Lb--)if(ge.tve.includes(Za.charAt(Lb))){rb=Lb;break}rb=Za.substring(rb+1,this.dQ);Za=""!==rb?this.$.Ab.getItemByName(rb):null;Lb=this.dQ;for(var oc=this.dQ+1;oc<=this.Ya.textBox.caretPosition;oc++)if("["===this.Ya.text.charAt(oc))Lb=oc;else break;this.dQ=Lb}else{rb=Za.lastIndexOf("[");Lb=0;for(oc=rb-1;1<=oc&&!(rb-oc>ge.frf);oc--)if(ge.tve.includes(Za.charAt(oc))){Lb=
oc;break}rb=Za.substring(Lb+1,rb);Za=""!==rb?this.$.Ab.getItemByName(rb):null}Za&&2===Za.type?(Pa=!0,this.qIa=rb):A.g(this.$).Fb.hk(Aa)&&(Pa=!0,this.qIa="")}Ab.stop();this.Cld=Ab.yc;l.ULS.sendTraceTag(575776011,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is ${this.Cld} milliseconds`);return Pa}get key(){return u.a.Xub}get calcManager(){this.oGc||(this.oGc=this.$.da.za(266,!1));return this.oGc}get FSd(){if(null!=
this.LSa)return this.LSa;if(!Na.EwaSettings.ma(135))return this.LSa=!1;const Za=A.g(this.$).ha.sa.activeCell.clone();if(1!==Za.Jqf||!Za.left||A.g(this.$).ha.sa.lhc())return!1;let Pa=this.formulaAssistanceControl.tableManager.qn(Za);if(Pa)return this.LSa=!1;--Za.left;--Za.right;if(!Za.Ez)return!1;Pa=this.formulaAssistanceControl.tableManager.qn(Za);return this.LSa=!!Pa&&Za.top===Pa.top&&this.formulaAssistanceControl.tableManager.X4g(Pa,A.g(this.$))}Yh(Za,Pa){this.formulaAssistanceControl.Ya=this.Ya;
-1470715894!==Pa&&-1231471547!==Pa||!this.XIe()||(this.uK=!1);return super.Yh(Za,Pa)}lAd(){var Za=this.V5a;if(Za||this.FSd)if(this.formulaAssistanceControl.Ya=this.Ya,this.formulaAssistanceTelemetryManager.Pob.formulaAssistanceRequestAttemptedCounter++,this.XIe())if(!Za&&this.FSd)this.formulaAssistanceControl.xte();else if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&this.U8h){if(Za=this.$.Jb.Bc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),
this.formulaAssistanceControl.zte(),Za.stop(),this.Kob.text.endsWith("[")&&"["!==this.Kob.text.charAt(this.Kob.text.length-2)){const Pa=""===this.qIa?this.formulaAssistanceControl.tableManager.Mg:Object(oa.a)(ve.a,this.$.Ab.getItemByName(this.qIa));l.ULS.sendTraceTag(575776010,0,50,`FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id ${Pa.mj} in ${Za.yc} ms with cell edit regression time of ${this.Cld} ms and popup visibility - ${this.uK}`)}}else this.formulaAssistanceControl.yob(),
this.hGf&&(this.hGf=this.uK=!1);else this.formulaAssistanceTelemetryManager.Pob.formulaAssistanceRequestOptimizedCounter++;else this.uK=!1}qh(){this.M$i||(this.LSa=null,this.FSd&&this.formulaAssistanceControl.gZ())}Lf(){this.uK=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.iuc();this.Wk&&this.jvi()}NGd(Za,Pa){return this.formulaAssistanceControl.Yh(Za,Pa)}jvi(){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.formulaAssistanceControl.R$&&
!this.formulaAssistanceControl.kia&&!this.formulaAssistanceControl.Xna&&(this.formulaAssistanceTelemetryManager.AJ.dismissSmartSuggestionImplicitlyCounter++,this.formulaAssistanceControl.R$=!1);this.formulaAssistanceControl.UD&&(this.formulaAssistanceTelemetryManager.PM.smartSuggestionShownCounter++,this.formulaAssistanceControl.UD=!1);this.formulaAssistanceControl.Xna&&(this.formulaAssistanceTelemetryManager.PM.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.Xna=!1);this.formulaAssistanceControl.gTa&&
(this.formulaAssistanceTelemetryManager.PM.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.gTa=!1);this.m2&&(this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit&&(this.formulaAssistanceTelemetryManager.PM.isCellContentOnlyEqualDuringEditCounter++,this.formulaAssistanceControl.isCellContentOnlyEqualDuringEdit=!1),this.formulaAssistanceControl.tMa&&(this.formulaAssistanceTelemetryManager.PM.isCellContentFormulaCounter++,this.formulaAssistanceControl.tMa=!1))}xWg(Za,Pa){let Ab=
0,Aa;for(;-1!==Ab;)if(Ab=Za.indexOf("[",Ab+1),-1!==Ab&&Ab<Pa&&(Aa=Za.indexOf("]",Ab+1),-1===Aa||Aa>=Pa))return Ab;return-1}XIe(){const Za=this.Ya.text,Pa=this.Ya.textBox.caretPosition,Ab=this.formulaAssistanceControl.Pxa,Aa=this.formulaAssistanceControl.LNa;if(this.uK&&gb.a.equals(Za,Ab,!0)&&Pa===Aa)return!1;this.formulaAssistanceControl.Pxa=Za;this.formulaAssistanceControl.LNa=Pa;return!0}}ge.tve=" !%&'()*+,-/:;<=>@[]^{|}~".split("");ge.frf=255;Object(d.a)(ge,"FormulaAutoCompleteListAutoCompleteBehavior",
ke.a,[]);var we=a(30),De;(function(Za){Za[Za.function=0]="function";Za[Za.field=1]="field";Za[Za.definedName=2]="definedName";Za[Za.letVariable=3]="letVariable";Za[Za.tableColHeaderName=4]="tableColHeaderName";Za[Za.tableSpecialStructRef=5]="tableSpecialStructRef";Za[Za.pendingData=6]="pendingData";Za[Za.tableNamedObject=7]="tableNamedObject"})(De||(De={}));Object(d.b)("ItemType",De);var ib=a(1091),Yb=a(1090);class pc{constructor(Za){this.index=Za}execute(Za){Za.push(this.index)}}Object(d.a)(pc,"AppendIndexOperation",
null,[660]);class Jc{execute(){}}Object(d.a)(Jc,"NopIndexOperation",null,[660]);class Xc{constructor(Za,Pa){this.t0i=Za;this.ltf=Pa}execute(Za){for(let Pa=0;Pa<Za.length;Pa++)Za[Pa]===this.t0i&&(Za[Pa]=this.ltf)}}Object(d.a)(Xc,"ReplaceIndexOperation",null,[660]);var M=a(79);class $a{constructor(Za,Pa){this.$=Za;this.items=Pa;this.kV=D.a.kV(this.$)}CFe(Za,Pa){const Ab=new pc(Pa);if(!this.kV)return Ab;Za=this.Api(Za,Pa);return null!=Za?this.items[Za].JAb?new Xc(Za,Pa):new Jc:Ab}Api(Za,Pa){const Ab=
this.items[Pa];l.ULS.shipAssertTag(537162075,0,!!Ab,"Internal error: invalid item index");Za=M.where(M.asEnumerable(Za),Aa=>this.items[Aa].name===Ab.name);return M.Ct(Za)?M.first(Za):null}}Object(d.a)($a,"FilterItemOperationFactory",null,[]);var ob=a(117),Tb=a(838);class Dc{constructor(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.isPrefixed=this.detail=this.type=null}}Object(d.a)(Dc,"CompletionItem",null,[]);const ad=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='${"description_cell"}{4}' class='${m.a.Xp}'>{3}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Xp}'>{5}</td>\r\n</tr>`,
ld=`<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Xp}'></td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Xp}'>{2}</td>\r\n</tr>`,md=`<td>\r\n\t<div class='${m.a.WA}'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>`,Wb=`<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='${"description_cell"}{1}' class='${m.a.Xp}'>{5}</td>\r\n\t<td id='${"item_type_cell"}' class='${m.a.Xp}'>{2}</td>\r\n</tr>`;
class Nc extends ib.a{constructor(Za,Pa,Ab,Aa,rb){super(Za,Pa);this.qra=null;this.$Mb=this.Ivc=0;this.Qqb=null;this.qWe=Ab;this.Uub=Aa;this.formulaAssistanceControl=rb;this.zr=[];this.WV=[];this.zgf=(this.Wk=D.a.J4())&&Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations")}TVc(Za){this.addHandler("FLBSelectedRowChanged",Za)}IKd(Za){this.removeHandler("FLBSelectedRowChanged",Za)}SZb(Za){this.addHandler("ACLBUpdated",Za)}otc(Za){this.removeHandler("ACLBUpdated",Za)}get uic(){return 0<
this.$Mb&&this.$Mb===this.zr.length}get se(){return super.se}set se(Za){super.se=Za;Za||(this.Ivc=0,this.fe=null);0===this.Ivc?ka.DOMElementExtensions.setVisible(this.Uub,Za&&!this.Wk):ka.DOMElementExtensions.setVisible(this.Uub,!1)}get Lj(){return this.qra}set Lj(Za){this.CBa(this.Lj);if(Za){this.qWe.innerText="";this.qra=Za;var Pa=this.CBa(this.Lj);const Ab=Za.rowIndex+1,Aa=$get("description_cell"+Ab,Za);this.Uub.innerText=Aa.innerText;const rb=$get("item_type_cell",Za);this.fe=Pa=Pa.innerText;
this.Ivc="field"===rb.innerText?1:"definedName"===rb.innerText?2:"letVariable"===rb.innerText?3:"tableColHeaderName"===rb.innerText?4:"tableSpecialStructRef"===rb.innerText?5:"pendingData"===rb.innerText?6:"tableNamedObject"===rb.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Yb.a(this.zr.length,Ab,Pa,Aa.innerText));this.uvc(Za)}}get ZTa(){return this.Uub}get FGa(){return this.formulaAssistanceControl}get n0(){return this.Ivc}dispose(){super.dispose();this.qra=this.qWe=this.Uub=null}Xzc(Za,
Pa,Ab,Aa=0){this.zgf||this.E7(!1);let rb="";Ab&&(rb+=`<table aria-live='off' id='${"list_column_header"}'><tr><td class='${Qa.a.f0g}'>${Ab}</td></tr></table>`);rb+=`<table class='${this.Xba}' aria-live='off'><tbody>`;const Lb=new Ob.a;for(let $c=0,Fd=this.WV.length;$c<Fd;$c++)rb+=this.k4e(Za[this.WV[$c]],$c+1,Pa,Aa),this.Wk&&Lb.add(this.QYe(Za[this.WV[$c]]));let oc=this.WV.length;for(let $c=0,Fd=this.zr.length;$c<Fd;$c++)this.WV.includes(this.zr[$c])||(oc++,rb+=this.k4e(Za[this.zr[$c]],oc,Pa,Aa),
this.Wk&&Lb.add(this.QYe(Za[this.zr[$c]])));this.gg.innerHTML=rb+"</tbody></table>";this.zn=ka.DOMElementExtensions.fk(this.domElement,this.Xba);this.Wk&&(this.Qqb=Lb.toArray());this.zgf?(this.se=!0,this.FGa.set_visible(!0)):(this.E7(!0),this.zJg(!!Ab))}IJa(Za,Pa,Ab,Aa="",rb=0,Lb=!1){if(Za){var oc=[],$c=[];this.$Mb=0;var Fd=new $a(this.$,Za);if(Pa){var Cd=!!Pa&&0<rb,$d=Cd&&91===Pa.charCodeAt(rb+1)?rb+2:rb+1;Lb=Cd?Pa.length===$d:!1;Cd&&Pa.length===rb&&Na.EwaSettings.ma(135)&&(Lb=!0);var he=null;!Lb&&
Cd&&Pa.length>rb+1&&(he=Pa.substring($d,Pa.length));if(Pa)for(let ue=0,Me=Za.length;ue<Me;ue++)if(Cd=Za[ue].name,!Za[ue].sgi){$d=Fd.CFe(oc,ue);Za[ue].JAb&&this.$Mb++;if(!he&&!Lb||0===Za[ue].itemType)({naf:oc,yJf:$c}=this.KTe(Pa,Cd,Ab,$d,oc,$c));he&&1===Za[ue].itemType&&({naf:oc,yJf:$c}=this.KTe(he,Cd,!0,$d,oc,$c));Lb&&1===Za[ue].itemType&&$d.execute(oc)}}else for(Ab=0;Ab<Za.length;++Ab)if(Za[Ab].JAb||Lb)he=Fd.CFe(oc,Ab),he.execute(oc),he.execute($c),Za[Ab].JAb&&this.$Mb++;this.WV=$c;this.zr=oc;this.Xzc(Za,
Pa,Aa,rb)}}wSj(Za){if(Za&&!(1<Za.length)){var Pa=[],Ab=[];Pa.push(0);Ab.push(0);this.WV=Pa;this.zr=Ab;this.Xzc(Za,"","",0)}}tya(){this.Lj&&super.tya()}T3i(Za,Pa){this.raiseEvent("ACLBUpdated",new Yb.a(Za,void 0,void 0,Pa))}nfg(Za){const Pa=this.zn.rows[Za];return(!this.Lj||this.Lj!==Pa)&&Za<this.zn.rows.length?(this.Lj=Pa,!0):!1}static RYe(Za){switch(Za){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}}onItemClick(Za){pa.g(Za.Ca);
0===this.n0||2===this.n0||3===this.n0||4===this.n0||5===this.n0||7===this.n0?(this.raiseEvent(Tb.a.a5a),this.tya()):1===this.n0?this.FGa.Vy(!1):(this.FGa.Vy(!1),Za=A.g(this.$),Za.Qo(!1),Za.focus());return!0}zJg(Za){this.Zra();if(Za){var Pa=this.zn.offsetWidth+(this.zr.length>this.fI?ob.a.xu:0);Za=$get("list_column_header");Za.offsetWidth>Pa&&ka.DOMElementExtensions.Jv(this.gg,Za.offsetWidth);Pa=this.gg.getElementsByClassName(this.f_);for(let Ab=0;Ab<Pa.length;Ab++)Pa[Ab].style.width=z.HelperMethods.pc(Za.offsetWidth)}}k4e(Za,
Pa,Ab,Aa){if(1===Za.itemType){const rb=we.a.zg(Za.name),Lb=we.a.zg(Aa?Ab.substring(Aa+1,Ab.length):Ab);let oc=0;rb.substring(0,Lb.length).toLowerCase()!==Lb.toLowerCase()&&(oc=Nc.ZEj(rb,w.nig,Lb));Ab="";Ab=0<=oc?Ab+(rb.substring(0,oc)+"<b>"+rb.substring(oc,oc+Lb.length)+"</b>"+rb.substring(oc+Lb.length,rb.length)):Ab+rb;Aa=Aa?String.format(md,m.a.YPe,we.a.wZ(na.a.Ue(0)),r.a.instance.ga(717)):"";return String.format(ld,Aa,Pa,De[Za.itemType],this.f_,Ab)}if(5===Za.itemType)return String.format(Wb,"",
Pa,De[Za.itemType],this.f_,we.a.zg(Za.name),we.a.zg(Za.ija));if(4===Za.itemType)return String.format(Wb,"(...)",Pa,De[Za.itemType],this.f_,we.a.zg(Za.name));if(6===Za.itemType)return Aa=Aa?String.format(md,m.a.YPe,we.a.wZ(na.a.Ue(0)),r.a.instance.ga(717)):"",String.format(ad,Aa,this.f_,we.a.zg(Za.name),we.a.zg(Za.ija),Pa,De[Za.itemType]);Aa=String.format(md,2===Za.itemType||3===Za.itemType?m.a.Oth:m.a.Mth,we.a.wZ(na.a.Ue(0)),r.a.instance.ga(714));return String.format(ad,Aa,this.f_,we.a.zg(Za.name),
we.a.zg(Za.ija),Pa,De[Za.itemType])}QYe(Za){const Pa=new Dc;Pa.label=Za.label;Pa.textEdit=Za.textEdit;Pa.kind=Nc.RYe(Za.itemType);Pa.type=Za.JAb?1:0;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===Pa.kind){const Ab=this.formulaAssistanceControl.VPh(Za.label);Pa.detail=Ab?Ab:Za.ija}else Pa.detail=Za.ija;return Pa}KTe(Za,Pa,Ab,Aa,rb,Lb){gb.a.equals(Pa,"Pretend this is the line.",!1)&&0<rb.length||gb.a.uL(Pa,Za)?(Aa.execute(rb),Aa.execute(Lb)):Ab&&Za.length>=
w.$4g&&Nc.Keh(Pa,w.nig,Za)?Aa.execute(rb):!Ab&&Za.length>=w.Z4g&&gb.a.contains(Pa,Za,!0)&&Aa.execute(rb);return{naf:rb,yJf:Lb}}static Keh(Za,Pa,Ab){for(const Aa of Pa)if(Pa=Za.split(Aa),!(2>Pa.length))for(const rb of Pa)if(gb.a.uL(rb,Ab))return!0;return!1}static ZEj(Za,Pa,Ab){for(const Aa of Pa)if(Pa=Za.toLowerCase().indexOf((Aa+Ab).toLowerCase()),0<Pa)return Pa+1;return-1}}Object(d.a)(Nc,"FormulaAutoCompleteListBox",ib.a,[614]);class gd{constructor(){this.o9=this._name=null}get name(){return this._name}get toolTip(){return this.o9}}
Object(d.a)(gd,"LETVariableInfo",null,[]);class Gd{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Gd,"TableColHeaderNameInfo",null,[]);class Zd{constructor(){this._name=null}get name(){return this._name}}Object(d.a)(Zd,"TableNamedObjectInfo",null,[]);class xe{constructor(){this.o9=this._name=null}get name(){return this._name}get toolTip(){return this.o9}}Object(d.a)(xe,"TableSpecialStructRefInfo",null,[]);var Re=a(113),Ue=a(174),jf=a(29),Bf=a(100),Ae=a(909),Qe=a(250),Je=a(51),
se=a(172);class cb{constructor(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}}Object(d.a)(cb,"FormulaAutoCompleteCallbacks",null,[]);class Rb{constructor(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}}Object(d.a)(Rb,"FormulaAutoCompleteRenderingInfo",null,[]);class uc{}Object(d.a)(uc,"RunExperimentRequest",null,[]);class Sc extends Jb.a{constructor(Za,Pa,Ab,Aa,rb,Lb,oc,$c,Fd){super(Za);this.functionInfoManager=
Pa;this.calcManager=Aa;this.instantaneousSupportInformationManager=rb;this.formulaAssistanceUIControl=oc;this.formulaAssistanceTelemetryManager=$c;this.pluginScheduler=Fd;this.Pdc=!1;this.r5=this.Dsd=this.sV=this.Mg=this.GGa=this.Br=null;this.y5b=this.LNb=this.Rsb=this.oKe=this.z3=this.Q$b=this.G3a=0;this.Wxc=!1;this.Upc=this.Mia=null;this.columnName="";this.Oxe=this.A6c=!1;this.VJa=[];this.cQ=null;this.z7=[];this.h8=this.Ncd=this.$q=null;this.kia=this.R$=this.tMa=this.isCellContentOnlyEqualDuringEdit=
this.gTa=this.Xna=this.UD=this.Cfa=!1;this.Pxa=null;this.LNa=0;this.r3d=null;this.sDb=0;this.ond=!1;this.onRestoreFocus=()=>{};this.fgb=void 0;this.xba=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.igf=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6592409_startArgumentAssistanceTimerBeforeAutocompleteCalculation");this.dAb=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Kid=()=>{this.Wk&&this.raiseEvent(Sc.Ubd,
null)};this.GTe=()=>{this.Mia=!1;this.sV=this.Ya.text;this.ah.IJa(this.sr,this.sV,!0,this.columnName,void 0,!1);1===this.ah.zr.length&&1===this.ah.WV.length?(this.set_visible(!1),this.Oxe||this.wld()):this.show()};this.vMi=Cd=>{if(vc.a(Cd))-315732528!==Cd.Errors[0].MessageId&&l.ULS.sendTraceTag(537162013,0,10,`FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : ${jf.a.xc(Cd.Errors)}`);else if((Cd=Cd.Result)&&Cd.length){this.Mg.AO||(this.Mg.AO={},this.Mg.AO.HeadersList=
[]);this.Mg.AO.IsFullTableHeaders=!0;for(let $d=0;$d<Cd.length;++$d)this.Mg.AO.HeadersList[$d]={},this.Mg.AO.HeadersList[$d].Index=$d,this.Mg.AO.HeadersList[$d].Name=Cd[$d];this.XIf(!0);this.sV=this.j4e();this.ah.IJa(this.sr,this.sV,!0,void 0,void 0,!0);this.show()}else l.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};this.uMi=Cd=>{Cd=gc.a.ff(Cd.data);l.ULS.sendTraceTag(537162011,0,10,`FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: ${jf.a.xc(Cd)}`)};
this.bvf=(Cd,$d)=>{this.gridView.eb||this.gridView.Fi||this.OOa(null===$d||void 0===$d?void 0:$d.cell)};this.qh=(Cd,$d)=>{this.OOa(null===$d||void 0===$d?void 0:$d.bja)};this.d6=(Cd,$d)=>{this.qNd($d.newValue)};this.Vc=()=>{(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")||this.Wk)&&this.set_visible(!1)};this.Zyf=()=>{this.h8=this.GGa=null};this.Ih=()=>{this.Wk&&this.a2a()};this.onFunctionInfoLoaded=()=>{this.yob()};this.Qya=()=>{this.ika?(this.GGa=
this.h8=null,this.yob()):this.Ug.Xk&&this.xte()};this.wca=()=>{this.cQ&&X(this.$,this.cQ.HelpId,this.cQ.IsDynamicUdf);return!0};this.yca=(Cd,$d)=>{0==$d.Vq&&(170==$d.zf.operation.operationName&&this.formulaAssistanceTelemetryManager.Njc++,this.$.userOperationManager.ho(this.yca))};this.kPa=(Cd,$d)=>{0==$d.Vq&&(12==$d.zf.operation.operationName&&this.$.userOperationManager.nr(this.yca),this.$.userOperationManager.ho(this.kPa))};this.a2a=()=>{this.Wk&&this.Jud();Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.UD&&(this.R$=!0);this.EF&&this.Ya.eb&&this.Rma();this.$q=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.H0b),this.Br.Jf=!1);this.ond=!1};this.TDf=()=>{this.EF&&this.Rma();this.u5f(!1);1===this.yYf.type&&Na.EwaSettings.xb()&&!this.Ya.text.includes("\n")&&this.HFd(this.yYf)};this.onDismiss=()=>{this.se=!1;this.gridView.Li.textBox.focus()};this.WRa=()=>{const Cd={};this.ah.uic?Cd[x.a.oQ]="SmartSuggestionsCard":Cd[x.a.oQ]="FunctionAndSmartSuggestionsCard";this.$.fd(802602464,
0,8,Cd)};this.LAd=(Cd,$d)=>{this.ah.nfg($d);this.Wk&&(this.IIa=!0)};this.KAd=Cd=>{this.Wk&&(this.FIa=!0);this.EF?(this.YBe(),this.x9&&this.ZWf(),this.gridView.baa.CZf(),this.gridView.Li.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Cd.textEdit?this.Lqb(Cd.textEdit):this.Vy(!0)};this.rq=A.g(Za);this.domElement.className=Qa.a.KNe;this.Ug=Lb.Y3c(Za,Ab);this.o6b=new fb(Za);this.xyg=Ab;Sc.Ukd||(Sc.Ukd=Sc.fKa());this.domElement.innerHTML=Sc.Ukd;this.Pzd=RegExp("\\d+");Qe.d(this.style,
this.$.isChromeRtl);this.cja=new le(this.$,this.domElement,this.functionInfoManager,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager,this.pluginScheduler);Pa=$get(w.Kcd,this.domElement);Ab=$get(w.Gcd,this.domElement);Aa=$get(w.Mcd,this.domElement);this.Aqg=new Nc(this.$,Pa,Aa,Ab,this);this.Ug.KZb(this.Qya);this.functionInfoManager.XFa(this.onFunctionInfoLoaded);this.functionInfoManager.sGg(this.Zyf);this.H0b=this.domElement;this.Wk&&(this.$.xa.Qf(this.Ih),this.ah.TVc(this.TDf),
Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&(this.H0b=document.createElement("div")));this.yTa(!0);this.H8f(!0);this.$.domElement.appendChild(this.H0b);this.TQc=0;(Ab=Re.a(Za))&&this.VJa.push(new ge(Za,Ab,this,this.formulaAssistanceTelemetryManager));this.VJa.push(new ge(Za,this.rq.Xb,this,this.formulaAssistanceTelemetryManager));this.Nub=this.VJa[0];this.Xpb=this.VJa[this.VJa.length-1];Za.da.Ga(221,this);this.instantaneousSupportInformationManager||
this.$.da.Za(268,Cd=>{this.instantaneousSupportInformationManager=Cd});this.YSe=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Na.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===this.formulaAssistanceTelemetryManager.l7.anyPluginInitialized?l.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):this.formulaAssistanceTelemetryManager.l7.anyPluginInitialized||
(this.sDb=Na.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));this.eBa=D.a.kV(this.$);this.Vyc=D.a.wxa(this.$);this.Pxj=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7136215_AdjustFunctionSuggestionGating")?D.a.Rte(this.$):this.eBa||this.Vyc;this.ozd=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.m2=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");this.JYc=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");
D.a.jV()&&this.qmd();D.a.kN(this.$)&&Pa.classList.add("ewa-fb-refactor");this.Wk?this.gridView.ha.YG(this.Vc):this.gridView.ha.uT(this.Vc);this.Br=new wc(this.$,this.formulaAssistanceUIControl,1,eb.a.ncd,this.Kid);this.Ynd=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.x9=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.Gii=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceGridView",
!1)}zoe(Za){this.addHandler(Sc.tcd,Za)}KRf(Za){this.removeHandler(Sc.tcd,Za)}xoe(Za){this.addHandler(Sc.Ubd,Za)}IRf(Za){this.removeHandler(Sc.Ubd,Za)}yoe(Za){this.addHandler("FormulaAutoCompleteShown",Za)}JRf(Za){this.removeHandler("FormulaAutoCompleteShown",Za)}get Zt(){return this.ah}get sr(){return this.h8}get NKb(){return this.ah.fe}get mWe(){return this.ah}get PVe(){return this.cja}get ah(){return this.Aqg}get t1a(){return this.eBa?this.Ya?this.Ya.text:null:this.sV}get Dgf(){var Za;return 0===
(null===(Za=this.CUe)||void 0===Za?void 0:Za.type)}get kni(){var Za;return 1===(null===(Za=this.CUe)||void 0===Za?void 0:Za.type)}get_visible(){return void 0!==this.fgb?this.fgb:this.fgb=super.get_visible()}set_visible(Za){if(this.fgb===Za)return this.Wk&&!Za&&this.a2a(),Za;this.cja.set_visible(Za);this.Wk&&!Za&&this.a2a();Sys.UI.Control.prototype.set_visible.call(this,Za);return this.fgb=Za}get se(){return this.Zt.se}set se(Za){this.Wk&&!Za&&this.a2a();this.Zt.se=Za}get tableManager(){return this.xyg}get ika(){return 0<
this.NY}get EF(){return this.Cfa}get gridView(){return this.Gii?this.rq:A.g(this.$)}get Fb(){return this.gridView.Fb}GVg(Za,Pa){this.se&&(Za+=w.openParen,Pa++,this.YDd(Za,Pa));var Ab=Pa===Za.length||Za.charAt(Pa)===w.closeParen;if(!(0<Pa&&Za.charAt(Pa-1)===w.openParen&&Ab))return l.ULS.sendTraceTag(537162053,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments Caret position: ${Pa} is invalid. Is cell empty: ${!Za.length}. Function exists in cell: ${!!this.cQ}`),!1;Ab=Za.substring(0,Pa).lastIndexOf(this.$.listSeparator);
const Aa=Za.substring(0,Pa-1).lastIndexOf(w.openParen);Za=Za.substring(-1===Ab&&-1===Aa?1:Math.max(Ab,Aa)+1,Pa-1).trim();return this.functionInfoManager.hfd(Za)?!0:(l.ULS.sendTraceTag(537162052,0,50,`FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: ${!!this.cQ}`),!1)}oci(Za,Pa){var Ab=this.GVg(Za,Pa);if(!Ab||!this.cQ)return l.ULS.shipAssertTag(537162051,0,!Ab||Ab&&!!this.cQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),
{returnValue:null,htf:0,EUe:0};Ab=this.cQ.Params;Ab=Ab.replace(RegExp("[\\[\\]]","g"),"");const Aa=Za.charAt(Pa-1)===w.openParen,rb=Aa?"":"(",Lb=Pa===Za.length?")":"";var oc=this.$.listSeparator;oc=Ab.includes(oc)?Ab.indexOf(oc):Ab.length;return{returnValue:Za.substring(0,Pa)+rb+Ab+Lb+Za.substring(Pa,Za.length),htf:Aa?Pa:Pa+1,EUe:oc}}At(Za,Pa){this.Wk&&void 0!==this.$q&&null!==this.$q&&this.$q();this.Wk||super.At(Za,Pa)}get q0b(){return this.r3d}get NY(){return this.oKe}set NY(Za){this.oKe=Za;Za||
(this.z3=0)}get uxj(){if(null==this.Upc){const Za=this.$.jc;this.Upc=!!Za&&!Za.inEmbedView}return this.Upc}get yYf(){return this.ah.Qqb[this.ah.Lj.rowIndex]}get CUe(){var Za,Pa;return null===(Pa=null===(Za=this.ah)||void 0===Za?void 0:Za.Qqb)||void 0===Pa?void 0:Pa[0]}get tWe(){!this.Ncd&&this.pluginScheduler&&(this.Ncd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Ncd}dispose(){if(this.$){this.yTa(!1);const Za=this.gridView;this.x9&&(this.$.userOperationManager.ho(this.yca),this.$.userOperationManager.ho(this.kPa));
Za&&(Za.ha&&(this.Wk?Za.ha.cG(this.Vc):Za.ha.IR(this.Vc),D.a.jV()&&4!==this.sDb&&(this.dAb?Za.hc.Ak(this.qh):Za.ha.Sma(this.bvf))),Za.view.Zq(this.Pnc));this.Wk&&this.$.xa&&this.$.xa.Eg(this.Ih)}this.functionInfoManager&&(this.functionInfoManager.Lbb(this.onFunctionInfoLoaded),this.functionInfoManager.Bbj(this.Zyf));this.Ug&&this.Ug.gtc(this.Qya);this.Wk&&this.ah&&this.ah.IKd(this.TDf);D.a.Mfc&&this.Ya&&this.Ya.SIb(this.d6);this.H8f(!1);O.a.Ia(this.ah);O.a.Ia(this.q0b);O.a.Ia(this.cja);O.a.Ia(this.Br);
this.Ya=this.functionInfoManager=this.Ug=null;O.a.qc(this.VJa);this.Mg=this.h8=this.cja=this.VJa=null;super.dispose()}hxa(){return!this.sr}pji(){return!this.GGa}jQj(Za){this.kni&&1872288872===Za&&(this.formulaAssistanceTelemetryManager.aD(["autoCompleteSmartSuggestionActiveDismissing"]),this.kia=!0)}Yh(Za,Pa){if(!this.hxa()){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.jQj(Pa);if(this.Wk&&this.EF){if(125627505===Pa||267796030===Pa)return this.Wk&&this.YBc(Pa),
this.YBe(),this.x9&&this.ZWf(),!1;if(1872288872===Pa)return this.Rma(),this.se=!1,!0;if(this.ah.uic&&(-798660877===Pa||137938150===Pa))return!1}if(1!==this.ah.n0||125627505!==Pa&&267796030!==Pa)if(6===this.ah.n0){var Ab=Za.keyCode;13!==Ab&&9!==Ab||this.Vy(!1)}else{if(4===this.ah.n0||5===this.ah.n0)return super.Yh(Za,Pa,!0);1===this.ah.WV.length&&(Ab=Za.keyCode,this.Oxe=8===Ab||127===Ab||46===Ab?!0:!1)}else{if(this.Vy(!1)&&!this.ika)return this.gridView.ha.Yh(Za,Pa);if(125627505===Pa&&this.ika)return!0}}return super.Yh(Za,
Pa)}iuc(){this.Ug.icb();this.h8=null;null==this.Mia||this.Mia||this.nkc("NoFieldChosen",1,2,1);this.Mia=null;this.NY=0;this.r5=this.Dsd=this.Upc=null}yob(){this.igf&&this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceOverall"]);const Za=!!this.Ya&&!pb.f(this.$.oa);let Pa=null;this.m2&&Za&&(Pa=this.Ya.text,Pa.startsWith("=")&&(this.tMa=!0,1===Pa.length&&(this.isCellContentOnlyEqualDuringEdit=!0)));if(this.Pxj&&Za){this.m2||(Pa=this.Ya.text);const Ab={content:Pa,caretPosition:null};(this.xba?
this.pluginScheduler.getRequester().functionSuggestion(Ab,0):this.pluginScheduler.requester().functionSuggestion(Ab)).then(Aa=>{if(0===Aa.kind){l.ULS.shipAssertTag(537162050,0,!!Aa&&!!Aa.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion");const rb=M.toArray(M.select(M.asEnumerable(Aa.payload.items),Lb=>Sc.O3g(Lb)));this.Vyc&&this.gridView.baa.fQd(Aa.payload,Pa);this.eBa&&(this.z7=rb,Nb.AFrameworkApplication.Qg||(this.JYc&&this.Fb.e5(this.gridView.ha.sa.activeCell)?
this.formulaAssistanceTelemetryManager.PM.smartSuggestionWouldSuggestInsidePivotCounter++:this.yte(Za,!0)))}return null})}this.eBa&&Za||this.yte(Za,!1)}j4e(){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var Za=this.gridView.tm?this.Nub.dQ:this.Xpb.dQ;this.LNb="@"===this.Ya.text.charAt(Za+1)&&this.Ya.textBox.caretPosition>Za+1?Za+2:Za+1}else{Za=this.Ya.text.lastIndexOf(w.Klf);const Pa=this.Ya.text.lastIndexOf("[");this.LNb=Za+1>=Pa?Za+2:Pa+1}return this.Ya.text.substring(this.LNb,
this.Ya.textBox.caretPosition)}zte(){this.G5f()&&(this.Iah(),this.sr&&(this.Mia=!1,this.sV=this.j4e(),this.ah.IJa(this.sr,this.sV,!0,void 0,void 0,!0),this.show(),Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.cja.Esb()))}xte(){this.G5f()&&(this.q0b&&this.q0b.cancel(),this.Ug.I6a?(this.hxa()&&this.mEe(!0),this.get_visible()?this.GTe():this.r3d=Ue.AsyncMethodContext.yr(this.GTe,w.feh,Wa.a.jEh,this.q0b)):this.gZ())}G5f(){return this.Ya?0<this.$.rb.uR||
!this.Ya.text||!this.Ya.eb?(this.set_visible(!1),!1):pb.f(this.$.oa)?!1:!0:!1}Lqb(Za){this.Ya&&this.se&&(this.Gmd(this.Ya.text,Za),this.Ya.textBox.caretPosition=Za.range.start.character+Za.newText.length,this.set_visible(!1))}Vy(){var Za;if(!this.Ya||!this.se)return!1;const Pa=this.ah.n0;this.formulaAssistanceTelemetryManager.eaf(Nc.RYe(Pa));let Ab="";var Aa=0;const rb=this.gridView;var Lb=this.Ya.text,oc=0,$c=this.ah.fe,Fd=!1;if(0===Pa||2===Pa||3===Pa||7===Pa)Ab+=Lb.substr(0,this.G3a)+this.ah.fe,
0!==Pa||this.ah.fe.endsWith(")")||(Ab+="("),Aa=Ab.toString().length,Ab+=Lb.substr(this.Q$b),2===Pa&&(oc=4,$c="DefinedName",Fd=!0,this.set_visible(!1));else if(1===Pa)if(this.Mia=!0,this.ika){Ab+=Lb.substr(0,this.NY+2);!Ab.toString().endsWith(Kb.a.rU)&&Na.EwaSettings.ma(135)&&(Ab+=Kb.a.rU);oc=this.ah.fe;oc=oc.replace("'","''");oc=oc.replace("[","'[");oc=oc.replace("]","']");if(this.A6c||this.Pzh(oc))oc=Kb.a.gsi+oc+Kb.a.Dij,Fd=!0;Ab+=oc;Aa=Ab.length;oc=3;se.a("PulloutFieldAccepted")}else return this.Ya.text=
this.ah.fe,this.set_visible(!1),rb.Qo(!1),rb.focus(),this.nkc("FieldName",1,1,1),se.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===Pa)l.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),Ab+=Lb.substr(0,this.LNb),gb.a.equals(this.ah.fe,"@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString,!1)?Ab+="@":(Ab+=this.ah.fe,Fd=!0,this.set_visible(!1)),Aa=Ab.length;else if(4===Pa){l.ULS.sendTraceTag(575776009,
0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");Ab+=Lb.substr(0,this.LNb);Fd="";Aa=!1;var Cd=[39,91,93,64,35];for(let $d=0;$d<this.ah.fe.length;$d++){const he=this.ah.fe.charCodeAt($d);Cd.includes(he)&&(Fd+="'");Fd+=this.ah.fe.charAt($d).toString();Aa||gb.a.isNumeral(he)||gb.a.Wff(he)||(Aa=!0)}Cd=this.gridView.tm?this.Nub.dQ:this.Xpb.dQ;Lb=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Lb.charAt(Cd+
1)&&Aa:Lb.lastIndexOf(w.Klf)+1>=Lb.lastIndexOf("[")&&Aa;Ab+=Lb?"["+Fd+"]":Fd;Fd=!0;this.set_visible(!1);Aa=Ab.toString().length}else if(6===Pa)Ab+=Lb.substr(0,this.Rsb);else return l.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=Ab;this.Ya.textBox.caretPosition=Aa;this.Ya.xxa()&&(null===(Za=rb.Vr)||void 0===Za?0:Za.Zua)&&rb.Vr.WKb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.Cy.length);rb.tm&&
(Za=rb.Xb,Za.text=this.Ya.text,Za.setCaretPosition(this.Ya.textBox.caretPosition));$c=(null==this.Mia?0:this.Mia)?"FieldName":$c;this.ah.Lj.sectionRowIndex>=this.ah.WV.length?this.nkc($c,4,oc,0):this.nkc($c,1,oc,0);Fd||(5===Pa||4===Pa?this.zte():this.yob());return!0}gZ(Za=null,Pa=null){Za?(this.Ug.icb(),this.Ug.gZ(Za,!1,!1,Pa)):(Za=this.gridView,Za.ha.sa.Bg&&(Za=Pb.v(Za.ha.sa.Xc,this.$),this.Ug.gZ(Za,!0,!0,Pa)))}Rma(){this.Cfa=!1;this.Ya.xJe()}VPh(Za){Za=this.calcManager.getWorksheetFuncId(Za);return this.tWe?
this.tWe.descriptionsMap.get(Za):null}mEe(Za){if(this.pji()){if(this.Ug.I6a&&this.Ug.Xk&&(!this.Ug.Xk.length||!this.Ug.Xk[0].FieldInfoDataList))return;this.vQj(Za)}Za=M.asEnumerable(this.GGa);Za=M.concat(Za,this.VRh(this.Ya.text));Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Wk&&(Za=M.concat(Za,this.cTh()));M.OBc(Za,Pa=>Pa.name,new Ae.a);this.eBa&&(Za=M.concat(M.asEnumerable(this.z7),Za),Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?0<this.z7.length?(this.UD||this.formulaAssistanceTelemetryManager.WD(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.UD=!0):this.UD&&this.Dgf&&(this.R$=!0):0<this.z7.length&&(this.UD=!0),this.z7=[]));this.h8=M.toArray(Za)}Iah(){var Za=this.Ya.text;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var Pa=this.gridView.tm?this.Nub.qIa:
this.Xpb.qIa,Ab=!0;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==Pa&&(this.Mg=Object(oa.a)(ve.a,this.$.Ab.getItemByName(Pa))),this.Mg||(this.Mg=this.tableManager.Mg,Ab=!1),!this.Mg){l.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d");return}}else this.Mg=Object(oa.a)(ve.a,this.$.Ab.getItemByName(Pa)),
this.Mg||(this.Mg=this.tableManager.Mg,Ab=!1);this.Mg.AO&&this.Mg.AO.IsFullTableHeaders?this.XIf(Ab):Fa.d(this.Mg)?(l.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s"),bb.o(this.$.pa.va,this.Mg.mj,this.vMi,this.uMi,null,null)):l.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.")}else if(this.calcManager&&this.tableManager.Mg)if(Pa=
this.calcManager.T4a(this.tableManager.Mg))if(this.calcManager.mKg(this.tableManager.Mg,Pa)){Za=M.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){const Aa=this.o1a("@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString);Za=M.concat(Za,(Ab=new Ob.a,Ab.add(Aa),Ab))}Za=M.concat(Za,M.select(M.asEnumerable(Pa.toArray()),Aa=>{const rb=new tb,Lb=new Gd;Lb._name=Aa.toString();rb.B1f(Lb);return rb}));this.h8=M.toArray(Za)}else Za.endsWith("[")&&"["!==Za.charAt(Za.length-
2)&&l.ULS.sendTraceTag(572381130,0,50,`FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with ${Pa.count} columns for a table with id ${this.tableManager.Mg.mj} of size ${this.tableManager.Mg.usedRange.right-this.tableManager.Mg.usedRange.left+1}`);else Za.endsWith("[")&&"["!==Za.charAt(Za.length-2)&&l.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")}Pzh(Za){if(!Za)return!1;
let Pa=Za.charCodeAt(0);if(46===Pa||48<=Pa&&57>=Pa||63===Pa)return!0;for(let Ab=0;Ab<Za.length;Ab++,Pa=Za.charCodeAt(Ab))if(!((Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?gb.a.isLetter(Pa):gb.a.Bpd(Pa))||92===Pa||95===Pa||63===Pa||48<=Pa&&57>=Pa))return!0;return!1}YDd(Za,Pa){let Ab=!1,Aa=!1;var rb=!1,Lb=0;let oc=0;this.G3a=0;this.Q$b=Pa;this.y5b=1;for(let $c=Pa-1;0<=$c;--$c)switch(Za.charCodeAt($c)){case 39:Aa=!Aa;break;case 34:Ab=
!Ab;break;case 91:++Lb;rb=Lb>oc;break;case 93:++oc}rb=Object(Bb.a)(new Le,{Ysa:!Ab,Zsa:!Aa,Iha:!rb,oGb:1});Lb=this.RWi(Za,Pa,rb);Pa=this.SWi(Za,Pa,rb.Ysa,rb.Zsa,rb.Iha);this.y5b=Lb+Pa;if(this.TQc=Lb-1)this.Wxc=!1;this.EAh(Za,Ab,Aa,rb.yDd,rb.zDd)}qmd(){4!==this.sDb&&(this.dAb?this.gridView.hc.Vk(this.qh):this.gridView.ha.Lga(this.bvf));const Za=D.a.Syb()?this.rq.Vb(null):void 0;this.OOa(Za);D.a.Mfc&&this.gridView.Li.cZa(this.d6);Sc.vNd(this.pluginScheduler);this.eBa&&this.YXg()}dzh(){return this.eBa||
this.YSe}TWi(){var Za=this.r5;if(!this.uxj||!Za)return this.NY=0,this.GGa=this.h8=null,!1;Za=Za.endsWith(Kb.a.rU);let Pa;if(Na.EwaSettings.ma(135)&&({sheetRange:Pa}=this.QNj(this.r5.substring(0,this.z3))).returnValue){const Ab=this.r5.substring(0,this.NY);if(Za&&Ab!==this.Dsd)return this.Dsd=Ab,this.NY=this.r5.length-(Za?1:0),this.gZ(Pa,this.r5),this.Mia=!1,l.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0}return!1}VRh(Za){const Pa=new Ob.a;this.calcManager&&Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
l.ULS.shipAssertTag(537162014,0,!!this.calcManager.lta(qa.Range.Uc(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.YSe&&(Za=this.calcManager.extractLetVariables(Za,this.Ya.textBox.caretPosition)))for(const Ab of Za){Za=new gd;Za._name=Ab;Za.o9=r.a.instance.ga(2215);const Aa=new tb;Aa.prj(Za);Pa.add(Aa)}return Pa}cTh(){const Za=new Ob.a,Pa=this.$.Ab.items;for(let Aa=0,rb=Pa.length;Aa<rb;Aa++){var Ab=Pa[Aa];if(!pb.n(Ab))continue;const Lb=
new Zd;Lb._name=Ab.name;Ab=new tb;Ab.Ftj(Lb);Za.add(Ab)}return Za}o1a(Za){const Pa=new tb,Ab=new xe;Ab._name=Za;Pa.Gtj(Ab);return Pa}XIf(Za){const Pa=new Ob.a,Ab=this.Ya.text.charCodeAt(this.Ya.text.length-1),Aa=this.Ya.textBox.caretPosition-1;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(Aa):91===Ab){var rb=this.o1a("@ - "+this.instantaneousSupportInformationManager.Ge.ThisRowStructRefString);Pa.add(rb)}for(var Lb of this.Mg.AO.HeadersList){rb=
new tb;const oc=new Gd;oc._name=Lb.Name;rb.B1f(oc);Pa.add(rb)}Lb=this.gridView.tm?this.Nub.dQ:this.Xpb.dQ;rb=this.Ya.text.charCodeAt(Lb+1);(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!Za||Aa!==Lb&&35!==rb:!Za||91!==Ab&&35!==Ab)||(Za=this.o1a("#"+this.instantaneousSupportInformationManager.Ge.AllStructRefString),Pa.add(Za),Za=this.o1a("#"+this.instantaneousSupportInformationManager.Ge.DataStructRefString),Pa.add(Za),Za=this.o1a("#"+this.instantaneousSupportInformationManager.Ge.HeadersStructRefString),
Pa.add(Za),Za=this.o1a("#"+this.instantaneousSupportInformationManager.Ge.TotalsStructRefString),Pa.add(Za));Pa&&(this.h8=Pa.toArray())}vQj(Za){let Pa=M.empty();!Za&&this.functionInfoManager.lV&&(Pa=M.concat(Pa,M.select(M.asEnumerable(this.functionInfoManager.P$b),Ab=>{const Aa=new tb;Aa.d0f(Ab);return Aa})),Za=this.o6b.dIe,0<Za.length&&(Pa=M.OBc(M.concat(Pa,M.select(M.asEnumerable(Za),Ab=>{const Aa=new tb;Aa.Npj(Ab);return Aa})),Ab=>Ab.name,new Ae.a)));if(this.Ug.I6a&&this.Ug.Xk){if(!this.Ug.Xk.length||
!this.Ug.Xk[0].FieldInfoDataList)return;Pa=M.OBc(M.concat(Pa,M.select(M.asEnumerable(this.Ug.Xk[0].FieldInfoDataList),Ab=>{const Aa=new tb;Aa.mqj(Ab);return Aa})),Ab=>Ab.name,new Ae.a);this.columnName=this.Ug.Xk[0].ColumnName}this.GGa=M.toArray(Pa)}OOa(Za){var Pa;if(1!==this.sDb){var Ab=this.gridView.ha.sa.activeCell;if(Ab){var Aa=this.calcManager.lta(Ab,!this.Ynd);if(Aa){var rb=this.$.xa,Lb=Aa.sheet.index;0>=rb.count||0>Lb||Lb>=rb.count?l.ULS.sendTraceTag(512278611,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged invalid sheet index"):
(Lb=rb=null,this.ozd&&void 0!==this.calcManager&&null!==this.calcManager&&(Za=null!==(Pa=null===Za||void 0===Za?void 0:Za.cell)&&void 0!==Pa?Pa:this.gridView.Ea.es(Ab))&&(Pa=this.calcManager.Lbc(Za.Nk),void 0!==Pa&&null!==Pa&&(rb=Pa.FormatString,Lb=Pa.Builtin)),2!==this.sDb&&(this.pluginScheduler.notifier().setActiveCell({colIndex:Aa.range.col,rowIndex:Aa.range.row,sheetIndex:this.$.xa.getItem(Aa.sheet.index).sheetId,docName:Aa.sheet.document.name,docPath:Aa.sheet.document.path,formatString:rb,builtIn:Lb}),
l.ULS.sendTraceTag(512278610,0,50,`FormulaAssistanceControl.NotifyActiveCellChanged sent notification to the scheduler. col: ${Aa.range.col}, row: ${Aa.range.row}, format: ${rb}`)))}else l.ULS.sendTraceTag(512278612,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged ISheetGridCell location is null")}else l.ULS.sendTraceTag(512278613,0,50,"FormulaAssistanceControl.NotifyActiveCellChanged activeCell range is null")}}ZWf(){this.formulaAssistanceTelemetryManager.ZH={Jk:this.gridView.ha.sa.activeCell,
Zpb:this.gridView.Xb.text,Nqb:!0};this.formulaAssistanceTelemetryManager.VBb=this.$.ea.Je;this.formulaAssistanceTelemetryManager.Mjc=this.$.xa.oa.sheetId;this.$.userOperationManager.nr(this.kPa)}YXg(){this.gridView.tm?this.Nub.sY(!1):this.Xpb.sY(!1)}ujf(Za){let Pa;Pa=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?gb.a.isLetter(Za):gb.a.Bpd(Za);return 48<=Za&&57>=Za||46===Za||95===Za||Pa}show(){if(this.sr){var Za=this.ah.nfg(0);this.Wk?
0<this.ah.zr.length?Za||this.u5f(!0):this.a2a():((Za=0<this.ah.zr.length)&&this.formulaAssistanceTelemetryManager.WD(["autoCompleteRender"]),!this.se&&this.columnName&&Za&&this.ah.T3i(this.ah.zr.length,this.columnName),this.se=Za,this.cja.show(this.cQ),this.SBa(!0),this.ah.tya(),Za&&this.formulaAssistanceTelemetryManager.aD(["autoCompleteRender"]))}}SWi(Za,Pa,Ab,Aa,rb){for(Ab=Object(Bb.a)(new Le,{yGf:41,PAe:40,Ysa:Ab,Zsa:Aa,Iha:rb});Pa<Za.length&&!this.xHf(Za,Pa,Ab);++Pa);return Ab.oGb}RWi(Za,Pa,
Ab){for(--Pa;0<=Pa&&!this.xHf(Za,Pa,Ab);--Pa);return Ab.oGb}xHf(Za,Pa,Ab){const Aa=Za.charCodeAt(Pa);0>=this.z3&&(this.z3=Za.substring(0,Pa).lastIndexOf(Kb.a.rU));46===Aa&&(Pa<this.z3?this.z3=Pa:Pa>this.Rsb&&(this.NY=this.Rsb=Pa));if(!this.ujf(Aa)&&!Sc.Soi(Aa)&&(!this.ika||Pa<=this.z3||!Sc.t8h(Aa,Ab))){Ab.sxf&&(Ab.sxf=!1,this.G3a=Pa+1);if(Ab.eCd){Ab.zDd=Pa+1;if(this.functionInfoManager.hfd(Za.substring(Ab.zDd,Ab.yDd)))return!0;Ab.eCd=!1}switch(Aa){case 39:Ab.Zsa=!Ab.Zsa;break;case 34:Ab.Ysa=!Ab.Ysa;
break;case 91:Ab.Iha=!1;break;case 93:Ab.Iha=!0}Aa===this.$.listSeparator.toString().charCodeAt(0)&&Ab.Zsa&&Ab.Ysa&&!Ab.y0a&&(!this.ika||Ab.Iha)&&(Pa<Ab.jOd||-1===Ab.jOd)&&(Ab.oGb+=1,this.y5b++);Aa===Ab.PAe&&Ab.Ysa&&Ab.Zsa&&(!this.ika||Ab.Iha)?Ab.y0a+=1:Aa===Ab.yGf&&Ab.Ysa&&Ab.Zsa&&(!this.ika||Ab.Iha)?0<Ab.y0a?--Ab.y0a:(Ab.jOd=Ab.DUe,Ab.DUe=Pa,0<Pa&&this.ujf(Za.charCodeAt(Pa-1))&&(Ab.eCd=!0,Ab.yDd=Pa)):this.ika&&46===Aa&&Pa>this.z3&&(Pa<this.z3?this.z3=Pa:Pa>this.Rsb&&(this.NY=this.Rsb=Pa))}return!1}EAh(Za,
Pa,Ab,Aa,rb){this.Q$b>this.G3a&&0<=this.G3a?Pa||Ab||(this.sV=Za.substring(this.G3a,this.Q$b)):this.sV=null;Aa!==rb?(Za=Za.substring(rb,Aa),this.cQ&&gb.a.equals(this.cQ.NameDataStrings,Za,!0)||(this.Wxc=!0),this.cQ=this.functionInfoManager.hfd(Za)):(this.Wxc=!1,this.cQ=null)}H8f(Za){const Pa=$get(w.rHf+"_"+w.nGb,this.domElement),Ab=$get(w.sHf+"_"+w.nGb,this.domElement);Za&&!this.Pdc?(Pa&&Ia.a.instance.ra(jb.a.click,Pa,this.wca),Ab&&Ia.a.instance.ra(jb.a.click,Ab,this.wca),this.Pdc=!0):this.Pdc&&(Pa&&
Ia.a.instance.Ba(jb.a.click,Pa,this.wca),Ab&&Ia.a.instance.Ba(jb.a.click,Ab,this.wca),this.Pdc=!1)}QNj(Za){let Pa;Pa=null;var Ab;if(({sheetName:Aa,range:Ab}=Pb.Z(Za,this.$.ea.xa)).returnValue&&Ab){if(!Aa){var Aa=Object(oa.a)(Bf.a,this.$.oa);if(!Aa)return{returnValue:!1,sheetRange:Pa};Aa=Aa.name}Pa=Pb.v(Ab,this.$);Pa.SheetName=Aa;this.A6c=!1;return{returnValue:!0,sheetRange:Pa}}return({sheetName:Aa,range:Ab}=this.o6b.zNj(Za)).returnValue?(Pa=Pb.v(Ab,this.$),Pa.SheetName=Aa,this.A6c=!0,{returnValue:!0,
sheetRange:Pa}):{returnValue:!1,sheetRange:Pa}}qNd(Za){Za={content:Za,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.xba?this.pluginScheduler.getRequester().runAuthoringExperiment(Za,0):this.pluginScheduler.requester().runAuthoringExperiment(Za)}wld(){if(1===this.ah.WV.length&&this.sr.length){var Za=this.sr[this.ah.WV[0]];if(1===Za.itemType){var Pa=Za.name;Za=this.Ya.text;Pa=Pa.substring(Za.length,Pa.length);Pa.length&&(this.Ya.text=Za+Pa,this.Ya.textBox.selectRange(Za.length,
this.Ya.text.length))}}else l.ULS.shipAssertTag(537162007,0,!1,`InCellAutoComplete should only be called when there is 1 item (number of items: ${this.ah.WV.length})`)}nkc(Za,Pa,Ab,Aa){const rb={};rb.a=Za;rb.b=Pa;rb.c=Ab;rb.d=Aa;Je.b().Ne(38,rb,!0)}yte(Za,Pa){if(!this.functionInfoManager.lV){if(Za)if(this.YDd(this.Ya.text,this.Ya.textBox.caretPosition),this.eBa||this.sV){const Ab={};Ab.Filter=this.sV?this.sV.charAt(0).toString():"";Ab.FilterType=1;Ab.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.eJa(Ab)}else Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6518663_FlightRemovalAutocompleteTableColumnHeaders")&&
this.get_visible()&&this.set_visible(!1);if(!Pa)return}0<this.$.rb.uR||this.Ya&&!this.Ya.eb?this.set_visible(!1):Za&&(this.YDd(this.Ya.text,this.Ya.textBox.caretPosition),this.cja.update(this.cQ,this.y5b,this.TQc,this.Wxc),this.r5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.z3=this.r5.indexOf(Kb.a.rU),this.NY=this.r5.lastIndexOf(Kb.a.rU),this.TWi()?(Za=new tb,Za.fsj(),this.GGa=this.h8=Za=[Za],this.ah.wSj(Za),this.show()):((this.dzh()||this.hxa())&&this.mEe(!1),0<this.NY?this.ah.IJa(this.sr,
this.r5,!1,void 0,this.r5.lastIndexOf(Kb.a.rU),!1):this.ah.IJa(this.sr,this.sV,!1,void 0,this.NY,!1),this.show(),this.Wk&&(this.ah.zr.length||this.gridView.Li.rI?this.cja.Esb():(this.cja.MLd(),this.Wk&&this.a2a()))))}u5f(Za){if(0<this.ah.zr.length){this.formulaAssistanceTelemetryManager.WD(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){const Pa={};Pa.zoomLevel=G(this.$);this.formulaAssistanceUIControl.updateContext(Pa);this.$q=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.H0b,
this.gridView.Li.textBox.domElement,this.efd())};this.$q();this.Wk&&this.ah.uic&&this.raiseEvent(Sc.tcd,null);this.ond||this.ah.uic||this.raiseEvent("FormulaAutoCompleteShown");this.ond=this.Br.Jf=!0;Za&&this.formulaAssistanceTelemetryManager.faf(this.ah.Qqb)}this.formulaAssistanceTelemetryManager.aD(["autoCompleteRender"]);Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")?!Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&
void 0!==this.z7&&null!==this.z7&&0<this.z7.length?(this.UD||this.formulaAssistanceTelemetryManager.WD(["autoCompleteSmartSuggestionActiveDismissing","autoCompleteSmartSuggestionAccepted"]),this.UD=!0):this.UD&&this.Dgf&&(this.R$=!0):!Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.z7&&null!==this.z7&&0<this.z7.length&&(this.UD=!0)}}Jud(){this.HIa&&(this.formulaAssistanceTelemetryManager.AJ.selectByArrowKeyCounter++,this.HIa=!1);this.IIa&&(this.formulaAssistanceTelemetryManager.AJ.selectByMouseHoverCounter++,
this.IIa=!1);this.GIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByTabKeyCounter++,this.GIa=!1);this.EIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByEnterKeyCounter++,this.EIa=!1);this.FIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByMouseClickCounter++,this.FIa=!1);Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&this.kia&&(this.formulaAssistanceTelemetryManager.AJ.dismissSmartSuggestionExplicitlyCounter++,this.kia=!1)}efd(){const Za=new Rb;
Za.completionItems=this.ah.Qqb;Za.activeItemIndex=this.ah.Lj?this.ah.Lj.rowIndex:-1;this.eJd(Za);return Za}eJd(Za){Za.callbacks=new cb;Za.callbacks.onCompletionItemSelected=this.LAd;Za.callbacks.onCompletionItemCommitted=this.KAd;Za.callbacks.onFeedback=this.WRa;Za.callbacks.onDismiss=this.onDismiss;Za.callbacks.onRestoreFocus=this.onRestoreFocus}HFd(Za){this.Cfa=!0;const Pa=Za.textEdit.newText;this.Ya.Xdb(Pa.substring(this.Ya.text.length-Za.textEdit.range.start.character,Pa.length))}YBe(){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7041469_LogSuggestionsDismissalControl")&&
this.formulaAssistanceTelemetryManager.aD(["autoCompleteSmartSuggestionAccepted"]);this.Vy(!0);this.Cfa=this.se=!1;this.gTa=this.Xna=!0}Gmd(Za,Pa){this.Ya.text=Za.substring(0,Pa.range.start.character)+Pa.newText+Za.substring(Pa.range.end.character,Za.length);this.gridView.tm&&(this.gridView.Xb.text=this.Ya.text)}static vNd(Za){Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUse")?Za.getRequester().runExperiment(new uc,0):Za.requester().runExperiment(new uc)}static O3g(Za){const Pa=
tb.rah(),Ab={IsCompatibility:!1};Ab.NameDataStrings=Za.label;Ab.Help=Za.detail;Pa.d0f(Ab);Pa.textEdit=Za.textEdit;return Pa}static fKa(){const Za=String.format(w.nFh,w.Mcd,ha.a.GOe),Pa=String.format(w.iFh,w.Kcd,Qa.a.Q9c,m.a.lp,m.a.Xp),Ab=String.format(w.gFh,w.Gcd,Qa.a.Q9c,m.a.lp,Qa.a.xPe,m.a.Xp);return`${Za}
${Pa}
${Ab}`}static Soi(Za){return 36===Za||58===Za||33===Za||39===Za||32===Za}static t8h(Za,Pa){return 32===Za||91===Za||!Pa.Iha}}Sc.tcd="FACardOpened";Sc.Ubd="FAFocusOnSmartSuggestionsCard";Sc.Ukd=null;Object(d.a)(Sc,"FormulaAssistanceControl",Jb.a,[599,600,10,601,602]);class ub extends Gb.a{constructor(Za,Pa,Ab){super(ub.fKa());this.$=Za;this.formulaAssistanceUIControl=Pa;this.formulaAssistanceTelemetryManager=Ab;this.w2=0;this.dla=this.$q=this.Br=null;this.PQ=this.Uv=!1;this.Vc=()=>{this.visible=!1};
this.onCardModeChange=Aa=>{this.cPb(Aa);1===Aa?this.formulaAssistanceTelemetryManager.X9.argumentAssistanceCollapseCounter++:this.formulaAssistanceTelemetryManager.X9.argumentAssistanceExpandCounter++};this.WRa=Aa=>{const rb={};rb[x.a.oQ]="ArgumentAssistanceCard";const Lb={};Lb.FunctionName=Aa.functionName;rb[x.a.xad]=Lb;this.$.fd(802602464,0,8,rb)};this.At=()=>{void 0!==this.$q&&null!==this.$q&&this.$q()};this.onDismissClick=()=>{this.formulaAssistanceTelemetryManager.X9.argumentAssistanceDismissCounter++;
this.dismiss();this.raiseEvent("DC");this.PQ&&this.mH.clear();0===this.w2&&this.cPb(1)};this.Lf=()=>{this.PQ&&this.mH.clear()};this.I4=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.aQd();this.Br=new wc(this.$,this.formulaAssistanceUIControl,0,eb.a.lcd);A.g(this.$).view.Xs(this.At);A.g(this.$).ha.YG(this.Vc);if(this.PQ=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1))this.mH=new Wd(this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager),A.g(this.$).hc.lm(this.Lf);Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement)}Boe(Za){this.addHandler("FAFunctionNameUpdated",Za)}LRf(Za){this.removeHandler("FAFunctionNameUpdated",Za)}qpe(Za){this.addHandler("FAParameterSelectionChangedOld",Za)}jSf(Za){this.removeHandler("FAParameterSelectionChangedOld",Za)}ppe(Za){this.addHandler("FAParameterSelectionChanged",
Za)}iSf(Za){this.removeHandler("FAParameterSelectionChanged",Za)}XFg(Za){this.addHandler("DC",Za)}kbj(Za){this.removeHandler("DC",Za)}get visible(){return this.Uv}set visible(Za){Za||this.dismiss();this.Uv=Za}dismiss(){this.Uv=!1;this.formulaAssistanceUIControl&&(this.$q=null,this.PQ&&this.mH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.dla=null,this.Br.Jf=!1)}show(Za,Pa){this.Uv=!0;const Ab=this.qFd(Za);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceRender"]),
Za={},Za.zoomLevel=G(this.$),this.formulaAssistanceUIControl.updateContext(Za),Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.$q=()=>{this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Pa,Ab)},this.$q()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,Pa,Ab),this.vEd(Ab),this.PQ&&this.mH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.$q,
()=>this.formulaAssistanceUIControl.dismiss(this.domElement)),this.Br.Jf=!0,this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceRender"]),this.formulaAssistanceTelemetryManager.bJa("argumentAssistanceOverall"))}dispose(){if(this.$){const Za=A.g(this.$);Za&&(Za.ha&&Za.ha.cG(this.Vc),Za.view.Zq(this.At),this.PQ&&Za.hc.Fl(this.Lf))}O.a.Ia(this.Br);this.$=null}qFd(Za){const Pa=new xd;Pa.functionRenderingInfo=Za;Pa.cardMode=this.w2;this.jJd(Pa);return Pa}jJd(Za){Za.callbacks=new pd;Za.callbacks.onHelpLink=
this.ofd(Za.functionRenderingInfo);Za.callbacks.onCardModeChange=this.onCardModeChange;Za.callbacks.onFeedback=this.WRa;this.I4&&(Za.callbacks.onDismissClick=this.onDismissClick)}ofd(Za){return()=>{X(this.$,Za.helpID,Za.isUDF)}}aQd(){const Za=ec.a.get(x.a.f0b);this.w2=Za?parseInt(Za,10):ub.p6c;this.formulaAssistanceTelemetryManager.LZf(this.w2)}vEd(Za){var Pa=Za.functionRenderingInfo.functionName;this.dla&&gb.a.equals(this.dla,Pa,!0)?(Pa=lb.a.map(Za.functionRenderingInfo.signatures,Ab=>{let Aa="";
0<=Ab.signatureParams.activeParam&&Ab.signatureParams.activeParam<Ab.signatureParams.params.length&&(Aa=Ab.signatureParams.params[Ab.signatureParams.activeParam]);return Aa}),this.raiseEvent("FAParameterSelectionChanged",new qc(Pa))):(this.dla=Pa,Za=lb.a.map(Za.functionRenderingInfo.signatures,Ab=>Ab.signatureParams.params.join(", ")),this.raiseEvent("FAFunctionNameUpdated",new wb(Pa,Za)))}cPb(Za){this.w2=Za;try{ec.a.Yw(x.a.f0b,Za.toString(),ac.AFrame.uea)}catch(Pa){l.ULS.sendTraceTag(537162074,0,
15,`Failed setting ArgumentAssistanceCardCollapseState cookie with error message: ${Pa.message}`)}}static fKa(){return document.createElement("div")}}ub.p6c=0;Object(d.a)(ub,"FormulaArgumentAssistanceControl",Gb.a,[620]);var Zb;(function(Za){Za[Za.Dismissed=0]="Dismissed";Za[Za.Smart=1]="Smart";Za[Za.Simple=2]="Simple";Za[Za.Mixed=3]="Mixed"})(Zb||(Zb={}));Object(d.b)("UIState",Zb);class Ec extends Gb.a{constructor(Za,Pa,Ab){super(Ec.fKa());this.$=Za;this.formulaAssistanceUIControl=Pa;this.formulaAssistanceTelemetryManager=
Ab;this.Br=this.Ya=this.gridView=null;this.R$=this.kia=this.FIa=this.EIa=this.GIa=this.IIa=this.HIa=!1;this.sr=null;this.zW=0;this.$q=null;this.gTa=this.Xna=this.UD=this.Cfa=this.Uv=!1;this.SOb=Zb.Dismissed;this.onRestoreFocus=()=>{};this.dismiss=()=>{this.Uv=!1;this.V6a&&(this.UD||this.xUd)&&this.JMa&&(this.R$=!0);this.Jud();this.EF&&this.Ya.eb&&this.Rma();this.$q=null;this.formulaAssistanceUIControl&&(this.formulaAssistanceUIControl.dismiss(this.domElement),this.Br.Jf=!1,this.SOb=Zb.Dismissed)};
this.Kid=()=>{this.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};this.yca=(Aa,rb)=>{0==rb.Vq&&(170==rb.zf.operation.operationName&&this.formulaAssistanceTelemetryManager.Njc++,this.$.userOperationManager.ho(this.yca))};this.kPa=(Aa,rb)=>{0==rb.Vq&&(12==rb.zf.operation.operationName&&this.$.userOperationManager.nr(this.yca),this.$.userOperationManager.ho(this.kPa))};this.kJi=()=>{this.dismiss();this.gridView.Li.textBox.focus()};this.WRa=()=>{const Aa={};this.iGf?Aa[x.a.oQ]="SmartSuggestionsCard":
Aa[x.a.oQ]="FunctionAndSmartSuggestionsCard";this.$.fd(802602464,0,8,Aa)};this.Lf=()=>{this.JMa&&this.YJg()};this.LAd=(Aa,rb)=>{this.Lfb(rb);this.IIa=!0};this.Vc=()=>{this.visible=!1};this.KAd=Aa=>{this.FIa=!0;this.Lqb(Aa)};this.Ih=()=>{this.dismiss()};this.At=()=>{void 0!==this.$q&&null!==this.$q&&this.$q()};this.gridView=A.g(this.$);this.Br=new wc(this.$,this.formulaAssistanceUIControl,1,eb.a.ncd,this.Kid);this.gridView.view.Xs(this.At);this.gridView.ha.YG(this.Vc);this.$.xa.Qf(this.Ih);this.JMa=
Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");this.x9=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.V6a=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6650011_LogSuggestionsDismissal");this.JMa&&this.gridView.hc.lm(this.Lf);Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&this.$.domElement.appendChild(this.domElement);this.Fji=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")}zoe(Za){this.addHandler("FACardOpened",
Za)}KRf(Za){this.removeHandler("FACardOpened",Za)}xoe(Za){this.addHandler("FAFocusOnSmartSuggestionsCard",Za)}IRf(Za){this.removeHandler("FAFocusOnSmartSuggestionsCard",Za)}yoe(Za){this.addHandler("FormulaAutoCompleteShown",Za)}JRf(Za){this.removeHandler("FormulaAutoCompleteShown",Za)}TVc(Za){this.addHandler("SelectedRowChanged",Za)}IKd(Za){this.removeHandler("SelectedRowChanged",Za)}SZb(Za){this.addHandler("ListBoxUpdated",Za)}otc(Za){this.removeHandler("ListBoxUpdated",Za)}dispose(){this.$&&(this.x9&&
(this.$.userOperationManager.ho(this.yca),this.$.userOperationManager.ho(this.kPa)),this.gridView&&(this.gridView.ha&&this.gridView.ha.cG(this.Vc),this.gridView.hc&&this.JMa&&this.gridView.hc.Fl(this.Lf),this.gridView.view.Zq(this.At)),this.$.xa&&this.$.xa.Eg(this.Ih));O.a.Ia(this.Br);this.$=null}LFg(Za){this.addHandler("CVIC",Za)}Yaj(Za){this.removeHandler("CVIC",Za)}get visible(){return this.Uv}set visible(Za){Za||this.dismiss();this.Uv=Za}get EF(){return this.Cfa}get xUd(){var Za,Pa;return 1===
(null===(Pa=null===(Za=this.sr)||void 0===Za?void 0:Za.items[0])||void 0===Pa?void 0:Pa.type)}get iGf(){return 1===this.sr.items.length&&this.xUd}Yh(Za,Pa){if(!this.visible)return!1;this.YBc(Pa);let Ab;return(Ab=this.R3h(Pa)).wdc?Ab.result:this.$wj(Pa)}Ywb(Za){if(!this.visible)return!1;let Pa=!1;switch(Za){case 1872288872:this.EF&&this.Rma();this.V6a&&this.xUd&&(this.formulaAssistanceTelemetryManager.aD(["autoCompleteSmartSuggestionActiveDismissing"]),this.kia=!0);this.visible=!1;Pa=!0;break;case -798660877:this.Lfb(this.Dwb(this.zW+
1));Pa=!0;break;case 137938150:this.Lfb(this.Dwb(this.zW-1));Pa=!0;break;case 2091832999:this.Lfb(this.Dwb(this.zW+8));Pa=!0;break;case 742457698:this.Lfb(this.Dwb(this.zW-8));Pa=!0;break;case 125627505:case 267796030:this.Lqb(this.sr.items[this.zW]),Pa=!0}return Pa}show(Za){this.Ya=this.gridView.Li;this.Uv=!0;this.zW=0;this.sr=Za;0<this.sr.items.length&&(this.render(),this.Lfb(this.Dwb(this.zW)),this.V6a?this.JMa&&(1===this.sr.items[0].type?(this.UD||this.formulaAssistanceTelemetryManager.WD(["autoCompleteSmartSuggestionActiveDismissing",
"autoCompleteSmartSuggestionAccepted"]),this.UD=!0):this.UD&&(this.R$=!0)):1===this.sr.items[0].type&&this.JMa&&(this.UD=!0));this.formulaAssistanceTelemetryManager.faf(Za.items)}Rma(){this.Cfa=!1;this.Ya.xJe()}$wj(Za){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(Za)}R3h(Za){return this.EF?125627505===Za||267796030===Za?(this.Lqb(this.sr.items[this.zW]),{wdc:!0,result:!1}):!this.iGf||-798660877!==Za&&137938150!==Za?{wdc:!1}:{wdc:!0,result:!1}:{wdc:!1}}render(){this.formulaAssistanceTelemetryManager.WD(["autoCompleteRender"]);
if(this.formulaAssistanceUIControl){const Za={};Za.zoomLevel=G(this.$);this.formulaAssistanceUIControl.updateContext(Za);this.$q=()=>{this.formulaAssistanceUIControl.renderAutoCompleteMenu(this.domElement,this.Ya.textBox.domElement,this.efd())};this.$q();this.I3i();this.Br.Jf=!0;this.Mlh()}}Mlh(){this.formulaAssistanceTelemetryManager.aD(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.bJa("autoCompleteOverall");const Za=this.sr.items.some(Ab=>1===Ab.type),Pa=this.sr.items.some(Ab=>
0===Ab.type);Za&&Pa?this.formulaAssistanceTelemetryManager.bJa("autoCompleteOverallSimpleAndSmart"):Za?this.formulaAssistanceTelemetryManager.bJa("autoCompleteOverallSmartOnly"):Pa&&this.formulaAssistanceTelemetryManager.bJa("autoCompleteOverallSimpleOnly")}I3i(){const Za=this.SOb;this.SOb=this.q_h(this.sr.items);Za!==Zb.Dismissed&&Za!==Zb.Smart||this.SOb!==Zb.Simple&&this.SOb!==Zb.Mixed||this.raiseEvent("FormulaAutoCompleteShown")}n4i(){var Za;if(this.Fji&&0!==this.sr.items.length){var Pa=0<=this.zW?
this.zW:0,Ab=this.sr.items[Pa];Ab={jG:Ab.label,description:null!==(Za=Ab.detail)&&void 0!==Za?Za:"",selectedIndex:Pa+1,length:this.sr.items.length};this.raiseEvent("SelectedRowChanged",Ab)}}Lqb(Za){if(this.Ya&&this.visible){var Pa=Za.textEdit;this.Gmd(this.Ya.text,Pa);this.Ya.textBox.caretPosition=Pa.range.start.character+Pa.newText.length;this.EF&&(this.Cfa=!1,this.JMa&&(this.V6a&&this.formulaAssistanceTelemetryManager.aD(["autoCompleteSmartSuggestionAccepted"]),this.gTa=this.Xna=!0),this.x9&&this.urj(),
this.gridView.baa.CZf(),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:Za.shouldRequestAutocompleteOnCommit});this.formulaAssistanceTelemetryManager.eaf(Za.kind)}}urj(){this.formulaAssistanceTelemetryManager.ZH={Jk:this.gridView.ha.sa.activeCell,Zpb:this.gridView.Xb.text,Nqb:!0};this.formulaAssistanceTelemetryManager.Mjc=this.$.xa.oa.sheetId;this.formulaAssistanceTelemetryManager.VBb=this.$.ea.Je;this.$.userOperationManager.nr(this.kPa)}YJg(){this.V6a&&
this.R$&&!this.kia&&!this.Xna&&(this.formulaAssistanceTelemetryManager.AJ.dismissSmartSuggestionImplicitlyCounter++,this.R$=!1);this.UD&&(this.formulaAssistanceTelemetryManager.PM.smartSuggestionShownCounter++,this.UD=!1);this.Xna&&(this.formulaAssistanceTelemetryManager.PM.smartSuggestionSelectedCounter++,this.Xna=!1);this.gTa&&(this.formulaAssistanceTelemetryManager.PM.smartSuggestionCommittedCounter++,this.gTa=!1)}efd(){const Za=new Rb;Za.completionItems=this.sr.items;Za.activeItemIndex=this.zW;
this.eJd(Za);return Za}eJd(Za){Za.callbacks=new cb;Za.callbacks.onCompletionItemSelected=this.LAd;Za.callbacks.onCompletionItemCommitted=this.KAd;Za.callbacks.onFeedback=this.WRa;Za.callbacks.onDismiss=this.kJi;Za.callbacks.onRestoreFocus=this.onRestoreFocus}HFd(Za){this.Cfa=!0;const Pa=Za.textEdit.newText;this.Ya.Xdb(Pa.substring(this.Ya.text.length-Za.textEdit.range.start.character,Pa.length))}Lfb(Za){const Pa=this.zW;this.zW=Za;const Ab=this.sr.items[Za];this.EF&&this.Rma();Pa!==Za&&this.render();
1===Ab.type&&Na.EwaSettings.xb()&&!this.gridView.Li.text.includes("\n")&&this.HFd(Ab);this.n4i()}Dwb(Za){return 0>Za?0:Math.min(Za,this.sr.items.length-1)}Gmd(Za,Pa){this.Ya.text=Za.substring(0,Pa.range.start.character)+Pa.newText+Za.substring(Pa.range.end.character,Za.length);this.gridView.tm&&(this.gridView.Xb.text=this.Ya.text)}Jud(){this.HIa&&(this.formulaAssistanceTelemetryManager.AJ.selectByArrowKeyCounter++,this.HIa=!1);this.IIa&&(this.formulaAssistanceTelemetryManager.AJ.selectByMouseHoverCounter++,
this.IIa=!1);this.GIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByTabKeyCounter++,this.GIa=!1);this.EIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByEnterKeyCounter++,this.EIa=!1);this.FIa&&(this.formulaAssistanceTelemetryManager.AJ.commitByMouseClickCounter++,this.FIa=!1);this.V6a&&this.kia&&(this.formulaAssistanceTelemetryManager.AJ.dismissSmartSuggestionExplicitlyCounter++,this.kia=!1)}YBc(Za){switch(Za){case -798660877:case 137938150:case 2091832999:case 742457698:this.HIa=!0;break;
case 125627505:this.GIa=!0;break;case 267796030:this.EIa=!0}}static fKa(){return document.createElement("div")}q_h(Za){return Za.reduce((Pa,Ab)=>Pa|=0===Ab.type?Zb.Simple:Zb.Smart,Zb.Dismissed)}}Object(d.a)(Ec,"FormulaAutoCompleteControl",Gb.a,[619,10,601]);var ed=a(753);class Kd{constructor(Za,Pa){var Ab,Aa;this.Ug=Za;this.$=Pa;this.Qya=()=>{this.D9b.resolve(this.Ug.Xk);this.zcg()};this.gzf=()=>{this.D9b.reject(null);this.zcg()};this.Lf=()=>{this.Ug.icb();this.htd=null};null===(Aa=null===(Ab=A.g(this.$))||
void 0===Ab?void 0:Ab.hc)||void 0===Aa?void 0:Aa.lm(this.Lf);this.vCj=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6476169_skipGetFieldInfoListContextIfContextLoaded")}getRichValueFieldListContext(Za,Pa,Ab,Aa){const rb={o$:Za,pKe:Pa};var Lb;if(Lb=Object(ed.b)(this.htd))Lb=this.htd,Lb=!(rb.o$.FirstRow===Lb.o$.FirstRow&&rb.o$.FirstColumn===Lb.o$.FirstColumn&&rb.o$.LastRow===Lb.o$.LastRow&&rb.o$.LastColumn===Lb.o$.LastColumn&&rb.o$.SheetName===Lb.o$.SheetName&&rb.pKe===Lb.pKe);Lb&&this.Ug.icb();this.htd=
rb;this.vCj&&this.Ug.I6a||this.Ug.gZ(Za,Ab,Aa,Pa);this.D9b=new ed.a;this.Ug.I6a?this.D9b.resolve(this.Ug.Xk):this.m8i();return this.D9b.promise}dispose(){var Za,Pa;null===(Pa=null===(Za=A.g(this.$))||void 0===Za?void 0:Za.hc)||void 0===Pa?void 0:Pa.Fl(this.Lf)}m8i(){this.Ug.KZb(this.Qya);this.Ug.uGg(this.gzf)}zcg(){this.Ug.gtc(this.Qya);this.Ug.Dbj(this.gzf)}}Object(d.a)(Kd,"ServerDataProvider",null,[618]);var fe=a(320),be=a(581),me=a(341),re=a(874);class Xe{constructor(Za){this.qK=this.rK=this.CF=
this.DF=!1;this.SZ=Za}}Object(d.a)(Xe,"MarqueeRangeData",null,[]);class We{constructor(Za,Pa,Ab,Aa=!1){this.QWd=Za;this.bOb=Pa;this.n7a=Aa;Ab?(this.SZ=Ab.SZ,this.DF=Ab.DF,this.CF=Ab.CF,this.rK=Ab.rK,this.qK=Ab.qK):l.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(d.a)(We,"MarqueeMetadata",null,[]);const ee="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class xc{constructor(Za,Pa,Ab){this.$=Za;this.pluginScheduler=Pa;this.formulaAssistanceTelemetryManager=Ab;this.mjf=this.pK=this.zeb=!1;this.rha=void 0;this.qh=()=>{this.rha=void 0};this.Kya=()=>{this.pK=!1;this.rha=void 0};this.gridView=A.g(Za);this.gridView.Xb.lm(this.Kya);this.mjf=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:7094505_updateFormulaHighlightsTelemetry");this.UAb=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6635594_updatedTriggeringX10FormulaHighlighting")}get coloredReferencesManager(){this.BVa||
(this.BVa=this.$.da.za(281));return this.BVa}nOj(Za,Pa,Ab){return isNullOrUndefined(this.coloredReferencesManager)?!1:this.coloredReferencesManager.ofb(Za,Pa,Ab)}ofb(Za,Pa,Ab){var Aa;this.mjf&&Za.textBox.addEventLogRecord("FormulaHighlightsControl.TryUpdateFormulaHighlights");if(this.zeb||Za.EF)return!1;const rb=isNullOrUndefined(Pa)?Za.text:Pa;if(1>=rb.length)return this.$eg(Za,rb,Object(ed.b)(Pa));Ab=this.A_h(Za,Pa,Ab);if(this.UAb&&this.tyj(Za,{content:rb,selection:Ab}))return!0;var Lb=null===(Aa=
this.r4a(rb,Ab))||void 0===Aa?void 0:Aa.formulaHighlights;if(!Lb)return l.ULS.sendTraceTag(512349465,0,50,"FormulaHighlightsControl.tryUpdateFormulaHighlights: formulaHighlights is null (might be an invalid formula)"),this.$eg(Za,rb,Object(ed.b)(Pa));Aa=[];Ab=new fc.a(!1);const oc=[],$c=[],Fd=[];var Cd=0;const $d=this.Fja();for(const he of Lb){this.vE(oc,rb,Cd,he.span.start,null);switch(he.kind){case 0:case 1:case 2:Lb=Pb.B(he.rangeInfo.sharedRange);if(isNullOrUndefined(Lb)){l.ULS.sendTraceTag(512349464,
0,10,`FormulaHighlightsControl.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${he.kind.toString()}`);this.vE(oc,rb,he.span.start,he.span.end,null);break}Cd=this.eZ(Lb,Ab,1);this.vE(oc,rb,he.span.start,he.span.end,Cd);Aa.push(new me.a(Lb,$d));$c.push({Start:he.span.start,End:he.span.end});Lb=oc.length-1;Fd.push(new We(Lb,oc[Lb].text,c(he)));break;case 3:this.vE(oc,rb,he.span.start,he.span.end,null,"rgba(229, 229, 229, 1)")}Cd=he.span.end}this.vE(oc,rb,Cd,
rb.length);this.gxc(Za,oc,!!Pa);Pa=Za.textBox.text;if(!gb.a.equals(Pa,rb,!1))return l.ULS.shipAssertTag(38114182,0,!1,`FormulaHighlightsControl.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Pa.length}], updatedTextLength [${rb.length}]`),Pa=Za.textBox.caretPosition,Za.textBox.text=rb,Za.textBox.caretPosition=Pa,!0;this.uz(Aa,Ab,Fd);return this.pK=!0}$eg(Za,Pa,Ab){this.uz(null,null);this.rha=void 0;if(this.pK){this.pK=
!1;const Aa=Za.textBox.caretPosition;Za.textBox.setPlainText(Pa);Za.textBox.caretPosition=Math.min(Aa,Pa.length);if(Ab)return!0}return!1}tyj(Za,Pa){var Ab,Aa,rb,Lb;const oc=(null===(Ab=this.rha)||void 0===Ab?void 0:Ab.IM)===Za&&(null===(Aa=this.rha)||void 0===Aa?void 0:Aa.d8c.content)===Pa.content&&(null===(rb=this.rha)||void 0===rb?void 0:rb.d8c.selection.index)===Pa.selection.index&&(null===(Lb=this.rha)||void 0===Lb?void 0:Lb.d8c.selection.length)===Pa.selection.length;oc||(this.rha={d8c:Pa,IM:Za});
return oc}A_h(Za,Pa,Ab){let Aa=Ab;Object(ed.b)(Pa)?Object(ed.b)(Ab)||(Aa={index:Pa.length,length:0}):Aa=Za.textBox.selection;return Aa}yDb(Za,Pa,Ab){if(!Za||!Pa||!Ab)return l.ULS.shipAssertTag(512349463,0,!!Za,"FormulaHighlightsControl.MoveMarqueeRange: cellContentEditor is null"),l.ULS.shipAssertTag(512349462,0,!!Pa,"FormulaHighlightsControl.MoveMarqueeRange: highlightState is null"),l.ULS.shipAssertTag(512349461,0,!!Ab,"FormulaHighlightsControl.MoveMarqueeRange: newRange is null"),!1;const Aa=Object(oa.a)(We,
Pa.metadata);if(!Aa)return l.ULS.shipAssertTag(512349460,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: marqueeMetadata is null"),!1;var rb=Aa.QWd,Lb=Aa.bOb,oc=this.gridView.Fb.wod(Ab)?Ab.Hvb(Aa.CF,Aa.DF):Ab.MKa(Aa.CF,Aa.DF,Aa.qK,Aa.rK);if(!oc)return l.ULS.shipAssertTag(512349459,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: newText is null"),!1;const $c=Lb.indexOf("!");-1!==$c&&(oc=Lb.substring(0,$c+1)+oc);if(!Za.textBox.changeTextInExistingTextPart(rb,Lb,oc))return l.ULS.shipAssertTag(38926105,
0,!1,"FormulaHighlightsControl.MoveMarqueeRange: failed to change the text part"),!1;Aa.bOb=oc;rb=!0;for(Lb=1;4>=Lb;Lb++)(oc=A.g(this.$).ob.nv(3,Lb,Pa.WT))?(oc.range=Ab,oc.metadata=Aa):(l.ULS.shipAssertTag(512349458,0,!1,"FormulaHighlightsControl.MoveMarqueeRange: highlightStateInPane is null"),rb=!1);this.gridView.ob.update(!1,!1);this.gridView.tm&&(this.gridView.hc.textBox.text=Za.text);this.gridView.hc.mQa(new fe.a({tzb:!0}));return rb}Mji(Za){if(3!==Za.Hq)return l.ULS.shipAssertTag(512349457,
0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: not HighlightDivIndex.Marquee."),!1;Za=Object(oa.a)(We,Za.metadata);return Za?Za.SZ&&!Za.n7a:(l.ULS.shipAssertTag(512349456,0,!1,"FormulaHighlightsControl.IsMarqueeHighlightDraggable: marqueeMetadata is null."),!1)}oBa(Za,Pa){l.ULS.sendTraceTag(512349455,0,50,"FormulaHighlightsControl.SuspendResumeColoredReferences: "+(Pa?"suspending":"resuming")+" colored references");Pa&&this.pK&&(this.pK=!1,this.uz(null,null),Za.textBox.Wze());this.zeb=
Pa}dispose(){var Za;this.gridView&&this.gridView.Xb&&this.gridView.Xb.Fl(this.Kya);(null===(Za=this.gridView)||void 0===Za?0:Za.hc)&&this.gridView.hc.Ak(this.qh);this.rha=void 0}ILa(Za){this.formulaAssistanceTelemetryManager.WD(["highlightPreviewRanges"]);var Pa=this.r4a(Za,re.a);if(isNullOrUndefined(Pa))this.sba&&this.uz(null,null);else{var Ab=this.Fja(),Aa=[],rb=new fc.a(!1),Lb=[];Pa=Pa.formulaHighlights;for(const oc of Pa)if(Pa=oc.kind,0===Pa||2===Pa||1===Pa)Pa=Pb.B(oc.rangeInfo.sharedRange),Object(ed.b)(Pa)&&
(Aa.push(new me.a(Pa,Ab)),this.eZ(Pa,rb,1),Lb.push(new We(oc.span.start,Za.substring(oc.span.start,oc.span.end),c(oc),!0)));this.uz(Aa,rb,Lb);this.formulaAssistanceTelemetryManager.aD(["highlightPreviewRanges"],!0)}}r4a(Za,Pa){return this.pluginScheduler.syncRequester().formulaHighlighting({content:Za,caretPosition:null===Pa||void 0===Pa?void 0:Pa.index,selectionLength:null===Pa||void 0===Pa?void 0:Pa.length})}eZ(Za,Pa,Ab){let Aa=Pa.getItem(Za.toString());Aa||(Aa=ee[Pa.count%ee.length],Pa.add(Za.toString(),
Aa));return String.format(Aa,Ab)}vE(Za,Pa,Ab,Aa,rb=null,Lb=null){l.ULS.shipAssertTag(512349453,0,Ab<=Aa,"FormulaHighlightsControl.AddTextPart: startIndex cannot be larger than endIndex");Ab<Aa&&(Pa=Pa.substring(Ab,Aa),Za.push(Object(Bb.a)(new be.a,{text:Pa,color:rb,backgroundColor:Lb})))}uz(Za,Pa,Ab=null){Za&&Za.length?(l.ULS.sendTraceTag(512349452,0,50,"FormulaHighlightsControl.HighlightRanges: number of ranges to highlight: "+Za.length),Za.reverse(),Ab.reverse(),this.gridView.ob.Ww(Za,[3],!0,(Aa,
rb)=>{if(Aa&&Aa.range&&rb){l.ULS.shipAssertTag(512349448,0,Pa.lb(Aa.range.toString()),`FormulaHighlightsControl.HighlightRanges: The range '${Aa.range.toString()}' doesn't exist in the range to color dictionary`);var Lb=this.eZ(Aa.range,Pa,.1),oc=this.eZ(Aa.range,Pa,1);this.$.frame&&this.$.frame.hD&&this.$.frame.hD.Aba||(rb.style.background=Lb);rb.style.borderColor=oc;Ab&&(rb.setAttribute(x.a.X5a,Aa.WT.toString()),Aa.metadata=Ab[Aa.WT])}else l.ULS.shipAssertTag(512349451,0,!!Aa,"FormulaHighlightsControl.HighlightRanges: state is null"),
l.ULS.shipAssertTag(512349450,0,!!Aa.range,"FormulaHighlightsControl.HighlightRanges: state.Range is null"),l.ULS.shipAssertTag(512349449,0,!!rb,"FormulaHighlightsControl.HighlightRanges: div is null")})):(Za=this.$.Jb.Bc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.ob.Pg([3]),this.gridView.ob.mSa(new me.a(null,this.Fja()),[3]),Za.stop())}gxc(Za,Pa,Ab){const Aa=Za.textBox;Aa.xF=!0;var rb=Aa.selection;const Lb=rb.index;rb=Lb+rb.length;Aa.setTextFromTextParts(Pa);Pa=Aa.text.length;Aa.selectRange(Math.min(Lb,
Pa),Math.min(rb,Pa));Ab&&Za.mQa(new fe.a);Aa.xF=!1}Qbc(){return this.gridView.Wq&&this.gridView.Wq.XF?this.gridView.Wq.XF:this.$.oa}Fja(){return this.Qbc().sheetId}}Object(d.a)(xc,"FormulaHighlightsControl",null,[617,10]);class jd{constructor(Za,Pa,Ab,Aa,rb,Lb,oc){this.$=Za;this.functionInfoManager=Pa;this.calcManager=Ab;this.pluginScheduler=Aa;this.formulaAssistanceUIControl=rb;this.formulaAssistanceTelemetryManager=Lb;this.Ug=oc;this.HSa=!0;this.tMa=this.isCellContentOnlyEqualDuringEdit=!1;this.Pxa=
null;this.LNa=-1;this.RV=0;this.xba=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6409372_isGroupwisePluginOperationsUsed");this.dAb=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NotifyActiveCellOnEditStarted",!1);this.Cbd=Na.EwaSettings.getBooleanFeatureGate("OfficeVSO:7135425_fixSetFunctionsInfoNotification",!1);this.Hh=($c,Fd)=>{this.gridView.eb||this.gridView.Fi||this.OOa(null===Fd||void 0===Fd?void 0:Fd.cell)};this.qh=($c,Fd)=>{this.OOa(null===Fd||void 0===Fd?void 0:Fd.bja)};this.onFunctionInfoLoaded=
()=>{this.Cbd||this.functionInfoManager.Lbb(this.onFunctionInfoLoaded);this.kfg();this.sda()};this.Avf=()=>{this.HSa=!1};this.Ivf=($c,Fd)=>{var Cd=this.Ya;$c=Cd.text;Cd=Cd.textBox.caretPosition;0<this.RV&&this.formulaAssistanceTelemetryManager.AJ.commitWhileRequestPending++;this.formulaAssistanceTelemetryManager.WD(["argumentAssistanceComputation","argumentAssistanceOverall"]);Fd.shouldRequestAutocompleteOnCommit?this.MYf($c,Cd):this.MLd($c,Cd)};this.Lf=()=>{this.m2&&(this.isCellContentOnlyEqualDuringEdit&&
(this.formulaAssistanceTelemetryManager.PM.isCellContentOnlyEqualDuringEditCounter++,this.isCellContentOnlyEqualDuringEdit=!1),this.tMa&&(this.formulaAssistanceTelemetryManager.PM.isCellContentFormulaCounter++,this.tMa=!1));this.HSa=!0;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&this.U6b()};this.d6=($c,Fd)=>{this.qNd(Fd.newValue)};this.Ej=()=>{this.feg()};this.feg=()=>{const $c=this.o6b.dIe;this.pluginScheduler.notifier().setDefinedNamesInfo($c);l.ULS.sendTraceTag(512278605,
0,50,`FormulaAssistanceManager.updateDefinedNamesList updated defined names info with ${null===$c||void 0===$c?void 0:$c.length} names}`)};this.r4a=($c,Fd)=>{$c=this.pluginScheduler.syncRequester().formulaHighlighting({content:$c,caretPosition:null===Fd||void 0===Fd?void 0:Fd.index,selectionLength:null===Fd||void 0===Fd?void 0:Fd.length});if(isNullOrUndefined($c)||isNullOrUndefined($c.formulaHighlights))l.ULS.sendTraceTag(521211933,0,10,`FormulaAssistanceManager.getFormulaHighlights: formulaHighlightingResult is null or undefined, formulaHighlights array is null:${!isNullOrUndefined($c)}`);
else return $c};this.functionInfoManager=Pa;this.formulaAssistanceUIControl=rb;this.pluginScheduler=Aa;this.gridView=A.g(this.$);this.xgf=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.I4=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.ozd=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.m2=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6352308_addTelemetryAtFormulaAssistance");
this.JYc=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6488306_BlockFormulasuggestionInPivotTable");this.Xhi=Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6646054_FixNoPreviewBugEnabled");this.xgf&&(this.o6b=new fb(Za),this.gridView.Ea.Wv(this.Ej),this.feg());this.gqa=new ub(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.D8=new Ec(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.sii=D.a.iV(Za);this.wxa=D.a.wxa(Za);this.kV=D.a.kV(Za);
this.sii&&(this.hqa=new xc(this.$,this.pluginScheduler,this.formulaAssistanceTelemetryManager));Za.da.Ga(464,this);this.calcManager=Ab;D.a.jV()&&this.qmd();this.m2&&this.gridView.hc.lm(this.Lf);this.I4&&(this.m2||this.gridView.hc.lm(this.Lf),this.gqa.XFg(this.Avf));this.Ynd=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConvertToSheetGridCell",!1);this.Cbd&&(this.functionInfoManager.XFa(this.onFunctionInfoLoaded),this.functionInfoManager.lV?this.kfg():this.functionInfoManager.eJa({}))}get eja(){return this.D8}get OVe(){return this.gqa}get nz(){return this.hqa}get rab(){return this.Ya.lli?
1:0}get Ya(){return this.gridView.Li}get Fb(){return this.gridView.Fb}dispose(){if(this.$){const Za=this.gridView;Za&&(Za.ha&&D.a.jV()&&(this.dAb?Za.hc.Ak(this.qh):Za.ha.Sma(this.Hh)),this.xgf&&Za.Ea&&Za.Ea.Rw(this.Ej))}this.m2&&this.gridView.hc.Fl(this.Lf);this.I4&&(this.m2||this.gridView.hc.Fl(this.Lf),this.gqa.kbj(this.Avf));this.D8.Yaj(this.Ivf);this.functionInfoManager&&this.functionInfoManager.Lbb(this.onFunctionInfoLoaded);D.a.Mfc&&this.Ya&&this.Ya.SIb(this.d6);O.a.Ia(this.gqa);O.a.Ia(this.D8);
this.D8=this.gqa=this.functionInfoManager=this.$=null}Wfj(){this.LNa=-1;this.Pxa=null}U6b(){this.D8.visible=!1;this.gqa.visible=!1}Yh(){this.sda();return!1}sda(){if(!this.Ya.rI)if(this.formulaAssistanceTelemetryManager.Pob.formulaAssistanceRequestAttemptedCounter++,this.Kxj()){this.Cbd||this.functionInfoManager.lV||(this.functionInfoManager.XFa(this.onFunctionInfoLoaded),this.functionInfoManager.eJa({}));var Za=this.Ya,Pa=Za.text;Za=Za.textBox.caretPosition;this.m2&&Pa.startsWith("=")&&(this.tMa=
!0,1===Pa.length&&(this.isCellContentOnlyEqualDuringEdit=!0));!this.I4||this.HSa?(this.formulaAssistanceTelemetryManager.WD("argumentAssistanceComputation autoCompleteComputation argumentAssistanceOverall autoCompleteOverall autoCompleteOverallSmartOnly autoCompleteOverallSimpleOnly autoCompleteOverallSimpleAndSmart".split(" ")),this.MYf(Pa,Za)):(this.formulaAssistanceTelemetryManager.WD(["autoCompleteComputation","autoCompleteOverall"]),this.Ffj(Pa,Za));Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutoCompleteWrapperPluginRequest",
!1)&&this.Efj(Pa,Za)}else this.formulaAssistanceTelemetryManager.Pob.formulaAssistanceRequestOptimizedCounter++}MYf(Za,Pa){Pa=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:Za,caretPosition:Pa},argumentAssistance:{content:Za,caretPosition:Pa}});this.RV+=1;Pa.then(Ab=>{--this.RV;0===Ab.kind&&(this.d6e(Ab.payload.argumentAssistance),this.L6e(Ab.payload.functionSuggestion,Za));return null})}Ffj(Za,Pa){Pa={content:Za,caretPosition:Pa};Pa=this.xba?
this.pluginScheduler.getRequester().functionSuggestion(Pa,this.rab):this.pluginScheduler.requester().functionSuggestion(Pa);this.RV+=1;Pa.then(Ab=>{--this.RV;0===Ab.kind&&this.L6e(Ab.payload,Za);return null})}Efj(Za,Pa){Pa={content:Za,caretPosition:Pa,enableAutocompleteWrapperPlugin:this.wxa&&!this.kV&&"="===Za};this.xba&&(Pa=this.pluginScheduler.getRequester().runPerCharacterExperiment(Pa,this.rab),this.RV+=1,Pa.then(Ab=>{--this.RV;if(0===Ab.kind)for(const Aa of Ab.payload.results)0===Aa.kind&&this.gridView.baa.fQd(Aa.value,
Za);return null}))}MLd(Za,Pa){Za={content:Za,caretPosition:Pa};Za=this.xba?this.pluginScheduler.getRequester().argumentAssistance(Za,this.rab):this.pluginScheduler.requester().argumentAssistance(Za);this.RV+=1;Za.then(Ab=>{--this.RV;0===Ab.kind&&this.d6e(Ab.payload)})}Kxj(){var Za=this.Ya;const Pa=Za.text;Za=Za.textBox.caretPosition;if(this.D8.visible&&gb.a.equals(Pa,this.Pxa,!0)&&(!this.Xhi||!yb.e(Pa))&&Za===this.LNa)return!1;this.Pxa=Pa;this.LNa=Za;return!0}vNd(){this.xba?this.pluginScheduler.getRequester().runExperiment(new uc,
this.rab):this.pluginScheduler.requester().runExperiment(new uc)}d6e(Za){Za&&this.Ya.eb?(this.formulaAssistanceTelemetryManager.aD(["argumentAssistanceComputation"]),this.gqa.show(Za,this.Ya.textBox.domElement)):this.gqa.dismiss()}L6e(Za,Pa){Za&&0<Za.items.length&&this.Ya.eb&&this.Ya.text===this.Pxa?this.JYc&&this.Fb.e5(this.gridView.ha.sa.activeCell)?(this.formulaAssistanceTelemetryManager.PM.smartSuggestionWouldSuggestInsidePivotCounter++,this.D8.dismiss()):(this.formulaAssistanceTelemetryManager.aD(["autoCompleteComputation"]),
this.D8.show(Za)):this.D8.dismiss();this.wxa&&this.gridView.baa.fQd(Za,Pa)}qNd(Za){Za={content:Za,isCellContentOnlyEqualDuringEdit:this.isCellContentOnlyEqualDuringEdit};this.xba?this.pluginScheduler.getRequester().runAuthoringExperiment(Za,this.rab):this.pluginScheduler.requester().runAuthoringExperiment(Za)}OOa(Za){var Pa;const Ab=this.gridView.ha.sa.activeCell;if(Ab){var Aa=this.calcManager.lta(Ab,!this.Ynd);if(Aa){var rb=this.$.xa,Lb=Aa.sheet.index;0>=rb.count||0>Lb||Lb>=rb.count?l.ULS.sendTraceTag(512278608,
0,50,"FormulaAssistanceManager.NotifyActiveCellChanged invalid sheet index"):(Lb=rb=null,this.ozd&&void 0!==this.calcManager&&null!==this.calcManager&&(Za=null!==(Pa=null===Za||void 0===Za?void 0:Za.cell)&&void 0!==Pa?Pa:this.gridView.Ea.es(Ab))&&(Pa=this.calcManager.Lbc(Za.Nk),void 0!==Pa&&null!==Pa&&(rb=Pa.FormatString,Lb=Pa.Builtin)),this.pluginScheduler.notifier().setActiveCell({colIndex:Aa.range.col,rowIndex:Aa.range.row,sheetIndex:this.$.xa.getItem(Aa.sheet.index).sheetId,docName:Aa.sheet.document.name,
docPath:Aa.sheet.document.path,formatString:rb,builtIn:Lb}),l.ULS.sendTraceTag(512278607,0,50,`FormulaAssistanceManager.NotifyActiveCellChanged sent notification to the scheduler. col: ${Aa.range.col}, row: ${Aa.range.row}, format: ${rb}`))}else l.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}else l.ULS.sendTraceTag(512278609,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged activeCell range is null")}kfg(){const Za=this.functionInfoManager.P$b;
this.pluginScheduler.notifier().setFunctionsInfo(Za);l.ULS.sendTraceTag(512278606,0,50,`FormulaAssistanceManager.updateSchedulerFunctionList update functions info with ${null===Za||void 0===Za?void 0:Za.length} functions}`)}qmd(){this.dAb?this.gridView.hc.Vk(this.qh):this.gridView.ha.Lga(this.Hh);const Za=D.a.Syb()?this.gridView.Vb(null):void 0;this.OOa(Za);D.a.Mfc&&this.Ya.cZa(this.d6);this.vNd();this.D8.LFg(this.Ivf);this.pluginScheduler.setServerDataProvider(new Kd(this.Ug,this.$));this.sda()}ofb(Za,
Pa,Ab){Ab=Object(ed.b)(Pa)?this.r4a(Pa,Object(ed.b)(Ab)?Ab:re.a):this.r4a(Za.text,Za.textBox.selection);return this.hqa.nOj(Za,Pa,Ab)}}Object(d.a)(jd,"FormulaAssistanceManager",null,[598,10]);a(184);class Nd extends ab.a{constructor(Za){super();this.$=Za;this.Eb()}create(){const Za=D.a.jV(),Pa=Na.EwaSettings.ma(373),Ab=Na.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1),Aa=D.a.hV(this.$),rb=this.$.da,Lb=e.GetServiceTaskFactory.create(rb,134,this.la,this.fb),oc=
e.GetServiceTaskFactory.Sa(this.$.da,12,477,this.fb);let $c;$c=D.a.J4()?e.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):R.Task.Ta(null);let Fd;Fd=D.a.jV()?e.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):R.Task.Ta(null);if(Ab||Za){const Cd=e.GetServiceTaskFactory.Sa(rb,266,265,this.fb),$d=e.GetServiceTaskFactory.Sa(rb,219,220,this.fb),he=e.GetServiceTaskFactory.Sa(rb,491,492,this.fb);k.TaskExtensions.Aa(k.TaskExtensions.Td([Cd,Fd,$c,$d,he],this.la),()=>{const ue=rb.za(19)||new od(this.$,
Fd.result),Me=$d.result;if(Aa){var ff=rb.za(464);ff||(ff=new jd(this.$,ue,Cd.result,Fd.result,$c.result,he.result,oc.result.Y3c(this.$,Lb.result)),Me.PXc(ff.OVe),Me.QXc(ff.eja),Na.EwaSettings.isChangeGateEnabled("OfficeVSO:6312266_RedesignListBoxEvents")&&Me.RXc(ff.eja))}else ff=rb.za(221),ff||(ff=new Sc(this.$,ue,Lb.result,Cd.result,null,oc.result,$c.result,he.result,Fd.result),Me.PXc(ff.PVe),Me.RXc(ff.mWe),Me.QXc(ff)),Pa&&(rb.za(317)||new Ma(this.$));this.pb(ue)},this.la,3)}else{const Cd=e.GetServiceTaskFactory.Sa(rb,
219,220,this.fb),$d=e.GetServiceTaskFactory.Sa(rb,491,492,this.fb);k.TaskExtensions.Aa(k.TaskExtensions.Td([Cd,$c,Fd],this.la),()=>{const he=rb.za(19)||new od(this.$,Fd.result),ue=Cd.result;let Me=rb.za(221);Me||(Me=new Sc(this.$,he,Lb.result,null,null,oc.result,$c.result,$d.result,Fd.result),ue.PXc(Me.PVe),ue.RXc(Me.mWe),ue.QXc(Me));Pa&&(rb.za(317)||new Ma(this.$));this.pb(he)},this.la,3)}}static ka(Za){Za.da.Ga(153,new Nd(Za))}}Object(d.a)(Nd,"FunctionInfoManagerFactory",ab.a,[]);a.d(C,"a",function(){return Ld});
const Ld=()=>{b.a.Fa(Za=>{sa.ka(Za);nb.ka(Za);Nd.ka(Za)})}},1135:function(n,C,a){var c=a(0),b=a(694),d=a(148),f=a(7),e=a(15),k=a(83),l=a(4),m=a(155),u=a(1072),t=a(1070),w=a(717),r=a(5),v=a(461),y=a(563),x=a(77),B=a(58),z=a(908),A=a(132),I=a(43),F=a(515),U=a(171),X=a(61),T=a(50),G=a(750),D=a(145),J=a(37),L=a(116),H=a(209),R=a(90),Q=a(71),O=a(35),V=a(29),W=a(282),da=a(1),ta=a(183),K=a(14),na=a(63),P=a(281),ka=a(21),pa=a(133),Na=a(772),Z=a(773),Ra=a(125),Da=a(112),Ba=a(51),ea=a(34),Y=a(420);class ja{constructor(){this.Sections=
this.Id=null}}Object(c.a)(ja,"AutoFilterMenu",null,[]);class ca{constructor(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}}Object(c.a)(ca,"MenuItem",null,[]);class ba{constructor(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}}Object(c.a)(ba,"MenuSection",null,[]);class ua{constructor(){this.isSuccess=!1}}Object(c.a)(ua,"ApplyFilterByValueResponse",null,[]);
class wa{constructor(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}}Object(c.a)(wa,"FilterByValueItem",null,[]);class ia{constructor(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}}Object(c.a)(ia,"GetColorsAndIconsResponse",null,[]);class xa{constructor(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}}Object(c.a)(xa,
"GetFilterByValueItemsResponse",null,[]);class gb{constructor(){this.autoFilterMenu=this.targetPoint=null}}Object(c.a)(gb,"ShowSortFilterMenuParams",null,[]);class va{constructor(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}}Object(c.a)(va,"SortFilterControllerFactoryParams",null,[]);class sa{constructor(){this.top=this.left=0}}Object(c.a)(sa,"TargetPoint",null,[]);var ab=a(55),Ua=a(184),
nb=a(33),Ha=a(161),sb=a(226),Qb=a(8);const mb=r.a.l3g;class Pb extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateAutoFilterContextMenu",1675506831,1651433993,mb,!0,!1,"AutoFilterContextMenuRoot",rb,Lb,!1,oc);this.cXc=this.bUa=this.sheetName=this.Urb=null;this.f3a=this.Jmf=!1;this.g5c=this.eab=this.VGe=this.PPa=this.Pbc=this.N$c=this.bNb=this.WGb=null;this.EV=()=>{this.Yyc();this.$.ea.fo(this.EV)};this.qLi=$c=>{this.f3a||pa.b(this.$).Hd(A.a.hzf,this.sm(),void 0,!0);var Fd={};this.$.gk(Fd);var Cd=
this.$.ea.isNamedObjectViewMode;const $d=B.a.$h(this.cXc);$d.SheetName=Cd?Fd.NamedObjectName:Fd.SheetName;$d.NamedObjectView=Cd;Cd=!!$c.searchText;Fd=586;this.f3a&&(Cd&&($d.ItemListOptions=this.a6g($c.searchText),Fd=597),pa.b(this.$).Hd(A.a.hzf,{["UserOperation"]:Fd.toString()},void 0,!0));const he=this.qBd(Cd),ue=this.rLi(),Me=this.$.pa.va.Tb();$c=(ff,Ve,Ze)=>this.g5c=X.n(this.$.pa.va,$d,P.b(ff,he),this.f3a?P.a(Ve,ue):Ve,Ze,null,Me);this.VGe=Me.RequestId;this.f3a&&this.Pbc&&!this.Pbc.dequeueUtcTime&&
(this.$.userOperationManager.Rta(this.Pbc),this.$Vg());$c=da.EwaSettings.$b()?new U.a(Fd,0,$c,80):new F.a(Fd,0,$c,16);this.Pbc=this.$.userOperationManager.Wb($c,null);this.eab=this.g5c;this.PPa=this.VGe};this.onMenuItemClick=($c,Fd,Cd)=>{pa.b(this.$).Hd(A.a.nQi,this.sm(),void 0,!0);Fd={["CommandValueId"]:Fd,["MenuItemId"]:Fd,["InputMethod"]:Cd,["TopCellAddress"]:this.bUa};const $d=new R.a($c,Cd,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb($d,Fd);e.ULS.sendTraceTag(537167131,0,50,`AutoFilterContextMenu::OnMenuItemClick ${$c}, ${Cd}`)};
this.nGi=$c=>{if($c.checkedItems&&$c.checkedItems.length){pa.b(this.$).Hd(A.a.yvf,this.sm(),void 0,!0);var Fd=B.a.$h(this.cXc),Cd={};this.$.gk(Cd);Cd.FirstRow=0;Cd.FirstColumn=Fd.Column;var $d=this.$.ea.isNamedObjectViewMode;Fd.NamedObjectView=$d;Fd.SheetName=$d?Cd.NamedObjectName:Cd.SheetName;var he=ff=>{if(Na.a.Yxc(ff)){const Ve=Na.a.nac(ff);this.XMa?Na.a.bRa(Z.a.applyItemFilter,Ve.MessageIdName,Da.a.tsa,!0,Na.a.isSessionEndingError(Ve.MessageId)):e.ULS.sendTraceTag(537167129,0,10,`AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -${Ve.MessageIdName}`)}W.a(ff)||
(e.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),pa.b(this.$).Hd(A.a.bzf,this.sm(),void 0,!0),ff=Object(f.a)(new ua,{isSuccess:!0}),this.bNb.onApplyFilterByValueFinish(ff),this.oS(this.bUa))},ue=this.M3c(Fd,Cd),Me=new U.a(208,0,(ff,Ve,Ze)=>X.a(this.$.pa.va,ue,$c.checkedItems,P.b(ff,he),Ve,Ze,null,null),6,()=>new z.a($c.checkedItems,ue));this.OAj(()=>{this.$.userOperationManager.Wb(Me,null)})}else e.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};
this.fMg=$c=>{const Fd=I.o(this.bUa,this.$),Cd=I.v(this.bUa,this.$);var $d=Object(f.a)(new u.a,{SortConditionType:$c.type,RowColOffset:Fd.FirstColumn-Cd.FirstColumn,SortColor:$c.color,SortIconSet:$c.icon.IconSet,SortIcon:$c.icon.Icon,IsAscending:!0});$d=Object(f.a)(new t.a,{OperationType:1,ActiveCell:Fd,SelectedRange:Cd,SortConditions:[$d],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1});const he={};he.SortOptions=$d;he.SelectedRange=Cd;he.OriginalActiveCell=Fd;he.ShouldRestoreSelection=!1;
he.ShouldPromptNamedSheetViewTeachingDialog=!0;e.ULS.sendTraceTag(537167119,0,50,`AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: ${$c.type}`);this.$.fd(-1089513346,x.a.Gb,19,{["CustomSortCommandData"]:he})};this.XMa=Na.a.pnd();this.vz=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")}get Lw(){return"PopulateAutoFilterContextMenu"}get HB(){return r.a.gNf}executeCommand(Aa,rb,Lb){Aa=rb.command;switch(Aa){case 1701016594:return w.a.Uxh(Lb),ab.Task.Ta(!0);case 966232027:if(da.EwaSettings.ll()){const oc=
new m.a;J.TaskExtensions.Aa(T.GetServiceTaskFactory.Sa(this.$.da,8,9,0),$c=>{this.t7e(rb,Lb,$c.result);oc.setResult(!0)},this.la,3).continueWith(()=>{oc.setResult(!1)},5,this.la,sb.a.instance);return oc.task}this.t7e(rb,Lb);return ab.Task.Ta(!0);default:return ta.a(Aa)}}t7e(Aa,rb,Lb){const oc=rb.domEvent;if(Q.e(oc.rawEvent)&&(Q.g(oc),oc.target)){var $c=new D.a(this.$.xa);if($c.Wd(4096)||$c.Wd(2048)){var Fd=B.a.$h(rb[x.a.kg]);this.D3f(Fd)&&(this.Jmf?this.Ktc(oc,oc.target,Fd,Aa,Lb):(this.WGb=()=>{this.D3f(Fd)&&
(this.Abi(),this.Ktc(oc,oc.target,Fd,Aa,Lb),this.f3a=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),this.Jmf=!0)},this.Yyc()))}}}Ac(Aa,rb,Lb){if(Aa=!!Lb)switch(rb.command){case 1701016594:case 966232027:da.EwaSettings.ll()||v.a(this.$)||(Aa=!1,rb=Ba.b().ij(rb.command),e.ULS.sendTraceTag(537167137,0,15,`AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was ${rb}`));break;default:Aa=!1}return Aa}QEd(Aa){Aa.MenuSectionList.push(...this.Urb)}Abi(){Y.a(()=>
{this.bNb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object(f.a)(new va,{getFilterByValueItemsRequest:this.qLi,applyFilterByValueRequest:this.nGi,onMenuItemClick:this.onMenuItemClick,autoFilterMenuWidth:Pb.jue,applySortByColorOrIconRequest:this.fMg}))});this.N$c=k.a.instance.yh("Common.IExternalUICommandDefinitionMapping")||new y.a(this.$.Cb,this.$)}Ktc(Aa,rb,Lb,oc,$c){pa.b(this.$).Hd(A.a.Ktc,this.sm(),void 0,!0);if(Lb){Aa=this.mJh(Lb,$c);oc=Sys.UI.DomElement.getBounds(rb);
rb=oc.x+oc.width;oc=oc.y;if(this.vz&&!Lb.IsHeaderSnapped){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.Wnd(this.$,Lb.Cell))return;Lb=w.a.ded(this.$,Lb.Cell,!0);rb=Lb.x;oc=Lb.y}Lb=ka.g(this.$).rtl?new Sys.UI.Point(rb-ea.a(this.$).nGa(Pb.jue),oc):new Sys.UI.Point(rb,oc);Lb=ea.a(this.$).Ija(Lb);Lb=Object(f.a)(new gb,{targetPoint:Object(f.a)(new sa,{left:Lb.x,top:Lb.y}),autoFilterMenu:Aa});this.bNb.showSortFilterMenu(Lb);this.$.fd(-544117314,-1,0,null)}else e.ULS.shipAssertTag(537167135,
0,!!Lb,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.")}D3f(Aa){return(null===Aa||void 0===Aa?0:Aa.Cell.SheetName)?ka.g(this.$).b5?Aa.Cell.SheetName===this.$.oa.name:Aa.Cell.SheetName===this.$.oa.sheetName:!0}mJh(Aa,rb){return(Aa=this.nJh(Aa,rb))?this.PKf(Aa):null}PKf(Aa){const rb=[];for(const Lb of Aa.Sections){if(Object(Ha.f)(this.$)&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&Lb.Title===K.a.instance.ga(1949))continue;const oc=this.i1i(Lb);
rb.push(oc)}return Object(f.a)(new ja,{Id:Aa.Id,Sections:rb})}i1i(Aa){const rb=[];for(const Lb of Aa.MenuItems)if(2===Lb.Identifier)this.cXc=Lb.CommandData;else switch(Lb.Type){case 3:case 2:rb.push(this.g1i(Lb,2===Lb.Type));break;case 1:rb.push(this.h1i(Lb))}return Object(f.a)(new ba,{MenuItems:rb,DisplayType:Aa.DisplayType,Id:this.IGh(Aa)})}h1i(Aa){({label:$c,QLa:oc}=this.UWe(Aa));const rb=this.PKf(Aa.SubMenu),Lb=this.KWe(Aa);var oc=this.N$c.dbc(oc);var $c=$c||Aa.Label;return Object(f.a)(new ca,
{Disabled:Aa.Disabled,Type:Aa.Type,Identifier:Aa.Identifier,Id:Lb,CommandData:Aa.CommandData,Label:$c,SubMenu:rb,IsChecked:Aa.IsChecked,IconName:"MissingIcon_20"===oc?null:oc})}g1i(Aa,rb){let Lb;({label:rb,QLa:$c,Fr:Lb}=this.W$b(Aa,rb&&Aa.IsChecked));const oc=this.Ycd(Aa,rb);var $c=this.N$c.dbc($c);return Object(f.a)(new ca,{Disabled:Aa.Disabled,Type:Aa.Type,Identifier:Aa.Identifier,Id:oc,RibbonCommand:Lb,CommandData:Aa.CommandData,Label:rb||Aa.Label,SubMenu:null,IsChecked:Aa.IsChecked,IconName:"MissingIcon_20"===
$c?null:$c})}nJh(Aa,rb){var Lb;this.bUa=Lb=I.C(Aa.Cell);this.sheetName=this.$.oa.sheetName;rb=rb||v.a(this.$);if(Aa.IsHeaderSnapped)Lb=rb.M9b.AQh(Lb);else{rb=ka.g(this.$).Ea.JKa(Lb);if(!rb)return this.XMa?Na.a.bRa(Z.a.iNf,Ra.a.L1h,Da.a.m_a,!0,!1):(Aa=ka.g(this.$).view.visibleArea,e.ULS.sendTraceTag(537167134,0,10,`AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested ${Lb}, visible range: ${Aa}`)),null;Lb=rb.autoFilterMenu}if(!Lb)return this.XMa?
Na.a.bRa(Z.a.iNf,Ra.a.uAi,Da.a.m_a,!0,!1):e.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.Jsb=Aa.Cell.FirstRow+"_"+Aa.Cell.FirstColumn;return Lb}Yyc(){if(this.$.ea.Hg){const Aa=T.GetServiceTaskFactory.Sa(this.$.da,283,284,1);J.TaskExtensions.Aa(Aa,()=>{this.XMa?Aa.result.ko.loadScript("sortFilter").then(()=>{this.WGb()},rb=>{na.a.Bk(rb,"AutoFilterContextMenu.SortFilterScriptLoad");
Na.a.bRa(Z.a.Yyc,Ra.a.CDj,Da.a.m_a,!1,!1)}):J.TaskExtensions.Aa(Ua.c(Aa.result.ko.loadScript("sortFilter")),()=>{this.WGb()},this.$.la,3)},this.$.la,3)}else this.$.ea.Ll(this.EV)}a6g(Aa){const rb={};rb.SearchText=Aa;rb.Page=1;rb.DateNodeType=-1;return rb}$Vg(){this.PPa&&(e.ULS.sendTraceTag(537167132,0,15,`AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID=${this.PPa}`),X.h(this.$.pa.va,this.PPa,null,null,null),this.PPa=null);this.eab&&
(l.AFrameworkApplication.yd.Du(this.eab.Yt),this.eab=null)}qBd(Aa){return rb=>{this.eab=this.PPa=null;if(Na.a.Yxc(rb)){var Lb=Na.a.nac(rb);this.XMa?Na.a.bRa(Aa?Z.a.searchAutoFilterItemList:Z.a.getAutoFilterItemList,Lb.MessageIdName,Da.a.m_a,!0,!0):e.ULS.sendTraceTag(537167127,0,10,`AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -${Lb.MessageIdName}`)}if(!W.a(rb)){e.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");
rb=rb.Result;Lb=new O.a(!0);const oc=rb.AutoFilterDateNodes?!0:!1;rb.AutoFilterItems&&Lb.add("AutoFilterItemsCount",rb.AutoFilterItems.length);oc&&Lb.add("AutoFilterDateItemsCount",rb.AutoFilterDateNodes.length);Lb.add("Location","contextMenu");pa.b(this.$).Hd(A.a.qBd,Lb.qu,void 0,!0);Lb=this.f3a?Object(f.a)(new xa,{filterByValueItems:this.nDe(rb),hasMoreRecords:rb.ItemListMaxExceeded,searchText:rb.SearchText}):Object(f.a)(new xa,{filterByValueItems:this.nDe(rb),hasMoreRecords:rb.ItemListMaxExceeded});
this.bNb.onGetFilterByValueItemsFinish(Lb);Aa||(e.ULS.shipAssertTag(529063959,0,null!==rb.FontColors&&null!==rb.CellColors&&null!==rb.Icons&&null!==rb.SelectedSortFontColors&&null!==rb.SelectedSortCellColors&&null!==rb.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),rb=Object(f.a)(new ia,{fontColors:rb.FontColors,cellColors:rb.CellColors,icons:rb.Icons,selectedSortFontColor:0<rb.SelectedSortFontColors.length?rb.SelectedSortFontColors[0]:
null,selectedSortCellColor:0<rb.SelectedSortCellColors.length?rb.SelectedSortCellColors[0]:null,selectedSortIcon:0<rb.SelectedSortIcons.length?rb.SelectedSortIcons[0]:null,getColorName:this.getColorName}),this.bNb.onGetColorsAndIconsFinish(rb))}}}rLi(){return Aa=>{this.eab=this.PPa=null;Aa=L.a.ff(Aa.data);Aa=V.a.xc(Aa);e.ULS.sendTraceTag(537167125,0,10,`AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [${Aa}].`)}}nDe(Aa){const rb=this.N3g(Aa),Lb=this.U3g(Aa.AutoFilterItems),oc=
[],$c=[];let Fd=0,Cd=0;Aa.HasBlanks&&(Aa=Pb.Z3c(K.a.instance.ga(787),Aa.IsBlanksSelected?1:0,r.a.iue),oc[Fd++]=Aa);for(const $d of rb)oc[Fd++]=$d;if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6892133_ErrorsOnTop_FilterMenu_Fix"))for(const $d of Lb)-1!==Array.indexOf(Qb.a.q9c,$d.displayText)?$c[Cd++]=$d:oc[Fd++]=$d;else for(const $d of Lb)oc[Fd++]=$d;return Array.prototype.concat($c,oc)}N3g(Aa){const rb=[];if(!Aa.AutoFilterDateNodes||!Aa.AutoFilterDateNodes.length)return rb;const Lb=[this.x4a(Aa.YearKeys,
Aa.YearValues),this.x4a(Aa.MonthKeys,Aa.MonthValues),this.x4a(Aa.DayKeys,Aa.DayValues),this.x4a(Aa.HourKeys,Aa.HourValues),this.x4a(Aa.MinuteKeys,Aa.MinuteValues),this.x4a(Aa.SecondKeys,Aa.SecondValues)];let oc=!1,$c=!1,Fd=0;var Cd=null;const $d=Array(6);var he=null;for(const ue of Aa.AutoFilterDateNodes){$d[0]&&(he.Year!==ue.Year?(oc=!0,Fd=0,Cd=null):he.Month!==ue.Month?($c=!0,Fd=1,Cd=$d[0]):he.Day!==ue.Day?(Fd=2,Cd=$d[1]):Aa.ShowTime&&(he.Hour!==ue.Hour?(Fd=3,Cd=$d[2]):he.Minute!==ue.Minute?(Fd=
4,Cd=$d[3]):(Fd=5,Cd=$d[4])));for(;6>Fd;){let Me;switch(Fd){case 0:Me=ue.Year;he=Lb[0].getItem(Me.toString());break;case 1:Me=ue.Month;he=Lb[1].getItem(Me.toString());break;case 2:Me=ue.Day;he=Lb[2].getItem(Me.toString());break;case 3:Me=ue.Hour;he=Lb[3].getItem(Me.toString());break;case 4:Me=ue.Minute;he=Lb[4].getItem(Me.toString());break;case 5:Me=ue.Second;he=Lb[5].getItem(Me.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}he=Pb.Z3c(he,-1!==ue.NodeType&&
Fd>=ue.NodeType?1:0,Cd?Cd.key+";"+Me:r.a.cYc+Me,!1,[]);Cd=Cd?Cd.children:rb;Cd=Cd[Cd.length]=he;$d[Fd]=he;switch(Fd){case 5:Fd=6;break;case 2:Fd=Aa.ShowTime?Fd+1:6;break;default:Fd++}}he=ue}oc||($d[0].expanded=!0,$c||($d[1].expanded=!0));return rb}U3g(Aa){const rb=[];if(!Aa)return rb;let Lb=0;for(const oc of Aa)rb[Lb++]=Pb.Z3c(oc.DisplayString,oc.Selected?1:0,r.a.dYc+oc.DisplayString);return rb}x4a(Aa,rb){const Lb=new O.a(!0);if(!Aa||!rb)return Lb;const oc=Aa.length<rb.length?Aa.length:rb.length;
for(let $c=0;$c<oc;$c++)Lb.add(Aa[$c].toString(),rb[$c]);return Lb}M3c(Aa,rb){const Lb={};Lb.Location=rb;Lb.FieldId=Aa.Id.toString();Lb.DataSourceIndex=-1;Lb.FilterType=Aa.AutoFilterType;Lb.AnchorType=0;Lb.ChartId=null;Lb.AnchorValue1=-1;Lb.AnchorValue2=-1;Lb.Property=Aa.RichProperty;return Lb}oS(Aa){nb.a.Mka(this.$)&&J.TaskExtensions.Aa(T.GetServiceTaskFactory.Sa(this.$.da,430,431,1),rb=>{rb.result.sea(Aa);e.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}getColorName(Aa){return G.a.HKa(H.a.tH(Aa))}OAj(Aa){J.TaskExtensions.Aa(T.GetServiceTaskFactory.Sa(this.$.da,309,310,3),rb=>{rb.result.VSa().continueWith(Lb=>{Lb.result&&Aa()})},this.$.la,3)}static Z3c(Aa=null,rb=0,Lb=null,oc=!1,$c=null){return Object(f.a)(new wa,{displayText:Aa?w.a.ki(Aa):Aa,state:rb,key:Lb,parent:null,children:$c,indentationLevel:0,expanded:oc})}}Pb.jue=268;Object(c.a)(Pb,"AutoFilterContextMenu",w.a,[]);var gc=a(725),Xb=a(82),
Ca=a(187),ra=a(67),ma=a(19);class hb{}hb.HTe=26;hb.Tad=[230,231,0,99,0,95,94];Object(c.a)(hb,"Constants",null,[]);class vb{constructor(Aa,rb,Lb,oc){this.aug=Aa;this.Nog=rb;this.Rog=Lb;this.oyg=oc}get Pji(){return 3===this.f5b}get Bni(){return 4===this.f5b&&!!this.subMenu}get subMenu(){return this.oyg}get wrf(){return this.aug}get f5b(){return this.Nog}get w5c(){return this.Rog}}Object(c.a)(vb,"FiltersMenuData",null,[]);class Va extends vb{constructor(Aa,rb){super(Aa,2,0,null);this.kue=rb}}Object(c.a)(Va,
"AutoFilterFiltersMenuData",vb,[]);class db{}db.DIj=[new vb(100,2,0,null),new vb(101,2,1,null),new vb(0,3,0,null),new vb(172,2,2,null),new vb(174,2,4,null),new vb(0,3,0,null),new vb(176,2,6,null),new vb(177,2,7,null),new vb(0,3,0,null),new vb(108,0,0,null)];db.TEi=[new vb(100,2,0,null),new vb(101,2,1,null),new vb(0,3,0,null),new vb(102,2,8,null),new vb(103,2,10,null),new vb(104,2,12,null),new vb(0,3,0,null),new vb(105,1,0,null),new Va(106,1),new Va(107,2),new vb(0,3,0,null),new vb(108,0,0,null)];
db.Pch=[new vb(100,2,0,null),new vb(0,3,0,null),new vb(112,2,10,null),new vb(113,2,8,null),new vb(104,2,12,null),new vb(0,3,0,null),new Va(110,8),new Va(109,9),new Va(111,10),new vb(0,3,0,null),new Va(115,11),new Va(114,12),new Va(116,13),new vb(0,3,0,null),new Va(117,14),new Va(118,15),new Va(119,16),new vb(0,3,0,null),new Va(120,17),new Va(121,18),new Va(122,19),new vb(0,3,0,null),new Va(123,20),new Va(124,21),new Va(125,22),new vb(0,3,0,null),new Va(126,23),new vb(127,2,12,[new Va(128,24),new Va(129,
25),new Va(130,26),new Va(131,27),new vb(0,3,0,null),new Va(132,28),new Va(133,29),new Va(134,30),new Va(135,31),new Va(136,32),new Va(137,33),new Va(138,34),new Va(139,35),new Va(140,36),new Va(141,37),new Va(142,38),new Va(143,39)]),new vb(0,3,0,null),new vb(108,0,0,null)];Object(c.a)(db,"Constants",null,[]);var oa=a(909),Oa=a(79);class Wa extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,Wa.Hzh,!0,!1,Wa.YJb,rb,Lb,!1,oc);this.om=null}get Lw(){return"PopulateAutoFilterFieldListContextMenu"}get HB(){return r.a.hNf}executeCommand(Aa,
rb,Lb){Aa=rb.command;switch(Aa){case -699941697:this.applyAutoFilterFieldList(rb,Lb);break;case 216058793:break;case -1494291901:break;default:return ta.a(Aa)}return ab.Task.Ta(!0)}Vdd(Aa,rb){return!Aa||Aa.length<=rb?(e.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(Aa[rb],10)}vGd(Aa,rb,Lb,oc,$c,Fd){const Cd=this.Vdd($c,Fd);0>Cd&&e.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(hb.Tad[Cd]){case 99:Aa=new R.a(-2058042992,rb.method,rb.mode,rb.Re,rb.tabName);this.om.aH.Stb(this.$,oc,0,Aa);break;case 230:Aa=new R.a(504133448,rb.method,rb.mode,rb.Re,rb.tabName);this.om.aH.Stb(this.$,oc,0,Aa);break;case 231:Aa=new R.a(-798968736,rb.method,rb.mode,rb.Re,rb.tabName);this.om.aH.Stb(this.$,oc,0,Aa);break;case 235:Aa=new R.a(-1677817820,rb.method,rb.mode,rb.Re,rb.tabName);this.om.aH.Stb(this.$,oc,0,Aa);break;case 95:this.eLf(Aa,rb,oc,Lb,$c,Fd+1);break;case 94:this.om.aH.Ari(this.$,
oc)}}eLf(Aa,rb,Lb,oc,$c,Fd){const Cd=this.Vdd($c,Fd);0>Cd&&e.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!oc||Cd>=oc.length)e.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(oc=oc[Cd],oc.f5b){case 1:this.om.aH.Vri(this.$,Lb);break;case 2:($c=Object(Xb.a)(Va,oc))?(Aa=new R.a(-2058042992,rb.method,rb.mode,rb.Re,rb.tabName),this.om.aH.Stb(this.$,Lb,$c.kue,Aa)):this.om.aH.Alf(this.$,
Aa,Lb,oc.w5c);break;case 0:this.om.aH.Alf(this.$,Aa,Lb,oc.w5c);break;case 4:this.eLf(Aa,rb,Lb,oc.subMenu,$c,Fd+1)}}applyAutoFilterFieldList(Aa,rb){var Lb=rb[gc.a.nG];if(Lb)if(Lb=Lb.split(ra.a.rU),3>Lb.length)e.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var oc=this.Vdd(Lb,1),$c=this.uKa(oc),Fd=this.rrf(oc).returnValue;Fd?this.vGd(rb,Aa,Fd,$c,Lb,2):e.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
oc.toString()+ra.a.rU)}else e.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")}Ac(Aa,rb){if(Aa=this.$.isEditMode)switch(rb.command){case 216058793:break;case -699941697:break;case -1494291901:Aa=!0;break;default:Aa=!1}return Aa}A0(Aa,rb,Lb){this.$.isEditMode&&((this.om=Object(Xb.a)(459,Lb))||e.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.BY(),super.A0(Aa,
rb,null,null,!0))}T3c(){if(!this.om||!this.om.Xk||1!==this.om.Xk.length)return e.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;const Aa=this.om.Xk[0];let rb=new Ca.a;rb.add(K.a.instance.ga(251));rb=Oa.OBc(Oa.concat(rb,Oa.select(Oa.asEnumerable(Aa.FieldInfoDataList),Lb=>Lb.Name)),Lb=>Lb,new oa.a);return Oa.toArray(rb)}fieldIndex(Aa){if(!this.om||!this.om.Xk||1!==this.om.Xk.length||!this.om.Xk[0].FieldInfoDataList)return-1;
for(let rb=0;rb<this.om.Xk[0].FieldInfoDataList.length;++rb)if(this.om.Xk[0].FieldInfoDataList[rb].Name===Aa)return rb;return-1}uKa(Aa){return 0>Aa||!this.om||!this.om.Xk||1!==this.om.Xk.length||!this.om.Xk[0].FieldInfoDataList||this.om.Xk[0].FieldInfoDataList.length<Aa?null:this.om.Xk[0].FieldInfoDataList[Aa].Name}BY(){var Aa=this.T3c();if(!Aa||!Aa.length)return null;const rb=this.Ua,Lb=rb.Dc();for(let Cd=0;Cd<Aa.length;++Cd){const $d=Aa[Cd],he=0<Cd?this.fieldIndex($d):-1,ue=Wa.F6f+he.toString()+
ra.a.rU;let Me=null;const ff=this.om.aH.q5h(0<Cd?$d:null),Ve=this.c4c(rb,ff,Wa.F6f+he.toString(),$d);for(let Ze=0;Ze<hb.Tad.length;++Ze){var oc=hb.Tad[Ze],$c=ue+Ze.toString();Me||(Me=rb.Dc());switch(oc){case 230:Me.buttons.push(rb.Ic(223,$c,-699941697,this.om.aH.lni(0<Cd?$d:null)?ma.a.T8b:ma.a.mJa,8,230,!1,null));break;case 231:Me.buttons.push(rb.Ic(224,$c,-699941697,this.om.aH.mni(0<Cd?$d:null)?ma.a.U8b:ma.a.nJa,8,231,!1,null));break;case 235:Me.buttons.push(rb.Ic(225,$c,-699941697,ma.a.R8b,1,235,
!1,null));break;case 99:oc=this.CSg($d);$c=rb.SHa($c+(ff?".enabled":".disabled"),oc,-699941697,null,"None",null,!ff,void 0,!0);$c.bS("Image16by16",8,ma.a.R2a);Me.buttons.push($c);break;case 95:var Fd=void 0;const gf=({QTe:Fd,isChecked:oc}=this.rrf(he)).returnValue;if(!gf)return null;Fd=this.c4c(rb,oc&&ff,$c,Fd);$c=this.ZWe(Fd.menu,rb,$c+ra.a.rU,gf,oc&&ff);Fd.menu.sc.push($c);Me.buttons.push(Fd);break;case 0:Me&&(Ve.menu.sc.push(Me),Me=null);break;default:$c=rb.SHa($c,K.a.instance.ga(oc),-699941697,
null,"None",null,!1,void 0,!0),this.e_f($c,ff&&94===oc&&this.om.aH.filter(),K.a.instance.ga(oc)),Me.buttons.push($c)}}Ve.menu.sc.push(Me);Lb.buttons.push(Ve)}Aa=rb.Up(this.menuId);Aa.sc.push(Lb);return Aa}ZWe(Aa,rb,Lb,oc,$c){let Fd=null;for(let Me=0;Me<oc.length;++Me){var Cd=oc[Me],$d=Lb+Me.toString(),he=!1;switch(Cd.f5b){case 1:he=$c&&this.om.aH.Vh.IsTop10;break;case 2:he=Object(Xb.a)(Va,Cd);he=$c&&this.om.aH.Fgi(he?he.kue:0,Cd.w5c);break;case 0:he=$c&&this.om.aH.Vh.IsCustomSupportedAndNotPresent}Fd||
(Fd=rb.Dc());if(Cd.Pji)Fd&&(Aa.sc.push(Fd),Fd=null);else if(Cd.Bni){var ue=K.a.instance.ga(Cd.wrf);ue=this.c4c(rb,he,$d,ue);ue.menu.sc.push(this.ZWe(ue.menu,rb,$d+ra.a.rU,Cd.subMenu,he));Fd.buttons.push(ue)}else Cd=K.a.instance.ga(Cd.wrf),$d=rb.SHa($d,Cd,-699941697,null,"None",null,!1,void 0,!0),this.e_f($d,he,Cd),Fd.buttons.push($d)}return Fd}e_f(Aa,rb,Lb){rb?Aa.bS("Image16by16",8,ma.a.Fua):Aa.bS("None",0,null);Aa.$R(Lb);Aa.label=Lb}c4c(Aa,rb,Lb,oc){return rb?Aa.U3c(Lb,this.menuId,oc,798637440,8,
ma.a.Fua):Aa.ew(Lb,this.menuId,oc,798637440)}Fh(Aa){return!Aa||!Aa.length}rrf(Aa){var rb=0>Aa?0:this.om.Xk[0].FieldInfoDataList[Aa].MajorityDataTypeForField;var Lb=null;Aa=this.om.aH.p5h(rb);switch(rb){case 0:Lb=96;rb=db.DIj;break;case 1:Lb=95;rb=db.TEi;break;case 2:Lb=97;rb=db.Pch;break;default:return e.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,QTe:Lb,isChecked:Aa}}Lb=K.a.instance.ga(Lb);return{returnValue:rb,QTe:Lb,
isChecked:Aa}}CSg(Aa){return!Aa||this.Fh(Aa.trim())?K.a.instance.ga(98):Aa.length>hb.HTe?String.format(K.a.instance.mb(155),Aa.substring(0,hb.HTe)):String.format(K.a.instance.mb(156),Aa)}}Wa.Hzh=r.a.k3g;Wa.YJb="AutoFilterFieldListContextMenuRoot";Wa.F6f="ApplyAutoFilterFieldList.";Object(c.a)(Wa,"AutoFilterFieldListContextMenu",w.a,[]);var Sa=a(549),yb=a(837),Ma=a(11),Bb=a(122),Nb=a(371);class Ia extends w.a{constructor(Aa,rb,Lb,oc,$c="PopulateFloatingObjectContextMenu",Fd=-2017893763,Cd=1350204367,
$d=r.a.r3g,he=!0,ue=!1){super(Aa,$c,Fd,Cd,$d,he,ue,$d,rb,Lb,!0,oc);this.floatingObject=null;this.tb=0;this.plc=!0}get Lw(){return"PopulateFloatingObjectContextMenu"}get HB(){return r.a.pNf}executeCommand(Aa,rb,Lb){Aa=Object(Xb.a)(Sa.a,Lb.eventArgs);switch(rb.command){case -1372040782:Lb=ka.g(this.$).ha.Qa.dc;e.ULS.shipAssertTag(537167048,0,!!Lb);Lb&&(this.floatingObject=Lb.floatingObject,this.tb=rb.method,rb=this.Kac(Aa),this.Jp(rb,!0,Aa.tb));break;case 848910589:Aa&&(rb=[yb.a.q2f],Aa=new Sys.UI.Point(Aa.Ca.clientX,
Aa.Ca.clientY),this.showFloatie(rb,new Sys.UI.Bounds(Aa.x,Aa.y,0,0),2))}return ab.Task.Ta(!0)}Ac(Aa,rb,Lb){switch(rb.command){case -1372040782:return!!Lb&&this.Fif(Aa);case 848910589:return Aa=ka.g(this.$).ha.Qa.dc,!!Lb&&!!Aa&&Aa.eb;default:return!1}}Fif(Aa){switch(Aa){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}}DUc(Aa,rb,Lb){Nb.a(this.$)?ka.g(this.$).ib.tj||(ea.a(this.$).ISd()?Lb.buttons.push(Aa.qb(265)):Lb.buttons.push(Aa.qb(264))):(this.$.isEditMode&&3===this.tb&&!this.p$b()&&
Lb.buttons.push(Aa.qb(101)),5!==this.floatingObject.type||Bb.a.NH(this.floatingObject.Bb)||this.floatingObject.Bb.IsGroup||(this.frd()?Lb.buttons.push(Aa.qb(186)):Lb.buttons.push(Aa.qb(147))),this.p$b()||this.frd()||Lb.buttons.push(Aa.qb(146)),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.JFh(Lb),this.kHh(Lb)),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Lb.buttons.push(Aa.qb(287)),da.EwaSettings.ma(166)&&
0===this.floatingObject.type&&Lb.buttons.push(Aa.qb(249)),5===this.floatingObject.type&&ka.g(this.$).ha.Qa.dc.i5()&&this.$.Jka&&this.$.V9&&Lb.buttons.push(Aa.qb(273)))}xKa(Aa){const rb=[];if(Nb.a(this.$))return rb;3===Aa?(Aa=!!this.$.pe.get(5)&&this.floatingObject.TVd(),this.p$b()||(this.$.isEditMode?(Aa&&rb.push(yb.a.LCh),5===ka.g(this.$).ha.Qa.$A.floatingObject.type&&rb.push(yb.a.$uj)):Aa&&rb.push(yb.a.copy)),rb.push(yb.a.MCh)):2===Aa&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
ka.g(this.$).ha.Qa.dc&&this.Z0e(ka.g(this.$).ha.Qa.dc,rb):this.Z0e(ka.g(this.$).ha.Qa.$A,rb));return rb}BY(){const Aa=this.Ua,rb=Aa.Up(this.menuId);var Lb=Nb.a(this.$);if(this.$.isEditMode){var oc=Aa.Dc();this.DUc(Aa,rb,oc);rb.sc.push(oc)}this.$.pe.get(5)&&this.floatingObject.TVd()&&!this.p$b()&&!Lb&&(oc=Aa.Dc(),this.hCg(Aa,oc),rb.sc.push(oc));(oc=this.$.xa.oa)&&oc.Dd&&(oc=oc.Dd.uv||oc.Dd.VH,!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||
this.$.ea.isNamedObjectViewMode||Lb||this.$.isMobileMode||oc||(Lb=Aa.Dc(),this.fEg(Aa,Lb),rb.sc.push(Lb)));return rb}Kac(Aa){var rb=ka.g(this.$).ha.Qa.dc;Aa=Aa&&1!==Aa.tb&&Aa.clientPoint?Aa.clientPoint:Sys.UI.DomElement.getLocation(rb.domElement);const Lb=this.$.domElement,oc=ka.g(this.$).rtl;(rb=Ma.HelperMethods.dD(rb.lg.domElement,Lb,oc))?(Aa.y=Math.max(Aa.y,rb.y),Aa.x=Math.max(Aa.x,rb.x)):e.ULS.sendTraceTag(537167047,5,15,`FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : ${l.AFrameworkApplication.Qg}`);
return Aa}frd(){const Aa=ka.g(this.$).ha.Qa.dc;return!!Aa&&Aa.eb}hCg(Aa,rb){if(this.$.isEditMode){rb.buttons.push(Aa.qb(42));rb.buttons.push(Aa.qb(43));const Lb=this.$.da.za(254,!0);(Lb&&2===Lb.KBb()||this.frd())&&rb.buttons.push(Aa.qb(44))}else rb.buttons.push(Aa.qb(43))}fEg(Aa,rb){rb.buttons.push(Aa.qb(274))}p$b(){return da.EwaSettings.ma(465)&&!!ka.g(this.$).ha.Qa.jo}Z0e(Aa,rb){5===Aa.floatingObject.type?Aa.eb?rb.push(yb.a.q2f):rb.push(yb.a.Wuj):rb.push(w.a.UUe)}JFh(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(282));
rb.buttons.push(this.Ua.qb(281));const Lb=this.Ua.ew("BringToFront","BringToFrontMenuId",K.a.instance.ga(827),-1777747317);Lb.menu.sc.push(rb);Aa.buttons.push(Lb)}kHh(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(284));rb.buttons.push(this.Ua.qb(283));const Lb=this.Ua.ew("SendToBack","SendToBackMenuId",K.a.instance.ga(828),-1777747317);Lb.menu.sc.push(rb);Aa.buttons.push(Lb)}}Object(c.a)(Ia,"FloatingObjectContextMenu",w.a,[]);var jb=a(787),Ob=a(102),Jb=a(557),Kb=a(516);const Qa=r.a.n3g;class ha extends Ia{constructor(Aa,
rb,Lb,oc){super(Aa,rb,Lb,oc,"PopulateChartContextMenu",-498523270,1640762262,Qa);this.isPivotChart=this.refresh=this.UY=this.nwa=this.YAa=!1}get Lw(){return"PopulateChartContextMenu"}get HB(){return r.a.jNf}executeCommand(Aa,rb,Lb){const oc=this.$;this.tb=rb.method;rb=Lb[ha.m0c];if(!(Aa&68)){if(!rb){if(8===Aa)rb=Kb.a(oc).Tc;else{var $c=ka.g(oc).ha.Qa.dc;if(null===$c||void 0===$c?0:$c.floatingObject)rb=$c.floatingObject.Tc}if(!rb)return ab.Task.Ta(!0)}this.isPivotChart=!!(rb.Attributes&4)}if(this.isPivotChart||
oc.isEditMode)if(this.refresh=this.UY=this.nwa=this.YAa=!1,$c=ka.g(this.$).ha.Qa.dc,e.ULS.shipAssertTag(537167107,0,!!$c),$c){this.floatingObject=$c.floatingObject;$c=Jb.a(oc);if(null===$c||void 0===$c?0:$c.dSd)this.YAa=$c=Ob.f(oc.sg),this.nwa=!$c;$c=oc.jc;this.UY=!!jb.a(oc)&&!!rb&&!!(rb.Attributes&512)&&!(Aa&8)&&$c.v2(32768);$c.allowManualDataRefresh&&$c.allowInteractivity&&(this.refresh=!0);Aa=this.Kac(Object(Xb.a)(Sa.a,Lb.eventArgs));this.Jp(Aa,!0)}return ab.Task.Ta(!0)}Ac(Aa,rb,Lb){return-149612405===
rb.command&&!!Lb&&this.Fif(Aa)}DUc(Aa,rb,Lb){this.isPivotChart&&(this.refresh&&Lb.buttons.push(Aa.qb(100)),this.UY&&Lb.buttons.push(Aa.qb(99)),this.YAa?Lb.buttons.push(Aa.qb(59)):this.nwa&&Lb.buttons.push(Aa.qb(58)));super.DUc(Aa,rb,Lb)}static get m0c(){return"chartMetaData"}}Object(c.a)(ha,"ChartContextMenu",Ia,[]);var qa=a(12);const pb=r.a.p3g;class bb extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateFieldListContextMenu",-1045020714,-170383950,pb,!0,!1,pb,rb,Lb,!1,oc);this.GL=this.Ao=null;
this.VVd=this.isOlap=this.nV=this.HZ=!1}get Lw(){return"PopulateFieldListContextMenu"}get HB(){return r.a.HHd}executeCommand(Aa,rb,Lb){Aa=rb.command;switch(Aa){case 330754562:rb=Lb.domElement;this.isOlap=Lb.isOlap;this.GL=Lb.versionkey;this.Ao=Lb.fieldItem;this.HZ=Lb.isChart;this.nV=Lb.isPpm;this.VVd="supportsImplicitMeasures"in Lb?Lb.supportsImplicitMeasures:!1;ka.g(this.$).Qo(!0);rb=qa.DOMElementExtensions.getBounds(rb);rb=new Sys.UI.Point(rb.x+rb.width,rb.y+rb.height/2);"isKeyboardInput"in Lb&&
Lb.isKeyboardInput?this.Jp(rb,!1,1):this.Jp(rb,!1);break;case 926905850:this.VVd&&this.Ao&&5===this.Ao.TypeTag&&!this.Ao.IsCollapsible&&e.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Jb.a(this.$).UJ(this.Ao,8,-1,this.GL,rb);break;case -67292059:Jb.a(this.$).UJ(this.Ao,1,-1,this.GL,rb);break;case 745182485:Jb.a(this.$).UJ(this.Ao,2,-1,this.GL,rb);break;case 359279088:Jb.a(this.$).UJ(this.Ao,4,-1,this.GL,rb);break;case 547535945:Jb.a(this.$).g5i(this.Ao);break;default:return ta.a(Aa)}return ab.Task.Ta(!0)}Ac(Aa,
rb,Lb){Aa=!1;switch(rb.command){case 330754562:Aa=!!Lb;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:Aa=!0}return Aa}BY(){const Aa=this.Ua.Up(this.menuId);this.DZi(Aa);this.HZ||this.isOlap||this.CZi(Aa);return Aa}DZi(Aa){const rb=this.Ua,Lb=rb.Dc();let oc=!1;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(oc=this.isOlap&&!this.nV&&this.VVd&&5===this.Ao.TypeTag&&!this.Ao.IsCollapsible);3!==this.Ao.TypeTag&&37!==this.Ao.TypeTag||
this.Ao.IsSet?17===this.Ao.TypeTag||this.nV?(Lb.buttons.push(rb.qb(79)),Lb.buttons.push(rb.qb(this.HZ?91:80)),Lb.buttons.push(rb.qb(this.HZ?92:81)),Lb.buttons.push(rb.qb(82))):13===this.Ao.TypeTag||this.Ao.IsSet?(Lb.buttons.push(rb.qb(83)),Lb.buttons.push(rb.qb(this.HZ?91:80)),Lb.buttons.push(rb.qb(this.HZ?92:81)),Lb.buttons.push(rb.qb(86))):(Lb.buttons.push(rb.qb(79)),Lb.buttons.push(rb.qb(this.HZ?91:80)),Lb.buttons.push(rb.qb(this.HZ?92:81)),Lb.buttons.push(rb.qb(oc?82:86))):(Lb.buttons.push(rb.qb(83)),
Lb.buttons.push(rb.qb(this.HZ?93:84)),Lb.buttons.push(rb.qb(this.HZ?94:85)),Lb.buttons.push(rb.qb(82)));Aa.sc.push(Lb)}CZi(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(78));Aa.sc.push(rb)}}Object(c.a)(bb,"FieldListContextMenu",w.a,[]);var eb=a(414),Fa=a(65);class tb{constructor(Aa){this.$=Aa;this.xN={}}get(Aa,rb,Lb){const oc=this.Ibg(Aa,"PivotFilterContextMenuCache.Get");return oc&&this.xN[oc]?this.xN[oc][tb.Ofd(rb,this.$,Aa,Lb)]:null}set(Aa,rb,Lb,oc){const $c=this.Ibg(Aa,"PivotFilterContextMenuCache.Set");
$c&&(this.xN[$c]||(this.xN[$c]={}),this.xN[$c][tb.Ofd(rb,this.$,Aa,oc)]=Lb)}F7b(Aa){Aa in this.xN&&this.xN[Aa]&&(this.xN[Aa]=null)}Ibg(Aa,rb){return Fa.f(this.$.oa)?this.$.activeItemName:(Aa=this.nNj(Aa,rb))?Aa.Pd:null}nNj(Aa,rb){Aa=I.C(Aa);Aa=ka.g(this.$).Ea.Cva(Aa,this.$.activeItemName);e.ULS.shipAssertTag(537167008,0,!!Aa,`PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: ${rb}`);return Aa}static Ofd(Aa,
rb,Lb,oc){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===oc?rb.oa.index+"_"+Aa.id+"_"+Lb.FirstRow.toString()+"_"+Lb.FirstColumn.toString():rb.oa.index+"_"+Aa.id}}Object(c.a)(tb,"PivotFilterContextMenuCache",null,[]);class dc{constructor(){this.cell=null;this.dataSourceIndex=0;this.Mo=this.pivotName=null}}Object(c.a)(dc,"ShowPivotFilterData",null,[]);var jc=a(456),fb=a(1286),ec=a(53);const lb=r.a.bDe;class ac extends w.a{constructor(Aa,rb,Lb,oc,$c,Fd,Cd,$d=lb){super(Aa,
rb,Lb,oc,$d,!0,!1,"PivotFilterMenuRootName",$c,Fd,!1,Cd);this.Hmc=this.Qzd=this.pivotData=this.vmb=this.Lkf=this.q5b=null;this.eY=this.w2b=this.jEb=0;this.Urb=null;this.KLi=(he,ue)=>{if(ue)if(W.a(he))this.Nwd(ue,!1);else if(he=he.Result){this.Jsb=tb.Ofd(ue,this.$,this.pivotData.cell,this.eY);var Me=this.srf(he.MenuModel.Sections);this.Urb=Me;ac.xN.set(this.pivotData.cell,ue,Me,this.eY);fb.a(this.$).aGj(he);this.Nwd(ue,!0)}};this.JLi=(he,ue)=>{this.Nwd(ue,!1)};this.rf=(he,ue)=>{ac.xN.F7b(ue.hd.hash)};
this.Tm=(he,ue)=>{ac.xN.F7b(ue.hd.hash)};this.Pza=null;this.Sye=this.w2b=this.Rzd=this.jEb=-1;this.Tqe=this.eY=0;this.vz=da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ac.xN||(ac.xN=new tb(this.$),ka.g(this.$).Ea.Ws(this.rf),ka.g(this.$).Ea.XG(this.Tm),ka.g(this.$).Ea.Mga(this.rf))}T$c(Aa,rb){const Lb=Aa.rawEvent,oc=Aa.cell,$c=Aa.requiresConfirmation;jc.a(this.$).Ex($c,Fd=>{if(Fd){Fd=Lb?new Sys.UI.DomEvent(Lb):null;this.pivotData=new dc;this.pivotData.pivotName=Aa.pivotName;
this.pivotData.dataSourceIndex=Aa.dataSourceIndex;this.pivotData.cell=oc;this.pivotData.Mo=Aa.optionalPivotMenuAnchorParameter;if(this.pivotData.Mo&&0<this.pivotData.Mo.AnchorType){this.Hmc=Aa.objectId;this.jEb=Aa.objectVersion;const Cd=this.pivotData.Mo.AnchorType;if(4===Cd||5===Cd||6===Cd||11===Cd||9===Cd||10===Cd||8===Cd)this.vmb=Aa.location}else this.Qzd=this.Hmc=null,this.Rzd=this.jEb=-1;ka.g(this.$).Qo(!0);this.$.gk(oc);this.A0(Fd,Fd?Fd.target:Aa.domElement,this.pivotData,rb,this.AMa())}});
return!0}A0(Aa,rb,Lb,oc){if(Object(eb.a)(dc,Lb)){this.pivotData=Lb;this.q5b=rb;this.Lkf=Aa;this.w2b=this.pivotData.Mo?this.pivotData.Mo.AnchorValue1:-1;this.eY=this.pivotData.Mo?this.pivotData.Mo.AnchorType:0;var $c=!1,Fd=null;Fd=ac.xN.get(this.pivotData.cell,rb,this.eY);$c=!!Fd;var Cd=!0;switch(this.eY){case 4:case 5:case 6:this.Pza=new Sys.UI.Point(this.vmb.x,this.vmb.y);Cd=!1;break;case 7:var $d=Sys.UI.DomElement.getBounds(rb);Cd=$d.x+(0<=$d.x?0:$d.width);$d=$d.y+(0<=$d.y?0:$d.height);this.Pza=
new Sys.UI.Point(0<=Cd?Cd:0,0<=$d?$d:0);Cd=!1;break;case 8:case 10:case 9:case 11:this.Pza=new Sys.UI.Point(this.vmb.x,this.vmb.y);break;default:this.Pza=null}$c&&this.Hmc===this.Qzd&&this.jEb===this.Rzd&&this.w2b===this.Sye&&this.eY===this.Tqe?(e.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.Urb=Fd,this.Pza?this.Jp(this.Pza,this.AMa()):this.vz?(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||
w.a.Wnd(this.$,this.pivotData.cell))&&this.Jp(w.a.ded(this.$,this.pivotData.cell,!1),this.AMa()):super.A0(Aa,rb,Lb,oc,this.AMa())):1!==ac.JOh(rb)&&(Cd&&(rb.parentNode.menuFetchStates=1,this.Apj(rb),this.NZf(!0)),this.$.userOperationManager.Wb(new U.a(126,0,(he,ue,Me)=>{const ff=this.$;return X.p(ff.pa.va,this.pivotData.cell,this.pivotData.dataSourceIndex,this.pivotData.pivotName,ff.domElement.id,ff.isChromeRtl,ff.workbookContext.NovMode,P.b(he,this.KLi),P.a(ue,this.JLi),Me,rb,this.pivotData.Mo)},
16),oc))}}QEd(Aa){Aa.MenuSectionList.push(...this.Urb)}Nwd(Aa,rb){Aa.parentNode.menuFetchStates=2;this.NZf(!1);if(rb){if(this.q5b!==Aa||this.vAi())this.Jp(this.Pza,this.AMa());else if(this.vz&&!this.Pza){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!w.a.Wnd(this.$,this.pivotData.cell))return;this.Jp(w.a.ded(this.$,this.pivotData.cell,!1),this.AMa())}else super.A0(this.Lkf,Aa,null,null,this.AMa());this.Qzd=this.Hmc;this.Rzd=this.jEb;this.Tqe=this.eY;this.Sye=
this.w2b}}AMa(){return 8!==this.eY&&9!==this.eY&&10!==this.eY&&11!==this.eY}vAi(){switch(this.pivotData.Mo?this.pivotData.Mo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}}NZf(Aa){const rb=this.q5b;if(rb){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var Lb=qa.DOMElementExtensions.cZ(rb,"ewaprevsrc","");Lb=!!Lb&&"null"!==Lb}else Lb=!!qa.DOMElementExtensions.cZ(rb,"ewaprevsrc","");Aa&&Lb||!Aa&&!Lb||(Aa?(rb.setAttribute("ewaprevsrc",
rb.src),rb.src=ec.a.current.Zn(100)):(Aa=qa.DOMElementExtensions.cZ(rb,"ewaprevsrc",""),rb.src=Aa,rb.setAttribute("ewaprevsrc",null)))}}Apj(Aa){this.q5b=Aa}static JOh(Aa){const rb=Aa.parentNode.menuFetchStates;void 0===rb&&(Aa.parentNode.menuFetchStates=0);return rb}}ac.xN=null;Object(c.a)(ac,"PivotFilterContextMenuBase",w.a,[]);const Gb="FieldList"+r.a.bDe;class wb extends ac{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateFieldListPivotMenu",-1793121409,1378457149,rb,Lb,oc,Gb)}get Lw(){return"PopulateFieldListPivotMenu"}get HB(){return r.a.nNf}executeCommand(Aa,
rb,Lb){return this.T$c(Lb,rb)?ab.Task.Ta(!0):ta.a(rb.command)}Ac(Aa,rb,Lb){return-1065117584===rb.command&&!!Lb}}Object(c.a)(wb,"FieldListPivotContextMenu",ac,[]);var qc=a(263),Ya=a(30),xb=a(86),wc=a(739);class Oc{}Object(c.a)(Oc,"PivotValueFieldSettingsApplyData",null,[]);class Cb{}Cb.uch="dataFieldCustomLabel";Cb.hHe="dataFieldSourceLabel";Cb.TTd="showValueAsSelect";Cb.RTd="showValueAsBaseFieldSelect";Cb.STd="showValueAsBaseItemSelect";Cb.l0d="valueFieldsSettingsFieldName";Cb.Rgg="valueFieldSettingTabs";
Object(c.a)(Cb,"CssElementIds",null,[]);var Ib=a(119);class fc{constructor(Aa,rb,Lb){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=Aa;this.baseFieldIndex=rb;this.baseItemIndex=Lb}}Object(c.a)(fc,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);class vc{constructor(Aa,rb,Lb,oc,$c){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=Aa;this.activeCell=rb;this.pivotFieldTitle=
Lb;this.summarizeBy=oc;this.showAsValueParameters=$c}getActiveCell(){return this.activeCell}}Object(c.a)(vc,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[115]);var Cc=a(236);class fd{}Object(c.a)(fd,"PivotValueFieldShowValueAsApplyData",null,[]);var od=a(727),Ub=a(42);const Fc=`<div id='showValueAsControlBody'><label for='${Cb.TTd}' class='${Ib.a.yo} valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='${Cb.TTd}' class='${Ib.a.gF}'></select></div><div class='showValueAsControlSelectRegion'><label for='${Cb.RTd}'>{1}</label><div><select size=6 id='${Cb.RTd}' class='${Ib.a.gF}'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='${Cb.STd}'>{2}</label><div><select size=6 id='${Cb.STd}' class='${Ib.a.gF}'></select></div></div></div>`;
class $b extends Cc.a{constructor(Aa,rb,Lb,oc,$c,Fd,Cd,$d,he){super(Aa);this.htmlSanitizationHelper=this.S5d=this.E3d=this.D3d=this.Q0b=this.X5b=this.oD=null;this.vxf=()=>{var ue=parseInt(this.s3.fe.value,10);this.OVg(ue)?(this.zP.mq.disabled=!0,this.AP.mq.disabled=!0,this.AP.clear(),$b.Xcf(ue)?(this.zP.mq.disabled=!1,this.bPb(!da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857026_ShowValueAsControlOKButtonFix"))):$b.Ycf(ue)?(this.zP.mq.disabled=!1,this.AP.mq.disabled=!1,this.bPb(!0),this.omf()):
this.bPb(!1)):(ue=V.a.Yc(1,0,0,1130,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Ub.a(this.$).Hr([ue]),this.s3.Chj())};this.CGi=()=>{0>this.zP.selectedIndex||this.AP.mq.disabled||(this.bPb(!0),this.omf())};this.HMi=ue=>{this.oD.uTa();this.AP.mq.style.overflowY="scroll";if(ue&&!W.a(ue)){ue=ue.Result;this.AP.clear();for(const Me of ue.BaseItems)this.AP.hM(Me.DisplayString,Me.Id.toString(),Me.Id===ue.SelectedBaseItem);this.bPb(!1)}};this.get_visible=this.Qja;this.set_visible=this.Fna;this.$=rb;this.cell=
Lb;this.Mo=oc;this.externalSourceIndex=$c;this.Jd=Fd;this.Tha=Cd;this.kki=$d;this.htmlSanitizationHelper=he;this.JSj=da.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");this.kka()}Qja(){return this.isVisible}Fna(Aa){return this.isVisible=Aa}get title(){return K.a.instance.ga(1118)}get qwb(){const Aa=this.s3.fe?parseInt(this.s3.fe.value,10):-1,rb=this.zP.fe?parseInt(this.zP.fe.value,10):-1,Lb=this.AP.fe?parseInt(this.AP.fe.value,10):-1;return Object(f.a)(new fd,
{SelectedDataFormat:0<=Aa?Aa:-1,SelectedBaseField:rb,SelectedBaseItem:Lb})}get zP(){return this.D3d}get AP(){return this.E3d}get s3(){return this.S5d}setFocus(){qa.DOMElementExtensions.setFocus(this.s3.mq)}render(Aa){Aa.appendChild(this.domElement)}dispose(){xb.a.qc([this.s3,this.zP,this.AP,this.X5b,this.Q0b]);super.dispose()}ksj(Aa){xb.a.qc([this.X5b,this.Q0b]);this.s3.clear();for(const rb of Aa.DataFormatTypes)this.s3.hM($b.VMh(rb),rb.toString(),rb===Aa.SelectedDataFormat);this.X5b=this.ve.$d(this.s3.domElement);
this.X5b.ka("change",this.vxf);this.zP.clear();for(const rb of Aa.BaseFieldList)this.zP.hM(rb.DisplayString,rb.Id.toString(),rb.Id===Aa.SelectedBaseField);this.Q0b=this.ve.$d(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857021_ShowValueAsControlBaseFieldSelectionFix")?this.zP.domElement:this.s3.domElement);this.Q0b.ka("change",this.CGi);this.oD=this.Tha.Orb(this.AP.mq.parentNode,1E3,null,"",741);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6857019_ShowValueAsControlLoadingIndicatorFix")&&this.oD.uTa();
this.vxf(null)}KQ(Aa){this.s3.KQ(Aa);this.zP.KQ(Aa);this.AP.KQ(Aa)}kka(){da.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.fdb(this.domElement,String.format(Fc,K.a.instance.ga(1119),K.a.instance.ga(1120),K.a.instance.ga(1121))):this.domElement.innerHTML=String.format(Fc,K.a.instance.ga(1119),K.a.instance.ga(1120),K.a.instance.ga(1121));this.S5d=new od.a(qa.DOMElementExtensions.getElementById(this.domElement,
Cb.TTd),!1);this.D3d=new od.a(qa.DOMElementExtensions.getElementById(this.domElement,Cb.RTd),!1);this.E3d=new od.a(qa.DOMElementExtensions.getElementById(this.domElement,Cb.STd),!1)}OVg(Aa){return this.kki||!$b.Xcf(Aa)&&!$b.Ycf(Aa)?!0:!!this.zP.count}getValueFieldSettingsShowValueAsBaseItemsInfo(){this.$.userOperationManager.Wb(new U.a(108,0,(Aa,rb,Lb)=>{var oc=this.$.pa.va,$c=parseInt(this.zP.fe.value,10);Aa=P.b.call(null,Aa,this.HMi);const Fd=X.L(oc,this.cell,this.externalSourceIndex,this.Mo);Fd.selectedBaseField=
$c;return X.g(oc,"GetPivotValueFieldSettingsShowValueAsBaseItems",Fd,Aa,rb,Lb,null,4)},16),this.Jd)}omf(){this.AP.clear();this.zP.fe&&(this.oD.oTa(),this.AP.mq.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())}bPb(Aa){const rb=document.getElementById("WACDialogActionButton");this.JSj&&rb&&(rb.disabled=Aa)}static VMh(Aa){switch(Aa){case 0:return K.a.instance.ga(1122);case 1:return K.a.instance.ga(1123);case 2:return K.a.instance.ga(1124);case 3:return K.a.instance.ga(1125);
case 4:return K.a.instance.ga(1126);case 5:return K.a.instance.ga(1127);case 6:return K.a.instance.ga(1128);case 7:return K.a.instance.ga(1129);case 8:return K.a.instance.ga(1131);case 9:return K.a.instance.ga(1132);case 10:return K.a.instance.ga(1133);case 11:return K.a.instance.ga(1134);case 12:return K.a.instance.ga(1135);case 13:return K.a.instance.ga(1136);case 14:return K.a.instance.ga(1137);default:return""}}static Xcf(Aa){return 11===Aa||12===Aa||14===Aa||13===Aa||4===Aa}static Ycf(Aa){return 1===
Aa||3===Aa||2===Aa}}Object(c.a)($b,"ShowValueAsControl",Cc.a,[486,10]);class zc{}Object(c.a)(zc,"PivotValueFieldSummarizeValueByApplyData",null,[]);const Wc="<div id='summarizeValuesByControlBody'>"+`<label class='${Ib.a.yo} valueFielsSettingsControlTitle' for='${"pivotDataFieldSelect"}'>{0}</label>`+`<div id='${"pivotDataFieldSelectDescription"}' class='${Ib.a.yo} summarizeValuesByControlDescription'>{1}</div>`+`<div><select class='${Ib.a.gF}' size=6 id='${"pivotDataFieldSelect"}' style='width: 100%' ${r.a.yJ}='${"pivotDataFieldSelectDescription"}'></select></div>`+
"</div>";class yc extends Cc.a{constructor(Aa,rb){super(Aa);this.htmlSanitizationHelper=this.Tee=null;this.get_visible=this.Qja;this.set_visible=this.Fna;this.htmlSanitizationHelper=rb;this.kka()}get qwb(){const Aa=this.ql.fe?parseInt(this.ql.fe.value,10):-1;return Object(f.a)(new zc,{Aggregation:0<=Aa?Aa:-1})}Qja(){return this.isVisible}Fna(Aa){return this.isVisible=Aa}get title(){return K.a.instance.ga(1117)}get enabled(){return!this.ql.mq.disabled}set enabled(Aa){this.ql.mq.disabled=!Aa}get ql(){return this.Tee}setFocus(){qa.DOMElementExtensions.setFocus(this.ql.mq)}render(Aa){Aa.appendChild(this.domElement)}dispose(){xb.a.Ia(this.ql);
super.dispose()}focus(){qa.DOMElementExtensions.setFocus(this.ql.mq)}jsj(Aa){this.ql.QUd();for(const rb of Aa.AggregationTypes){const Lb=rb===Aa.SelectedAggregation;this.ql.BUc(yc.vIh(rb),rb.toString(),Lb,"")}this.ql.D8c();this.ql.mq.disabled=Aa.AggregationsDisabled}yhj(){this.ql.zhj()}kka(){da.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.fdb(this.domElement,
String.format(Wc,K.a.instance.ga(1102),K.a.instance.ga(1103))):this.domElement.innerHTML=String.format(Wc,K.a.instance.ga(1102),K.a.instance.ga(1103));this.Tee=new od.a(qa.DOMElementExtensions.getElementById(this.domElement,yc.nIf),!1)}static vIh(Aa){switch(Aa){case 0:return K.a.instance.ga(1105);case 1:return K.a.instance.ga(1106);case 2:return K.a.instance.ga(1107);case 3:return K.a.instance.ga(1108);case 4:return K.a.instance.ga(1109);case 5:return K.a.instance.ga(1110);case 6:return K.a.instance.ga(1111);
case 7:return K.a.instance.ga(1112);case 8:return K.a.instance.ga(1113);case 9:return K.a.instance.ga(1114);case 10:return K.a.instance.ga(1115);case 11:return K.a.instance.ga(1116);default:return""}}}yc.nIf="pivotDataFieldSelect";Object(c.a)(yc,"SummarizeValuesByControl",Cc.a,[486,10]);var pd=a(210),xd=a(467),Vb=a(1233);class Uc extends wc.a{constructor(Aa,rb,Lb,oc,$c,Fd,Cd,$d,he,ue){super($c,K.a.instance.mb(61),!0,2,!0);this.g4f=!0;this.htmlSanitizationHelper=this.dSc=this.W5b=this.isb=this.Lfa=
this.ZSa=this.vke=null;this.rGi=Me=>{qc.a.any(Me.Errors,ff=>-103190598===ff.MessageId)&&this.CTa.yhj()};this.GMi=Me=>{Me&&!W.a(Me)&&(Me=Me.Result,da.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?this.htmlSanitizationHelper.Ypj(this.W5b,K.a.instance.ga(1100)+Ya.a.zg(Me.ValueFieldSourceName)):this.W5b.innerHTML=K.a.instance.ga(1100)+Ya.a.zg(Me.ValueFieldSourceName),this.isOlap&&
!this.nV?(this.CTa.enabled=!1,this.Lfa.activeTab=this.Lfa.Zzc-1):(this.CTa.enabled=!0,this.Lfa.activeTab=0),this.CTa.jsj(Me.PivotValueFieldSettingsSummarizeValueByInfo),this.ZSa.ksj(Me.PivotValueFieldShowValueAsInitialInfo),this.ig())};this.cell=Aa;this.Mo=rb;this.externalSourceIndex=Lb;this.Qgg=oc;this.Jd=Fd;this.Tha=Cd;this.isOlap=$d;this.nV=he;this.htmlSanitizationHelper=ue}get uc(){return"ValueFieldSettingsDialog"}get gCa(){return this.vke}get HDb(){return this.Lfa}get CTa(){return this.dSc}get hA(){return 560}dispose(){this.W5b=
this.isb=this.ZSa=this.dSc=null;xb.a.Ia(this.Lfa);this.Lfa=null;super.dispose()}initialize(){let Aa="<div id='"+Cb.hHe+"' class='"+Ib.a.yo+"'></div><div id='"+Cb.uch+"' class='"+Ib.a.yo+"'><label for='"+Cb.l0d+"'>{0}</label><input type='text' id='"+Cb.l0d+"' value='{1}' class='"+Ib.a.gF+" UIFont' /></div><div id='"+Cb.Rgg+"'></div>";Aa=String.format(Aa,K.a.instance.ga(1101),Ya.a.zg(this.Qgg));da.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
this.htmlSanitizationHelper.fdb(this.Pb,Aa):this.Pb.innerHTML=Aa;this.hf||(this.Iga(),this.Co());this.vke=[-103190598];this.Z_h();super.initialize()}close(Aa){1===Aa&&(this.g4f=!1);super.close(Aa)}eJe(Aa){this.iN=Aa;this.domElement.disabled=Aa;const rb=["input","option","select"];for(let Lb=0,oc=rb.length;Lb<oc;++Lb){const $c=this.domElement.getElementsByTagName(rb[Lb]);for(let Fd=0;Fd<$c.length;++Fd)$c[Fd].disabled=Aa}}Co(){this.isb=document.getElementById(Cb.l0d);this.W5b=qa.DOMElementExtensions.getElementById(this.Pb,
Cb.hHe);const Aa=qa.DOMElementExtensions.getElementById(this.Pb,Cb.Rgg);this.dSc=new yc(document.createElement("div"),this.htmlSanitizationHelper);this.ZSa=new $b(document.createElement("div"),this.$,this.cell,this.Mo,this.externalSourceIndex,this.Jd,this.Tha,!this.isOlap,this.htmlSanitizationHelper);let rb;this.Lfa=new Vb.a(Aa,(rb=new Ca.a,rb.add(this.CTa),rb.add(this.ZSa),rb));this.Lfa.BSf()}aFd(){const Aa=new Uc(this.cell,this.Mo,this.externalSourceIndex,this.Qgg,this.$,this.Jd,this.Tha,this.isOlap,
this.nV,this.htmlSanitizationHelper);Aa.initialize();Aa.ig()}TPb(){const Aa=new xd.a;if(!this.g4f)return Aa.isValid=!0,Aa;this.isb.value.length?Aa.isValid=!0:(this.eJe(!0),Aa.error=V.a.Yc(1,0,756,771,0,1783218700,"PivotTableValueFieldNoBlank"),this.iN=!0,this.hf||(this.cz.disabled=!0),Aa.isValid=!1);return Aa}w6e(){this.iN=!1;this.hf||(this.cz.disabled=!1);this.eJe(!1)}Oya(Aa){const rb=new R.a(2105621672,0,this.$.Kc,30,null);this.$.Ka.Lb(rb);this.mW(5,Aa.tb,"Number Format");return!0}Po(){this.qoa=
String.format(K.a.instance.mb(61),null);super.Po()}setFocus(){if(this.hf){const Aa=qa.DOMElementExtensions.getElementById(this.Pb,yc.nIf);pd.a.sBc(Aa)}else this.Lfa.setFocus()}Qj(){const Aa=this.ZSa.qwb,rb=new fc(Aa.SelectedDataFormat,Aa.SelectedBaseField,Aa.SelectedBaseItem);return()=>new vc(this.externalSourceIndex,this.cell,this.isb.value,this.CTa.qwb.Aggregation,rb)}EE(){const Aa=Object(f.a)(new Oc,{PivotValueFieldSummarizeValueByApplyData:this.CTa.qwb,PivotValueFieldShowValueAsApplyData:this.ZSa.qwb,
PivotValueFieldTitle:this.isb.value});return(rb,Lb,oc)=>{var $c=this.$.pa.va;rb=P.b(rb,this.rGi);const Fd=X.L($c,this.cell,this.externalSourceIndex,this.Mo);Fd.pivotValueFieldSettingsApplyData=Aa;return X.g($c,"ApplyPivotValueFieldSettings",Fd,rb,Lb,oc,null,0)}}KQ(Aa){this.$.da.Za(40,()=>{this.ZSa.KQ(Aa)})}Z_h(){this.$.userOperationManager.Wb(new U.a(123,0,(Aa,rb,Lb)=>{var oc=this.$.pa.va;Aa=P.b.call(null,Aa,this.GMi);const $c=X.L(oc,this.cell,this.externalSourceIndex,this.Mo);return X.g(oc,"GetPivotValueFieldSettingsInitial",
$c,Aa,rb,Lb,null,4)},16),this.Jd)}}Object(c.a)(Uc,"ValueFieldSettingsDialog",wc.a,[]);const ud=r.a.q3g;class Vc extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateFieldWellContextMenu",1374696078,495005930,ud,!0,!1,ud,rb,Lb,!1,oc);this.Mo=this.Ao=this.cell=null;this.y1d=this.externalSourceIndex=-1;this.jTa=0;this.Zyc=-1;this.GL=null;this.e3a=this.nV=this.isOlap=!1}get Lw(){return"PopulateFieldWellContextMenu"}get HB(){return r.a.IHd}executeCommand(Aa,rb,Lb,oc){Aa=rb.command;switch(Aa){case -1453503574:oc=
Lb.domElement;this.Ao=Lb.fieldItem;this.y1d=Lb.zoneCount;this.jTa=Lb.sourceAxis;this.Zyc=Lb.sourceAxisPos;this.Mo=Lb.optionalPivotMenuAnchorParameter;this.GL=Lb.versionkey;this.isOlap=Lb.isOlap;this.nV=Lb.isPpm;this.e3a="fieldItemsupportsImplicitMeasures"in Lb?Lb.fieldItemsupportsImplicitMeasures:!1;this.cell=Lb.cell;this.externalSourceIndex=Lb.externalSourceIndex;ka.g(this.$).Qo(!0);oc=qa.DOMElementExtensions.getBounds(oc);Aa=new Sys.UI.Point(oc.x,oc.y+oc.height);this.$.isChromeRtl&&(Aa.x+=oc.width);
"isKeyboardInput"in Lb&&Lb.isKeyboardInput?this.Jp(Aa,!1,1):this.Jp(Aa,!1);break;case 495005930:break;case -1170196828:Jb.a(this.$).UJ(this.Ao,this.jTa,this.Zyc-1,this.GL,rb);break;case -889576107:Jb.a(this.$).UJ(this.Ao,this.jTa,this.Zyc+2,this.GL,rb);break;case 2033235475:Jb.a(this.$).UJ(this.Ao,this.jTa,this.y1d,this.GL,rb);break;case 389774337:Jb.a(this.$).UJ(this.Ao,this.jTa,0,this.GL,rb);break;case -96230454:Jb.a(this.$).UJ(this.Ao,4,-1,this.GL,rb);break;case 74086617:Jb.a(this.$).UJ(this.Ao,
1,-1,this.GL,rb);break;case 1529312473:Jb.a(this.$).UJ(this.Ao,2,-1,this.GL,rb);break;case 563292088:this.e3a&&e.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Jb.a(this.$).UJ(this.Ao,8,-1,this.GL,rb);break;case -1092351914:Jb.a(this.$).UJ(this.Ao,0,-1,this.GL,rb);break;case -2141589616:const $c=T.GetServiceTaskFactory.Sa(this.$.da,12,477,oc.Raa()),Fd=da.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:7118534_RemoveValueFieldSettingsDialogInnerHtml")?
T.GetServiceTaskFactory.Sa(this.$.da,498,499,oc.Raa()):ab.Task.Ta(null);return J.TaskExtensions.Aa(J.TaskExtensions.Td([$c,Fd],this.$.la),()=>{(new Uc(this.cell,this.Mo,this.externalSourceIndex,this.Ao.Name,this.$,rb,$c.result,this.isOlap,this.nV,Fd.result)).initialize()},this.la);default:return ta.a(Aa)}return ab.Task.Ta(!0)}Ac(Aa,rb,Lb){Aa=!1;switch(rb.command){case -1453503574:Aa=!!Lb;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:Aa=
!0}return Aa}BY(){const Aa=this.Ua.Up(this.menuId);this.KZi(Aa,this.Zyc,this.y1d);this.LZi(Aa,this.jTa);this.MZi(Aa);8===this.jTa&&this.IZi(Aa);return Aa}KZi(Aa,rb,Lb){const oc=this.Ua,$c=oc.Dc();rb||rb!==Lb-1?!rb&&rb<Lb-1?($c.buttons.push(oc.qb(64)),$c.buttons.push(oc.qb(61)),$c.buttons.push(oc.qb(66)),$c.buttons.push(oc.qb(63))):0<rb&&rb<Lb-1?($c.buttons.push(oc.qb(60)),$c.buttons.push(oc.qb(61)),$c.buttons.push(oc.qb(62)),$c.buttons.push(oc.qb(63))):0<rb&&rb===Lb-1&&($c.buttons.push(oc.qb(60)),
$c.buttons.push(oc.qb(65)),$c.buttons.push(oc.qb(62)),$c.buttons.push(oc.qb(67))):($c.buttons.push(oc.qb(64)),$c.buttons.push(oc.qb(65)),$c.buttons.push(oc.qb(66)),$c.buttons.push(oc.qb(67)));Aa.sc.push($c)}LZi(Aa,rb){const Lb=this.Ua,oc=Lb.Dc(),$c=1!==rb&&(!this.isOlap||this.nV||8!==rb||this.e3a),Fd=2!==rb&&(!this.isOlap||this.nV||8!==rb||this.e3a),Cd=8!==rb&&-2!==this.Ao.PivotTableIndex&&(!this.isOlap||this.nV||this.e3a);oc.buttons.push(Lb.qb(4===rb||this.Ao.IsSet||-2===this.Ao.PivotTableIndex||
this.isOlap&&!this.nV&&8===rb&&!this.e3a?72:68));8===this.Mo.AnchorType||10===this.Mo.AnchorType?(oc.buttons.push(Lb.qb($c?95:97)),oc.buttons.push(Lb.qb(Fd?96:98))):(oc.buttons.push(Lb.qb($c?69:73)),oc.buttons.push(Lb.qb(Fd?70:74)));oc.buttons.push(Lb.qb(Cd?71:75));Aa.sc.push(oc)}MZi(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(76));Aa.sc.push(rb)}IZi(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(77));Aa.sc.push(rb)}}Object(c.a)(Vc,"FieldWellContextMenu",w.a,[]);var yd=a(1213);class Sd extends ac{constructor(Aa,
rb,Lb,oc){super(Aa,"PopulatePivotContextMenu",2123758504,912277356,rb,Lb,oc)}get Lw(){return"PopulatePivotContextMenu"}get HB(){return r.a.tNf}executeCommand(Aa,rb,Lb){let oc=!1;const $c=rb.command;switch($c){case 37023044:oc=this.T$c(Lb,rb);break;case 541421805:case -569786022:oc=this.qjd(Aa,rb)}return oc?ab.Task.Ta(!0):ta.a($c)}Ac(Aa,rb,Lb){Aa=!1;switch(rb.command){case 37023044:Aa=!!Lb;break;case 541421805:case -569786022:Aa=!0}return Aa}qjd(Aa,rb){var Lb=8===Aa,oc=this.$,$c=Kb.a(oc),Fd=ka.g(oc).ha.Qa.dc;
let Cd=Aa=null;Lb&&$c?(Aa=$c.chartId,Cd=$c.Tc):!Lb&&Fd&&(Aa=Fd.floatingObject.id,Cd=Fd.floatingObject.Tc);return Sd.Vse(Cd,260)?(Lb={},oc.gk(Lb),Lb.FirstColumn=Lb.FirstRow=-1,oc={["rawEvent"]:null,["pivotName"]:null,["cell"]:Lb,["requiresConfirmation"]:Sd.Vse(Cd,64),["dataSourceIndex"]:Cd.ExternalSourceIndex},Fd?($c=Fd.floatingObject,oc.domElement=Fd.domElement,oc.objectId=$c.id,oc.objectVersion=$c.version):$c&&(oc.domElement=$c.Al,oc.objectId=$c.chartId,oc.objectVersion=$c.Vye),Fd={AnchorType:7},
Fd.ChartId=Aa,Fd.AnchorValue1=-1,Fd.AnchorValue2=-1,oc.optionalPivotMenuAnchorParameter=Fd,this.T$c(oc,rb)):!1}static Vse(Aa,rb){return(Aa.Attributes&rb)===rb}}Object(c.a)(Sd,"PivotFilterContextMenu",ac,[]);var Wd=a(1285),Hd=a(836);const le=(Aa,rb,Lb,oc,$c,Fd,Cd,$d,he,ue=null)=>{ue=Aa.Na(41,ue);ue.activeCell=rb;ue.operationType=Lb;ue.fieldCaption=oc;ue.prevFieldCaption=$c;return X.g(Aa,"ExecutePivotTableOperation",ue,Fd,Cd,$d,he,0)},Le=(Aa,rb,Lb,oc,$c,Fd,Cd,$d=null)=>{$d=Aa.Na(41,$d);$d.activeCell=
rb;$d.pivotValueFieldSettingsApplyData=Lb;return X.g(Aa,"ApplyValueFieldSettingsToPivotTable",$d,oc,$c,Fd,Cd,0)};var Md=a(147),ke=a(370),ve=a(283),ge=a(28),we=a(22);const De=r.a.u3g,ib=De+".RemoveField",Yb=De+".Subtotal",pc=De+".ClearFilter",Jc=De+".LayoutSameColumn",Xc=De+".LayoutNextColumn";class M extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulatePivotTableContextMenu",-1475408662,1114549926,De,!0,!1,"PivotTableContextMenuRootName",rb,Lb,!0,oc);this.$0d=this.activeCell=this.lc=null;this.UY=
this.refresh=this.expandCollapse=this.Nod=this.Eic=!1;this.Bab=this.ub=this.$0a=this.kA=this.ye=null;this.Eba=!1;this.WLi=$c=>{$c&&!V.a.ug($c.Errors)&&this.lc&&(this.lc.$o=$c.Result,this.pLb());this.showPivotTableContextMenu()};this.VLi=()=>{};this.KPi=()=>{this.hcb()};this.JPi=()=>{this.hcb()};this.xGi=()=>{this.hcb()};this.wGi=()=>{this.hcb()};this.my=()=>{this.uZd();this.Eba=!1};this.Tq=()=>{if(this.Eba){e.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
const $c=this.lc;this.grid.Fb.rp(this.grid.ha.sa.activeCell)!==$c&&(this.hcb(),this.Q6h())}};this.Pih=new DOMParser;this.swj=!0;this.grid=ka.g(Aa);this.plc=!0}get Lw(){return"PopulatePivotTableContextMenu"}get HB(){return r.a.uNf}executeCommand(Aa,rb,Lb){rb=rb.command;Aa=null;this.grid=ka.g(this.$);this.activeCell=I.o(this.grid.ha.sa.activeCell,this.$);if(this.$.isEditMode&&(this.lc=this.grid.Fb.rp(this.grid.ha.sa.activeCell),!this.lc))return e.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),
J.TaskExtensions.Uaa();this.$0d=this.$.pa.va;this.$0a=Object(Xb.a)(Sa.a,Lb.eventArgs);switch(rb){case 671488277:this.dyj()?this.CUh():(this.hcb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,
2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.wSa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.wSa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);
break;case 786592977:this.wSa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.wSa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.wSa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.wSa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:Lb=Number.parseInvariant(Lb.MenuItemId.split(".")[2]);this.wSa(11,Lb);this.applyValueFieldSettingsToPivotTable(-2031744961);break;
case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.fd(-1556797033,x.a.Gb,8,null);break;case 1514686611:this.Hri();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:Lb=Number.parseInvariant(Lb.MenuItemId);this.yZg(Lb);break;case 1778578888:Lb=Number.parseInvariant(Lb.MenuItemId);this.SLg(Lb);break;case 2059542618:this.performPivotTableOperation(2059542618,11);break;case 713270357:this.performPivotTableOperation(713270357,
12);break;case -1842411134:this.performPivotTableOperation(-1842411134,13);break;case 2054968064:this.performPivotTableOperation(2054968064,14);break;case 74278997:this.performPivotTableOperation(74278997,15);break;case 8572743:this.performPivotTableOperation(8572743,16);break;case 833996216:this.performPivotTableOperation(833996216,17);break;case 139202061:this.performPivotTableOperation(139202061,18);break;default:Aa=ta.a(rb)}return Aa||J.TaskExtensions.Uaa()}Ac(Aa,rb){Aa=!1;switch(rb.command){case 671488277:Aa=
Hd.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:Aa=!0;break;case 1600778266:Aa=!0;break;case -556893687:Aa=!0;break;case -1966978671:Aa=!0;break;case -1951357930:Aa=!0;break;case -1390365353:case -1457478532:Aa=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:Aa=!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:Aa=
!0;break;case -1007663920:case 234234584:case 1194992911:Aa=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:Aa=!0;break;case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Aa=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)}return Aa}dyj(){if(!this.$.isEditMode||this.lc.ygc)return!1;let Aa=this.g3f(!1);return da.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.lc.isOlap||Aa:!this.lc.vhc()||Aa}Lc(Aa,rb){let Lb=!1;switch(rb){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:case 2059542618:case 713270357:case -1842411134:case 2054968064:case 74278997:case 8572743:case 833996216:case 139202061:Lb=this.dS();break;case -1007663920:case 234234584:Lb=this.Jwj()||this.dS();break;case 1194992911:Lb=this.Kwj()||this.dS();break;
case 1217404289:Lb=!Wd.j(this.ub.LabelOrDateFilterType)||this.dS();break;case -743135194:Lb=!Wd.m(this.ub.ValueFilterType)&&!Wd.l(this.ub.ValueFilterType)||this.dS();break;case 771421327:Lb=0===this.ub.LabelOrDateFilterType&&0===this.ub.ValueFilterType&&!this.ub.HasManualFilter||this.dS();break;case 1015867427:Lb=!Wd.i(this.ub.LabelOrDateFilterType)||this.dS();break;case 1105960559:Lb=!Wd.k(this.ub.LabelOrDateFilterType)||this.dS()}return Lb||super.Lc(Aa,rb)}hcb(){this.Bab=this.ub=this.ye=null}HVd(){this.grid.sT(this.Tq);
this.$.Ka.jZa(this.my)}uZd(){this.grid.dO(this.Tq);this.$.Ka.$Ib(this.my)}pLb(){if(this.lc&&this.lc.$o){this.ye=this.lc.$o;this.ub=this.lc.Oac();if(this.T3f()){const Aa=this.lc.iL[4===this.ye.CellType?this.lc.N5c-1:this.ye.CurrentFieldIndex-1];Aa&&(this.Bab=-2===Aa.Index?this.lc.mHe:Aa.Caption)}this.C$h();this.ub&&8===this.ye.CellArea&&(this.kA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.ub.DataFieldAggregationType,this.kA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.ub.DataFieldFormatType,
this.kA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.ub.BaseFieldIndex,this.kA.PivotValueFieldTitle=this.ub.Caption)}}g3f(Aa){return this.lc?this.lc.isOlap&&!this.lc.tNa(!Aa):!1}Rwj(){const Aa=da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.ub.MeasureType&&(!this.lc.uhf||Aa&&2===this.ub.MeasureType)}BY(){const Aa=this.Ua.Up(this.menuId),rb=this.Ua.Dc(),Lb=ka.g(this.$).Vb(null);if(this.lc)this.ye&&this.lc.$o&&this.ye!==this.lc.$o&&
e.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.ub&&this.ub!==this.lc.Oac()&&e.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return Aa;this.NFh(Aa);if(this.$.isEditMode){this.refresh&&this.eHh(Aa);if(this.ye&&this.ub){var oc=this.Ua.Dc();this.sHh(oc);this.bGh(oc);Aa.sc.push(oc)}this.UY&&rb.buttons.push(this.Ua.qb(99));this.ye&&this.ub&&this.AGh(Aa);if(this.expandCollapse){oc=this.Ua.ew("ContextMenu.PivotExpandCollapse",
null,K.a.instance.ga(1166),589118293);const $c=this.Ua.Dc();$c.buttons.push(this.Ua.qb(243));$c.buttons.push(this.Ua.qb(244));$c.buttons.push(this.Ua.qb(245));$c.buttons.push(this.Ua.qb(246));oc.menu.sc.push($c);oc&&0<$c.buttons.length&&rb.buttons.push(oc)}this.ye&&(oc=this.Ua.Dc(),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",!1)&&this.LGh(oc),this.fHh(oc),0<oc.buttons.length&&Aa.sc.push(oc));this.ye&&this.ub&&8===this.ye.CellArea&&8!==this.ye.CellType&&
(oc=this.Ua.Dc(),this.Rwj()&&this.uHh(oc),3!==this.ye.CellType&&this.pHh(oc),Aa.sc.push(oc));!this.lc.vhc()&&""!==(null===Lb||void 0===Lb?void 0:Lb.text)&&this.ye&&0===this.ye.CellType&&da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.oHh(Aa);this.Wki()?rb.buttons.push(this.Ua.qb(257)):rb.buttons.push(this.Ua.qb(258));this.Nod?rb.buttons.push(this.Ua.qb(59)):rb.buttons.push(this.Ua.qb(58))}Aa.sc.push(rb);return Aa}NSa(){return this.ub&&this.ub.Caption?
20<this.ub.Caption.length:!1}vKa(Aa){return this.ub&&this.ub.Caption?Aa?this.ub.Caption.substring(0,20)+"...":this.ub.Caption:""}Dva(Aa){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?we.a.hashCode(Aa).toString():Aa}sHh(Aa){if(this.ye&&this.ub&&4!==this.ye.CellArea){var rb=this.lja(this.xH("PivotTableContextMenu.Sort",this.Dva(this.ub.Caption)),-1777747317,0,0!==this.ub.SortInfo,K.a.instance.ga(229)),Lb=this.Ua.Dc();Lb.buttons.push(this.Sd("PivotTableContextMenu.SortAscending",
-1007663920,0,1===this.ub.SortInfo,K.a.instance.ga(230)));Lb.buttons.push(this.Sd("PivotTableContextMenu.SortDescending",234234584,0,2===this.ub.SortInfo,K.a.instance.ga(231)));1!==this.ye.CellArea&&2!==this.ye.CellArea||Lb.buttons.push(this.Sd("PivotTableContextMenu.SortByValue",1194992911,0,3===this.ub.SortInfo||4===this.ub.SortInfo,K.a.instance.ga(156)));rb.menu.sc.push(Lb);rb&&0<Lb.buttons.length&&Aa.buttons.push(rb)}}bGh(Aa){if(this.ye&&this.ub&&(1===this.ye.CellArea||2===this.ye.CellArea)){var rb=
this.cyj();const Fd=this.lja(this.xH("PivotTableContextMenu.Filter",this.Dva(this.ub.Caption)),-1777747317,0,rb,K.a.instance.ga(656)),Cd=this.Ua.Dc();var Lb="",oc=this.NSa(),$c=String.format(K.a.instance.mb(156),this.vKa(oc));oc&&(Lb=String.format(K.a.instance.mb(156),this.ub.Caption));rb=this.Dva(this.ub.Caption)+"."+(rb?"enabled":"disabled");Lb=this.Sd(this.xH(pc,rb),771421327,0,!1,$c,"0",Lb,8,ma.a.R2a);rb=this.Dva(this.ub.Caption)+"."+this.ub.LabelOrDateFilterType.toString();this.ub.IsDateField?
($c=this.lja(this.xH("PivotTableContextMenu.DateFilter",rb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,K.a.instance.ga(97)),this.QFh($c.menu)):($c=this.lja(this.xH("PivotTableContextMenu.LabelFilter",rb),-1777747317,0,0!==this.ub.LabelOrDateFilterType,K.a.instance.ga(654)),this.zGh($c.menu));rb=this.Dva(this.ub.Caption)+"."+this.ub.ValueFilterType.toString();rb=this.lja(this.xH("PivotTableContextMenu.ValueFilter",rb),-1777747317,0,0!==this.ub.ValueFilterType,K.a.instance.ga(655));this.GHh(rb.menu);
oc=this.Ua.Dc();oc.buttons.push(this.Sd("PivotTableContextMenu.ManualFilter",1514686611,0,this.ub.HasManualFilter,K.a.instance.ga(94)));Cd.buttons.push(Lb);Cd.buttons.push($c);Cd.buttons.push(rb);Fd.menu.sc.push(Cd);Fd.menu.sc.push(oc);Fd&&0<Cd.buttons.length&&Aa.buttons.push(Fd)}}QFh(Aa){Aa.sc.push(this.jbc(!0,!1));Aa.sc.push(this.ZMh());Aa.sc.push(this.YMh());Aa.sc.push(this.OOh());Aa.sc.push(this.ROh());Aa.sc.push(this.POh());Aa.sc.push(this.QOh());Aa.sc.push(this.SOh());Aa.sc.push(this.TOh());
Aa.sc.push(this.MMh())}FFh(Aa){Aa.sc.push(this.jbc(!0,!0));Aa.sc.push(this.zVh());Aa.sc.push(this.NSh())}zGh(Aa){Aa.sc.push(this.jbc(!0,!1));Aa.sc.push(this.QZe(!0));Aa.sc.push(this.sJh());Aa.sc.push(this.WLh());Aa.sc.push(this.PYe(!0));Aa.sc.push(this.UXe(!0))}GHh(Aa){Aa.sc.push(this.jbc(!1,!1));Aa.sc.push(this.QZe(!1));Aa.sc.push(this.PYe(!1));Aa.sc.push(this.UXe(!1));Aa.sc.push(this.TZh())}TZh(){const Aa=this.Ua.Dc();Aa.buttons.push(this.Sd("PivotTableContextMenu.Top10",-1611233597,0,Wd.l(this.ub.ValueFilterType),
K.a.instance.ga(105)));return Aa}WLh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.Contains",786260386,0,10===this.ub.LabelOrDateFilterType,K.a.instance.ga(657),"10")),Aa.buttons.push(this.Sd("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.ub.LabelOrDateFilterType,K.a.instance.ga(658),"11")));return Aa}sJh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.BeginsWith",786260386,0,6===this.ub.LabelOrDateFilterType,K.a.instance.ga(659),
"6")),Aa.buttons.push(this.Sd("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.ub.LabelOrDateFilterType,K.a.instance.ga(660),"7")),Aa.buttons.push(this.Sd("PivotTableContextMenu.EndsWith",786260386,0,8===this.ub.LabelOrDateFilterType,K.a.instance.ga(661),"8")),Aa.buttons.push(this.Sd("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.ub.LabelOrDateFilterType,K.a.instance.ga(662),"9")));return Aa}QZe(Aa){const rb=this.Ua.Dc();if(this.ub){const Lb=Aa?Wd.c:Wd.f;rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.Equals",
Lb),786260386,0,Aa?4===this.ub.LabelOrDateFilterType:18===this.ub.ValueFilterType,K.a.instance.ga(100),Aa?"4":"18"));rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.DoesNotEqual",Lb),786260386,0,Aa?5===this.ub.LabelOrDateFilterType:19===this.ub.ValueFilterType,K.a.instance.ga(101),Aa?"5":"19"))}return rb}PYe(Aa){const rb=this.Ua.Dc();if(this.ub){const Lb=Aa?Wd.c:Wd.f;rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.GreaterThan",Lb),786260386,0,Aa?12===this.ub.LabelOrDateFilterType:20===
this.ub.ValueFilterType,K.a.instance.ga(102),Aa?"12":"20"));rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.GreaterThanOrEqualTo",Lb),786260386,0,Aa?13===this.ub.LabelOrDateFilterType:21===this.ub.ValueFilterType,K.a.instance.ga(663),Aa?"13":"21"));rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.LessThan",Lb),786260386,0,Aa?14===this.ub.LabelOrDateFilterType:22===this.ub.ValueFilterType,K.a.instance.ga(103),Aa?"14":"22"));rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.LessThanOrEqualTo",
Lb),786260386,0,Aa?15===this.ub.LabelOrDateFilterType:23===this.ub.ValueFilterType,K.a.instance.ga(664),Aa?"15":"23"))}return rb}UXe(Aa){const rb=this.Ua.Dc();if(this.ub){const Lb=Aa?Wd.c:Wd.f;rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.Between",Lb),786260386,0,Aa?16===this.ub.LabelOrDateFilterType:24===this.ub.ValueFilterType,K.a.instance.ga(104),Aa?"16":"24"));rb.buttons.push(this.Sd(this.xH("PivotTableContextMenu.NotBetween",Lb),786260386,0,Aa?17===this.ub.LabelOrDateFilterType:25===
this.ub.ValueFilterType,K.a.instance.ga(665),Aa?"17":"25"))}return rb}jbc(Aa,rb){const Lb=this.Ua.Dc();if(this.ub){var oc=K.a.instance.ga(98);const Fd=Aa?this.ub.LabelOrDateFilterType.toString():this.ub.ValueFilterType.toString();var $c=["PivotTableContextMenu.ClearFilter",this.Dva(this.ub.Caption),Fd];Aa=Aa?this.ub.IsDateField?rb?1015867427:1105960559:1217404289:-743135194;$c.push(Aa.toString());$c=$c.join(".");oc=this.Sd($c,Aa,0,!1,oc,Fd,oc,8,ma.a.R2a);Lb.buttons.push(oc)}return Lb}ZMh(){const Aa=
this.Ua.Dc();this.ub&&Aa.buttons.push(this.Sd(this.xH("PivotTableContextMenu.Equals",Wd.d),786260386,0,26===this.ub.LabelOrDateFilterType,K.a.instance.ga(100),"26"));return Aa}YMh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.Before",786260386,0,27===this.ub.LabelOrDateFilterType,K.a.instance.ga(112),"27")),Aa.buttons.push(this.Sd("PivotTableContextMenu.After",786260386,0,28===this.ub.LabelOrDateFilterType,K.a.instance.ga(113),"28")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Between",
786260386,0,29===this.ub.LabelOrDateFilterType,K.a.instance.ga(104),"29")));return Aa}OOh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.ub.LabelOrDateFilterType,K.a.instance.ga(110),"30")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Today",1778578888,0,31===this.ub.LabelOrDateFilterType,K.a.instance.ga(109),"31")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Yesterday",1778578888,0,32===this.ub.LabelOrDateFilterType,K.a.instance.ga(111),
"32")));return Aa}ROh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.NextWeek",1778578888,0,33===this.ub.LabelOrDateFilterType,K.a.instance.ga(115),"33")),Aa.buttons.push(this.Sd("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.ub.LabelOrDateFilterType,K.a.instance.ga(114),"34")),Aa.buttons.push(this.Sd("PivotTableContextMenu.LastWeek",1778578888,0,35===this.ub.LabelOrDateFilterType,K.a.instance.ga(116),"35")));return Aa}POh(){const Aa=this.Ua.Dc();this.ub&&
(Aa.buttons.push(this.Sd("PivotTableContextMenu.NextMonth",1778578888,0,36===this.ub.LabelOrDateFilterType,K.a.instance.ga(117),"36")),Aa.buttons.push(this.Sd("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.ub.LabelOrDateFilterType,K.a.instance.ga(118),"37")),Aa.buttons.push(this.Sd("PivotTableContextMenu.LastMonth",1778578888,0,38===this.ub.LabelOrDateFilterType,K.a.instance.ga(119),"38")));return Aa}QOh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.NextQuarter",
1778578888,0,39===this.ub.LabelOrDateFilterType,K.a.instance.ga(120),"39")),Aa.buttons.push(this.Sd("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.ub.LabelOrDateFilterType,K.a.instance.ga(121),"40")),Aa.buttons.push(this.Sd("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.ub.LabelOrDateFilterType,K.a.instance.ga(122),"41")));return Aa}SOh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.NextYear",1778578888,0,42===this.ub.LabelOrDateFilterType,
K.a.instance.ga(123),"42")),Aa.buttons.push(this.Sd("PivotTableContextMenu.ThisYear",1778578888,0,43===this.ub.LabelOrDateFilterType,K.a.instance.ga(124),"43")),Aa.buttons.push(this.Sd("PivotTableContextMenu.LastYear",1778578888,0,44===this.ub.LabelOrDateFilterType,K.a.instance.ga(125),"44")));return Aa}TOh(){const Aa=this.Ua.Dc();if(this.ub){Aa.buttons.push(this.Sd("PivotTableContextMenu.YearToDate",1778578888,0,45===this.ub.LabelOrDateFilterType,K.a.instance.ga(126),"45"));const rb=this.lja("PivotTableContextMenu.AllDatesInThePeriod",
1778578888,0,Wd.i(this.ub.LabelOrDateFilterType),K.a.instance.ga(127));this.FFh(rb.menu);Aa.buttons.push(rb)}return Aa}MMh(){const Aa=this.Ua.Dc();this.ub&&Aa.buttons.push(this.Sd("PivotTableContextMenu.CustomFilter",786260386,0,this.$xj(this.ub.LabelOrDateFilterType),K.a.instance.ga(108),"26"));return Aa}zVh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.Quarter1",1778578888,0,46===this.ub.LabelOrDateFilterType,K.a.instance.ga(128),"46")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.ub.LabelOrDateFilterType,K.a.instance.ga(129),"47")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Quarter3",1778578888,0,48===this.ub.LabelOrDateFilterType,K.a.instance.ga(130),"48")),Aa.buttons.push(this.Sd("PivotTableContextMenu.Quarter4",1778578888,0,49===this.ub.LabelOrDateFilterType,K.a.instance.ga(131),"49")));return Aa}NSh(){const Aa=this.Ua.Dc();this.ub&&(Aa.buttons.push(this.Sd("PivotTableContextMenu.January",1778578888,0,50===this.ub.LabelOrDateFilterType,K.a.instance.ga(132),
"50")),Aa.buttons.push(this.Sd("PivotTableContextMenu.February",1778578888,0,51===this.ub.LabelOrDateFilterType,K.a.instance.ga(133),"51")),Aa.buttons.push(this.Sd("PivotTableContextMenu.March",1778578888,0,52===this.ub.LabelOrDateFilterType,K.a.instance.ga(134),"52")),Aa.buttons.push(this.Sd("PivotTableContextMenu.April",1778578888,0,53===this.ub.LabelOrDateFilterType,K.a.instance.ga(135),"53")),Aa.buttons.push(this.Sd("PivotTableContextMenu.May",1778578888,0,54===this.ub.LabelOrDateFilterType,K.a.instance.ga(136),
"54")),Aa.buttons.push(this.Sd("PivotTableContextMenu.June",1778578888,0,55===this.ub.LabelOrDateFilterType,K.a.instance.ga(137),"55")),Aa.buttons.push(this.Sd("PivotTableContextMenu.July",1778578888,0,56===this.ub.LabelOrDateFilterType,K.a.instance.ga(138),"56")),Aa.buttons.push(this.Sd("PivotTableContextMenu.August",1778578888,0,57===this.ub.LabelOrDateFilterType,K.a.instance.ga(139),"57")),Aa.buttons.push(this.Sd("PivotTableContextMenu.September",1778578888,0,58===this.ub.LabelOrDateFilterType,
K.a.instance.ga(140),"58")),Aa.buttons.push(this.Sd("PivotTableContextMenu.October",1778578888,0,59===this.ub.LabelOrDateFilterType,K.a.instance.ga(141),"59")),Aa.buttons.push(this.Sd("PivotTableContextMenu.November",1778578888,0,60===this.ub.LabelOrDateFilterType,K.a.instance.ga(142),"60")),Aa.buttons.push(this.Sd("PivotTableContextMenu.December",1778578888,0,61===this.ub.LabelOrDateFilterType,K.a.instance.ga(143),"61")));return Aa}AGh(Aa){const rb=this.Ua.Dc();if(this.T3f()){var Lb=this.lc.iL[4===
this.ye.CellType?this.lc.N5c-1:this.ye.CurrentFieldIndex-1];if(Lb&&this.Bab){var oc=this.Ua.ew("ContextMenu.PivotTableLayout",null,K.a.instance.ga(652),-1777747317);var $c=this.Ua.Dc();const Fd=String.format(K.a.instance.mb(169),this.Bab),Cd=String.format(K.a.instance.mb(170),this.Bab);$c.buttons.push(this.Sd(Xc,-1457478532,0,!Lb.IsCompactLayout,Fd));$c.buttons.push(this.Sd(Jc,-1390365353,0,Lb.IsCompactLayout,Cd));oc.menu.sc.push($c);oc&&rb.buttons.push(oc)}}if(1===this.ye.CellArea||2===this.ye.CellArea)this.ub.Caption&&
(Lb="",$c=this.NSa(),oc=String.format(K.a.instance.mb(159),this.vKa($c)),$c&&(Lb=String.format(K.a.instance.mb(159),this.ub.Caption)),1===this.ye.CellArea?(Lb=this.lja("ContextMenu.PivotTableSubtotal",1801458190,0,this.ub.ShowSubtotal,oc),oc=this.Ua.Dc(),oc.buttons.push(this.Ua.qb(259)),oc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnTop",671485366,644,this.ub.ShowSubtotal&&this.ub.ShowSubtotalAtTop)),oc.buttons.push(this.Sd("ContextMenu.PivotTableSubtotalOnBottom",772221736,645,this.ub.ShowSubtotal&&
!this.ub.ShowSubtotalAtTop)),Lb.menu.sc.push(oc),Lb&&0<oc.buttons.length&&rb.buttons.push(Lb)):($c=$c?this.xH(Yb,this.Dva(oc)):Yb,rb.buttons.push(this.Sd($c,1801458190,0,this.ub.ShowSubtotal,oc,null,Lb)))),rb.buttons.push(this.Sd("ContextMenu.RepeatItemLabels",-556893687,647,this.ub.RepeatItemLabels));1===this.ye.CellArea&&rb.buttons.push(this.Sd("ContextMenu.PivotBlankLineAfterEachItem",1600778266,646,this.ub.ShowBlankLineAfterEachItem));Aa.sc.push(rb)}oHh(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(247));
Aa.sc.push(rb)}LGh(Aa){if(this.$.isEditMode&&this.grid){var rb=this.grid.ha.sa.activeRange;if(rb.top===rb.bottom&&rb.left===rb.right&&0!==this.ye.MoveItemsMenuState){rb=this.lja("PivotTableContextMenu.Move",-1777747317,0,!1,K.a.instance.ga(73));var Lb=this.Ua.Dc();this.cva(Lb,"PivotTableContextMenu.MoveToBeginning",2059542618,String.format(K.a.instance.mb(162),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&1));this.cva(Lb,"PivotTableContextMenu.MoveUp",713270357,String.format(K.a.instance.mb(163),
this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&2));this.cva(Lb,"PivotTableContextMenu.MoveDown",-1842411134,String.format(K.a.instance.mb(160),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&4));this.cva(Lb,"PivotTableContextMenu.MoveToEnd",2054968064,String.format(K.a.instance.mb(161),this.ye.MoveItemName),0===(this.ye.MoveItemsMenuState&8));rb.menu.sc.push(Lb);Lb=this.Ua.Dc();this.cva(Lb,"PivotTableContextMenu.MoveDataItemTop",74278997,String.format(K.a.instance.mb(167),this.vKa(this.NSa())),
0===(this.ye.MoveItemsMenuState&16));this.cva(Lb,"PivotTableContextMenu.MoveDataItemUp",8572743,String.format(K.a.instance.mb(164),this.vKa(this.NSa())),0===(this.ye.MoveItemsMenuState&32));this.cva(Lb,"PivotTableContextMenu.MoveDataItemDown",833996216,String.format(K.a.instance.mb(165),this.vKa(this.NSa())),0===(this.ye.MoveItemsMenuState&64));this.cva(Lb,"PivotTableContextMenu.MoveDataItemBottom",139202061,String.format(K.a.instance.mb(166),this.vKa(this.NSa())),0===(this.ye.MoveItemsMenuState&
128));rb.menu.sc.push(Lb);Aa.buttons.push(rb)}}}fHh(Aa){var rb="";let Lb="";var oc=!1;3===this.ye.CellType?rb=K.a.instance.ga(649):8===this.ye.CellType?this.lc&&(rb=String.format(K.a.instance.mb(168),this.lc.mHe)):this.ub&&((oc=this.NSa())&&(Lb=String.format(K.a.instance.mb(168),this.ub.Caption)),rb=String.format(K.a.instance.mb(168),this.vKa(oc)));rb&&(oc=oc?this.xH(ib,this.Dva(rb)):ib,rb=this.Sd(oc,-1951357930,0,!1,rb,null,Lb,8,ma.a.q$c),Aa.buttons.push(rb))}NFh(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(43));
this.ub&&this.ye&&this.$.isEditMode&&(0===this.ye.CellType||4===this.ye.CellType)&&rb.buttons.push(this.Ua.qb(136));Aa.sc.push(rb)}eHh(Aa){const rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(100));Aa.sc.push(rb)}uHh(Aa){const rb=2===this.ub.MeasureType&&!this.ub.IsNumeric,Lb=this.Ua.ew("ContextMenu.SummarizeValuesBy",null,K.a.instance.ga(650),-249874296),oc=this.Ua.Dc();oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesBySum",-1255320719,1105,0===this.ub.DataFieldAggregationType,void 0,void 0,void 0,
void 0,void 0,rb));oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCount",1746132849,1106,1===this.ub.DataFieldAggregationType));oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByAverage",-771066011,1107,2===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,rb));oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMax",835007294,1108,3===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,rb));oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByMin",
929115636,1109,4===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,rb));oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByProduct",1935475057,1110,5===this.ub.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.g3f(!0)||rb));2!==this.ub.MeasureType&&(oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1111,6===this.ub.DataFieldAggregationType)),oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviation",588680636,1112,7===this.ub.DataFieldAggregationType)),
oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1113,8===this.ub.DataFieldAggregationType)),oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariant",1668427539,1114,9===this.ub.DataFieldAggregationType)),oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1115,10===this.ub.DataFieldAggregationType)));this.lc&&this.lc.vhc()&&oc.buttons.push(this.Sd("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1116,11===this.ub.DataFieldAggregationType));
Lb.menu.sc.push(oc);Aa.buttons.push(Lb)}pHh(Aa){const rb=this.Ua.ew("ContextMenu.ShowValuesAs",null,K.a.instance.ga(651),-1128612833),Lb=this.Ua.Dc();Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsNoCalculation",-841863025,1122,0===this.ub.DataFieldFormatType));Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1129,7===this.ub.DataFieldFormatType));Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1128,6===this.ub.DataFieldFormatType));
Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1127,5===this.ub.DataFieldFormatType));Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1132,9===this.ub.DataFieldFormatType));Lb.buttons.push(this.Sd("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1133,10===this.ub.DataFieldFormatType));if(this.lc&&this.lc.iL&&0<this.lc.iL.length||this.lc.z$&&0<this.lc.z$.length){const oc=this.lja("ContextMenu.ShowValuesAsPercentOfParentTotal",
-1128612833,1134,11===this.ub.DataFieldFormatType),$c=this.Ua.Dc(),Fd=this.tHh();for(let Cd=0;Cd<Fd.length;Cd++){const $d=Fd[Cd];$c.buttons.push(this.Sd("ContextMenu.ShowValuesAsPercentOfParentTotal."+$d.Caption,-2031744961,1134,11===this.ub.DataFieldFormatType&&this.ub.BaseFieldIndex===$d.Index,$d.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+$d.Index))}oc.menu.sc.push($c);Lb.buttons.push(oc)}rb.menu.sc.push(Lb);Aa.buttons.push(rb)}showPivotTableContextMenu(){this.Nod=!0;this.expandCollapse=
this.UY=this.refresh=!1;var Aa=this.$,rb=ka.g(Aa),Lb=jc.a(Aa).NKa();if(Lb){var oc=Jb.a(Aa);if(null===oc||void 0===oc?0:oc.dSd)this.Nod=Ob.f(Aa.sg);oc=Aa.jc;this.UY=Lb.supportsBIExplore&&!!jb.a(Aa)&&oc.v2(32768);oc.allowInteractivity&&(Aa=rb.Vb(null),(null===Aa||void 0===Aa?0:Aa.cell)&&(Aa.cell.f_c||Aa.cell.Q3f)&&(this.expandCollapse=!0),oc.allowManualDataRefresh&&(this.refresh=!0))}Aa=null;Lb=1;this.$0a&&1!==this.$0a.tb?(Aa=new Sys.UI.Point(this.$0a.clientPoint.x,this.$0a.clientPoint.y),Lb=this.$0a.tb):
(rb=Hd.e(rb,this.$))&&(Aa=new Sys.UI.Point(rb.x+(this.$.isChromeRtl?0:rb.width),rb.y+rb.height));x.a.Gb=Lb;this.Eic=3===Lb;this.Jp(Aa,!0,Lb);this.Eba=!0;this.HVd()}Q6h(){const Aa=new R.a(1114549926,0,this.$.Kc,19,null);this.$.Ka.Lb(Aa)}CUh(){if(this.lc&&this.lc.$o){var Aa=this.lc.$o.CurrentCol;if(this.lc.$o.CurrentRow===this.activeCell.FirstRow&&Aa===this.activeCell.FirstColumn){this.pLb();this.showPivotTableContextMenu();return}}Aa=new U.a(228,0,(rb,Lb,oc)=>ve.j(this.$.pa.va,this.activeCell,P.b(rb,
this.WLi),P.a(Lb,this.VLi),oc,null),16);this.$.userOperationManager.Wb(Aa,null)}Wki(){if(nb.a.od(this.$)){var Aa=this.$.da.za(441);if(Aa)return Aa.$r}else if(Aa=this.$.da.za(346))return Aa.$r;return!1}xH(Aa,rb){return Aa+"."+rb}performPivotTableOperation(Aa,rb){const Lb=ge.a.Pa.zb;if(!this.lc||!this.ub&&this.ye&&3!==this.ye.CellType)this.uj();else{var oc=this.lc.isOlap;jc.a(this.$).Ex(oc,$c=>{$c&&this.$.Wb(Aa,(Fd,Cd,$d)=>le(this.$0d,this.activeCell,rb,this.ub?this.ub.Caption:null,this.Bab,P.b(Fd,
this.KPi),P.a(Cd,this.JPi),$d,null,this.$.pa.va.Tb()),Lb,0,4,229)})}}applyValueFieldSettingsToPivotTable(Aa,rb=!1){const Lb=ge.a.Pa.zb;this.lc&&this.ub?(rb&&2===this.ub.MeasureType&&e.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),rb=this.lc.isOlap,jc.a(this.$).Ex(rb,oc=>{oc&&this.$.Wb(Aa,($c,Fd,Cd)=>Le(this.$0d,this.activeCell,this.kA,P.b($c,this.xGi),P.a(Fd,this.wGi),Cd,null,this.$.pa.va.Tb()),Lb,0,4,231)})):this.uj()}Sd(Aa,rb,Lb,
oc,$c=null,Fd=null,Cd=null,$d=8,he=null,ue=!1){oc&&(Aa+=".Checked");ue&&(Aa+=".Disabled");this.Ua.ynd(Aa)&&this.Ua.AJd(Aa);Lb=$c||K.a.instance.ga(Lb);Aa=this.Ua.SHa(Aa,Lb,rb,null,"None",Fd,ue,null);Aa.Bwc(null);Cd&&Aa.$R(Cd);oc?Aa.bS("Image16by16",3,ma.a.haa):he?Aa.bS("Image16by16",$d,he):Aa.N2b();return Aa}lja(Aa,rb,Lb,oc,$c=null){Lb=$c||K.a.instance.ga(Lb);this.Ua.ynd(Aa)?this.Ua.AJd(Aa):this.Ua.AJd(Aa+".Checked");oc&&(Aa+=".Checked");this.swj&&(Lb=this.Pih.parseFromString(Lb,"text/html").body.innerText);
Aa=this.Ua.U3c(Aa,null,Lb,rb,3,ma.a.haa);Aa.R$e=oc;!oc&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&Aa.N2b();return Aa}C$h(){this.kA=Object(f.a)(new Oc,{PivotValueFieldSummarizeValueByApplyData:Object(f.a)(new zc,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object(f.a)(new fd,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})}wSa(Aa,rb){this.kA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=
Aa;this.kA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=rb;this.kA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1}tHh(){const Aa=[];if(this.lc&&this.lc.z$&&0<this.lc.z$.length)for(const rb of this.lc.z$)rb&&Aa.push(rb);if(this.lc&&this.lc.iL&&0<this.lc.iL.length)for(const rb of this.lc.iL)rb&&Aa.push(rb);Aa.sort((rb,Lb)=>rb.Index-Lb.Index);return Aa}T3f(){if(!this.ye||!this.lc||!this.lc.iL)return!1;const Aa=1===this.ye.CellArea||4===this.ye.CellType&&this.ye.IsRowAxis,rb=4===this.ye.CellType?
0<this.lc.N5c:0<this.ye.CurrentFieldIndex;return 1<this.lc.iL.length&&Aa&&rb}xKa(Aa){const rb=[];3===Aa?this.$.isEditMode?rb.push(...[yb.a.pIf,yb.a.rIf,yb.a.tYi]):rb.push(...[yb.a.copy]):2===Aa&&rb.push(yb.a.vye);return rb}uj(){const Aa=V.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");Ub.a(this.$).uj(Aa)}cyj(){return this.ub?0!==this.ub.LabelOrDateFilterType||0!==this.ub.ValueFilterType||this.ub.HasManualFilter:!1}$xj(Aa){return 62<=Aa&&65>=Aa}Hri(){if(this.activeCell&&this.ub&&
this.lc){var Aa={};Aa.cell=this.activeCell;Aa.dataSourceIndex=this.lc.externalSourceIndex;Aa.fieldId=this.ub.Index.toString();Aa.isOlap=this.lc.isOlap;Aa.confirmationRequired=this.lc.confirmationRequiredForDataOps;var rb={};rb.showPivotFilterDialogCommandData=Aa;this.$.fd(492140419,x.a.Gb,19,rb)}}yZg(Aa){this.activeCell&&this.ub&&this.lc&&this.$.userOperationManager.Wb(new U.a(153,0,(rb,Lb,oc)=>X.A(this.$.pa.va,this.activeCell,this.lc.externalSourceIndex,this.ub.Index.toString(),Aa,rb,Lb,oc,null,
null)),null)}SLg(Aa){!(30>Aa||61<Aa)&&this.activeCell&&this.ub&&this.lc&&this.$.userOperationManager.Wb(new U.a(152,0,(rb,Lb,oc)=>X.e(this.$.pa.va,this.activeCell,this.lc.externalSourceIndex,this.ub.Index.toString(),Aa,rb,Lb,oc,null,null)),null)}applyPivotSort(Aa){if(this.lc&&this.ub&&this.activeCell&&this.ye){var rb=1===this.ye.CellArea||2===this.ye.CellArea;8===this.ye.CellArea?ke.a(this.$.userOperationManager,(Lb,oc,$c)=>ve.b(this.$.pa.va,this.activeCell,Aa,this.ub.Caption,Lb,oc,$c,null),Lb=>new U.a(1015,
0,Lb,void 0,null),null):rb&&(rb=1===this.ye.CellArea?1:2,this.$.ma(688)?Md.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.lc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.lc.isOlap?"":this.ub.Caption,rb,1===Aa):Md.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.lc.externalSourceIndex,this.ub.Index.toString(),1===Aa))}}dS(){return!this.lc||!this.lc.isActionable}Jwj(){return(this.ye||this.lc)&&4!==this.ye.CellType&&
(0!==this.ye.CellType||8!==this.ye.CellArea||this.lc.z$&&this.lc.z$.length||this.lc.iL&&this.lc.iL.length)?!1:!0}Kwj(){return this.ye&&this.lc&&(1===this.ye.CellArea||2===this.ye.CellArea)&&this.lc.WPb&&this.lc.WPb.length?!1:!0}cva(Aa,rb,Lb,oc,$c){Aa.buttons.push(this.Sd(rb,Lb,0,!1,oc,null,null,8,null,$c))}}Object(c.a)(M,"PivotTableContextMenu",w.a,[]);class $a{compare(Aa,rb){return(Aa||"").localeCompare(rb||"",void 0,{numeric:!0,sensitivity:"accent"})}}Object(c.a)($a,"DigitsAsNumberComparer",null,
[437]);var ob=a(1081),Tb=a(153),Dc=a(343),ad=a(262),ld=a(24),md=a(172);const Wb=r.a.w3g;class Nc extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Wb,!0,!1,"TableFieldListContextMenuRoot",rb,Lb,!1,oc);this.v5b=null;this.Fzd=0;this.NEa=null;this.grid=ka.g(Aa)}get Lw(){return"PopulateTableFieldListContextMenu"}get HB(){return r.a.wNf}get YK(){this.NEa||(this.NEa=this.$.da.za(261));return this.NEa}executeCommand(Aa,rb,Lb){Aa=rb.command;switch(Aa){case 639960842:this.applyTableFieldList(Lb);
this.YK.uda();break;case -1085236154:e.ULS.sendTraceTag(537166999,0,50,`TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, ${this.Fzd}`);this.YK.uda();break;case 1833782813:this.YK.showCallout();break;default:return ta.a(Aa)}return ab.Task.Ta(!0)}applyTableFieldList(Aa){var rb=Aa.MenuItemId.toString();da.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(rb=rb.replace("'","''"),rb=rb.replace("[","'["),rb=rb.replace("]","']"));var Lb=
Object(Xb.a)(String,Aa.SourceControlId);const oc={};oc.PulloutField=rb;oc.PulloutCardPath=Aa.SourceCardKeyPath;oc.PulloutCardSourceRow=Aa.SourceCardRow;oc.PulloutCardSourceColumn=Aa.SourceCardColumn;if(this.YK.qN){e.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");oc.ParameterType=2;Aa=Aa.ColumnIndex;if(void 0===Aa||null===Aa){if(void 0===Lb||null===Lb){e.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}Aa=0<=this.YK.vLf?this.YK.vLf:parseInt(Lb.substring(20+rb.length+1,Lb.length),10);if(isNaN(Aa)){e.ULS.shipAssertTag(537166997,0,!1,`TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, ${Lb}`);return}}oc.PulloutRichColumnSourceIndex=Aa;if(this.NEa.tJg){this.fKg(rb,oc);return}}else e.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),oc.ParameterType=4,Lb=this.YK.selectedRange.right,nb.a.mzb()&&this.NEa.Uwa&&(oc.ParameterType=8,Aa=this.YK.Hla.top,Aa=
ld.Range.QP(Lb)+Aa,rb==ob.d?(rb="=DAYS("+Aa+", TODAY())",md.a("DateFormulaPulledOut_DaysFromToday")):rb==ob.g?(rb="=IF(TODAY() < "+Aa+", DATEDIF(TODAY(), "+Aa+', "Y"), DATEDIF('+Aa+', TODAY(), "Y"))',md.a("DateFormulaPulledOut_YearsFromToday")):rb==ob.c?(rb="=TEXT("+Aa+', "dddd")',md.a("DateFormulaPulledOut_DayOfWeek")):rb==ob.f?(rb="=TEXT("+Aa+', "mmmm")',md.a("DateFormulaPulledOut_MonthOfYear")):rb==ob.e?(rb="EOMONTH("+Aa+", 0)",rb="=DATE(YEAR("+rb+"), MONTH("+rb+"), DAY("+rb+"))",md.a("DateFormulaPulledOut_EndOfMonth")):
rb==ob.b&&(rb="="+Aa+" + 1",md.a("DateFormulaPulledOut_AddOneDay"))),void 0!==oc.PulloutCardSourceColumn&&null!==oc.PulloutCardSourceColumn&&(Lb=oc.PulloutCardSourceColumn+1),oc.PulloutRichColumnSourceIndex=Lb;this.NPd(rb,oc)}NPd(Aa,rb,Lb=0){e.ULS.sendTraceTag(537166996,0,50,`TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, ${this.Fzd}, SelectedColumnIndex, ${rb.PulloutRichColumnSourceIndex}`);Aa=Object(f.a)(new ad.a,{Text:Aa});this.grid.setCell(Aa,this.YK.Hla,0,127,rb,Lb);this.grid.focus();
this.v5b=null;this.YK.uda();this.YK.xgj()}Ac(Aa,rb,Lb){if(Aa=this.$.isEditMode&&da.EwaSettings.ma(135)&&!!this.YK)switch(rb.command){case -1085236154:break;case 639960842:Aa=!!Lb;break;case 1833782813:Aa=this.YK.Kwa&&this.YK.YBb;break;default:Aa=!1}return Aa}A0(Aa,rb,Lb){this.$.isEditMode&&(this.v5b=this.GGh(Object(Xb.a)(403,Lb)),super.A0(Aa,rb,null,null,!1))}BY(){return this.v5b}T3c(Aa){if(!this.YK||!Aa||!Aa.Xk)return e.ULS.shipAssertTag(537166994,0,!!this.YK,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),
e.ULS.shipAssertTag(537166993,0,!!Aa,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),Aa&&e.ULS.shipAssertTag(537166992,0,!!Aa.Xk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;let rb=new Ca.a;for(const oc of Aa.Xk){Aa=new Ca.a;Aa.add(oc.ColumnName);Aa.add(oc.ColumnIndex.toString());let $c=new Ca.a;var Lb=null;nb.a.mzb()&&this.NEa.Uwa?$c=Oa.toList(Oa.select(Oa.asEnumerable(oc.FieldInfoDataList),Fd=>Fd.Name)):(Lb=
da.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new $a:new oa.a,$c=Oa.OBc(Oa.concat($c,Oa.select(Oa.asEnumerable(oc.FieldInfoDataList),Fd=>Fd.Name)),Fd=>Fd,Lb));Lb=new Ca.a;Lb.add(Oa.toArray(Oa.concat(Aa,$c)));rb=Oa.toList(Oa.concat(rb,Lb))}return Oa.toArray(rb)}GGh(Aa){var rb=this.T3c(Aa);if(!rb||!rb.length)return this.v5b=null;Aa=this.Ua;const Lb=Aa.Up(this.menuId);let oc=Aa.Dc();const $c=1<rb.length,Fd=nb.a.mzb()&&this.NEa.Uwa;this.Fzd=rb.length;
for(const Cd of rb){Fd?oc.title="Calculate Date Information":$c||(oc.title=Cd[0]);rb=Aa.Dc();for(let $d=2,he=Cd.length;$d<he;++$d)!Fd||Cd[$d]!=ob.d&&Cd[$d]!=ob.e||(Lb.sc.push(oc),oc=Aa.Dc()),($c?rb.buttons:oc.buttons).push(Aa.SHa("ApplyTableFieldList."+Cd[$d]+"."+Cd[1],Cd[$d],639960842,null,"None",Cd[$d],!1,void 0,!0));if($c){const $d=Aa.ew("ApplyTableFieldList."+Cd[0],this.menuId,Cd[0],798637440);$d.menu.sc.push(rb);oc.buttons.push($d)}}Lb.sc.push(oc);return Lb}fKg(Aa,rb){const Lb=V.a.Yc(12,1,0,
904,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(da.EwaSettings.Dz()){const oc=new Dc.a(this.$,Lb);oc.rP(()=>{2===oc.returnValue&&this.NPd(Aa,rb,8)})}else{const oc=new Tb.ErrorDialog(this.$,Lb);oc.rP(()=>{2===oc.returnValue&&this.NPd(Aa,rb,8)});oc.ig()}}}Object(c.a)(Nc,"PulloutFieldListContextMenu",w.a,[]);const gd=r.a.yNf;class Gd extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateRichTextContextMenu",679816325,1151222423,gd,!0,!1,gd,rb,Lb,!0,oc);this.grid=ka.g(Aa)}get Lw(){return"PopulateRichTextContextMenu"}get HB(){return r.a.yNf}Ac(Aa,
rb,Lb){return-1687037502===rb.command&&!!Lb&&this.grid.eb}executeCommand(Aa,rb,Lb){this.showRichTextFloatie(Lb);return ab.Task.Ta(!0)}xKa(){return[yb.a.bXg]}showRichTextFloatie(Aa){var rb=Object(Xb.a)(Sa.a,Aa.eventArgs);rb&&(Aa=this.xKa(rb.tb),rb=new Sys.UI.Point(rb.Ca.clientX,rb.Ca.clientY),this.showFloatie(Aa,new Sys.UI.Bounds(rb.x,rb.y,0,0),2))}}Object(c.a)(Gd,"RichTextContextMenu",w.a,[]);var Zd=a(100),xe=a(576);const Re=r.a.v3g;class Ue extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateSheetOpsContextMenu",
274207288,-1497523576,Re,!0,!1,"SheetTabContextMenuRootName",rb,Lb,!1,oc);this.wic=this.Ugc=!1}get Lw(){return"PopulateSheetOpsContextMenu"}get HB(){return r.a.zNf}executeCommand(Aa,rb,Lb){if(Nb.a(this.$))return ab.Task.Ta(!0);this.$.isEditMode&&(Aa=Lb[r.a.O2f],Aa=Aa.x&&Aa.y?new Sys.UI.Point(Aa.x+(this.$.isChromeRtl?10:-10),Aa.y):qa.DOMElementExtensions.getLocation(Lb[r.a.P2f]),this.Jp(Aa,!1));return ab.Task.Ta(!0)}Ac(Aa,rb,Lb){return-1075099431===rb.command&&!!Lb}BY(){const Aa=this.Ua.Up(this.menuId),
rb=this.$.isEditMode;this.FTj();this.uGh(Aa,rb);this.jGh(Aa);this.nHh(Aa);return Aa}qZb(Aa,rb,Lb,oc){Aa.push(this.Ua.qb(rb?Lb:oc))}uGh(Aa,rb){var Lb=this.Ua;const oc=Lb.Dc();oc.buttons.push(Lb.qb(54));this.qZb(oc.buttons,this.wic,127,56);oc.buttons.push(Lb.qb(55));rb&&this.qZb(oc.buttons,this.wic,126,125);oc.buttons.push(Lb.qb(158));rb=this.$.xa.oa;da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.vK&&!this.$.ea.isNamedObjectViewMode&&!this.$.isMobileMode&&
rb&&rb.Dd&&(rb.Dd.uv||rb.Dd.VH||oc.buttons.push(Lb.qb(299)));this.$.ea.ZLb&&(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6540166_CheckIsSdxAllowedForProtectionPane")?l.AFrameworkApplication.erd(xe.a):this.$.ya.ExcelSheetProtectionSettingsEnabled)&&(rb=Object(Xb.a)(Zd.a,this.$.oa))&&Fa.p(rb)&&this.$.isEditMode&&(oc.buttons.push(Lb.qb(277)),rb.isLockPausedInSession?oc.buttons.push(Lb.qb(279)):rb.wi&&oc.buttons.push(Lb.qb(278)));rb=Lb.ew("ContextMenu.TabColor",null,K.a.instance.ga(523),1841703919);
Lb=Lb.R3c(467002767,1549407384,546,-221093529,this.HB);rb.menu.sc.push(Lb);oc.buttons.push(rb);Aa.sc.push(oc)}jGh(Aa){const rb=this.Ua.Dc();this.qZb(rb.buttons,this.wic,114,112);this.qZb(rb.buttons,!this.Ugc,115,113);Aa.sc.push(rb)}nHh(Aa){if(da.EwaSettings.ma(480)&&!Fa.e(this.$.xa.oa)){var rb=this.Ua,Lb=rb.Dc();Lb.buttons.push(rb.qb(263));Aa.sc.push(Lb)}}FTj(){let Aa,rb;({D3c:Aa,SDe:rb}=this.$.C3c());this.wic=1===Aa;this.Ugc=0<rb}}Object(c.a)(Ue,"SheetOpsContextMenu",w.a,[]);var jf=a(517);class Bf extends w.a{constructor(Aa,
rb,Lb,oc){super(Aa,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",rb,Lb,!0,oc)}get Lw(){return"PopulateSlicerContextMenu"}get HB(){return r.a.ANf}Lc(Aa,rb){var Lb=!0;switch(rb){case -231711729:Lb=!1;break;case -1909381757:Lb=this.mcc();Lb=!!Lb&&Lb.Thi;break;case 1312363469:Lb=!0}return!Lb||super.Lc(Aa,rb)}executeCommand(Aa,rb,Lb){if(!this.$.isEditMode)return J.TaskExtensions.Uaa();Aa=rb.command;rb=this.mcc();let oc=null;switch(Aa){case 2108047455:rb&&
rb.qAe();break;case -231711729:e.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:rb&&rb.V2b();break;case 1312363469:this.showSlicerContextMenu(Lb);break;default:oc=ta.a(Aa)}return oc||J.TaskExtensions.Uaa()}Ac(Aa,rb,Lb){Aa=!1;switch(rb.command){case -231711729:case 2108047455:case -1909381757:Aa=!0;break;case 1312363469:Aa=!!Lb}return Aa}BY(){const Aa=this.Ua.Up(this.menuId);var rb=this.Ua.Dc();rb.buttons.push(this.Ua.qb(252));rb.buttons.push(this.Ua.qb(253));
rb.buttons.push(this.Ua.qb(254));Aa.sc.push(rb);rb=this.Ua.Dc();this.ini()?rb.buttons.push(this.Ua.qb(266)):rb.buttons.push(this.Ua.qb(267));Aa.sc.push(rb);return Aa}ini(){if(nb.a.od(this.$)){var Aa=this.$.da.za(439);if(Aa)return Aa.$r}else if(Aa=this.$.da.za(371))return Aa.$r;return!1}showSlicerContextMenu(Aa){var rb=Object(Xb.a)(Sa.a,Aa.eventArgs);Aa=this.Kac(Object(Xb.a)(Sa.a,Aa.eventArgs));rb=rb.tb;x.a.Gb=rb;this.Jp(Aa,!1,rb)}YWe(Aa){const rb=this.Ua.Dc(),Lb=this.Ua.Dc();Lb.buttons.push(this.Ua.qb(255));
Lb.buttons.push(this.Ua.qb(256));const oc=this.Ua.U3c("ContextMenu.SlicerSort",null,K.a.instance.ga(2177),-814639094,0,ma.a.$Pe);oc.menu.sc.push(Lb);rb.buttons.push(oc);Aa.sc.push(rb)}syj(Aa){return da.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&Aa.Db.className===ma.a.a$c||da.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===Aa.tb}Kac(Aa){var rb=ka.g(this.$).ha.Qa.dc;let Lb=Aa&&1!==Aa.tb&&
Aa.clientPoint?Aa.clientPoint:Sys.UI.DomElement.getLocation(rb.domElement);if(this.syj(Aa)){var oc=this.mcc();oc&&(Aa.Db.className===ma.a.a$c&&(Lb=Ma.HelperMethods.uvb(Aa.Ca)),1===Aa.tb&&(Lb=ea.a(this.$).Ija(qa.DOMElementExtensions.getLocation(oc.frame))))}else if(Aa=this.mcc())Aa=this.MPh(Aa.frame),(oc=Ma.HelperMethods.dD(this.$.Ef,this.$.domElement,ka.g(this.$).rtl,!1))?(Aa.x=ea.a(this.$).Ci(Aa.x-oc.x)+oc.x,Aa.y=ea.a(this.$).Ci(Aa.y-oc.y)+oc.y):e.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),
Lb.y+=Aa.y,Lb.x+=Aa.x;Aa=this.$.domElement;oc=ka.g(this.$).rtl;rb=Ma.HelperMethods.dD(rb.lg.domElement,Aa,oc);Lb.y=Math.max(Lb.y,rb.y);Lb.x=Math.max(Lb.x,rb.x);return Lb}mcc(){const Aa=ka.g(this.$).ha.Qa.dc;e.ULS.shipAssertTag(537166988,0,!!Aa);return jf.a(this.$).DH(Aa.floatingObject.id)}MPh(Aa){let rb=new Sys.UI.Point(Aa.offsetParent.offsetLeft,Aa.offsetParent.offsetTop);var Lb=ka.g(this.$);if(!Lb)return rb;const oc=ka.g(this.$).rtl;rb=Ma.HelperMethods.dD(Aa,this.$.qr.ownerDocument.body,oc);Lb.KDe(rb);
rb.x=oc?this.$.qr.clientWidth-rb.x-Aa.clientWidth:rb.x;Aa=Lb.view.ipb;Lb=oc?-Lb.WR.nca(Aa.x):Aa.x;rb.x-=Lb;rb.y-=Aa.y;return rb}}Object(c.a)(Bf,"SlicerContextMenu",w.a,[]);class Ae{constructor(Aa,rb,Lb){this.type=Aa;this.t3g=rb;this.Fr=Lb}}Object(c.a)(Ae,"TimeSlicerRibbonButtonParameter",null,[]);class Qe extends w.a{constructor(Aa,rb,Lb,oc){super(Aa,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Qe.DJj,!0,!1,Qe.YJb,rb,Lb,!1,oc);this.x1a=0;this.lLe=this.GKa=this.Osa=null}get Lw(){return"PopulateTimeSlicerLevelMenu"}get HB(){return r.a.DNf}executeCommand(Aa,
rb,Lb){Aa=rb.command;switch(Aa){case 2000085697:Aa=Lb.DOMElement;this.Osa=Lb.ChangeLevelCallback;this.GKa=Lb.GetLevelLabelCallback;this.x1a=Lb.CurrentLevel;const oc=Lb.DomEvent;Q.g(oc);const $c=Lb.location;Lb=Lb.levelLabelText;this.lLe=qa.DOMElementExtensions.yz(document.activeElement,"iframe")&&Lb?Lb.parentNode:null;Lb=Sys.UI.DomElement.getBounds(Lb);Lb.x=$c.x;Lb.y=$c.y;this.A0(oc,Aa,Lb,rb,!0);break;case -649826274:this.Osa(0);break;case 149600865:this.Osa(1);break;case -2012435159:this.Osa(2);break;
case -1979934975:this.Osa(3);break;case 1634477200:qa.DOMElementExtensions.setFocus(this.lLe);break;default:return ta.a(Aa)}return ab.Task.Ta(!0)}Ac(Aa,rb,Lb){Aa=!1;switch(rb.command){case 2000085697:Aa=!!Lb;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:Aa=!0}return Aa}A0(Aa,rb,Lb){Aa=Sys.UI.DomElement.getBounds(rb);Lb.x=ea.a(this.$).Ci(Lb.x);Lb.y=ea.a(this.$).Ci(Lb.y);Aa.x=ea.a(this.$).Ci(Aa.x);Aa.y=ea.a(this.$).Ci(Aa.y);Aa=new Sys.UI.Point(Aa.x+Lb.x,Aa.y+
Lb.y);this.showContextMenu(new Sys.UI.Bounds(Aa.x,Aa.y-Lb.height,Lb.width,Lb.height))}BY(){const Aa=this.Ua,rb=Aa.Up(this.menuId),Lb=Aa.Dc();for(let $c=0;3>=$c;$c++){const Fd=this.GKa($c);var oc=Qe.gKh($c);oc=Aa.x5g(oc.t3g,oc.Fr,this.x1a===$c,Qe.sze);oc.label=Fd;oc.$R(Fd);this.x1a===$c?oc.bS("Image16by16",8,Qe.sze):oc.N2b();Lb.buttons.push(oc)}rb.sc.push(Lb);return rb}static gKh(Aa){let rb=null;switch(Aa){case 0:rb=new Ae(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:rb=new Ae(88,
"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:rb=new Ae(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:rb=new Ae(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return rb}}Qe.DJj=r.a.x3g;Qe.YJb="TimeSlicerLevelMenuRootName";Qe.sze=ma.a.Fua;Object(c.a)(Qe,"TimeSlicerLevelMenu",w.a,[]);var Je=a(315),se=a(3);class cb extends b.a{constructor(Aa){super(Aa)}vd(){const Aa=this.$,rb=sb.a.p1a(Ba.b(),this.la,"Task","IRootUser"),Lb=d.a(Aa);let oc=null;oc=(Cd,$d)=>{Lb.dSf(oc);
rb.setResult($d.g4b)};Lb.Yoe(oc);Lb.N1e();const $c=T.GetServiceTaskFactory.create(Aa.da,102,Aa.la,this.fb),Fd=T.GetServiceTaskFactory.Sa(Aa.da,342,338,this.fb);J.TaskExtensions.Aa(J.TaskExtensions.Td([rb.task,$c,Fd],this.la),()=>{const Cd=$c.result,$d=rb.task.result,he=Fd.result;this.$c([new Pb(Aa,$d,Cd,he),new ha(Aa,$d,Cd,he),new bb(Aa,$d,Cd,he),new wb(Aa,$d,Cd,he),new Vc(Aa,$d,Cd,he),new Ia(Aa,$d,Cd,he),new yd.GridContextMenu(Aa,$d,Cd,he),new Sd(Aa,$d,Cd,he),new Ue(Aa,$d,Cd,he),new Qe(Aa,$d,Cd,
he),new Nc(Aa,$d,Cd,he),new Wa(Aa,$d,Cd,he),new M(Aa,$d,Cd,he),new Bf(Aa,$d,Cd,he),new Gd(Aa,$d,Cd,he)])},Aa.la,3)}static initData(){const Aa=Je.a.v9;Aa(2000085697,20479,0,0);Aa(-227942804,se.a.oc|24576,0,0);Aa(1634477200,se.a.oc|131072,0,0);Aa(-649826274,4095,0,0);Aa(149600865,4095,0,0);Aa(-2012435159,4095,0,0);Aa(-1979934975,4095,0,0);Aa(1247109494,se.a.oc|24576,0,0);Aa(-2064931494,se.a.oc|131072,0,0);Aa(-1396319072,se.a.Ha,128,0);Aa(-425234874,se.a.Ha,128,0);Aa(-1253126584,se.a.Ha,0,0);Aa(274207288,
se.a.oc|24576,0,0);Aa(-1497523576,se.a.oc|131072,0,0);Aa(-498523270,se.a.oc|24576,64,0);Aa(1640762262,se.a.oc|131072,64,0);Aa(-2017893763,se.a.oc|24576,0,0);Aa(1350204367,se.a.oc|131072,0,0);Aa(-889576107,se.a.aw,128,0);Aa(-1170196828,se.a.aw,128,0);Aa(389774337,se.a.aw,128,0);Aa(1529312473,se.a.aw,128,0);Aa(2033235475,se.a.aw,128,0);Aa(-96230454,se.a.aw,128,0);Aa(74086617,se.a.aw,128,0);Aa(563292088,se.a.aw,128,0);Aa(-1092351914,se.a.aw,128,0);Aa(-2141589616,se.a.aw|16384,128,0);Aa(745182485,se.a.aw,
0,0);Aa(359279088,se.a.aw,128,0);Aa(-67292059,se.a.aw,128,0);Aa(926905850,se.a.aw,128,0);Aa(547535945,se.a.aw,128,0);Aa(1374696078,se.a.oc|24576,0,0);Aa(495005930,se.a.oc|212992,0,0);Aa(-1045020714,se.a.oc|24576,0,0);Aa(-170383950,se.a.oc|212992,0,0);Aa(324156914,se.a.Ha,0,0);Aa(-1085236154,se.a.Xu,0,0);Aa(-751848458,se.a.xl|16384,0,0);Aa(216058793,se.a.Xu,0,0);Aa(474690375,se.a.xl|16384,0,0);Aa(-1920954846,se.a.oc|24576,0,0);Aa(723126814,se.a.oc|131072,0,0);Aa(2108047455,128,128,0);Aa(-231711729,
128,128,0);Aa(-1909381757,128,128,0);Aa(-814639094,128,128,0);Aa(1701016594,se.a.oc|3072,128,0);Aa(-1475408662,se.a.oc|24576,0,0);Aa(1114549926,se.a.oc|131072,32,0)}static ka(Aa){b.a.Od(10,new cb(Aa))}}Object(c.a)(cb,"ContextMenuCommandHandlerFactory",b.a,[]);var Rb=a(222),uc=a(1392),Sc=a(91),ub=a(212);class Zb{constructor(Aa,rb){this.erb=rb;this.$=Aa}dispose(){}T$(){this.erb.w3()}XC(){this.erb.XC()}fTd(Aa,rb,Lb){Hd.h(this.$,Hd.b);this.erb.showContextMenu(Object(f.a)(new uc.a,{x:rb.x,y:rb.y}),Lb,
Aa);Sc.EventHandlerManager.instance.ecd()}pyc(Aa,rb,Lb){Hd.h(this.$,Hd.b);this.erb.showFloatie(Object(f.a)(new uc.a,{x:rb.x,y:rb.y}),Aa,Lb);ub.a(()=>{Sc.EventHandlerManager.instance.ecd()},this.$.la)}eTd(Aa,rb,Lb,oc){Hd.h(this.$,Hd.b);this.erb.eTd(Object(f.a)(new uc.a,{x:rb.x,y:rb.y}),Aa,Lb,oc)}}Object(c.a)(Zb,"ReactContextMenuController",null,[396,10]);class Ec extends Rb.a{constructor(Aa){super();this.Eaf=!1;this.Vld=()=>{let rb;(rb=this.$.da.za(342))?this.pb(rb):this.$.Yx(Lb=>{Lb.Qec().then(oc=>
{(rb=this.$.da.za(342))?this.pb(rb):(rb=new Zb(this.$,oc),this.pb(this.$.da.Ga(342,rb)))})})};this.$=Aa;this.Eb()}dispose(){this.Eaf&&this.$&&this.$.ea.fo(this.Vld);super.dispose()}create(){this.$.ea.Hg?(e.ULS.sendTraceTag(537167065,0,50,`ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = ${this.$.ea.Hg}`),this.Vld(null,null)):(this.Eaf=!0,this.$.ea.Ll(this.Vld))}static ka(Aa){Aa.da.Ga(338,new Ec(Aa))}}Object(c.a)(Ec,"ContextMenuControllerFactory",Rb.a,[]);var ed=
a(154);class Kd{constructor(){this.dictionary=this.Jd=null}}Object(c.a)(Kd,"RibbonCommandParams",null,[]);class fe{constructor(){this.menuModel=null;this.EGe=0}}Object(c.a)(fe,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);class be{constructor(){this.Kdc={}}sKh(Aa){return(Aa=this.Kdc[Aa.toString()])?Aa.menuModel:null}pUg(Aa,rb){this.Kdc[rb.toString()]=Object(f.a)(new fe,{menuModel:Aa,EGe:Ma.HelperMethods.Sb()})}F7b(Aa){this.Kdc[Aa.toString()]=null}LZh(Aa){return(Aa=this.Kdc[Aa.toString()])?Aa.EGe:
-1}}Object(c.a)(be,"FilterMenuCache",null,[]);var me=a(13),re=a(189),Xe=a(223);class We{constructor(){this.Pd=this.lue=this.cell=null}}Object(c.a)(We,"AutoFilterEventRegistrationArgs",null,[]);class ee{constructor(Aa){this.l_a=null;this.uSd=!1;this.$Bb=0;this.B9c=1;this.DNe=0;this.XEb=rb=>{this.VLf(rb.domElement,rb.hashCode)};this.FPf=rb=>{let Lb=0;for(;window.performance.now()-rb<this.vnh&&0<this.l_a.length;)this.kne(this.l_a.shift()),Lb++;e.ULS.sendTraceTag(537167052,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: ${this.B9c}, Events Registered in this frame: ${Lb}, Events in queue: ${this.l_a.length}`);
0<this.l_a.length?this.$Bb=window.requestAnimationFrame(this.FPf):(rb=window.performance.now()-this.DNe,e.ULS.sendTraceTag(537167051,1,50,`FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: ${this.B9c}, Total time in MS: ${rb}`),this.B9c++,this.$Bb=0)};this.onPointerDown=rb=>{Md.a.slim(rb.Ca.rawEvent);return!1};this.$=Aa;this.gridView=ka.g(this.$);this.K9h();this.vnh=this.$.ya.AutoFilterEventRegistrationTimeLimit}dispose(){window.cancelAnimationFrame(this.$Bb);this.gridView&&
this.gridView.ktc(this.XEb);this.gridView=null}K9h(){if(this.uSd=Ma.HelperMethods.k7a)this.l_a=[];this.EDg();this.gridView.NZb(this.XEb)}EDg(){for(const Aa of this.gridView.Cn){const rb=Aa.jCa;for(let Lb in rb){const oc=rb[Lb];this.VLf(oc.domElement,oc.hashCode)}}}VLf(Aa,rb){if(ka.g(this.$).Ea.ym.e2a(rb))if(Aa){Aa=Aa.querySelectorAll('[id^="'+r.a.Sad+'"]');for(let $c=0;$c<Aa.length;$c++){var Lb=Aa[$c],oc=Lb.getAttribute(r.a.OAh);const Fd=Lb.getAttribute(r.a.HAh);e.ULS.shipAssertTag(537167053,0,!!oc&&
!!Fd,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: ${Lb.id}, BlockHash: ${rb}`);oc=ld.Range.Uc(parseInt(oc,10),parseInt(Fd,10));Lb=Object(f.a)(new We,{cell:oc,lue:Lb,Pd:rb});this.uSd?(this.l_a.push(Lb),this.$Bb||(this.DNe=window.performance.now(),this.$Bb=window.requestAnimationFrame(this.FPf))):this.kne(Lb)}}else e.ULS.sendTraceTag(537167054,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: ${rb}`);
else e.ULS.sendTraceTag(537167055,0,50,`FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: ${rb}`)}kne(Aa){const rb=this.gridView.Ea.JKa(Aa.cell,Aa.Pd);rb?this.DDg(Aa.lue,rb):e.ULS.sendTraceTag(537167050,1,10,`FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: ${Aa.Pd}, AutoFilter Cell: ${Aa.cell}`)}DDg(Aa,rb){rb.hasAutoFilter?this.BBg(Aa,
rb.eub):rb.t4?this.BDg(Aa,rb.eub,rb.nqd):e.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");ed.a.instance.ra(me.a.Cf,Aa,this.onPointerDown);re.a.instance.ra(me.a.wya,Aa,this.onPointerDown)}BBg(Aa,rb){Xe.a.instance.ra(me.a.click,Aa,Lb=>{rb&&Md.a.hrc(Lb.Ca.rawEvent,966232027,rb,null);return!0})}BDg(Aa,rb,Lb){const oc=B.a.$h(rb);Xe.a.instance.ra(me.a.click,Aa,$c=>{Lb?Md.a.spf(document.getElementById(oc.EwaElementId),
oc.Cell,oc.DataSourceIndex,oc.FieldId,oc.IsOlap,oc.RequiresConfirmation,$c.Ca.rawEvent,oc.OptionalPivotMenuAnchor):Md.a.spfm($c.Ca.rawEvent,oc.RequiresConfirmation,oc.Cell,oc.DataSourceIndex,oc.PivotName,oc.OptionalPivotMenuAnchor);return!1})}}Object(c.a)(ee,"FilterMenuPointerEventsManager",null,[10]);class xc{constructor(Aa){this.LTe=null;this.$=Aa;this.h9a=new be;da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||
(this.LTe=new ee(this.$))}dispose(){da.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&da.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.LTe.dispose();this.$=null}AQh(Aa){const rb=ka.g(this.$).Ea.f$(Aa,this.$.activeItemName);return rb&&rb.blockPresentInViewportTimeStamp>this.h9a.LZh(Aa.left)?rb.fs(Aa).autoFilterMenu:this.h9a.sKh(Aa.left)}QMi(Aa,rb,Lb){this.h9a&&this.h9a.pUg(Aa.menuModel[rb],Lb)}RMi(Aa){this.h9a&&this.h9a.F7b(Aa)}}Object(c.a)(xc,"FilterMenuManager",
null,[395,10]);var jd=a(204),Nd=a(168);class Ld{constructor(Aa,rb,Lb){this.Oyc={};this.Ad=!1;this.Xl=(oc,$c=null)=>{this.showContextMenu($c)};this.oxf=(oc,$c)=>{$c.yAi===Ld.C1h&&ka.g(this.$).focus()};this.nR=(oc,$c)=>{oc=this.$.Ka.Eaa($c.Jd.command);(null===oc||void 0===oc?0:oc.dismissesContextualUI)&&this.w3()};this.mR=()=>{this.$.da.nU(342);J.TaskExtensions.Aa(T.GetServiceTaskFactory.create(this.$.da,338,this.$.la,3),oc=>{oc=oc.result;for(let $c of this.Oyc)$c.pPf(oc)},this.$.la)};this.$=Aa;this.contextMenuController=
Lb;this.I7d=new xc(this.$);Aa.da.Ga(8,this);for(Lb=0;Lb<rb.length;Lb++)this.Oyc[Ld.y3g[Lb]]=rb[Lb];this.ha=ka.g(Aa).ha;this.ha.GZb(this.Xl);this.$.Ka.jZa(this.oxf);ed.a.instance.ptj();da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.WFa(this.nR);da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.aY(this.mR)}get M9b(){return this.I7d}ced(Aa){return O.a.Cc(this.Oyc,Aa)}dispose(){this.Ad?
e.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Ad=!0,this.$&&(this.$.Hl(Ld.dd),this.$.da.nU(8),this.ha&&this.ha.ctc(this.Xl),this.$.Ka.$Ib(this.oxf),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.aAa(this.nR),da.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.b0(this.mR)),this.$=this.ha=null,this.M9b.dispose(),
this.Oyc=this.I7d=null)}showContextMenu(Aa,rb=null,Lb=null){this.Zxj(Aa)&&(Hd.h(this.$,Hd.i),Aa=this.J6g(Aa,rb,Lb),this.$.Ka.Lb(Aa.Jd,Aa.dictionary))}w3(){this.contextMenuController?this.contextMenuController.T$():e.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")}Zxj(Aa){return Ub.a(this.$).gq()?(e.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Ub.a(this.$).aW(Nd.a.grid,jd.a.showContextMenu),!1):!this.$.Ka.lyh&&(!Aa||Aa.Db!==ka.g(this.$).domElement&&!we.a.equals(Aa.Db.tagName,"INPUT",!0))}J6g(Aa,rb=null,Lb=null){Lb={["eventArgs"]:Aa,["creationParams"]:Lb};Aa=Aa?Aa.tb:-1;const oc=this.ha.Qa.dc;let $c=1441131127;oc?(rb=oc.floatingObject,e.ULS.shipAssertTag(537167059,0,!!rb,"floatingObj shouldn't be null."),Ld.zrd(rb)?$c=1312363469:Ld.isPivotChart(rb)?(Lb[ha.m0c]=rb?rb.Tc:null,$c=-149612405):$c=-1372040782):Ld.Xgf(rb)?(Lb[ha.m0c]=rb,$c=-149612405):
!Hd.g(this.$)&&Hd.f(ka.g(this.$))&&($c=671488277);rb=new R.a($c,Aa,this.$.Kc,30,null);return Object(f.a)(new Kd,{Jd:rb,dictionary:Lb})}static ka(Aa){Aa.kl(Ld.dd)}static isPivotChart(Aa){return!!Aa&&0===Aa.type&&Ld.Xgf(Aa.Tc)}static zrd(Aa){return!!Aa&&2===Aa.type}static Xgf(Aa){return!!Aa&&!!(Aa.Attributes&4)}}Ld.y3g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Ld.C1h="GridContextMenu";Ld.dd=Aa=>{(Aa=Object(Xb.a)(6,Aa))&&T.GetServiceTaskFactory.create(Aa.da,9,Aa.la,0)};Object(c.a)(Ld,"ContextMenuManager",null,[384,10]);class Za extends Rb.a{constructor(Aa){super();this.$=Aa;this.Eb()}create(){const Aa=this.$,rb=Aa.jc;if(rb.allowSelection||rb.allowEdits||rb.allowFiltering||rb.allowSorting||rb.allowPivotSpecificOperations){const Lb=T.GetServiceTaskFactory.create(Aa.da,10,Aa.la,this.fb),oc=T.GetServiceTaskFactory.Sa(Aa.da,342,338,this.fb);J.TaskExtensions.Aa(J.TaskExtensions.Td([Lb,
oc],this.la),()=>{this.pb(v.a(Aa)||new Ld(Aa,Lb.result,oc.result))},this.$.la,3)}else e.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),Aa.da.nU(8),this.pb(null)}static ka(Aa){Aa.da.Ga(9,new Za(Aa))}}Object(c.a)(Za,"ContextMenuManagerFactory",Rb.a,[]);var Pa=a(9);a.d(C,"a",function(){return Ab});const Ab=()=>{cb.initData();Pa.a.Fa(Aa=>{Ec.ka(Aa);Za.ka(Aa);cb.ka(Aa);Ld.ka(Aa)})}},1147:function(n,C,a){var c=
a(9);n=a(0);var b=a(694),d=a(15);const f=wa=>{switch(wa){case 0:wa="Between";break;case 1:wa="NotBetween";break;case 2:wa="Equal";break;case 3:wa="NotEqual";break;case 4:wa="GreaterThan";break;case 5:wa="LessThan";break;case 6:wa="GreaterThanOrEqual";break;case 7:wa="LessThanOrEqual";break;default:wa="Unknown"}return wa},e=wa=>{switch(wa){case 0:wa="AnyValue";break;case 1:wa="WholeNumber";break;case 2:wa="Decimal";break;case 3:wa="List";break;case 4:wa="Date";break;case 5:wa="Time";break;case 6:wa=
"TextLength";break;case 7:wa="Custom";break;default:wa="Unknown"}return wa};var k=a(132),l=a(43),m=a(370),u=a(171),t=a(283);class w{constructor(wa=null){this.S4=wa?wa.IsIgnoreBlank:!0;this.T4=wa?wa.IsInCellDropDown:!0;this.RN=wa?wa.LowerBoundary:"";this.SN=wa?wa.UpperBoundary:"";this.JB=wa?wa.ConditionType:0;this.ruleType=wa?wa.RuleType:0;this.GZ=wa?wa.IsAlertBlocking:!0;this.xT=wa?wa.AlertTitle:"";this.wT=wa?wa.AlertMessage:"";this.dV=wa?wa.InputMessage:"";this.zF=wa?wa.InputTitle:"";this.l5=wa?
wa.IsShowErrorAlert:!0;this.m5=wa?wa.IsShowInputMessage:!0}isEqual(wa){return wa?this.S4===wa.S4&&this.T4===wa.T4&&this.RN===wa.RN&&this.SN===wa.SN&&this.JB===wa.JB&&this.ruleType===wa.ruleType&&this.GZ===wa.GZ&&this.xT===wa.xT&&this.wT===wa.wT&&this.dV===wa.dV&&this.zF===wa.zF&&this.l5===wa.l5&&this.m5===wa.m5:(d.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)}}Object(n.a)(w,"DataValidationEditDialogState",null,[]);var r=a(282),v=a(183),y=a(281),
x=a(21),B=a(133),z=a(51),A=a(55);class I{constructor(wa,ia){this.UB=this.I1a=this.selectedRanges=null;this.UKe=!1;this.ei=null;this.bLi=xa=>{d.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!xa||r.a(xa)?d.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):(this.I1a=xa.Result,this.f0i())};this.tyh=xa=>{this.mW("DataValidationEdit.ExpandExisitngDialog",
xa);this.UB.c=I.jia(xa);1===xa?this.THa(new w(this.I1a)):2===xa?this.THa(new w):this.oof()};this.bWi=xa=>{this.mW("DataValidationEdit.OverrideExisitngDialog",xa);this.UB.c=I.jia(xa);1===xa?this.THa(new w):this.oof()};this.$=wa;this.Q5c=ia}Lc(){return!1}executeCommand(wa,ia){-1728432249!==ia.command&&v.a(ia.command);this.selectedRanges=l.r(x.g(this.$).ha.sa.selectedRanges,this.$);x.g(this.$).XSa(!0);this.getDataValidationInitialState();this.ei=this.$.Jb.Bc("UserAction","DataValidationEditTimeToDialogOpen");
this.UKe?d.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(d.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.UKe=!0);return A.Task.Ta(!0)}Ac(wa,ia){return-1728432249===ia.command}Oc(){return!1}getDataValidationInitialState(){const wa=this.$.pa.va.Tb();m.a(this.$.userOperationManager,(ia,xa,gb)=>t.e(this.$.pa.va,this.selectedRanges,y.b(ia,this.bLi),y.a(xa),gb,wa),ia=>new u.a(120,0,ia,16),null)}f0i(){var wa=
this.UB={};let ia;switch(this.I1a.Command){case 0:ia="CreateNew";break;case 1:ia="CreateNewFromRule";break;case 2:ia="ExpandExisitng";break;case 3:ia="OverrideExisitng";break;default:ia="Unknown"}wa.a=ia;this.ei&&(this.ei.stop(),this.UB.r=this.ei.id);switch(this.I1a.Command){case 0:this.UB.b=!1;this.UB.c="None";this.THa(new w);break;case 1:this.UB.b=!1;this.UB.c="None";this.THa(new w(this.I1a));break;case 2:this.UB.b=!0;this.Q5c.G5g(this.$,this.tyh);break;case 3:this.UB.b=!0;this.Q5c.I5g(this.$,this.bWi);
break;default:d.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}}THa(wa){this.Q5c.THa(this.$,this.selectedRanges,wa,this.I1a.Command);this.fxi(wa)}fxi(wa){I.Bsb(wa,this.UB);this.UB.d=!0;z.b().Ne(48,this.UB,!0)}oof(){this.UB.d=!1;z.b().Ne(48,this.UB,!0)}mW(wa,ia){wa={["ButtonType"]:I.jia(ia),["DialogName"]:wa,["Location"]:"dialog",["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.PK};B.b(this.$).Hd(k.a.D6b,wa)}static Bsb(wa,ia){ia.e=e(wa.ruleType);
ia.f=f(wa.JB);ia.g=!!wa.RN;ia.h=!!wa.SN;ia.i=wa.S4;ia.j=wa.T4;ia.k=wa.m5;ia.l=!!wa.zF;ia.m=!!wa.dV;ia.n=wa.l5;ia.o=wa.GZ;ia.p=!!wa.xT;ia.q=!!wa.wT}static jia(wa){switch(wa){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return d.ULS.shipAssertTag(537163281,0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}}}Object(n.a)(I,"DataValidationEditCommandHandler",null,[164]);var F=a(134),U=a(798),X;(function(wa){wa[wa.between=0]="between";wa[wa.notBetween=
1]="notBetween";wa[wa.equal=2]="equal";wa[wa.notEqual=3]="notEqual";wa[wa.greaterThan=4]="greaterThan";wa[wa.lessThan=5]="lessThan";wa[wa.greaterThanOrEqual=6]="greaterThanOrEqual";wa[wa.lessThanOrEqual=7]="lessThanOrEqual"})(X||(X={}));Object(n.b)("DataValidationRuleConditionType",X);var T;(function(wa){wa[wa.anyValue=0]="anyValue";wa[wa.wholeNumber=1]="wholeNumber";wa[wa.decimal=2]="decimal";wa[wa.list=3]="list";wa[wa.date=4]="date";wa[wa.time=5]="time";wa[wa.textLength=6]="textLength";wa[wa.custom=
7]="custom"})(T||(T={}));Object(n.b)("DataValidationRuleType",T);var G=a(144),D=a(185);class J{static get mg(){return G.a.Yp(J.ml,"")}static get Xfh(){return G.a.Yp(J.agh,D.a.ga(1672),D.a.ga(1687),D.a.ga(1688),D.a.ga(1689),D.a.ga(1690),D.a.ga(1691),D.a.ga(1692),D.a.ga(1693),D.a.ga(1694),D.a.ga(1673),D.a.ga(1697),D.a.ga(1698),D.a.ga(1699),D.a.ga(1700),D.a.ga(1701),D.a.ga(1702),D.a.ga(1703),D.a.ga(1704),D.a.ga(1674),D.a.ga(1675),D.a.ga(1695),D.a.ga(1696),D.a.ga(1686),"255")}static get dgh(){return G.a.Yp(J.bgh,
D.a.ga(1709),D.a.ga(1713),D.a.ga(1714),"255","32")}static get hgh(){return G.a.Yp(J.cgh,D.a.ga(1708),D.a.ga(1711),D.a.ga(1710),D.a.ga(1712),D.a.ga(1713),D.a.ga(1714),"255","32")}}J.n$f=255;J.ml="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";J.agh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
J.bgh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
J.cgh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(n.a)(J,"DataValidationEditDialogHtml",null,[]);var L=a(85),H=a(555),R=a(13),Q=a(187),O=a(236),V=a(12),W=a(14);class da extends O.a{constructor(wa,ia,xa){super(ia);this.uDd=this.upc=this.FPa=this.P$a=this.YNa=this.U5a=this.iza=this.hza=this.UK=this.yT=this.Iec=this.vwa=null;this.oCh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];this.Clj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,
1],[12,12]];this.Unc=gb=>{let va=!1;(null===gb||void 0===gb?0:gb.Ca)&&(gb.Ca.keyCode===L.a.Toa||gb.Ca.keyCode===L.a.fi)&&(va=this.xca(gb),this.yT.blur(),this.UK.blur());return va};this.xca=()=>{const gb=this.yT.selectedIndex,va=this.UK.selectedIndex;this.upc.innerText=this.Mvb(gb,va);this.uDd.innerText=this.Xgd(gb,va);switch(gb){case 0:return this.UK.disabled=!0,V.DOMElementExtensions.setVisible(this.P$a,!1),V.DOMElementExtensions.setVisible(this.FPa,!1),V.DOMElementExtensions.setVisible(this.U5a,
!1),V.DOMElementExtensions.setVisible(this.YNa,!1),this.vwa.disabled=!0,!1;case 3:return this.UK.disabled=!0,V.DOMElementExtensions.setVisible(this.P$a,!0),V.DOMElementExtensions.setVisible(this.FPa,!1),V.DOMElementExtensions.setVisible(this.U5a,!0),V.DOMElementExtensions.setVisible(this.YNa,!0),this.vwa.disabled=!1;case 7:return this.UK.disabled=!0,V.DOMElementExtensions.setVisible(this.P$a,!0),V.DOMElementExtensions.setVisible(this.FPa,!1),V.DOMElementExtensions.setVisible(this.U5a,!1),V.DOMElementExtensions.setVisible(this.YNa,
!1),this.vwa.disabled=!1;default:this.vwa.disabled=!1,V.DOMElementExtensions.setVisible(this.P$a,!0),V.DOMElementExtensions.setVisible(this.YNa,!1)}switch(va){case 0:case 1:V.DOMElementExtensions.setVisible(this.FPa,!0);break;default:V.DOMElementExtensions.setVisible(this.FPa,!1)}this.UK.disabled=!1;this.upc.disabled=!1;V.DOMElementExtensions.setVisible(this.U5a,!1);V.DOMElementExtensions.setVisible(this.YNa,!1);return!1};this.get_visible=this.Qja;this.set_visible=this.Fna;this.YQ=new Q.a;this.YQ.add(W.a.instance.ga(1674));
this.YQ.add(W.a.instance.ga(1675));this.YQ.add(W.a.instance.ga(1678));this.YQ.add(W.a.instance.ga(1676));this.YQ.add(W.a.instance.ga(1677));this.YQ.add(W.a.instance.ga(1679));this.YQ.add(W.a.instance.ga(1680));this.YQ.add(W.a.instance.ga(1681));this.YQ.add(W.a.instance.ga(1682));this.YQ.add(W.a.instance.ga(1683));this.YQ.add(W.a.instance.ga(1684));this.YQ.add(W.a.instance.ga(1685));this.YQ.add("");this.$=wa;this.Ok=xa;this.kka()}get title(){return W.a.instance.ga(1705)}get U1g(){return this.yT.selectedIndex}GAa(wa){this.yT.selectedIndex=
wa.ruleType;this.UK.selectedIndex=wa.JB;this.Iec.checked=wa.T4;this.vwa.checked=wa.S4;this.hza.value=wa.RN;this.iza.value=wa.SN;this.xca(null)}Bpb(wa){wa.S4=this.vwa.checked;wa.T4=this.Iec.checked;wa.JB=this.UK.selectedIndex;wa.ruleType=this.yT.selectedIndex;wa.RN=this.hza.value;wa.SN=this.iza.value}dispose(){this.mk();this.Ok=this.uDd=this.upc=this.FPa=this.P$a=this.YNa=this.U5a=this.Iec=this.iza=this.hza=this.UK=this.yT=this.vwa=null;super.dispose()}render(wa){wa.appendChild(this.domElement)}Qja(){return this.isVisible}Fna(wa){return this.isVisible=
wa}setFocus(){}Mvb(wa,ia){return this.J1e(wa,ia,this.oCh)}Xgd(wa,ia){return 0!==ia&&1!==ia?"":this.J1e(wa,ia,this.Clj)}kka(){this.domElement.innerHTML=J.Xfh;this.vwa=V.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.yT=V.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.UK=V.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.hza=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");
this.iza=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.upc=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId1");this.uDd=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.U5a=V.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.YNa=V.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.P$a=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");
this.FPa=V.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Iec=V.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownCheckboxId");this.Ij()}J1e(wa,ia,xa){return xa.length<wa||xa[wa].length<ia?(d.ULS.sendTraceTag(537163280,0,10,`DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption=${wa} operatorOption=${ia}, cannot get label.`),""):this.YQ.na(xa[wa][ia])}Ij(){H.a.instance.ra(R.a.Qb,this.yT,this.Unc);H.a.instance.ra(R.a.Qb,this.UK,
this.Unc);H.a.instance.ra(R.a.change,this.yT,this.xca);H.a.instance.ra(R.a.change,this.UK,this.xca);H.a.instance.ra(R.a.change,this.UK,this.Ok);H.a.instance.ra(R.a.change,this.yT,this.Ok);H.a.instance.ra(R.a.change,this.hza,this.Ok);H.a.instance.ra(R.a.Qb,this.hza,this.Ok);H.a.instance.ra(R.a.change,this.iza,this.Ok);H.a.instance.ra(R.a.Qb,this.iza,this.Ok)}mk(){H.a.instance.Ba(R.a.Qb,this.yT,this.Unc);H.a.instance.Ba(R.a.Qb,this.UK,this.Unc);H.a.instance.Ba(R.a.change,this.yT,this.xca);H.a.instance.Ba(R.a.change,
this.UK,this.xca);H.a.instance.Ba(R.a.change,this.UK,this.Ok);H.a.instance.Ba(R.a.change,this.yT,this.Ok);H.a.instance.Ba(R.a.change,this.hza,this.Ok);H.a.instance.Ba(R.a.Qb,this.hza,this.Ok);H.a.instance.Ba(R.a.change,this.iza,this.Ok);H.a.instance.Ba(R.a.Qb,this.iza,this.Ok)}static oja(){let wa;return wa=new Q.a,wa.add("operatorInputId1"),wa.add("operatorInputId2"),wa}}Object(n.a)(da,"DataValidationEditConditionsControl",O.a,[486,10,834]);var ta=a(61);const K=(wa,ia,xa,gb,va,sa,ab,Ua=null)=>{Ua=
wa.Na(9,Ua);Ua.selectedRanges=ia;Ua.ruleOptions=xa;return ta.g(wa,"CreateOrEditDataValidation",Ua,gb,va,sa,ab,0)};var na=a(29),P=a(22),ka=a(200);class pa extends U.a{constructor(wa,ia,xa,gb){super(wa);this.lOd=this.nub=null;this.xNa=this.disposed=this.uka=!1;this.ei=null;this.JVj=(va,sa)=>{let ab;this.Sac(va);if(({errorString:va,Eq:ab}=this.f0d()).returnValue)return this.gMa(121,this.WMh(this.$,sa),0,this.Z4,!1),"";this.kla("OkInvalidByClient",ab);return va};this.P5c=va=>{this.mW(va);this.ei=this.$.Jb.Bc("UserAction",
"DataValidationEditTimeToDialogTryClose");0===va&&this.Ula()};this.selectedRanges=ia;this.wSb=xa;this.command=gb;3===gb&&(this.uka=!0);this.Rb=2;this.Nv=!1}get xd(){return this.wSb}get uc(){return"DataValidationEditDialog"}QTd(){var wa={["RuleType"]:this.xd.ruleType,["RuleOperatorType"]:this.xd.JB,["OperatorInput1"]:this.xd.RN,["OperatorInput2"]:this.xd.SN,["IsIgnoreBlank"]:this.xd.S4,["IsInCellDropDown"]:this.xd.T4,["IsAlertBlocking"]:this.xd.GZ,["AlertTitle"]:this.xd.xT,["AlertMessage"]:this.xd.wT,
["InputTitle"]:this.xd.zF,["InputMessage"]:this.xd.dV,["IsShowErrorAlert"]:this.xd.l5,["IsShowInputMessage"]:this.xd.m5};this.rc(2,W.a.instance.ga(1671));wa={[pa.dv]:this.uc,["validateDialogValues"]:this.JVj,["RangePickerController"]:x.g(this.$).Ff.$bc(),["isModal"]:!1,["bodyProps"]:wa};this.initializeAndShow(W.a.instance.ga(1670),this.P5c,wa);d.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")}dispose(){this.disposed||(super.dispose(),this.disposed=!0)}get k2b(){return 3===
this.xd.ruleType}oja(){return da.oja()}WMh(wa,ia){return(xa,gb,va)=>{const sa=wa.pa.va.Tb();return K(this.$.pa.va,this.selectedRanges,this.tSg(),this.j0a(xa,this.PAd(ia)),y.a(gb),va,sa)}}PAd(wa){return ia=>{d.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");let xa;r.a(ia)?(d.ULS.sendTraceTag(537163276,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: ${ia?na.a.xc(ia.Errors):null}.`),ia.Errors&&1===ia.Errors.length&&
((xa=this.oed(ia.Errors[0].MessageId))?this.kla("OkInvalidByServer",ia.Errors[0].MessageIdName):(this.kla("OkValid","None"),this.hide()),wa(xa)),d.ULS.sendTraceTag(537163275,0,15,`DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${na.a.xc(ia.Errors)}`)):this.hide()}}tSg(){const wa={};wa.Command=this.command;wa.RuleType=this.xd.ruleType;wa.ConditionType=this.xd.JB;wa.IsIgnoreBlank=this.xd.S4;wa.IsInCellDropDown=this.xd.T4;wa.LowerBoundary=this.xd.RN;wa.UpperBoundary=
this.xd.SN;wa.IsAlertBlocking=this.xd.GZ;wa.IsShowErrorAlert=this.xd.l5;wa.IsShowInputMessage=this.xd.m5;wa.AlertTitle=this.xd.xT;wa.AlertMessage=this.xd.wT;wa.InputTitle=this.xd.zF;wa.InputMessage=this.xd.dV;wa.ShouldIgnoreFormulaError=this.xNa;return wa}oed(wa){switch(wa){case 1173235830:return W.a.instance.ga(1720);case 43935303:return W.a.instance.ga(1721);case -1323438439:return W.a.instance.ga(1723);case 2112020473:return W.a.instance.ga(1717);case -219503282:return W.a.instance.ga(1718);case 1689335445:return W.a.instance.ga(1719);
case 2146493810:return W.a.instance.ga(1722);case -2104909922:return String.format(W.a.instance.mb(105),this.nub,this.lOd);case -869372599:return String.format(W.a.instance.mb(104),this.nub);case -1181828368:return W.a.instance.ga(1725);case -758480861:return W.a.instance.ga(1726);case -13729088:return W.a.instance.ga(1727);case -846654055:return W.a.instance.ga(1728);case 751854001:return W.a.instance.ga(1729);case -453846397:return W.a.instance.ga(1730);case 1102013489:return W.a.instance.ga(1731);
case 835813260:return W.a.instance.ga(1732);case 1577787509:return W.a.instance.ga(1733);case 2083564019:return W.a.instance.ga(1724);default:d.ULS.sendTraceTag(537163274,0,15,`DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: ${wa.toString()}.`)}return null}Ula(){this.kla("Cancel","None")}mW(wa){d.ULS.sendTraceTag(537163273,0,50,`DataValidationEditDialog ${1===wa?"Ok":"Cancel"} was clicked.`);wa={["ButtonType"]:pa.jia(wa),["DialogName"]:this.uc,["Location"]:"dialog",
["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.PK};B.b(this.$).Hd(k.a.D6b,wa)}kla(wa,ia){const xa={};pa.Bsb(this.xd,xa);xa.o=wa;xa.p=ia;xa.n=this.uka;this.ei&&(this.ei.stop(),xa.q=this.ei.id);z.b().Ne(49,xa,!0)}Sac(wa){this.xd.ruleType=wa.RuleType;this.xd.JB=wa.RuleOperatorType;this.xd.RN=wa.OperatorInput1;this.xd.SN=wa.OperatorInput2;this.xd.GZ=wa.IsAlertBlocking;this.xd.l5=wa.IsShowErrorAlert;this.xd.xT=wa.AlertTitle;this.xd.wT=wa.AlertMessage;this.xd.m5=wa.IsShowInputMessage;this.xd.zF=wa.InputTitle;
this.xd.dV=wa.InputMessage;this.xd.S4=wa.IsIgnoreBlank;this.xd.T4=wa.IsInCellDropDown;this.nub=wa.firstOperatorLabel;this.lOd=wa.secondOperatorLabel}SPb(wa,ia,xa){let gb,va;va=gb=null;if(!wa)return xa?(gb=String.format(W.a.instance.mb(105),this.nub,this.lOd),va="DataValidationEditNoMinMaxError"):(gb=String.format(W.a.instance.mb(104),this.nub),va="DataValidationEditNoValueError"),{returnValue:!1,errorString:gb,Eq:va};if(wa.length>J.n$f)return gb=W.a.instance.ga(1724),{returnValue:!1,errorString:gb,
Eq:va};if(ka.d(wa))return{returnValue:!0,errorString:gb,Eq:va};if(1===ia||2===ia||6===ia){if(!P.a.c5(wa))return gb=W.a.instance.ga(1717),{returnValue:!1,errorString:gb,Eq:va};if(1===ia&&!P.a.isInteger(wa))return gb=W.a.instance.ga(1718),{returnValue:!1,errorString:gb,Eq:va};if(6===ia){if(!P.a.isInteger(wa))return gb=W.a.instance.ga(1718),{returnValue:!1,errorString:gb,Eq:va};if(0>parseInt(wa,10))return gb=W.a.instance.ga(1719),{returnValue:!1,errorString:gb,Eq:va}}}return{returnValue:!0,errorString:gb,
Eq:va}}f0d(){let wa,ia;ia=wa=null;const xa=this.xd.RN,gb=this.xd.SN,va=T[this.xd.ruleType];var sa=X[this.xd.JB];if(0===va)return{returnValue:!0,errorString:wa,Eq:ia};sa=(0===sa||1===sa)&&3!==va&&7!==va;return!({errorString:wa,Eq:ia}=this.SPb(xa,va,sa)).returnValue||sa&&!({errorString:wa,Eq:ia}=this.SPb(gb,va,sa)).returnValue?{returnValue:!1,errorString:wa,Eq:ia}:sa&&(1===va||2===va||6===va)&&!ka.d(xa)&&!ka.d(gb)&&parseFloat(xa)>parseFloat(gb)?(wa=W.a.instance.ga(1722),{returnValue:!1,errorString:wa,
Eq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:wa,Eq:ia}}static jia(wa){switch(wa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Bsb(wa,ia){ia.a=e(wa.ruleType);ia.b=f(wa.JB);ia.c=!!wa.RN;ia.d=!!wa.SN;ia.e=wa.S4;ia.f=wa.T4;ia.g=wa.m5;ia.h=!!wa.zF;ia.i=!!wa.dV;ia.j=wa.l5;ia.k=wa.GZ;ia.l=!!wa.xT;ia.m=!!wa.wT}}Object(n.a)(pa,
"DataValidationEditDialog",U.a,[]);var Na=a(86);U=a(261);class Z{}Z.Jch="DataValidationDialogPanel";Z.Ich="DataValidationButtonPanel";Z.Hch="DataValidationButtonClearAll";Object(n.a)(Z,"CssClassNames",null,[]);class Ra extends O.a{constructor(wa,ia){super(wa);this.jba=this.kba=this.iba=null;this.Wnc=()=>{this.iba.checked?(this.kba.disabled=!1,this.jba.disabled=!1):(this.kba.disabled=!0,this.jba.disabled=!0);return!1};this.get_visible=this.Qja;this.set_visible=this.Fna;this.Ok=ia;this.kka()}get title(){return W.a.instance.ga(1707)}render(wa){wa.appendChild(this.domElement)}Qja(){return this.isVisible}Fna(wa){return this.isVisible=
wa}setFocus(){}dispose(){this.mk();this.Ok=this.kba=this.jba=this.iba=null;super.dispose()}kka(){this.domElement.innerHTML=J.dgh;this.iba=V.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");V.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.kba=V.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.jba=V.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.iba.checked=!0;this.Ij();this.Wnc(null)}GAa(wa){this.kba.value=
void 0===wa.zF||null===wa.zF?"":wa.zF;this.jba.value=void 0===wa.dV||null===wa.dV?"":wa.dV;this.iba.checked=wa.m5;this.Wnc(null)}Bpb(wa){wa.zF=this.kba.value;wa.dV=this.jba.value;wa.m5=this.iba.checked}Ij(){H.a.instance.ra(R.a.change,this.iba,this.Wnc);H.a.instance.ra(R.a.change,this.iba,this.Ok);H.a.instance.ra(R.a.change,this.kba,this.Ok);H.a.instance.ra(R.a.Qb,this.kba,this.Ok);H.a.instance.ra(R.a.change,this.jba,this.Ok);H.a.instance.ra(R.a.Qb,this.jba,this.Ok)}mk(){H.a.instance.Ba(R.a.change,
this.iba,this.Wnc);H.a.instance.Ba(R.a.change,this.iba,this.Ok);H.a.instance.Ba(R.a.change,this.kba,this.Ok);H.a.instance.Ba(R.a.Qb,this.kba,this.Ok);H.a.instance.Ba(R.a.change,this.jba,this.Ok);H.a.instance.Ba(R.a.Qb,this.jba,this.Ok)}}Object(n.a)(Ra,"DataValidationEditInputControl",O.a,[486,10,833]);class Da extends O.a{constructor(wa,ia){super(wa);this.L9=this.N9=this.PUa=this.hha=this.K9=null;this.Vnc=()=>{this.K9.checked?(this.hha.disabled=!1,this.PUa.disabled=!1,this.N9.disabled=!1,this.L9.disabled=
!1):(this.hha.disabled=!0,this.PUa.disabled=!0,this.N9.disabled=!0,this.L9.disabled=!0);return!1};this.get_visible=this.Qja;this.set_visible=this.Fna;this.Ok=ia;this.kka()}get title(){return W.a.instance.ga(1706)}render(wa){wa.appendChild(this.domElement)}Qja(){return this.isVisible}Fna(wa){return this.isVisible=wa}setFocus(){}dispose(){this.mk();this.Ok=this.N9=this.L9=this.PUa=this.hha=this.K9=null;super.dispose()}kka(){this.domElement.innerHTML=J.hgh;this.K9=V.DOMElementExtensions.getElementById(this.domElement,
"showAlertCheckBoxId");this.hha=V.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.PUa=V.DOMElementExtensions.getElementById(this.domElement,"warningId");this.N9=V.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.L9=V.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.K9.checked=!0;this.hha.checked=!0;this.Ij();this.Vnc(null)}GAa(wa){this.hha.checked=wa.GZ;this.PUa.checked=!wa.GZ;this.N9.value=void 0===wa.xT||null===
wa.xT?"":wa.xT;this.L9.value=void 0===wa.wT||null===wa.wT?"":wa.wT;this.K9.checked=wa.l5;this.Vnc(null)}Bpb(wa){wa.xT=this.N9.value;wa.wT=this.L9.value;wa.GZ=this.hha.checked;wa.l5=this.K9.checked}Ij(){H.a.instance.ra(R.a.change,this.K9,this.Vnc);H.a.instance.ra(R.a.change,this.K9,this.Ok);H.a.instance.ra(R.a.change,this.hha,this.Ok);H.a.instance.ra(R.a.change,this.PUa,this.Ok);H.a.instance.ra(R.a.change,this.N9,this.Ok);H.a.instance.ra(R.a.Qb,this.N9,this.Ok);H.a.instance.ra(R.a.change,this.L9,this.Ok);
H.a.instance.ra(R.a.Qb,this.L9,this.Ok)}mk(){H.a.instance.Ba(R.a.change,this.K9,this.Vnc);H.a.instance.Ba(R.a.change,this.K9,this.Ok);H.a.instance.ra(R.a.change,this.hha,this.Ok);H.a.instance.ra(R.a.change,this.PUa,this.Ok);H.a.instance.Ba(R.a.change,this.N9,this.Ok);H.a.instance.Ba(R.a.Qb,this.N9,this.Ok);H.a.instance.Ba(R.a.change,this.L9,this.Ok);H.a.instance.Ba(R.a.Qb,this.L9,this.Ok)}}Object(n.a)(Da,"DataValidationEditMessagesControl",O.a,[486,10,832]);class Ba{constructor(wa,ia){this.options=
this.cellRange=null;this.cellRange=wa;this.options=ia}}Object(n.a)(Ba,"MacroRecorderRangeDataValidationChangedPayload",null,[115]);var ea=a(1233);class Y extends U.a{constructor(wa,ia,xa,gb){super(wa);this.e3=this.gfc=this.zlc=this.HDb=null;this.xNa=this.disposed=this.uka=!1;this.ei=null;this.PAd=va=>{d.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");if(this.disposed)d.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");
else{if(r.a(va)){d.ULS.sendTraceTag(537163267,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: ${va?na.a.xc(va.Errors):null}.`);if(va.Errors&&1===va.Errors.length){const sa=va.Errors[0].MessageId,ab=this.oed(sa);if(ab){this.Jyj(sa)?this.Ytj(ab):this.Hr(ab);this.kla("OkInvalidByServer",va.Errors[0].MessageIdName);return}}d.ULS.sendTraceTag(537163266,0,15,`DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: ${na.a.xc(va.Errors)}`)}this.kla("OkValid",
"None");this.hide()}};this.P5c=va=>{this.mW(va);2!==va&&(this.ei=this.$.Jb.Bc("UserAction","DataValidationEditTimeToDialogTryClose"));1===va?this.w$a():2===va?this.Oya():this.Ula()};this.xca=()=>{this.UQj();this.xNa?this.kAe():this.Uze();return this.uka=!1};this.selectedRanges=ia;this.wSb=xa;this.command=gb;3===gb&&(this.uka=!0);this.Rb=2;this.Nv=!1;this.mg=J.mg}get xd(){return this.wSb}get uc(){return"DataValidationEditDialog"}QTd(){const wa={["key"]:this.xd};this.initializeAndShow(W.a.instance.ga(1670),
this.P5c,wa);d.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")}dispose(){this.disposed||(this.gfc=this.zlc=this.e3=null,Na.a.Ia(this.HDb),this.HDb=null,B.b(this.$)&&B.b(this.$).oVd("DataValidationDialogCorellation"),super.dispose(),this.disposed=!0)}get ly(){return()=>{this.mW(1);this.w$a()}}Cv(wa){super.Cv(wa);this.rc(2,W.a.instance.ga(1671));wa=this.cK(2);var ia=this.cK(1),xa=this.cK(0),gb=ia.parentNode;gb.appendChild(wa);gb.appendChild(ia);gb.appendChild(xa);
wa.parentNode.classList.add(Z.Ich);wa.classList.add(Z.Hch);wa=document.getElementById("dataValidationTabsId");ia=new da(this.$,document.createElement("div"),this.xca);xa=new Ra(document.createElement("div"),this.xca);gb=new Da(document.createElement("div"),this.xca);this.Hbi(ia,xa,gb);let va;this.HDb=new ea.a(wa,(va=new Q.a,va.add(ia),va.add(xa),va.add(gb),va));this.HDb.BSf();this.CU=document.getElementById("validationErrorMessageId");this.GAa();B.b(this.$)&&B.b(this.$).YUd("DataValidationDialogCorellation")}HI(){super.HI();
document.getElementById(this.ni("WACDialogPanel")).classList.add(Z.Jch)}get nY(){return!1}get k2b(){return 3===this.e3.U1g}oja(){return da.oja()}Eed(){return"validationErrorMessageId"}Hbi(wa,ia,xa){this.e3=wa;this.gfc=ia;this.zlc=xa}Imj(){const wa={};wa.IsClearAll=this.uka;wa.Command=this.command;wa.RuleType=this.xd.ruleType;wa.ConditionType=this.xd.JB;wa.IsIgnoreBlank=this.xd.S4;wa.IsInCellDropDown=this.xd.T4;wa.LowerBoundary=this.xd.RN;wa.UpperBoundary=this.xd.SN;wa.IsAlertBlocking=this.xd.GZ;wa.IsShowErrorAlert=
this.xd.l5;wa.IsShowInputMessage=this.xd.m5;wa.AlertTitle=this.xd.xT;wa.AlertMessage=this.xd.wT;wa.InputTitle=this.xd.zF;wa.InputMessage=this.xd.dV;wa.ShouldIgnoreFormulaError=this.xNa;const ia=this.$.pa.va.Tb(),xa=()=>new Ba(this.selectedRanges,wa);m.a(this.$.userOperationManager,(gb,va,sa)=>K(this.$.pa.va,this.selectedRanges,wa,y.b(gb,this.PAd),y.a(va),sa,ia),gb=>new u.a(121,0,gb,void 0,xa),null)}Jyj(wa){return 1577787509===wa}Ytj(wa){this.CU.innerText=wa;this.EI(this.cK(0));this.xNa=!0}kAe(){this.xNa=
!1;this.CU.innerText=""}oed(wa){switch(wa){case 1173235830:return W.a.instance.ga(1720);case 43935303:return W.a.instance.ga(1721);case -1323438439:return W.a.instance.ga(1723);case 2112020473:return W.a.instance.ga(1717);case -219503282:return W.a.instance.ga(1718);case 1689335445:return W.a.instance.ga(1719);case 2146493810:return W.a.instance.ga(1722);case -2104909922:return String.format(W.a.instance.mb(105),this.e3.Mvb(this.xd.ruleType,this.xd.JB),this.e3.Xgd(this.xd.ruleType,this.xd.JB));case -869372599:return String.format(W.a.instance.mb(104),
this.e3.Mvb(this.xd.ruleType,this.xd.JB));case -1181828368:return W.a.instance.ga(1725);case -758480861:return W.a.instance.ga(1726);case -13729088:return W.a.instance.ga(1727);case -846654055:return W.a.instance.ga(1728);case 751854001:return W.a.instance.ga(1729);case -453846397:return W.a.instance.ga(1730);case 1102013489:return W.a.instance.ga(1731);case 835813260:return W.a.instance.ga(1732);case 1577787509:return W.a.instance.ga(1733);case 2083564019:return W.a.instance.ga(1724);default:d.ULS.sendTraceTag(537163265,
0,15,`DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: ${wa.toString()}.`)}return null}w$a(){d.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Sac();let wa,ia;if(!({errorString:wa,Eq:ia}=this.f0d()).returnValue)return this.Hr(wa),this.kla("OkInvalidByClient",ia),!1;this.Imj();return!0}Ula(){this.Sac();this.kla("Cancel","None");this.hide()}Oya(){d.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");
this.xNa?this.kAe():this.Uze();this.dgj();this.uka=!0}mW(wa){wa={["ButtonType"]:Y.jia(wa),["DialogName"]:this.uc,["Location"]:"dialog",["NumberOfSelectedRanges"]:x.g(this.$).ha.sa.PK};B.b(this.$).Hd(k.a.D6b,wa)}dgj(){this.wSb=new w;this.GAa()}GAa(){this.zlc.GAa(this.xd);this.gfc.GAa(this.xd);this.e3.GAa(this.xd)}Sac(){this.e3.Bpb(this.xd);this.zlc.Bpb(this.xd);this.gfc.Bpb(this.xd)}kla(wa,ia){const xa={};Y.Bsb(this.xd,xa);xa.o=wa;xa.p=ia;xa.n=this.uka;this.ei&&(this.ei.stop(),xa.q=this.ei.id);z.b().Ne(49,
xa,!0)}SPb(wa,ia){let xa,gb;gb=xa=null;if(!wa)return ia?(xa=String.format(W.a.instance.mb(105),this.e3.Mvb(this.xd.ruleType,this.xd.JB),this.e3.Xgd(this.xd.ruleType,this.xd.JB)),gb="DataValidationEditNoMinMaxError"):(xa=String.format(W.a.instance.mb(104),this.e3.Mvb(this.xd.ruleType,this.xd.JB)),gb="DataValidationEditNoValueError"),{returnValue:!1,errorString:xa,Eq:gb};if(wa.length>J.n$f)return xa=W.a.instance.ga(1724),{returnValue:!1,errorString:xa,Eq:gb};if(ka.d(wa))return{returnValue:!0,errorString:xa,
Eq:gb};if(1===this.xd.ruleType||2===this.xd.ruleType||6===this.xd.ruleType){if(!P.a.c5(wa))return xa=W.a.instance.ga(1717),{returnValue:!1,errorString:xa,Eq:gb};if(1===this.xd.ruleType&&!P.a.isInteger(wa))return xa=W.a.instance.ga(1718),{returnValue:!1,errorString:xa,Eq:gb};if(6===this.xd.ruleType){if(!P.a.isInteger(wa))return xa=W.a.instance.ga(1718),{returnValue:!1,errorString:xa,Eq:gb};if(0>parseInt(wa,10))return xa=W.a.instance.ga(1719),{returnValue:!1,errorString:xa,Eq:gb}}}return{returnValue:!0,
errorString:xa,Eq:gb}}f0d(){let wa,ia;ia=wa=null;if(this.uka||0===this.xd.ruleType)return{returnValue:!0,errorString:wa,Eq:ia};const xa=(0===this.xd.JB||1===this.xd.JB)&&3!==this.xd.ruleType&&7!==this.xd.ruleType;return!({errorString:wa,Eq:ia}=this.SPb(this.xd.RN,xa)).returnValue||xa&&!({errorString:wa,Eq:ia}=this.SPb(this.xd.SN,xa)).returnValue?{returnValue:!1,errorString:wa,Eq:ia}:xa&&(1===this.xd.ruleType||2===this.xd.ruleType||6===this.xd.ruleType)&&!ka.d(this.xd.RN)&&!ka.d(this.xd.SN)&&parseFloat(this.xd.RN)>
parseFloat(this.xd.SN)?(wa=W.a.instance.ga(1722),{returnValue:!1,errorString:wa,Eq:"DataValidationEditMaximumLessMinimumError"}):{returnValue:!0,errorString:wa,Eq:ia}}set ly(wa){super.ly=wa}static jia(wa){switch(wa){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return d.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}}static Bsb(wa,ia){ia.a=e(wa.ruleType);ia.b=f(wa.JB);ia.c=!!wa.RN;ia.d=!!wa.SN;ia.e=
wa.S4;ia.f=wa.T4;ia.g=wa.m5;ia.h=!!wa.zF;ia.i=!!wa.dV;ia.j=wa.l5;ia.k=wa.GZ;ia.l=!!wa.xT;ia.m=!!wa.wT}}Object(n.a)(Y,"DataValidationEditDialogDeprecated",U.a,[]);var ja=a(1);class ca{THa(wa,ia,xa,gb){ja.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new pa(wa,ia,xa,gb)).QTd():(new Y(wa,ia,xa,gb)).QTd()}G5g(wa,ia){const xa=new F.StandardDialog;xa.Rb=3;xa.ZAa(wa.rb.mja,W.a.instance.ga(1715),ia)}I5g(wa,ia){const xa=new F.StandardDialog;xa.Rb=1;xa.JW(wa.rb.mja,
W.a.instance.ga(1716),ia)}}Object(n.a)(ca,"DataValidationEditDialogFactory",null,[709]);class ba extends b.a{constructor(wa){super(wa)}vd(){this.$c([new I(this.$,new ca)])}static ka(wa){b.a.Od(245,new ba(wa))}}Object(n.a)(ba,"DataValidationEditCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return ua});const ua=()=>{c.a.Fa(ba.ka)}},1150:function(n,C,a){function c(oa,Oa,Wa,Sa,yb,Ma){if(0===Sa)return Object(ea.a)(ma.UnsupportedZeroResize);if(0>Sa||0===Wa.length)return Object(ea.a)(ma.InvalidInput);
if(oa.O5h())return Object(ea.a)(ma.UnsupportedSkeletonInView);const Bb=oa.Zd;if(!Bb)return Object(ea.a)(ma.NullSPD);var Nb=Bb.T_e(Wa);if(Nb&&0<Nb.length)return Object(ea.a)(Nb.length.toString()+" "+ma.UnsupportedHiddenInRange);a:{for(const jb of Wa)yb?jb.right=K.a.ph:jb.bottom=K.a.eh;Nb=oa.J$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",Wa);try{for(Nb.$$rst();Nb.$$mn();)if(Nb.Sn.QDj){var Ia=!0;break a}}finally{Nb&&Nb.dispose()}Ia=!1}if(Ia)return Object(ea.a)(ma.UnsupportedMergeCell);if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!yb&&"undefined"!==typeof gridRenderer)for(const jb of Wa)gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(jb.left);oa=oa.Ea;Ia=ra.a.create().toString();Bb.jfg(Wa,Sa,yb);Ma=oa.DQj(yb,Ma);Oa.j7i(Wa,yb);oa.n3i(Ma,Ia,yb?"row":"column");return Object(ea.d)(Sa)}var b=a(9);n=a(0);var d=a(222),f=a(7),e=a(15),k=a(86);a(263);var l=a(187),m=a(414),u=a(82),t=a(774),w=a(186),r=a(266),v=a(24),y=a(873),x=a(43);class B{}B.uFh="GalleryGeneral";B.wFh="GalleryNumber";B.sFh="GalleryCurrency";B.qFh="GalleryAccounting";
B.zFh="GalleryShortDate";B.vFh="GalleryLongDate";B.BFh="GalleryTime";B.xFh="GalleryPercentage";B.tFh="GalleryFraction";B.yFh="GalleryScientific";B.AFh="GalleryText";B.GTg="ButtonComma";B.buttonPercentage="ButtonPercentage";B.keyboardNumber="KeyboardNumber";B.keyboardCurrency="KeyboardCurrency";B.keyboardDate="KeyboardDate";B.keyboardTime="KeyboardTime";B.keyboardPercentage="KeyboardPercentage";Object(n.a)(B,"RibbonFormatKind",null,[]);var z=a(61),A=a(294),I=a(620),F=a(619),U=a(618),X=a(1);class T extends A.a{constructor(oa,
Oa,Wa,Sa,yb,Ma,Bb,Nb,Ia,jb,Ob,Jb=null,Kb=null){super(11,0,Nb,Ob);this.SDh=oa;this.jcd=Oa;this.format=Sa;this.activeCell=Wa;this.Fse=yb;this.vIf=Ma;this.qIf=Bb;this.vFa=Ia;this.clientCorrelationId=jb;this.Ylb=Jb;this.qib=Kb}get WF(){return X.EwaSettings.$b()?super.WF:0}get It(){return this.Ylb}get naa(){return this.qib}get $Cc(){return this.vFa}G2(oa){return super.G2(oa)||this.SDh.G2(this.jcd,this.activeCell,this.format,this.Fse,this.vIf,this.qIf,this.D_b,this.vFa,this.clientCorrelationId,this.Ylb,
this.qib)}Qj(){const oa=[];if(this.$cc)for(const Oa of this.$cc)oa.push(U.a(Oa));else oa.push(new F.a(this.format,this.jcd,this.activeCell));return()=>new I.a(oa)}Teb(){const oa={OperationType:0};oa.FormatCellsMultiRange=this.jcd;oa.ActiveCell=this.activeCell;oa.Format=this.format;oa.ApplyFormatOnPivotTableValueField=this.Fse;oa.PivotTableXluid=this.vIf;oa.PivotTableFieldCaption=this.qIf;return oa}}Object(n.a)(T,"FormatCellsBatchOperation",A.a,[]);var G=a(33),D=a(208);class J{}J.editCell="Edited";
J.dependentCell="Dependents";Object(n.a)(J,"RecalcPriorityGroupType",null,[]);var L=a(197);const H=oa=>{switch(oa.alignment){case "Center":return 2;case "Left":return 1;case "Right":return 3;default:return e.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}},R=oa=>{if(oa=oa.color){if("String"===Object.getType(oa).getName())return L.a.pp(oa);if("Number"===Object.getType(oa).getName())return null}else return null;e.ULS.sendTraceTag(537162193,
0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null},Q=(oa,Oa)=>{oa=excelOnlineCalc.calc.getCellValueKind(oa.rangeDelta.data.value);switch(oa){case "number":case "string":case "boolean":return!0;case "Blank":return!0;case "Error":if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;Oa.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return Oa.numberOfUnsupportedRichCellTypes++,!1;default:return e.ULS.shipAssertTag(537162192,
0,!1,`CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type ${oa}`),!1}},O=oa=>{oa=excelOnlineCalc.calc.getCellValueKind(oa.rangeDelta.data.value);let Oa=0;switch(oa){case "number":Oa=1;break;case "string":Oa=2;break;case "boolean":Oa=3;break;case "Error":Oa=4;break;case "Blank":Oa=0;break;default:e.ULS.shipAssertTag(537162191,0,!1,`CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type ${oa}`)}return Oa},V=oa=>{const Oa=oa.value;switch(oa.type){case 2:return void 0===
Oa||null===Oa?"":Oa;case 1:return oa=parseFloat(Oa),isNaN(oa)?null:oa;case 3:return oa=parseFloat(Oa),isNaN(oa)?null:1===oa;case 4:return oa=parseFloat(Oa),isNaN(oa)?null:excelOnlineCalc.calc.errorValue(oa);default:return excelOnlineCalc.calc.blankValue}},W=(oa,Oa)=>{const Wa=da(Oa);var Sa=!(void 0===Oa.rangeDelta.data.format||null===Oa.rangeDelta.data.format);e.ULS.shipAssertTag(537162187,0,0===Wa||!Sa,`CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only ${Oa.priorityGroup}`);
oa=Math.max(oa.cell.Nk,0);Sa&&(Sa=excelOnlineCalc.calc.getCellFormatKind(Oa.rangeDelta.data.format.format),"number"===Sa?oa=Oa.rangeDelta.data.format.format:"string"===Sa?e.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===Sa?e.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):e.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));
return oa},da=oa=>{if(oa.priorityGroup===J.editCell)return 0;if(oa.priorityGroup===J.dependentCell)return 1;e.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2},ta=oa=>{oa=da(oa);if(0===oa)return 1;if(1===oa)return 2;e.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0};var K=a(8);class na{constructor(oa=0,Oa="",Wa=0,Sa="",yb=""){this.DJ=oa;this.cellValue=Oa;this.ifmt=
Wa;this.priorityGroup=Sa;this.Vx=yb}}Object(n.a)(na,"RecalcAccuracyObject",null,[]);class P{}P.string="String";P.blank="Blank";P.general="General";P.DCh="Flexible";Object(n.a)(P,"FormattedUnitKind",null,[]);class ka{constructor(oa=0,Oa=0,Wa=0,Sa=0,yb=0,Ma=0,Bb=0,Nb=0,Ia=0,jb=0,Ob=0,Jb=0,Kb=0,Qa=0,ha=0,qa=!1,pb="",bb=0,eb=null,Fa=null,tb=null,dc=null,jc=null,fb=null,ec=null){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=
this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=
this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=oa;this.numberOfNonUpdatedCells=Oa;this.numberOfUpdatedCells=Wa;this.numberOfCellsUpdatedAlreadyByServer=Sa;this.numberOfCellsSkippedDueToTimeout=yb;this.numberOfCellsWithNoFormattedCell=Ma;this.numberOfUnsupportedErrorCellTypes=Bb;this.numberOfUnsupportedBlankCellTypes=
Nb;this.numberOfUnsupportedRichCellTypes=Ia;this.numberOfSkippedCellsDueToMissingLocaleInfo=jb;this.totalExecutionTime=Ob;this.originalProcessingTimeLimit=Jb;this.newProcessingTimeLimit=Kb;this.numberOfEditedRecalcedCellsInBatch=Qa;this.numberOfDependentRecalcedCellsInBatch=ha;this.isNewTask=qa;this.lastSetCellInstantaneousOperation=pb;this.taskId=bb;this.isNewNumberFormatter=eb;this.numberOfRecalcedCellsWithFormattedValue=Fa;this.numberOfRecalcedCellsWithoutFormattedValue=tb;this.totalNumberFormatterTime=
dc;this.newNumberFormatterFinalizeFailures=jc;this.numberOfMeasureTextWidthCalls=fb;this.numberOfHashFormattedValues=ec}}Object(n.a)(ka,"RecalcResultProcessingStatistics",null,[]);class pa{constructor(oa,Oa,Wa,Sa){this.rangeDelta=oa;this.stateId=Oa;this.isFinished=Wa;this.priorityGroup=Sa}}Object(n.a)(pa,"RecalcedCellInfo",null,[]);var Na=a(109),Z=a(11),Ra=a(22),Da=a(55),Ba=a(64),ea=a(458);class Y{constructor(oa,Oa,Wa){this.$ca=[];this.calcManager=this.Pzc=this.lastSetCellInstantaneousOperation=null;
this.bLf=Sa=>{var yb;if(Sa&&Sa.rangeDeltas){var Ma=this.$ca.length;for(let Bb=0;Bb<Sa.rangeDeltas.length;Bb++)(null===(yb=Sa.rangeDeltas[Bb])||void 0===yb?0:yb.data)&&void 0!==Sa.rangeDeltas[Bb].data.value&&null!==Sa.rangeDeltas[Bb].data.value&&void 0!==Sa.rangeDeltas[Bb].range&&null!==Sa.rangeDeltas[Bb].range&&this.$ca.push(new pa(Sa.rangeDeltas[Bb],Sa.stateId,Sa.isFinished,Sa.priorityGroup));e.ULS.sendTraceTag(574993422,0,50,`CalcResultProcessor.ProcessResults stateId=${Sa.stateId}, priorityGroup=${Sa.priorityGroup}, recalcFinished=${Sa.isFinished}, cellsFromCalc=${Sa.rangeDeltas.length}, initialCellsToRender=${Ma}, recalcedCells=${this.$ca.length}, lastSetCellInstantaneousOperation=${this.lastSetCellInstantaneousOperation}`);
!Ma&&this.$ca.length&&this.MCf(!1,0)}};this.$=oa;this.grid=Oa;this.xg=Wa;this.Wca=Y.THe;this.$.da.Za(268,Sa=>{this.Pzc=Sa});this.$.da.Za(266,Sa=>{this.calcManager=Sa});this.VAb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.zsd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.upi=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker")}dispose(){this.calcManager=
this.Pzc=this.xg=this.grid=this.$=null}Vad(oa,Oa,Wa,Sa,yb,Ma,Bb){if(!Oa)return Object(ea.a)("Null");var Nb=excelOnlineCalc.numfmt.renderCallback(Sa,jb=>gridRenderer.CanvasRendererGlobals.measureTextWidth(jb,yb,!0,X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1)),Bb);let Ia=oa.renderValue(Oa,Nb);if(!excelOnlineCalc.util.isSuccess(Ia))return Object(ea.a)("Finalize");Sa=null;if(Bb=excelOnlineCalc.numfmt.isHashesValue(Ia.value)){if(Ia=oa.renderHashesValue(Ia.value,
Nb),!excelOnlineCalc.util.isSuccess(Ia))return Object(ea.a)("Hashes")}else Sa=Y.cEh(Oa,Ia.value);Nb=Ia.value;oa=excelOnlineCalc.numfmt.renderedValueToString(Nb);Oa=H(Nb);Nb=R(Nb);return Object(ea.d)({text:oa,valueType:Wa,fontColor:Nb,Nk:Ma,POa:Sa,horizontalAlignment:Oa,isHashesValue:Bb})}MCf(oa,Oa){this.$&&this.grid&&this.calcManager&&this.Pzc&&this.calcManager.tD?(oa&&(this.Wca=this.Pzc.Kbf),this.F1i(this.grid,this.calcManager.tD,oa,Oa),!this.Wca&&this.$ca.length?Da.Task.delay(0).fp(Wa=>{this.MCf(!0,
Wa.id);return!0},0,null,Ba.a.current):Da.Task.Ta(!0)):(e.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Da.Task.Ta(!1))}F1i(oa,Oa,Wa,Sa){const yb=Z.HelperMethods.Sb();for(Wa=new ka(this.$ca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,this.Wca,void 0,void 0,void 0,Wa,void 0,Sa,!0,0,0,0,0,0,0);0<this.$ca.length;){Sa=Z.HelperMethods.Sb()-yb;if(!this.Wca||Sa>this.Wca){Wa.numberOfCellsSkippedDueToTimeout=
this.$ca.length;break}Sa=Array.dequeue(this.$ca);if(Q(Sa,Wa)){var Ma=v.Range.Uc(Sa.rangeDelta.range.row+1,Sa.rangeDelta.range.column+1);(Ma=oa.Vb(Ma))?Y.xVg(Sa.stateId,Ma.cell)?(Y.smc(oa,Ma,Sa,Wa),this.cMg(Oa,Ma,Sa,Wa)):Wa.numberOfCellsUpdatedAlreadyByServer++:Wa.numberOfCellsWithNoFormattedCell++}}Sa=Math.round(Z.HelperMethods.Sb()-yb);this.dUj(Sa);this.QGj(Wa,Sa);this.mfj(Wa)}cMg(oa,Oa,Wa,Sa){var yb,Ma,Bb,Nb,Ia=W(Oa,Wa);const jb=Wa.rangeDelta.data.formatted,Ob=O(Wa),Jb=da(Wa);oa=this.Vad(oa,jb,
Ob,Oa.cell.tBa,Oa.cell.aia,Ia,!1);Ia=Oa.cell.mEc;if(Object(ea.c)(oa))if(this.VAb&&this.zsd){if(0===Jb||Oa.text!==oa.value.text)this.upi&&0===Jb&&this.rSd(Ia,oa.value)&&(Oa.cell.li=Ia),this.xg.QZa(Oa,oa.value),Wa=ta(Wa),this.xg.F8c(Oa,this.lastSetCellInstantaneousOperation,2,Wa,!0,!0),0===Jb&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")&&(this.calcManager?this.calcManager.Rtf(Oa.range):e.ULS.sendTraceTag(521171802,0,15,"CalcResultsProcessor.applyRecalcResultOnCell: Unable to call notifyEditedCellRecalcComplete as calcManager member is null.")),
Sa.numberOfUpdatedCells++}else Oa.text!==oa.value.text&&(this.xg.QZa(Oa,oa.value),Wa=ta(Wa),this.xg.F8c(Oa,this.lastSetCellInstantaneousOperation,2,Wa,!0,!0),Sa.numberOfUpdatedCells++);else switch(oa.reason){case "Null":Sa.numberOfRecalcedCellsWithoutFormattedValue=(null!==(yb=Sa.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==yb?yb:0)+1;break;case "Hashes":Sa.numberOfHashFormattedValues=(null!==(Ma=Sa.numberOfHashFormattedValues)&&void 0!==Ma?Ma:0)+1;break;case "Finalize":Sa.newNumberFormatterFinalizeFailures=
(null!==(Bb=Sa.newNumberFormatterFinalizeFailures)&&void 0!==Bb?Bb:0)+1}Object(ea.b)(oa)&&"Null"!==oa.reason&&(Sa.numberOfRecalcedCellsWithFormattedValue=(null!==(Nb=Sa.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Nb?Nb:0)+1);Sa=0===Jb?Oa.cell.userInput:Oa.formulaBarText;Nb=Object(ea.c)(oa)?oa.value.text:"";Wa=Object(ea.b)(oa)?oa.reason:"";e.ULS.sendTraceTag(537162180,0,50,`CalcResultProcessor.ApplyRecalcResultOnCell: (${Oa.range.top}, ${Oa.range.left}) 2nd pass formatting, success: ${oa.success}, reason: ${Wa}, priority: ${Jb}, ifmt: ${Oa.cell.Nk}, input: '${Sa?
Ra.a.nM(Sa):"null"}', prediction: '${Nb?Ra.a.nM(Nb):"null"}',`)}dUj(oa){this.Wca=Math.max(this.Wca-Math.max(oa,1),0)}QGj(oa,Oa){oa.numberOfNonUpdatedCells=this.$ca.length;oa.totalExecutionTime=Oa;oa.newProcessingTimeLimit=this.Wca;oa.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation}mfj(oa){oa=Sys.Serialization.JavaScriptSerializer.serialize(oa);e.ULS.sendTraceTag(574993417,0,50,`CalcResultProcessor.ReportRecalcProcessingStatistics:${oa}`)}static cEh(oa,Oa){oa=oa.units;var Wa=
Oa.units;if(oa.length!==Wa.length)return e.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;Oa=[];let Sa=-1;for(let yb=0;yb<oa.length;yb++)switch(oa[yb].kind){case P.blank:Oa.push(...Na.h(" ",Wa[yb].str.length));break;case P.string:Oa.push(oa[yb].str);break;case P.DCh:Oa.push("");Sa=yb;break;case P.general:Oa.push(Wa[yb].str);break;default:e.ULS.sendTraceTag(537162178,
0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=Sa||""===Wa[Sa].str)return null;Wa={};Wa.Start=Oa.slice(0,Sa).join("");Wa.Separator=oa[Sa].str;Wa.End=Oa.slice(Sa+1,Oa.length).join("");return Wa}static KKh(oa){return oa&&oa&&oa.$x?oa.$x.BJ:K.a.Be}static xVg(oa,Oa){if(!Oa)return!1;Oa=Y.KKh(Oa);return Oa===K.a.Be||Oa===oa}static smc(oa,Oa,Wa,Sa){var yb=Wa.rangeDelta.data.value.toString();const Ma=O(Wa),Bb=W(Oa,Wa);yb=new na(Ma,yb,Bb,Wa.priorityGroup);Oa.cell.smc(yb,
oa.Ea.z5);1===da(Wa)?Sa.numberOfDependentRecalcedCellsInBatch++:Sa.numberOfEditedRecalcedCellsInBatch++}rSd(oa,Oa){return null==oa?!1:!!oa.TextRuns&&!!oa.Fonts&&oa.Text===Oa.text&&2===Oa.valueType}}Y.THe=20;Object(n.a)(Y,"CalcResultProcessor",null,[302,10]);class ja{constructor(oa,Oa=null,Wa=""){this.success=oa;this.ymc=Oa;this.reason=Wa}}Object(n.a)(ja,"GetRibbonNumberFormatResult",null,[]);var ca=a(910);class ba{constructor(oa,Oa){this.xx=null;this.Ea=oa;this.b3a=Oa}cdb(oa,Oa,Wa,Sa,yb=!1,Ma=!1){oa&&
(oa.u0(Oa,Wa,yb,Ma),oa.verticalAlignment=Sa)}lLb(oa,Oa,Wa){this.xx||(this.xx=new ca.a(this.Ea,this.b3a));this.xx.lLb(oa,Oa,Wa)}}Object(n.a)(ba,"FormatCellsActionModelAccessor",null,[300]);var ua=a(209),wa=a(28),ia=a(29),xa=a(282),gb=a(250),va=a(281),sa=a(75);class ab{constructor(){this.Ugg=this.kXj=!1;this.source=0;this.Dwa=this.Thc=!1}}Object(n.a)(ab,"FormatCellInstantaneousResult",null,[]);class Ua{constructor(oa,Oa){this.success=oa;this.Vx=Oa}}Object(n.a)(Ua,"FormatStringResult",null,[]);var nb=
a(21),Ha=a(200),sb=a(1084),Qb=a(42),mb=a(519),Pb=a(51),gc=a(199),Xb=a(262),Ca=a(79),ra=a(173),ma;(function(oa){oa.InvalidInput="invalid input";oa.UnsupportedZeroResize="resizing to 0 - ignore";oa.UnsupportedSkeletonInView="skeleton in view - ignore";oa.NullSPD="ActiveSheetProcessedData is null";oa.UnsupportedHiddenInRange="hiddens in resizeRanges";oa.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(ma||(ma={}));Object(n.b)("InstantaneousRowColumnResizeFailureReason",ma);
var hb=a(176);class vb{constructor(oa){this.xx=this.calcManager=this.dy=this.cTa=null;this.dYg=Oa=>{if(Oa){const Wa=Z.HelperMethods.yO.hasOwnProperty(Oa);Oa=nb.g(this.$).isFontSupported(Oa);return!Wa&&Oa}e.ULS.sendTraceTag(512340115,0,15,"FormatCellsAction.checkIfNewFont: fontName cannot be null");return!1};this.EKi=(Oa,Wa)=>{if(Oa&&!xa.a(Oa)&&Wa){const Sa=!!Oa&&!!Oa.RequestTelemetryData;nb.g(this.$).Pi.vla(Wa.toString(),Oa.StateId,Sa?Oa.RequestTelemetryData.EcsOperationDuration:0,Sa?Oa.RequestTelemetryData.EcsRequestDuration:
0,Sa?Oa.RequestTelemetryData.WfeRequestDuration:0)}};this.$=oa;this.$.da.Za(268,Oa=>{this.dy=Oa});this.TDh=new ba(nb.g(this.$).Ea,this.$);this.vha=new Y(this.$,nb.g(this.$),this);this.$.da.Za(266,Oa=>{this.calcManager=Oa});this.xb=X.EwaSettings.xb();this.Qm=X.EwaSettings.Qm();this.VAb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.zsd=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2");this.oNa=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",
!1);this.vpi=X.EwaSettings.isChangeGateEnabled("OfficeVSO:6280164_fixRTEregressionInMovingNFToWebWorker");this.Bl=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)}get Xua(){return this.TDh}get tD(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.tD}get localeInfo(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}dispose(){k.a.qc([this.cTa,this.vha]);this.$=this.vha=this.cTa=null}TSa(oa,
Oa,Wa,Sa,yb=!1,Ma="",Bb,Nb=0,Ia=null){return this.DAj(oa,Oa,Wa,yb,Nb,Ma,void 0,Ia)}F8c(oa,Oa,Wa,Sa,yb,Ma){oa.cell.$x.NJ|=Sa;vb.G1g(nb.g(this.$),oa,Wa,yb);this.vha.lastSetCellInstantaneousOperation=Oa;Ma&&nb.g(this.$).Pi.D0(Oa,sa.BasicTelemetryCalculator.NQ)}Vda(oa,Oa,Wa,Sa=!1,yb=null,Ma=null){Ma=Ma||oa.ha.sa.selectedRanges;if(!(-1690267012===Oa&&1<Ma.length)){-1690267012===Oa&&e.ULS.shipAssertTag(537162176,0,1===Ma.length,`FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = ${Ma.length}`);
Ma=oa.J$("FormatCellsAction.ShowInstantaneousFormatting",Ma);try{Ma.$$rst();let Bb=!1;for(;Ma.$$mn();){let Nb;const Ia=Ma.$$cu().QH?oa.JKb(Ma.$$cu().range):(Nb=new l.a,Nb.add(Ma.$$cu()),Nb);for(let jb of Ia)if(nb.g(this.$),!jb||Ma.hb.contains(jb.range))if(this.V4f(Oa,jb,Wa,Sa,yb,Ma.$$cu().QH),Bb||(oa.Ea.gV(),Bb=!0),yb)break}}finally{Ma&&Ma.dispose()}}}QZa(oa,Oa,Wa=null){Wa&&(Wa.Dwa=!0);Wa=!Oa.text;const Sa=Ra.a.Jgf(Oa.text);let yb;const Ma=oa.QH?nb.g(this.$).JKb(oa.range):(yb=new l.a,yb.add(oa),yb);
for(let Bb of Ma)this.aMg(this.$,Bb,Oa.text,Oa.horizontalAlignment,Oa.fontColor,Oa.Nk,oa.cell.Nk,Wa,Sa,Oa.valueType,Oa.POa);oa.cell.PCc()}AXi(oa,Oa,Wa,Sa,yb=null){try{const Ma=x.D(Oa);let Bb=x.D(Wa);if(oa.Fb.X6a(Ma)||oa.Fb.X6a(Bb))return 8;if(-185374993!==Sa&&this.nni(oa,Ma,Bb))return 9;if(-185374993!==Sa&&(oa.Fb.g5(Bb)||oa.Fb.pAb(Ma)))return 10;if(1804571062!==Sa&&oa.Fb.e5(Bb))return 11;if(this.Kih(Bb))return 12;if(this.goi(Ma,Bb))return 13;const Nb=this.$.Jb.Bc("UserAction","PasteInstantaneous");
Nb.start();mb.a(Nb);yb&&Pb.b().KA(Nb.id,yb.id,"actions","actions");!Ma.isSingle&&Bb.isSingle&&(Bb=vb.expandRange(Ma,Bb),oa.ha.updateSelection(Bb,Bb,0));switch(Sa){case 237279923:case 808159687:if(!this.SXi(Ma,Bb))return 14;this.r3c(oa,Ma,Bb,!0,!1);break;case 1804571062:this.r3c(oa,Ma,Bb,!0,!1);break;case -185374993:this.r3c(oa,Ma,Bb,!1,!0);break;default:return 2}e.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Ma){return e.ULS.sendTraceTag(537162145,
0,10,`FormatCellsAction.PasteInstantaneous: failed with the following error: ${JSON.stringify(Ma)}`),15}}BZg(oa,Oa){for(const Wa of oa)this.W0c(Wa,!0,Oa)}W0c(oa,Oa,Wa=""){if(oa){var Sa=nb.g(this.$);if(Oa){if(Oa=Sa.uk("FormatCellsAction.ClearRangeInstantaneous",oa),Sa=oa.isSingle?null:oa,Oa.$$mn()&&void 0!==Oa.$$cu()&&null!==Oa.$$cu())for(oa=Object(f.a)(new Xb.a,{Text:""}),this.TSa(Oa.$$cu(),oa,!1,void 0,G.a.wpd(this.$),Wa,void 0,void 0,Sa);Oa.$$mn();)void 0!==Oa.$$cu()&&null!==Oa.$$cu()&&this.TSa(Oa.$$cu(),
oa,!1,void 0,!1,Wa)}else this.Vda(Sa,-1228228458,{},void 0,void 0,[oa])}else e.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")}j7i(oa,Oa){if(!Oa){Oa=Z.HelperMethods.Sb();var Wa=nb.g(this.$),Sa=Wa.J$("FormatCellsAction.ReformatCells",oa);try{Sa.$$rst();let yb=!1;for(;Sa.$$mn();){const Ma=Sa.$$cu().cell;if(0===Ma.DJ||2===Ma.DJ)this.updateSpillInformation(Ma,oa),yb||(Wa.Ea.gV(),yb=!0)}}finally{Sa&&Sa.dispose()}e.ULS.sendTraceTag(537162143,
0,50,`FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: ${Z.HelperMethods.Sb()-Oa}.`)}}Ajd(oa,Oa){if(this.xb){if(oa.formulaBarText)return!Ra.a.equals(Oa.Text,oa.formulaBarText,!1);let Wa=oa.cell.li;Wa=gb.a(Wa,oa.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(Wa,Oa).isEqual}return!Ra.a.equals(Oa.Text,oa.text,!1)}KVe(oa,Oa,Wa,Sa){if(void 0===Oa||null===Oa)return new Ua(!1,oa);const yb={};yb.value=oa;yb.type=1;Oa=this.w3a(yb,Oa,Wa,
Sa);return Object(ea.b)(Oa)?new Ua(!1,oa):new Ua(!0,Oa.value.text)}EAj(oa,Oa,Wa,Sa){return c(oa,this,Oa,Wa,Sa,!0)}BAj(oa,Oa,Wa){if(!this.Ajd(Oa,Wa))return Object(ea.d)("Skip unchanged cell content");Oa=Oa.cell;Wa=this.MVe(Wa.Text,Oa.Nk,Oa.tBa,Oa.aia,!0);if(Object(ea.b)(Wa))oa=Wa;else{Wa=Wa.value;var Sa=Oa.hasRichValueIcon?"Unsupported rich value icon":Oa.a8?"Unsupported wrapped text":Oa.xjf||null!=Oa.zL&&0!==Oa.zL?"Unsupported rotated text":!0;!0!==Sa?oa=Object(ea.a)(Sa):(Oa.isCellWidthFixed?Sa="Skip fixed width cell":
(Sa=Wa.valueType,Sa=0===Sa?"Skip empty cell value":2===Sa?"Skip string cell value":Oa.FF&&!Oa.gni?"Skip merged cell":Oa.Fyc?"Skip shrunk to fit":Wa.isHashesValue?"Skip hashes cell value":!0),!0!==Sa?oa=Object(ea.d)(Sa):(Wa=Oa.h3g(Wa.text),Wa>Oa.offsetWidth?(Oa=[Oa.getRange().clone()],oa=c(oa,this,Oa,Wa,!1,!1),oa=Object(ea.b)(oa)?oa:Object(ea.d)(Wa)):oa=Object(ea.d)("Column is wide enough")))}return oa}JVe(oa,Oa,Wa,Sa,yb){const Ma={};Ma.value=oa;Ma.type=Wa;Oa=this.w3a(Ma,Oa,Sa,yb);return Object(ea.b)(Oa)?
new Ua(!1,oa):new Ua(!0,Oa.value.text)}updateSpillInformation(oa,Oa){const Wa=oa.getRange();let Sa=!1;for(const yb of Oa)if(Wa.left===yb.left){Sa=!0;break}oa.TQj(Sa)}DAj(oa,Oa,Wa,Sa,yb,Ma="",Bb=1,Nb=null){this.VAb&&this.vpi&&(oa.cell.mEc=Oa);const Ia=new ab;Ia.source=0;Ia.Dwa=!1;oa.cell.aGb=oa.cell.Nk;let jb=Oa.Text;const Ob=!jb,Jb=Ra.a.Jgf(jb);Ra.a.Kq(jb)&&(e.ULS.shipAssertTag(537162142,0,!((void 0===jb||null===jb)&&void 0!==Oa.TextRuns&&null!==Oa.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),
Oa=Object(f.a)(new Xb.a,{Text:""}),jb="");oa.cell.userInput=jb;if(!this.Ajd(oa,Oa))return this.cXg(oa,yb,Ob,Jb,Ia);Wa?this.WWg(oa,jb,this.$.workbookContext.DefaultHyperlinkStyle,Ia):this.QWg(oa,Oa,jb,Ob,Jb,Sa,Ia,Nb);this.F8c(oa,Ma,yb,Bb,Ia.Thc,Ia.Dwa);return Ia}cXg(oa,Oa,Wa,Sa,yb){yb.Ugg=!0;yb.Thc=!0;yb.Dwa=!1;0===Oa&&nb.g(this.$).Ea.gV();0===oa.cell.jza&&(Wa?oa.cell.u0(0,!1):Sa&&oa.cell.u0(1,!1));this.QYd(oa.range,"FormatCellsAction.cellUnchangedDataEntryCSE");return yb}WWg(oa,Oa,Wa,Sa){Sa.Dwa=!0;
oa.insertHyperlink(Oa,D.a.Dbd(Oa),Wa);this.QYd(oa.range,"FormatCellsAction.cellDataEntryCSE")}QWg(oa,Oa,Wa,Sa,yb,Ma,Bb,Nb=null){Bb.Dwa=!1;const Ia=oa.cell;let jb=!1;this.dy||(this.dy=this.$.da.za(268));this.EMj(this.dy,Ia.Nk);X.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")&&Ma&&(jb=this.$ag(this.dy,oa,Wa,Nb));Sa||yb?this.SWg(oa,Sa,yb,Bb):(Sa=this.MVe(Wa,Ia.Nk,Ia.tBa,Ia.aia,!1,jb),Object(ea.c)(Sa)?(this.rSd(Oa.TextRuns,Oa.Fonts)&&this.UWg(oa,Oa,Sa.value),this.QZa(oa,
Sa.value,Bb),this.QYd(oa.range,"FormatCellsAction.cellDataEntryCSE")):this.VAb&&this.zsd?this.$Wg(oa,Oa.Text,Bb):this.aXg(oa,Oa.Text),Oa=Object(ea.c)(Sa)?Sa.value.text:"",yb=Object(ea.b)(Sa)?Sa.reason:"",e.ULS.sendTraceTag(559724065,0,50,`FormatCellsAction.CellDataEntryCSE: (${oa.range.top}, ${oa.range.left}) 1st pass formatting, success: ${Sa.success}, reason: ${yb}, ifmt: ${Ia.Nk}, input: '${Ra.a.KZa(Ia.userInput)}', prediction: '${Ra.a.KZa(Oa)}',`));Ia.formulaBarText=Wa;X.EwaSettings.isChangeGateEnabled("OfficeVSO:7082146_applyNFWhenNotSendingWW")||
Ma&&this.$ag(this.dy,oa,Wa,Nb);Bb.Thc=!0}SWg(oa,Oa,Wa,Sa){Sa.Dwa=!0;oa.text="";oa.formulaBarText="";oa.cell.userInput="";this.g2b(oa,null,null,Oa,Wa)}UWg(oa,Oa,Wa){Oa.Text===Wa.text&&2===Wa.valueType&&(oa.cell.li=Oa)}$Wg(oa,Oa,Wa){Wa&&(Wa.Dwa=!0);oa.text=Oa;oa.formulaBarText=Oa;this.g2b(oa,1)}aXg(oa,Oa){oa.text=Oa;oa.formulaBarText=Oa;this.g2b(oa,1)}g2b(oa,Oa,Wa=null,Sa=!1,yb=!1,Ma=!1){let Bb=oa.horizontalAlignment;Wa=null!=Wa?Wa:oa.verticalAlignment;0===oa.cell.jza&&(null!=Oa||Sa||yb||Ma)&&(Sa?Bb=
0:yb||Ma?Bb=1:null!=Oa&&(Bb=Oa),this.Xua.cdb(oa,Bb,!1,Wa,!0))}QYd(oa,Oa){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6487996_CalcNotifiesRecalcComplete")){const Wa=nb.g(this.$),Sa=()=>{this.calcManager?this.calcManager.Rtf(oa):e.ULS.sendTraceTag(521172961,0,50,`FormatCellsAction.cellUnchangedDataEntryCSE: Unable to call notifyEditedCellRecalcComplete as calcManager member is null. caller: ${Oa}, cell ${oa}`);Wa.Xb.Fl(Sa)};Wa.Xb.lm(Sa)}}EMj(oa,Oa){(null===oa||void 0===oa?0:oa.Dya)&&Oa>=vb.lCh&&
Oa>oa.Dya.length-1&&(e.ULS.sendTraceTag(537162141,0,50,`FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:${Oa}. Triggering refresh...`),oa.CVe())}$ag(oa,Oa,Wa,Sa=null){if(void 0===oa||null===oa)return!1;if(this.dy.Kmd)return e.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing"),!1;const yb=this.$.da.za(266);return yb?(this.vha.Wca=Y.THe,oa&&(this.vha.Wca=oa.Kbf),yb.OUg(Oa,Wa,this.vha.bLf,Sa)):!1}w3a(oa,Oa,Wa,Sa){var yb=
this.$.da.za(266);if(!yb)return Object(ea.a)("calcManager is null");if(!yb.tD)return Object(ea.a)("calcManager.NumberFormatter is null");if(!this.dy)return Object(ea.a)("instantaneousManager is null");let Ma;if("number"===typeof Oa||"string"===typeof Oa){var Bb=yb.Jbc(Oa);if(!Object(ea.c)(Bb))return Bb;Ma=Bb.value}else Ma=Oa;Bb=yb.tD;const Nb=V(oa);if(void 0===Nb||null===Nb)return Object(ea.a)("cellValue is null");yb=excelOnlineCalc.calc.cellValueToReadOper(yb.config.mathpack,Nb);if(void 0===yb||
null===yb)return Object(ea.a)("readOper is null");yb=Bb.applyFormat(Ma,yb,X.EwaSettings.isChangeGateEnabled("OfficeVSO:6328006_applyFormatDisplaysZeroes"));return excelOnlineCalc.util.isSuccess(yb)?this.vha.Vad(Bb,yb.value,oa.type,Wa,Sa,"number"===typeof Oa?Oa:-1,!1):Object(ea.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(yb.reason.kind))}MVe(oa,Oa,Wa,Sa,yb,Ma){var Bb=this.$.da.za(266);if(void 0===Bb||null===Bb)return Object(ea.a)("calcManager is null");if(void 0===Bb.tD||null===Bb.tD)return Object(ea.a)("calcManager.NumberFormatter is null");
if(void 0===this.dy||null===this.dy)return Object(ea.a)("instantaneousManager is null");if(this.VAb&&!yb&&Ma)return Object(ea.a)("No main thread number formatter");Ma=Bb.Jbc(Oa);if(!Object(ea.c)(Ma))return Ma;var Nb=Ma.value;Ma=Bb.tD;oa=Ma.parseEdit(oa,Nb);if(!excelOnlineCalc.util.isSuccess(oa))return Object(ea.a)(`ParseEdit failure: reason=${oa.reason.kind}, features=${oa.reason.features}`);if(oa.value.kind===y.a.formula)return Object(ea.a)("Main thread - skipping formula edit");Bb=excelOnlineCalc.numfmt.applyValueEdit(Ma,
Bb.localeInfo,Nb,oa.value);if(!excelOnlineCalc.util.isSuccess(Bb))return Object(ea.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Bb.reason.kind));oa=oa.value;e.ULS.shipAssertTag(537162190,0,oa.kind!==y.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");oa=excelOnlineCalc.numfmt.getValueEditOperKind(oa);Nb=0;switch(oa){case 0:case 128:Nb=0;break;case 1:Nb=1;break;case 2:Nb=2;break;case 4:Nb=3;break;case 8:Nb=4;break;case 16:case 32:case 64:case 256:e.ULS.sendTraceTag(537162189,
0,15,`CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind ${oa} to a CellValueType`);break;default:e.ULS.shipAssertTag(537162188,0,!1,`CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind ${oa}`)}return this.vha.Vad(Ma,Bb.value,Nb,Wa,Sa,"number"===typeof Oa?Oa:-1,yb)}nni(oa,Oa,Wa){if(Oa.width<Wa.width){const Sa=oa.uk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new v.Range(Oa.top,Oa.left,Oa.bottom,Oa.left,!0,!0));for(;Sa.$$mn();){let yb=Sa.$$cu();if(yb&&
yb.tLa())return e.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}}if(Oa.height<Wa.height)for(oa=oa.uk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new v.Range(Oa.top,Oa.left,Oa.top,Oa.right,!0,!0));oa.$$mn();)if((Oa=oa.$$cu())&&Oa.xLa())return e.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1}r3c(oa,Oa,Wa,Sa,yb){const Ma=Oa.nS().FirstRow,Bb=Oa.nS().LastRow;
var Nb=Wa.nS().FirstRow;const Ia=Wa.nS().LastRow;let jb=Ma;for(;Nb<=Ia;Nb++,jb++){jb>Bb&&(jb=Ma);const Ob=Oa.nS();Ob.FirstRow=Ob.LastRow=jb;const Jb=Wa.nS();Jb.FirstRow=Jb.LastRow=Nb;this.H4g(oa,w.a.tQ(Ob),w.a.tQ(Jb),Sa,yb)}}SXi(oa,Oa){const Wa=this.$.da.za(266);return void 0!==Wa&&null!==Wa?(Wa.JUg(oa,Oa.topLeft,this.vha.bLf),!0):!1}goi(oa,Oa){const Wa=oa.right-oa.left+1;oa=oa.bottom-oa.top+1;const Sa=Oa.right-Oa.left+1;Oa=Oa.bottom-Oa.top+1;if(Sa>Wa&&Oa>oa){if(!(Sa%Wa&&Oa%oa))return!0}else if(Sa===
Wa&&Oa>oa){if(!(Oa%oa))return!0}else if(Sa>Wa&&Oa===oa&&!(Sa%Wa))return!0;return!1}Kih(oa){if(X.EwaSettings.ma(102)){oa=nb.g(this.$).b1(oa).gridView.getRangeInformation(oa);for(const Oa of oa)if(Object(m.a)(r.DynamicArrayRange,Oa)&&!Object(u.a)(r.DynamicArrayRange,Oa).kmc)return!0}return!1}IDe(oa,Oa,Wa,Sa,yb,Ma){for(let Bb of Oa)Wa&&(this.L4g(Bb,yb),Bb.setCell(!0)),Sa&&(Ma=this.L3h(yb,Bb)),Ma||(oa.Ea.gV(),Ma=!0);return Ma}HPh(oa,Oa,Wa){Oa=new v.Range(Oa,Wa,Oa,Wa,!0,!0);return oa.Vb(Oa)}H4g(oa,Oa,
Wa,Sa,yb){if(Wa){this.cTa&&Wa.equals(this.cTa.range)||(k.a.Ia(this.cTa),this.cTa=oa.uk("FormatCellsAction.CopyBetweenRows",Wa));Wa=this.cTa;Wa.$$rst();var Ma=!1;if(X.EwaSettings.getBooleanFeatureGate(hb.a.HGe,!1)){var Bb=Oa.nS().FirstColumn+1,Nb=Oa.nS().LastColumn+1;Oa=Oa.nS().FirstRow+1;let jb=Bb;for(;Wa.$$mn();){jb>Nb&&(jb=Bb);const Ob=this.HPh(oa,Oa,jb);jb+=1;var Ia=void 0;const Jb=Wa.$$cu().QH?oa.JKb(Wa.$$cu().range):(Ia=new l.a,Ia.add(Wa.$$cu()),Ia);Ob&&(Ma=this.IDe(oa,Jb,Sa,yb,Ob,Ma));Ca.lastOrDefault(Jb)}}else for(Ia=
oa.uk("FormatCellsAction.CopyBetweenRows2",Oa);Wa.$$mn();)Ia.$$mn()||(Ia.$$rst(),Ia.$$mn()),Nb=Ia.$$cu(),Oa=Wa.$$cu().QH?oa.JKb(Wa.$$cu().range):(Bb=new l.a,Bb.add(Wa.$$cu()),Bb),Nb&&(Ma=this.IDe(oa,Oa,Sa,yb,Nb,Ma)),Ca.lastOrDefault(Oa)}else e.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")}o5f(){const oa=ia.a.Yc(1,0,0,653,0,104573951,"PivotTableContextMenuOperationFailure");Qb.a(this.$).uj(oa)}Vyi(oa,Oa){const Wa={ValidMembers:32},Sa=Oa.NumberFormat;switch(oa){case 1890566896:if(1001===
Sa||1002===Sa||1003===Sa){Wa.NumberFormat=14;Wa.NumberFormatOptions={};switch(Sa){case 1001:Wa.NumberFormatOptions.TimeType=2;break;case 1002:Wa.NumberFormatOptions.DateType=7;break;case 1003:Wa.NumberFormatOptions.DecimalPlaces=0}Wa.NumberFormatOptions.NumberFormatCategory=this.QLg(Sa)}else Wa.NumberFormat=Sa;break;case 1886928607:Wa.NumberFormat=13;break;case -992833457:Wa.NumberFormat=11;break;case 218524921:Wa.NumberFormat=12;break;case 996232352:Wa.NumberFormat=14;Wa.NumberFormatOptions=Object(f.a)(new t.a,
{DecimalPlaces:0});Wa.NumberFormatOptions.NumberFormatCategory=6;break;default:return Oa}return Wa}formatCells(oa,Oa,Wa,Sa=null,yb=null,Ma=null,Bb=null){var Nb;const Ia=this.$.Jb.Bc("UserAction","FormatCellsInstantaneous, command = "+Pb.b().ij(oa)),jb=this.$.Jb.Rg("UserAction","FormatCellsInstantaneousFrame");jb.start();mb.a(jb);var Ob=Pb.b().ij(oa);const Jb=this.$,Kb=nb.g(Jb);var Qa=Kb.ha.sa,ha=yb||Qa.selectedRanges,qa=Na.g(ha,tb=>tb.dH);Ob=`${Ob}, cellCount=${qa}`;nb.g(this.$).Pi.A7(1,Ia.id,Ob);
ha=x.r(ha,this.$);Qa=Qa.activeCell;Ob=-168056295===Wa.command;var pb=qa=null;if(Ob){pb=Kb.Fb.rp(Qa);if(!pb){this.o5f();return}qa=pb.Lca.substring(1,pb.Lca.length-1);pb=pb.Oac();if(!pb){this.o5f();return}pb=pb.Caption}Kb.Ff.eH(!1,!0);const bb=x.o(Qa,Jb),eb=Jb.pa.va.Tb({j_:!0,AZ:1}),Fa=this.Vyi(Wa.command,Oa);Ob||this.Vda(Kb,oa,Oa,!1,Sa,yb);Ia.stop();nb.g(this.$).Pi.D0(Ia.id,sa.BasicTelemetryCalculator.NQ);Wa.Gci=wa.a.Pa.zb;Sa=this.$.Jb.Bc("UserAction","FormatCellsUserAction");yb=this.Bl&&this.dYg(null===
(Nb=null===Oa||void 0===Oa?void 0:Oa.Font)||void 0===Nb?void 0:Nb.FontName);this.ivi(oa,Wa.taskId,Oa,ha,Qa,Sa.id,yb);Pb.b().KA(Ia.id,Sa.id,"actions","actions");Pb.b().KA(jb.id,Sa.id,"actions","actions");X.EwaSettings.$b()?Jb.userOperationManager.Wb(new T(this,ha,bb,Fa,Ob,qa,pb,eb,Sa,Ia.id,64,Ma,Bb),Wa):Jb.userOperationManager.Wb(new T(this,ha,bb,Fa,Ob,qa,pb,eb,Sa,Ia.id,0,Ma,Bb),Wa)}G2(oa,Oa,Wa,Sa,yb,Ma,Bb,Nb,Ia,jb,Ob){const Jb=this.$;return(Kb,Qa,ha)=>{Jb.Ay();Kb=[Kb,this.EKi];Qa=[Qa];jb&&Kb.push(jb);
Ob&&Qa.push(Ob);return z.l(Jb.pa.va,oa,Oa,Wa,Sa,yb,Ma,!1,va.b(...Kb),va.a(...Qa),ha,Ia,Bb,Nb)}}V4f(oa,Oa,Wa,Sa,yb,Ma,Bb=null){if(Oa&&Wa){var Nb=Wa.Font,Ia=Wa.HorizontalAlignment,jb=Wa.VerticalAlignment;Wa.ValidMembers&2||(Ia=Oa.horizontalAlignment);Wa.ValidMembers&1||(jb=Oa.verticalAlignment);var Ob=0!==Ia;vb.Qei(oa)&&0===Ia&&(Ia=this.W_e(Oa));var Jb=!1;switch(oa){case -394785302:this.Xua.cdb(Oa,Ia,Ob,0);break;case 1041132226:this.Xua.cdb(Oa,Ia,Ob,1);break;case -571165336:this.Xua.cdb(Oa,Ia,Ob,2);
break;case -1150205178:case -1142465846:case -286432209:this.Xua.cdb(Oa,Ia,Ob,jb,!1,!1);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:this.oNa&&this.fpj(Oa,Wa,Ob);break;case 1650812936:this.setFillColor(Oa,Wa,Ma);break;case -287251124:Oa.bold=Nb.Bold;break;case -1690267012:nb.g(this.$).ha.sa.Bg&&(Nb=X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?Bb?Bb:nb.g(this.$).ha.sa.Xc:nb.g(this.$).ha.sa.Xc,
this.Xua.lLb(Oa,Wa,Nb));break;case 1970784898:Wa=L.a.pp(Oa.color,Oa.backgroundColor);if(ua.a.compare(Wa,ua.a.red)&&(Ra.a.c5(Oa.text)||Ra.a.V7e(Oa.text)))break;Wa=ua.a.tH(Nb.FontColor);Oa.color=gc.e(L.a.sG(Wa));break;case -1925065947:Oa.italic=Nb.Italic;break;case -1293291468:Oa.fontName=Nb.FontName;this.Qm&&Oa.b0f(Nb.FontScheme);break;case 862890474:case 963349338:Oa.fontSize=Nb.FontSize;this.$.$e();break;case -1077965542:Oa.fontSize=Nb.FontSize;break;case 1764140053:Oa.underline=Nb.Underline;break;
case -1685033574:Oa.doubleUnderline=Nb.DoubleUnderline;break;case -1590502662:Oa.fontStrikethrough=Nb.Strikethrough;break;case -848953656:case 2045211913:Jb=Oa.lqb();break;case 2105621672:Wa=Object(u.a)(sb.a,yb);if(!Wa)break;Nb=ua.a.WEh(Wa.color);Oa.color=gc.e(L.a.sG(Nb));this.Lse(Oa,Wa.Cmc);break;case -1409276245:this.Lse(Oa,Wa.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.$Lg(Oa,Wa);break;case -1228228458:Oa.lqb();Oa.clearFormat();this.fXc(Oa,0);Jb=!0;break;case -730106152:Oa.clearFormat();
this.fXc(Oa,0);break;case 932244020:this.epj(Oa,Wa,Ma);break;case -1942512156:case -1920201820:this.erj(Oa,Wa)}Sa||(Jb?Oa.zIb(!0):Oa.setCell(!0))}else e.ULS.shipAssertTag(537162135,0,!Oa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),e.ULS.shipAssertTag(537162134,0,!Wa,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")}L4g(oa,Oa){oa&&Oa?(oa.uqb(Oa),oa.p1c(Oa),this.fXc(oa,Oa.cell.Nk)):e.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")}fXc(oa,
Oa){if(0>Oa)this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"failure",reason:"ApplyNumberFormatIndexOnCell: negative format index was supplied"});else{var Wa=this.w3a(oa.cx,Oa,oa.cell.tBa,oa.cell.aia);Object(ea.b)(Wa)?this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"failure",reason:Wa.reason}):(this.QZa(oa,Wa.value),this.Zba({caller:"ApplyNumberFormatIndexOnCell",cell:oa,kind:"success",Vx:Wa.value,format:Oa}))}}Lse(oa,Oa){if(void 0===Oa||null===Oa)this.Zba({caller:"ApplyNumberFormatStringOnCell",
cell:oa,kind:"failure",reason:"ApplyNumberFormatStringOnCell: no format string was supplied"});else{var Wa=this.w3a(oa.cx,Oa,oa.cell.tBa,oa.cell.aia);Object(ea.b)(Wa)?this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:oa,kind:"failure",reason:Wa.reason}):(this.QZa(oa,Wa.value),this.Zba({caller:"ApplyNumberFormatStringOnCell",cell:oa,kind:"success",Vx:Wa.value,format:Oa}))}}$Lg(oa,Oa=null){if(Oa)if(Oa=this.MWh(oa,Oa),Oa.success){var Wa=this.w3a(oa.cx,Oa.ymc,oa.cell.tBa,oa.cell.aia);Object(ea.b)(Wa)?
this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:Wa.reason,format:Oa.ymc}):(this.QZa(oa,Wa.value),this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"success",Vx:Wa.value,format:Oa.ymc}))}else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:Oa.reason,format:Oa.ymc});else this.Zba({caller:"ApplyNumberFormatCategoryOnCell",cell:oa,kind:"failure",reason:"ApplyNumberFormatCategoryOnCell: no format was supplied"})}QLg(oa){switch(oa){case 1004:return 1;
case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<oa?-1:oa}MWh(oa,Oa){if(!this.dy||!this.localeInfo||!Oa)return oa=this.dy?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new ja(!1,void 0,"GetRibbonNumberFormat: "+oa);Oa=Oa.NumberFormat;switch(Oa){case 0:oa=B.uFh;break;case 1:oa=B.wFh;break;case 2:oa=B.sFh;break;case 3:oa=B.qFh;break;case 4:oa=B.zFh;break;case 5:oa=
B.vFh;break;case 6:oa=B.BFh;break;case 7:oa=B.xFh;break;case 8:oa=B.tFh;break;case 9:oa=B.yFh;break;case 10:oa=B.AFh;break;case 11:case 12:return this.dy.CVe(),this.bNh(oa,Oa);case 13:oa=B.GTg;break;case 1006:oa=B.buttonPercentage;break;case 1004:oa=B.keyboardNumber;break;case 1005:oa=B.keyboardCurrency;break;case 1002:oa=B.keyboardDate;break;case 1001:oa=B.keyboardTime;break;case 1003:oa=B.keyboardPercentage;break;case 14:return oa="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
e.ULS.shipAssertTag(537162132,0,!1,oa),new ja(!1,void 0,oa);default:return oa="GetRibbonNumberFormat: unknown NumberFormatType!",e.ULS.shipAssertTag(537162131,0,!1,oa),new ja(!1,void 0,oa)}return oa?(oa=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,oa))?new ja(!0,oa):new ja(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format..."):new ja(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...")}bNh(oa,Oa){if(!this.calcManager||
!this.tD)return Oa=this.calcManager?"numberFormatter is null":"calcManager is null",new ja(!1,void 0,"GetDecimalChangeNumberFormat: "+Oa);oa=this.calcManager.Jbc(oa.cell.Nk);if(!Object(ea.c)(oa))return new ja(!1,void 0,`getDecimalChangeNumberFormat: ${oa.reason}`);Oa=this.tD.changeFormatDecimals(oa.value,11===Oa?1:-1);return excelOnlineCalc.util.isSuccess(Oa)?void 0===Oa.value||null===Oa.value?new ja(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result"):new ja(!0,Oa.value):new ja(!1,
void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure")}Zba(oa){const Oa=oa.caller,Wa=oa.cell;var Sa=oa.format;Sa=null==Sa?"null":"number"===typeof Sa?Sa:"string"===typeof Sa?Ra.a.KZa(Sa):Ra.a.KZa(Sa.formatString);const yb=Ra.a.KZa(Wa.cx.value)||"null",Ma="success"===oa.kind?Ra.a.KZa(oa.Vx.text):"null";oa=JSON.stringify({caller:Oa,"range.top":Wa.range.top,"range.left":Wa.range.left,result:oa.kind,reason:"success"===oa.kind?"":oa.reason,value:yb,valueType:Wa.cx.type,ifmt:Sa,
prediction:Ma});e.ULS.sendTraceTag(537162130,0,50,`FormatCellsAction.LogNumberFormatEdit: ${oa}`)}aMg(oa,Oa,Wa,Sa,yb,Ma,Bb,Nb=!1,Ia=!1,jb=0,Ob=null){const Jb=Oa.cell;Jb.DJ=jb;jb=Oa.text;jb!==Wa&&(Jb.text=Wa);Jb.POa=Ob;Ha.f(jb)?Oa.formulaBarText=jb:Oa.formulaBarText="";oa=nb.g(oa).Fb.mhf(Oa.range);this.g2b(Oa,Sa,null,Nb,Ia,oa);yb&&(Oa.color=gc.e(L.a.sG(yb)));Oa.cell.Nk=Ma;Oa.cell.aGb=Bb;Oa.cell.hzc=Ma}ivi(oa,Oa,Wa,Sa,yb,Ma,Bb){const Nb={};Nb.a=this.$.ya.UserSessionId;Nb.b=Oa;Nb.c=Sa.Ranges.length;
Nb.d=this.J8g(Sa.Ranges);Nb.e=yb.toString();Nb.f=oa;Nb.h=Ma;1890566896===oa?Nb.g=Wa.NumberFormat.toString():2105621672===oa?Nb.g=Wa.NumberFormatOptions.NumberFormatCategory.toString():this.Bl&&-1293291468===oa&&(Nb.g=`{ "isNewFont": ${Bb} }`);Pb.b().Ne(3,Nb,!0)}J8g(oa){let Oa=0,Wa=0,Sa=0;for(let yb=0;yb<oa.length;yb++){const Ma=x.B(oa[yb]).dH;Oa+=Ma;Ma>Sa&&(Sa=Ma,Wa=yb)}oa=x.B(oa[Wa]).toString();return"TotalCellCount:"+Oa+"; Max range:"+oa+"; MaxRangeSize:"+Sa+";"}epj(oa,Oa,Wa){64===(Oa.ValidMembers&
64)&&this.setFillColor(oa,Oa,Wa);16===(Oa.ValidMembers&16)&&vb.Iqj(oa,Oa);128===(Oa.ValidMembers&128)&&this.Xua.lLb(oa,Oa,oa.range);if(2===(Oa.ValidMembers&2)||1===(Oa.ValidMembers&1)){Wa=Oa.VerticalAlignment;Oa=Oa.HorizontalAlignment;const Sa=0!==Oa;X.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!Sa&&this.W_e(oa);this.Xua.cdb(oa,Oa,Sa,Wa)}}setFillColor(oa,Oa,Wa){(X.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
oa.Yaa:oa.Yaa&&oa.fxb&&!oa.ixb&&!oa.mxb)||(Oa=-1===Oa.FillColor?Wa?L.a.sG(ua.a.white):null:L.a.sG(ua.a.tH(Oa.FillColor)),oa.backgroundColor=Oa?gc.e(Oa):null)}erj(oa,Oa){0!==oa.horizontalAlignment&&2!==oa.horizontalAlignment||oa.u0(1,!1);0<=oa.indentation+Oa.IndentationIncrease&&(oa.indentation+=Oa.IndentationIncrease)}fpj(oa,Oa,Wa){let Sa=oa.zL,yb=Oa.TextOrientation;yb!==K.a.verticalText&&(0>yb||180<yb)&&e.ULS.shipAssertTag(523090050,0,!1,`FormatCellsAction.setCellTextOrientation: invalid value for text orientation in server ${yb}`);
Sa===yb||Sa===K.a.Muc&&yb===K.a.Nuc||Sa===K.a.Ouc&&yb===K.a.Puc?Oa.TextOrientation=0:(oa.zL=Oa.TextOrientation,Wa||oa.u0(0<=oa.zL?1:3,!1))}W_e(oa){oa=this.w3a(oa.cx,oa.cell.Nk,oa.cell.tBa,oa.cell.aia);return Object(ea.b)(oa)?0:null!=oa.value.horizontalAlignment?oa.value.horizontalAlignment:0}rsj(oa,Oa,Wa){this.xx||(this.xx=new ca.a(nb.g(this.$).Ea,this.$));this.xx.lLb(oa,Oa,Wa)}L3h(oa,Oa){const Wa=new Xb.a;if(oa.cell.formulaBarText&&oa.cell.formulaBarText.startsWith("'"))Wa.Text=oa.cell.formulaBarText;
else{let Sa=oa.cellValue;Sa&&4!==oa.cell.DJ||(Sa=oa.text);Wa.Text=Sa}this.TSa(Oa,Wa,!1,void 0,G.a.wpd(this.$));return!0}rSd(oa,Oa){return this.xb&&!!oa&&!!Oa}static G1g(oa,Oa,Wa,Sa){Sa&&Oa.setCell(!0);0===Wa&&oa.Ea.gV()}static expandRange(oa,Oa){Oa=Oa.clone();Oa.height<oa.height&&(Oa.bottom=Oa.top+oa.height-1);Oa.width<oa.width&&(Oa.right=Oa.left+oa.width-1);return Oa}static Qei(oa){switch(oa){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;
default:return!1}}static Iqj(oa,Oa){Oa=Oa.Font;var Wa=0!==(Oa.ValidMembers&16);const Sa=0!==(Oa.ValidMembers&16),yb=0!==(Oa.ValidMembers&16);oa.bold=0!==(Oa.ValidMembers&4);oa.italic=0!==(Oa.ValidMembers&8);Wa&&(oa.underline=Wa);Sa&&(oa.doubleUnderline=Sa);yb&&(oa.fontStrikethrough=yb);oa.fontName=Oa.FontName;oa.fontSize=Oa.FontSize;Wa=L.a.pp(oa.color,oa.backgroundColor);ua.a.compare(Wa,ua.a.red)&&(Ra.a.c5(oa.text)||Ra.a.V7e(oa.text))||(Oa=ua.a.tH(Oa.FontColor),oa.color=gc.e(L.a.sG(Oa)))}}vb.lCh=
36;Object(n.a)(vb,"FormatCellsAction",null,[245,10]);class Va extends d.a{constructor(oa){super();this.$=oa;this.Eb()}create(){this.pb(new vb(this.$))}static ka(oa){oa.da.Ga(18,new Va(oa))}}Object(n.a)(Va,"FormatCellsActionFactory",d.a,[]);a.d(C,"a",function(){return db});const db=()=>{b.a.Fa(Va.ka)}},1159:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(1),f=a(15),e=a(195),k=a(78),l=a(37),m=a(47),u=a(45),t=a(642),w=a(28),r=a(118);class v{constructor(){this.startTime=w.a.Pa.zb;this.zx=new t.a}LZe(){return r.a(w.a.Pa,
this.startTime)}}Object(n.a)(v,"OngoingAction",null,[]);class y extends k.a{constructor(Va,db,oa,Oa,Wa=null){super();this.yPa=this.Qnb=null;this.BZc=0;this.rpc=null;this.$Qi=()=>{const Sa=this.yPa.LZe();f.ULS.sendTraceTag(537153861,0,50,`ActionAggregator<${this.qla}>.OnRunningLong: Operation running for more than ${Sa}ms`);this.rpc=m.a.instance.create(this.r6,Math.max(this.uwe-Sa,0),u.a.hle)};this.r6=()=>{f.ULS.sendTraceTag(537153860,0,50,`ActionAggregator<${this.qla}>.OnTimeout: Operation running for more than ${this.yPa.LZe()}ms, timing out. Has pending actions: ${this.k6a}`);
this.BZc++;this.BZc>this.twe&&f.ULS.sendTraceTag(537153859,0,50,`ActionAggregator<${this.qla}>.OnTimeout: passed the allowed bypassed count`);this.yPa.zx.cancel();this.sUe()};this.x_=()=>{this.k6a&&f.ULS.sendTraceTag(537153858,0,50,`ActionAggregator<${this.qla}>.OnDocumentUnhidden: Start. IsActionOngoing: ${this.jMa}, AggregatedActionParams not null: ${this.k6a}`);this.Qmd()};this.GAg=Va;this.HAg=db;this.documentVisibilityObserver=oa;this.qla=Oa;this.xL=Wa;oa&&this.documentVisibilityObserver.eZa(this.x_);
this.AZc=!!oa&&d.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);this.twe=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);db=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);this.uwe=Va.kdd(db);Va=d.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);this.STg=Math.max(this.uwe-db,
0)+Va}get jMa(){return!!this.yPa}get k6a(){return!!this.Qnb}bIf(Va){f.ULS.sendTraceTag(537153864,0,50,`ActionAggregator<${this.qla}>.PerformThrottledAction: Start. IsActionOngoing: ${this.jMa}, AggregatedActionParams not null: ${this.k6a}`);this.Qnb=this.HAg.AWc(Va,this.Qnb);this.Qmd()}dispose(){this.documentVisibilityObserver&&this.documentVisibilityObserver.UQa(this.x_);this.$xe();super.dispose()}P0f(Va){this.AZc?(this.yPa=Va?new v:null,Va?this.startTimer():this.$xe()):this.yPa=Va?{}:null}sUe(Va=
null){this.AZc&&Va&&Va.tK?f.ULS.sendTraceTag(537153863,0,50,`ActionAggregator<${this.qla}>.FinishedCallback: timedout, skipping`):(f.ULS.sendTraceTag(537153862,0,50,`ActionAggregator<${this.qla}>.FinishedCallback: Start. IsActionOngoing: ${this.jMa}, AggregatedActionParams not null: ${this.k6a}`),this.P0f(!1),this.Qmd())}Qmd(){if(!this.vMb()){var Va=this.Qnb;this.Qnb=null;this.P0f(!0);f.ULS.sendTraceTag(537153857,0,50,`ActionAggregator<${this.qla}>.InternalPerformAction: Calling PerformAction.`);
var db=this.AZc?this.yPa.zx.token:e.a.none;l.TaskExtensions.Aa(this.GAg.tEd(Va),()=>{this.sUe(db)},db,0,this.xL)}}vMb(){return!this.k6a||this.jMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.vi?(f.ULS.sendTraceTag(593376846,0,50,`ActionAggregator<${this.qla}>.ShouldThrottle: Not Calling PerformAction as document is hidden.`),!0):!1}$xe(){this.rpc&&this.rpc.cancel()}startTimer(){this.BZc<=this.twe&&(this.rpc=m.a.instance.create(this.$Qi,this.STg,u.a.hle))}}Object(n.a)(y,"ActionAggregator",
k.a,[684,10]);var x=a(27),B=a(85),z=a(108),A=a(13),I=a(44),F=a(38),U=a(19),X=a(5),T=a(128),G=a(14),D=a(21),J=a(55);class L extends F.a{constructor(Va){super();this.yw=this.firstElement=null;this.IMa=!1;this.Ms=null;this.awj=x.a.Uf;this.zAf=db=>{const oa=db.Ca.keyCode;return oa===B.a.fi?this.LJi():oa===B.a.jA&&db.Ca.shiftKey?this.oyh(this.firstElement):!1};this.XFf=db=>{if(!this.IMa||db.Ca.keyCode!==B.a.FL)return!1;L.B9e();J.Task.delay(1).fp(()=>{this.yw.focus();return!0},0,this.la);return!0};this.vUi=
()=>{document.activeElement&&document.activeElement.id===this.yw.id||(L.B9e(),J.Task.delay(1).fp(()=>{this.yw.focus();return!0},0,this.la))};this.Dyf=()=>{this.Uag(this.yw)};this.yAf=db=>{db.stopPropagation();db.preventDefault();this.IMa&&(this.IMa=!1)};this.$=Va;(Va=this.$.ea.jc)&&f.ULS.sendTraceTag(39350791,0,50,`EmbedViewFocusControl: PermissionSet = ${Va.dta}; InWebPart = '${Va.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`);Va&&(Va.inWebPart||
Va.inEmbedView)?f.ULS.sendTraceTag(537153856,0,15,`EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '${Va.inWebPart?"Classic":"Non Classic"}', InEmbedView = '${Va.inEmbedView?"True (+Modern)":"False (not Modern)"}'`):(this.B7g(),this.z8g(),z.KeyInputManager.instance.ra(A.a.Qb,this.$.domElement,this.XFf));this.$.da.Ga(238,this)}VGg(Va){this.addHandler("KBIS",Va)}Wbj(Va){this.removeHandler("KBIS",Va)}dispose(){this.firstElement&&
I.a.removeHandler(this.firstElement,A.a.focus,this.Dyf);this.Ms&&this.Ms.detach("focus");this.yw&&(I.a.removeHandler(this.yw,A.a.focus,this.yAf),I.a.removeHandler(this.yw,A.a.blur,L.onBlur),z.KeyInputManager.instance.Ba(A.a.Qb,this.yw,this.zAf));z.KeyInputManager.instance.Ba(A.a.Qb,this.$.domElement,this.XFf);this.Ms=this.yw=this.firstElement=this.$=null;super.dispose()}B7g(){this.awj?(this.firstElement=document.documentElement,this.Ms=T.a.instance.iH(document.parentWindow),this.Ms.ka("focus",this.vUi)):
(this.firstElement=L.SEe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),I.a.addHandler(this.firstElement,A.a.focus,this.Dyf))}z8g(){this.yw=L.SEe();this.yw.id=X.a.PLe;this.yw.setAttribute(X.a.Xt,G.a.instance.ga(867));document.body.appendChild(this.yw);I.a.addHandler(this.yw,A.a.focus,this.yAf);I.a.addHandler(this.yw,A.a.blur,L.onBlur);z.KeyInputManager.instance.ra(A.a.Qb,this.yw,this.zAf)}oyh(Va){this.Uag(Va);return!1}LJi(){this.IMa=!0;D.g(this.$).focus();D.g(this.$).ha.F6e();
this.raiseEvent("KBIS");return!0}Uag(Va){this.IMa?this.IMa=!1:(this.IMa=!0,Va&&Va.focus())}static SEe(){const Va=document.createElement("div");Va.tabIndex=0;return Va}static B9e(){document.body.classList.add(U.a.pOe)}static onBlur(){document.body.classList.remove(U.a.pOe)}}Object(n.a)(L,"EmbedViewFocusControl",F.a,[683,10]);var H=a(4),R=a(1081),Q=a(60),O=a(521),V=a(24),W=a(43),da=a(370),ta=a(171),K=a(283),na=a(116),P=a(29),ka=a(282),pa=a(281),Na=a(61);const Z=(Va,db,oa,Oa,Wa,Sa,yb,Ma,Bb,Nb,Ia=null)=>
{Ia=Va.Na(1,Ia);Ia.selectedRange=db;Ia.richValueKeyPath=oa;Ia.singleColumn=Oa;Ia.searchForRange=Wa;Ia.calculateMajorityDataType=Sa;return Na.g(Va,"GetRichValueFieldListContextList",Ia,yb,Ma,Bb,Nb,4)};var Ra=a(33);class Da extends F.a{constructor(Va,db){super();this.MJb=this.Med=this.Lvb=this.fP=null;this.BUb=!1;this.I5d=null;this.hHd=!1;this.jLi=(oa,Oa,Wa)=>{f.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Wa);this.MJb&&this.MJb.stop();this.fP=null;this.raiseEvent(R.h)};
this.kLi=oa=>{ka.a(oa)||(this.MJb&&this.MJb.stop(),this.BUb=!1,(this.fP=oa.Result)&&0<this.fP.length&&f.ULS.sendTraceTag(25264351,0,50,`Retrieved ${this.fP.length} rich value field list context for autocomplete`),this.GWa=!0,this.Drc())};this.GWa=!1;this.jb=Va;this.nTb=-1;this.tableManager=db;this.hHd=d.EwaSettings.isChangeGateEnabled("OfficeVSO:6395797_raiseFieldInfoLoadedEventOnEmptyResults")&&Ra.a.hV(Va)}KZb(Va){this.addHandler(R.a,Va)}gtc(Va){this.removeHandler(R.a,Va)}uGg(Va){this.addHandler(R.h,
Va)}Dbj(Va){this.removeHandler(R.h,Va)}get I6a(){return this.GWa}get Jti(){return this.BUb}get hWe(){return this.nTb}get r5c(){return this.I5d}get $(){return this.jb}get Xk(){return this.fP}get KOh(){return!!this.Lvb}dispose(){this.jb=null;this.icb();super.dispose()}iZi(){var Va=Array(6);var db={};db.Name=R.f;Va[0]=db;db={};db.Name=R.c;Va[1]=db;db={};db.Name=R.d;Va[2]=db;db={};db.Name=R.g;Va[3]=db;db={};db.Name=R.e;Va[4]=db;db={};db.Name=R.b;Va[5]=db;db={ColumnName:"",ColumnIndex:-1};db.FieldInfoDataList=
Va;Va=[];Va[0]=db;this.LPd(Va)}gZ(Va,db,oa,Oa=null){if(Va){this.s_c();this.W1b();var Wa=null,Sa=!1;if(!Oa&&({bab:Sa,Xk:Wa}=this.qNj(Va,db,oa)).returnValue)if(this.hHd||this.LPd(Wa),this.BUb=!0,this.fP=Wa,this.hHd){if(!Sa){this.GWa=!0;this.Drc();return}}else if(this.fP&&0<this.fP.length&&(this.GWa=!0,this.Drc()),!Sa)return;this.Geg(Va,Oa,db,oa,!1)}}Geg(Va,db,oa,Oa,Wa){if(this.$.ea.fc){this.$.Jb&&(this.MJb=this.$.Jb.Bc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Lvb=null;var Sa=this.$.pa.va.Tb();
this.Lvb=Z(this.$.pa.va,Va,db,oa,Oa,Wa,this.kLi,this.jLi,null,Sa)}else this.fP=null}icb(){this.fP=null;this.GWa=!1;this.s_c();this.W1b();this.Lvb=null;this.nTb=-1}s_c(){Da.Upb(this.Lvb)}W1b(){Da.Upb(this.Med)}Drc(){this.raiseEvent(R.a)}qn(Va){Va=W.D(Va);--Va.left;--Va.right;return this.tableManager.qn(Va)}tKa(Va){Va.FirstColumn=Va.FirstColumn;Va.LastColumn=Va.LastColumn;Va.FirstRow=Va.FirstRow;Va.LastRow=Va.LastRow;this.W1b();this.Med=null;return da.a(this.$.userOperationManager,(db,oa,Oa)=>K.g(this.$.pa.va,
Va,pa.b(db,Wa=>{this.uLi(Wa)}),pa.a(oa,oa,Wa=>{this.tLi(Wa)}),Oa,null),db=>new ta.a(264,0,db,80),null)}tLi(Va){Va=na.a.ff(Va.data);f.ULS.sendTraceTag(525336847,0,10,`FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: ${P.a.xc(Va)}`)}uLi(Va){if(ka.a(Va))-315732528!==Va.Errors[0].MessageId&&f.ULS.sendTraceTag(525336846,0,10,`FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : ${P.a.xc(Va.Errors)}`);else if(Va&&Va.Result){Va=Va.Result;
var db=Va.HasHeaderRow;db=new O.AutofilterRange(Va.TableRange.FirstRow+(db?1:0)+1,Va.TableRange.FirstColumn+1,Va.TableRange.LastRow+1,Va.TableRange.LastColumn+1,null,null,null,0,db);this.nTb=Va.TableRange.FirstColumn;(Va=this.dLf(!1,!0,db))||f.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.LPd(Va)}else f.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")}qNj(Va,
db,oa){let Oa,Wa;Wa=null;Oa=!1;if(Va.SheetName!==this.$.ea.oa.sheetName)return{returnValue:!1,bab:Oa,tKa:!1,Xk:Wa};let Sa;this.nTb=-1;if(oa){Sa=this.qn(Va);if(!Sa||!Sa.aba)return{returnValue:!1,bab:Oa,tKa:!1,Xk:Wa};var yb=D.g(this.$).Fb.Z2e(Sa);this.I5d=Sa;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&yb&&0<yb.count)return--Va.FirstColumn,--Va.LastColumn,this.Med=this.tKa(Va),{returnValue:!0,bab:Oa,tKa:!0,Xk:Wa};Sa.top+=1;
Sa.right=W.D(Va).right-1}else Sa=new O.AutofilterRange(Va.FirstRow+1,Va.FirstColumn+1,Va.LastRow+1,Va.LastColumn+1,null,null,null,0,!1);if(Sa.top>Sa.bottom||Sa.left>Sa.right)return{returnValue:!0,bab:Oa,tKa:!1,Xk:Wa};Va=D.g(this.$);var Ma=Va.ib.width,Bb=Va.ib.height;yb=Va.view.visibleArea;Ma=new Q.a(yb.x-Ma,yb.y-Bb,yb.width+Ma,yb.height+Bb);Bb=Va.dg(Sa);if(!yb||!Bb||!Va.Xhc(Sa))return{returnValue:!1,bab:Oa,tKa:!1,Xk:Wa};Ma.contains(Bb)||(Oa=!0);Wa=this.dLf(db,oa,Sa);return{returnValue:!0,bab:Oa,tKa:!1,
Xk:Wa}}LPd(Va){Va&&f.ULS.sendTraceTag(25264348,0,50,`Retrieved ${Va.length} rich value field contexts from block cache`);this.BUb=!0;(this.fP=Va)&&0<this.fP.length&&(this.GWa=!0,this.Drc())}dLf(Va,db,oa){let Oa;Oa=null;const Wa=oa.clone();if(db)for(let Sa=oa.right,yb=0;Sa>=oa.left;--Sa){if(Wa.left=Sa,Wa.right=Sa,db=this.ZZe(Wa,!0,oa.left)){Oa||(Oa=[]);Oa[yb]=db;if(Va)break;++yb}}else if(Va=this.ZZe(Wa,!1))Oa=[],Oa[0]=Va;return Oa}ZZe(Va,db,oa=0){var Oa=null;if(d.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Wa=
D.g(this.$).Fb.PWh(Va);if(Wa&&0<Wa.count){var Sa=Array(Wa.count);Oa=0;for(var yb of Wa.values)Wa={},Wa.Name=yb,Sa[Oa]=Wa,++Oa;yb="";Wa=-1;0<Va.top&&db&&(Va=new V.Range(Va.top-1,Va.left,Va.top-1,Va.left,!1,!1),null!=D.g(this.$).Vb(Va)&&null!=D.g(this.$).Vb(Va).originalText&&(yb=D.g(this.$).Vb(Va).originalText),Wa=Va.left-oa);Oa={};Oa.ColumnName=yb;Oa.ColumnIndex=Wa;Oa.FieldInfoDataList=Sa}}else if((yb=D.g(this.$).Fb.Z2e(Va))&&0<yb.count){Sa=Array(yb.count);Oa=0;for(Wa of yb)yb={},yb.Name=Wa,Sa[Oa]=
yb,++Oa;yb="";Wa=-1;0<Va.top&&db&&(Va=new V.Range(Va.top-1,Va.left,Va.top-1,Va.left,!1,!1),yb=D.g(this.$).Vb(Va).originalText,Wa=Va.left-oa);Oa={};Oa.ColumnName=yb;Oa.ColumnIndex=Wa;Oa.FieldInfoDataList=Sa}return Oa}static Upb(Va){Va&&H.AFrameworkApplication.yd.Du(Va.Yt)}}Object(n.a)(Da,"FieldInfoManager",F.a,[403,10]);class Ba extends Da{constructor(Va,db,oa,Oa){super(Va,db);this.p2a=null;this.xyf=()=>{this.gtc(this.xyf);if(this.Xk&&this.Xk.length&&this.contextMenuManager){var Wa=this.contextMenuManager.ced("autoFilterRichFieldList"),
Sa=window.document.getElementById(this.p2a);Wa.A0(null,Sa,this,null,!0)}};this.Smg=oa;this.contextMenuManager=Oa}get aH(){return this.Smg}UOh(Va,db){this.p2a=db;f.ULS.sendTraceTag(537153825,0,100,`FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col (${Va.FirstRow}, ${Va.FirstColumn}, ${Va.LastRow}, ${Va.LastColumn})`);this.Geg(Va,null,!0,!1,!0)}}Object(n.a)(Ba,"FilterInfoManager",Da,[459,403,10]);var ea=a(838),Y=a(1092),ja=a(30),
ca=a(86),ba=a(8);class ua{}ua.nsh="ewa-sharedUi-launchButton";ua.qsh="ewa-sharedUi-launchButtonWithText";ua.osh="ewa-sharedUi-launchButtonClick";ua.rsh="ewa-sharedUi-launchButtonWithTextClick";ua.psh="ewa-sharedUi-launchButtonText";Object(n.a)(ua,"CssClassNames",null,[]);var wa=a(65);a(516);var ia=a(237),xa=a(223);F=a(236);var gb=a(286),va=a(71),sa=a(11),ab=a(250),Ua=a(34);class nb extends F.a{constructor(Va,db,oa,Oa,Wa,Sa,yb,Ma){super(document.createElement("div"));this.alf=null;this.UTd=!1;this.$Nb=
this.$Sa=null;this.MN=()=>{this.raiseEvent("OnObjectButtonMouseOver")};this.KN=()=>{this.raiseEvent("OnObjectButtonMouseOut")};this.fCj=()=>{this.sle()};this.gd=Bb=>{this.raiseEvent(this.OGb,Bb);this.MGb();return!0};this.rJi=Bb=>{100<r.a(w.a.Pa,this.alf)&&this.cjd(new Sys.UI.Point(Math.round(Bb.clientX),Math.round(Bb.clientY)))};this.FN=Bb=>{va.g(Bb.Ca,!1);return!1};this.MY=this.ve.VHa();this.set_visible(!1);this.vic=Wa;this.OGb=Sa;this.mmc=Va;this.U2b=db;this.vic&&(this.$Sa=m.a.instance.create(this.fCj,
3E4,"OnObjectButton.ShyTimerFired",!1,!1));Va&&this.domElement.classList.add(Va);this.M_a=document.createElement("div");this.domElement.appendChild(this.M_a);oa&&this.M_a.classList.add(oa);Oa&&(this.M_a.innerHTML=Oa);yb&&(this.$Nb=document.createElement("div"),this.domElement.appendChild(this.$Nb),this.$Nb.classList.add(Ma),this.$Nb.innerText=yb,this.domElement.style.padding="3px",ia.a.instance.ra(A.a.pointerDown,this.domElement,this.FN));this.C_a=new gb.a(this.domElement,7);xa.a.instance.ra(A.a.click,
this.domElement,this.gd);d.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&ia.a.instance.ra(A.a.pointerDown,this.domElement,this.FN);Va=Bb=>{va.g(Bb)};this.Gc.ka("mouseup",Va);this.Gc.ka("click",Va);this.Gc.ka("dblclick",Va)}p2(Va){this.addHandler(this.OGb,Va)}lda(Va){this.get_events().removeHandler(this.OGb,Va)}lHg(Va){this.addHandler("OnObjectButtonMouseOver",Va)}kcj(Va){this.get_events().removeHandler("OnObjectButtonMouseOver",Va)}kHg(Va){this.addHandler("OnObjectButtonMouseOut",
Va)}jcj(Va){this.get_events().removeHandler("OnObjectButtonMouseOut",Va)}Mdg(Va){Va&&(this.M_a.innerHTML=Va)}IQj(Va,db,oa){this.M_a.innerHTML="";Va?Va.lba(db,16,16,this.M_a,16,16,void 0,oa):f.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")}JQj(Va,db){Va&&(this.$Nb.innerText=Va);this.domElement.title=db}dispose(){this.get_isInitialized()&&(this.hide(),this.Gc.UC(),ca.a.qc([this.MY,this.C_a]),xa.a.instance.Ba(A.a.click,this.domElement,this.gd),
ia.a.instance.Ba(A.a.pointerDown,this.domElement,this.FN),this.$Sa&&this.$Sa.dispose(),super.dispose())}gcb(){this.U2b&&this.domElement.classList.remove(this.U2b);this.mmc&&this.domElement.classList.add(this.mmc)}MGb(){this.mmc&&this.domElement.classList.remove(this.mmc);this.U2b&&this.domElement.classList.add(this.U2b);this.C2a()}C2a(){this.vic&&(this.$Sa.cancel(),this.T7f(),this.setOpacity(1));this.set_visible(!0)}Jp(Va,db,oa,Oa,Wa=!1){Va=Ua.a(Oa).Ci(Va);db=Ua.a(Oa).Ci(db);Ua.a(Oa).Uwc(this.domElement);
this.domElement.style.top=sa.HelperMethods.pc(db);this.domElement.style.left=this.domElement.style.right="";db=Va;Wa&&(db=Va-this.domElement.offsetWidth);ab.c(this.domElement.style,oa,sa.HelperMethods.pc(db));this.set_visible(!0);this.setOpacity(1);this.vic&&(this.UTd=!1,this.XEj(),this.$Sa.lq())}hide(){this.gcb();this.set_visible(!1);this.vic&&(this.T7f(),this.$Sa.cancel())}W7b(){this.Gc.ka("mouseover",this.MN,!0);this.Gc.ka("mouseout",this.KN,!0)}XEj(){this.MY.tn("mousemove")||this.MY.ka("mousemove",
this.rJi)}T7f(){this.MY.tn("mousemove")&&this.MY.detach("mousemove")}cjd(Va){if(this.domElement.parentNode){var db=Sys.UI.DomElement.getBounds(this.domElement);const oa=new Sys.UI.Point(Math.round(db.x+db.width),Math.round(db.y+db.height));db=Math.abs(oa.x-Va.x);Va=Math.abs(oa.y-Va.y);Va=db>Va?db:Va;this.UTd?this.setOpacity(nb.VUg(Va)):100>=Va&&this.sle()}}sle(){this.UTd=!0;this.$Sa.cancel()}setOpacity(Va){x.a.setOpacity(this.domElement,Va);this.alf=w.a.Pa.zb}static VUg(Va){return 100>=Va?1:250<=
Va?0:.01*(100-(Va-100)/150*100)}}Object(n.a)(nb,"OnObjectButton",F.a,[699,700,10]);var Ha=a(790);const sb=ua.psh;class Qb extends k.a{constructor(Va,db,oa,Oa,Wa,Sa,yb,Ma=""){super();this.zwa=null;this.g$e=!1;this.Klc=this.Llc=null;this.buttons={};this.zNe={};this.$=Va;this.svgIconProvider=db;this.MHi=oa;this.Cec=Oa;this.Bec=Wa;this.altText=Sa;this.OGb=yb;this.buttonText=Ma}get rz(){return Ua.a(this.$).nGa(ba.a.pPi)}get v2b(){return ba.a.oPi}get buttonWidth(){return Ua.a(this.$).nGa(ba.a.qPi)}dispose(){this.Fhh();
this.$=null;super.dispose()}getButton(Va,db=!0){return this.lva(Va,db)}lva(Va,db=!0){const oa=Va.toString();oa in this.buttons||this.B8g(Va,db);return this.buttons[oa]}Jp(Va,db,oa,Oa,Wa=!0,Sa=!1){this.hide();if(this.$.ea.isNamedObjectViewMode&&wa.i(this.$.oa)){var yb=D.g(this.$).WR.domElement;const Ma=Va+this.buttonWidth-yb.scrollWidth;yb=db+this.buttonWidth-yb.scrollHeight;Va=0<Ma?Va-Ma:Va;db=0<yb?db-yb:db}this.lva(Oa,Wa).Jp(Va,db,oa,this.$,Sa)}hide(){const Va=this.buttons;for(let db in Va)Va[db].hide()}W7b(Va,
db){!this.g$e&&(db=this.buttons[db.toString()])&&(this.Llc=(oa,Oa)=>{Va(Oa,!0)},db.lHg(this.Llc),this.Klc=(oa,Oa)=>{Va(Oa,!1)},db.kHg(this.Klc),this.g$e=!0,db.W7b())}B8g(Va,db){this.zwa=String.format(this.Cec===U.a.L8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',ja.a.zg(this.Cec),ja.a.zg(this.Bec),"{0}");var oa=String.format(this.zwa,ja.a.zg(this.altText));db=new nb(""===this.buttonText?
ua.nsh:ua.qsh,""===this.buttonText?ua.osh:ua.rsh,U.a.WA,oa,db,this.OGb,this.buttonText,sb);oa=(Oa,Wa)=>{this.MHi(Wa,Va)};db.p2(oa);this.buttons[Va.toString()]=db;this.zNe[Va.toString()]=oa;oa=D.g(this.$).Hf(Va);oa.domElement.insertBefore(db.domElement,oa.domElement.firstChild)}Fhh(){for(const Va of Ha.a(this.buttons)){const db=this.buttons[Va];db.lda(this.zNe[Va]);ca.a.Ia(db);delete this.buttons[Va];this.Llc&&db.kcj(this.Llc);this.Klc&&db.jcj(this.Klc)}}domElement(Va){return this.lva(Va).domElement}C2a(Va){this.lva(Va).C2a()}Eeg(Va,
db){this.Cec=Va;this.Bec=db}APb(Va,db,oa=!0){this.zwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',ja.a.zg(this.Cec),ja.a.zg(this.Bec),"{0}");Va=String.format(this.zwa,ja.a.zg(Va));this.lva(db,oa).Mdg(Va)}wUa(Va,db,oa){this.lva(oa,!1).JQj(Va,db)}Ceg(){this.zwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",ja.a.zg(this.Bec),"{1}");const Va=String.format(this.zwa,void 0,
ja.a.zg(void 0));this.lva(void 0,!1).Mdg(Va)}Deg(Va,db,oa){this.lva(oa,!1).IQj(this.svgIconProvider,Va,db)}}Object(n.a)(Qb,"OnObjectLaunchButton",k.a,[681,10]);k=a(93);class mb extends k.a{constructor(Va,db){super(Va);this.uCb=null;this.phh=()=>{this.display()};this.r9h=Math.max(1,db)}dispose(){ca.a.Ia(this.uCb);this.uCb=null;super.dispose()}oTa(){ca.a.Ia(this.uCb);this.uCb=m.a.instance.create(this.phh,this.r9h,u.a.Nti)}uTa(){ca.a.Ia(this.uCb);this.hide()}}Object(n.a)(mb,"LoadingIndicatorBehavior",
k.a,[592,10]);class Pb extends mb{constructor(Va,db,oa,Oa){super(Va,db);this.tCb=null;this.qpg=oa;this.z6h=Oa;this.XCg()}dispose(){this.tCb=null;super.dispose()}display(){this.qpg(this.tCb)}hide(){this.z6h(this.tCb)}XCg(){this.tCb=document.createElement("div");this.domElement.appendChild(this.tCb)}}Object(n.a)(Pb,"ShimmerLoadingIndicatorBehavior",mb,[]);var gc=a(73),Xb=a(53),Ca=a(12);class ra extends mb{constructor(Va,db,oa=null,Oa=null,Wa=0){super(Va,db);this.cOa=null;this.Hec=oa||Xb.a.current.Zn(105);
this.Lmf=Wa;this.v5c=Oa;this.WCg()}dispose(){this.cOa=null;super.dispose()}display(){Ca.DOMElementExtensions.setVisible(this.cOa,!0)}hide(){Ca.DOMElementExtensions.setVisible(this.cOa,!1)}WCg(){this.cOa=document.createElement("div");this.cOa.classList.add(gc.a.Wqh);const Va=document.createElement("div");Va.classList.add(gc.a.Xqh);this.v5c&&""!=this.v5c&&Va.classList.add(this.v5c);const db=0===this.Lmf?"":G.a.instance.ga(this.Lmf),oa=String.format('<div class="'+gc.a.Yqh+'">{0}</div>',db);Va.innerHTML=
this.Hec?`<img src="${this.Hec}" alt="${db}" title="${db}"/>`+oa:oa;this.cOa.appendChild(Va);this.domElement.appendChild(this.cOa)}}Object(n.a)(ra,"SpinnerLoadingIndicatorBehavior",mb,[]);class ma{v4c(Va,db,oa){return new ea.a(Va,db,oa)}S4b(Va,db,oa,Oa,Wa,Sa,yb,Ma,Bb,Nb){return new Y.a(Va,db,oa,Oa,Wa,Sa,yb,Ma,Bb,Nb)}Orb(Va,db,oa,Oa,Wa=0){return new ra(Va,db,oa,Oa,Wa)}jgd(Va){return Va.da.za(238)||new L(Va)}V4b(Va,db,oa,Oa,Wa,Sa,yb,Ma=""){return new Qb(Va,db,oa,Oa,Wa,Sa,yb,Ma)}Y3c(Va,db){return new Da(Va,
db)}w7g(Va,db,oa,Oa){return new Ba(Va,db,oa,Oa)}F3c(Va,db,oa,Oa){return new y(Va,db,oa,Oa)}}Object(n.a)(ma,"SharedUIControlsFactory",null,[521]);class hb extends b.a{constructor(Va){super();this.$=Va;this.Eb()}create(){d.EwaSettings.ll()?this.pb(this.$.da.za(12)||new ma):this.pb(new ma)}static ka(Va){Va.da.Ga(477,new hb(Va))}}Object(n.a)(hb,"SharedUIControlsFactoryServiceFactory",b.a,[]);a.d(C,"a",function(){return vb});const vb=()=>{c.a.Fa(hb.ka)}},1163:function(n,C,a){var c=a(9);n=a(0);var b=a(222),
d=a(50),f=a(37),e=a(1),k=a(809);class l extends b.a{constructor(Ia){super();this.$=Ia;this.Eb()}create(){const Ia=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.fb),jb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([Ia,jb],this.la),()=>{this.pb(this.$.da.za(296)||this.$.da.Ga(296,new k.BorderFormatManager(this.$,Ia.result,jb.result)))},this.la,3)}static ka(Ia){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&
Ia.da.Ga(468,new l(Ia))}}Object(n.a)(l,"BorderFormatManagerFactory",b.a,[]);var m=a(694),u=a(15),t=a(263),w=a(173),r=a(822),v=a(27),y=a(39),x=a(30),B=a(94),z=a(260),A=a(352),I=a(349),F=a(98),U=a(187),X=a(8),T;(function(Ia){Ia[Ia.insert=1]="insert";Ia[Ia.delete=2]="delete";Ia[Ia.rows=4]="rows";Ia[Ia.columns=8]="columns";Ia[Ia.cellsShiftHorizontal=16]="cellsShiftHorizontal";Ia[Ia.cellsShiftVertical=32]="cellsShiftVertical";Ia[Ia.insertRows=5]="insertRows";Ia[Ia.insertColumns=9]="insertColumns";Ia[Ia.insertCellsShiftRight=
17]="insertCellsShiftRight";Ia[Ia.insertCellsShiftDown=33]="insertCellsShiftDown";Ia[Ia.deleteRows=6]="deleteRows";Ia[Ia.deleteColumns=10]="deleteColumns";Ia[Ia.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";Ia[Ia.deleteCellsShiftUp=34]="deleteCellsShiftUp";Ia[Ia.insertRowsBelow=37]="insertRowsBelow"})(T||(T={}));Object(n.b)("InsertDeleteCellFlags",T);var G=a(5),D=a(421),J=a(65),L=a(77);class H{constructor(Ia){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=Ia}}Object(n.a)(H,
"MacroRecorderRangeInsertedOrDeletedPayload",null,[115]);var R=a(1079),Q=a(43),O=a(515),V=a(370),W=a(171),da=a(61),ta=a(283),K=a(145),na=a(456),P=a(113),ka=a(53),pa=a(197),Na=a(90),Z=a(35),Ra=a(29),Da=a(282),Ba=a(257),ea=a(11),Y=a(183),ja=a(22),ca=a(281);class ba{constructor(Ia,jb,Ob,Jb,Kb=0){this.yqg=Ia;this.zqg=jb;this.kyg=Ob;this.kXb=Jb;this.HDh=Kb}get bja(){return this.yqg}get li(){return this.zqg}get style(){return this.kyg}get size(){return this.kXb}get aZ(){return this.HDh}static zSg(Ia,jb){return new ba(Ia,
jb,null,null,null)}static tZc(Ia,jb){return new ba(Ia,null,jb,null,null)}static ASg(Ia,jb){return new ba(Ia,null,null,jb,null)}static ySg(Ia,jb,Ob){return new ba(Ia,null,jb,null,Ob)}}Object(n.a)(ba,"CachedPreviewCellGroup",null,[]);var ua=a(82);b=a(284);var wa=a(100),ia=a(14);class xa extends b.a{constructor(Ia,jb,Ob){super(Ia);this.Nl=null;this.T6c=0;this.mci=(Jb,Kb)=>{if(0===Jb)u.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Jb=
{};var Qa="",ha=1035996630;switch(Kb.selectedKey){case 0:Qa=1896159024===this.Fr?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Qa=1896159024===this.Fr?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===this.Fr?(Qa="InsertRows",ha=-1113896058):(Qa="DeleteRows",ha=1554436520);break;case 3:1896159024===this.Fr?(Qa="InsertColumns",ha=1415868706):(Qa="DeleteColumns",ha=674605324)}u.ULS.sendTraceTag(574993490,0,50,`InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:${Qa}`);
Kb=new Na.a(ha,1,2,8,null);Jb[L.a.Qc]=Qa;this.$.Ka.Lb(Kb,Jb)}};this.Fr=jb;this.selectedRanges=Ob;this.isRtl=Object(ua.a)(wa.a,this.$.xa.oa).displayRtl}get uc(){return"InsertDeleteCellsDialog"}Ag(){1896159024===this.Fr?(this.Nl=ia.a.instance.ga(23),this.T6c=0):(this.Nl=ia.a.instance.ga(22),this.T6c=1);const Ia=this.selectedRanges[0].VZ&&!this.selectedRanges[0].o5?0:1;this.Rb=1;this.initializeAndShow(this.Nl,this.mci,{[xa.dv]:this.uc,["dialogToDisplay"]:this.T6c,["defaultSelectedKey"]:Ia,["isRtl"]:this.isRtl})}}
Object(n.a)(xa,"InsertDeleteCellsDialog",b.a,[]);const gb=(Ia,jb,Ob,Jb,Kb,Qa,ha=null)=>{ha=Ia.Na(41,ha);ha.insertDeleteMultiRangeParameters=jb;return da.g(Ia,"InsertDeleteCells",ha,Ob,Jb,Kb,Qa,0)};class va{constructor(Ia,jb,Ob,Jb){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=Ia;this.targetSheetRange=jb;this.fillRangeType=Ob;this.fillRangeDirection=Jb}}Object(n.a)(va,"MacroRecorderRangeFilledPayload",null,[115]);var sa=a(7),ab=
a(24);class Ua{constructor(){this.uRa=this.MGa=this.RNa=this.aUa=0}}Object(n.a)(Ua,"RangeBorders",null,[]);class nb{constructor(){this.scenario=0;this.rQ=null}}Object(n.a)(nb,"ScenarioInfo",null,[]);var Ha=a(910),sb=a(21),Qb=a(262),mb=a(209),Pb=a(79);class gc{constructor(Ia,jb){this.$=Ia;this.xg=jb;this.xx=new Ha.a(sb.g(this.$).Ea,this.$);this.hzb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Jpd=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.jhc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.mff=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Igi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.kjf=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.Whc=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.Xzb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.khc=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1);this.Qji=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6327711_MergeCellMultiBlockUnmergeBitFix");this.Pgi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6350260_MergeCellCSEDataLossScenarioUnmergeConditionFix");this.jdf=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6209366_MergeCellCSECellFormatAssertFix");
this.jff=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6402649_HiddenCellsAvoidCseFixEnabled");this.gki=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6476102_MergeCellCSEMultiBlockMergeFlagsFix");this.qpi=e.EwaSettings.isChangeGateEnabled("OfficeVSO:6665369_MergeCellCSEWrapTextFixForUnmergeScenarios")}dispose(){this.$=null}Ogi(Ia,jb){return!(void 0===jb||null===jb)&&!!(jb.scenario&16384)&&!this.Qgi(Ia,jb)&&this.cdf(jb,Ia)}S0e(){var Ia=y.a.Ud(),jb=sb.g(this.$),Ob=jb.ha.sa.selectedRanges;let Jb=0;var Kb=
0,Qa=Ob.length;const ha=new nb;if(1<Qa)return ha.scenario=4,ha;if(this.jff&&jb.Zd.Dhc(Ob[0]))return ha.scenario=262144,ha;this.Jpd&&sb.g(this.$).rtl&&(Jb|=65536);if(!jb.wK(Ob[0]))if(this.hzb)Jb|=32;else return ha.scenario=32,ha;if(jb=jb.Ea.BKa(Ob[0],this.$.activeItemName)){ha.NYc=jb;for(var qa of jb)if(Kb+=1,1<Kb){this.hzb?(Jb|=256,ha.scenario=Jb):ha.scenario=256;if(!this.Xzb)return ha;break}}Kb=sb.g(this.$).Ea.nja(Ob[0]);if(!Kb)return ha.scenario=32768,ha;qa=Kb.length;Ob=Ob[0];jb=Ob.bottom-Ob.top+
1;Qa=Ob.right-Ob.left+1;const pb=new Ua;for(let bb=0;bb<qa;bb++)if(this.HVh(Kb[bb],Ob,pb),Jb=Jb|(void 0!==Kb[bb].text&&null!==Kb[bb].text&&""!==Kb[bb].text?1:0)|(Kb[bb].FF?2:0)|(Kb[bb].ewa?8:0)|(Kb[bb].gxb?16:0)|(Kb[bb].tF?64:0)|(Kb[bb].Yaa?128:0),void 0!==Kb[bb].text&&null!==Kb[bb].text&&""!==Kb[bb].text||Kb[bb].ewa)if(void 0===ha.rQ||null===ha.rQ)ha.rQ=sb.g(this.$).Vb(Kb[bb].getRange());else{if(Kb[bb].getRange().top<ha.rQ.range.top||Kb[bb].getRange().top==ha.rQ.range.top&&Kb[bb].getRange().left<
ha.rQ.range.left)ha.rQ=sb.g(this.$).Vb(Kb[bb].getRange());Jb|=16384}pb.aUa===Qa&&(Jb|=512);pb.MGa===Qa&&(Jb|=2048);pb.RNa===jb&&(Jb|=4096);pb.uRa===jb&&(Jb|=1024);if(0<pb.aUa&&pb.aUa<Qa||0<pb.MGa&&pb.MGa<Qa||0<pb.RNa&&pb.RNa<jb||0<pb.uRa&&pb.uRa<jb)Jb|=8192;!e.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||Ob.right!==Ob.maxColumns&&Ob.bottom!==Ob.maxRows||(Jb|=131072);Ia=y.a.Ud()-Ia;u.ULS.sendTraceTag(537159424,0,50,`Execution time of GetMergeCellScenario is : ${Ia}`);
ha.scenario=Jb;return ha}yrf(Ia,jb){const Ob=Ia.command;if(void 0===jb||null===jb)jb=this.S0e();if(!this.cdf(jb,Ob))return!1;Ia=sb.g(this.$).ha.sa.selectedRanges;var Jb=sb.g(this.$).Ea.nja(Ia[0]);if(!Jb)return!1;if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===Jb.length&&!Jb[0].FF)return-167499203===Ob?(Jb[0].u0(2,!0),!0):!1;Jb=sb.g(this.$).ha.sa.ls;const Kb=this.$.oa.sheetName;let Qa=!0;switch(Ob){case -167499203:2===(jb.scenario&2)&&this.jhc?this.Ocg(jb.scenario,
Ia,Ob):Qa=this.zAi(jb,Ia);break;case 1097660126:(jb=this.zrf(jb,Ia))&&0!=jb.length||(Qa=!1);break;case 155820588:this.Ocg(jb.scenario,Ia,Ob);break;default:return!1}sb.g(this.$).rZ(Ia,Jb,Kb,null,Ia[0],null,null,0,"MergeCellCommandAction");return this.Xzb?Qa:!0}cdf(Ia,jb){const Ob=this.Afi(Ia,jb);if(!this.mff)return Ob;const Jb=sb.g(this.$).ha.sa.selectedRanges[0].pz(!1);u.ULS.sendTraceTag(526149324,0,50,`Merge Cell Command: ${jb.toString()}; Scenario Number: ${Ia.scenario}; IsCSEPossible result: ${Ob}; Range: ${Jb}`);
return Ob}Afi(Ia,jb){if(-255094134===jb)return!1;var Ob=Ia.scenario;if(this.jff&&262144===Ob||this.Jpd&&65536===(Ob&65536))return!1;if(this.jjf(jb,Ia))return Ob=sb.g(this.$).ha.sa.selectedRanges,0===Ob.length?!1:this.toi(jb,Ia,Ob[0]);this.hzb&&32===(Ob&32)&&(Ob&=-33);if(256==(Ob&256))if(this.fki(Ia))Ob&=-257;else return!1;return 32768===Ob||4===Ob||128===(Ob&128)||!this.hzb&&32===Ob?!1:-167499203!=jb&&1097660126!==jb||!this.wnd(Ia)?void 0!==Ia.rQ&&null!==Ia.rQ&&Ia.rQ.a8?!1:0===Ob?!0:16384===(Ob&16384)?
e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(Ob&1)&&8!==(Ob&8)||!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.khc}Bhi(Ia){return 131072===(Ia.scenario&131072)?!0:!1}fki(Ia){if(!this.Xzb)return!1;let jb="Multi block",Ob=!0;this.wnd(Ia)&&(jb+=" with border",Ob=!1);this.Bhi(Ia)&&(Ob=!1,jb+=" with entire row or column selected",16384===(Ia.scenario&16384)&&(jb+=" and a data loss scenario"));
Ob||u.ULS.sendTraceTag(523511383,0,50,`CSE for ${jb}, is not enabled`);return Ob}wnd(Ia){return 16===(Ia.scenario&16)||this.zjd(Ia.scenario)||this.Tjd(Ia.scenario)||this.Ljd(Ia.scenario)||this.Vjd(Ia.scenario)||8192===(Ia.scenario&8192)?!0:!1}Qgi(Ia,jb){return this.Pgi?this.jjf(Ia,jb):155820588===Ia}jjf(Ia,jb){return 155820588===Ia||(-167499203===Ia||1097660126===Ia)&&2===(jb.scenario&2)&&this.jhc?!0:!1}soi(Ia){return this.Vjd(Ia.scenario)||this.Ljd(Ia.scenario)||this.zjd(Ia.scenario)||this.Tjd(Ia.scenario)?
!0:!1}A5h(Ia){Ia=sb.g(this.$).Ea.nja(Ia);if(!Ia||0===Ia.length)return!1;for(let jb=0;jb<Ia.length;jb++)if(Ia[jb].FF&&Ia[jb].a8)return!0;return!1}toi(Ia,jb,Ob){if(1097660126===Ia&&2===(jb.scenario&2))return!1;if(this.qpi){if(this.A5h(Ob))return!1}else if(this.Igi&&void 0!==jb.rQ&&null!==jb.rQ&&jb.rQ.a8)return!1;this.hzb&&32===(jb.scenario&32)&&(jb.scenario&=-33);return 32768===jb.scenario||4===jb.scenario||256===(jb.scenario&256)&&this.Qji||128===(jb.scenario&128)?!1:2===(jb.scenario&2)?this.soi(jb)?
e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",!1):!1}HVh(Ia,jb,Ob){const Jb=Ia.getRange();if(Jb.top===jb.top)if(Ia.xLa)Ob.aUa+=Jb.right-Jb.left+1;else{var Kb=this.xx.vQ(Jb,0);if(Kb)for(const ha of Kb)ha.rLa&&(Ob.aUa+=ha.getRange().right-ha.getRange().left+1)}if(Jb.left===jb.left)if(Ia.tLa)Ob.RNa+=Jb.bottom-Jb.top+1;else if(Kb=this.xx.vQ(Jb,
2))for(var Qa of Kb)Qa.vLa&&(Ob.RNa+=Qa.getRange().bottom-Qa.getRange().top+1);if(Jb.bottom===jb.bottom)if(Ia.rLa)Ob.MGa+=Jb.right-Jb.left+1;else if(Qa=this.xx.vQ(Jb,1))for(const ha of Qa)ha.xLa&&(Ob.MGa+=ha.getRange().right-ha.getRange().left+1);if(Jb.right===jb.right)if(Ia.vLa)Ob.uRa+=Jb.bottom-Jb.top+1;else if(Ia=this.xx.vQ(Jb,3))for(const ha of Ia)ha.tLa&&(Ob.uRa+=ha.getRange().bottom-ha.getRange().top+1)}p$i(Ia,jb){for(let Ob of jb.NYc){jb=Ia.Ie(Ob.tf);jb=sb.g(this.$).Ea.nja(jb);const Jb=jb.length;
for(let Kb=1;Kb<Jb;Kb++){const Qa=sb.g(this.$).Vb(jb[Kb].getRange());this.khc?Qa.cell.deleteCellFromModel():(Qa.lqb(),Qa.clearFormat(),Qa.cell.q$i());Qa.zIb(!0)}}}bUj(Ia,jb){Ia.backgroundColor=jb.backgroundColor;Ia.color=jb.color}Kjg(Ia,jb){return{SpansBlocks:!0,OriginRow:Ia,OriginColumn:jb,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}}GBg(Ia,jb,Ob,Jb,Kb){Ob=Ia.Ie(Ob.tf);if(!Ob)return u.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var Qa=new ab.Range(Ia.top,Ia.left,Ob.top,Ob.left,!1,!1);let ha;Ob.top==Ia.top?ha=0:(Qa.bottom=Ob.top-1,ha=jb.Egd(Qa));Ob.left==Ia.left?Qa=0:(Qa.right=Ob.left-1,Qa=jb.Fgd(Qa));jb=this.Kjg(Ia.top-1,Ia.left-1);jb.OriginDeltaY=ha;jb.OriginDeltaX=Qa;jb.Rows=Ob.bottom-Ob.top;jb.Columns=Ob.right-Ob.left;jb.Height=Kb;jb.Width=Jb;Ob.top==Ia.top&&Ob.left==Ia.left&&(jb.IsOrigin=!0);Ia=sb.g(this.$).Vb(Ob.topLeft);Ia.cell.D0f(jb);return Ia}mQd(Ia,jb){let Ob=[];const Jb=sb.g(this.$).Zd;if(!Jb)return Ob;const Kb=
Jb.Egd(Ia),Qa=Jb.Fgd(Ia);if(jb.NYc)for(const ha of jb.NYc)if(jb=this.GBg(Ia,Jb,ha,Qa,Kb))Ob.push(jb);else{Ob=[];break}return Ob}GWh(Ia,jb,Ob,Jb){var Kb=Ob.bottom-Ob.top,Qa=Ob.right-Ob.left;let ha=[];const qa=Jb.scenario;if(256===(qa&256)){if(ha=this.mQd(Ob,Jb),!ha||0==ha.length)return ha}else jb.cell.mQd(Kb,Qa),ha.push(jb);Kb=this.R2(this.L4(jb),!0,0,qa,"merge");if(void 0!==Ia&&null!==Ia)for(const pb of ha){Qa=Ia.cell.li;const bb=Object(sa.a)(new Qb.a,{TextRuns:Qa.TextRuns,Fonts:Qa.Fonts});bb.Text=
void 0!==Ia.cell.originalText&&null!==Ia.cell.originalText?Ia.cell.originalText:void 0!==Ia.cell.userInput&&null!==Ia.cell.userInput?Ia.cell.userInput:Qa.Text;Kb=this.R2(this.L4(pb),Kb,1,qa,"merge");this.xg.TSa(pb,bb,!1,null,!0,"MergeCells",void 0,2);Kb=this.R2(this.L4(pb),Kb,2,qa,"merge");this.Jpd?pb.uqb(Ia):this.bUj(pb,Ia);Kb=this.R2(this.L4(pb),Kb,3,qa,"merge");pb.cell.J4g(Ia.cell);Kb=this.R2(this.L4(pb),Kb,4,qa,"merge");pb.cell.PCc(!1);Kb=this.R2(this.L4(pb),Kb,6,qa,"merge")}this.p$i(Ob,Jb);this.R2(this.L4(jb),
Kb,5,qa,"merge");return ha}Ljd(Ia){return 4096===(Ia&4096)}Vjd(Ia){return 512===(Ia&512)}zjd(Ia){return 2048===(Ia&2048)}Tjd(Ia){return 1024===(Ia&1024)}sac(Ia,jb){let Ob=null;for(let Jb=0;Jb<Ia.length;Jb++)if(Ia[Jb].BorderPosition===jb){Ob=Ia[Jb];break}return Ob}QRh(Ia,jb){this.Whc?(jb=this.sac(jb.cell.RM().Borders,2))&&Ia.push(jb):(jb=jb.cell.RM().Borders,1<jb.length&&(jb=[jb[1]]),Ia=[...jb,...Ia]);return Ia}UZh(Ia,jb){this.Whc?(jb=this.sac(jb.cell.RM().Borders,0))&&Ia.push(jb):(jb=jb.cell.RM().Borders,
1<jb.length&&(jb=[jb[0]]),Ia=[...jb,...Ia]);return Ia}PJh(Ia,jb){jb=this.xx.vQ(jb.cell.getRange(),1);if(!jb||0===jb.length)return Ia;if(this.Whc){if(jb=jb[0].RM().Borders,jb=this.sac(jb,0))jb.BorderPosition=1,Ia.push(jb)}else{let Ob=[];0<jb.length&&(Ob=jb[0].RM().Borders);Ob[0].BorderPosition=1;Ia=[...Ob,...Ia]}return Ia}QWh(Ia,jb){jb=this.xx.vQ(jb.cell.getRange(),3);if(!jb||0===jb.length)return Ia;if(this.Whc){if(jb=jb[0].RM().Borders,jb=this.sac(jb,2))jb.BorderPosition=3,Ia.push(jb)}else{let Ob=
[];0<jb.length&&(Ob=jb[0].RM().Borders);Ob[0].BorderPosition=3;Ia=[...Ob,...Ia]}return Ia}IVh(Ia,jb,Ob){this.Ljd(Ia.scenario)&&(jb=this.QRh(jb,Ob));this.Vjd(Ia.scenario)&&(jb=this.UZh(jb,Ob));this.zjd(Ia.scenario)&&(jb=this.PJh(jb,Ob));this.Tjd(Ia.scenario)&&(jb=this.QWh(jb,Ob));return jb}dZ(Ia){if(0===Ia.length)return null;let jb=[0,0,0,0],Ob=[1,1,1,1],Jb=0;Ia.forEach(function(Qa){let ha=Qa.BorderPosition;Ob[ha]=Qa.BorderLineStyle;let qa=new mb.a(Qa.Color.Red,Qa.Color.Green,Qa.Color.Blue);jb[ha]=
qa.mS();Jb|=ea.HelperMethods.Y3a(Qa.BorderPosition)});Ia={};Ia.LineStyle=Ob;Ia.Color=jb;let Kb={};Kb.BorderFormat=Ia;Kb.Border=Jb;return Kb}o2d(Ia,jb,Ob=null){let Jb=[];Jb=null!==Ob?[...Ob]:this.IVh(jb,Jb,Ia);if(jb=this.dZ(Jb))Ia.cell.Cbb(Ia.cell.getRange()),this.xx.yIb(Ia.cell.getRange()),this.xg.Vda(sb.g(this.$),-1690267012,jb,!1,null,[Ia.cell.getRange()])}pli(Ia){return 512===(Ia.scenario&512)||4096===(Ia.scenario&4096)||1024===(Ia.scenario&1024)||2048===(Ia.scenario&2048)?!0:!1}VZh(Ia){Ia=this.xx.vQ(Ia.cell.getRange(),
1);return Ia&&0!==Ia.length?Ia[0].xLa?(Ia=Ia[0].RM().Borders[0],Ia.BorderPosition=1,Ia):null:null}WZh(Ia){Ia=this.xx.vQ(Ia.cell.getRange(),3);return Ia&&0!==Ia.length?Ia[0].tLa?(Ia=Ia[0].RM().Borders[0],Ia.BorderPosition=3,Ia):null:null}v3h(Ia,jb,Ob,Jb,Kb){jb.cell.Oeg();if(this.pli(Ia))this.o2d(jb,Ia);else{const Qa=8192===(Ia.scenario&8192),ha=jb.cell.getRange();Qa&&this.jdf?(jb.cell.Cbb(),this.xx.yIb(ha)):Kb?(Kb=[],null!==Ob&&Kb.push(Ob),null!==Jb&&Kb.push(Jb),0<Kb.length?this.o2d(jb,Ia,Kb):(jb.cell.Cbb(),
this.xx.yIb(ha))):Qa&&!this.jdf&&(jb.cell.Cbb(),this.xx.yIb(ha))}}mRh(Ia,jb){return null===Ia||void 0===Ia?!0:Ia.cell.getRange().top===jb.topLeft.top&&Ia.cell.getRange().left===jb.topLeft.left&&Ia.cell.getRange().bottom===jb.topLeft.bottom&&Ia.cell.getRange().right===jb.topLeft.right?!0:!1}zAi(Ia,jb){jb=this.zrf(Ia,jb);if(this.Xzb&&(!jb||0==jb.length))return!1;for(let Ob=0;Ob<jb.length;Ob++)jb[Ob].u0(2,!0),this.R2(this.L4(jb[Ob]),!0,8,Ia.scenario,"merge");return!0}ASj(Ia){const jb=sb.g(this.$).Ea.BKa(Ia,
this.$.activeItemName);if(jb&&Pb.Ct(jb))for(let Ob of jb)Ob.c_d(Ia,!0)}zrf(Ia,jb){const Ob=Ia.rQ,Jb=sb.g(this.$).Vb(jb[0]);let Kb=null,Qa=null;this.khc&&(Kb=this.VZh(Jb),Qa=this.WZh(Jb));const ha=this.GWh(Ob,Jb,jb[0],Ia);if(this.Xzb&&(!ha||0==ha.length))return ha;this.gki?this.ASj(jb[0]):sb.g(this.$).Ea.f$(jb[0],this.$.activeItemName).c_d(jb[0],!0);this.R2(this.L4(Jb),!0,9,Ia.scenario,"merge");if(this.khc&&this.wnd(Ia)){jb=this.mRh(Ob,jb[0]);for(const qa of ha)this.v3h(Ia,qa,Kb,Qa,jb)}return ha}OLg(Ia,
jb,Ob){if(!(1>Ia.Borders.length)){var Jb=this.dZ(Ia.Borders);Ob.forEach(Kb=>{Kb=sb.g(this.$).Vb(Kb.getRange());this.xg.V4f(-1690267012,Kb,Jb,!1,null,!1,jb)})}}ePj(Ia,jb,Ob){const Jb=Ia.length;for(let Qa=0;Qa<Jb;Qa++){Ia[Qa].cell.PCc();const ha=Ia[Qa].cell.getRange(),qa=sb.g(this.$).Ea.nja(ha),pb=qa.length;if(-167499203===jb&&this.jhc){var Kb=0;2===Ia[Qa].cell.aId||1===Ia[Qa].cell.DJ?Kb=3:2===Ia[Qa].cell.DJ&&(Kb=1);Ia[Qa].u0(Kb,!1)}for(Kb=1;Kb<pb;Kb++)qa[Kb].attachCellToModel(),qa[Kb].uqb(Ia[Qa]),
-167499203===jb&&this.jhc&&qa[Kb].u0(null,!1);this.kjf&&Ob&&this.OLg(Ob[Qa],ha,qa)}}qXe(Ia,jb){let Ob=null;for(let Jb=0;Jb<Ia.length;Jb++)if(Ia[Jb].BorderPosition===jb){Ob=Ia[Jb];break}return Ob}OJh(Ia,jb){let Ob=Ia.cell.RM();Ia.rLa()&&Ia.cell.OQa(1);Ia.vLa()&&Ia.cell.OQa(3);if((Ia=this.xx.vQ(jb,0))&&Ia[0].rLa){var Jb=Ia[0].RM().Borders;Jb=this.qXe(Jb,1);Jb.BorderPosition=0;Ob.Borders.push(Jb);Ia.forEach(Kb=>{Kb.OQa(1)})}(jb=this.xx.vQ(jb,2))&&jb[0].vLa&&(Ia=jb[0].RM().Borders,Ia=this.qXe(Ia,3),Ia.BorderPosition=
2,Ob.Borders.push(Ia),jb.forEach(Kb=>{Kb.OQa(3)}));return Ob}Ocg(Ia,jb,Ob){var Jb=sb.g(this.$).Ea.Cva(jb[0],this.$.activeItemName);const Kb=sb.g(this.$).Ea.f$(jb[0],this.$.activeItemName),Qa=[];if(void 0!==Jb&&null!==Jb&&(jb=sb.g(this.$).Bva(jb[0],Jb),void 0!==jb&&null!==jb)){jb=jb.$$ge();for(Jb=[];jb.$$mn();){var ha=jb.$$cu();if(ha.QH){Qa.push(ha);this.R2(this.L4(ha),!0,10,Ia,"unmerge");ha.cell.qZg();const qa=ha.cell.getRange();this.R2(this.L4(ha),!1,11,Ia,"unmerge");Kb.c_d(qa,!1);this.kjf&&(ha=
this.OJh(ha,qa),Jb.push(ha))}}0<Qa.length&&(Kb.vf.resetCellLookup(),this.ePj(Qa,Ob,Jb))}}R2(Ia,jb,Ob,Jb,Kb){if(!this.mff)return!1;Ia!==jb&&u.ULS.sendTraceTag(526149323,0,50,`Merge Information for resultant cell is unexpectedly changed at step: ${Ob}; Scenario: ${Jb}; Command: ${Kb}; Expected: ${jb?"populated":"empty"}; Actual: ${Ia?"populated":"empty"}`);return Ia}L4(Ia){return!!Ia.cell.cell.Merge}}Object(n.a)(gc,"MergeCellCommandAction",null,[]);var Xb=a(75),Ca=a(97),ra=a(200),ma=a(42),hb=a(459),
vb=a(376),Va=a(51),db=a(68),oa=a(55),Oa=a(1086),Wa=a(33),Sa=a(341),yb=a(172);class Ma{constructor(Ia,jb,Ob,Jb,Kb,Qa,ha){this.$=Ia;this.gridView=jb;this.xg=Ob;this.FB=Jb;this.borderFormatManager=Kb;this.moreColorsHelper=Qa;this.fontDropdownHelper=ha;this.zC=null;this.T_a=1461300262;this.ox=this.Q_a=this.k9a=this.E$b=null;this.tNi=(qa,pb,bb)=>{const eb=!!qa&&!!qa.RequestTelemetryData;!Da.a(qa)&&pb&&sb.g(this.$).Pi.vla(pb,qa.StateId,eb?qa.RequestTelemetryData.EcsOperationDuration:0,eb?qa.RequestTelemetryData.EcsRequestDuration:
0,eb?qa.RequestTelemetryData.WfeRequestDuration:0);if(e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){pb=1;if(33===bb||17===bb||9===bb||5===bb||37===bb)pb=0;this.R0(pb,qa)}};this.eKi=qa=>{e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)&&this.R0(3,qa)};this.pqb=()=>{if(this.gridView.K6a){const qa=this.$.da.za(254,!0);qa&&qa.xcj(this.pqb);this.gridView.K6a=
!1;this.gridView.Ff.dm(G.a.BQ);this.gridView.ha.kW(this.kcd);sb.g(this.$).$.$e()}};this.kcd=()=>{var qa=this.E$b;this.E$b=J.d(this.$.xa.oa);qa===this.E$b&&(this.gridView.ha.kW(this.kcd),(qa=this.$.da.za(254,!0))&&qa.h_c(36,sb.g(this.$).ha.sa.selectedRanges)?(qa=new Na.a(1804571062,2,2,0,null),this.$.Ka.Lb(qa,{[G.a.skipClipboardAccess]:!0,[G.a.M0c]:!0,[G.a.isFormatPainter]:!0}).continueWith(()=>{this.pqb()})):this.gridView.Ff.eH(!1))};this.xb=e.EwaSettings.xb();this.vlc=new gc(this.$,Ob);this.nD=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);this.Qm=e.EwaSettings.Qm();this.Bl=Wa.a.Bl()}get bif(){return t.a.all(this.gridView.ha.sa.selectedRanges,Ia=>Ia.isRow)}get Xhf(){return t.a.all(this.gridView.ha.sa.selectedRanges,Ia=>Ia.gf)}get themesManager(){this.ox||(this.ox=this.$.da.za(422));return this.ox}R0(Ia,jb){const Ob=this.$.da.za(465);Ob&&Ob.R0(Ia,jb)}hji(Ia){return 1896159024===Ia||-1554384558===Ia||-1113896058===Ia||1554436520===Ia||1415868706===Ia||674605324===Ia||1035996630===Ia}Lc(Ia,jb){return 2054778433===jb&&Ia&1?!na.a(this.$).Zhc:
600686207===jb?!1:this.hji(jb)&&t.a.any(this.gridView.ha.sa.selectedRanges,Ob=>Ob.gf||Ob.isRow)&&!this.bif&&!this.Xhf?!0:this.tic(Ia,jb)}executeCommand(Ia,jb,Ob){return this.Lb(jb,Ob)}Ac(Ia,jb,Ob){if(Ia=1===Ia)switch(jb.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Ia=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:Ia=
!!Ob;break;case 862825906:case 1532790410:case 46555851:case -1522760979:Ia=!0;break;default:Ia=!1}return Ia}Oc(Ia,jb,Ob){switch(jb){case "PopulateFontColor":Ob.MenuItems=this.FB.Dac(1970784898,-803000997,null,null,-128950598,2036397036,1688184685,862825906,Ob.MenuId);break;case "PopulateFillColor":Ob.MenuItems=this.FB.Dac(1650812936,null,87208751,2063445891,673562736,1457172838,-446735083,1532790410,Ob.MenuId);break;case "PopulateBorderColor":Ob.MenuItems=this.FB.Dac(-236759591,-1803452024,void 0,
void 0,void 0,void 0,void 0,46555851,Ob.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.P3h(Ob);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.Bl&&(this.fontDropdownHelper.Frj(Ob.MenuId),!this.fontDropdownHelper.fii()))return!1;Ob.MenuItems=this.fontDropdownHelper.LWe(-1293291468,324978188,-1428968098,Ob.MenuId);break;default:return!1}return!0}tic(Ia,jb){const Ob=sb.g(this.$).ha.sa.selectedRanges;return!(new K.a(this.$.xa)).um(Ia,jb,Ob,this.gridView)}Lb(Ia,
jb){var Ob=this.gridView;const Jb=Ia.command;var Kb=f.TaskExtensions.ak();let Qa=!0;switch(Jb){case -1077965542:Qa=this.J6e(jb,Ia,!1);break;case 909774670:this.Cpb(Jb);Qa=this.J6e(jb,Ia,!0);break;case -1293291468:Qa=this.H6e(jb,Ia,!1);break;case 324978188:this.Cpb(Jb);Qa=this.H6e(jb,Ia,!0);break;case 862890474:case 963349338:Qa=this.i3h(Ia);break;case -1832800737:Qa=this.jdc(Jb,jb,!1,Ia);break;case 1970784898:Qa=this.jdc(Jb,jb,!1,Ia);break;case -803000997:Qa=this.jdc(Jb,jb,!1,Ia);break;case -128950598:case 1688184685:this.Cpb(Jb);
Qa=this.jdc(Jb,jb,!0,Ia);break;case 1597684571:Qa=this.Xwb(Jb,jb,!1,Ia);break;case 87208751:jb.Color="-1";jb.IntColor=!0;Qa=this.Xwb(Jb,jb,!1,Ia);break;case -446735083:this.Cpb(Jb);jb.Color="-1";jb.IntColor=!0;Qa=this.Xwb(Jb,jb,!0,Ia);break;case 1650812936:Qa=this.Xwb(Jb,jb,!1,Ia);break;case 673562736:this.Cpb(Jb);Qa=this.Xwb(Jb,jb,!0,Ia);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:this.fVf(Jb);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Qa=
this.U2h(Jb,Ia);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Qa=this.f2h(Jb,Ia);break;case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:Qa=this.K3h(Jb,Ia);break;case -1803452024:case -236759591:Qa=this.Lid(Jb,jb,Ia);break;case -2118943501:Qa=this.borderFormatManager.n2h(jb,Ia);break;case 1012765228:Qa=this.borderFormatManager.d4h(jb,Ia);break;case 1256700402:Qa=this.borderFormatManager.Pid(Ia);
break;case -1756763834:Qa=this.borderFormatManager.Qid(Ia);break;case -1418159950:Qa=this.borderFormatManager.v6e(Ia);break;case -1920201820:case -1942512156:Qa=this.j3h(Jb,Ia);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Qa=this.borderFormatManager.h6e(jb,Ia);this.FAh(jb);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Qa=this.G3h(Jb,jb,Ia);break;case -693675336:case 322710748:break;case 1696566924:Qa=this.V2h(Ia);break;
case -167499203:case -255094134:case 1097660126:case 155820588:Kb=this.handleMergeCellsCommand(this.gridView,Ia);break;case 1896159024:case -1554384558:jb=this.gridView.ha.sa.selectedRanges;if(this.fyj(Ia,jb))u.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new xa(this.$,Jb,jb)).Ag(),Qa=!0;else if(t.a.any(jb,ha=>this.gridView.Fb.YMa(ha))){Ob="";Kb=1461300262;const ha=-1554384558===Jb&&this.gridView.Fb.qli(jb[0]);jb=jb[0].height>jb[0].width&&
!ha;switch(Jb){case 1896159024:Ob=jb?"InsertColumnsTable":"InsertRowsTable";Kb=jb?622604322:942362098;break;case -1554384558:Ob=jb?"DeleteColumnsTable":"DeleteRowsTable",Kb=jb?284490184:1405456548}jb=Z.a.pq(Ma.Dmd,Ob,1);new Na.a(Kb,1,2,6,null);Kb=this.insertOrDeleteCells(jb,Ia,!0)}else Kb=this.insertOrDeleteCells(1896159024===Jb?1:2,Ia,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Kb=this.insertOrDeleteCells(Z.a.pq(Ma.Dmd,jb[L.a.Qc],1),Ia,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Kb=
this.insertOrDeleteCells(Z.a.pq(Ma.Dmd,jb[L.a.Qc],1),Ia,!1);break;case 504848446:Kb=Ob.startEdit(!1,1,jb[G.a.event],void 0,void 0,!0);break;case 1504715724:if(sb.g(this.$).wz&&this.borderFormatManager.uU.qB)break;Kb=Ob.startEdit(!0,0,jb[G.a.event],void 0,void 0,!0);break;case 1872288872:this.pqb();break;case 41465729:Kb=this.fill(Ob.ha.sa.Xc,null,0,1,Ia);break;case -1451655532:case 1972143101:Kb=this.fillDownAbsoluteValueAndStartEdit(Ob,jb[G.a.event],-1451655532===Jb);break;case -475861485:Kb=this.fill(Ob.ha.sa.Xc,
null,Ob.rtl?1:2,1,Ia);break;case -978843926:Kb=this.fill(Ob.ha.sa.Xc,null,3,1,Ia);break;case 2098035706:Kb=this.fill(Ob.ha.sa.Xc,null,Ob.rtl?2:1,1,Ia);break;case -2142700828:Kb=this.fill(Ob.ha.sourceRange,Ob.ha.sa.Xc,Ma.b_e(Ob.ha.sa.Xc,Ob.ha.sourceRange),2,Ia);break;case 1405660955:Kb=this.fill(Ob.ha.sourceRange,Ob.ha.sa.Xc,Ma.b_e(Ob.ha.sa.Xc,Ob.ha.sourceRange),4,Ia);break;case 1983983164:Kb=this.fill(Ob.ha.sa.Xc,null,0,0,Ia);break;case 478842689:(Ia=this.$.da.za(376))?(Ia.E3i(),Qa=!0):u.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Qa=Ob.ha.Lb(null,Jb);break;case -208772570:this.B3h();Qa=!0;break;case -987339782:this.v2h();Qa=!0;break;case -1770246794:Ob.ha.w2h();Qa=!0;break;case 748067091:case -381232414:this.z2h(Jb);Qa=!0;break;case -1522760979:this.gridView.toggleFormulaView();Qa=!0;break;case 886009118:Kb=this.g3h();break;case 894341014:this.l3h();
Qa=!0;break;case 862825906:Kb=this.Z6e(1970784898,Ia);break;case 1532790410:Kb=this.Z6e(1650812936,Ia);break;case 46555851:Kb=this.x3h(Ia);break;default:Qa=!1}Qa||(Kb=Y.a(Jb));return Kb}FAh(Ia){Ia&&Ia.MenuItemId&&["OutsideBorders","AllBorders","ThickOutsideBorders"].includes(Ia.MenuItemId)&&e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&this.gQg(new Sa.a(this.gridView.ha.sa.activeRange,J.d(this.$.xa.oa)))}gQg(Ia){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,
426,427,1),jb=>{void jb.result.oYd(Ia,"BorderActions")},this.$.la,3)}fyj(Ia,jb){const Ob=t.a.all(jb,Qa=>!this.gridView.Fb.YMa(Qa)),Jb=1<jb.length&&!!this.gridView.Fb.yhd(jb),Kb=t.a.all(jb,Qa=>!this.gridView.Fb.e5(Qa));jb=!t.a.any(jb,Qa=>Qa.isRow||Qa.gf);return 1===Ia.method&&6===Ia.Re&&(Ob||Jb)&&Kb&&jb}fillDownAbsoluteValueAndStartEdit(Ia,jb,Ob){const Jb=Ia.ha.sa.activeCell,Kb=Q.E(Jb,this.gridView.Ts);return Ia.startEdit(!0,0,jb).fp(()=>{const Qa=Ia.Vb(Kb),ha=Ia.Vb(Jb);if(!Qa||!ha)return u.ULS.shipAssertTag(537159507,
0,!1,`GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: ${Jb.toString()} and above cell: ${Kb.toString()}`),oa.Task.Ta(!1);this.gridView.Xb.text=Ob?Qa.U0:Qa.text;this.gridView.Xb.textBox.setCaretPositionToEnd();return oa.Task.Ta(!0)})}insertOrDeleteCells(Ia,jb,Ob){const Jb=w.a.create().toString();var Kb=Enum.toString(T,Ia);this.gridView.Pi.A7(17,Jb,Kb);Kb=this.gridView.ha.sa.selectedRanges;var Qa=this.bif,ha=this.Xhf;if(!this.$.Sp(null,!1,void 0,jb.Re)&&!ha&&!Qa&&
5!==Ia&&9!==Ia)return oa.Task.Ta(!0);2===Ia?Ia=ha?10:Qa?6:Kb[0].height>Kb[0].width?18:34:1===Ia?Ia=ha?9:Qa?5:Kb[0].height>Kb[0].width?17:33:18===Ia&&Qa?Ia=34:34===Ia&&ha&&(Ia=18);Kb=this.IJg(Kb,Ia);if((10===Ia||6===Ia)&&!this.$.Sp(Kb,!0,1,jb.Re))return oa.Task.Ta(!0);const qa={};qa.InsertDeleteRangeItems=Array(Kb.length);qa.SheetName=this.$.oa.sheetName;qa.IsTableCommand=Ob;for(Ob=0;Ob<Kb.length;Ob++){Qa=Kb[Ob];ha={};let Fa,tb;Ia&4?(ha.FirstRow=Qa.top-1,ha.LastRow=X.a.Gz,ha.FirstColumn=0,ha.LastColumn=
X.a.Aw,Fa=Qa.bottom-Qa.top+1,tb=0,6===Ia?(Qa.gf||(ha.FirstRow=Qa.bottom),Fa=-Fa):yb.b("InsertRowsAbove"),37===Ia&&(ha.FirstRow=Qa.bottom,yb.b("InsertRowsBelow"))):Ia&8?(ha.FirstRow=0,ha.LastRow=X.a.Gz,ha.FirstColumn=Qa.left-1,ha.LastColumn=X.a.Aw,Fa=0,tb=Qa.right-Qa.left+1,10===Ia&&(Qa.isRow||(ha.FirstColumn=Qa.right),tb=-tb)):Ia&16?(ha.FirstRow=Qa.top-1,ha.LastRow=Qa.bottom-1,ha.FirstColumn=Qa.left-1,ha.LastColumn=X.a.Aw,Fa=0,tb=Qa.right-Qa.left+1,18===Ia&&(ha.FirstColumn=Qa.right,tb=-tb)):(ha.FirstRow=
Qa.top-1,ha.LastRow=X.a.Gz,ha.FirstColumn=Qa.left-1,ha.LastColumn=Qa.right-1,Fa=Qa.bottom-Qa.top+1,tb=0,34===Ia&&(ha.FirstRow=Qa.bottom,Fa=-Fa));const dc={};dc.InsertDeleteRange=ha;dc.DeltaRow=Fa;dc.DeltaColumn=tb;dc.AdjustedSelectedRange=Q.j(Qa);qa.InsertDeleteRangeItems[Ob]=dc}this.gridView.Ff.eH(!1);const pb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");qa.IsDecoupleRecalc=pb;const bb=this.$.pa.va.Tb(),eb=()=>new H(qa);return V.a(this.$.userOperationManager,
(Fa,tb,dc)=>{pb&&!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||this.$.Ay();return gb(this.$.pa.va,qa,ca.b(Fa,(jc,fb)=>{this.tNi(jc,fb,Ia)}),tb,dc,Jb,bb)},Fa=>new W.a(237,0,Fa,void 0,eb),jb)}IJg(Ia,jb){return jb&32?this.xZa(Ia,Ob=>Ob.bottom,Ob=>Ob.top,(Ob,Jb)=>{Ob.bottom=Jb},!1,!0):jb&16?this.gridView.rtl?this.xZa(Ia,Ob=>Ob.left,Ob=>Ob.right,(Ob,Jb)=>{Ob.left=Jb},!1,!1):this.xZa(Ia,Ob=>Ob.right,Ob=>Ob.left,(Ob,Jb)=>{Ob.right=Jb},!1,!1):jb&4?this.xZa(Ia,Ob=>Ob.bottom,Ob=>
Ob.top,(Ob,Jb)=>{Ob.bottom=Jb},!0,!0):jb&8?this.gridView.rtl?this.xZa(Ia,Ob=>Ob.left,Ob=>Ob.right,(Ob,Jb)=>{Ob.left=Jb},!0,!1):this.xZa(Ia,Ob=>Ob.right,Ob=>Ob.left,(Ob,Jb)=>{Ob.right=Jb},!0,!1):Ia}xZa(Ia,jb,Ob,Jb,Kb,Qa){Ia=Q.d(Ia);Ia.sort((ha,qa)=>jb(qa)-jb(ha));if(Kb){Kb=[];Qa=Qa?X.a.eh+1:X.a.ph+1;for(let ha=0;ha<Ia.length;ha++){const qa=Ia[ha];Ob(qa)<Qa&&(Jb(qa,Math.min(jb(qa),Qa-1)),Kb.push(qa),Qa=Ob(qa))}Ia=Kb}return Ia}fill(Ia,jb,Ob,Jb,Kb){const Qa=this.$;if(!Qa.Sp([jb],!0))return oa.Task.Ta(!0);
const ha=Q.v(Ia,Qa),qa=jb?Q.v(jb,Qa):ha,pb=this.$.pa.va.Tb(),bb=()=>new va(ha,qa,Jb,Ob);return V.a(this.$.userOperationManager,(eb,Fa,tb)=>{this.$.Ay();var dc=this.$.pa.va;eb=ca.b(eb,this.eKi);const jc=dc.Na(9,pb);jc.sourceRange=ha;jc.targetRange=qa;jc.fillDirection=Ob;jc.fillType=Jb;return da.g(dc,"FillRange",jc,eb,Fa,tb,null,0)},eb=>new W.a(155,0,eb,void 0,bb),Kb)}G3h(Ia,jb,Ob){const Jb={ValidMembers:32};switch(Ia){case 1890566896:Ia=parseInt(jb[L.a.Qc].toString(),10);if(14===Ia)return Ob=new Na.a(2105621672,
Ob.method,Ob.mode,Ob.Re,Ob.tabName),jb[L.a.Qc]=null,this.$.Ka.Lb(Ob,jb),u.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;Jb.NumberFormat=Ia;break;case 1886928607:Jb.NumberFormat=13;break;case -992833457:Jb.NumberFormat=11;break;case 218524921:Jb.NumberFormat=12;break;case 996232352:Jb.NumberFormat=1006;break;default:return u.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+Va.b().ij(Ob.command)),
!1}u.ULS.sendTraceTag(537159504,0,50,`GridCommandHandler.HandleNumberFormatCommand: triggered ${Va.b().ij(Ob.command)} command, with menu item ${jb[L.a.Qc]}.`);this.xg.formatCells(1890566896,Jb,Ob);this.$.$e();return!0}i3h(Ia){var jb=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(this.xb&&this.gridView.eb){jb=this.gridView.Li.q4a(jb?ra.a(jb).Font:null);if(!jb)return u.ULS.shipAssertTag(537159503,0,!1,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range ${this.gridView.ha.sa.activeCell.toString()} is null while editing`),
!1;var Ob=jb.FontSize}else if(jb)Ob=jb.fontSize;else return!1;jb=Ia.command;let Jb=0;if(862890474===jb)for(;Jb<Ma.SJa.length-1&&Ma.SJa[Jb]<=Ob;)Jb++;else if(963349338===jb)for(Jb=Ma.SJa.length-1;0<Jb&&Ma.SJa[Jb]>=Ob;)Jb--;u.ULS.sendTraceTag(537159501,0,50,`GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size ${Ob} to size ${Ma.SJa[Jb]}`);if(Ob===Ma.SJa[Jb])return!0;Ob=Ma.vwc(2);Ob.Font.FontSize=Ma.SJa[Jb];this.xb&&this.gridView.eb?(this.fob(Ia,!1,Ob),this.$.$e()):this.xg.formatCells(jb,
Ob,Ia);return!0}J6e(Ia,jb,Ob){Ia=Ia[Ia[r.a.IsFreeForm]?r.a.Value:L.a.kg].toString();if(!Ma.ZZi.test(Ia))return u.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not a number."),e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;Ia=parseFloat(Ia);if(8>Ia||72<Ia)return u.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command is not within expected limits (8 - 72)."),
e.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;const Jb=Math.round(2*Ia)/2,Kb=Ma.vwc(2);Kb.Font.FontSize=Jb;this.xb&&this.gridView.eb?(this.fob(jb,Ob,Kb,!0),Jb===Ia||Ob||this.$.$e()):Ob?this.xg.Vda(this.gridView,-1077965542,Kb,Ob):(this.xg.formatCells(-1077965542,Kb,jb),this.s0a());return!0}H6e(Ia,jb,Ob){var Jb=Ia[L.a.kg];if(this.Bl){var Kb=this.fontDropdownHelper.Qzc?this.fontDropdownHelper.Qzc[Jb]:null;Kb||(u.ULS.sendTraceTag(523903201,1,15,
`GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for ${Jb}`),Kb=ea.HelperMethods.yO[Jb])}else Kb=ea.HelperMethods.yO[Jb];let Qa=0;this.Qm&&(Ia=Ia.MenuItemId,Ia===Oa.b?(Jb==this.themesManager.AL.Wrf&&(Kb=Jb),Qa=2):Ia===Oa.a&&(Jb==this.themesManager.AL.nqf&&(Kb=Jb),Qa=1));if(!Kb)return!0;Jb=Ma.vwc(1);Jb.Font.FontName=Kb;this.Qm&&(Jb.Font.FontScheme=Qa);this.xb&&this.gridView.eb?(this.fob(jb,Ob,Jb),this.$.$e()):Ob?this.xg.Vda(this.gridView,-1293291468,Jb,Ob):
(this.xg.formatCells(-1293291468,Jb,jb),this.s0a());return!0}jdc(Ia,jb,Ob,Jb){let Kb=-803000997===Ia||1688184685===Ia?"black":jb.Color;this.moreColorsHelper&&(-1832800737===Ia?Kb=ja.a.compare(Kb,"WindowText",!0)?this.moreColorsHelper.nbb:"black":Ob||(this.moreColorsHelper.nbb=Kb,this.moreColorsHelper.ada(jb,Kb,Jb)));Ia=Ma.vwc(32);Ia.Font.FontColor=pa.a.uH(Kb,Z.a.rg(jb,"IntColor"));this.xb&&this.gridView.eb?this.fob(Jb,Ob,Ia,17===Jb.Re):Ob?this.xg.Vda(this.gridView,1970784898,Ia,Ob):(this.nD&&({themeColor:jb}=
this.getThemeColor(jb)).returnValue&&(Ia.Font.ThemeFontColor=jb,Ia.Font.ColorTypeOption=1),this.xg.formatCells(1970784898,Ia,Jb),this.s0a());return!0}z2h(Ia){var jb=(new Date).format(748067091===Ia?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat);const Ob=this.gridView.tm?P.a(this.gridView.$):this.gridView.Xb;Ia=Ob.textBox;this.gridView.eb?Ob.insertText(jb):(this.gridView.startEdit(!0,0),Ob.text=jb,jb=jb.length,Ia.bdb(jb),Ia.caretPosition=jb)}B3h(){this.gridView.wK(this.gridView.ha.sa.activeCell)||
this.gridView.Mvc||this.gridView.UMa()||this.gridView.tt(this.gridView.ha.sa.activeCell,3,Ca.a.O5e)}v2h(){if(!(this.gridView.Mvc||this.gridView.UMa()||this.gridView.eb&&v.a.isMac)){const Ia=this.gridView.ha.sa.b4;this.gridView.yg(Q.v(Ia,this.$),Ia,null,null,60,Ca.a.O5e)}}V2h(Ia){this.E$b=J.d(this.$.xa.oa);const jb=this.$.da.za(254,!0);if(this.gridView.K6a)return this.gridView.Ff.eH(!1),!!jb;if(!jb)return u.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),
!1;this.gridView.ha.cY(this.kcd);const Ob=String.format(G.a.Eta,ka.a.current.Zn(109));this.gridView.Ff.dm(Ob);Ia=new Na.a(-911352779,Ia.method,Ia.mode,Ia.Re,Ia.tabName);this.$.Ka.Lb(Ia,{[G.a.silentClipboardAccessFailures]:!0,[G.a.isFormatPainter]:!0}).continueWith(Jb=>{(6>Jb.status||6===Jb.status&&!Jb.result)&&this.pqb()});this.gridView.K6a=!0;jb.GHg(this.pqb);return!0}Xwb(Ia,jb,Ob,Jb){let Kb=87208751===Ia?"-1":jb.Color;this.moreColorsHelper&&(1597684571===Ia?Kb=this.moreColorsHelper.zQa:Ob||(this.moreColorsHelper.zQa=
Kb===Ma.notSet?Ma.hYd:Kb,this.moreColorsHelper.ada(jb,Kb,Jb)));Ia={ValidMembers:64};Ia.FillColor=pa.a.uH(Kb,Z.a.rg(jb,"IntColor"));Ob?this.xg.Vda(this.gridView,1650812936,Ia,!0):(this.nD&&({themeColor:jb}=this.getThemeColor(jb)).returnValue&&(Ia.ThemeFillColor=jb,Ia.ColorTypeOption=1),this.xg.formatCells(1650812936,Ia,Jb),this.s0a());return!0}l3h(){u.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");const Ia=this.$.da.za(221);if(Ia){var jb=
this.gridView.Li;if(jb){var Ob,Jb,Kb=({htf:Ob,EUe:Jb}=Ia.oci(jb.text,jb.textBox.caretPosition)).returnValue;Kb?(Ia.se=!1,jb.text=Kb,jb.textBox.selectRange(Ob,Ob+Jb),u.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):u.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else u.ULS.shipAssertTag(537159491,0,!1,
"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else u.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")}U2h(Ia,jb){let Ob=0;const Jb=this.gridView,Kb=ra.a(Jb.Vb(null));this.xb&&Jb.eb&&(Kb.Font=Jb.Li.q4a(Kb.Font));let Qa=Kb.Font;Qa||(Qa={ValidMembers:0});switch(Ia){case -287251124:Ob|=4;Ba.e(Qa,4)?Qa.Bold=!Qa.Bold:Qa.Bold=!0;break;case -1925065947:Ob|=8;Ba.e(Qa,8)?Qa.Italic=!Qa.Italic:Qa.Italic=!0;
break;case 1764140053:Ob|=16;Ba.e(Qa,16)?Qa.Underline=!Qa.Underline:Qa.Underline=!0;break;case -1685033574:Ob|=64;Ba.e(Qa,64)?Qa.DoubleUnderline=!Qa.DoubleUnderline:Qa.DoubleUnderline=!0;break;case -1590502662:Ob|=128,Ba.e(Qa,128)?Qa.Strikethrough=!Qa.Strikethrough:Qa.Strikethrough=!0}if(!Ob)return!1;Qa.ValidMembers=Ob;Kb.Font=Qa;Kb.ValidMembers=16;this.xb&&this.gridView.eb?this.fob(jb,!1,Kb):(e.EwaSettings.ma(651)||Jb.Ff.eH(!1),this.xg.formatCells(Ia,Kb,jb));this.$.$e();return!0}f2h(Ia,jb){let Ob=
0;const Jb=this.gridView,Kb=ra.a(Jb.Vb(null));-571165336===Ia||1041132226===Ia||-394785302===Ia?(Ob|=1,Kb.VerticalAlignment=Z.a.pq(Ma.GZa,Ia.toString(),2)):Ma.Sii(Ia)?(Ob|=2,this.d3h(Kb,Ia)):-1116189897===Ia&&(Ob|=8,Kb.Wrap=Kb.ValidMembers&8?!Kb.Wrap:!0);if(!Ob)return!1;Kb.ValidMembers=Ob;e.EwaSettings.ma(651)||Jb.Ff.eH(!1);this.xg.formatCells(Ia,Kb,jb);this.$.$e();return!0}d3h(Ia,jb){!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&
-1142465846!==jb&&(jb=-1150205178===jb?-286432209:-1150205178);jb=Z.a.pq(Ma.GZa,jb.toString(),0);Ia.HorizontalAlignment=jb===Ia.HorizontalAlignment?0:jb}YKf(Ia,jb,Ob,Jb){let Kb=!1;e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(Kb=this.vlc.yrf(jb,Ob))&&sb.g(this.$).Pi.D0(this.k9a,Xb.BasicTelemetryCalculator.NQ);return this.ptb(Ia,jb,!1,Kb,Qa=>{this.COi(Qa,Ob,jb,Kb,Jb)})}handleMergeCellsCommand(Ia,jb){this.k9a=w.a.create().toString();let Ob=null;Ob=this.vlc.S0e();
var Jb=D.a(jb.command);const Kb=this.vlc.Ogi(jb.command,Ob);let Qa=0;Kb?Qa=y.a.Ud():sb.g(this.$).Pi.A7(4,this.k9a,Jb+", Scenario = "+Ob.scenario.toString());Jb=Ia.ha.sa.selectedRanges;u.ULS.sendTraceTag(537159459,0,50,`GridCommandHandler.HandleMergeCellsCommand: Merge Command: ${Va.b().ij(jb.command)}, Number of ranges: ${Jb.length}, Ranges: ${Q.i(Jb,",",this.$,!1)}`);Jb=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);Ia.Ff.eH(!1,Jb);if(10===Z.a.pq(Ma.Arf,
jb.command.toString(),10))return oa.Task.Ta(!1);const ha=e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Jb&&ha)return Kb?(this.A4f(Ob,jb,!0,!0,Qa),oa.Task.Ta(!0)):this.YKf(Ia,jb,Ob,!1);let qa=!1;Jb&&(qa=this.vlc.yrf(jb,Ob))&&sb.g(this.$).Pi.D0(this.k9a,Xb.BasicTelemetryCalculator.NQ);return this.ptb(Ia,jb,!1,qa,pb=>{this.DOi(pb,jb,qa)})}ptb(Ia,jb,Ob,Jb,Kb=null){const Qa=this.$.pa.va.Tb(),ha=Z.a.pq(Ma.Arf,jb.command.toString(),10),qa=Q.r(Ia.ha.sa.selectedRanges,
Ia.$),pb=()=>new R.a(ha,qa),bb=eb=>{const Fa=!!eb&&!!eb.RequestTelemetryData;sb.g(this.$).Pi.vla(this.k9a,eb.StateId,Fa?eb.RequestTelemetryData.EcsOperationDuration:0,Fa?eb.RequestTelemetryData.EcsRequestDuration:0,Fa?eb.RequestTelemetryData.WfeRequestDuration:0)};Ia=(eb,Fa,tb)=>{this.$.Ay();eb=Kb?ca.b(eb,Kb):eb;eb=ca.b(eb,bb);return da.d(this.$.pa.va,ha,qa,Ob,eb,Fa,tb,null,Qa)};return Jb?e.EwaSettings.$b()?V.a(this.$.userOperationManager,Ia,eb=>new W.a(156,0,eb,64,pb),jb):V.a(this.$.userOperationManager,
Ia,eb=>new O.a(156,0,eb,void 0,pb),jb):V.a(this.$.userOperationManager,Ia,eb=>new W.a(156,0,eb,void 0,pb),jb)}A4f(Ia,jb,Ob,Jb=!1,Kb=0){u.ULS.sendTraceTag(537159457,0,50,`Merge cells with multiple values. isCalledBeforeCSE :- ${Ob}`);var Qa=sb.g(this.$).rtl;Qa=Ra.a.Yc(3,2,0,Qa?640:639,0,514846606,"MergeCellsLoseData");f.TaskExtensions.Aa(ma.a(this.$).uj(Qa),ha=>{ha=ha.result;if(Jb){const qa=y.a.Ud()-Kb;u.ULS.sendTraceTag(528779355,0,50,`Time taken to show Dialog in Data Loss Scenario is : ${qa}, and the user action is : ${ha}`)}0===
ha?(u.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),Ob?(Jb&&(ha=D.a(jb.command),sb.g(this.$).Pi.A7(4,this.k9a,ha+", Scenario = "+Ia.scenario.toString())),this.YKf(sb.g(this.$),jb,Ia,!0)):this.ptb(this.gridView,jb,!0,!1)):1===ha&&u.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11)}Jui(Ia,jb,Ob,Jb){jb!==Ia&&u.ULS.sendTraceTag(537159454,0,15,`MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- ${jb} and as per server is ${Ia}. The scenario is:- ${Ob}, The CSE is done:- ${Jb}`)}DOi(Ia,
jb,Ob){Da.b(Ia,514846606)&&(u.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),db.a(this.$).kd.gM(514846606),Ia=sb.g(this.$).rtl,Ia=Ra.a.Yc(3,2,0,Ia?640:639,0,514846606,"MergeCellsLoseData"),f.TaskExtensions.Aa(ma.a(this.$).uj(Ia),Jb=>{Jb=Jb.result;0===Jb?(u.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.ptb(this.gridView,jb,!0,Ob)):1===Jb&&u.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))}COi(Ia,jb,Ob,
Jb,Kb){let Qa=!1;Da.b(Ia,514846606)&&(Qa=!0,db.a(this.$).kd.gM(514846606),Jb&&Kb?window.setTimeout(()=>{this.ptb(this.gridView,Ob,!0,!0)},0):this.A4f(jb,Ob,!1));this.Jui(Qa,Kb,jb.scenario,Jb)}Cpb(Ia){if(this.T_a!==Ia&&1461300262!==this.T_a){this.fVf(this.T_a);var jb=Va.b().ij(Ia);const Ob=Va.b().ij(this.T_a);u.ULS.sendTraceTag(537159450,0,50,`GridCommandHandler.CacheFontStyles: Style cached during ${Ob} was restored before caching the style for ${jb} command.`)}this.T_a=Ia;if(this.xb&&this.gridView.eb)this.Q_a||
(this.Q_a=this.gridView.Li.li);else if(!this.zC){this.zC=[];jb=this.gridView.J$("GridCommandHandler.CacheFontStyles",this.gridView.ha.sa.selectedRanges);try{for(jb.$$rst();jb.$$mn();){const Ob=jb.$$cu();if(Ob.cell.hasRichText)this.zC.push(ba.zSg(Ob,Ob.cell.li));else switch(Ia){case 673562736:case -446735083:this.zC.push(ba.tZc(Ob,Ob.backgroundColor));break;case -128950598:case 1688184685:this.zC.push(ba.tZc(Ob,Ob.color));break;case 909774670:this.zC.push(ba.ASg(Ob,Ob.fontSize));break;case 324978188:this.Qm?
this.zC.push(ba.ySg(Ob,Ob.fontName,Ob.aZ)):this.zC.push(ba.tZc(Ob,Ob.fontName))}}}finally{jb&&jb.dispose()}}}yCj(){return this.xb&&this.gridView.eb?!this.Q_a:!this.zC}Ffi(Ia){return!!this.zC&&this.zC.length>Ia&&!!this.zC[Ia].li}Idd(Ia){return this.zC[Ia].style}uKh(Ia){return this.zC[Ia].size}tKh(Ia){return this.zC[Ia].aZ}fVf(Ia){if(!this.yCj()){if(this.xb&&this.gridView.eb)this.Q_a&&(this.gridView.Xb.li=this.Q_a);else{const Ob=this.zC.length;for(let Jb=0;Jb<Ob;Jb++){let Kb;var jb=this.zC[Jb].bja.cell.getRange();
Kb=this.gridView.Vb(jb);if(!Kb){u.ULS.sendTraceTag(537159441,0,50,`GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: ${jb.pz(!1)}`);continue}let Qa;jb=Kb.QH?this.gridView.JKb(Kb.range):(Qa=new U.a,Qa.add(Kb),Qa);for(let ha of jb)if(ha.cell.hasRichText&&1457172838!==Ia)this.Ffi(Jb)&&(ha.cell.li=this.zC[Jb].li);else switch(Ia){case 1457172838:ha.backgroundColor=this.Idd(Jb);break;case 2036397036:ha.color=this.Idd(Jb);break;case -1904244080:ha.fontSize=this.uKh(Jb);
break;case -1428968098:ha.fontName=this.Idd(Jb),this.Qm&&ha.b0f(this.tKh(Jb))}}}this.T_a=1461300262;this.s0a()}}s0a(){this.xb&&this.gridView.eb?this.Q_a=null:this.zC=null}j3h(Ia,jb){const Ob={IndentationIncrease:0};if(-1942512156===Ia)Ob.IndentationIncrease=1;else if(-1920201820===Ia)Ob.IndentationIncrease=-1;else return!0;Ob.ValidMembers=256;this.xg.formatCells(Ia,Ob,jb);return!0}K3h(Ia,jb){var Ob=Ia;!sb.g(this.$).rtl||-1649235364!==Ia&&524773427!==Ia||(Ob=-1649235364===Ia?524773427:-1649235364);
switch(Ob){case -1649235364:Ob=X.a.rotateTextUp45;break;case 524773427:Ob=X.a.Nuc;break;case 1886217042:Ob=X.a.rotateTextUp90;break;case 928057943:Ob=X.a.Puc;break;case -1526602249:Ob=X.a.verticalText;break;default:return!1}const Jb={ValidMembers:512};Jb.TextOrientation=Ob;this.xg.formatCells(Ia,Jb,jb);return!0}g3h(){const Ia=sb.g(this.$),jb=Q.r(Ia.ha.sa.selectedRanges,this.$),Ob=Q.o(Ia.ha.sa.activeCell,this.$);u.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");
return V.a(this.$.userOperationManager,(Jb,Kb,Qa)=>ta.p(this.$.pa.va,Ob,jb,Jb,Kb,Qa,null),Jb=>new W.a(201,0,Jb),null)}Z6e(Ia,jb){let Ob=null;var Jb=sb.g(this.$).ha.sa.selectedRanges;Jb=this.gridView.J$("MoreColors",Jb,1,!0);try{for(Jb.$$rst();Jb.$$mn();){const Kb=Jb.$$cu().cell;if(!Kb)continue;let Qa=Ma.black;if(1970784898===Ia)Qa=Kb.color;else if(1650812936===Ia){const ha=Kb.backgroundColor;Qa=ja.a.compare(ha,Ma.hYd,!0)&&ja.a.compare(ha,Ma.empty,!0)?Kb.backgroundColor:Ma.white}if(!Ob)Ob=Qa;else if(Ob!==
Qa){Ob=Ma.black;break}}}finally{Jb&&Jb.dispose()}this.xb&&this.gridView.eb&&1970784898===Ia&&this.gridView.Li.textBox.eve();return this.moreColorsHelper.ZBb(Ia,jb,Ob)}x3h(Ia){const jb=x.a.J4a(this.borderFormatManager.m3);return this.moreColorsHelper.ZBb(-236759591,Ia,jb)}fob(Ia,jb,Ob,Jb=!1){jb?this.gridView.Li.dKf(Ob.Font):(this.Uwi(Ia),Jb?window.requestAnimationFrame(()=>{B.FocusManager.instance().Zj(z.AFrame.U$);this.gridView.Li.LVe(Ob.Font)}):(B.FocusManager.instance().Zj(z.AFrame.U$),this.gridView.Li.LVe(Ob.Font)),
this.s0a())}Uwi(Ia){const jb=D.a(Ia.command);Ia=A.a[Ia.Re]+"_"+I.a[Ia.method];const Ob=this.gridView.hc.Aye.toString(),Jb=new Map;Jb.set("Command",jb);Jb.set("Source",Ia);Jb.set("Ribbon","React");Jb.set("CellTextRuns",Ob);F.Health.instance.recordKpiUsage(vb.a.VDh,0,hb.a.KVf,Jb)}Lid(Ia,jb,Ob){Ia=this.borderFormatManager.Lid(Ia,jb,Ob);this.moreColorsHelper&&this.moreColorsHelper.ada(jb,this.borderFormatManager.m3,Ob);return Ia}getThemeColor(Ia){let jb;jb={};let Ob=!1;if((Ia.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return u.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:jb};let Jb;({themeIndex:Ia,yBa:Jb,returnValue:Ob}=this.themesManager.getThemeColor(Ia.Color));Ob&&(jb.ThemeColorIndex=Ia,jb.ThemeColorRow=Jb)}return{returnValue:Ob,themeColor:jb}}static get ZZi(){return Ma.bfe||(Ma.bfe=RegExp("^[0-9]+[.]?[0-9]*$"))}static get Dmd(){return Ma.G9d||(Ma.G9d={["InsertRows"]:5,["InsertColumns"]:9,["InsertCellsShiftRight"]:17,["InsertCellsShiftDown"]:33,["DeleteRows"]:6,["DeleteColumns"]:10,
["DeleteCellsShiftLeft"]:18,["DeleteCellsShiftUp"]:34,["DeleteRowsTable"]:6,["DeleteColumnsTable"]:10,["InsertRowsTable"]:5,["InsertColumnsTable"]:9,["InsertRowsBelow"]:37})}static get GZa(){return Ma.Dgb||(Ma.Dgb={["-394785302"]:0,["-571165336"]:2,["1041132226"]:1,["-1150205178"]:1,["-1142465846"]:2,["-286432209"]:3})}static get Arf(){return Ma.sce||(Ma.sce={["-167499203"]:2,["-255094134"]:5,["1097660126"]:6,["155820588"]:7})}static Sii(Ia){return-1150205178===Ia||-1142465846===Ia||-286432209===
Ia}static vwc(Ia){const jb={},Ob={};jb.ValidMembers=16;jb.Font=Ob;Ob.ValidMembers=Ia;return jb}static b_e(Ia,jb){let Ob;Ob=Ia.top<jb.top?3:Ia.bottom>jb.bottom?0:-1;return Ob=Ia.left<jb.left?1:Ia.right>jb.right?2:Ob}}Ma.hYd="transparent";Ma.notSet="-1";Ma.black="#000000";Ma.empty="";Ma.white="#FFFFFF";Ma.G9d=null;Ma.Dgb=null;Ma.sce=null;Ma.bfe=null;Ma.SJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(n.a)(Ma,"GridCommandHandler",null,[164]);class Bb extends m.a{constructor(Ia){super(Ia)}vd(){const Ia=
d.GetServiceTaskFactory.create(this.$.da,111,this.la,this.fb),jb=d.GetServiceTaskFactory.create(this.$.da,18,this.la,this.fb),Ob=d.GetServiceTaskFactory.create(this.$.da,397,this.la,this.fb),Jb=d.GetServiceTaskFactory.Sa(this.$.da,502,503,this.fb);if(e.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){const Kb=d.GetServiceTaskFactory.Sa(this.$.da,296,468,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([Ia,jb,Ob,Kb,Jb],this.la),()=>{this.$c([new Ma(this.$,sb.g(this.$),
jb.result,Ia.result,Kb.result,Ob.result,Jb.result)])},this.la,3)}else{const Kb=d.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([Ia,jb,Kb,Ob,Jb],this.la),()=>{this.$c([new Ma(this.$,sb.g(this.$),jb.result,Ia.result,new k.BorderFormatManager(this.$,jb.result,Kb.result),Ob.result,Jb.result)])},this.la,3)}}static ka(Ia){m.a.Od(80,new Bb(Ia))}}Object(n.a)(Bb,"GridCommandHandlerFactory",m.a,[]);a.d(C,"a",function(){return Nb});const Nb=()=>{c.a.Fa(Bb.ka);
c.a.Fa(l.ka)}},1174:function(n,C,a){n=a(0);var c=a(15),b=a(187),d=a(84),f=a(82),e=a(383),k=a(99),l=a(44);class m{constructor(){this.bda=this.eXe=null}}Object(n.a)(m,"GestureAdapterInfo",null,[]);var u=a(4),t=a(373),w=a(227);class r{constructor(){this.QHc=null}fti(){if(!this.QHc){var R="hammer.min.js";u.AFrameworkApplication.fa.wo("IsServerFlavorDebug")&&(R=u.AFrameworkApplication.fa.qa("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");R=u.AFrameworkApplication.lL(String.format("{0}",R),5);R=w.a.create(R,
null,null);t.a.yia(R);this.QHc=R.F8a}return this.QHc}static get instance(){r.Ma||(r.Ma=new r);return r.Ma}}r.Ma=null;Object(n.a)(r,"HammerJsDependencyLoader",null,[290]);var v=a(13);const y=(R,Q,O=null)=>{if(void 0===Q||null===Q)throw c.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");let V=null;switch(R){case v.a.pinch:V=new Hammer.Pinch(O);break;case v.a.pan:V=new Hammer.Pan(O)}V&&(V.manager=Q);return V};var x;(function(R){R[R.none=-1]="none";
R[R.pinch=0]="pinch";R[R.pan=1]="pan";R[R.swipe=2]="swipe"})(x||(x={}));Object(n.b)("GestureEvent",x);var B=a(76);class z extends B.a{constructor(R,Q,O,V,W,da,ta,K){super(R,O,V,da);this.ihb=Q;this.iga=ta;this.pX=K;this.Jqg=W}get shiftKey(){return this.iga}get ctrlKey(){return this.pX}get clientPoint(){return this.ihb}get fva(){return this.Jqg}static create(R,Q,O,V,W,da){if(O.rawEvent)if(da){var ta=O.rawEvent;ta=new Sys.UI.Point(ta.clientX,ta.clientY)}else ta=B.a.vvb(O);else ta=new Sys.UI.Point(O.clientX,
O.clientY);return new z(R,ta,Q,O,V,W,O.shiftKey,O.ctrlKey,da)}}Object(n.a)(z,"GestureEventArgs",B.a,[]);class A{constructor(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=
null}}Object(n.a)(A,"GestureManagerData",null,[]);class I{}I.Ykg=2;I.Zkg=4;I.$kg=8;I.blg=8;Object(n.a)(I,"HammerConstants",null,[]);var F=a(91),U=a(205),X=a(30),T=a(79);class G extends l.a{constructor(R,Q){super();this.nqa=e.a.KHh;this.oPc=!!window.PointerEvent;this.Jje=window.hasOwnProperty("ontouchstart");this.rWa=this.ukb=null;this.H8=!1;this.XS=new k.a;this.Pkb=new k.a;this.Kqg=new b.a;this.Ipa=null;this.wVa=this.GJc=this.B4d=this.zGc=this.iNc=this.ige=this.H4d=this.pmb=!1;this.Xjb=-1;this.curRecognizer=
this.element=this.handlers=this.session=this.WRc=null;this.Md=F.EventHandlerManager.instance;this.oPc?(c.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),this.ukb=Object(d.a)(this,this.Doc,"onPointerEvent"),this.rWa=v.a.MHh):this.Jje?(c.ULS.sendTraceTag(593893140,310,50,"Using touch events"),this.ukb=Object(d.a)(this,this.dza,"onTouchEvent"),this.rWa=v.a.touchEvents):(c.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),this.ukb=Object(d.a)(this,this.noc,"onMouseEvent"),this.rWa=v.a.LHh);
this.Ch=Q;this.lfa=R;u.AFrameworkApplication.fa&&(this.pmb=u.AFrameworkApplication.fa.qa("UsePointerCaptureIsEnabled"),this.H4d=u.AFrameworkApplication.fa.qa("ClearCacheOnPrimaryPointerIsEnabled"),this.ige=u.AFrameworkApplication.fa.qa("ResetHandledBeforeInputHandlerIsEnabled"),this.iNc=u.AFrameworkApplication.fa.qa("LogCoalescedEventsIsEnabled"),this.zGc=u.AFrameworkApplication.fa.qa("CheckExistenceOfGetCoalescedEventsIsEnabled"),this.B4d=u.AFrameworkApplication.fa.qa("CheckIfHammerExistsAfterDownloadIsEnabled"),
this.GJc=u.AFrameworkApplication.fa.qa("HammerJsPerformanceTimersIsEnabled"),this.wVa=this.pmb&&u.AFrameworkApplication.fa.qa("CancelDragFromGestureInputManagerIsEnabled")&&u.AFrameworkApplication.fa.qa("UseGestureInputManagerPointerCacheIsEnabled"))}aQh(){return this.oPc?0:this.Jje?1:2}rn(R){super.rn(R);this.Md.lka(this.rWa,R,0,this.ukb)}mm(R){super.mm(R);this.Md.yIa(R,this.rWa)}t8i(R,Q,O=null){u.AFrameworkApplication.ohc()?r.instance.fti().continueWith(V=>{this.gFj();if(V.Tf||V.Eh)c.ULS.sendTraceTag(591192778,
310,10,"Hammer did not download correctly: {0}",V.status);else{c.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",V.status);if(this.B4d){V=window.Hammer;if("undefined"===typeof V){c.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");this.zzc();return}if("undefined"===typeof V.inputHandler){c.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");this.zzc();return}}if(!R)throw this.zzc(),Error.argumentNull("source element can not be null");V=U.a.Gva(R,this.nqa);
if(void 0===V||null===V)V=new k.a,U.a.kdb(R,this.nqa,V),this.u8i(R);var W=null;V.lb(x[0])||(W=Object.assign(new m,{bda:y(x[0],this,null),eXe:Q}),V.add(x[0],W));if(void 0!==O&&null!==O)for(let da=0;da<O.length;da++)if(V.lb(x[O[da]])){const ta=V.na(x[O[da]]);W.bda.recognizeWith(ta.bda)}}this.zzc()}):c.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")}gFj(){this.GJc&&(this.Ch?this.WRc=this.Ch.Bc("Task","RegisterGestureAdapterAfterLoad"):c.ULS.sendTraceTag(590387074,
310,10,"_stopwatchBuilder is null"))}zzc(){this.GJc&&(this.WRc?this.WRc.stop():c.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))}u8i(R){this.Kqg.add(R);this.Md.lka(this.rWa,R,0,this.ukb)}recognize(R){var Q=Array(R.pointers.length);for(var O=0;O<R.pointers.length;O++)Q[O]=R.pointers[O].target;O=null;for(this.Ipa=this.qSh(Q);void 0!==this.Ipa&&null!==this.Ipa&&(O=U.a.Gva(this.Ipa,this.nqa),void 0===O||null===O);this.Ipa=this.Ipa.parentNode);if(void 0!==O&&
null!==O){this.curRecognizer&&this.curRecognizer.state===I.blg&&(this.curRecognizer=null);Q=O.keys;for(let V of Q){Q=O.na(V);void 0!==Q&&null!==Q&&void 0!==Q.bda&&null!==Q.bda&&(void 0===this.curRecognizer||null===this.curRecognizer||Q.bda===this.curRecognizer||Q.bda.canRecognizeWith(this.curRecognizer))&&Q.bda.recognize(R);const W=Q.bda.state;this.curRecognizer||I.Ykg!==W&&I.Zkg!==W&&I.$kg!==W||(this.curRecognizer=Q.bda)}}}emit(R,Q){if("hammer.input"!==R){this.H8=!1;Q=z.create(R,this.Ipa,Q.srcEvent,
Q,3,this.oPc);var O=U.a.Gva(this.Ipa,this.nqa);if(this.Tki(R))var V=0;else if(this.Iki(R))V=1;else if(this.Kni(R))V=2;else{c.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}({value:O}=O.Cc(x[V]));void 0!==O&&null!==O&&((O=O.eXe,O.Aii())?R.endsWith("start")?this.H8=O.RKi(Q):R.endsWith("end")?(O.PKi(Q),this.H8=!0):R.endsWith("cancel")?(O.OKi(Q),this.H8=!0):R.endsWith("move")&&(this.H8=O.QKi(Q)):c.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",
R))}}get(R){return Object(f.a)(Hammer.Recognizer,R)}qSh(R){if(1>R.length)return null;if(1===R.length)return R[0];var Q=R[0],O=!0;for(let V=1;V<R.length;V++){if(!R[V])return null;if(Q!==R[V]){O=!1;break}}if(O)return Q;Q=this.xXe(R[0]);O=0;for(const V of R){R=this.xXe(V);if(Q.na(Q.count-1)!==R.na(R.count-1))return null;for(let W=Q.count-2,da=R.count-2;W>=O&&0<=da;W--,da--)if(Q.na(W)!==R.na(da)){O=W+1;break}}return Q.na(O)}xXe(R){const Q=new b.a;for(;void 0!==R&&null!==R;R=R.parentNode)Q.add(R);return Q}j0e(R){switch(R){case v.a.Cf:case v.a.g$:return 1;
case v.a.Yf:case v.a.lha:return 2;case v.a.ue:case v.a.QGa:return 4;case v.a.aBc:case v.a.aZc:return 8}return 0}dza(R,Q,O){R=this.j0e(R);Q=this.$Qh(O);Hammer.inputHandler(this,R,Q);this.H8&&O.preventDefault();return this.H8}G7e(){return 1<this.XS.count}Y1b(){c.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.pmb)for(let R of this.XS)this.PQf(R.key);else this.XS=new k.a;this.session=null}nDg(R,Q,O){c.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
R);if(!this.Pkb.lb(R)){try{Q.setPointerCapture(R)}catch(V){c.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",V)}this.Pkb.add(R,Q)}this.XS.ia(R,O);this.wVa&&1<this.XS.count&&this.lfa&&!this.lfa.Rpb&&(this.lfa.Rpb=!0)}PQf(R){c.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",R);if(this.Pkb.lb(R)){try{this.Pkb.na(R).releasePointerCapture(R)}catch(Q){c.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",Q)}this.Pkb.remove(R)}else c.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",
R);this.XS.remove(R);this.wVa&&1>=this.XS.count&&this.lfa&&this.lfa.Rpb&&(this.lfa.Rpb=!1)}Doc(R,Q,O){var V=O.rawEvent.pointerType.toString();const W=O.rawEvent.pointerId.toString();if("touch"!==V)return!1;R=this.j0e(R);if(1!==R&&!this.XS.lb(W))return!1;this.H4d&&1===R&&O.rawEvent.isPrimary&&this.XS.count&&(c.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.Y1b());this.pmb?this.nDg(W,Q,O):this.XS.ia(W,O);this.iNc&&2===R&&(!this.zGc||this.zGc&&"function"===typeof O.rawEvent.getCoalescedEvents)&&
(Q=O.rawEvent.getCoalescedEvents())&&this.G7e()&&(this.Xjb=Math.max(this.Xjb,Q.length));this.ige&&(this.H8=!1);V=this.ZQh(this.XS,O,V);Hammer.inputHandler(this,R,V);if(4===R||8===R)this.pmb?this.PQf(W):this.XS.remove(W),this.XS.count||(this.session=null,this.iNc&&-1!==this.Xjb&&(c.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Xjb),this.Xjb=-1));this.H8&&O.preventDefault();return this.H8}noc(){return!1}$Qh(R){const Q=new A;var O=R.rawEvent;const V=O.touches;O=O.changedTouches;
Q.pointers=Array.clone(V);Q.pointers=Array.clone(0<V.length?V:O);Q.changedPointers=Array.clone(O);Q.srcEvent=R;Q.pointerType="touch";return Q}ZQh(R,Q,O){const V=new A;V.pointers=T.toArray(R.values);V.changedPointers=[Q];V.pointerType=O;V.srcEvent=Q;return V}Tki(R){return X.a.startsWith(R,v.a.pinch)}Iki(R){return X.a.startsWith(R,v.a.pan)}Kni(R){return X.a.startsWith(R,v.a.swipe)}}Object(n.a)(G,"GestureInputManager",l.a,[269,270]);var D=a(276),J=a(247);class L{constructor(){this.gb=null;this.hx=!1}get name(){return"Common.App.GestureInputManager"}Wh(R){R.register(G,
"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").wc().Fc(()=>new G(D.a.instance,u.AFrameworkApplication.ta.ZD));this.gb=R}init(){this.hx||(this.gb.resolve("Common.App.GestureManager.GestureInputManager"),this.hx=!0)}dispose(){}static main(){J.a.instance.Gi(new L)}}Object(n.a)(L,"GestureInputManagerPackage",null,[3,4]);a.d(C,"a",function(){return H});const H=()=>{Type.registerNamespace("Common.App.GestureManager");L.main()}},1175:function(n,C,a){function c({x:P,y:ka},
pa,Na=document){let Z=-1,Ra=null;void 0!==Na.caretPositionFromPoint?(P=Na.caretPositionFromPoint(P,ka),null!==P&&(Z=P.offset,Ra=P.offsetNode)):void 0!==Na.caretRangeFromPoint&&(P=Na.caretRangeFromPoint(P,ka),null!==P&&(Z=P.startOffset,Ra=P.startContainer));return null===Ra||-1===Z?(w.ULS.sendTraceTag(521446491,0,15,"getEditorCaretPositionFromPoint - failed to get relevant range"),-1):pa.contains(Ra)?b(pa,Ra,Z):(w.ULS.sendTraceTag(521446490,0,15,"getEditorCaretPositionFromPoint - relavant node not inside root"),
-1)}function b(P,ka,pa){if(P===ka)return pa;if(ka.textContent!==ka.parentElement.textContent)for(;null!==ka.previousSibling;)ka=ka.previousSibling,pa+=ka.textContent.length,"div"===ka.nodeName.toLowerCase()&&(pa+=1);return b(P,ka.parentElement,pa)}function d(P,ka){return P.text===ka.text&&P.start===ka.start&&P.length===ka.length}function f(P,ka,pa){if(P.has(ka))return P.get(ka);pa=pa();P.set(ka,pa);return pa}function e(P){return JSON.stringify({text:P.text,start:P.start,length:P.length})}var k=a(9);
n=a(0);var l=a(222),m=a(163),u=a(753),t=a(21),w=a(15),r=a(11),v=a(22),y=a(14),x=a(217),B=a(34);class z{constructor(P,ka,pa){this.$=P;this.UJa=ka;this.ariaLiveNotifier=pa;this.z$h();this.editBox=Object(t.g)(this.$).Xb}get zoomManager(){this.Xke||(this.Xke=Object(B.a)(this.$));return this.Xke}dispose(){this.hide()}show(P,ka,pa){P=Object.assign(Object.assign({},ka),{IM:P,e1d:pa});this.Kdb(P)&&(this.Ona(P)&&this.hide(),this.RC=P,this.Gy(),pa&&this.r7h())}hide(){if(this.RC){var P=this.RC.e1d;this.dhh();
P&&this.O$i();this.RC=void 0}}Kdb(P){var ka;(ka=!this.RC)||(ka=this.RC,ka=!(ka.IM===P.IM&&ka.kind===P.kind&&ka.text===P.text&&ka.start===P.start&&ka.length===P.length&&ka.e1d===P.e1d));return ka}Ona(P){var ka;if(ka=this.RC)ka=this.RC,ka=!(ka.IM===P.IM&&ka.start===P.start&&ka.length===P.length);return ka}r7h(){this.RC.IM.textBox.formatText(this.RC.start,this.RC.length,{background:"rgba(202,234,216,0.6)"})}O$i(){const P=this.RC.IM,ka=this.RC.start,pa=this.RC.length,Na=P.text;Na.length<ka+pa?w.ULS.shipAssertTag(521019917,
0,!1,`FormulaAssistanceValuePreviewControl.removeHighlight - unexpected editor state, ${Na.length}:${ka}:${pa}`):P.textBox.formatText(ka,pa,{background:!1})}Gy(){var P=this.RC.text;switch(this.RC.kind){case 1:case 2:P={isLoaded:!0,value:P};break;case 3:P={isLoaded:!1,value:null};break;default:return}this.hUj();this.UJa.renderValuePreview(this.Is,this.zOb,P);this.TXi(P)}dhh(){this.UJa.dismiss(this.Is)}z$h(){this.Is=document.createElement("div");this.zOb=document.createElement("div");this.zOb.style.position=
"absolute";this.zOb.style.visibility="hidden";this.$.domElement.appendChild(this.zOb)}hUj(){var P=this.RC.IM,ka=this.RC.start;const pa=this.RC.length,Na=v.a.contains(P.text.substring(ka,ka+pa),"\n",!0);P=excelOnline.utils.getBoundingRectForText(P.textBox.Se,ka,Na?ka:ka+pa,!1);ka=new x.a(this.zOb.style);ka.OB.left=this.Kyc(P.left);ka.OB.top=this.Kyc(P.top);ka.OB.width=this.Kyc(P.width);ka.OB.height=this.Kyc(P.height);ka.u2()}Kyc(P){var ka=this.RC.IM;ka=Object(u.b)(this.zoomManager)&&ka===this.editBox;
return r.HelperMethods.pc(ka?this.zoomManager.Ci(P):P)}TXi({isLoaded:P,value:ka}){P?this.ariaLiveNotifier.readText(String.format(y.a.instance.mb(179),ka)):this.ariaLiveNotifier.readText(y.a.instance.ga(870))}}Object(n.a)(z,"FormulaAssistanceValuePreviewControl",null,[10]);var A=a(113);class I{constructor(P){this.cache=P}clearCache(){this.cache=void 0}}Object(n.a)(I,"Cacheable",null,[]);class F extends I{constructor(P,ka){super();this.$=P;this.callbacks=ka;this.Dnc=(pa,Na)=>{const Z=this.gridView.Li;
if(!(0<(Z.eb?Z.textBox.selection:{index:0,length:0}).length))switch(Na.state){case 0:this.ABd(pa,Na.event);break;case 1:this.ZMi(pa);break;default:return w.ULS.shipAssertTag(521446489,0,!1,"FormulaAssistanceValuePreviewHandler.onHoverChange unxpected HoverState"),Na}};this.Cnc=(pa,Na)=>{const Z=Na.selection;Na={kind:U.Editor,text:Na.text,start:Z.index,length:Z.length};if(0<Z.length)this.onSelectionChange(pa,Na);else this.UDf(pa,Na)};this.gridView=Object(t.g)(this.$);this.editBox=this.gridView.hc;
this.formulaBar=Object(A.a)(this.$);this.Ij()}dispose(){this.mk()}trigger(){const P=this.gridView.Li,ka=P.textBox.selection;this.onSelectionChange(P,{kind:U.Shortcut,text:P.text,start:ka.index,length:ka.length})}Ij(){this.editBox.BVc(this.Dnc);this.formulaBar.BVc(this.Dnc);this.editBox.koe(this.Cnc);this.formulaBar.koe(this.Cnc)}mk(){this.editBox.qKd(this.Dnc);this.formulaBar.qKd(this.Dnc);this.editBox.yRf(this.Cnc);this.formulaBar.yRf(this.Cnc)}ABd(P,ka){ka=new Sys.UI.Point(ka.clientX,ka.clientY);
ka=c(ka,P.textBox.Se);if(-1!==ka)this.onSelectionChange(P,{kind:U.Hover,text:P.text,start:ka,length:0})}ZMi(P){this.UDf(P)}onSelectionChange(P,ka){this.bxj(ka)&&(this.cache=ka,this.callbacks.GCd(P,{index:ka.start,length:ka.length}))}UDf(P,ka){this.Ywj(ka)&&(this.clearCache(),this.callbacks.YOa(P))}bxj(P){return!this.cache||!d(this.cache,P)}Ywj(P){return this.cache&&P?this.cache.kind!==U.Shortcut||!d(this.cache,P):!0}}Object(n.a)(F,"FormulaAssistanceValuePreviewHandler",I,[10]);var U;(function(P){P[P.Shortcut=
0]="Shortcut";P[P.Hover=1]="Hover";P[P.Editor=2]="Editor"})(U||(U={}));Object(n.b)("TriggerKind",U);var X=a(43),T=a(61),G=a(33);class D{constructor(P,ka){this.$=P;this.pluginScheduler=ka;this.bcb=new L(e);this.sZf=new L(e);this.JRi=(pa,Na)=>Z=>{if(Object(u.c)(Z.Result))Na("No result");else if(Z=JSON.parse(Z.Result),Object(u.c)(Z))Na("Failed to deserialize");else if(1!==Object.keys(Z).length)Na("Invalid response");else{for(let Da in Z)var Ra=Z[Da];pa(Ra)}};this.IRi=pa=>()=>{pa("Request failed")};this.gridView=
Object(t.g)(this.$);if(this.Mub=G.a.hV(this.$))this.formulaAssistanceManager=P.da.za(464)}clearCache(){this.bcb.clear();this.sZf.clear()}request(P){return Object(m.a)(this,void 0,void 0,function*(){return f(this.bcb,P,()=>Object(m.a)(this,void 0,void 0,function*(){const {kind:ka,payload:pa}=yield this.pluginScheduler.getRequester().valuePreview(P,this.formulaAssistanceManager?this.formulaAssistanceManager.rab:0);if(0!==ka)return null;if(Object(u.c)(pa))return{kind:0};switch(pa.kind){case 0:return{kind:0};
case 1:case 2:return Object.assign({},pa);case 3:const Na={text:P.text,start:pa.start,length:pa.length};return this.bcb.has(Na)?yield this.bcb.get(Na):Object.assign(Object.assign({},pa),{kind:3,next:()=>this.Dfj(Na,P,pa.text)})}}))})}Dfj(P,ka,pa){return Object(m.a)(this,void 0,void 0,function*(){return f(this.sZf,P,()=>{const Na=new Promise(Z=>Object(m.a)(this,void 0,void 0,function*(){try{const Ra=yield this.rUh(pa);Z({kind:1,text:Ra,start:P.start,length:P.length})}catch(Ra){w.ULS.sendTraceTag(520495426,
1,50,`FormulaAssistanceValuePreviewRequester.requestFromServer: getPartialCalcResults failed, ${Ra}`),Z({kind:0})}}));Na.then(()=>{this.bcb.set(P,Na);this.bcb.set(ka,Na)}).catch(Z=>{w.ULS.sendTraceTag(520495425,1,15,`FormulaAssistanceValuePreviewRequester.requestFromServer: serverPromise failed, ${Z}`)});return Na})})}rUh(P){return Object(m.a)(this,void 0,void 0,function*(){return new Promise((ka,pa)=>{const Na={Formula:P,PartialFormula:P,SourceRange:Object(X.v)(this.gridView.ha.sa.activeCell,this.$)};
J(this.$.pa.va,Na,this.JRi(ka,pa),this.IRi(pa),null,null)})})}}Object(n.a)(D,"FormulaAssistanceValuePreviewRequester",null,[]);const J=(P,ka,pa,Na,Z,Ra,Da=null)=>{Da=P.Na(1,Da);Da.getPartialCalcResultsParameters=ka;return Object(T.g)(P,"GetPartialCalcResults",Da,pa,Na,Z,Ra,4)};class L{constructor(P){this.nXd=P;this.map=new Map}has(P){P=this.nXd(P);return this.map.has(P)}get(P){P=this.nXd(P);return this.map.get(P)}set(P,ka){P=this.nXd(P);this.map.set(P,ka);return this}clear(){this.map.clear()}}Object(n.a)(L,
"RequestMap",null,[]);class H{constructor(P,ka,pa,Na){this.$=P;this.GCd=(Z,Ra)=>Object(m.a)(this,void 0,void 0,function*(){const Da={text:Z.text,start:Ra.index,length:Ra.length};void this.aLf(Da,this.requester.request.bind(this.requester),Z,0===Da.length)});this.YOa=()=>{this.hide()};this.reset=()=>{this.handler.clearCache();this.requester.clearCache();this.hide()};this.oy=()=>{this.handler.clearCache();this.requester.clearCache()};this.gridView=Object(t.g)(this.$);this.control=new z(this.$,pa,Na);
this.requester=new D(this.$,ka);this.handler=new F(this.$,{GCd:this.GCd,YOa:this.YOa});this.Ij()}trigger(){this.handler.trigger()}dispose(){this.mk();this.handler.dispose();this.control.dispose()}Ij(){this.gridView.Xb.lm(this.reset);this.gridView.ha.Lga(this.reset);this.$.ea.xE(this.oy)}mk(){this.gridView.Xb.Fl(this.reset);this.gridView.ha.Sma(this.reset);this.$.ea.ND(this.oy)}aLf(P,ka,pa,Na){return Object(m.a)(this,void 0,void 0,function*(){const Z=Object.assign(Object.assign({},P),{IM:pa,mSd:Na});
this.nIa=Z;const Ra=yield ka(P);Object(u.c)(Ra)||this.Uli(Z)&&void this.n4h(Ra)})}n4h(P){return Object(m.a)(this,void 0,void 0,function*(){const ka=this.nIa.text,pa=this.nIa.IM,Na=this.nIa.mSd;switch(P.kind){case 0:this.hide();break;case 1:case 2:this.show(pa,P,Na);break;case 3:if(!this.qoi(P))break;this.show(pa,P,Na);void this.aLf({text:ka,start:P.start,length:P.length},P.next,pa,Na);break;default:return P}})}show(P,ka,pa){this.nIa=void 0;this.ami(ka)&&(this.control.show(P,ka,pa),this.Wrb=ka)}hide(){this.control.hide();
this.Wrb=this.nIa=void 0}Uli(P){var ka;if(ka=this.nIa)ka=this.nIa,ka=ka.text===P.text&&ka.start===P.start&&ka.length===P.length&&ka.IM===P.IM&&ka.mSd===P.mSd;return ka}ami(P){return Object(u.b)(P.text)&&""!==P.text}qoi(P){return!this.Wrb||this.Wrb.start!==P.start||this.Wrb.length!==P.length||3===this.Wrb.kind}}Object(n.a)(H,"FormulaAssistanceValuePreview",null,[587,10]);var R=a(50),Q=a(37);class O extends l.a{constructor(P){super();this.$=P;this.Eb()}static ka(P){P.da.Ga(497,new O(P))}create(){let P=
this.$.da.za(496);P&&this.pb(P);const ka=R.GetServiceTaskFactory.Sa(this.$.da,413,414,this.fb),pa=R.GetServiceTaskFactory.Sa(this.$.da,448,449,this.fb),Na=R.GetServiceTaskFactory.Sa(this.$.da,19,153,this.fb),Z=R.GetServiceTaskFactory.Sa(this.$.da,211,212,this.fb);Q.TaskExtensions.Aa(Q.TaskExtensions.Td([ka,pa,Na,Z],this.la),()=>{P=this.$.da.za(496);P||(P=new H(this.$,ka.result,pa.result,Z.result),this.$.da.Ga(496,P));this.pb(P)},this.la,3)}}Object(n.a)(O,"FormulaAssistanceValuePreviewFactory",l.a,
[]);var V=a(694),W=a(183),da=a(55);class ta{constructor(P,ka){this.formulaAssistanceValuePreview=ka;this.gridView=Object(t.g)(P)}Lc(){return!1}executeCommand(P,ka){P=!1;ka=ka.command;switch(ka){case -46938080:this.formulaAssistanceValuePreview.trigger(),P=!0}return P?da.Task.Ta(!0):W.a(ka)}Ac(P,ka){return-46938080===ka.command}Oc(){return!1}}Object(n.a)(ta,"FormulaAssistanceValuePreviewCommandHandler",null,[164]);class K extends V.a{constructor(P){super(P)}vd(){const P=R.GetServiceTaskFactory.Sa(this.$.da,
496,497,this.fb);Q.TaskExtensions.Aa(P,()=>{this.$c([new ta(this.$,P.result)])},this.la)}static ka(P){V.a.Od(515,new K(P))}}Object(n.a)(K,"FormulaAssistanceValuePreviewCommandHandlerFactory",V.a,[]);a.d(C,"a",function(){return na});const na=()=>{k.a.Fa(P=>{O.ka(P);K.ka(P)})}},1186:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(27),f=a(86),e=a(30),k=a(414),l=a(236);class m{}m.vph="ewa-dv";m.wph="ewa-dv-buttonarea";m.Coh="ewa-dlb";m.mCb="list-table";m.listItem="list-item";m.jCb="list-item-selected";
m.nCb="list-table-touch";m.uph="ewa-dpb";m.Ijh="dv-prompt-title";m.Hjh="dv-prompt-message";Object(n.a)(m,"CssClassNames",null,[]);var u=a(31),t=a(556),w=a(19),r=a(49),v=a(424),y=a(77),x=a(7),B=a(15),z=a(153),A=a(818),I=a(37),F=a(14),U=a(21),X=a(262),T=a(64);class G extends z.ErrorDialog{constructor(sa,ab,Ua){super(sa,G.xQ(ab,sa,Ua));this.Vc=()=>{this.setFocus()};U.g(this.$).ha.YG(this.Vc);(sa=sa.da.za(14).e4a(Ua))&&sa.options&1&&B.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.")}dispose(){U.g(this.$).ha.cG(this.Vc);
super.dispose()}setFocus(){switch(this.error.Severity){case 0:var sa=4;break;case 1:sa=3;break;case 2:sa=0;break;default:sa=this.xM}(sa=this.getButton(sa))?sa.get_element().focus():super.setFocus()}Kqb(){const sa=U.g(this.$);sa.eb&&sa.Xb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.UUd(1);if(2===this.returnValue||0===this.returnValue){const ab=sa.Vb(null);if(ab){sa.Ea.gV();const Ua=Object(x.a)(new X.a,{Text:ab.originalText});sa.setCell(Ua,ab.range,
0,63,null)}this.$.fd(-798660877,y.a.Gb,8,null)}super.Kqb()}Isa(){const sa=U.g(this.$);sa.eb&&sa.Xb.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.UUd(0);super.Isa()}UUd(sa){const ab=U.g(this.$);I.TaskExtensions.Aa(ab.startEdit(!1,sa),()=>{const Ua=ab.Xb.textBox;Ua.text&&Ua.selectRange(0,Ua.text.length)},this.la,11,T.a.current)}static xQ(sa,ab,Ua){Ua=ab.da.za(14).e4a(Ua);sa.MessageId=-1083021405;sa.MessageIdName="DataValidationError";sa.MessageIdHash=
e.a.Zv(sa.MessageIdName);sa.Severity=Ua?Ua.r9c:1;ab=(null===Ua||void 0===Ua?0:Ua.iJa)?e.a.zg(Ua.iJa):null;Ua=(null===Ua||void 0===Ua?0:Ua.error)?e.a.zg(Ua.error):String.format("<p>{0}</p><p>{1}</p>",F.a.instance.ga(900),F.a.instance.ga(901));switch(sa.Severity){case 0:sa.Appearance=18;break;case 1:sa.Appearance=12;Ua+=String.format("<p>{0}</p>",F.a.instance.ga(902));break;default:sa.Appearance=3}sa.Caption=ab;sa.Description=Ua;sa.HelpDescription=F.a.instance.ga(1322);sa.HelpTopicId=A.a.oHe;return sa}}
Object(n.a)(G,"DataValidationErrorDeprecatedDialog",z.ErrorDialog,[]);z=a(284);var D=a(5),J=a(43),L=a(283),H=a(191),R=a(53),Q=a(29),O=a(282),V=a(11),W=a(281),da=a(157);class ta extends z.a{constructor(sa,ab,Ua){super(sa);this.BU=this.Kx=null;this.Fhf=!1;this.MW=this.Lm=this.W8e=this.errorMessage=null;this.pHe=nb=>{const Ha=this.$;var sb=this.Fhf;this.hide();const Qb=U.g(Ha);Qb.eb&&Qb.Xb.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===nb&&sb&&I.TaskExtensions.Aa(Qb.startEdit(!1,
1),()=>{const mb=Qb.Xb.textBox;mb.text&&mb.selectRange(0,mb.text.length)},this.la,11,T.a.current);if(1===nb&&!sb){if(sb=Qb.Vb(null)){Qb.Ea.gV();const mb=Object(x.a)(new X.a,{Text:sb.cell.userInput});Qb.setCell(mb,sb.range,0,63,null)}Ha.fd(-798660877,y.a.Gb,8,null)}2===nb&&I.TaskExtensions.Aa(Qb.startEdit(!1,0),()=>{const mb=Qb.Xb.textBox;mb.text&&mb.selectRange(0,mb.text.length)},this.la,11,T.a.current)};this.yBd=()=>{V.HelperMethods.KV(this.$.xG,this.error.HelpTopicId,this.$.sS)};this.IMi=()=>{this.Pxb();
this.$.fd(802602464,2,8,this.BU)};this.cLi=()=>{B.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};this.dLi=nb=>{!nb||O.a(nb)?B.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(nb=this.YWh(nb.Result),this.Kx.errorInformation=nb,this.rUa(this.iJa,this.O4a(this.pHe),this.Kx))};this.eBd=()=>{this.show(this.xSb)};
this.nNe=Ua;this.sqmManager=da.a(this.$);this.error=ta.xQ(ab,sa,Ua);this.rb.gp=this;this.iJa=(this.av=sa.da.za(14).e4a(this.nNe))&&this.av.iJa?this.av.iJa:F.a.instance.ga(1734);this.Qpj();this.initializeAndShow(this.iJa,this.pHe,this.Kx)}get uc(){return"DataValidationErrorDialog"}dispose(){this===this.rb.gp&&(this.rb.gp=null);f.a.Ia(this.Lm);this.Lm=null;super.dispose()}Qpj(){this.av&&this.av.error?this.errorMessage=this.av.error:this.av&&this.av.options&1?(B.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=F.a.instance.ga(1736),this.W8e=R.a.current.Zn(121)):(this.errorMessage=F.a.instance.ga(1735),this.XMh(this.nNe));var sa=this.av?this.av.r9c:1;this.Kx={[ta.dv]:this.uc,["errorDescription"]:this.errorMessage,["helpImageUri"]:this.W8e};switch(sa){case 0:this.Rb=1;this.rc(1,"Retry");this.Kx.dialogIcon=2;this.Fhf=!0;break;case 1:this.Rb=4;this.Kx.dialogIcon=1;this.Kx.additionalInformation=F.a.instance.ga(902);break;default:this.Rb=1,this.Kx.dialogIcon=3}this.Kx.helpLink={["type"]:"AppLinkProps",
[ta.dv]:this.error.HelpTopicId,["text"]:F.a.instance.ga(1322),["handler"]:this.yBd};sa=Q.a.lXc([this.error]);this.BU={[D.a.B9b]:!0,[D.a.Bad]:sa,[D.a.Cad]:da.a(this.$).wtb(this.error.MessageIdHash),[D.a.oQ]:this.uc,["DismissHandler"]:this.eBd};this.Kx.giveFeedbackLink={["type"]:"AppLinkProps",[ta.dv]:D.a.pid,["text"]:F.a.instance.ga(1773),["handler"]:this.IMi}}XMh(sa){const ab=this.$.pa.va.Tb();L.e(this.$.pa.va,J.q(sa,this.$),W.b(this.dLi),W.a(this.cLi),null,ab)}YWh(sa){let ab;switch(sa.RuleType){case 1:switch(sa.ConditionType){case 0:return ab=
F.a.instance.mb(108),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 1:return ab=F.a.instance.mb(109),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 2:return ab=F.a.instance.mb(110),String.format(ab,sa.LowerBoundary);case 3:return ab=F.a.instance.mb(111),String.format(ab,sa.LowerBoundary);case 4:return ab=F.a.instance.mb(112),String.format(ab,sa.LowerBoundary);case 5:return ab=F.a.instance.mb(113),String.format(ab,sa.UpperBoundary);case 6:return ab=F.a.instance.mb(114),String.format(ab,
sa.LowerBoundary);case 7:return ab=F.a.instance.mb(115),String.format(ab,sa.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(sa.ConditionType){case 0:return ab=F.a.instance.mb(116),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 1:return ab=F.a.instance.mb(117),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 2:return ab=F.a.instance.mb(118),String.format(ab,sa.LowerBoundary);case 3:return ab=F.a.instance.mb(119),String.format(ab,sa.LowerBoundary);case 4:return ab=
F.a.instance.mb(120),String.format(ab,sa.LowerBoundary);case 5:return ab=F.a.instance.mb(121),String.format(ab,sa.UpperBoundary);case 6:return ab=F.a.instance.mb(122),String.format(ab,sa.LowerBoundary);case 7:return ab=F.a.instance.mb(123),String.format(ab,sa.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(sa.ConditionType){case 0:return ab=F.a.instance.mb(124),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 1:return ab=F.a.instance.mb(125),String.format(ab,sa.LowerBoundary,
sa.UpperBoundary);case 2:return ab=F.a.instance.mb(126),String.format(ab,sa.LowerBoundary);case 3:return ab=F.a.instance.mb(127),String.format(ab,sa.LowerBoundary);case 4:return ab=F.a.instance.mb(128),String.format(ab,sa.LowerBoundary);case 5:return ab=F.a.instance.mb(129),String.format(ab,sa.UpperBoundary);case 6:return ab=F.a.instance.mb(130),String.format(ab,sa.LowerBoundary);case 7:return ab=F.a.instance.mb(131),String.format(ab,sa.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(sa.ConditionType){case 0:return ab=
F.a.instance.mb(132),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 1:return ab=F.a.instance.mb(133),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 2:return ab=F.a.instance.mb(134),String.format(ab,sa.LowerBoundary);case 3:return ab=F.a.instance.mb(135),String.format(ab,sa.LowerBoundary);case 4:return ab=F.a.instance.mb(136),String.format(ab,sa.LowerBoundary);case 5:return ab=F.a.instance.mb(137),String.format(ab,sa.UpperBoundary);case 6:return ab=F.a.instance.mb(138),String.format(ab,
sa.LowerBoundary);case 7:return ab=F.a.instance.mb(139),String.format(ab,sa.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(sa.ConditionType){case 0:return ab=F.a.instance.mb(140),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 1:return ab=F.a.instance.mb(141),String.format(ab,sa.LowerBoundary,sa.UpperBoundary);case 2:return ab=F.a.instance.mb(142),String.format(ab,sa.LowerBoundary);case 3:return ab=F.a.instance.mb(143),String.format(ab,sa.LowerBoundary);case 4:return ab=
F.a.instance.mb(144),String.format(ab,sa.LowerBoundary);case 5:return ab=F.a.instance.mb(145),String.format(ab,sa.UpperBoundary);case 6:return ab=F.a.instance.mb(146),String.format(ab,sa.LowerBoundary);case 7:return ab=F.a.instance.mb(147),String.format(ab,sa.UpperBoundary);default:return"we couldn't get the details"}case 3:return ab=F.a.instance.mb(106),String.format(ab,sa.LowerBoundary);case 7:return ab=F.a.instance.mb(107),String.format(ab,sa.LowerBoundary);default:return"we couldn't get the details"}}UUd(sa){const ab=
U.g(this.$);I.TaskExtensions.Aa(ab.startEdit(!1,sa),()=>{const Ua=ab.Xb.textBox;Ua.text&&Ua.selectRange(0,Ua.text.length)},this.la,11,T.a.current)}get la(){this.Lm=this.Lm||new H.a;return this.Lm.token}static xQ(sa,ab,Ua){ab=ab.da.za(14).e4a(Ua);sa.MessageId=-1083021405;sa.MessageIdName="DataValidationError";sa.MessageIdHash=e.a.Zv(sa.MessageIdName);sa.Severity=ab?ab.r9c:1;sa.HelpDescription=F.a.instance.ga(1322);sa.HelpTopicId=A.a.oHe;return sa}}Object(n.a)(ta,"DataValidationErrorDialog",z.a,[89,
90,10,91]);z=a(912);var K=a(381);class na extends z.a{constructor(sa,ab,Ua){super(sa,ab);this.dataValidationControl=Ua}get ozb(){return Object(k.a)(ta,this.$.rb.ih)}get uK(){return this.dataValidationControl.se}set uK(sa){this.dataValidationControl.se=sa}get V5a(){return!1}get key(){return K.a.R5c}dispose(){this.dataValidationControl=null;super.dispose()}Yh(sa,ab){this.dataValidationControl.Ya=this.Ya;const Ua=sa.keyCode;return 1461300262!==ab||16!==Ua&&17!==Ua&&18!==Ua?super.Yh(sa,ab):!1}lAd(){this.uK&&
(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.nN,!0,!0,d.a.Ap||3===y.a.Gb))}Lf(){}qh(){this.dataValidationControl.show(this.dataValidationControl.nN,!0,!0,d.a.Ap||3===y.a.Gb)}NGd(sa,ab){return this.dataValidationControl.Yh(ab)}}Object(n.a)(na,"DataValidationListAutoCompleteBehavior",z.a,[]);var P=a(263);z=a(838);var ka=a(12),pa=a(117),Na=a(22),Z=a(911),Ra=a(1);class Da extends z.a{constructor(sa,ab,Ua){super(sa,ab,new Z.a(m.listItem,m.jCb,m.mCb,
m.nCb));this.tIa=this.wV=this.Eda=this.fe=this.Elb=null;this.ZNa=0;this.bGb=[];this.xRj=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");this.lCb=Ua}get Lj(){return this.Elb}set Lj(sa){this.CBa(this.Elb);if(sa){this.Elb=sa;this.lCb.innerText="";this.CBa(this.Elb);const ab=this.bGb[sa.rowIndex];this.fe=this.wV[ab];this.tIa&&(this.Eda=this.tIa[ab],B.ULS.shipAssertTag(537163286,0,!this.bGb.length||!!this.Eda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.lCb.innerText=this.fe;this.uvc(sa)}else this.Eda=this.fe=null}get eb(){return U.g(this.$).eb}get editText(){return U.g(this.$).Xb.text}dispose(){super.dispose();this.lCb=this.Elb=null}vea(sa,ab,Ua,nb){if(sa&&(!sa||sa.length)){this.E7(!1);this.tIa=sa;this.wV=[];for(var Ha=0;Ha<sa.length;Ha++)this.wV[Ha]=sa[Ha]?sa[Ha].Name:null;Ha=`<table class='${this.Xba}' aria-live='polite'><tbody>`;var sb="",Qb="";sa=0;var mb=U.g(this.$).Vb(null);nb=this.eb?nb?nb.text:this.editText:mb?mb.originalText:null;
mb=!nb;var Pb=0;this.bGb.length=0;var gc=[],Xb=[],Ca=[],ra=nb?nb.split(" "):[""];nb=nb.trim();for(let hb=0;hb<this.wV.length;hb++){const vb=this.wV[hb];var ma=void 0;const Va=vb.split(" ");ma=P.a.all(ra,Oa=>P.a.any(Va,Wa=>Na.a.uL(Wa,Oa)));const db=!vb,oa=Ca.includes(vb);db||oa||this.eb&&!ma||(ma=vb?e.a.zg(e.a.B8c(vb)):"",ma=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.f_,ma),Ca.push(vb),this.eb&&Na.a.uL(vb,nb)?(sb+=ma,gc.push(hb)):(Qb+=ma,Xb.push(hb)),!mb&&Na.a.equals(nb,vb,!0)&&
(sa=this.eb?gc.length-1:Pb,mb=!0),Pb++)}this.ZNa=Pb;this.bGb.push(...gc);this.bGb.push(...Xb);this.gg.innerHTML=Ha+(sb+Qb+"</tbody></table>");Ha=this.zn=ka.DOMElementExtensions.fk(this.domElement,this.Xba);this.knb(Ha,ab);this.E7(!0);this.Zra(ab,Ua);this.Lj=0<this.ZNa?Ha.rows[sa]:null}}dSa(sa){var ab=!1;this.eb&&sa&&(ab=!this.ZNa,sa.endEdit(ab,"DataValidationListBox.SetCellContent",0));if(!ab&&(sa=U.g(this.$),ab=sa.Vb(null))){let nb=null;if(this.Eda&&-1!==this.Eda.SheetId&&-1!==this.Eda.Row&&-1!==
this.Eda.Column){var Ua={};Ua.SheetName=this.Eda.SheetId.toString();Ua.FirstRow=this.Eda.Row;Ua.FirstColumn=this.Eda.Column;nb={ParameterType:6};nb.SourceRange=Ua}Ua=Object(x.a)(new X.a,{Text:this.fe});sa.setCell(Ua,ab.range,0,63,nb)}return!0}Zra(sa,ab){const Ua=sa?this.eDb:this.fI;sa=sa?this.ckc:this.dkc;0>=this.ZNa?this.gg.style.height=V.HelperMethods.pc(sa):(this.gg.style.height="auto",this.ZNa>Ua?(ka.DOMElementExtensions.TI(this.gg,this.xRj?Math.floor(sa*Ua):Math.floor(this.gg.offsetHeight*Ua/
this.ZNa)),this.gg.style.overflowY="auto"):(this.gg.style.height="auto",this.gg.style.overflowY="hidden"));ka.DOMElementExtensions.Jv(this.gg,ab);ka.DOMElementExtensions.Jv(this.zn,ab-(this.ZNa>Ua?pa.a.xu:0))}}Object(n.a)(Da,"DataValidationListBox",z.a,[]);var Ba=a(113),ea=a(250),Y=a(253),ja=a(1092);const ca=`<p class='${m.Ijh}'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>`,ba=`<p class='${m.Hjh}'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>`;var ua=w.a.oOe,wa=w.a.oOe,
ia=w.a.b_g;class xa extends l.a{constructor(sa){super(document.createElement("div"));this.w1b=this.DQ=this.aR=!1;this.ai=this.Qh=null;this.Tgi=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");this.Ugi=Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");this.znd=this.yqd=this.Dpd=!1;this.Z5b=[];this.Hh=()=>{this.B4f(!1)};this.jPa=(Ua,nb)=>{this.show(this.nN,!this.se,!0,d.a.Ap||3===nb.tb||3===y.a.Gb);this.QAd(null,null)};this.QAd=
()=>{this.gridView.setFocus()};this.VLa=()=>{this.Ya.textBox.xF=!0};this.At=()=>{this.Teg()};this.onContentReady=()=>{this.B4f(this.se)};this.Ec=()=>{this.ay()};this.aza=()=>{this.dSa()};this.ayf=()=>{this.Teg()};this.$=sa;this.gridView=U.g(this.$);this.bJ=this.gridView.Xb;var ab="<div id='dv_reader_description' class='"+u.a.GOe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+m.wph+" "+w.a.Xp+"'></div>\r\n<div id='dv_list_box' class='"+m.Coh+" "+w.a.lp+" "+w.a.Xp+"'></div>\r\n<div id='dv_prompt_box' class='"+
m.uph+" "+w.a.Xp+"'></div>";this.domElement.className=m.vph;this.domElement.innerHTML=ab;ea.d(this.style,this.isGridRtl);this.gg=$get("dv_list_box",this.domElement);this.Q_=$get("dv_prompt_box",this.domElement);this.Dsa=$get("dv_list_button",this.domElement);this.lCb=$get("dv_reader_description",this.domElement);(ab=Ba.a(sa))&&this.Z5b.push(new na(sa,ab,this));this.Z5b.push(new na(sa,this.gridView.Xb,this));this.gridView.ha.vJ(this.Hh);this.gridView.Uu(this.onContentReady);this.gridView.hc.aGg(this.ayf);
this.$.sk(this.Ec);ab=this.gridView.zj;ab.insertBefore(this.domElement,ab.firstChild);this.onContentReady(null,null);sa.da.Ga(14,this)}get SAb(){return!!(this.$.Cd&16)}get poi(){return this.se||this.nN||this.Nwa}get se(){return ka.DOMElementExtensions.isVisible(this.gg)}set se(sa){ka.DOMElementExtensions.setVisible(this.gg,sa)}get nN(){return ka.DOMElementExtensions.isVisible(this.Q_)}set nN(sa){ka.DOMElementExtensions.setVisible(this.Q_,sa)}get Nwa(){return ka.DOMElementExtensions.isVisible(this.Dsa)&&
!!this.Qh&&ka.DOMElementExtensions.isVisible(this.Qh.domElement)}set Nwa(sa){ka.DOMElementExtensions.setVisible(this.Dsa,sa);this.Qh&&ka.DOMElementExtensions.setVisible(this.Qh.domElement,sa)}get Ya(){return this.bJ}set Ya(sa){this.bJ=sa}get q5a(){return!!this.activeCell&&this.A7c(this.activeCell.range)}get activeCell(){return this.gridView.Vb(null)}get q8e(){return this.q5a&&!!this.av&&!!(this.av.options&2)&&!!this.av.prompt}get nxb(){return this.q5a&&!!this.av&&!!(this.av.options&1)}get isGridRtl(){return this.gridView.rtl}get av(){return this.e4a(this.activeCell.range)}get UOa(){const sa=
this.activeCell;return sa?this.Hva(this.gridView,sa):null}dispose(){this.$&&(this.uNb(!1),this.gridView.ha.bL(this.Hh),this.gridView.xy(this.onContentReady),this.gridView.hc.nbj(this.ayf),this.$.Gl(this.Ec));this.EFe(!1);this.FFe(!1);f.a.qc(this.Z5b);this.Z5b=this.Dsa=this.gg=this.Q_=this.bJ=this.gridView=this.$=null;super.dispose()}A7c(sa){return!!this.e4a(sa)}vrb(sa,ab){return Ra.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new ta(this.$,sa,ab):new G(this.$,
sa,ab)}e4a(sa){sa=this.gridView.getRangeInformation(sa);for(let ab=0;ab<sa.length;ab++){const Ua=sa[ab];if(Object(k.a)(v.DataValidationRange,Ua))return Ua}return null}XIh(){if(!this.q5a)return"";const sa=this.q8e?`${this.av.oLf} ${this.av.prompt}`:"",ab=this.nxb?F.a.instance.ga(847):"";return String.format(F.a.instance.mb(17),sa,ab)}Yh(sa){let ab=!1;if(this.se||(-569786022===sa||541421805===sa)&&this.nxb||1872288872===sa&&this.nN)switch(sa){case -569786022:case 541421805:this.show(this.nN,!this.se,
!0,d.a.Ap||3===y.a.Gb);ab=!0;break;case 1872288872:this.se?(this.show(this.nN,!1,!0,!1),ab=!0):this.nN?(this.show(!1,!1,!0,!1),ab=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),ab=!0);break;case -798660877:this.ai.vB(1);ab=!0;break;case 137938150:this.ai.vB(-1);ab=!0;break;case 2091832999:this.ai.vB(this.ai.fI-1);ab=!0;break;case 742457698:this.ai.vB(-(this.ai.fI-1));ab=!0;break;case 125627505:case 267796030:ab=this.dSa()}return ab}show(sa,ab,Ua,nb){this.ay();if(this.SAb&&
this.q5a){var Ha=this.UOa;if(Ha){if(sa||ab||Ua)this.isVisible=!0;ea.d(this.style,this.isGridRtl);Ua&&this.nxb&&(this.FFe(!0),this.Keg(Ha,!1));ab&&this.nxb&&this.USa(nb,Ha);sa&&this.q8e&&this.sBj(Ha);this.poi||(this.isVisible=!1)}}}Hva(sa,ab){if(!ab||!ab.cell.Kk)return null;var Ua=this.gridView.hc.textBox.domElement;var nb=0<ka.DOMElementExtensions.getHeight(Ua)&&0<ka.DOMElementExtensions.getWidth(Ua)&&0<=Ua.offsetTop&&0<=Ua.offsetLeft;if(nb)Ua=ka.DOMElementExtensions.Hva(Ua,sa.zj);else{Ua=sa.getCellBounds(ab.cell);
var Ha=ka.DOMElementExtensions.getBoundingClientRect(sa.zj);Ua=new Sys.UI.Bounds(Ua.x-Ha.x,Ua.y-Ha.y,Ua.width,Ua.height)}if(Ua)if(nb)2<Ua.height&&2<Ua.height&&(Ua.x+=1,Ua.y+=1,Ua.height-=2,Ua.width-=2);else if(nb=U.g(this.$).dK(ab.cell))nb=nb.width+1,Ha=Na.a.equals(Y.a.Bvb(ab.cell,sa.rtl),"right",!0),sa.rtl&&Ha&&(Ua.x=Ua.x+Ua.width-nb),ab.Ska&&sa.rtl===Ha&&(Ua.width=nb);else return null;return Ua}B4f(sa){const ab=this.q5a;this.uNb(ab);ab?this.show(!0,sa,!0,!1):this.ay()}dSa(){let sa=!1;this.se&&(sa=
this.ai.dSa(this.Ya),this.show(this.nN,!1,!0,!1));return sa}ay(){this.Tgi?(this.se&&(this.se=!1),this.Nwa&&(this.Nwa=!1),this.nN&&(this.nN=!1),this.isVisible&&(this.isVisible=!1)):this.se=this.Nwa=this.nN=this.isVisible=!1;this.Dpd=this.znd=this.yqd=!1}USa(sa,ab){this.nxb&&!this.av.tIa?this.Nwa&&this.Qh.disable():(this.EFe(!0),this.ai.vea(this.av.tIa,sa,this.bSh(ab),this.Ya),this.SBa(ab,!1))}sBj(sa){this.av.prompt&&(this.nN=!0,this.mTj(this.av.oLf,this.av.prompt),this.dfg(sa,!1))}Keg(sa,ab){const Ua=
sa.y;this.Dsa.style.top=V.HelperMethods.pc(Ua);sa=this.isGridRtl?sa.x-this.Dsa.offsetWidth+1:sa.x+sa.width+1;this.Dsa.style.left=V.HelperMethods.pc(sa);ab?this.Nwa=this.gridView.Pic(new r.a(sa,Ua))&&this.znd:this.znd=!0}SBa(sa,ab){const Ua=sa.y+sa.height;sa=this.isGridRtl?sa.x+sa.width-this.gg.offsetWidth:sa.x;this.gg.style.top=V.HelperMethods.pc(Ua);this.gg.style.left=V.HelperMethods.pc(sa);ab?this.se=this.gridView.Pic(new r.a(sa,Ua))&&this.Dpd:this.Dpd=!0}dfg(sa,ab){const Ua=sa.y+sa.height+5;var nb=
this.activeCell;nb=nb?nb.width/2:32;sa=this.isGridRtl?sa.x-this.Q_.offsetWidth+nb:sa.x+sa.width-nb;this.Q_.style.top=V.HelperMethods.pc(Ua);this.Q_.style.left=V.HelperMethods.pc(sa);ab?this.nN=this.gridView.Pic(new r.a(sa,Ua))&&this.yqd:this.yqd=!0}mTj(sa,ab){if(ab){var Ua="";sa&&(Ua+=String.format(ca,e.a.zg(sa)));Ua+=String.format(ba,e.a.zg(ab));this.Q_.innerHTML=Ua;sa=ka.DOMElementExtensions.fk(this.Q_,"dv-prompt-titletext");if(ab=ka.DOMElementExtensions.fk(this.Q_,"dv-prompt-messagetext")){sa=
sa?parseInt(String(Math.max(sa.offsetWidth,ab.offsetWidth)),10):ab.offsetWidth;sa+=6;ka.DOMElementExtensions.Jv(this.Q_,sa);for(let nb=0,Ha=this.Q_.children.length;nb<Ha;nb++)ka.DOMElementExtensions.Jv(this.Q_.children[nb],sa)}}}bSh(sa){return this.Ugi?sa.width+17-2+1:sa.width+this.Dsa.clientWidth-2+1}FFe(sa){this.$&&!this.SAb||!sa?(this.G8f(!1),f.a.Ia(this.Qh),this.Qh=null):(this.Qh||(this.Qh=new ja.a(this.Dsa,ua,t.a.bia,1,wa,F.a.instance.ga(899),ia,F.a.instance.ga(898),"",-1),this.G8f(!0)),this.Nwa=
!0,this.av.tIa?this.Qh.isEnabled||this.Qh.enable():this.Qh.disable())}EFe(sa){this.$&&!this.SAb||!sa?(this.yTa(!1),f.a.Ia(this.ai),this.ai=null):(this.ai||(this.ai=new Da(this.$,this.gg,this.lCb),this.yTa(!0)),this.se=!0)}yTa(sa){this.ai&&(sa&&!this.aR?(this.ai.C9(this.QAd),this.ai.OZb(this.VLa),this.ai.Fnb(this.aza),this.aR=!0):!sa&&this.aR&&(this.ai.mda(this.QAd),this.ai.ltc(this.VLa),this.ai.fJb(this.aza),this.aR=!1))}uNb(sa){sa&&!this.DQ?(this.gridView.view.Xs(this.At),this.DQ=!0):!sa&&this.DQ&&
(this.gridView.view.Zq(this.At),this.DQ=!1)}G8f(sa){this.Qh&&(sa&&!this.w1b?(this.Qh.sVc(this.jPa),this.Qh.GVc(this.jPa),this.Qh.rnb(this.VLa),this.w1b=!0):!sa&&this.w1b&&(this.Qh.gKd(this.jPa),this.Qh.uKd(this.jPa),this.Qh.RIb(this.VLa),this.w1b=!1))}Teg(){if(this.q5a){var sa=this.UOa;sa&&(this.Keg(sa,!0),this.SBa(sa,!0),this.dfg(sa,!0))}}}Object(n.a)(xa,"DataValidationControl",l.a,[710,10]);class gb extends b.a{constructor(sa){super();this.$=sa;this.Eb()}create(){this.pb(this.$.da.za(14)||new xa(this.$))}}
Object(n.a)(gb,"DataValidationControlFactory",b.a,[]);a.d(C,"a",function(){return va});const va=()=>{c.a.Fa(sa=>{sa.da.Ga(150,new gb(sa))})}},1194:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(187);const f={average:0,max:0,median:0,P75:0,P95:0},e={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,commitByMouseClickCounter:0,commitWhileRequestPending:0,dismissSmartSuggestionExplicitlyCounter:0,dismissSmartSuggestionImplicitlyCounter:0},k={formulaAssistanceRequestAttemptedCounter:0,
formulaAssistanceRequestOptimizedCounter:0},l={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},m={smartSuggestionShownCounter:0,smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0,smartSuggestionKeptCounter:0,isCellContentOnlyEqualDuringEditCounter:0,
isCellContentFormulaCounter:0,smartSuggestionWouldSuggestInsidePivotCounter:0},u={dialogCommitedCounter:0,dialogShownCounter:0,argsDialogOpenedByRibbonCounter:0,argsDialogOpenedByDialogCounter:0,argsDialogCommitedCounter:0},t={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},f),excludingFirstAction:Object.assign({},f)},w={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,smartFormulaBarAutoCompletePluginFlight:void 0,
anyPluginInitialized:void 0,formulaAssistanceRedesignFlight:void 0,NewInsertFunctionDialogFlight:void 0,smartFormulaSuggestionsFeatureEnabled:void 0};var r=a(58),v=a(109),y=a(28),x=a(1);class B{constructor(L){this.Orf=L;this.K_=Object.assign({},t);this.G7b=[];this.nlc=-1;(this.Nrf=x.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&L&&(this.K_.countAboveThresholds={},L.forEach(H=>this.K_.countAboveThresholds[H]=0))}pTa(){this.nlc=y.a.Pa.me.m}xia(L){-1!==this.nlc&&
(L?(this.hnb(y.a.Pa.me.m-this.nlc),this.nlc=-1):this.K_.failedCount++)}VAh(){this.K_.excludingFirstAction=B.RTe(this.G7b);this.G7b.push(this.K_.firstAction);this.K_.includingFirstAction=B.RTe(this.G7b)}hnb(L){this.K_.count?1E3>this.K_.count&&this.G7b.push(L):this.K_.firstAction=L;this.Nrf&&this.Orf&&this.Orf.forEach(H=>{L>H&&this.K_.countAboveThresholds[H]++});this.K_.count++}static RTe(L){const H=Object.assign({},f);0<L.length&&(v.i(L),H.median=L[Math.floor(.5*L.length)],H.P75=L[Math.floor(.75*L.length)],
H.P95=L[Math.floor(.95*L.length)],H.max=L[L.length-1],H.average=v.g(L,R=>R)/L.length);return H}}Object(n.a)(B,"PerformanceMeasurement",null,[]);var z=a(22),A=a(41),I=a(21),F=a(99),U;(function(L){L[L.function=3]="function";L[L.namedRange=100]="namedRange";L[L.tableHeader=101]="tableHeader";L[L.letVariable=102]="letVariable";L[L.richEntity=103]="richEntity";L[L.lambda=104]="lambda";L[L.customFunction=105]="customFunction";L[L.table=106]="table";L[L.tableSpecialStructRef=107]="tableSpecialStructRef";
L[L.richEntityEmptyCellRef=108]="richEntityEmptyCellRef"})(U||(U={}));Object(n.b)("CompletionItemKind",U);var X=a(33);const T={["argumentAssistanceOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverall"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleAndSmart"]:[50,80,100,130,150,170,200],["autoCompleteOverallSmartOnly"]:[50,80,100,130,150,170,200],["autoCompleteOverallSimpleOnly"]:[50,80,100,130,150,170,200]};class G{constructor(L){this.$=L;this.ZH=null;this.VBb=-1;this.Mjc=null;this.Njc=
0;this.X9=Object.assign({},l);this.PM=Object.assign({},m);this.AJ=Object.assign({},e);this.Pob=Object.assign({},k);this.l7=Object.assign({},w);this.Qob={};this.F3a=Object.assign(Object.assign({},u),{isReactDialog:X.a.Upd()});this.Lf=(H,R)=>{null!=this.ZH&&(1==Math.abs(this.VBb-this.$.ea.Je)&&(H=this.$.xa.oa.sheetId,R.Nqb&&R.Jk.equals(this.ZH.Jk)&&this.Mjc===H&&this.ZH.Zpb!==R.Zpb&&this.Njc++),1<=Math.abs(this.VBb-this.$.ea.Je)&&(this.ZH=null,this.VBb=-1,this.Mjc=null))};this.Ec=()=>{this.ktj();this.x9&&
this.utj();this.$.sendBeaconTraceTag(88392384,50,!1,"{0}",this.getJsonForLogging())};this.x9=x.EwaSettings.isChangeGateEnabled("OfficeVSO:6378161_addKeptSmartSuggestionsMetric");this.jab=new F.a;L.sk(this.Ec);this.x9&&I.g(this.$).Li.lm(this.Lf)}dispose(){this.$&&this.x9&&I.g(this.$).Li.Fl(this.Lf)}WD(L){L.forEach(H=>{this.jab.lb(H)||this.jab.ia(H,new B(T[H]));this.jab.na(H).pTa()})}aD(L,H=!0){L.forEach(R=>{this.jab.lb(R)&&this.jab.na(R).xia(H)})}LZf(L){let H="Undefined";switch(L){case 1:H="Collapsed";
break;case 0:H="Expanded";break;case 2:H="Hidden"}this.X9.argumentAssistanceCardInitialMode=H}bJa(L){window.requestAnimationFrame(()=>{this.aD([L])})}faf(L){L.forEach(H=>{H=U[H.kind];this.Zgg(H);this.Qob[H].shownCounter++})}eaf(L){L=U[L];this.Zgg(L);this.Qob[L].committedCounter++}getJsonForLogging(){return"{"+this.ZT("SessionDetails",this.l7)+","+this.ZT("ArgumentAssistanceUsage",this.X9)+","+this.ZT("FormulaSuggestionsUsage",this.PM)+","+this.ZT("FunctionDialogUsage",this.F3a)+","+this.ZT("AutocompleteCardInteraction",
this.AJ)+","+this.ZT("AutocompleteRenderOptimization",this.Pob)+","+this.ZT("AutocompleteUsageByKind",this.Qob)+","+this.CXh()+"}"}utj(){this.PM.smartSuggestionKeptCounter=this.PM.smartSuggestionCommittedCounter-this.Njc}ktj(){this.l7.argumentAssistanceFlight=this.n4a("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.l7.autoCompleteUIFlight=this.n4a("Microsoft.Office.Excel.","AutoCompleteNewUI");this.l7.smartFormulaBarAutoCompleteFlight=this.n4a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled");
this.l7.smartFormulaBarAutoCompletePluginFlight=this.n4a("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled");this.l7.formulaAssistanceRedesignFlight=this.n4a("Microsoft.Office.Excel.","FormulaAssistanceRedesign");this.l7.NewInsertFunctionDialogFlight=this.n4a("Microsoft.Office.Excel.","NewInsertFunctionDialog");this.l7.smartFormulaSuggestionsFeatureEnabled=X.a.kV(this.$)}CXh(){const L=new d.a;for(let H of this.jab)H.value.VAh(),L.add(`"${H.key}":${r.a.kc(H.value.K_)}`);return`"PerfMeasurements": {${L.toArray().join(",")}}`}n4a(L,
H){return z.a.contains(this.$.ya.FlightHolder.FlightId,H,!0)?x.EwaSettings.getBooleanFeatureGate(L+H,!1)?"T":"C":"None"}ZT(L,H){return`"${L.toString()}":${A.c(H)}`}Zgg(L){this.Qob[L]||(this.Qob[L]={shownCounter:0,committedCounter:0})}}Object(n.a)(G,"FormulaAssistanceTelemetryManager",null,[588]);class D extends b.a{constructor(L){super();this.$=L;this.Eb()}static ka(L){L.da.Ga(492,new D(L))}create(){var L;this.pb(null!==(L=this.$.da.za(491))&&void 0!==L?L:this.$.da.Ga(491,new G(this.$)))}}Object(n.a)(D,
"FormulaAssistanceTelemetryManagerFactory",b.a,[]);a.d(C,"a",function(){return J});const J=()=>{c.a.Fa(L=>{D.ka(L)})}},1213:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(276),d=a(91),f=a(39),e=a(263),k=a(549),l=a(4),m=a(82),u=a(414),t=a(717),w=a(8),r=a(31),v=a(19),y=a(60),x=a(5),B=a(787),z=a(1045),A=a(837),I=a(14),F=a(33);class U{constructor(Xb,Ca,ra,ma,hb,vb,Va,db){this.$=Ca;this.Ua=ra;this.rl=ma;this.selectedRanges=hb;this.grid=vb;this.Fy=db;this.H4=Va;this.Tga=e.a.all(hb,oa=>oa.isRow);this.csa=
e.a.all(hb,oa=>oa.gf);this.XDb=e.a.all(hb,oa=>!oa.isRow&&!oa.gf);Ca=vb.Fb.yhd(hb);this.Crb=!!Ca;this.eTf=!!Ca&&Ca.hasActiveFilter;this.menuSection=ra.Dc();Xb.sc.push(this.menuSection);this.mba=this.Tga||this.csa?this.menuSection:ra.Dc();this.Qta=this.Tga||this.csa?this.menuSection:ra.Dc()}Scd(){this.qGh();this.UFh();const Xb=this.Fy.y7a(this.selectedRanges,this.grid);this.menuSection.buttons.push(this.Ua.qb(Xb?149:148))}wGh(){let Xb=0;this.Crb?this.H4.um(942362098)?Xb=this.Fy.um(this.rl,942362098,
this.selectedRanges,this.grid)?161:169:this.eTf&&(Xb=this.Fy.um(this.rl,-1113896058,this.selectedRanges,this.grid)?177:181):this.H4.um(-1113896058)&&(Xb=this.Tga?this.Fy.um(this.rl,-1113896058,this.selectedRanges,this.grid)?49:116:this.Fy.um(this.rl,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Xb&&this.mba.buttons.push(this.Ua.qb(Xb))}vGh(){let Xb;!this.Crb&&this.H4.um(-1113896058)&&(Xb=this.Tga?this.Fy.um(this.rl,-1113896058,this.selectedRanges,this.grid)?295:296:this.Fy.um(this.rl,-1113896058,
this.selectedRanges,this.grid)?297:298,this.mba.buttons.push(this.Ua.qb(Xb)))}rGh(){let Xb=0;this.Crb?this.H4.um(622604322)&&(Xb=this.grid.rtl?this.Fy.um(this.rl,622604322,this.selectedRanges,this.grid)?191:192:this.Fy.um(this.rl,622604322,this.selectedRanges,this.grid)?162:170):this.H4.um(1415868706)&&(Xb=this.csa?this.Fy.um(this.rl,1415868706,this.selectedRanges,this.grid)?50:117:this.Fy.um(this.rl,1415868706,this.selectedRanges,this.grid)?178:182);0!==Xb&&this.mba.buttons.push(this.Ua.qb(Xb))}pGh(){this.H4.um(1035996630)&&
(this.Fy.um(this.rl,1035996630,this.selectedRanges,this.grid)?(this.mba.buttons.push(this.Ua.qb(this.grid.rtl?187:165)),this.mba.buttons.push(this.Ua.qb(166))):(this.mba.buttons.push(this.Ua.qb(this.grid.rtl?188:173)),this.mba.buttons.push(this.Ua.qb(174))))}qGh(){const {GridContextMenu:Xb}=a(1213);let Ca=null;this.XDb&&(Ca=this.Ua.ew("ContextMenu.InsertCells",null,I.a.instance.ga(350),1896159024),Ca.menu.sc.push(this.mba));Xb.sGh(this.mba,this.Ua,this.$);this.wGh();l.AFrameworkApplication.cI("XLS-InsertRowsBelowExperiment-Treatment;XLS-InsertRowsBelowExperiment-Control");
F.a.spd()&&this.vGh();this.rGh();this.pGh();Ca&&0<this.mba.buttons.length&&this.menuSection.buttons.push(Ca)}WFh(){let Xb=0;this.Crb?this.H4.um(1405456548)?Xb=this.Fy.um(this.rl,1405456548,this.selectedRanges,this.grid)?163:171:this.eTf&&(Xb=this.Fy.um(this.rl,1554436520,this.selectedRanges,this.grid)?179:183):this.H4.um(1554436520)&&(Xb=this.Tga?this.Fy.um(this.rl,1554436520,this.selectedRanges,this.grid)?51:118:this.Fy.um(this.rl,1554436520,this.selectedRanges,this.grid)?179:183);0!==Xb&&this.Qta.buttons.push(this.Ua.qb(Xb))}VFh(){let Xb=
0;this.Crb?this.H4.um(284490184)&&(Xb=this.Fy.um(this.rl,284490184,this.selectedRanges,this.grid)?164:172):this.H4.um(674605324)&&(Xb=this.csa?this.Fy.um(this.rl,674605324,this.selectedRanges,this.grid)?52:119:this.Fy.um(this.rl,674605324,this.selectedRanges,this.grid)?180:184);0!==Xb&&this.Qta.buttons.push(this.Ua.qb(Xb))}TFh(){this.H4.um(1035996630)&&(this.Fy.um(this.rl,1035996630,this.selectedRanges,this.grid)?(this.Qta.buttons.push(this.Ua.qb(this.grid.rtl?189:167)),this.Qta.buttons.push(this.Ua.qb(168))):
(this.Qta.buttons.push(this.Ua.qb(this.grid.rtl?190:175)),this.Qta.buttons.push(this.Ua.qb(176))))}UFh(){let Xb=null;this.XDb&&(Xb=this.Ua.ew("ContextMenu.DeleteCells",null,I.a.instance.ga(414),-1554384558),Xb.menu.sc.push(this.Qta));this.WFh();this.VFh();this.TFh();Xb&&0<this.Qta.buttons.length&&this.menuSection.buttons.push(Xb)}}Object(n.a)(U,"CellsContextMenuGenerator",null,[]);class X{constructor(Xb){this.ranges=null;this.ranges=Xb}}Object(n.a)(X,"MacroRecorderRangeHyperlinkRemovedPayload",null,
[115]);var T=a(525),G=a(24),D=a(102),J=a(77),L=a(72),H=a(43),R=a(171),Q=a(61),O=a(605),V=a(145),W=a(37),da=a(456),ta=a(557),K=a(1),na=a(183),P=a(21),ka=a(371),pa=a(34),Na=a(50),Z=a(240),Ra=a(22),Da=a(30),Ba=a(1071),ea=a(908),Y=a(132),ja=a(515),ca=a(370),ba=a(283),ua=a(162),wa=a(153),ia=a(343),xa=a(90),gb=a(29),va=a(282),sa=a(281),ab=a(133),Ua=a(772),nb=a(773),Ha=a(112),sb=a(41),Qb=a(55),mb;(function(Xb){Xb[Xb.none=0]="none";Xb[Xb.once=1]="once";Xb[Xb.twice=2]="twice"})(mb||(mb={}));Object(n.b)("ToggleState",
mb);class Pb{constructor(Xb,Ca,ra,ma){this.dXc=this.Ueb=this.Web=0;this.$=Xb;this.gridView=P.g(this.$);this.namedSheetViewPublic=Ca;this.xg=ra;this.instantaneousSupportInformationManager=ma;this.XMa=Ua.a.pnd()}dih(){var Xb=this.QU();Xb={["CommandValueId"]:sb.c(Xb)};const Ca=new xa.a(-2058042992,2,this.$.Kc,19,null);c.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Lb(Ca,Xb)}tih(){const Xb=new xa.a(644342024,2,this.$.Kc,
19,null);c.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Lb(Xb)}iih(){const Xb=this.gridView.ha.sa.activeCell,Ca=this.$.da.za(66).Mg,ra=this.$.da.za(66).jvb(Xb);return Ca||ra?this.kih(Ca,ra,Xb):this.jih(Xb)}kih(Xb,Ca,ra){if(this.JXg(Xb,Ca,ra))return c.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Qb.Task.Ta(!1);if(null!=
Xb&&Xb.hasAutoFilter||null!=Ca&&Ca.O_a.every(ma=>0!=ma.length))return this.Web=mb.none,this.bXc();this.Web=mb.once;return this.o7b(mb.once)}jih(Xb){var Ca=H.v(this.gridView.ha.sa.Xc,this.$);Ca=this.gridView.$.xa.getItemByName(Ca.SheetName);const ra=H.D(Ca.y0);if(this.IXg(ra,Xb))return c.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Qb.Task.Ta(!1);if(Ca.hasAutoFilter){if(ra&&ra.contains(this.gridView.ha.sa.activeCell))return this.Web=
mb.none,this.bXc();this.Web=mb.twice;return this.o7b(mb.twice)}this.Web=mb.once;return this.o7b(mb.once)}o7b(Xb){const Ca=H.v(this.gridView.ha.sa.Xc,this.$);if(!Ca)return Qb.Task.Ta(!1);this.Ueb||(this.Ueb=Date.now());const ra=new xa.a(368460465,2,this.$.Kc,19,null),ma=this.$.pa.va.Tb(),hb=()=>new Ba.a(Ca),vb=Va=>{va.a(Va)?c.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}"):(c.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),
Xb===mb.twice?this.o7b(mb.once):this.bXc())};return K.EwaSettings.$b()?ca.a(this.$.userOperationManager,(Va,db,oa)=>ba.z(this.$.pa.va,Ca,sa.b(Va,vb),db,oa,null,ma),Va=>new R.a(516,0,Va,64,hb),ra):ca.a(this.$.userOperationManager,(Va,db,oa)=>ba.z(this.$.pa.va,Ca,sa.b(Va,vb),db,oa,null,ma),Va=>new ja.a(516,0,Va,void 0,hb),ra)}JXg(Xb,Ca,ra){return null!=Xb&&ua.d(Xb)&&ra.top===Xb.usedRange.top||null!=Ca&&Ca.aba&&ra.top===Ca.top?(this.Erc(this.$,225),!0):null!=Xb&&ua.g(Xb)&&ra.top===Xb.usedRange.bottom?
(this.Erc(this.$,226),!0):!1}IXg(Xb,Ca){if(Xb&&Xb.contains(Ca)&&Ca.top===Xb.top||!Xb&&this.NWg(Ca.top,Ca.left))return this.Erc(this.$,227),!0;Xb=new G.Range(Ca.top,Ca.left,Ca.top+1,Ca.left+1,!1,!1);return this.gridView.Fb.pxa(Xb)?(this.Erc(this.$,228),!0):!1}Erc(Xb,Ca){Ca=gb.a.Yc(1,1,756,Ca,0,147079615,"ContextMenuFilterByCellValueError");K.EwaSettings.Dz()?new ia.a(Xb,Ca):(Xb=new wa.ErrorDialog(Xb,Ca),Xb.initialize(),Xb.ig())}bXc(){this.dXc=Date.now();const Xb=this.$_h();if(!Xb)return c.ULS.sendTraceTag(527500296,
0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),Qb.Task.Ta(!1);const Ca=this.QU(),ra={FirstRow:0};ra.FirstColumn=Ca.Column;ra.SheetName=Ca.SheetName;ab.b(this.$).Hd(Y.a.yvf,this.sm(),void 0,!0);const ma=this.M3c(Ca,ra),hb=Va=>{c.ULS.sendTraceTag(527500295,0,50,`GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : ${JSON.stringify({["ToggleFilterOperationCount"]:this.Web,["ApplyFilterTime"]:this.dXc?Date.now()-this.dXc:-1,["ToggleAndApplyFilterTime"]:this.Ueb?Date.now()-
this.Ueb:-1,["FilterByValueType"]:Ca.AutoFilterType})}`);this.Ueb&&(this.Ueb=0);if(Ua.a.Yxc(Va)){const db=Ua.a.nac(Va);this.XMa?Ua.a.bRa(nb.a.filterByCellValue,db.MessageIdName,Ha.a.tsa,!0,Ua.a.isSessionEndingError(db.MessageId)):c.ULS.sendTraceTag(527500294,0,10,`GridContextMenuFilter::ApplyFilterByValue failed with FilterException -${db.MessageIdName}`)}va.a(Va)?(Va=gb.a.xc(Va.Errors),c.ULS.sendTraceTag(527500292,0,50,`GridContextMenuFilter::ApplyFilterByValue service call failed with errors : ${Va}`)):
(c.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),ab.b(this.$).Hd(Y.a.bzf,this.sm(),void 0,!0),Va={},Va.FirstRow=this.VOh(),Va.FirstColumn=Ca.Column,-1!==Va.FirstRow&&(Va=H.C(Va),this.oS(Va)))},vb=new R.a(208,0,(Va,db,oa)=>Q.a(this.$.pa.va,ma,Xb,sa.b(Va,hb),db,oa,null,null),6,()=>new ea.a(Xb,ma));this.namedSheetViewPublic?this.namedSheetViewPublic.VSa().continueWith(Va=>{Va.result&&this.$.userOperationManager.Wb(vb,null)}):this.$.userOperationManager.Wb(vb,
null);return Qb.Task.Ta(!0)}oS(Xb){F.a.Mka(this.$)&&W.TaskExtensions.Aa(Na.GetServiceTaskFactory.Sa(this.$.da,430,431,1),Ca=>{Ca.result.sea(Xb);c.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.la,3)}sm(){return{["Location"]:"contextMenu"}}QU(){var Xb=0,Ca=this.gridView.ha.sa.activeCell;var ra=this.$.da.za(66).Mg;const ma=this.$.da.za(66).jvb(Ca);if(ra){var hb="Table";Xb=ra.objectId}else ma?(hb="Table",
Xb=ma.id):hb="Sheet";ra=Ca.left;Ca={};Ca.AutoFilterType=hb;Ca.Column=ra;Ca.Id=Xb;hb={};this.$.gk(hb);hb.FirstRow=0;hb.FirstColumn=Ca.Column;Xb=this.$.ea.isNamedObjectViewMode;Ca.NamedObjectView=Xb;Ca.SheetName=Xb?hb.NamedObjectName:hb.SheetName;Ca.ItemListOptions=null;return Ca}NWg(Xb,Ca){Xb=G.Range.Uc(Xb,Ca);return this.gridView.Ea.f$(Xb,this.$.oa.name)&&(Xb=this.gridView.Ea.JKa(Xb))&&Xb.autoFilterMenu?!0:!1}$_h(){var Xb=null;const Ca=this.gridView.Vb(this.gridView.ha.sa.activeCell);if(!Ca)return null;
const ra=Ca.cell.hzc;let ma;({category:ma}=this.instantaneousSupportInformationManager.MBa(ra,!1));if(1===Ca.cx.type)if(3===ma){if(!Ca.cell.POa)return c.ULS.sendTraceTag(527500290,0,15,`GridContextMenuFilter::GetValueForFilter() for category : ${ma}. NumFmt is null. `),null;Xb=(Ca.cell.POa.Start+Ca.cell.POa.End).trim()}else if(!ma&&(Ra.a.Y0a(Ca.cx.value,"E")||Ra.a.Y0a(Ca.originalText,"E"))){Xb=this.xg.JVe(Ca.cx.value,ra,1,Number.POSITIVE_INFINITY,Ca.cell.aia);if(!Xb.success)return c.ULS.sendTraceTag(527500289,
0,50,`GridContextMenuFilter::GetValueForFilter() for category : ${ma}. Failed to acquire formatted value`),null;Xb=Xb.Vx}Xb||(Xb=Ca.originalText);return Da.a.C0c(Xb)?["[Blanks]"]:["i"+Xb.trim()]}VOh(){const Xb=this.gridView.ha.sa.activeCell;var Ca=this.$.da.za(66).Mg;const ra=this.$.da.za(66).jvb(Xb);if(Ca)return Ca.usedRange.top;if(null!=ra)return ra.top;Ca=this.$.xa.getItemByName(this.$.oa.sheetName);return(Ca=H.D(Ca.y0))&&Ca.contains(Xb)?Ca.top:-1}M3c(Xb,Ca){const ra={};ra.Location=Ca;ra.FieldId=
Xb.Id.toString();ra.DataSourceIndex=-1;ra.FilterType=Xb.AutoFilterType;ra.AnchorType=0;ra.ChartId=null;ra.AnchorValue1=-1;ra.AnchorValue2=-1;ra.Property=Xb.RichProperty;return ra}}Object(n.a)(Pb,"GridContextMenuFilter",null,[]);a.d(C,"GridContextMenu",function(){return gc});class gc extends t.a{constructor(Xb,Ca,ra,ma){super(Xb,"PopulateGridContextMenu",1247109494,-2064931494,gc.K1h,!0,!1,gc.YJb,Ca,ra,!0,ma);this.Eic=this.expandCollapse=this.refresh=this.UY=this.nwa=this.YAa=!1;this.sFe=!0;this.grid=
P.g(Xb);this.plc=!0;if(this.egc=K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1)){const hb=Na.GetServiceTaskFactory.Sa(this.$.da,309,310,3),vb=Na.GetServiceTaskFactory.create(this.$.da,18,this.la,3);W.TaskExtensions.Aa(W.TaskExtensions.Td([hb,vb],this.la),()=>{this.$.da.Za(268,Va=>{this.d5a=new Pb(Xb,hb.result,vb.result,Va)})},this.la,3)}}get Lw(){return"PopulateGridContextMenu"}get HB(){return x.a.rNf}dispose(){super.dispose();this.grid=null}Lc(Xb,Ca){Xb=
!this.Uqd(Xb,Ca);if(!Xb)switch(Ca){case -1977666927:Xb=null==this.d5a||this.Awj();break;case 1549396389:Xb=null==this.d5a||!this.Mfi();break;case 2045563128:case 1803952894:Xb=null==this.d5a||!this.$.isEditMode&&!this.Nfi()}return Xb}Uqd(Xb,Ca){const ra=this.grid.ha.sa.selectedRanges;return(new V.a(this.$.xa)).um(Xb,Ca,ra,this.grid)}executeCommand(Xb,Ca,ra){const ma=Ca.command;Xb=null;switch(ma){case -1396319072:if(Ca=this.grid.Vb(null))b.a.instance.q_c(!0),d.EventHandlerManager.instance.ecd(),gc.RUi(Ca);
break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.sa.selectedRanges,Ca);break;case 324156914:Xb=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(ra);break;case -1977666927:Xb=this.d5a.dih();break;case 1549396389:Xb=this.d5a.tih();break;case 1803952894:Xb=this.d5a.iih();break;default:Xb=na.a(ma)}return Xb||W.TaskExtensions.Uaa()}Ac(Xb,Ca,ra){Xb=!1;switch(Ca.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Xb=
!0;break;case 1441131127:Xb=!!ra}return Xb}BY(Xb=!1){let Ca=!1,ra=!1,ma=0;K.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(ma=f.a.Ud());const hb=this.Ua.Up(this.menuId);var vb=this.grid.ha.sa;const Va=vb.Bg,db=Va&&vb.Xc.gf,oa=Va&&vb.Xc.isRow;vb=vb.selectedRanges;const Oa=e.a.all(vb,Ma=>Ma.gf),Wa=e.a.all(vb,Ma=>Ma.isRow),Sa=H.O(vb),yb=H.P(vb);this.Ygf(db,oa)?(Ca=!0,this.$Gh(hb)):this.$.isEditMode?ka.a(this.$)?this.aHh(hb,db,oa):(this.XFh(hb,!(oa||db||
!this.Eic)),this.tGh(hb,vb,Xb),this.iGh(hb,Oa,Wa,Sa,yb),this.YWe(hb,Va,db,oa),this.rHh(hb),this.DWe(hb,db,oa),this.QGh(hb,Va,db,oa,vb),this.$Fh(hb),this.YFh(hb,vb),this.BGh(hb),this.mHh(hb,Va),K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.nGh(hb)):(ra=!0,ka.a(this.$)?this.TWe(hb):this.HHh(hb,Va,db,oa,vb));K.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Xb=f.a.Ud()-ma,c.ULS.sendTraceTag(537167046,0,50,`GridContextMenu::CreateMenuModel, ExecutionTimeTotal: ${Xb}, isPivotMenu: ${Ca}, isViewMenu: ${ra}, firstTimeEntry: ${this.sFe}`));
this.sFe=!1;return hb}xKa(Xb){const Ca=[];if(ka.a(this.$))return Ca;if(3===Xb){Xb=this.grid.ha.sa;const ma=Xb.Bg,hb=ma&&Xb.Xc.gf,vb=ma&&Xb.Xc.isRow;let Va=!1;var ra=!1;let db=!1;this.$.isMobileMode&&(ra=Xb.selectedRanges,Va=H.O(ra),ra=H.P(ra));if(ma){const oa=P.e(this.grid);oa&&oa.range.contains(Xb.Xc)&&this.mV(oa)&&(db=!0)}this.$.isEditMode?this.Ygf(hb,vb)?Ca.push(...[A.a.pIf,A.a.rIf]):hb||vb?(Ca.push(A.a.clipboard),vb?Ca.push(A.a.Sij):hb&&Ca.push(A.a.g0g)):(Ca.push(...[A.a.edit,A.a.clipboard]),
db?Ca.push(A.a.hyperlink):Ca.push(A.a.color),ma&&Ca.push(A.a.oOg)):(Ca.push(A.a.copy),db&&Ca.push(A.a.openHyperlink),!vb||this.$.isMobileMode&&ra?!hb||this.$.isMobileMode&&Va||Ca.push(A.a.BWj):Ca.push(A.a.CWj));Ca.push(A.a.B1h)}else 2===Xb&&Ca.push(A.a.vye);return Ca}Ygf(Xb,Ca){return(this.YAa||this.nwa||this.UY||this.refresh||this.expandCollapse)&&!(Xb||Ca)}showGridContextMenu(Xb){this.expandCollapse=this.refresh=this.UY=this.nwa=this.YAa=!1;var Ca=this.$,ra=da.a(Ca).NKa(),ma=this.grid.ha.sa;const hb=
ma.Bg;var vb=hb&&ma.Xc.gf;ma=hb&&ma.Xc.isRow;if(ra&&!vb&&!ma){vb=ta.a(Ca);if(null===vb||void 0===vb?0:vb.dSd)this.YAa=vb=D.f(Ca.sg),this.nwa=!vb;vb=Ca.jc;this.UY=ra.supportsBIExplore&&!!B.a(Ca)&&vb.v2(32768);vb.allowInteractivity&&(Ca=this.grid.Vb(null),(null===Ca||void 0===Ca?0:Ca.cell)&&(Ca.cell.f_c||Ca.cell.Q3f)&&(this.expandCollapse=!0),vb.allowManualDataRefresh&&(this.refresh=!0))}Ca=null;ra=1;vb=Object(m.a)(k.a,Xb.eventArgs);Xb=Object(m.a)(z.a,Xb.creationParams);ma=this.$Lh();Xb?(Ca=Xb.clientPoint,
ra=Xb.inputMethod):vb&&1!==vb.tb?(Ca=new Sys.UI.Point(vb.clientPoint.x,vb.clientPoint.y),ra=vb.tb):ma&&(Ca=new Sys.UI.Point(ma.x+(this.$.isChromeRtl?0:ma.width),ma.y+ma.height));J.a.Gb=ra;this.Eic=3===ra;Xb=r.a.Otb;this.Jp(Ca,!vb||vb.Ca.target.className!==Xb,ra)}removeHyperlinksFromRange(Xb,Ca){if(!K.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Sp(Xb,!0)){var ra=H.r(Xb,this.$),ma=this.$.pa.va.Tb();this.$.userOperationManager.Wb(new R.a(125,
0,(hb,vb,Va)=>{this.$.Ay();return Q.b(this.$.pa.va,ra,"","",!0,!1,127,hb,vb,Va,null,ma)},void 0,()=>new X(ra)),Ca);this.grid.Ff.eH(!1)}}$Lh(){var Xb=this.grid.Vb(null);if((null===Xb||void 0===Xb?0:Xb.cell.Kk)&&this.kgf(Xb))return this.grid.getCellBounds(Xb.cell);Xb=this.grid.ha.sa.activeCell;return(Xb=this.X9b(new G.Range(Xb.top,Xb.left,w.a.eh,Xb.left,!1,!1),2,!0)||this.X9b(new G.Range(1,Xb.left,Xb.top,Xb.left,!1,!1),2,!1)||this.X9b(new G.Range(Xb.top,Xb.right,Xb.top,w.a.ph,!1,!1),1,!0)||this.X9b(new G.Range(Xb.top,
1,Xb.top,Xb.right,!1,!1),1,!1)||null)&&Xb.Kk?this.grid.getCellBounds(Xb):Sys.UI.DomElement.getBounds(this.grid.hwa.nc)}kgf(Xb){var Ca=this.grid.rtl,ra=this.$.isChromeRtl;Xb=Xb.cell;var ma=P.g(this.$).dK(Xb);return ma?(ma=ma.topLeft,Ca=ma.x+=Ca===ra?Xb.offsetWidth:0,ra=ma.y+=Xb.offsetHeight,this.grid.view.visibleArea.contains(new y.a(Ca,ra,0,0))):!1}X9b(Xb,Ca,ra){Xb=this.grid.uk("GridContextMenu.FindFirstCellInViewportArea",Xb,Ca,ra);try{for(Xb.$$rst();Xb.$$mn();){const ma=Xb.$$cu();if(ma&&this.kgf(ma))return ma.cell}}finally{Xb&&
Xb.dispose()}return null}$Gh(Xb){const Ca=this.Ua,ra=Ca.Dc();this.refresh&&ra.buttons.push(Ca.qb(100));this.UY&&ra.buttons.push(Ca.qb(99));this.YAa?ra.buttons.push(Ca.qb(59)):this.nwa&&ra.buttons.push(Ca.qb(58));if(this.expandCollapse){let ma;ma=Ca.ew("ContextMenu.PivotExpandCollapse",null,I.a.instance.ga(1166),589118293);const hb=Ca.Dc();hb.buttons.push(Ca.qb(243));hb.buttons.push(Ca.qb(244));hb.buttons.push(Ca.qb(245));hb.buttons.push(Ca.qb(246));ma.menu.sc.push(hb);ma&&0<hb.buttons.length&&ra.buttons.push(ma)}Xb.sc.push(ra)}YWe(Xb,
Ca,ra,ma){if(Ca&&!ra&&!ma){Ca=this.Ua.Dc();this.egc&&!this.$.vK&&this.Wcd(Ca);this.edd(Ca);this.vHh(Ca);if(K.EwaSettings.ma(479)&&P.g(this.$).ha.sa.sK()&&P.g(this.$).ha.sa.n5)switch(K.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Ca.buttons.push(this.Ua.qb(237));break;case 2:Ca.buttons.push(this.Ua.qb(238));break;default:Ca.buttons.push(this.Ua.qb(236))}Xb.sc.push(Ca)}}edd(Xb){if(this.$.jc.allowSorting&&(!this.$.isMobileMode||
(new V.a(this.$.xa)).Wd(2048))){var Ca=this.Ua.Dc();Ca.buttons.push(this.Ua.qb(223));Ca.buttons.push(this.Ua.qb(224));K.EwaSettings.isChangeGateEnabled("OfficeVSO:7080994_PutSelectedItemOnTop")&&(Ca.buttons.push(this.Ua.qb(292)),Ca.buttons.push(this.Ua.qb(293)),Ca.buttons.push(this.Ua.qb(294)));this.$.isMobileMode||Ca.buttons.push(this.Ua.qb(225));var ra=this.Ua.ew("ContextMenu.sort",null,I.a.instance.ga(229),-864298118);ra.menu.sc.push(Ca);Xb.buttons.push(ra)}}Wcd(Xb){const Ca=this.Ua.ew("ContextMenu.filter",
null,I.a.instance.ga(1968),2045563128),ra=this.Ua.Dc();var ma=this.xQh();const hb=this.Ua.qb(234);hb.label=ma;ra.buttons.push(hb);ra.buttons.push(this.Ua.qb(235));ma=this.Ua.Dc();ma.buttons.push(this.Ua.qb(233));Ca.menu.sc.push(ra);Ca.menu.sc.push(ma);Xb.buttons.push(Ca)}vHh(Xb){if(P.g(this.$).ha.sa.sK()){const Ca=this.Ua.Dc();Ca.buttons.push(this.Ua.qb(232));Ca.buttons.push(this.Ua.qb(285));Ca.buttons.push(this.Ua.qb(286));const ra=this.Ua.ew("ContextMenu.table",null,I.a.instance.ga(1967),-697806646);
ra.menu.sc.push(Ca);Xb.buttons.push(ra)}}OWe(Xb,Ca,ra,ma,hb){if(Ca){const Va=H.K(hb);var vb=P.e(this.grid);if(vb&&!ra&&!ma){ra=new V.a(this.$.xa);if(vb.range.contains(Va)&&this.mV(vb)){(Ca=!vb.NMa&&!ra.wi)&&this.$.isEditMode&&Xb.buttons.push(this.Ua.qb(45));vb.Zaa&&Xb.buttons.push(this.Ua.qb(53));Ca&&this.$.isEditMode&&Xb.buttons.push(this.Ua.qb(47));return}!vb.NMa&&this.$.isEditMode&&(vb=ra.Wd(128),Xb.buttons.push(this.Ua.qb(vb?46:121)))}}this.N4i(hb)&&Xb.buttons.push(this.Ua.qb(48));(vb=this.$.xa.oa)&&
vb.Dd&&(vb=vb.Dd.uv||vb.Dd.VH,!Ca||this.$.vK||!K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||vb||(Ca=H.K(hb),this.M4i(Ca)?Xb.buttons.push(this.Ua.qb(276)):Ca.gf||Ca.isRow||Xb.buttons.push(this.Ua.qb(275))))}N4i(Xb){for(const Ca of Xb){Xb=this.grid.getRangeInformation(Ca);for(let ra=0;ra<Xb.length;ra++)if(Object(u.a)(T.HyperlinkRange,Xb[ra])){const ma=this.grid.Vb(Xb[ra]);if(ma&&this.mV(ma)&&!ma.NMa)return!0}}return!1}M4i(Xb){if(P.g(this.$).ha.sa.sK()){const Ca=
P.g(this.$).Fb.hk(Xb);if(Ca&&Ca.usedRange.equals(Xb))return!0}return!1}DWe(Xb,Ca,ra){var ma,hb;if(1===P.g(this.$).ha.Me&&!Ca&&!ra){Ca=ka.a(this.$);ra=this.Ua;var vb=ra.Dc(),Va=this.$.da.za(65);(null===(ma=null===Va||void 0===Va?void 0:Va.Sm)||void 0===ma?0:ma.uF)&&!Ca&&vb.buttons.push(ra.qb(227));Va&&Va.isCommentOperationEnabled(3)&&vb.buttons.push(ra.qb(221));(null===(hb=null===Va||void 0===Va?void 0:Va.Sm)||void 0===hb?0:hb.Pjd)&&!Ca&&vb.buttons.push(ra.qb(228));(null===Va||void 0===Va?0:Va.hasCommentAtActiveCell)?
Va.JC.isResolved||vb.buttons.push(ra.qb(159)):Va&&Va.hasCommentAtActiveCell||(Va&&Va.Sm&&Va.Sm.uF?Ca||(vb.buttons.push(ra.qb(229)),vb.buttons.push(ra.qb(230))):(vb.buttons.push(ra.qb(160)),Ca||vb.buttons.push(ra.qb(226))));Xb.sc.push(vb)}}rHh(Xb){if(K.EwaSettings.ma(134)){const Ca=this.Ua,ra=Ca.Dc();ra.buttons.push(Ca.qb(250));Xb.sc.push(ra)}}tGh(Xb,Ca,ra){if(!ra){ra=this.$.Ka.yH();var ma=new V.a(this.$.xa),hb=new O.a(ra,Ca,this.grid);(new U(Xb,this.$,this.Ua,ra,Ca,this.grid,hb,ma)).Scd()}}iGh(Xb,
Ca,ra,ma,hb){const vb=(new V.a(this.$.xa)).Wd(8),Va=this.Ua,db=Va.Dc();Ca&&db.buttons.push(Va.qb(vb?152:153));ra&&db.buttons.push(Va.qb(vb?150:151));Ca&&(ma||db.buttons.push(Va.qb(vb?109:155)),db.buttons.push(Va.qb(vb?111:157)));ra&&(hb||db.buttons.push(Va.qb(vb?108:154)),db.buttons.push(Va.qb(vb?110:156)));Xb.sc.push(db)}XFh(Xb,Ca){const ra=this.Ua,ma=ra.Dc();Xb.sc.push(ma);Ca&&ma.buttons.push(ra.qb(102));ma.buttons.push(ra.qb(42));ma.buttons.push(ra.qb(43));Ca=this.XGh(ra);Xb.sc.push(Ca)}XGh(Xb){const Ca=
Xb.Dc();Ca.title=I.a.instance.ga(1146);Ca.N5f=!1;Ca.M5f=!1;Ca.Y$f=!1;let ra=5;const ma=F.a.usd(this.$);ma&&(ra=6);Xb=Xb.ZA("PasteOptionsGallery",ra,"Size24by24",Ca.title);Ca.buttons.push(Xb);Xb.Vt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1147,void 0,"Paste_24",1,v.a.Pth);Xb.Vt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1148,void 0,"PasteValues_24",1,v.a.Uth);Xb.Vt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",
1149,void 0,"PasteFormulas_24",1,v.a.Rth);Xb.Vt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1150,void 0,"PasteTranspose_24",1,v.a.Tth);Xb.Vt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1151,void 0,"PasteFormatting_24",1,v.a.Qth);ma&&Xb.Vt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1152,void 0,"PasteLink_24",1,v.a.Sth);return Ca}HHh(Xb,Ca,ra,ma,hb){var vb;const Va=this.Ua;var db=Va.Dc();
db.buttons.push(Va.qb(43));Xb.sc.push(db);this.egc&&!this.$.vK&&(db=this.Ua.Dc(),this.Wcd(db),Xb.sc.push(db));K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.jc.isMobileMode&&this.$.ea.jc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(db=this.Ua.Dc(),this.edd(db),Xb.sc.push(db),c.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));
db=this.$.da.za(65);if(null===(vb=null===db||void 0===db?void 0:db.Sm)||void 0===vb?0:vb.uF)vb=this.Ua.Dc(),vb.buttons.push(Va.qb(229)),Xb.sc.push(vb);vb=this.Ua.Dc();this.OWe(vb,Ca,ra,ma,hb);Xb.sc.push(vb);l.AFrameworkApplication.isMobileMode&&!L.a(this.$.ya,30)&&(Ca=Va.Dc(),Ca.buttons.push(Va.qb(272)),Xb.sc.push(Ca))}QGh(Xb,Ca,ra,ma,hb){const vb=this.Ua.Dc();this.RGh(vb);this.OWe(vb,Ca,ra,ma,hb);0<vb.buttons.length&&Xb.sc.push(vb)}RGh(Xb){Xb.buttons.push(this.Ua.qb(135))}nGh(Xb){const Ca=this.Ua.Dc();
Ca.buttons.push(this.Ua.qb(185));Xb.sc.push(Ca)}mHh(Xb,Ca){K.EwaSettings.ma(480)&&Ca&&(Ca=this.Ua.Dc(),Ca.buttons.push(this.Ua.qb(262)),Xb.sc.push(Ca))}BGh(Xb){var Ca=this.grid.ha.sa.selectedRanges;if(Ca&&Ca.length){var ra=!1;for(var ma=0;ma<Ca.length;ma++)if(this.grid.Fb.cNa(Ca[ma])){ra=!0;break}if(ra){ra=!1;for(ma=0;ma<Ca.length;ma++){var hb=this.grid.Fb.FUh(Ca[ma]);if(null!=hb&&null!=hb[0]){for(var vb=0;vb<hb.length;vb++)if(this.grid.Fb.cNa(hb[vb])){ra=!0;break}if(ra)break}}vb=this.Ua;ma=vb.Dc();
hb=vb.Dc();var Va=1===Ca.length&&(Ca[0].isSingle||this.grid.Fb.E7a(Ca[0])),db=!1,oa=!1,Oa=!1,Wa=!1;for(let Sa=0;Sa<Ca.length&&!(db&&Oa&&oa&&Wa);Sa++)!db&&this.grid.Fb.qki(Ca[Sa])&&(db=!0),!Oa&&this.grid.Fb.bgf(Ca[Sa],!1)&&(Oa=!0),!oa&&this.grid.Fb.Jqd(Ca[Sa])&&(oa=!0),!Wa&&this.grid.Fb.Pfi(Ca[Sa])&&(Wa=!0);K.EwaSettings.ma(104)&&Va&&!this.grid.Fb.Ffc(Ca[0])&&(Wa?ma.buttons.push(vb.qb(217)):ma.buttons.push(vb.qb(216)));Wa=db;Wa=!(new V.a(this.$.xa)).wi&&Wa;Oa&&!ra&&(K.EwaSettings.ma(130)&&D.l(this.$.sg)&&
(K.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(K.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?hb.buttons.push(vb.qb(220)):hb.buttons.push(vb.qb(Wa?220:271))),oa&&hb.buttons.push(vb.qb(Wa?218:269)),Va&&(this.grid.Fb.Jqd(Ca[0])||this.grid.Fb.Ffc(Ca[0]))&&hb.buttons.push(vb.qb(Wa?219:270))),hb.buttons.push(vb.qb(Wa?215:268)));0<hb.buttons.length&&(Ca=vb.ew(db?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",
null,I.a.instance.ga(1781),798637440),Ca.menu.sc.push(hb),ma.buttons.push(Ca));0<ma.buttons.length&&Xb.sc.push(ma)}}}YFh(Xb,Ca){this.grid.Fb.pef(Ca)&&(Ca=this.Ua.Dc(),this.grid.ha.sa.Hba()?(Ca.buttons.push(this.Ua.qb(241)),Ca.buttons.push(this.Ua.qb(239))):Ca.buttons.push(this.Ua.qb(240)),Xb.sc.push(Ca))}mV(Xb){return Xb.cell.hasHyperlink}TWe(Xb){this.bHh(Xb);var Ca=this.Ua.Dc();this.edd(Ca);Xb.sc.push(Ca);this.egc&&(Ca=this.Ua.Dc(),this.Wcd(Ca),Xb.sc.push(Ca))}aHh(Xb,Ca,ra){this.TWe(Xb);this.DWe(Xb,
Ca,ra)}bHh(Xb){if(this.grid.ha.sa.Bg&&!this.grid.ib.tj){var Ca=this.Ua,ra=Ca.Dc();pa.a(this.$).ISd()?ra.buttons.push(Ca.qb(265)):ra.buttons.push(Ca.qb(264));Xb.sc.push(ra)}}static RUi(Xb){const Ca=Xb.EKa(gc.Zkd);Ca&&Ca.Omd&gc.Zkd&&Xb.invoke(gc.Zkd,null)}static sGh(Xb,Ca,ra){if(K.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(ra=ra.da.za(254),!ra){c.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");
return}}else if(ra=ra.da.za(254,!0),!ra)return;ra.qpd()&&ra.blf()&&Xb.buttons.push(Ca.qb(212));ra.qpd()&&ra.yjc()&&Xb.buttons.push(Ca.qb(213))}Awj(){const Xb=this.$.da.za(66).Mg,Ca=this.grid.ha.sa.activeCell;return null!=Xb&&!Xb.hasActiveFilter||Z.c(this.$,Ca)||!this.Ofi(Ca)}Ofi(Xb){const Ca=Xb.left;var ra=this.tcc();if(null!=ra&&null!=ra.N9b&&ra.N9b.includes(Ca-1))return!0;ra=this.kcc();return null!=ra&&H.D(ra).contains(Xb)&&null!=ra.FilteredColumns&&ra.FilteredColumns.includes(Ca-1)?!0:!1}Mfi(){var Xb=
this.$.da.za(66).Mg;const Ca=this.tcc();if(null!=Xb)return Xb.hasAutoFilter&&Xb.hasActiveFilter;if(null!=Ca)return null!=Ca.N9b&&0<Ca.N9b.length;Xb=this.kcc();return null!=Xb&&null!=Xb.FilteredColumns&&0<Xb.FilteredColumns.length}Nfi(){var Xb=this.$.da.za(66).Mg;const Ca=this.tcc();if(null!=Xb&&Xb.hasAutoFilter||null!=Ca&&Ca.O_a.every(ra=>0!=ra.length))return!0;Xb=H.D(this.kcc());return null!=Xb&&Xb.contains(this.grid.ha.sa.activeCell)?!0:!1}tcc(){const Xb=this.$.da.za(66);Xb.qn(this.grid.ha.sa.activeCell);
return Xb.jvb(this.grid.ha.sa.activeCell)}kcc(){return this.$.xa.getItemByName(this.$.oa.sheetName).y0}xQh(){var Xb=this.grid.ha.sa.activeCell,Ca=0,ra=!1,ma=this.$.da.za(66),hb=this.tcc();ma=ma.Mg;null!=ma?(Ca=ma.usedRange.top,ra=!0):null!=hb?(Ca=hb.top,ra=!0):(hb=this.kcc(),null!=hb&&H.D(hb).contains(Xb)&&(Ca=hb.FirstRow+1,ra=!0));return ra?(Xb=Xb.left,Ca=G.Range.Uc(Ca,Xb),Ca=this.grid.Vb(Ca),ra="",null!=Ca&&(ra=Ca.text),this.vRg(ra,Xb)):I.a.instance.ga(222)}vRg(Xb,Ca){return null==Xb||Ra.a.Fh(Xb.trim())?
String.format(I.a.instance.mb(157),G.Range.QP(Ca)):Xb.length>gc.f2d?String.format(I.a.instance.mb(155),Xb.substring(0,gc.f2d)):String.format(I.a.instance.mb(156),Xb)}}gc.YJb="GridContextMenuRootName";gc.K1h=x.a.aDe;gc.Zkd=192;gc.f2d=26;Object(n.a)(gc,"GridContextMenu",t.a,[])},1214:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(86),d=a(1089),f=a(8),e=a(775);class k{}k.S8f="suggested_cells_list_box";Object(n.a)(k,"CssElementIds",null,[]);var l=a(5),m=a(1090);class u{constructor(W,da){this.Rmg=W;this.Qmg=
da}get ssa(){return this.Rmg}get ZXc(){return this.Qmg}}Object(n.a)(u,"CellAutoCompleteItem",null,[613]);var t=a(4),w=a(82),r=a(912),v=a(381),y=a(43),x=a(1),B=a(22),z=a(21);class A extends r.a{constructor(W,da,ta){super(W,da);this.ARb=null;this.sjc=0;this.L0=this.t8a=null;this.d6=(K,na)=>{if(K=this.cellAutoCompleteControl.items)if(1===K.length&&this.cellAutoCompleteControl.t1a.length<K[0].ssa.length&&this.cellAutoCompleteControl.rwa&&B.a.uL(K[0].ssa,this.cellAutoCompleteControl.t1a)&&(na.newValue=
K[0].ssa),this.Ya&&x.EwaSettings.ma(135)){let P=-1;1<K.length?P=this.cellAutoCompleteControl.qcc(this.Ya.text,!0):1===K.length&&(this.cellAutoCompleteControl.rwa||this.cellAutoCompleteControl.hec)&&(P=0);if(0<=P&&K.length>P&&K[P].ZXc){const ka=y.C(K[P].ZXc);ka&&z.g(this.$).Fb.cNa(ka)&&(na.idf=!0,na.rye=K[P].ZXc)}}};this.IFb=()=>{this.cellAutoCompleteControl.rwa=!1};this.Ya.cZa(this.d6);if(this.Yyb=x.EwaSettings.ll())this.ARb=ta;this.L0=this.ve.$d(this.Ya.textBox.domElement);this.L0.ka("mousedown",
this.IFb)}get ozb(){return!1}get uK(){return this.cellAutoCompleteControl.se}set uK(W){this.cellAutoCompleteControl.se=W}get V5a(){return!1}get key(){return v.a.V_c}get cellAutoCompleteControl(){if(this.Yyb)return this.ARb;const {CellAutoCompleteControl:W}=a(1214);return this.ARb||(this.ARb=Object(w.a)(W,this.$.da.za(1)))}dispose(){this.Ya.SIb(this.d6);super.dispose()}sY(W){W&&!this.cellAutoCompleteControl.se||super.sY(W)}Yh(W,da){this.cellAutoCompleteControl.Ya=this.Ya;this.sjc=W.keyCode;if(this.Ya.eb){const ta=
this.Ya.text;B.a.equals(this.t8a,ta,!1)||(this.t8a=ta)}else this.t8a=null;if(237279923===da)return this.cellAutoCompleteControl.se=!1;x.EwaSettings.ma(135)&&17===this.sjc&&this.cellAutoCompleteControl.rwa&&(this.cellAutoCompleteControl.hec=!0);return super.Yh(W,da)}lAd(){var W;if(!x.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!t.AFrameworkApplication.Qg)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.rwa=!1,this.Ya.eb){const da=
!B.a.equals(this.t8a,this.Ya.text,!0),ta=this.Ya.sod;ta||!da&&229!==this.sjc?ta&&(this.cellAutoCompleteControl.se&&(this.cellAutoCompleteControl.se=!1),null===(W=this.cellAutoCompleteControl.XNa)||void 0===W?void 0:W.cancel()):this.cellAutoCompleteControl.dNg(this.sjc)}else this.t8a=null}qh(){}Lf(){this.uK=!1;this.cellAutoCompleteControl.set_visible(!1);this.t8a=null;this.cellAutoCompleteControl.rwa=!1;this.cellAutoCompleteControl.hec=!1;this.cellAutoCompleteControl.XNa&&this.cellAutoCompleteControl.XNa.cancel()}NGd(W,
da){return this.cellAutoCompleteControl.Yh(W,da)}}Object(n.a)(A,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var I=a(30);r=a(1091);var F=a(12),U=a(11),X=a(117);class T extends r.a{constructor(W,da,ta){super(W,da);this.qra=this.cellAutoCompleteControl=null;if(this.Yyb=x.EwaSettings.ll())this.cellAutoCompleteControl=ta;this.zr=[]}get Lj(){return this.qra}set Lj(W){this.CBa(this.Lj);this.qra=W;const da=this.CBa(this.Lj);this.fe=W?da.innerText:null;this.uvc(W)}get se(){return super.se}set se(W){super.se=
W;W||(this.Lj=null)}get ZTa(){return null}get FGa(){return this.Yyb?this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.za(1))}dispose(){super.dispose();this.qra=null}Xzc(W){this.E7(!1);let da;da=`<table class='${this.Xba}' aria-live='polite'><tbody>`;for(let K=0,na=this.zr.length;K<na;K++){var ta=I.a.zg(W[this.zr[K]].ssa);ta=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.f_,T.W_c,l.a.Oqe,ta,I.a.B8c(ta));da+=
ta}this.gg.innerHTML=da+"</tbody></table>";this.zn=F.DOMElementExtensions.fk(this.domElement,this.Xba);this.E7(!0);this.Zra()}IJa(W,da){if(W&&W.length){var ta=[];if(da)for(let K=0,na=W.length;K<na;K++)B.a.uL(W[K].ssa,da)&&ta.push(K);this.zr=ta;this.Xzc(W)}else this.se=!1,this.qra=null}tya(){}DUg(W,da,ta){let K=Math.min(W,Math.max(200,ta));da&&W<ta&&(K+=X.a.xu);F.DOMElementExtensions.Jv(this.gg,K);da&&(K-=X.a.xu);return K}Zra(){super.Zra();var W=F.DOMElementExtensions.fk(this.get_element(),this.Xba),
da=this.zr.length>this.fI,ta=z.g(this.$);if(ta=ta.Vb(ta.ha.sa.activeCell))for(W=this.DUg(W.offsetWidth,da,ta.width),da=this.gg.getElementsByClassName(T.W_c),ta=0;ta<da.length;ta++)da[ta].style.maxWidth=U.HelperMethods.pc(W);else c.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")}onItemClick(W){if(W=super.onItemClick(W)){const da=z.g(this.$);da.Qo(!1);da.focus()}return W}}T.W_c=e.a.hth;Object(n.a)(T,"CellAutoCompleteListBox",
r.a,[]);var G=a(24),D=a(65),J=a(113),L=a(174),H=a(45),R=a(35),Q=a(250);r=a(19);a.d(C,"CellAutoCompleteControl",function(){return V});const O=`<div id='${k.S8f}' class='${e.a.Q9c} ${r.a.lp}' ></div>`;class V extends d.a{constructor(W,da){super(W);this.gDa=null;this.U_c=[];this.V5d=null;this.hec=this.rwa=!1;this.Cbe=this.uq=null;this.MKe=()=>{this.qY.IJa(this.items,this.gDa);this.raiseEvent("ACLBUpdated",new m.a(this.items.length));this.show()};this.tableManager=da;this.domElement.className=e.a.KNe;
this.domElement.innerHTML=O;F.DOMElementExtensions.setVisible(this.domElement,!1);Q.d(this.style,this.$.isChromeRtl);this.Nef=x.EwaSettings.ll();this.qye=$get(k.S8f,this.domElement);this.qY=new T(this.$,this.qye,this);this.yTa(!0);this.$.domElement.appendChild(this.domElement);this.Gob(W,J.a(W));this.Gob(W,z.g(W).Xb);this.Nef||this.$.da.Ga(1,this);this.Tfi=x.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1)}SZb(W){this.addHandler("ACLBUpdated",W)}otc(W){this.removeHandler("ACLBUpdated",
W)}r2(W){this.addHandler("ACLBSelectionChanged",W)}oda(W){this.removeHandler("ACLBSelectionChanged",W)}QGg(W){this.addHandler("ACLBMatchedItem",W)}Rbj(W){this.removeHandler("ACLBMatchedItem",W)}get Zt(){return this.qY}get t1a(){return this.gDa}get fe(){return this.qY.fe}get items(){return this.uq}get XNa(){return this.Cbe}get activeCell(){return z.g(this.$).ha.sa.activeCell}get dataValidationControl(){return this.V5d||(this.V5d=this.$.da.za(14))}f8f(W){for(let da=0;da<W.length;da++){const ta=W.charCodeAt(da);
if(x.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?B.a.isLetter(ta):B.a.Bpd(ta))return!0}return!1}hxa(){return!this.items}dispose(){if(this.$){this.yTa(!1);const W=z.g(this.$);W&&W.view.Zq(this.Pnc)}b.a.qc([this.qY,this.XNa]);b.a.qc(this.U_c);this.U_c=this.qye=this.qY=this.Ya=null;super.dispose()}Yh(W,da){let ta=!1;if(this.Zwj())switch(da){case -798660877:if(1===this.items.length&&this.fe)break;this.Zt.vB(1);this.raiseEvent("ACLBSelectionChanged",
new m.a(this.items.length,this.qcc(this.fe),this.fe));ta=this.Vy(!1);break;case 137938150:if(1===this.items.length&&this.fe)break;this.Zt.vB(-1);this.raiseEvent("ACLBSelectionChanged",new m.a(this.items.length,this.qcc(this.fe),this.fe));ta=this.Vy(!1);break;case 2091832999:this.Zt.vB(this.fI-1);ta=this.Vy(!1);break;case 742457698:this.Zt.vB(-(this.fI-1));ta=this.Vy(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.se=!1;ta=!0;break;case 267796030:this.Vy(!0);break;default:ta=
super.Yh(W,da)}return ta}show(){this.items&&this.items.length&&(this.qY.Lj=this.fe?this.Zt.zn.rows[this.qcc(this.fe)]:null,this.se=0<this.qY.zr.length,this.SBa(!0),this.qY.tya())}dNg(W){const da=!!this.Ya&&!D.f(this.$.oa);this.hec=this.rwa=!1;this.Ya&&!this.Ya.eb?this.set_visible(!1):da&&!this.Kch(this.activeCell)&&this.GAj(W)}Kch(W){return!!this.dataValidationControl&&this.dataValidationControl.A7c(W)}Vy(W){if(!this.Ya||!this.se)return!1;const da=this.gDa;if(this.fe){var ta=F.DOMElementExtensions.cZ(F.DOMElementExtensions.fk(this.qY.Lj,
T.W_c),l.a.Oqe,"");const K=ta.substring(da.length,ta.length);W?this.Ya.text=ta:this.Ya.insertTextAt(K,da.length,this.Ya.text.length)}ta=z.g(this.$);ta.tm&&(ta=ta.Xb,ta.text=this.Ya.text,ta.setCaretPosition(this.Ya.textBox.caretPosition));W?this.se=!1:this.Ya.textBox.selectRange(da.length,this.Ya.text.length);return!0}qcc(W,da=!1){if(!this.qY.zn)return-1;const ta=this.qY.zn.children[0],K=ta.children.length;let na;for(let P=0;P<K;++P)if(na=ta.children[P],B.a.equals(na.innerText.trim(),W,da))return P;
return-1}TBg(W,da,ta,K,na,P,ka){const pa=ta.originalText.replace(V.Etf,String.fromCharCode(32)),Na=new G.Range(W.top-1,W.left,W.bottom-1,W.right,!1,!1),Z=ka?ka.qn(ta.range):null;(!ta.QH||ta.range.left===W.left)&&1<pa.length&&!K.lb(pa.toUpperCase())&&B.a.uL(pa,da)&&!B.a.equals(pa,da,!0)&&!V.BUe(da)&&this.f8f(pa)&&(!na&&!Z||!na&&Z.equals(ka.qn(Na))||na&&ta.range.Bd(P)&&ta.range.top!==P.top)&&(W=ta.formulaBarText,B.a.equals(W,ta.text,!1)||!W)&&(W={},W.FirstRow=ta.range.top-1,W.FirstColumn=ta.range.left-
1,ta=new u(pa,W),K.add(pa.toUpperCase(),ta))}GAj(W){this.uq=this.UYh();this.XNa&&this.XNa.cancel();0<this.Ya.text.length&&0!==W?this.items&&((1<this.items.length||this.se)&&this.sjh(),8!==W&&127!==W&&46!==W&&(1===this.items.length?this.wld(!1):this.qY.Lj&&this.Vy(!1))):this.se=!1}sjh(){this.se?this.MKe():this.Cbe=L.AsyncMethodContext.yr(this.MKe,500,H.a.LWg,this.XNa)}wld(W){c.ULS.shipAssertTag(537167966,0,!this.hxa()&&1===this.items.length,"Invalid Items");let da=this.items[0].ssa,ta=this.Ya.text,
K=da.substring(ta.length,da.length);if(W&&!K.length)this.Ya.text=da;else if(!W&&0<K.length)this.Ya.appendText(K),this.Ya.textBox.selectRange(ta.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new m.a(this.items.length,0,da));this.rwa=!0}UYh(){this.uq=null;const W=new R.a(!1);var da=this.activeCell;this.gDa=this.Ya.text.replace(V.Etf,String.fromCharCode(32));const ta=this.tableManager.qn(da),K=da.Bd(ta);if(V.BUe(this.gDa)||!this.f8f(this.gDa))return this.items;const na=new G.Range(1,
da.left,da.top-1,da.left,!1,!1);var P=new G.Range(da.top+1,da.left,f.a.eh,da.left,!1,!1);let ka;const pa=z.g(this.$);P=pa.uk("CellAutoCompleteControl.GetSuggestedCells",P);try{const Na=pa.uk("CellAutoCompleteControl.GetSuggestedCells2",na);try{for(const Z of[Na,P])for(;Z.$$mn();)ka=Z.$$cu(),this.TBg(da,this.gDa,ka,W,K,ta,this.tableManager)}finally{Na&&Na.dispose()}}finally{P&&P.dispose()}this.uq=Array(W.values.length);for(da=0;da<this.items.length;da++)this.items[da]=W.values[da];this.items.sort((Na,
Z)=>Na.ssa.localeCompare(Z.ssa));return this.items}Gob(W,da){W&&da&&this.U_c.push(new A(W,da,this.Nef?this:void 0))}Zwj(){return this.Tfi?this.t1a&&!this.hxa()&&this.se?this.get_visible():!1:this.t1a&&!this.hxa()&&this.get_visible()&&this.se}static get Etf(){return V.hde||(V.hde=new RegExp(String.fromCharCode(160),"g"))}static BUe(W){W=0<W.length?W.charCodeAt(0):-1;return 35===W||61===W||43===W||45===W||64===W}}V.hde=null;Object(n.a)(V,"CellAutoCompleteControl",d.a,[603,600,604,10])},1221:function(n,
C,a){n=a(0);var c=a(569),b=a(564),d=a(561),f=a(1001);class e{i$g(F,U){if(F&&!(1>F.length)&&U){var X=Object.assign(new d.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.F7g(F,X.ControlList);U.push(X)}}F7g(F,U){const X=Object.assign(new c.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new b.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(U,X);U=Object.assign(new d.a,{Title:"",ControlList:[]});
Array.add(X.Menu.MenuSectionList,U);this.O9g(F,U.ControlList)}O9g(F,U){for(let X=0;X<F.length;X++){const T=Object.assign(new f.a,{ExternalId:String.format("CoauthorPersona_{0}",X),Command:"336231556",DisplayName:F[X].userName,LabelText:F[X].userName,ImageBackColor:F[X].color,PersonaId:F[X].email,IsAnonymous:F[X].isAnonymous});Array.add(U,T)}}}Object(n.a)(e,"PresenceContextMenuSectionBuilder",null,[527]);var k=a(84),l=a(4),m=a(177),u=a(562),t=a(107),w=a(134),r=a(86),v=a(83),y=a(106),x=a(25);class B{constructor(F,
U,X,T){this.X3d=this.i1=this.Yi=this.iE=this.k8=null;this.iXb=F;this.wxg=T;this.iXb.rMa&&(this.Yi=new t.a(3,2,5E3,Object(k.a)(this,this.fOg,"authenticationCheckTask"),2),l.AFrameworkApplication.Hi.Fg(this.Yi),this.Ig(U,X));this.iXb.qnb(()=>{this.Gvf()});this.iXb.aZa(()=>{this.Hvf()})}get businessBar(){return this.i1||(this.i1=v.a.instance.yh("CommonUI.IBusinessBar"))}get gwe(){return this.X3d||(this.X3d=v.a.instance.yh("CommonUI.IBusinessBarEntryFactory"))}Ig(F,U){const X=l.AFrameworkApplication.vb;
X.Le(x.a.authenticationLost,y.a.frame,F,96);X.Le(x.a.due,y.a.frame,U,96);X.Nb(x.a.Yxe,y.a.frame,m.ActionManager.t7c);X.Nb(x.a.Zxe,y.a.frame,m.ActionManager.t7c);X.Nb(x.a.Otd,y.a.frame,m.ActionManager.t7c)}Gvf(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);l.AFrameworkApplication.vb.processAction(x.a.authenticationLost,2)}Hvf(){this.nIj();l.AFrameworkApplication.vb.processAction(x.a.due,2)}fOg(){this.iXb.authenticationCheck()}nIj(){this.iE&&(this.iE.hide(),this.iE.dispose(),this.iE=
null);this.k8&&this.businessBar&&(l.AFrameworkApplication.Qg||this.businessBar.removeEntry(this.k8),this.k8.dispose(),this.k8=null)}showDialog(F){r.a.Ia(this.iE);this.iE=new w.StandardDialog;this.wxg||(this.iE.ut=!1,this.iE.Rb=0);this.iE.rc(1,CommonUIStrings.l_SignIn);this.iE.JW(CommonUIStrings.l_DefaultDialogTitle,F,Object(k.a)(this,this.iw,"dialogHandler"))}iw(F){1===F?(u.a.A6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),l.AFrameworkApplication.vb.processAction(x.a.Otd,
2)):(this.VSd(),l.AFrameworkApplication.vb.processAction(x.a.Zxe,2))}VSd(){this.businessBar&&this.gwe&&(this.k8=this.gwe.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.k8.closeable=!0,this.k8.addButton(CommonUIStrings.l_SignIn,B.zTg,""),this.k8.w$=Object(k.a)(this,this.CTg,"businessBarEntryCloseHandler"),this.businessBar.qC(this.k8,!1))}CTg(){this.Pgh();l.AFrameworkApplication.vb.processAction(x.a.Yxe,2)}Pgh(){this.Yi&&(l.AFrameworkApplication.Hi.jp(this.Yi),
this.Yi=null)}dispose(){this.Yi=this.iE=this.k8=null}static zTg(){u.a.A6();l.AFrameworkApplication.vb.processAction(x.a.Otd,2)}}Object(n.a)(B,"SignOutResponseUI",null,[10]);var z=a(247);class A{get name(){return"Common.App.UI"}Wh(F){F.register(e,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").wc()}init(){}dispose(){r.a.Ia(A.T1);A.T1=null}static main(){z.a.instance.Gi(new A)}}A.T1=null;Object(n.a)(A,"CommonAppUIPackage",null,[3,4]);a.d(C,"a",
function(){return I});const I=()=>{Type.registerNamespace("CAUI");A.main()}},1222:function(n,C,a){n=a(0);var c=a(222),b=a(1214),d=a(50),f=a(37),e=a(1),k=a(699);class l extends c.a{constructor(y){super();this.$=y;this.Eb()}create(){const y=this.$.da,x=d.GetServiceTaskFactory.create(y,134,this.la,this.fb),B=d.GetServiceTaskFactory.Sa(y,213,214,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([x,B],this.la),()=>{if(e.EwaSettings.ll())this.pb(Object(k.c)(this.$.da,1,()=>{const z=new b.CellAutoCompleteControl(this.$,
x.result);B.result.ka(z);return z}));else{let z=y.za(1);z||(z=new b.CellAutoCompleteControl(this.$,x.result),B.result.ka(z));this.pb(z)}},this.la,3)}static ka(y){y.da.Ga(151,new l(y))}}Object(n.a)(l,"CellAutoCompleteControlFactory",c.a,[]);var m=a(15),u=a(14);class t{constructor(y,x){this.k_a=null;this.DCf=(B,z)=>{1<z.length&&(B=u.a.instance.ga(862),this.ariaLiveNotifier.HNf(B,z.length))};this.ECf=(B,z)=>{m.ULS.shipAssertTag(537167961,0,0<=z.selectedIndex&&0<=z.length&&z.selectedIndex<z.length,"Invalid ListEventArgs: SelectedIndex/Length");
m.ULS.shipAssertTag(537167960,0,!!z.jG,"ListEventArgs: SelectedValue should not be null");this.ariaLiveNotifier.R5i(z.jG,z.selectedIndex+1,z.length)};this.FCf=(B,z)=>{this.ariaLiveNotifier.sQa(z.jG)};this.ariaLiveNotifier=y;e.EwaSettings.ll()||x.Ga(213,this)}dispose(){this.mZd();this.k_a=null}ka(y){y&&(this.k_a=y,y.SZb(this.DCf),y.r2(this.ECf),y.QGg(this.FCf))}mZd(){this.k_a&&(this.k_a.otc(this.DCf),this.k_a.oda(this.ECf),this.k_a.Rbj(this.FCf))}}Object(n.a)(t,"CellAutoCompleteReadoutHandler",null,
[696,10]);class w extends c.a{constructor(y){super();this.$=y;this.Eb()}create(){const y=this.$.da;f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(y,211,212,this.fb),x=>{if(e.EwaSettings.ll())this.pb(Object(k.c)(y,213,()=>new t(x.result,y)));else{const B=y.za(213)||new t(x.result,y);this.pb(B)}},this.la,3)}static ka(y){y.da.Ga(214,new w(y))}}Object(n.a)(w,"CellAutoCompleteReadoutHandlerFactory",c.a,[]);var r=a(9);a.d(C,"a",function(){return v});const v=()=>{r.a.Fa(l.ka);r.a.Fa(w.ka)}},1223:function(n,
C,a){var c=a(9);n=a(0);var b=a(234),d=a(222),f=a(50),e=a(37),k=a(1),l=a(15),m=a(86),u=a(4),t=a(78),w=a(8),r=a(24),v=a(65),y=a(43),x=a(145),B=a(47),z=a(45),A=a(12),I=a(14),F=a(21),U=a(27),X=a(19),T=a(53);class G extends t.a{constructor(Q,O,V,W){super();this.isMac=U.a.isMac;this.Uwa=!1;this.$=Q;this.ariaLiveNotifier=W;this.uo=V.V4b(Q,null,O,X.a.dQe,T.a.Ue(9),I.a.instance.ga(1738),"PulloutPointerDown")}Ldg(Q){this.Uwa!==Q&&(this.hide(),(this.Uwa=Q)?this.uo.Eeg(X.a.Wuh,T.a.Ue(3)):this.uo.Eeg(X.a.dQe,
T.a.Ue(9)))}get rz(){return this.uo.rz}get buttonWidth(){return this.uo.buttonWidth}dispose(){this.uo.dispose();this.$=null;super.dispose()}domElement(Q){return this.uo.domElement(Q)}getButton(Q){return this.uo.getButton(Q,!1)}APb(Q,O){this.uo.APb(Q,O,!1)}XAa(Q,O){const V=F.g(this.$),W=V.ib.Oi(Q);this.uo.APb(this.Uwa?I.a.instance.ga(1740):O?I.a.instance.ga(1738):I.a.instance.ga(1739),W);O=this.isMac?O?I.a.instance.ga(1743):I.a.instance.ga(1744):O?I.a.instance.ga(1741):I.a.instance.ga(1742);var da=
V.dg(Q,W);Q=V.Hf(W).wm;if(da&&0<=da.x&&0<=da.y){const ta=da.bottomRight.x+this.rz;da=da.topLeft.y-this.rz-this.buttonWidth;if(da<Q.topLeft.y+this.rz){if(V.ib.cUa){this.hide();return}da=Q.topLeft.y+this.rz}this.Jp(ta,da,V.rtl,W);this.ariaLiveNotifier.sQa(O)}else this.hide()}Jp(Q,O,V,W){this.uo.Jp(Q,O,V,W,!1)}hide(){this.uo.hide()}}Object(n.a)(G,"PulloutLaunchButton",t.a,[]);var D=a(33),J=a(22);class L extends t.a{constructor(Q,O,V,W,da){super();this.XXa=this.kOc=this.zvc=this.IFa=this.PR=this.NO=null;
this.yfe=0;this.ECb=this.lzb=this.ZEc=!1;this.Dg=()=>{this.Kwa&&(this.gridView?1===this.gridView.ha.Me?(this.gridView.ha.sa.activeCell.equals(this.IFa)||this.qN||this.ay(),this.Bob.lq()):this.ay():l.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};this.qh=()=>{this.ay()};this.dd=()=>{this.HW()};this.Ec=()=>{this.ay()};this.gd=()=>{this.showCallout()};this.Qya=()=>{if(this.Ug.Xk&&this.Ug.Xk.length)if(this.yZc)this.Ug.Jti||(this.ZEc=this.Ug.Xk[0].BlockingDataForExpand),this.Ug.KOh&&
l.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),this.yfe=this.Ug.r5c&&this.Ug.hWe<this.Ug.r5c.left-1?this.Ug.r5c.left-1-this.Ug.hWe:-1,this.showCallout();else if(this.gridView.ha.sa.Bg){var ta=this.gridView.ha.sa.activeCell;if(ta&&this.PR){var K=this.tableManager.qn(ta);this.$Lc=!!K;const na=this.gridView.ha.sa.Xc;K=this.qN&&this.PR.Bd(K);const P=this.Fid&&!this.qN&&na.equals(this.selectedRange);K||P?(l.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),
this.E9b=!0,k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!this.qN&&this.tableManager.Gja(ta)?l.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.qN?this.Gh.XAa(this.PR,this.qN):this.Gh.XAa(na,this.qN):this.Gh.XAa(this.PR,this.qN),this.iuc())):l.ULS.shipAssertTag(537154138,0,
!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};this.gj=()=>{this.b7a()&&this.Gh.hide();1===this.gridView.ha.Me&&this.HW()};this.oR=()=>{const ta=this.gridView.ha.Me;this.gridView.ha.sa.activeCell&&1===ta&&this.HW()};this.At=()=>{if(k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(this.qN){if(this.PR&&this.IFa){var ta=this.tableManager.qn(this.IFa);ta&&1<ta.bottom-ta.top&&(--ta.bottom,this.gridView.f5(ta)&&this.Bob.lq())}}else this.gridView.ha.sa.Bg&&
this.gridView.f5(this.gridView.ha.sa.Xc)&&this.Bob.lq();else this.PR&&this.IFa&&this.qN&&(ta=this.tableManager.qn(this.IFa))&&1<ta.bottom-ta.top&&(--ta.bottom,this.gridView.f5(ta)&&this.Bob.lq())};this.HW=()=>{if(this.$&&this.gridView){if(this.E9b&&this.qN){const ta=this.gridView.ha.sa.activeCell;this.PR=this.kUe();const K=!!this.zvc&&this.zvc.contains(ta);if(this.PR&&(ta.equals(this.IFa)||K)){this.Gh.XAa(this.PR,this.qN);return}}this.E9b=!1;(this.PR=this.kUe())&&this.Hla&&this.gridView&&this.gridView.Ea.es(this.Hla)?
(this.yZc=!1,this.gZ()):(this.Ug.s_c(),this.Ug.W1b());this.E9b||this.Gh.hide()}};this.$=Q;this.tableManager=V;this.contextMenuManager=W;this.Gh=new G(Q,this.gd,O,da);this.Ug=O.Y3c(Q,V);this.E9b=this.yZc=!1;this.Fid=k.EwaSettings.ma(135);this.$Lc=!0;this.YDa=!1;this.gridView=F.g(this.$);this.gridView.Xb.Vk(this.qh);this.gridView.Uu(this.oR);this.$.kl(this.dd);this.$.sk(this.Ec);this.$.LA(this.gj);this.gridView.view.Xs(this.At);this.gridView.ha.uT(this.Dg);this.Bob=B.a.instance.create(this.HW,250,z.a.j2i);
l.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");this.Ug.KZb(this.Qya);D.a.mzb()&&(this.lzb=!0);this.HW();Q.da.Ga(261,this)}get nc(){return this.Gh.domElement(1)}get Hla(){return this.kOc}get selectedRange(){return this.XXa}get qN(){return this.$Lc}get Uwa(){return this.YDa}get vLf(){return this.yfe}get YBb(){const Q=this.Gh.domElement(this.Dea);return Q?A.DOMElementExtensions.isVisible(Q):!1}get Kwa(){return this.$.isEditMode&&k.EwaSettings.ma(135)?!(new x.a(this.$.xa)).wi:!1}get tJg(){return this.ZEc}get Dea(){return this.Hla?
this.gridView.ib.Oi(this.NO):1}dispose(){this.gridView&&(this.gridView.ha.IR(this.Dg),this.gridView.view.Zq(this.At),this.gridView.Xb&&this.gridView.Xb.Ak(this.qh));if(this.$){const Q=this.$;Q.Hl(this.dd);Q.Gl(this.Ec);Q.LD(this.gj);F.g(Q).xy(this.oR)}this.Ug&&this.Ug.gtc(this.Qya);m.a.Ia(this.Gh);this.Ug=this.$=this.gridView=this.Bob=this.Gh=null;super.dispose()}ay(){this.Gh.hide()}uda(){this.Gh?this.Gh.getButton(this.Dea).gcb():l.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")}xgj(){this.PR=
null}QKf(){this.Gh&&this.Gh.hide()}X_h(){if(!this.Fid||1!==this.selectedRange.width)return null;const Q=this.selectedRange.clone();for(;this.gridView.f5(Q);){Q.left+=1;Q.right+=1;if(!this.gridView.Hf(this.gridView.ib.Oi(Q)).mi.Ie(Q))break;if(!this.gridView.Ea.es(Q))continue;const O=this.gridView.uk("PulloutManager.GetValidatedRangeToFill",Q,2);try{if(L.yVj(O))return Q}finally{O&&O.dispose()}}return null}iuc(){this.Ug.icb()}showCallout(){this.Kwa&&(this.Ug.I6a?(this.Gh.getButton(this.Dea).MGb(),k.EwaSettings.ll()?
e.TaskExtensions.Aa(f.GetServiceTaskFactory.Sa(this.$.da,8,9,0),Q=>{this.n4f(Q.result)},this.$.la,3):this.n4f(this.contextMenuManager)):(this.yZc=!0,this.gZ()))}n4f(Q){Q.ced("tableFieldList").A0(null,this.Gh.domElement(this.Dea),this.Ug,null,!0);this.iuc()}kUe(){if(!this.Kwa||!this.gridView||this.gridView.ha.Qa.dc||!this.gridView.ha.sa.Bg)return null;var Q=this.gridView.ha.sa.activeCell,O=F.g(this.$).ib.Oi(Q);if(!Q)return null;this.IFa=Q.clone();var V=this.tableManager.qn(Q);this.$Lc=!!V;if(this.qN){this.Gh.APb(I.a.instance.ga(1738),
O);this.NO=L.Ngg(V);if(!this.NO)return null;Q=!1;O=({jY:Q}=this.tableManager.PDe(V,this.gridView)).returnValue||Q;this.ZEc=Q;if(O)return this.zvc=new r.Range(V.top,V.left,V.bottom,V.right,!1,!1),this.kOc=new r.Range(this.NO.top,this.NO.right+1,this.NO.top,this.NO.right+1,!1,!1),this.lzb&&(this.YDa=!1,this.Gh.Ldg(this.YDa)),this.NO}else if(this.Fid){this.XXa=this.gridView.ha.sa.Xc.clone();V=this.selectedRange.isSingle&&F.g(this.$).Fb.Sdf(this.selectedRange);const W=F.g(this.$).Fb.cNa(this.selectedRange);
this.lzb&&(this.YDa=V&&!W);this.Gh.APb(this.YDa?I.a.instance.ga(1740):I.a.instance.ga(1739),O);V&&!W&&!this.ECb&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:6253558_DatePulloutExperimentTrigger")&&J.a.equals(u.AFrameworkApplication.uiCulture,"en-us",!0)&&(u.AFrameworkApplication.cI("XLS-DateSuggestionV2-Treatment;XLS-DateSuggestionV2-Control"),this.ECb=!0);this.NO=L.Ngg(this.selectedRange);if(!(this.lzb&&V||W)||!this.NO||!this.selectedRange||k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&this.tableManager.Gja(this.selectedRange))return null;this.kOc=this.X_h();if((k.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.f5(this.selectedRange):this.gridView.f5(this.NO))&&this.Hla)return this.lzb&&this.Gh.Ldg(this.YDa),this.zvc=this.NO,l.ULS.sendTraceTag(537154137,0,50,`PulloutManager:FindSelection, NextRange, ${this.Hla?this.Hla.toString():"null"}, RightColumnHeader, ${this.NO?this.NO.toString():"null"}, ActiveCell, ${Q?
Q.toString():"null"}`),this.NO}return null}gZ(){this.qN?this.Ug.gZ(y.v(this.Hla,this.$),!1,!0):this.YDa?this.Ug.iZi():k.EwaSettings.ma(135)&&this.Ug.gZ(y.v(this.selectedRange,this.$),!0,!1)}b7a(){return this.$.ea.isNamedObjectViewMode&&v.f(this.$.oa)}static yVj(Q){for(;Q.$$mn();)if(Q.$$cu().text||Q.$$cu().QH||Q.$$cu().vi||Q.Sn.j8e)return!1;return!0}static Ngg(Q){return Q.right===w.a.ph?null:new r.Range(Q.top,Q.right,Q.top,Q.right,!1,!1)}}Object(n.a)(L,"PulloutManager",t.a,[714,10]);class H extends d.a{constructor(Q){super();
this.$=Q;this.Eb()}create(){c.a.Fa(Q=>{const O=f.GetServiceTaskFactory.Sa(Q.da,12,477,this.fb),V=f.GetServiceTaskFactory.Sa(Q.da,66,134,this.fb),W=f.GetServiceTaskFactory.Sa(Q.da,211,212,this.fb);let da=b.a.Ta(null);const ta=!k.EwaSettings.ll();ta&&(da=f.GetServiceTaskFactory.Sa(Q.da,8,9,this.fb));e.TaskExtensions.Aa(e.TaskExtensions.Td([O,V,da,W],Q.la),()=>{ta?this.pb(this.$.da.za(261)||new L(this.$,O.result,V.result,da.result,W.result)):this.pb(this.$.da.za(261)||new L(this.$,O.result,V.result,
null,W.result))},Q.la)})}static ka(Q){Q.da.Ga(262,new H(Q))}}Object(n.a)(H,"PulloutManagerFactory",d.a,[]);a.d(C,"a",function(){return R});const R=()=>{c.a.Fa(Q=>{Q.ma(135)&&H.ka(Q)})}},1233:function(n,C,a){n=a(0);var c=a(187);class b{oHj(r,v){r.set_visible(!1);v.set_visible(!0)}}Object(n.a)(b,"DefaultTabSwitchBehaviour",null,[504]);class d{}d.$Hj="TabsContainer";d.LHj="TabTitlesContainer";d.JHj="TabTitle";d.KHj="TabTitleText";d.qWd="TabTitleActive";Object(n.a)(d,"MultitabControlStyles",null,[]);
var f=a(84),e=a(44),k=a(85),l=a(88),m=a(56);class u{constructor(r,v,y){this.nk=r;this.Pp=v;this.HGc=y;this.Bfa=document.createElement("a");m.a.Gwc(this.Bfa,this.Pp);Sys.UI.DomElement.addCssClass(this.Bfa,d.KHj);Sys.UI.DomElement.addCssClass(this.nk,d.JHj);this.nk.appendChild(this.Bfa);this.Bfa.tabIndex=0;this.XBc();e.a.addHandler(this.nk,"click",this.HGc);e.a.addHandler(this.nk,"keyup",Object(f.a)(this,this.D$a,"onTitleKeyUp"))}get nc(){return this.nk}get title(){return this.Pp}get isActive(){return Sys.UI.DomElement.containsCssClass(this.nk,
d.qWd)}set isActive(r){this.setActive(r)}dispose(){e.a.removeHandler(this.nk,"keyup",Object(f.a)(this,this.D$a,"onTitleKeyUp"));e.a.removeHandler(this.nk,"click",this.HGc);this.nk=this.Bfa=null}setActive(r){r?Sys.UI.DomElement.addCssClass(this.nk,d.qWd):Sys.UI.DomElement.removeCssClass(this.nk,d.qWd);this.Bfa&&this.Bfa.setAttribute(l.a.Zga,r)}D$a(r){r.keyCode!==k.a.fi&&r.keyCode!==k.a.Toa||this.HGc(r)}XBc(){this.nk.setAttribute(l.a.Kd,l.a.Zs);this.Bfa.setAttribute(l.a.Xt,this.Pp);this.Bfa.setAttribute(l.a.Kd,
l.a.tob)}}Object(n.a)(u,"TabTitleControl",null,[10]);var t=a(39);a.d(C,"a",function(){return w});class w{constructor(r,v=null,y=null){this.amb=this.imb=null;this.e1=-1;this.nk=r;this.oga=v||new c.a;this.vyg=y||new b;this.kFa=new c.a;r=0;for(let x of this.oga)this.msd(this.e1)||(this.e1=r),v=r++,this.kFa.add(new u(document.createElement("li"),x.title,this.r7g(v)))}get Zzc(){return this.oga.count}get activeTab(){return this.e1}set activeTab(r){this.n9f(r)}get nc(){return this.nk}get visible(){return t.a.isVisible(this.nk)}set visible(r){this.nk.style.visibility=
r?"visible":"hidden"}BSf(){this.imb=document.createElement("ul");this.imb.className=d.LHj;this.amb=document.createElement("div");this.amb.className=d.$Hj;for(let r=0;r<this.Zzc;++r){const v=this.oga.na(r),y=this.kFa.na(r);v.set_visible(!1);y.isActive=!1;const x=document.createElement("div");v.render(x);this.amb.appendChild(x);this.imb.appendChild(y.nc)}this.nc.appendChild(this.imb);this.nc.appendChild(this.amb);this.msd(this.e1)&&(this.kFa.na(this.e1).isActive=!0,this.oga.na(this.e1).set_visible(!0))}dispose(){for(let r=
0;r<this.Zzc;++r)this.oga.na(r).dispose(),this.kFa.na(r).dispose();this.kFa=this.oga=this.nk=this.amb=this.imb=null}setFocus(){this.oga.na(this.e1).setFocus()}msd(r){return 0<=r&&r<this.Zzc}n9f(r){this.e1!==r&&this.msd(r)&&(this.vyg.oHj(this.oga.na(this.e1),this.oga.na(r)),this.kFa.na(this.e1).isActive=!1,this.kFa.na(r).isActive=!0,this.e1=r,this.setFocus())}r7g(r){return()=>{this.n9f(r)}}}Object(n.a)(w,"MultitabControl",null,[487,10])},1245:function(n,C,a){var c=a(9);n=a(0);var b=a(7),d=a(222),f=
a(50),e=a(37);class k{constructor(){this.isFeedbackAllowed=!1;this.zoomLevel=0}}Object(n.a)(k,"FormulaAssistanceUIContext",null,[]);var l=a(184);class m extends d.a{constructor(t){super();this.Ykj="formulaAssistance";this.$=t;this.Eb()}create(){let t=this.$.da.za(448);if(t)this.pb(t);else{var w=f.GetServiceTaskFactory.Sa(this.$.da,283,284,this.fb);e.TaskExtensions.Aa(w,()=>{e.TaskExtensions.Aa(l.c(w.result.ko.loadScript(this.Ykj)),()=>{t=this.$.da.za(448);if(!t){const r=Object(b.a)(new k,{isFeedbackAllowed:this.$.isFeedbackEnabled});
t=this.$.da.Ga(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(r));this.$.ize(()=>{const v={};v.isFeedbackAllowed=this.$.isFeedbackEnabled;t.updateContext(v)})}this.pb(t)},this.$.la,3)},this.$.la,3)}}static ka(t){t.da.Ga(449,new m(t))}}Object(n.a)(m,"FormulaAssistanceUIControlFactory",d.a,[]);a.d(C,"a",function(){return u});const u=()=>{c.a.Fa(t=>{m.ka(t)})}},1246:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(50),f=a(37),e=a(21),k=a(15),l=a(31),m=a(211),u=a(24),t=a(65),w=a(1),r=
a(1087),v=a(11);class y{constructor(z,A){this.MNa=1;this.Aga=[];this.active=!1;this.Hw=()=>{const I=this.gridView.Ohd();if(!(0>=I||I===this.MNa||this.gridView.dr)){var F=!1,U=[],X=[];for(var T=this.Aga.length-1;0<=T;T--){var G=this.Aga[T];if(this.Nhd(G)>I||G.bottom<I)U.push(G),this.Aga.splice(T,1),F=!0}for(T=this.tableManager.rangeList.length-1;0<=T;T--){G=this.tableManager.rangeList[T];var D=this.Nhd(G);D<=I&&G.bottom>=I&&!(D<=this.MNa&&G.bottom>=this.MNa)&&G.aba&&(X.push(G),F=!0)}if(F){G=this.gridView.Kpc;
for(let L of G)for(let H of L)for(let R of H){T=R.$n;D=r.a(R.v4);for(var J=U.length-1;0<=J;J--)G=U[J],this.OAc(G,!1,D,T)&&U.splice(J,1);for(J=X.length-1;0<=J;J--)G=X[J],this.OAc(G,!0,D,T)&&this.Aga.push(G);F&&R.ZPd(D)}}else k.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");this.MNa=I}};this.Lzf=(I,F)=>{F.isRow||F.cWc(this.zLa)};this.Mzf=(I,F)=>{F.isRow||(this.tableManager.rangeList.length||this.deactivate(),F.SKd(this.zLa))};this.zLa=
(I,F)=>{if(this.Wd())this.activate();else if(I=this.active,this.deactivate(),!I){k.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(F=F.ku)&&this.C6f(F.$n[0],F.$n[F.$n.length-1],F.v4,F.$n)};this.xCf=(I,F)=>{!this.gridView.dr&&(this.Wd()?this.activate():(I=this.active,this.deactivate(),I||k.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),F=F.ku)&&
(I=r.a(F.v4),this.C6f(F.$n[0],F.$n[F.$n.length-1],I,F.$n)&&F.ZPd(I))};this.te=()=>{this.gridView.ib.s4?this.deactivate():this.activate()};this.tableManager=z;this.gridView=A;this.$=A.$;z.ipe(this.xCf);A.yGg(this.Lzf);A.zGg(this.Mzf);this.$.xa.Qf(this.te);this.$.Ab.Qf(this.te);this.Kse(I=>{I.cWc(this.zLa)});this.Wd()&&(this.activate(),this.Hw(this,null));this.$.da.Ga(68,this)}dispose(){this.deactivate();this.gridView&&(this.tableManager.fSf(this.xCf),this.gridView.Fbj(this.Lzf),this.gridView.Gbj(this.Mzf),
this.$.xa.Eg(this.te),this.$.Ab.Eg(this.te),this.Kse(z=>{z.SKd(this.zLa)}));this.gridView=this.tableManager=this.Aga=null}OAc(z,A,I,F){if(!t.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.ib.cUa)return!0;if(!I.length)return!1;var U=F.length;if(F[U-1]<z.left)return!1;var X=v.HelperMethods.wx(new m.a(F),0,U,z.left,v.HelperMethods.sD);if(0>X)return!1;const T=z.aag,G=!!z.O_a&&0<z.O_a.length,D=!!z.menuModel&&0<z.menuModel.length;for(let L=X,H=0,R=Math.min(T.length+X,U);L<R;L++,H++)if(U=I[L],
!w.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||U){X=null;var J=U.getElementsByClassName(l.a.E$c);J&&(X=J[0]);if(X&&X.innerText){if(J=U.getElementsByClassName(l.a.qqe))for(let Q=J.length-1;0<=Q;Q--)U.removeChild(J[Q]);J=F[L];A?(X.innerText=T[H],U.classList.add(l.a.yRe),G&&z.O_a[H]&&(X=document.createElement("div"),X.innerHTML=z.O_a[H],D&&z.menuModel[H]&&this.eDg(z,H,J),U.appendChild(X.firstChild))):(U.classList.remove(l.a.yRe),X.textContent=u.Range.QP(J),
this.tjh(J))}}z.hTa=A;return!0}eDg(z,A,I){this.$.da.Za(8,F=>{F.M9b.QMi(z,A,I)})}tjh(z){this.$.da.Za(8,A=>{A.M9b.RMi(z)})}C6f(z,A,I,F){let U=!1;const X=this.w_h(z,A);for(let T=this.Aga.length-1;0<=T;T--){const G=this.Aga[T];A>=G.left&&z<=G.right&&(this.OAc(G,!1,I,F),this.Aga.splice(T,1),U=!0)}for(let T=0,G=X.length;T<G;T++)this.OAc(X[T],!0,I,F)&&(this.Aga.push(X[T]),U=!0);return U}activate(){this.Wd()&&!this.active&&(this.gridView.view.Xs(this.Hw),this.active=!0)}deactivate(){this.active&&(this.gridView.view.Zq(this.Hw),
this.active=!1)}Wd(){return t.b(this.$.oa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.ib.HL&&0<this.tableManager.rangeList.length}Kse(z){const A=this.gridView.Kpc;for(let I of A)for(let F of I)for(let U of F)z(U)}w_h(z,A){const I=[];if(!this.active)return I;this.MNa=this.gridView.Ohd();for(let F=this.tableManager.rangeList.length-1;0<=F;F--){const U=this.tableManager.rangeList[F];U.bottom>=this.MNa&&this.Nhd(U)<=this.MNa&&U.left>=z&&U.right<=A&&U.aba&&I.push(U)}return I}Nhd(z){const A=this.gridView.Fb.hk(z);
return A&&this.tableManager.fff(z,A.usedRange.topLeft)?z.top+1:z.top}}Object(n.a)(y,"HeaderSnappingFeature",null,[10]);class x extends b.a{constructor(z){super();this.$=z;this.Eb()}create(){const z=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([z],this.la),()=>{this.pb(this.$.da.za(68)||new y(z.result,e.g(this.$)))},this.la,11)}static ka(z){z.da.Ga(67,new x(z))}}Object(n.a)(x,"HeaderSnappingFactory",b.a,[]);a.d(C,"a",function(){return B});const B=
()=>{c.a.Fa(x.ka)}},1270:function(n,C,a){var c=a(9);n=a(0);var b=a(15),d=a(875),f=a(27),e=a(195),k=a(222),l=a(226),m=a(1),u=a(51),t=a(55),w=a(184),r=a(33);class v{constructor(){this._list={}}addHandler(A,I){var F;this._list[A]=[...(null!==(F=this._list[A])&&void 0!==F?F:[]),I]}removeHandler(A,I){const F=this._list[A];void 0!==F&&(I=F.indexOf(I),0<=I&&(this._list[A]=[...F.slice(0,I),...F.slice(I+1)]))}getHandler(A){const I=this._list[A];return I&&0!==I.length?(F,U)=>{for(const X of I)X(F,U)}:null}static qJb(){Sys.EventHandlerList.prototype.addHandler=
v.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=v.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=v.prototype.removeHandler}}Object(n.a)(v,"EventHandlerListOptimized",null,[]);class y{constructor(){this._list={}}addHandler(A,I){this.invalidate(A);void 0===this._list[A]?this._list[A]=[I]:this._list[A].push(I)}invalidate(A){void 0!==this.tA&&this.tA.delete(A)}removeHandler(A,I){const F=this._list[A];void 0!==F&&0!==F.length&&(I=F.indexOf(I),0<=I&&(this.invalidate(A),
F.splice(I,1)))}getHandler(A){void 0===this.tA&&(this.tA=new Map);var I=this.tA.get(A);return void 0===I?(I=this.makeHandler(A),this.tA.set(A,I),I):I}makeHandler(A){A=this._list[A];if(!A||0===A.length)return null;const I=[...A];return(F,U)=>{for(let X=0;X<I.length;++X)I[X](F,U)}}static qJb(){Sys.EventHandlerList.prototype.addHandler=y.prototype.addHandler;Sys.EventHandlerList.prototype.getHandler=y.prototype.getHandler;Sys.EventHandlerList.prototype.removeHandler=y.prototype.removeHandler;Sys.EventHandlerList.prototype.makeHandler=
y.prototype.makeHandler;Sys.EventHandlerList.prototype.invalidate=y.prototype.invalidate}}Object(n.a)(y,"EventHandlerListMemoized",null,[]);class x{constructor(A){this.a=A;this.preventDefault=x.LGf.preventDefault;this.stopPropagation=x.LGf.stopPropagation;const I=this.type=A.type.toLowerCase();this.rawEvent=A;this.altKey=A.altKey;"undefined"!==typeof A.button&&(this.button="undefined"!==typeof A.which?A.button:4===A.button?Sys.UI.MouseButton.middleButton:2===A.button?Sys.UI.MouseButton.rightButton:
Sys.UI.MouseButton.leftButton);"keypress"===I?this.charCode=A.charCode||A.keyCode:this.keyCode=A.keyCode&&46===A.keyCode?127:A.keyCode;this.clientX=A.clientX;this.clientY=A.clientY;this.ctrlKey=A.ctrlKey;this.target=A.target?A.target:A.srcElement;this.screenX=A.screenX;this.screenY=A.screenY;this.shiftKey=A.shiftKey}get offsetX(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetX)return this.rawEvent.offsetX;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientX){const A=
Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageXOffset||0)+this.clientX-A.x}}}get offsetY(){if(!this.type.startsWith("key")){if(void 0!==this.rawEvent.offsetY)return this.rawEvent.offsetY;if(this.target&&3!==this.target.nodeType&&"number"===typeof this.clientY){const A=Sys.UI.DomElement.getLocation(this.target);return(Sys.UI.DomElement._getWindow(this.target).pageYOffset||0)+this.clientY-A.y}}}static qJb(){Sys.UI.DomEvent=x;x.registerClass("Sys.UI.DomEvent",
void 0,void 0)}}x.addHandler=Sys.UI.DomEvent.addHandler;x.addHandlers=Sys.UI.DomEvent.addHandlers;x.removeHandler=Sys.UI.DomEvent.removeHandler;x.clearHandlers=Sys.UI.DomEvent.clearHandlers;x._removeHandler=Sys.UI.DomEvent._removeHandler;x._clearHandlers=Sys.UI.DomEvent._clearHandlers;x._disposeHandlers=Sys.UI.DomEvent._disposeHandlers;x.LGf=Sys.UI.DomEvent.prototype;x.registerClass=function(A,I,F){this.prototype.constructor=this;this.__typeName=A;this.__class=!0;I&&(this.__baseType=I,this.__basePrototypePending=
!0);Sys.__upperCaseTypes[A.toUpperCase()]=this;if(F){this.__interfaces=[];for(let U=2,X=arguments.length;U<X;U++)this.__interfaces.push(arguments[U])}return this};Object(n.a)(x,"DomEventLazy",null,[560]);class B extends k.a{constructor(A){super();this.$=A;this.X4b=null;this.Eb()}create(){b.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");d.a.then(this.W9g(),A=>{this.pb(A)})}W9g(){if(this.X4b)return this.X4b;const A=l.a.p1a(u.b(),e.a.none,"LoadResource","x10Scheduler loading");
if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNativeStartsWithEndsWith",!1)){var I=String.prototype;if(void 0===I.startsWithOriginal||void 0===I.endsWithOriginal)if(m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RetrieveOriginalStringUsingIFrameHack",!1)){const F=document.createElement("frame");document.body.appendChild(F);const U=F.contentWindow.String.prototype;document.body.removeChild(F);I.startsWithOriginal=U.startsWith;I.endsWithOriginal=U.endsWith}else I.startsWithOriginal=
function(F,U=0){return this.lastIndexOf(F,U)===U},I.endsWithOriginal=function(F){return-1!==this.indexOf(F,this.length-F.length)};I.startsWith=I.startsWithOriginal;I.endsWith=I.endsWithOriginal}m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseImmutableHandlers",!1)&&v.qJb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMemoizedHandlers",!1)&&y.qJb();m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseLazyDomEvent",!1)&&x.qJb();if(m.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&
f.a.tv)return I=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance(),this.$.da.Ga(413,I),A.setResult(I),this.X4b=A.task;this.$.da.Za(266,()=>{this.$.da.Za(283,F=>{const U=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();F=w.b(t.Task.Ta(F.ko));Promise.all([excelOnlineCalc.x10.ensureGroupAttached(F,0),r.a.Rte(this.$)?excelOnlineCalc.x10.ensureGroupAttached(F,2):0]).then(X=>X.some(T=>0<T)).then(X=>{this.$.da.Ga(413,U);A.setResult(U);m.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",
0)&&this.$.da.Za(491,T=>{T.l7.anyPluginInitialized=X})})})});return this.X4b=A.task}static ka(A){A.da.Ga(414,new B(A))}}Object(n.a)(B,"PluginSchedulerFactory",k.a,[]);a.d(C,"a",function(){return z});const z=()=>{c.a.Fa(A=>{B.ka(A)})}},1433:function(n,C,a){a.r(C);var c=a(1078),b=a(0),d=a(694),f=a(15),e=a(178),k=a(61);const l=(wb,qc,Ya,xb,wc,Oc,Cb,Ib,fc,vc)=>{vc=wb.Na(9,vc);vc.selectedRange=qc;vc.activeCell=Ya;vc.autoSumType=xb;vc.topLeftCell=wc;return k.g(wb,"AutoSum",vc,Oc,Cb,Ib,fc,0)},m=(wb,qc,Ya,
xb,wc,Oc)=>{if(qc){const Cb=wb.textBox;wb.eb||wb.startEdit(qc,!0);wb.xqd=!0;wb.text=Ya;Cb.caretPosition=wc;wc<Oc&&(xb&&wb.gBa(),Cb.selectRange(0,Oc+1),Cb.selectRange(wc,Oc))}};var u=a(77);class t{constructor(wb,qc){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=wb;this.type=qc}P4a(){return this.sharedSheetRange}}Object(b.a)(t,"MacroRecorderAutoSumPayload",null,[115]);var w=a(43),r=a(515),v=a(370),y=a(171),x=a(50),B=a(37),z=a(153),A=a(343),I=a(29),F=a(1),U=a(183),X=a(281),T=a(21),G=a(125),
D=a(566),J=a(55);class L extends e.a{constructor(wb){super();this.Kvf=qc=>{const Ya=T.g(this.$);if(qc=qc.Result){let xb=w.D(qc.NewSelection),wc=w.D(qc.NewActiveCell);if(xb&&wc)if(!qc.Committed&&qc.AutoSumFormula){const Oc=Ya.Vb(wc);Oc&&(Ya.ha.updateSelection(xb,wc,60),xb=wc=w.D(qc.MarkedArea),Ya.VJ=2,m(Ya.hc,Oc,qc.AutoSumFormula,!!xb,qc.FormulaMarkStart,qc.FormulaMarkEnd),xb&&wc&&Ya.ha.updateSelection(xb,wc,0),Ya.hc.xqd=!1,B.TaskExtensions.Aa(x.GetServiceTaskFactory.create(this.$.da,153,this.la,0),
Cb=>{Cb.result.eJa(null)},this.la,3))}else Ya.ha.updateSelection(xb,wc,60)}};this.$=wb}Lc(){return!1}executeCommand(wb,qc,Ya){wb=qc.command;switch(wb){case 1220954656:qc=this.VJe(0,qc);break;case -1537138325:qc=this.VJe(parseInt(Ya[u.a.Qc].toString(),10),qc);break;default:qc=U.a(wb)}return qc}Ac(wb,qc){if(wb=1===wb)switch(qc.command){case 1220954656:case -1537138325:break;default:wb=!1}return wb}Oc(){return!1}VJe(wb,qc){const Ya=T.g(this.$);Ya.Ff.eH(!1);if(!T.g(this.$).ha.sa.Bg)return qc=T.g(this.$).ha.sa.PK,
f.ULS.sendTraceTag(537170308,0,50,`AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type ${wb} due to discontinuous selection. Number of selected ranges is ${qc}`),this.wza(),J.Task.Ta(!1);const xb=Ya.EH();if(!xb)return null;const wc=w.v(Ya.ha.sa.Xc,this.$),Oc=w.o(Ya.ha.sa.activeCell,this.$),Cb=w.o(xb,this.$),Ib=this.$.pa.va.Tb(),fc=()=>new t(wc,wb);return this.$.Sp(Ya.ha.sa.selectedRanges,!0)?F.EwaSettings.$b()?v.a(this.$.userOperationManager,(vc,Cc,fd)=>l(this.$.pa.va,wc,Oc,wb,Cb,X.b(vc,this.Kvf),
Cc,fd,wb,Ib),vc=>new y.a(502,0,vc,64,fc),qc):v.a(this.$.userOperationManager,(vc,Cc,fd)=>l(this.$.pa.va,wc,Oc,wb,Cb,X.b(vc,this.Kvf),Cc,fd,wb,Ib),vc=>new r.a(502,0,vc,void 0,fc),qc):J.Task.Ta(!1)}wza(){D.a(G.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var wb=I.a.Yc(1,1,756,2190,0,371863010,"DiscontinuousSelectionBlocking");F.EwaSettings.Dz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.ig())}}Object(b.a)(L,"AutoSumCommandHandler",e.a,[164]);class H extends d.a{constructor(wb){super(wb)}vd(){this.$c([new L(this.$)])}static ka(wb){d.a.Od(96,
new H(wb))}}Object(b.a)(H,"AutoSumCommandHandlerFactory",d.a,[]);var R=a(9),Q=a(173),O=a(263),V=a(38),W=a(320),da=a(1079),ta=a(282),K=a(75);class na extends V.a{constructor(wb,qc,Ya){super();this.GHi=(xb,wc)=>{if(!ta.a(xb)&&wc){const Oc=!!xb&&!!xb.RequestTelemetryData;T.g(this.$).Pi.vla(wc.toString(),xb.StateId,Oc?xb.RequestTelemetryData.EcsOperationDuration:0,Oc?xb.RequestTelemetryData.EcsRequestDuration:0,Oc?xb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=wb;this.tableManager=qc;this.xg=
Ya}BFg(wb){this.addHandler("ekcvc",wb)}Qaj(wb){this.removeHandler("ekcvc",wb)}Lc(){return!1}executeCommand(wb,qc){wb=qc.command;switch(wb){case -730106152:qc=this.Mid(qc,3);break;case -1228228458:qc=this.Mid(qc,4);break;case -848953656:case 2045211913:if(this.dli()){qc=J.Task.Ta(!0);break}qc=this.Mid(qc,1);break;default:qc=U.a(wb)}return qc}Ac(wb,qc){if(wb=1===wb)switch(qc.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:wb=!1}return wb}Oc(){return!1}Mid(wb,
qc){var Ya=T.g(this.$);const xb=Ya.ha.sa.selectedRanges,wc=wb.command,Oc=Q.a.create().toString();if(!this.$.Sp(xb,!0)&&-730106152!==wc)return J.Task.Ta(!0);const Cb=w.r(xb,this.$);this.CAj(wc,Ya,xb,Oc);F.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.q3i();const Ib=this.$.pa.va.Tb({j_:!0,AZ:1});Ya=(vc,Cc,fd)=>{this.$.Ay();return k.d(this.$.pa.va,qc,Cb,!1,X.b(vc,this.GHi),Cc,fd,Oc,Ib)};const fc=()=>new da.a(qc,Cb);return F.EwaSettings.$b()?v.a(this.$.userOperationManager,
Ya,vc=>new y.a(508,0,vc,67,fc),wb):v.a(this.$.userOperationManager,Ya,vc=>new r.a(508,0,vc,3,fc),wb)}CAj(wb,qc,Ya,xb){if(-848953656!==wb&&2045211913!==wb&&-730106152!==wb&&-1228228458!==wb)f.ULS.sendTraceTag(537167938,0,10,`ClearCommandHandler.ShowInstantaneousClear: Unexpected command ${wb}.`);else if(!O.a.any(Ya,Oc=>0<qc.getRangeInformation(Oc).length)){var wc=O.a.any(Ya,Oc=>this.tableManager.Mrd(Oc));if(-730106152!==wb&&-1228228458!==wb||!wc)this.xEj(qc,wb,xb,Ya),-730106152!==wb&&-1228228458!==
wb||this.xg.Vda(qc,-730106152,{}),-1228228458!==wb&&2045211913!==wb&&-848953656!==wb||this.xg.BZg(Ya,xb),qc.Pi.D0(xb,K.BasicTelemetryCalculator.NQ)}}xEj(wb,qc,Ya,xb){let wc="";switch(qc){case -1228228458:wc="ClearAll";break;case 2045211913:case -848953656:wc="ClearContent";break;case -730106152:wc="ClearFormat";break;default:f.ULS.sendTraceTag(537167937,0,15,`ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command ${qc}.`)}qc=xb.length;xb=w.b(xb);wb.Pi.A7(15,Ya,wc+(", ranges to clear: "+
qc+", cells to clear: "+xb))}q3i(){this.raiseEvent("ekcvc",new W.a)}dli(){if(T.g(this.$).wz){const wb=this.$.da.za(296);return!!wb&&wb.uU.qB}return!1}}Object(b.a)(na,"ClearCommandHandler",V.a,[164,735]);class P extends d.a{constructor(wb){super(wb)}vd(){const wb=x.GetServiceTaskFactory.create(this.$.da,134,this.la,this.fb),qc=x.GetServiceTaskFactory.create(this.$.da,18,this.la,this.fb);B.TaskExtensions.Aa(B.TaskExtensions.Td([wb,qc],this.la),()=>{const Ya=new na(this.$,wb.result,qc.result);this.$c([Ya]);
this.$.da.Ga(313,Ya)},this.la,3)}static ka(wb){d.a.Od(101,new P(wb))}}Object(b.a)(P,"ClearCommandHandlerFactory",d.a,[]);var ka=a(1221),pa=a(1080),Na=a(1135),Z=a(1082),Ra=a(1083),Da=a(1147),Ba=a(86),ea=a(222),Y=a(4),ja=a(106),ca=a(44),ba=a(11),ua=a(84),wa=a(144);class ia{}ia.HTML='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(b.a)(ia,"FileUploadDialogHTML",null,[]);var xa=a(151),gb=a(25);class va extends wa.a{constructor(wb){super(!1,!1,va.Gu);this.fwd=!1;this.aqf=!0;this.hpf=0;this.Rb=1;this.rc(1,CommonUIStrings.l_Send);this.rc(0,CommonUIStrings.l_NoThanks);this.mg=ia.HTML;this.apf=wb;this.Ce=va.bUg}uj(wb,qc,Ya,xb=!1,wc=!0){this.fwd=xb;this.Mzj(qc);this.hpf=wb;wc&&Y.AFrameworkApplication.eG(wb)}Mzj(wb){if(va.Gu)this.uBj(wb);else{var qc={};qc[va.YTg]=wb;qc[va.dUg]=CommonUIStrings.l_SendFileErrorReportMessage;qc[va.eUg]=
CommonUIStrings.l_SendFileErrorReportTextCaption;qc[va.KZc]="";qc[va.aUg]=CommonUIStrings.l_UserReportLinkText;qc[va.B1b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ua.a)(this,this.ksi,"legacyDialogHandler"),qc);this.DW(va.jUg)}}uBj(wb){wb={["id"]:this.Ce,["bodyControls"]:{["reportErrorCheckboxProps"]:this.fwd?{["label"]:CommonUIStrings.l_UserReportLinkText}:null,["textAreaProps"]:this.aqf?{}:null,["privacyStatementLinkProps"]:{["text"]:CommonUIStrings.l_PrivacyStatement,
["handler"]:{["href"]:Y.AFrameworkApplication.Gma,["target"]:"_blank"}}},["errorMessage"]:wb,["errorReportMessage"]:CommonUIStrings.l_SendFileErrorReportMessage,["errorTextPrompt"]:CommonUIStrings.l_SendFileErrorReportTextCaption};this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(ua.a)(this,this.GHd,"reactDialogHandler"),wb)}h$a(){if(!va.Gu){var wb=document.getElementById(va.gUg);wb&&(wb.className=va.fUg,wb.appendChild(xa.createClusteredImage(32,32,va.cUg,null,!0,CommonUIStrings.l_DialogError)));
if(wb=document.getElementById(va.hUg))wb.innerText=CommonUIStrings.l_PrivacyStatement,wb.href=Y.AFrameworkApplication.Gma,ca.a.addHandler(wb,"click",Object(ua.a)(this,this.aQi,"onPrivacyClickHandler"));this.aqf||(wb=document.getElementById(va.KZc))&&wb.parentNode&&wb.parentNode.removeChild(wb);this.fwd||(wb=document.getElementById(va.$Tg))&&wb.parentNode&&wb.parentNode.removeChild(wb)}}HI(){va.Gu||(super.HI(),document.getElementById(this.ni("WACDialogPanel")).style.width=String.format("{0}px",400))}ksi(wb,
qc){const Ya=qc[va.KZc]||"";let xb=!0;void 0!==qc[va.B1b]&&null!==qc[va.B1b]&&(xb=qc[va.B1b]);this.iw(wb,Ya,xb)}GHd(wb,qc){this.iw(wb,qc.text||"",qc.reportErrorChecked)}iw(wb,qc,Ya){this.apf&&(Ya&&f.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.hpf),this.apf(wb,qc,Ya))}aQi(wb){Y.AFrameworkApplication.vb.de(gb.a.qHb,2,wb)}get nY(){return!1}static get Gu(){return Y.AFrameworkApplication.ta.Oa.vv&&Y.AFrameworkApplication.ta.Oa.Eli}}va.YTg="WACDialogErrorMessage";va.dUg="WACDialogErrorReportMessage";
va.eUg="WACDialogErrorTextPrompt";va.KZc="WACDialogInput";va.hUg="WACDialogPrivacyText";va.gUg="WACDialogIconPanel";va.cUg="CancelRequest_32x32x32";va.fUg="WACDialogIcon";va.jUg="WACDialogTextPanel";va.B1b="WACDialogSendFileCheckbox";va.$Tg="WACDialogSendFileCheckboxContainer";va.aUg="WACDialogSendFileCheckboxText";va.bUg="FileUploadErrorDialog";Object(b.a)(va,"FileUploadErrorDialog",wa.a,[]);class sa extends V.a{constructor(wb){super();this.iKf=0;this.oH=null;this.I$i=qc=>{this.Zaj(qc)};this.T_g=
(qc,Ya)=>{if(1===qc&&this.oH.FileCollectionErrorStateId){qc=this.$.pa.va;var xb=this.oH.MessageId,wc=this.oH.OriginalEcsServerId,Oc=this.oH.FileCollectionErrorStateId;const Cb=qc.Na(0);Cb.errorMessageId=xb;Cb.ecsServerId=wc;Cb.fileCollectionErrorStateId=Oc;Cb.userComment=Ya;qc.b_c("CollectFile",Cb,null,null,null,null,0)}this.raiseEvent("fileCollectionComplete",null,this)};this.$=wb}MFg(wb){this.addHandler("fileCollectionComplete",wb)}Zaj(wb){this.removeHandler("fileCollectionComplete",wb)}S_g(wb,
qc,Ya){this.iKf=qc;this.oH=wb;this.MFg(Ya);Y.AFrameworkApplication.Gma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;wb=new va(this.T_g);Y.AFrameworkApplication.vb.Nb(gb.a.qHb,ja.a.frame,sa.c1i);wb.uj(0,"",null,!1,!1)}static c1i(wb,qc,Ya,xb,wc){ca.a.au(wc);Y.AFrameworkApplication.Gma&&ba.HelperMethods.Ze(Y.AFrameworkApplication.Gma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32}}Object(b.a)(sa,"FileCollectionOperation",V.a,[728,10]);class ab extends ea.a{constructor(wb){super();
this.ZSb=null;this.$=wb;this.Eb()}get Szh(){return this.ZSb||(this.ZSb=new sa(this.$))}create(){B.TaskExtensions.Aa(x.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),()=>{this.pb(this.Szh)},this.la,3)}dispose(){Ba.a.Ia(this.ZSb);this.ZSb=null;super.dispose()}static ka(wb){wb.da.Ga(125,new ab(wb))}}Object(b.a)(ab,"FileCollectionCommandHandlerFactory",ea.a,[]);var Ua=a(1150),nb=a(1085),Ha=a(1245),sb=a(7),Qb=a(645);class mb{}Object(b.a)(mb,"FreezePanesCommandParameters",null,[]);var Pb=a(8),
gc=a(182),Xb=a(24),Ca=a(385),ra=a(28),ma=a(268),hb=a(270),vb=a(117);const Va=(wb,qc,Ya,xb,wc,Oc,Cb=null)=>{Cb=wb.Na(9,Cb);Cb.freezeSettings=qc;return k.g(wb,"FreezeOrUnfreezePanes",Cb,Ya,xb,wc,Oc,0)};class db{constructor(wb){this.freezeOptions=null;this.freezeOptions=wb}getSheetName(){return this.freezeOptions.SheetName}}Object(b.a)(db,"MacroRecorderSheetPaneFrozenPayload",null,[115]);var oa=a(42);class Oa{constructor(wb,qc){this.L$b=this.JGd=null;this.Uyf=()=>{F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",
!1)||this.kuc();if(this.L$b){const Ya=ma.a(ra.a.Pa.me,this.L$b);f.ULS.sendTraceTag(570949840,5,50,`FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: ${Ya}`);this.L$b=null}this.CGf()};this.$=wb;this.gridView=T.g(wb);this.oD=qc.Orb(this.$.domElement,500,null,null);this.gLa=this.fLa=-1}Lc(wb,qc){let Ya=!1;switch(qc){case 1844679312:Ya=1!==wb&&!this.gridView.ib.s4}return Ya}executeCommand(wb,qc){wb=this.gridView.ib;const Ya=this.gridView.eid();
Y.AFrameworkApplication.ta.Oa.ww&&this.$.UZ&&(1844679312===qc.command||340334732===qc.command||-806625837===qc.command)&&Qb.ShyRibbon.EJ(1,2);switch(qc.command){case 1844679312:return this.setFreezePanes(qc,Ya,wb.tj);case 340334732:return wb.f$b?J.Task.Ta(!1):this.Nqj(qc,Ya);case -806625837:return wb.cUa?J.Task.Ta(!1):this.Oqj(qc,Ya)}return J.Task.Ta(!1)}Ac(wb,qc){wb=!1;switch(qc.command){case 1844679312:case 340334732:case -806625837:case 1745254833:wb=!0}return wb}Oc(){return!1}setFreezePanes(wb,
qc,Ya){if(Ya)return this.Svc(wb,!1,0,0,0,0,qc,null);var xb=this.gridView.ha.sa;Ya=xb.activeCell.clone();xb=xb.activeRange;xb.gf&&(f.ULS.sendTraceTag(537159585,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top (${Ya.top}) and firstUnfreezeCell.Bottom (${Ya.bottom}) to equal topLeftRange.Top (${qc.top})`),Ya.top=Ya.bottom=qc.top);xb.isRow&&(f.ULS.sendTraceTag(537159584,0,50,`FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left (${Ya.left}) and firstUnfreezeCell.Right (${Ya.right}) to equal topLeftRange.Left (${qc.left})`),
Ya.left=Ya.right=qc.left);Ya.top===qc.top&&Ya.left===qc.left&&(Ya=Xb.Range.Uc(Ya.top+1,Ya.left));xb=Ya.top-1;const wc=Ya.left-1,Oc=xb-(qc.top-1),Cb=wc-(qc.left-1);return this.LVj(Ya,Oc,Cb)?this.Svc(wb,!0,xb,wc,Oc,Cb,qc,Ya):(this.$.$e(),this.CGf(),J.Task.Ta(!0))}Nqj(wb,qc){return this.Svc(wb,!0,0,qc.left,0,1,qc,null)}Oqj(wb,qc){return this.Svc(wb,!0,qc.top,0,1,0,qc,null)}LVj(wb,qc,Ya){const xb=this.gridView.dg(wb),wc=this.gridView.view.visibleArea;return!xb||wc.topLeft.y>xb.bottomRight.y||wc.topLeft.x>
xb.bottomRight.x||wc.bottomRight.y<xb.bottomRight.y||wc.bottomRight.x<xb.bottomRight.x?(f.ULS.sendTraceTag(537159583,0,50,`FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range=${wb}, rangeViewportArea=${xb?xb.toString():"null"}, visibleArea=${wc.toString()}`),wb=I.a.Yc(1,0,26,1493,0,2105967339,"FreezePaneSelectionNotInViewErr"),F.EwaSettings.Dz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.ig()),!1):0>=
qc&&0>=Ya?(f.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),wb=T.g(this.$).rtl?1495:1494,qc=T.g(this.$).rtl?-2131054257:-1953454131,wb=I.a.Yc(1,0,26,wb,0,qc,"FreezePaneA1SelectedErr"),F.EwaSettings.Dz()?new A.a(this.$,wb):(wb=new z.ErrorDialog(this.$,wb),wb.initialize(),wb.ig()),!1):!0}Svc(wb,qc,Ya,xb,wc,Oc,Cb,Ib){this.JGd=oa.a(this.$).B9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.sT(this.Uyf);this.oD.oTa();
this.gridView.aFj(qc?"":"UnsetFreezePane");this.ftj(wb,qc,this.gridView.ib);const fc=Object(sb.a)(new mb,{SheetName:this.$.oa.name,Freeze:qc,FrozenRows:wc,FrozenColumns:Oc,FirstRow:Ya,FirstColumn:xb});f.ULS.sendTraceTag(573101852,0,50,`FreezePanesCommandHandler.SendFreezePanesRequest: Freeze=${qc}, FrozenRows=${wc}, FrozenColumns=${Oc}, FirstRow=${Ya}, FirstColumn=${xb} `);const vc=()=>new db(fc);this.L$b=ra.a.Pa.me;return v.a(this.$.userOperationManager,(Cc,fd,od)=>{if(F.EwaSettings.ma(60)){var Ub=
window.performance;Ub.clearMarks();Ub.mark("FreezePanes request sent")}(Ub=this.gridView.Ts)?(Ub=this.hnh(fc,Ub,Cb,Ib),this.hMj(Ub)):this.$.Ay();return Va(this.$.pa.va,fc,Cc,fd,od,qc)},Cc=>new y.a(151,0,Cc,void 0,vc),wb)}hnh(wb,qc,Ya,xb){f.ULS.shipAssertTag(537159580,1,!!qc,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!wb.Freeze)return null;const wc=hb.a();wc.State=1;wc.IsEstimated=!0;let Oc=!1,Cb=!1;const Ib=qc.RU(Xb.Range.Uc(Ya.top,Ya.left));
let fc=wb.FrozenRows;var vc=wb.FrozenColumns;1!==wb.FrozenRows||wb.FrozenColumns?wb.FrozenRows||1!==wb.FrozenColumns?(vc=qc.RU(Xb.Range.Uc(wb.FirstRow+1,wb.FirstColumn+1)),qc=qc.RU(Xb.Range.Uc(Ya.top,Ya.left)),wc.Width=vc.yj-Ib.yj,wc.Height=vc.Kj-Ib.Kj,0<wb.FrozenRows&&(wc.AbsoluteTop=vc.Kj,Cb=!0),0<wb.FrozenColumns&&(wc.AbsoluteLeft=vc.yj,Oc=!0),fc=vc.AI-qc.AI,vc=vc.fH-qc.fH):(wc.Width=qc.Fgd(gc.a.Uc(Ya.top,Ya.left)),xb=Xb.Range.Uc(Ya.top,Ya.left+1),wc.AbsoluteLeft=Ib.yj+wc.Width,Oc=!0):(wc.Height=
qc.Egd(gc.a.Uc(Ya.top,Ya.left)),xb=Xb.Range.Uc(Ya.top+1,Ya.left),wc.AbsoluteTop=Ib.Kj+wc.Height,Cb=!0);Cb&&(wc.FirstFrozenRow=Ya.top,wc.FirstScrollableRow=xb.top);Oc&&(wc.FirstFrozenColumn=Ya.left,wc.FirstScrollableColumn=xb.left);wc.VisibleRows=fc;wc.VisibleColumns=vc;return wc}hMj(wb){J.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(()=>{this.$.oa&&this.$.ea&&(this.$.ea.ZW(Pb.a.Be,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Ca.b(this.$.oa,wb,-1,void 0,!0))})}ftj(wb,
qc,Ya){if(!F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnfreezeViewportAdjustLocation",!1))switch(wb.command){case 1844679312:if(qc||-1===this.fLa&&-1===this.gLa)this.fLa=Ya.sx-Ya.width+this.gridView.scrollLeft,this.gLa=Ya.tx-Ya.height+this.gridView.scrollTop;break;case 340334732:if(qc||-1===this.fLa)this.fLa=Ya.sx-Ya.width+this.gridView.scrollLeft;break;case -806625837:if(qc||-1===this.gLa)this.gLa=Ya.tx-Ya.height+this.gridView.scrollTop}}kuc(){const wb=this.gridView.ib;0<wb.width?
this.gridView.scrollLeft=vb.a.m1b(this.gridView.domElement,T.g(this.$).rtl,0):-1!==this.fLa&&(this.gridView.scrollLeft=this.fLa,this.fLa=-1);0<wb.height?this.gridView.scrollTop=0:-1!==this.gLa&&(this.gridView.scrollTop=this.gLa,this.gLa=-1)}CGf(){this.oD.uTa();Ba.a.Ia(this.JGd);this.JGd=null;this.gridView.dO(this.Uyf)}}Object(b.a)(Oa,"FreezePanesCommandHandler",null,[164]);class Wa extends d.a{constructor(wb){super(wb)}vd(){B.TaskExtensions.Aa(x.GetServiceTaskFactory.Sa(this.$.da,12,477,this.fb),
wb=>{this.$c([new Oa(this.$,wb.result)])},this.$.la)}static ka(wb){wb.da.Ga(116,new Wa(wb))}}Object(b.a)(Wa,"FreezePanesCommandHandlerFactory",d.a,[]);var Sa=a(1163),yb=a(27),Ma=a(564),Bb=a(561),Nb=a(30),Ia=a(995),jb=a(1086);a(311);var Ob=a(14),Jb=a(33);class Kb{constructor(wb,qc){this.$=wb;this.fontServiceManager=qc;this.menuId=this.zZc=this.yO=this.Wua=null;this.Zbd=0;this.gBi="+mn-lt";this.myi="+mj-lt";this.DKi=()=>{this.z_f()};this.YPi=Ya=>{this.ahf=!0;this.$.Yx(xb=>{xb.YPa("FontName_New")});
f.ULS.sendTraceTag(520710160,1,15,`PreviewFont Status is ${Ya}`)};this.vfi=!!String.fromCodePoint&&!yb.a.pu&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.ahf=!1;this.Qm=F.EwaSettings.Qm();this.gridView=T.g(this.$);(this.Bl=Jb.a.Bl())&&this.fontServiceManager&&(this.fontServiceManager.Hgc?this.z_f():this.fontServiceManager.$oe(this.DKi))}get themesManager(){this.ox||(this.ox=this.$.da.za(422));return this.ox}z_f(){this.yO=this.fontServiceManager.Qzc;this.Wua=
this.fontServiceManager.GDh;this.Zbd=2}get Qzc(){return this.yO}LWe(wb,qc,Ya,xb=null){const wc=Object.assign(new Ma.a,{Id:"FontDropdownMenu"});wc.MenuSectionList=[];if(this.Qm&&this.themesManager){this.themesManager.Kad(xb);if(null==this.themesManager.AL||this.themesManager.Srd)return wc;xb=Object.assign(new Bb.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:Ob.a.instance.ga(1339),ControlList:this.CZh(wb,qc,Ya)});wc.MenuSectionList.push(xb)}xb=Object.assign(new Bb.a,{ControlsId:"FontsMenuSectionControl"});
if(this.Qm||this.Bl)xb.Title=Ob.a.instance.ga(1340);xb.ControlList=this.wPh(wb,qc,Ya);wc.MenuSectionList.push(xb);return wc}CZh(wb,qc,Ya){var xb;const wc=[];var Oc=this.gridView.ha.Qa.dc;Oc=5===(null===(xb=null===Oc||void 0===Oc?void 0:Oc.floatingObject)||void 0===xb?void 0:xb.type);let Cb,Ib;this.themesManager.AL?(Cb=this.themesManager.AL.Wrf,Ib=this.themesManager.AL.nqf):f.ULS.sendTraceTag(520710165,1,15,"ThemeFonts are Null");null!=Ib?(xb=this.tGe(Ib,1,Oc,wb,qc,Ya),wc.push(xb)):f.ULS.sendTraceTag(520710164,
1,15,"Major Theme Font is Null");null!=Cb?(wb=this.tGe(Cb,2,Oc,wb,qc,Ya),wc.push(wb)):f.ULS.sendTraceTag(520710163,1,15,"Minor Theme Font is Null");return wc}tGe(wb,qc,Ya,xb,wc,Oc){var Cb=2===qc?this.gBi:this.myi;Ya=Ya?Cb:Nb.a.nf(wb);Cb=Nb.a.nf(ba.HelperMethods.xcc(wb,qc));wb=Nb.a.nf(wb);return Object.assign(new Ia.a,{MenuItemId:2===qc?jb.b:jb.a,CommandValueId:Ya,LabelText:Cb,LabelCss:String.format("font-size:12pt;font-family:{0};",wb),Styles:Kb.nwb(wb),AriaLabel:Cb,Alt:Cb,Command:xb.toString(),CommandPreviewId:wc.toString(),
CommandRevertId:Oc.toString()})}wPh(wb,qc,Ya){if(this.zZc)return this.zZc.b6c;let xb;const wc=ba.HelperMethods.Q5(()=>{const Oc=this.vfi&&!this.ahf;let Cb=!1;this.Wua||(this.Yaf(),Cb=!0);xb=this.TEe(wb,qc,Ya,this.Wua,Oc,Cb);xb.Oxc&&!Cb&&(f.ULS.sendTraceTag(520710162,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),this.Yaf(),xb=this.TEe(wb,qc,Ya,this.Wua,Oc,xb.Oxc));this.Bl&&!xb.Oxc&&(this.zZc=xb);Oc&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.YPi)});
10<wc&&f.ULS.sendTraceTag(512340117,1,50,`FontDropdownHelper.getFontButtonsForMenuSection: Duration for getFontButtonsForMenuSection, duration=${wc}`);return xb.b6c}TEe(wb,qc,Ya,xb,wc,Oc){const Cb=[];let Ib;const fc=this.Bl&&!Oc;Ib=fc?"msofpNew":"msofp";for(let Ub in xb){var vc=Ub,Cc=xb[Ub],fd=Nb.a.nf(vc),od=void 0;if(fc)if(od=this.yO?this.yO[vc]:null)od=Nb.a.nf(od);else return f.ULS.sendTraceTag(520710161,1,15,`FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for ${vc}`),
{Oxc:!0,b6c:[]};else od=Nb.a.nf(ba.HelperMethods.yO[vc]);vc=Nb.a.nf(vc);wc||(Cc=0);fd=Object.assign(new Ia.a,{MenuItemId:fd,CommandValueId:fd,LabelText:wc&&0<Cc?Nb.a.nf(String.fromCodePoint(Cc)):od,LabelCss:String.format("font-size:12pt;font-family:{0};",wc&&0<Cc?Ib:vc),Styles:Kb.nwb(wc&&0<Cc?Ib:vc),AriaLabel:od,Alt:od,Command:wb.toString(),CommandPreviewId:qc.toString(),CommandRevertId:Ya.toString()});Cb.push(fd)}return{Oxc:Oc,b6c:Cb}}Frj(wb){this.menuId=wb}fii(){return 2!==this.Zbd&&3!==this.Zbd?
!1:!0}Yaf(){this.Wua={["Angsana New"]:983046,["Arial Black"]:983051,["Arial"]:983050,["Batang"]:983061,["Book Antiqua"]:983077,["Browallia New"]:983082,["Calibri"]:983085,["Cambria"]:983089,["Candara"]:983091,["Century"]:983095,["Comic Sans MS"]:983100,["Consolas"]:983101,["Constantia"]:983102,["Corbel"]:983106,["Cordia New"]:983107,["Courier New"]:983109,["DilleniaUPC"]:983121,["Dotum"]:983123,["FangSong"]:983138,["Garamond"]:983154,["Georgia"]:983156,["Gulim"]:983182,["GungSuh"]:983186,["KaiTi"]:983222,
["JasmineUPC"]:983218,["Malgun Gothic"]:983258,["Mangal"]:983262,["Meiryo"]:983264,["Microsoft JhengHei"]:983272,["Microsoft YaHei"]:983284,["MingLiU"]:983292,["MingLiU_HKSCS"]:983296,["MS Gothic"]:983245,["MS Mincho"]:983247,["MS PGothic"]:983249,["MS PMincho"]:983251,["PMingliU"]:983322,["PMingLiU-ExtB"]:983324,["SimHei"]:983382,["SimSun"]:983384,["SimSun-ExtB"]:983386,["Source Sans Pro"]:983396,["Tahoma"]:983405,["THSarabunPSK"]:983404,["Times New Roman"]:983415,["Trebuchet MS"]:983419,["Verdana"]:983443,
["Yu Gothic"]:983464,["Yu Mincho"]:983474}}static nwb(wb){const qc={};qc["font-family"]=wb;qc["font-size"]="12pt";wb={};wb.optionText=qc;return wb}}Object(b.a)(Kb,"FontDropdownHelper",null,[737]);var Qa=a(699);class ha extends ea.a{constructor(wb){super();this.$=wb;this.Eb()}create(){F.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FontServiceIntegration",!1)?this.$.da.Za(504,wb=>{this.pb(Object(Qa.c)(this.$.da,502,()=>new Kb(this.$,wb)))}):this.pb(Object(Qa.c)(this.$.da,502,()=>new Kb(this.$,
null)))}static ka(wb){wb.da.Ga(503,new ha(wb))}}Object(b.a)(ha,"FontDropdownHelperFactory",ea.a,[]);var qa=a(1246),pb=a(1088),bb=a(1222),eb=a(1186),Fa=a(1134),tb=a(1159),dc=a(1270),jc=a(1223),fb=a(1194);class ec{constructor(wb){this.$=wb}Lc(){return!1}executeCommand(wb,qc){wb=!1;qc=qc.command;switch(qc){case 1910465940:wb=!0}return wb?J.Task.Ta(!0):U.a(qc)}Ac(wb,qc){switch(qc.command){case 1910465940:return!0;default:return!1}}Oc(){return!1}}Object(b.a)(ec,"NameManagerCommandHandler",null,[164]);
class lb extends d.a{constructor(wb){super(wb)}vd(){this.$c([new ec(this.$)])}static ka(wb){d.a.Od(493,new lb(wb))}}Object(b.a)(lb,"NameManagerCommandHandlerFactory",d.a,[]);var ac=a(1175),Gb=a(1174);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Object(c.a)();R.a.Fa(H.ka);R.a.Fa(P.ka);Object(ka.a)();Object(pa.a)();Object(Na.a)();Object(Z.a)();Object(Ra.a)();Object(Da.a)();R.a.Fa(ab.ka);Object(Ua.a)();Object(nb.a)();Object(Ha.a)();(()=>{R.a.Fa(wb=>{Wa.ka(wb)})})();Object(Sa.a)();Object(qa.a)();Object(pb.a)();Object(bb.a)();Object(eb.a)();Object(Fa.a)();
Object(tb.a)();Object(dc.a)();Object(jc.a)();Object(Gb.a)();Object(fb.a)();Object(ac.a)();(()=>{R.a.Fa(wb=>{lb.ka(wb)})})();(()=>{R.a.Fa(wb=>{ha.ka(wb)})})()},717:function(n,C,a){a.d(C,"a",function(){return H});n=a(0);var c=a(7),b=a(15),d=a(564),f=a(86),e=a(561),k=a(374),l=a(591),m=a(569),u=a(111),t=a(263),w=a(83),r=a(414),v=a(1391);C=a(78);var y=a(19),x=a(5),B=a(836),z=a(77),A=a(43),I=a(59),F=a(145),U=a(113),X=a(1),T=a(11),G=a(22),D=a(14),J=a(21),L=a(34);class H extends C.a{constructor(R,Q,O,V,W,
da,ta,K,na,P,ka,pa){super();this.plc=!1;this.uGc=this.kJc=this.contextMenuController=null;this.Sod=!1;this.Juc=this.Jsb=null;this.XC=()=>{this.contextMenuController?this.contextMenuController.XC():b.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");this.Zcg()};this.jb=R;this.vrf=W;this.qlb=P;this.NIf=da;this.populateOnlyOnce=ta;this.r5h=ka;this.pPf(pa)}get contextMenuRoot(){return this.Juc}get $(){return this.jb}get Ua(){return this.qlb}get menuId(){return this.$.Cb+
this.vrf}get Oub(){this.kJc||(this.kJc=U.a(this.$));return this.kJc}get $pb(){this.uGc||(this.uGc=J.g(this.$).Xb);return this.uGc}Lc(R,Q){R=!0;switch(Q){case 1651433993:case 1675506831:case 966232027:R=this.Wd(4096)||this.Wd(2048);break;case 2045563128:R=this.Wd(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:R=this.Wd(8192)}return!R}Oc(R,Q,O){O.IsShadowMenuOpen||B.h(this.$,B.d);R=!1;Q===this.Lw&&(O.IsShadowMenuOpen||B.h(this.$,B.a),Q=Object(c.a)(new d.a,{ExternalId:"ContextMenu",
UpdateDynamically:!0,MenuSectionList:[]}),this.QEd(Q,O.IsShadowMenuOpen),O.MenuItems=Q,O.IsShadowMenuOpen||B.h(this.$,B.c),R=!0);R&&this.plc&&T.HelperMethods.n1b&&!O.IsShadowMenuOpen&&B.j(this.$);return R}QEd(R,Q){(Q=this.BY(Q))?(this.m$e(Q),R.MenuSectionList.push(...Q.yC().MenuSectionList),this.HDg(R)):b.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")}BY(){b.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");
return null}A0(R,Q,O,V,W){R=Sys.UI.DomElement.getBounds(Q);Q=new Sys.UI.Point(R.x,R.y+R.height);this.$.isChromeRtl&&(Q.x+=R.width);this.Jp(Q,W)}Jp(R,Q,O=0){Q&&(R=L.a(this.$).Ija(R));Q=!0;if(this.r5h){let V;3===O?(V=this.xKa(3))&&0<V.length?(Q=!1,this.showFloatie(V,new Sys.UI.Bounds(R.x,R.y,0,0),O)):b.ULS.sendTraceTag(537167075,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: ${this.menuId}`):2===O&&this.$.isEditMode&&
((V=this.xKa(2))&&0<V.length?V[0]!==H.UUe?(Q=!1,this.gTd(V,new Sys.UI.Bounds(R.x,R.y,0,0),O)):b.ULS.sendTraceTag(537167074,0,50,`ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: ${this.menuId}`):b.ULS.sendTraceTag(537167073,0,10,`ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: ${this.menuId}`))}Q&&this.showContextMenu(new Sys.UI.Bounds(R.x,R.y,0,0),O)}xKa(){return null}zgd(R,
Q=null){let O="";3===R?O="touch":2===R&&(O="mouse");return{["ContextMenuId"]:this.menuId,["IsEditMode"]:this.$.isEditMode,["IsSLR"]:!!I.a.wg&&I.a.wg.yK,["IsReactMLR"]:!!I.a.wg&&I.a.wg.oV,["IsNov"]:this.$.ea.isNamedObjectViewMode,["InputType"]:O,["FloatieGroups"]:JSON.stringify(Q)}}showContextMenu(R,Q=0){const O=this.zgd(Q);b.ULS.sendTraceTag(595359709,0,50,`ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: ${JSON.stringify(O)}`);this.contextMenuController?this.HB!==x.a.HHd&&
this.HB!==x.a.IHd||0===Q?this.contextMenuController.fTd(this.HB,R,z.a.Gb):this.contextMenuController.fTd(this.HB,R,Q):b.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")}showFloatie(R,Q,O){const V=this.zgd(O,R);b.ULS.sendTraceTag(595359710,0,50,`ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: ${JSON.stringify(V)}`);this.contextMenuController?(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.wPf(),this.contextMenuController.pyc(R,Q,O)):(R=JSON.stringify(R),b.ULS.sendTraceTag(537167071,0,10,`ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups ${R}.`))}gTd(R,Q,O){var V=this.zgd(O,R);V=JSON.stringify(V);b.ULS.sendTraceTag(537167070,0,50,`ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: ${V}`);this.contextMenuController?(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.wPf(),this.contextMenuController.eTd(R,Q,O,this.HB)):b.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")}pPf(R){this.contextMenuController=R}dispose(){this.$&&this.$.Ka.Dbb(this);this.jb=null;X.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.Zcg();this.Juc&&(f.a.Ia(this.Juc),this.Juc=null);super.dispose()}$Fh(R){var Q=this.$.da.za(204);
Q&&(Q=Q.HGh(this.vrf))&&R.sc.push(Q)}Wd(R){return(new F.a(this.$.xa)).Wd(R)}m$e(R){for(const Q of R.sc)if(Object(r.a)(431,Q)){R=Q;R.title&&(R.title=H.ki(R.title));for(const O of R.buttons)Object(r.a)(432,O)?(R=O,R.label=H.ki(R.label),R.$R(H.ki(R.alt))):Object(r.a)(433,O)&&this.m$e(O.menu)}}srf(R,Q=!1){const O=[];for(const V of R)O.push(this.XE(V,Q));return O}XE(R){const Q=[];for(const O of R.MenuItems)switch(O.Type){case 3:Q.push(this.i6g(O));break;case 2:Q.push(this.Sah(O));break;case 1:Q.push(this.G7g(O))}return Object(c.a)(new e.a,
{ControlList:Q,Title:R.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})}Ycd(R,Q){Q=[this.Jsb,R.RibbonCommand.toString(),Q?this.M_e(Q):this.M_e(R.Label),R.Disabled?R.Disabled.toString():"False"];let O=R.CommandData;O=G.a.hashCode(O).toString();Q.push(O,R.Identifier.toString());Q=Q.join("_");R.IsChecked&&(Q+="_Checked");return Q}IGh(R){const Q=[this.Jsb,G.a.hashCode(R.Title).toString()];for(const O of R.MenuItems)Q.push(O.RibbonCommand.toString());
return Q.join("_")}KWe(R){var Q=R.Label;Q=G.a.hashCode(Q).toString();Q=[this.Jsb,Q];X.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&R.Id&&Q.push(G.a.hashCode(R.Id).toString());Q=Q.join("_");R.IsChecked&&(Q+="_Checked");return Q}i6g(R){let Q,O,V;({label:O,QLa:V,Fr:Q}=this.W$b(R,!1));const W=this.Ycd(R,O);return Object(c.a)(new k.a,{Command:R.Disabled?(-251203935).toString():Q.toString(),ExternalId:W,Id:W,Image16by16Class:V,LabelText:O||R.Label,MenuItemId:R.CommandData,
CommandValueId:R.CommandData})}Sah(R){let Q,O,V;({label:O,QLa:V,Fr:Q}=this.W$b(R,R.IsChecked));const W=this.Ycd(R,O);return Object(c.a)(new l.a,{Command:R.Disabled?(-251203935).toString():Q.toString(),ExternalId:W,Id:W,Image16by16Class:V,LabelText:O||R.Label,MenuItemId:R.CommandData,CommandValueId:R.CommandData,IsChecked:R.IsChecked})}G7g(R){let Q;var O;({label:Q,QLa:O}=this.UWe(R));const V=Object(c.a)(new d.a,{MenuSectionList:[],UpdateDynamically:!0});V.MenuSectionList.push(...this.srf(R.SubMenu.Sections,
!0));const W=this.KWe(R);R=Q||R.Label;return Object(c.a)(new m.a,{ExternalId:W,Id:W,LabelText:R,PopulateOnlyOnce:!1,Menu:V,Image16by16Class:O,ImageIsVisible:!!O})}UWe(R){let Q,O;({label:R,QLa:Q,Fr:O}=this.W$b(R,!0));return{label:R,QLa:Q,Fr:O}}W$b(R,Q){let O;switch(R.Identifier){case 26:O=912804500;Q=y.a.gRe;R=D.a.instance.ga(1949);break;case 3:O=-1902148570;Q=Q?y.a.haa:null;R=D.a.instance.ga(1909);break;case 4:O=-1902148570;Q=Q?y.a.haa:null;R=D.a.instance.ga(1910);break;case 5:O=-1902148570;Q=Q?y.a.haa:
null;R=null;break;case 1:O=-1677817820;Q=y.a.R8b;R=D.a.instance.ga(235);break;case 2:O=-1649376918;Q=R.IsChecked?y.a.Fua:null;R=D.a.instance.ga(2120);break;case 23:O=1701016594;Q=R.IsChecked?y.a.Fua:null;R=D.a.instance.ga(2120);break;case 6:O=-87741481;Q=null;R=D.a.instance.ga(2121);break;case 7:O=1948650742;Q=y.a.TPe;R=D.a.instance.ga(1947);break;case 8:O=1933713114;Q=y.a.SPe;R=D.a.instance.ga(1948);break;case 14:O=504133448;Q=y.a.mJa;R=D.a.instance.ga(145);break;case 30:O=504133448;Q=y.a.mJa;R=
D.a.instance.ga(149);break;case 32:O=504133448;Q=y.a.mJa;R=D.a.instance.ga(151);break;case 34:O=504133448;Q=y.a.mJa;R=D.a.instance.ga(153);break;case 27:O=1701016594;Q=Q?y.a.T8b:y.a.mJa;R=D.a.instance.ga(145);break;case 15:O=-798968736;Q=y.a.nJa;R=D.a.instance.ga(147);break;case 31:O=-798968736;Q=y.a.nJa;R=D.a.instance.ga(150);break;case 33:O=-798968736;Q=y.a.nJa;R=D.a.instance.ga(152);break;case 35:O=-798968736;Q=y.a.nJa;R=D.a.instance.ga(154);break;case 28:O=1701016594;Q=Q?y.a.U8b:y.a.nJa;R=D.a.instance.ga(147);
break;case 21:O=-2058042992;Q=y.a.R2a;R=null;break;case 29:O=1701016594;Q=y.a.R2a;R=null;break;case 9:O=1701016594;R=Q=null;break;case 11:O=-1494291901;R=Q=null;break;case 25:O=-1045020714;Q=R.IsChecked?y.a.Fua:null;R=null;break;case 13:O=1701016594;Q=R.IsChecked?y.a.Fua:null;R=D.a.instance.ga(156);break;case 16:O=1701016594;Q=y.a.J8b;R=D.a.instance.ga(1081);break;case 17:O=1701016594;Q=y.a.Q2a;R=null;break;case 18:O=1701016594;Q=y.a.P2a;R=null;break;case 19:O=1701016594;Q=y.a.K8b;R=D.a.instance.ga(1086);
break;case 20:O=1701016594;Q=y.a.$9c;R=D.a.instance.ga(1087);break;case 24:O=1675506831;R=Q=null;break;case 22:O=R.RibbonCommand;Q=R.IsChecked?y.a.haa:null;R=null;break;case 36:O=1461300262;Q=null;R=D.a.instance.ga(155);break;case 38:O=R.RibbonCommand;Q=y.a.p$c;R=D.a.instance.ga(1820);break;default:b.ULS.shipAssertTag(537167069,0,!1,`Unable to map menu item: ${JSON.stringify(R)}`),O=1461300262,R=Q=null}return{label:R,QLa:Q,Fr:O}}M_e(R){return G.a.hashCode(R+T.HelperMethods.voj).toString()}HDg(R){if(!this.$.ea.amIAlone){var Q=
this.$.da.za(25);if((void 0!==Q&&null!==Q||!X.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!u.a.isEmpty(Q.dCa)&&(Q=Q.l0h(),!t.a.Fh(Q))){var O=[];w.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").i$g(Q,O);R.MenuSectionList.push(...O)}}}wPf(){this.Sod||(this.Oub&&this.Oub.QZb(this.XC),this.$pb&&this.$pb.QZb(this.XC),this.Sod=!!this.Oub||!!this.$pb)}Zcg(){this.Oub&&this.Oub.ntc(this.XC);this.$pb&&this.$pb.ntc(this.XC);this.Sod=!1}static Wnd(R,Q){Q=A.C(Q);
R=J.g(R).Ea.JKa(Q);return!(null===R||void 0===R||!R.Kk)}static ded(R,Q,O){Q=A.C(Q);var V=J.g(R).Ea.JKa(Q);Q=J.g(R).getCellBounds(V);const W=V.rOg;V=V.qOg;let da=Q.x+W.x;Q=Q.y+W.y;O&&X.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(J.g(R).rtl||(da+=V),Q-=V);return new Sys.UI.Point(da,Q)}static Uxh(R){try{Object(v.a)(R.CommandValueId)}catch(Q){}}static ki(R){const Q=H.eua.parseFromString(R,"text/html");return Q?Q.body.innerText:(b.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),
R)}}H.eua=new DOMParser;H.UUe="Unsupported";Object(n.a)(H,"ContextMenuBase",C.a,[164,434,10])},775:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.KNe="ewa-ac";c.Anh="ewa-ac-param";c.COe="ewa-function-help-link";c.Q9c="ewa-lb";c.wOe="ewa-fb-refactor";c.listItem="list-item";c.jCb="list-item-selected";c.nCb="list-table-touch";c.mCb="list-table";c.hth="ewa-suggested-cell-name";c.f0g="columnName-header";c.xPe="ewa-tt";c.Cqh="ewa-function-link-container";c.DOe="ewa-function-udf-name";
c.rtl="rtl";Object(n.a)(c,"CssClassNames",null,[])},809:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(814),d=a(725),f=a(5),e=a(77),k=a(53),l=a(197),m=a(35),u=a(1),t=a(14);class w{constructor(Q,O,V,W,da,ta,K,na){this.fng=Q;this.gng=O;this.eng=V;this.xga=W;this.hyg=da;this.wug=ta;this.Hjb=K;this.wtg=na}get ove(){return this.fng}get e1b(){return this.gng}get nve(){return this.eng}get width(){return this.xga}get lGj(){return this.hyg}get eFi(){return this.wug}get lineHeight(){return this.Hjb}get Hsi(){return this.wtg}static jRg(){return new w("BorderStyleSolidLine",
1961,1,"1","",1,8,0)}static fRg(){return new w("BorderStyleDashedLine",1962,3,"1","5,3",1,8,0)}static gRg(){return new w("BorderStyleDottedLine",1963,4,"1","1,1",1,8,0)}static iRg(){return new w("BorderStyleMediumLine",1964,2,"2","",1,8,0)}static kRg(){return new w("BorderStyleThickLine",1965,5,"3","",1,8,0)}static hRg(){return new w("BorderStyleDoubleLine",1966,6,"1","",2,8,3)}}Object(n.a)(w,"BorderLineStyleProperties",null,[]);class r{constructor(){this.iconName=this.title=this.key=null}}Object(n.a)(r,
"BorderLineStyleProps",null,[]);class v{constructor(Q){Q.GPf()}getBorderLineStyleProps(){const Q=a(809).BorderFormatManager.z_a,O=Array(Object.keys(Q).length);let V=0;for(let ta in Q){var W=ta,da=Q[ta];O[V]=new r;O[V].key=W;W=da;O[V].title=t.a.instance.ga(W.e1b);O[V].iconName=W.ove;V++}return O}}Object(n.a)(v,"BorderMenuController",null,[279]);var y=a(263),x=a(85),B=a(237),z=a(13),A=a(108),I=a(24),F=a(47),U=a(45),X=a(209),T=a(11),G=a(97),D=a(21),J=a(34),L=a(43);class H{constructor(Q,O){this.iHb=this.ribbonCommandInfo=
this.cellFormat=this.Sr=this.ob=this.ha=null;this.vsc=!1;this.fKf=this.dMa=this.bGd=this.m9d=this.Cza=this.Cma=null;this.g1b=this.kua=this.lKf=0;this.borderStyle=this.A_a=this.borderColor=null;this.qB=!1;this.C1a=this.Eab=null;this.e0=()=>{if(!this.qB||D.g(this.$).wz)this.qB=!1,D.g(this.$).wz=!1,this.kua=0,D.g(this.$).Ff.dm(f.a.BQ),1===this.$.Ka.yH()&&(D.g(this.$).rZ(u.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?L.d(this.bGd):y.a.clone(this.bGd),this.lKf,this.$.oa?this.$.oa.sheetName:
null,null,this.fKf.clone(),null,null,0,G.a.njh,!0),D.g(this.$).XSa(!0)),this.Iv(),this.jZd(),this.mk(),this.vsc=!1,this.Cza=this.Cma=null,this.Sr&&(this.Sr.cancel(),this.Sr.dispose()),c.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=V=>{try{if(V=this.Vd(V),D.g(this.$).wz=!0,this.Cma={},this.Cza={},this.Eab=null,this.npb(this.g1b),2===V.tb){const W=D.g(this.$).ha.eo(V.clientPoint,V.Db,5,void 0,void 0,!1);W&&(this.C1a=this.dMa=W,this.f8i())}}catch(W){D.g(this.$).wz=
!1}return!0};this.Jh=V=>{try{V=this.Vd(V);const W=D.g(this.$).ha.eo(V.clientPoint,V.Db,5,void 0,void 0,!1),da=D.g(this.$).Ea.es(W);if(!this.iHb||da&&(da.JQ!==this.iHb.JQ||da.IQ!==this.iHb.IQ))if(this.qB=!0,this.iHb=da,W){let ta=new I.Range(this.dMa.top,this.dMa.left,this.dMa.top,this.dMa.left,!0,!1);ta.union(W);ta=D.g(this.$).ha.GVh(ta);this.l1b(W);this.dVf(this.Eab,ta);if(this.bottomRightCorner(ta.bottom,ta.right))return c.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),
!1;const K=new I.Range(ta.top,ta.left,ta.bottom+1,ta.right+1,!0,!1),na=D.g(this.$).J$("DrawBorderBehavior.OnPointerMove",[K]);if(this.Cma&&this.Cza)for(;na.$$mn();){const P=na.$$cu(),ka=P.cell.getRange().toString();ka in this.Cma&&1!==this.kua||(this.Cma[ka]=P,this.Cza[ka]=P.cell.RM())}this.Eab=K;this.C1a=ta;D.g(this.$).rZ([ta],0,this.$.oa.sheetName,null,ta.topLeft,null,null,0,G.a.kjh,!0);this.xg.Vda(D.g(this.$),-1690267012,this.cellFormat,!0,null,[ta])}return!0}catch(W){return D.g(this.$).wz=!1}};
this.Mf=V=>{V=this.Vd(V);(V=D.g(this.$).ha.eo(V.clientPoint,V.Db,5,void 0,void 0,!1))?this.qB&&(this.l1b(V),this.dMa.union(V),3===this.kua?this.npb(0):this.npb(this.g1b),D.g(this.$).rZ([this.dMa],0,this.$.oa.sheetName,null,null,null,null,0,G.a.ljh,!0),this.xg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo)):(3===this.kua?this.npb(0):this.npb(this.g1b),D.g(this.$).rZ([this.C1a],0,this.$.oa.sheetName,null,null,null,null,0,G.a.mjh,!0),this.xg.formatCells(-1690267012,this.cellFormat,this.ribbonCommandInfo));
this.qB=!1;this.jZd();this.Cza=this.Cma=null;return!0};this.onKeyDown=V=>{V=this.Vd(V);if(this.qB||[17,16,18,20].includes(V.Ca.keyCode))return!0;this.e0();return!1};this.onKeyUp=V=>{V=this.Vd(V);if(V.Ca.keyCode===x.a.FL&&this.qB)return this.qB=!1,this.dVf(this.Eab,this.C1a,!0),this.jZd(),!0;if(this.qB||V.Ca.keyCode===x.a.Z7||V.Ca.keyCode===x.a.q2d||V.Ca.keyCode===x.a.p2d||[17,16,18,20,37,39,38,40,33,34,9,13].includes(V.Ca.keyCode)||V.Ca.keyCode===x.a.Elg||V.Ca.keyCode===x.a.Alg||V.Ca.keyCode===x.a.wlg)return!0;
this.e0();return!1};this.nR=(V,W)=>{D.g(this.$).wz&&!this.s8h.includes(W.Jd.command)&&(V=JSON.stringify(W.Jd),c.ULS.sendTraceTag(537159512,0,50,`DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : ${V} `),this.e0())};this.$=Q;this.xg=O}get s8h(){return this.m9d||(this.m9d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}NAg(Q){c.ULS.sendTraceTag(537159517,
0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=D.g(this.$).ha;this.ob=D.g(this.$).ob;this.ribbonCommandInfo=Q;this.bGd=u.EwaSettings.isChangeGateEnabled("OfficeVSO:6713439_FixCloneRangeArray")?L.d(this.ha.sa.selectedRanges):y.a.clone(this.ha.sa.selectedRanges);this.lKf=this.ha.sa.ls;this.fKf=this.ha.sa.activeCell.clone();this.ob&&this.ob.pkd();this.Av();this.Ij()}dispose(){this.e0();this.iHb=this.ribbonCommandInfo=this.cellFormat=null}npb(Q){var {BorderFormatManager:O}=
a(809);this.cellFormat={};const V={};this.borderColor=this.borderColor||O.h6c;var W=l.a.uH(this.borderColor,!1);V.Color=[W,W,W,W];u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.A_a&&(V.ThemeBorderColor=[this.A_a,this.A_a,this.A_a,this.A_a],V.ColorTypeOption=1);W=a(809).BorderFormatManager.z_a;this.borderStyle=this.borderStyle||O.borderStyleSolidLine;O=W[this.borderStyle].nve;V.LineStyle=[O,O,O,O];this.cellFormat.BorderFormat=V;this.cellFormat.ValidMembers=128;this.cellFormat.Border=
Q}Av(){for(const Q of D.g(this.$).Cn)B.a.instance.ra(z.a.pointerDown,Q.domElement,this.onPointerDown);A.KeyInputManager.instance.ra(z.a.Qb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.ra(z.a.Ed,document.documentElement,this.onKeyUp)}f8i(){for(const Q of D.g(this.$).Cn)B.a.instance.ra(z.a.Gj,Q.domElement,this.Jh),B.a.instance.ra(z.a.Nf,Q.domElement,this.Mf);B.a.instance.ra(z.a.Nf,document.documentElement,this.Mf);B.a.instance.ra(z.a.sy,document.documentElement,this.Mf);this.vsc=
!0}Iv(){try{for(const Q of D.g(this.$).Cn)B.a.instance.Ba(z.a.pointerDown,Q.domElement,this.onPointerDown);A.KeyInputManager.instance.Ba(z.a.Qb,document.documentElement,this.onKeyDown);A.KeyInputManager.instance.Ba(z.a.Ed,document.documentElement,this.onKeyUp)}catch(Q){D.g(this.$).wz=!1,c.ULS.sendTraceTag(537159514,0,10,`DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception ${Q}`)}}jZd(){if(this.vsc)try{this.vsc=!1;for(const Q of D.g(this.$).Cn)B.a.instance.Ba(z.a.Gj,
Q.domElement,this.Jh),B.a.instance.Ba(z.a.Nf,Q.domElement,this.Mf);B.a.instance.Ba(z.a.Nf,document.documentElement,this.Mf);B.a.instance.Ba(z.a.sy,document.documentElement,this.Mf)}catch(Q){D.g(this.$).wz=!1,c.ULS.sendTraceTag(537159513,0,10,`DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception ${Q}`)}}Ij(){this.$.xa.Qf(this.e0);D.g(this.$).Xb.Vk(this.e0);D.g(this.$).rC(this.e0);this.$.Ka.WFa(this.nR)}mk(){this.$.xa.Eg(this.e0);D.g(this.$).Xb.Ak(this.e0);D.g(this.$).MD(this.e0);
this.$.Ka.aAa(this.nR)}dVf(Q,O,V=!1){if(Q&&this.Cma&&this.Cza)for(Q=D.g(this.$).J$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[Q]);Q.$$mn();){var W=Q.$$cu().cell.getRange();if(V||!O.contains(W)||1===this.kua){W=W.toString();const da=m.a.Cc(this.Cma,W);if(da){const ta=m.a.Cc(this.Cza,W);this.setBorders(da,ta);delete this.Cma[W];delete this.Cza[W]}}}}setBorders(Q,O){var V=Q.cell;const W=V.getRange();V.Cbb();W.right!==this.Eab.right&&(V=new I.Range(W.top,W.left-1,W.bottom,W.left-1,!0,!1),D.g(this.$).Ea.es(V).OQa(3));
W.bottom!==this.Eab.bottom&&(V=new I.Range(W.top-1,W.left,W.top-1,W.right,!0,!1),D.g(this.$).Ea.es(V).OQa(1));if(null===O||void 0===O?0:O.Borders.length){V={};let K=0;const na=Array(4),P=Array(4);for(var da=0;4>da;da++)na[da]=1,P[da]=0;for(var ta of O.Borders)O=ta.BorderPosition,na[O]=ta.BorderLineStyle,da=new X.a(ta.Color.Red,ta.Color.Green,ta.Color.Blue),P[O]=da.mS(),K|=T.HelperMethods.Y3a(ta.BorderPosition);V.LineStyle=na;V.Color=P;ta={};ta.BorderFormat=V;ta.Border=K;this.xg.rsj(Q,ta,W)}}l1b(Q){const O=
new I.Range(Math.max(1,Q.top-1),Math.max(1,Q.left-1),Q.bottom+1,Q.right+1,!1,!1);D.g(this.$).wK(O)||this.Sr&&this.Sr.Lq||(this.Sr=F.a.instance.create(()=>{D.g(this.$).tt(O,60,G.a.ijh)},40,U.a.jjh))}bottomRightCorner(Q,O){return 1048576<=Q||16384<=O?!0:!1}Vd(Q){return J.a(this.$).Vd(Q)}}Object(n.a)(H,"DrawBorderBehavior",null,[10]);a.d(C,"BorderFormatManager",function(){return R});class R{constructor(Q,O,V){this.mRb=null;this.ZF={};this.cSb=this.ox=null;c.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");
this.$=Q;this.C5d=R.h6c;this.D5d=R.borderStyleSolidLine;this.xg=O;this.Ua=V;u.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ga(296,this);this.uU=new H(this.$,this.xg);this.nD=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);c.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName 296")}get fIa(){return this.D5d}get m3(){return this.C5d}get yta(){return this.cSb}get themesManager(){this.ox||
(this.ox=this.$.da.za(422));return this.ox}h6e(Q,O){c.ULS.sendTraceTag(537159564,0,50,`HandleBorderCommand : Begin handling, Command being executed: ${O.command.toString()}`);const V={},W={};var da=l.a.uH(this.m3,!1);W.Color=[da,da,da,da];this.nD&&this.yta&&(W.ThemeBorderColor=[this.yta,this.yta,this.yta,this.yta],W.ColorTypeOption=1);Q=-600086683===O.command?"OutsideBorders":Q[e.a.Qc];W.LineStyle=m.a.Cc(R.rJf,Q);W.LineStyle?c.ULS.sendTraceTag(537159562,0,50,`RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is ${Q}`):
(da=R.z_a[this.fIa].nve,W.LineStyle=[da,da,da,da],c.ULS.sendTraceTag(537159563,0,50,`RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is ${this.fIa}`));da=m.a.pq(R.hQg,Q,0);c.ULS.sendTraceTag(40732555,0,50,`RibbonCommand.Border is using the BorderFormat information, the border type requested is ${Q}, the border color selected is ${this.m3}`);V.BorderFormat=W;4!==da&&8!==da||!this.$.oa.displayRtl||(da=4===da?8:4);V.ValidMembers=128;V.Border=da;this.xg.formatCells(-1690267012,
V,O);c.ULS.sendTraceTag(537159561,0,50,`HandleBorderCommand : Successfully handled, Command executed: ${O.command.toString()}`);return!0}Lid(Q,O,V){c.ULS.sendTraceTag(537159560,0,50,`RibbonCommand:${Q.toString()} is being executed, the previous border color is ${this.m3}`);if(this.nD){if((O.SqmControlId||"").includes("ThemeColorPicker")){let W,da;({themeIndex:W,yBa:da}=this.themesManager.getThemeColor(O.Color)).returnValue?(this.cSb={},this.yta.ThemeColorIndex=W,this.yta.ThemeColorRow=da):this.cSb=
null}else this.cSb=null;this.uU.A_a=this.yta}this.C5d=-1803452024===Q?R.h6c:O.Color;this.uU.borderColor=this.m3;this.bMe(V);this.$.$e();c.ULS.sendTraceTag(40944211,0,50,`RibbonCommand:${Q.toString()} is being executed, the updated border color is ${this.m3}`);return!0}P3h(Q){c.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");const O=this.Ua.Up();var V=this.Ua.Dc();O.sc.push(V);const W=this.Ua.ZA("StyleDashGallery",1,"Size120by20");V.buttons.push(W);V=R.z_a;
for(let da in V){const ta=da,K=V[da],na=t.a.instance.ga(K.e1b);W.Vt(ta,-2118943501,"QueryBorderStyle",K.e1b,ta,ta,void 0,void 0,na)}c.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");Q.MenuItems=O.yC();c.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")}n2h(Q,O){c.ULS.sendTraceTag(537159555,0,50,`RibbonCommand.BorderStyle: Begin handling, Current Border Style is ${this.fIa}`);Q=Q[e.a.Qc];if(R.Foi(Q))this.D5d=Q,c.ULS.sendTraceTag(537159554,0,50,`RibbonCommand.BorderStyle: Updated Border Style is ${this.fIa}`);
else return c.ULS.sendTraceTag(537159553,0,15,`RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : ${Q}`),!0;this.uU.borderStyle=this.fIa;this.bMe(O);this.$.$e();c.ULS.sendTraceTag(40944220,0,50,`RibbonCommand.BorderStyle: Successfully handled Current Border Style is ${this.fIa}`);return!0}Pid(Q){c.ULS.sendTraceTag(537159552,0,50,`HandleDrawBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.UTc(Q,64,this.m3,111,1);return!0}Qid(Q){c.ULS.sendTraceTag(537159523,
0,50,`HandleDrawBorderGridCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.UTc(Q,112,this.m3,112,2);return!0}v6e(Q){c.ULS.sendTraceTag(537159522,0,50,`HandleEraseBorderCommand : Begin handling, Command being executed: ${Q.command.toString()}`);this.UTc(Q,112,"white",113,3);return!0}T3h(Q){this.Xqj(this.jQg,Q,Q.MenuItemId?Q.MenuItemId:R.borderStyleSolidLine)}Xqj(Q,O,V){V in Q?(Q=Q[V],c.ULS.sendTraceTag(537159521,0,50,`HandleQueryBorderStyleCommand:SetIcon command ${V}`),
this.Zqj(O,Q)):c.ULS.sendTraceTag(537159520,0,15,`HandleQueryBorderStyleCommand: cannot find dashes '${V}' in BorderLineStyleButtons dictionary`)}d4h(Q,O){const V=Q[e.a.Qc];return"DrawBorder"===V?this.Pid(O):"DrawBorderGrid"===V?this.Qid(O):"EraseBorder"===V?this.v6e(O):this.h6e(Q,O)}GPf(){this.mRb||this.lRg()}NJh(){return new v(this)}get jQg(){this.GPf();return this.mRb}lRg(){this.mRb={};let Q=0;const O=R.z_a;for(let V in O){const W=O[V],da=W.ove;t.a.instance.ga(W.e1b);this.mRb[da]=da;this.vbb(da,
()=>appChrome.buildBorderStyleIconNew(W.lGj,W.width,W.eFi,W.lineHeight,W.Hsi));Q++}}vbb(Q,O){if(!(Q in this.ZF)){const V={};O=O();V[Q]=O;appChrome.api.registerIconProvider(()=>V);this.ZF[Q]=!0}return Q}Zqj(Q,O){Q.MenuItemId&&(Q[b.a.On]=Q.MenuItemId===this.fIa,Q[d.a.Icon]=O)}UTc(Q,O,V,W,da){c.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.VXg(Q,da)?(c.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),
this.uU.e0()):(D.g(this.$).wz&&this.uU.e0(),k.a.current&&(W=String.format(f.a.Eta,k.a.current.Zn(W)),D.g(this.$).Ff.dm(W)),this.uU.g1b=O,this.uU.borderColor=V,D.g(this.$).wz=!0,this.uU.NAg(Q),this.uU.kua=da)}bMe(Q){if(Q)switch(this.uU.kua){case 2:this.Qid(Q);break;default:this.Pid(Q)}}VXg(Q,O){return this.uU.kua===O&&-236759591!==Q.command&&-2118943501!==Q.command?!0:!1}static get z_a(){return R.Q3d||(R.Q3d={["BorderStyleSolidLine"]:w.jRg(),["BorderStyleDashedLine"]:w.fRg(),["BorderStyleDottedLine"]:w.gRg(),
["BorderStyleMediumLine"]:w.iRg(),["BorderStyleThickLine"]:w.kRg(),["BorderStyleDoubleLine"]:w.hRg()})}static get hQg(){return R.P3d||(R.P3d={["NoBorder"]:0,["BottomBorder"]:1,["TopBorder"]:2,["LeftBorder"]:4,["RightBorder"]:8,["OutsideBorders"]:64,["AllBorders"]:112,["ThickOutsideBorders"]:64,["InsideBorders"]:48,["InsideHorizontalBorders"]:16,["InsideVerticalBorders"]:32,["BottomDoubleBorder"]:1,["ThickBottomBorder"]:1,["TopBottomBorder"]:3,["TopThickBottomBorder"]:3,["TopDoubleBottomBorder"]:3})}static get rJf(){return R.efe||
(R.efe={["ThickOutsideBorders"]:[2,2,2,2],["BottomDoubleBorder"]:[1,6,1,1],["ThickBottomBorder"]:[1,2,1,1],["TopBottomBorder"]:R.Kdh,["TopThickBottomBorder"]:[1,2,1,1],["TopDoubleBottomBorder"]:[1,6,1,1]})}static Foi(Q){return Q?Q in R.rJf||Q in R.z_a:!1}}R.P3d=null;R.Q3d=null;R.efe=null;R.h6c="black";R.borderStyleSolidLine="BorderStyleSolidLine";R.Kdh=[1,1,1,1];Object(n.a)(R,"BorderFormatManager",null,[238])},836:function(n,C,a){a.d(C,"i",function(){return"ContextMenuPerf.A"});a.d(C,"b",function(){return"ContextMenuPerf.B"});
a.d(C,"d",function(){return"ContextMenuPerf.C1"});a.d(C,"a",function(){return"ContextMenuPerf.C2"});a.d(C,"c",function(){return"ContextMenuPerf.D"});a.d(C,"e",function(){return m});a.d(C,"f",function(){return w});a.d(C,"g",function(){return r});a.d(C,"h",function(){return v});a.d(C,"j",function(){return y});var c=a(15),b=a(319),d=a(8),f=a(60),e=a(24),k=a(11),l=a(21);const m=(B,z)=>{var A=B.Vb(null);if((null===A||void 0===A?0:A.cell.Kk)&&u(A,B,z))return B.getCellBounds(A.cell);A=B.ha.sa.activeCell;
return(z=t(new e.Range(A.top,A.left,d.a.eh,A.left,!1,!1),2,!0,B,z)||t(new e.Range(1,A.left,A.top,A.left,!1,!1),2,!1,B,z)||t(new e.Range(A.top,A.right,A.top,d.a.ph,!1,!1),1,!0,B,z)||t(new e.Range(A.top,1,A.top,A.right,!1,!1),1,!1,B,z)||null)&&z.Kk?B.getCellBounds(z):Sys.UI.DomElement.getBounds(B.hwa.nc)},u=(B,z,A)=>{var I=z.rtl,F=A.isChromeRtl;B=B.cell;return(A=l.g(A).dK(B))?(A=A.topLeft,I=A.x+=I===F?B.offsetWidth:0,F=A.y+=B.offsetHeight,z.view.visibleArea.contains(new f.a(I,F,0,0))):!1},t=(B,z,A,
I,F)=>{B=I.uk("ContextMenuHelper.FindFirstCellInViewportArea",B,z,A);try{for(B.$$rst();B.$$mn();){const U=B.$$cu();if(U&&u(U,I,F))return U.cell}}finally{B&&B.dispose()}return null},w=B=>B.Fb.e5(B.ha.sa.activeCell),r=B=>{B=l.g(B).ha.sa;return B.Bg&&(B.Xc.isRow||B.Xc.gf)},v=(B,z)=>{k.HelperMethods.dZc&&window.performance.mark(z)},y=()=>{if(b.a.jpb){const B=x("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),z=x("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),A=x("EWAPopulation",
"ContextMenuPerf.C2","ContextMenuPerf.D");c.ULS.sendTraceTag(537167064,0,50,`ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[${B}], PrepInfraWork=[${z}], EWAPopulation =[${A}]`)}},x=(B,z,A)=>{window.performance.measure(B,z,A);z=window.performance.getEntriesByName(B);z.length||c.ULS.sendTraceTag(537167063,0,10,`ContextMenuHelper.MeasureTime: measure name [${B}] returned no measures.`);return z[z.length-1]?z[z.length-1].duration:-1}},837:function(n,C,a){a.d(C,"a",function(){return c});
n=a(0);class c{}c.edit="Edit";c.clipboard="Clipboard";c.copy="Copy";c.color="Color";c.oOg="AutoFill";c.Sij="RowOperations";c.g0g="ColumnOperations";c.CWj="ViewModeRowOperations";c.BWj="ViewModeColumnOperations";c.hyperlink="Hyperlink";c.openHyperlink="OpenHyperlink";c.$uj="ShapeStyle";c.LCh="FloatingObjectClipboard";c.pIf="PivotTableCopyDelete";c.rIf="PivotTableFieldListActions";c.vye="CellFloatie";c.Wuj="ShapeFloatie";c.contextMenu="ContextMenu";c.B1h="GridContextMenu";c.tYi="PivotTableContextMenu";
c.MCh="FloatingObjectContextMenu";c.bXg="CellRTEFloatie";c.q2f="ShapeRTEFloatie";Object(n.a)(c,"FloatieGroupIdentifiers",null,[])},838:function(n,C,a){a.d(C,"a",function(){return m});n=a(0);var c=a(86),b=a(223),d=a(13),f=a(237);C=a(236);var e=a(12),k=a(71),l=a(21);class m extends C.a{constructor(u,t,w){super(t);this.ekc=this.aR=!1;this.zn=this._selectedRowListBox=this.WNa=null;this.kAf=r=>this.onItemClick(r);this.KBd=r=>{k.g(r.Ca);this.raiseEvent(m.a5a);this.raiseEvent(m.vPd);return!0};this.onScroll=
r=>{k.g(r);this.kHd();this.raiseEvent(m.a5a)};this.onBlur=r=>{k.g(r);this.kHd()};this.onPointerDown=()=>{this.kHd();this.raiseEvent(m.a5a);this.raiseEvent(m.VPa);return!1};this.aFb=r=>{const v=r.Ca;if(v.button===Sys.UI.MouseButton.leftButton||v.button===Sys.UI.MouseButton.rightButton||v.type.includes("touch"))this.Lj=this.zac(v),this.onPointerDown(r);this.raiseEvent(m.Esd);return!1};this.jb=u;this.iCb=w;this.lBa(!0)}C9(u){this.get_events().addHandler(m.a5a,u)}mda(u){this.get_events().removeHandler(m.a5a,
u)}OZb(u){this.get_events().addHandler(m.fld,u)}ltc(u){this.get_events().removeHandler(m.fld,u)}Fnb(u){this.get_events().addHandler(m.vPd,u)}fJb(u){this.get_events().removeHandler(m.vPd,u)}Dnb(u){this.get_events().addHandler(m.VPa,u)}cJb(u){this.get_events().removeHandler(m.VPa,u)}EVc(u){this.get_events().addHandler(m.Esd,u)}tKd(u){this.get_events().removeHandler(m.Esd,u)}get Lj(){return this._selectedRowListBox}set Lj(u){this.CBa(this._selectedRowListBox);u?(this._selectedRowListBox=u,this.CBa(this._selectedRowListBox),
this.uvc(u)):this._selectedRowListBox=null}get f_(){return this.iCb.ListCellClass}get Xba(){return this.iCb.ListTableClass}get fI(){return 8}get eDb(){return 5}get dkc(){return 24}get ckc(){return 35}get gg(){return this.domElement}get $(){return this.jb}dispose(){this.E7(!1);this.lBa(!1);c.a.qc([this.WNa]);this.WNa=null;super.dispose()}zac(u){return e.DOMElementExtensions.Sed(u.target,"tr",!0)}vB(u){if(u){if(!this.Lj){var t=this.zn;if(!t||!t.rows.length)return;this.Lj=t.rows[0];0<u?u--:u++}t=this.Lj;
for(let w=0,r=Math.abs(u);w<r;w++)if(0>u){if(!t.previousSibling)break;t=t.previousSibling}else{if(!t.nextSibling)break;t=t.nextSibling}t&&(this.Lj=t)}}knb(u,t){e.DOMElementExtensions.toggleCssClass(u,this.iCb.ListTableClassInTouch,t)}E7(u){const t=this.zn;t&&(u&&!this.ekc?(b.a.instance.ra(d.a.click,t,this.kAf),b.a.instance.ra(d.a.xk,t,this.KBd),f.a.instance.ra(d.a.pointerDown,t,this.aFb),this.ekc=!0):this.ekc&&(b.a.instance.Ba(d.a.click,t,this.kAf),b.a.instance.Ba(d.a.xk,t,this.KBd),f.a.instance.Ba(d.a.pointerDown,
t,this.aFb),this.ekc=!1))}CBa(u){let t=null;u&&(t=e.DOMElementExtensions.fk(u,this.iCb.ListCellClass))&&t.classList.toggle(this.iCb.ListCellSelectedClass);return t}lBa(u){this.gg&&(u&&!this.aR?(this.WNa=this.ve.$d(this.gg),this.WNa.ka("scroll",this.onScroll),this.WNa.ka("blur",this.onBlur),f.a.instance.ra(d.a.pointerDown,this.domElement,this.onPointerDown),this.aR=!0):this.aR&&(c.a.Ia(this.WNa),this.WNa=null,f.a.instance.Ba(d.a.pointerDown,this.domElement,this.onPointerDown),this.aR=!1))}onItemClick(u){return this.KBd(u)}uvc(u){if(u){var t=
u.offsetTop,w=this.gg.scrollTop;t<w?this.XXf(!0):t+u.offsetHeight>w+this.gg.clientHeight&&this.XXf(!1)}}XXf(u){this.gg.scrollTop=u?this.Lj.offsetTop:this.Lj.offsetTop+this.Lj.offsetHeight-this.gg.clientHeight}kHd(){l.g(this.$).eb&&this.raiseEvent(m.fld)}}m.a5a="GotFocus";m.fld="IgnoreBlur";m.vPd="SetCell";m.VPa="PointerDown";m.Esd="ItemPointerDown";Object(n.a)(m,"ListBox",C.a,[629,10])},909:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(22);class b{compare(d,f){return c.a.compare(d,
f,!0)}}Object(n.a)(b,"IgnoreCaseComparer",null,[437])},910:function(n,C,a){a.d(C,"a",function(){return f});n=a(0);var c=a(24),b=a(11),d=a(200);class f{constructor(e,k){this.Ea=e;this.b3a=k}lLb(e,k,l){const m=k.Border;k=k.BorderFormat;let u=0,t=!1;if(0===m)e.cell.Cbb(),this.yIb(e.cell.getRange());else{for(let w=0;3>=w;w++)f.iwj(e,l,w,m)&&(u|=b.HelperMethods.Y3a(w),this.EZd(e.cell.getRange(),w,k),t=!0);b.HelperMethods.SQ(m,16)&&!d.c(e,0,l)&&(u|=2,this.EZd(e.cell.getRange(),0,k),t=!0);b.HelperMethods.SQ(m,
32)&&!d.c(e,2,l)&&(u|=4,this.EZd(e.cell.getRange(),2,k),t=!0);t&&(l=e.cell.$x.tf,b.HelperMethods.SQ(u,2)&&this.C3f(e,l,0)&&(u&=-3),b.HelperMethods.SQ(u,1)&&this.B3f(e,l,1)&&(u&=-2),b.HelperMethods.SQ(u,4)&&this.C3f(e,l,2)&&(u&=-5),b.HelperMethods.SQ(u,8)&&this.B3f(e,l,3)&&(u&=-9),e.cell.setBorders(k,u,!1))}}vQ(e,k){e=f.rXe(e,k);return e.Ez?(e=this.Ea.nja(e))&&e.length?e:null:null}yIb(e){for(let l=0;3>=l;l++){var k=f.rXe(e,l);if(!k.Ez)continue;k=this.Ea.nja(k);if(!k||!k.length)continue;const m=f.K1e(l);
for(let u=0;u<k.length;u++)k[u].OQa(m)}}EZd(e,k,l){if(e=this.vQ(e,k)){var m=f.K1e(k),u=b.HelperMethods.Y3a(m);for(let t=0;t<e.length;t++){const w=e[t];this.sfi(w,m)&&f.setBorders(w,l,u,k,m)}}}sfi(e,k){const l=e.$x.tf;var m=e.getRange();m=this.vQ(m,k);let u=!1,t=!1,w=!1,r=!1;m&&(u=f.W6a(m,!0),t=f.W6a(m,!1),r=f.Kpd(m),w=1===m.length?!0:!1);switch(k){case 0:return f.Kei(e,l,r,t,w);case 1:return f.Hei(e,l,r,u,w);case 2:return f.Iei(e,l,r,u,w);case 3:return f.Jei(e,l,r,t,w)}return!1}C3f(e,k,l){if(!e.cell.FF)return!1;
const m=e.range,u=this.vQ(m,l),t=d.c(e,l,k);let w=!1;k=0===l?m.top<k.top:m.left<k.left;!f.Yzb(e.cell)&&u&&1!==u.length&&(w=(0===l?f.W6a(u,!0):f.W6a(u,!1))?!1:!0);return!t&&w||k?!0:!1}B3f(e,k,l){const m=e.cell,u=this.vQ(m.getRange(),l);e=d.c(e,l,k);k=!1;if(u){const w=f.W6a(u,!0);var t=f.W6a(u,!1);const r=w&&!t;t=t&&!w;1!==l||f.XAb(m)?3!==l||f.Nzb(m)||f.pwj(m,u,t,r)&&(k=!0):f.owj(m,u,w,t)&&(k=!0)}return!e&&k||f.Yzb(m)?!0:!1}static eRg(e,k,l){const m={};m.LineStyle=Array(4);m.LineStyle[l]=e.LineStyle[k];
m.Color=Array(4);m.Color[l]=e.Color[k];return m}static $cf(e,k,l,m,u){return b.HelperMethods.SQ(e,u)&&d.c(k,l,m)}static iwj(e,k,l,m){return f.$cf(m,e,l,k,b.HelperMethods.Y3a(l))||f.$cf(m,e,l,k,64)||112===m}static setBorders(e,k,l,m,u){k=f.eRg(k,m,u);e.setBorders(k,l,!1)}static rXe(e,k){switch(k){case 0:return new c.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new c.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new c.Range(e.bottom+1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new c.Range(e.top,
e.right+1,e.bottom,e.right+1,!1,!1)}return e}static K1e(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}}static W6a(e,k){for(let l=0;l<e.length;l++){const m=e[l];if(m.FF)return k?f.Nzb(m):f.XAb(m)}return!1}static Yzb(e){const k=e.$x.tf,l=e.getRange();return e.FF&&(l.top<k.top||l.bottom>k.bottom||l.left<k.left||l.right>k.right)?!0:!1}static Kpd(e){for(let k=0;k<e.length;k++)if(f.Yzb(e[k]))return!0;return!1}static owj(e,k,l,m){if(!e.FF){if(!l||f.Kpd(k))return!0}else if(f.Nzb(e)&&
(1===k.length&&f.uMg(e,k[0])||!l))return!0;return m}static pwj(e,k,l,m){if(!e.FF){if(!l||f.Kpd(k))return!0}else if(f.XAb(e)&&(1===k.length&&f.vMg(e,k[0])||!l))return!0;return e.Ska||m}static Kei(e,k,l,m,u){const t=e.getRange();return f.Nzb(e)?f.Yzb(e)||u:k.top===t.top||!m||l}static Hei(e,k,l,m,u){const t=e.getRange();return f.Nzb(e)?k.bottom===t.bottom&&u:m&&!l||k.bottom===t.bottom}static Iei(e,k,l,m,u){const t=e.getRange();return f.XAb(e)?f.Yzb(e)||u:k.left===t.left||!m||l}static Jei(e,k,l,m,u){const t=
e.getRange();return e.Ska?!1:f.XAb(e)?k.right===t.right&&u:m&&!l||k.right===t.right}static Nzb(e){return 0<e.getRange().right-e.getRange().left}static XAb(e){return 0<e.getRange().bottom-e.getRange().top}static vMg(e,k){e=e.getRange();k=k.getRange();return e.top===k.top&&e.bottom===k.bottom}static uMg(e,k){e=e.getRange();k=k.getRange();return e.left===k.left&&e.right===k.right}}Object(n.a)(f,"BorderModelAccessorHelper",null,[])},912:function(n,C,a){a.d(C,"a",function(){return e});n=a(0);var c=a(86);
C=a(93);var b=a(47),d=a(45),f=a(71);class e extends C.a{constructor(k,l){super(l.textBox.domElement);this.$Xc=null;this.yGi=()=>{this.lAd()};this.cyf=(m,u)=>{this.Lf(m,u)};this.gyf=(m,u)=>{this.qh(m,u)};this.jb=k;this.bJ=l;l.z2&&(l.z2.add(this),l.Vk(this.gyf),l.lm(this.cyf))}get $(){return this.jb}get Ya(){return this.bJ}dispose(){const k=this.bJ;if(null===k||void 0===k?0:k.z2)k.z2.remove(this),k.Ak(this.gyf),k.Fl(this.cyf);c.a.Ia(this.$Xc);this.bJ=null;super.dispose()}Yh(k,l){switch(l){case -1470715894:case -1231471547:this.sY(!1);
break;default:if(this.NGd(k,l))return f.g(k),!0;e.lki(l)||this.sY(!1)}return!1}sY(){c.a.Ia(this.$Xc);this.$Xc=b.a.instance.create(this.yGi,10,d.a.Psi)}qh(){this.sY(!1)}static lki(k){switch(k){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1}}Object(n.a)(e,"ListAutoCompleteBehavior",C.a,[628,10])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kpae.js.map/9f23c57265312b4d561bfb9a0fa4fa81/EwaDSEsNext.kpae.js.map