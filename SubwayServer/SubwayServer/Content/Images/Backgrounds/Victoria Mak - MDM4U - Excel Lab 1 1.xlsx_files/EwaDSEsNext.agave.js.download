/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1143:function(n,C,a){n=a(0);var c=a(15),b=a(694),d=a(77),f=a(37);class e{constructor(eb,Fa){this.automateCommandManager=eb;this.$=Fa}Lc(){return!1}executeCommand(eb,Fa,tb){eb=f.TaskExtensions.ak();Fa=Fa.command;switch(Fa){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 1043696663:case 971811139:case -2126202430:case 1623358083:this.$.fd(2045014907,-1,0,null),this.automateCommandManager.Ntd(Fa,
1904816141===Fa?tb[d.a.Qc].toString():null)}return eb}Ac(eb,Fa){eb=!1;switch(Fa.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case -2126202430:case 1623358083:case 1904816141:case 1043696663:case 1606046412:eb=this.$.QZ}return eb}Oc(eb,Fa,tb){return"PopulateAutomateGalleryMenu"===Fa&&this.$.QZ?(this.automateCommandManager.Oc(Fa,tb),!0):!1}}Object(n.a)(e,"AutomateCommandHandler",null,[164]);var k=a(457);class l extends b.a{constructor(eb){super(eb)}vd(){k.a(this.$,374,375,
this.fb,()=>{const eb=this.$.da.za(352);eb?this.$c([new e(eb,this.$)]):c.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})}static ka(eb){eb.da.Ga(308,new l(eb))}}Object(n.a)(l,"AutomateCommandHandlerFactory",b.a,[]);b=a(222);var m=a(7),u=a(4);class t{constructor(){this.token=null;this.timeStamp=0}}Object(n.a)(t,"AuthContext",null,[]);var w=a(723),r=a(132),v=a(110),y=a(28),x=a(765),B=a(172),z=a(69);class A{constructor(eb,Fa,tb){var dc,
jc;this.$=eb;this.oAuthManager=Fa;this.Wu=tb;this.y2=new t;this.Mob=null!==(jc=null===(dc=this.oAuthManager)||void 0===dc?void 0:dc.qMa())&&void 0!==jc?jc:!1}getAuthContext(){return this.y2}Maa(){const eb=y.a.Pa.zb,Fa=[];if(this.oAuthManager)Fa.push(Object(m.a)(new z.a,{name:"IsAuthSupported",bool:this.Mob}));else return this.Jia(Fa,eb,"need_OAuthManager","No OAuthManager");if(!this.Wu.yn||!this.Wu.yn.value)return this.Jia(Fa,eb,"need_license","No License");if(u.AFrameworkApplication.fa.qa("IsAnonymousUser"))return this.Jia(Fa,
eb,"need_user","Anonymous User");if(33E5>Date.now()-this.y2.timeStamp)return Fa.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!0})),B.a(r.a.N9a,!0,0,Fa),Promise.resolve(Object(m.a)(new x.a,{IsSuccess:!0,Token:this.y2.token}));Fa.push(Object(m.a)(new z.a,{name:"UsedCachedToken",bool:!1}));let tb=1;const dc=(jc,fb)=>(new Promise(ec=>{window.setTimeout(()=>{ec(jc)},fb)})).then(ec=>{Fa.push(Object(m.a)(new z.a,{name:"Error"+tb,string:ec.ErrorMessage}));Fa.push(Object(m.a)(new z.a,{name:"ErrorCode"+
tb,string:ec.ErrorCode}));tb++;return this.OOb()});return this.OOb().catch(jc=>dc(jc,200)).catch(jc=>dc(jc,400)).then(jc=>{jc.IsSuccess?(this.y2.token=jc.Token,this.y2.timeStamp=Date.now()):(Fa.push(Object(m.a)(new z.a,{name:"Error"+tb,string:jc.ErrorMessage})),Fa.push(Object(m.a)(new z.a,{name:"ErrorCode"+tb,string:jc.ErrorCode})));Fa.push(Object(m.a)(new z.a,{name:"Attempts",int64:tb}));Fa.push(Object(m.a)(new z.a,{name:"Error",string:jc.ErrorMessage}));Fa.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:jc.ErrorCode}));B.a(r.a.N9a,jc.IsSuccess,v.getElapsedMilliseconds(eb,y.a.Pa.zb),Fa);return Promise.resolve(jc)}).catch(jc=>{Fa.push(Object(m.a)(new z.a,{name:"Error"+tb,string:jc.ErrorMessage}));Fa.push(Object(m.a)(new z.a,{name:"ErrorCode"+tb,string:jc.ErrorCode}));Fa.push(Object(m.a)(new z.a,{name:"Attempts",int64:tb}));return this.Jia(Fa,eb,jc.ErrorCode,jc.ErrorMessage)})}Jia(eb,Fa,tb,dc){eb.push(Object(m.a)(new z.a,{name:"Error",string:dc}));eb.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:tb}));B.a(r.a.N9a,!1,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),eb);return Promise.resolve(Object(m.a)(new x.a,{IsSuccess:!1,ErrorMessage:dc,ErrorCode:tb}))}OOb(){var eb=w.a.Khd();let Fa=0;eb=this.oAuthManager.CL("Maker",eb).then(tb=>{if(tb)return!tb.IsSuccess&&this.ySd(tb)?Promise.reject(tb):Promise.resolve(tb);tb=Object(m.a)(new x.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(tb)}).catch(tb=>{let dc=new x.a;Object.getType(tb)===Object.getType(dc)?
dc=tb:(dc.ErrorMessage=tb.toString(),dc.ErrorCode="exception");return Promise.reject(dc)});return Promise.race([eb,new Promise((tb,dc)=>{Fa=window.setTimeout(()=>{dc(Object(m.a)(new x.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(tb=>{window.clearTimeout(Fa);return tb})}ySd(eb){return"interaction_required"===eb.ErrorCode||"InitFailed"===eb.ErrorCode||"invalid_resource"===eb.ErrorCode||"login_required"===eb.ErrorCode&&eb.ErrorMessage.startsWith("AADSTS500341")?
!1:!0}}Object(n.a)(A,"AutomateCommandAuth",null,[379]);var I=a(814);class F{constructor(){this.vu=null}}Object(n.a)(F,"AutomateCommandGalleryBase",null,[]);var U=a(374),X=a(30),T=a(561),G=a(1385),D=a(19),J=a(53),L=a(14);a(311);var H=a(579);class R{constructor(eb,Fa){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=eb;this.currentUserMlapiToken=Fa}}Object(n.a)(R,"UserInfo",null,[]);var Q=a(515),O=a(171),V=a(61),W=a(33),da=a(1),ta=a(281);const K=eb=>"TestHost"===eb.ya.DocumentHostInfo.HostTier,
na=(eb,Fa)=>{Fa.WacTaskPaneInfra=W.a.od(eb);Fa.TaskpanelessRFB=da.EwaSettings.getBooleanFeatureGate(w.a.SNb,!1);Fa.OfficeScriptsAutomateTask=w.a.oEb;Fa.DeferAdminCheck=w.a.Lta;Fa.SharedScriptsButton=P()},P=()=>da.EwaSettings.getBooleanFeatureGate(w.a.ARd,!1),ka=(eb,Fa)=>{K(eb)&&(da.EwaSettings.getBooleanFeatureGate(w.a.tla,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(eb.ya.UserSessionId);makerstorage.setUserAccessInfo(new R(Fa,
null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")},pa=eb=>{if(K(eb))return da.EwaSettings.getBooleanFeatureGate(w.a.tla,!1)?"makerservicelocal":"localstorage";eb=w.a.IKa();return w.a.Fwb(eb)},Na=(eb,Fa,tb,dc,jc)=>{const fb=eb.userOperationManager,ec=eb.pa;let lb=null,ac=null,Gb=null;const wb=()=>{if(fb.fta()||0<ec.va.FU||0<ec.Hk.FU)return!1;lb&&fb.ho(lb);ac&&ec.Fs(ac);Gb&&ec.yy(Gb);const qc=(Ya,xb,wc)=>V.g(ec.va,"ExecuteRichApiRequest",dc,ta.b(Ya,Fa),ta.a(xb,tb),wc,null,
0);da.EwaSettings.$b()?fb.cs(new O.a(507,0,qc,80)):fb.cs(new Q.a(507,0,qc,16));return!0};wb()||(lb=()=>{wb()},ac=()=>{wb()},Gb=()=>{wb()},fb.nr(lb),ec.pr(ac),ec.ux(Gb));return jc.task},Z=eb=>{eb=eb.pa.va.Na(1);eb.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return eb},Ra=eb=>W.a.od(eb)?eb.isChromeRtl?D.a.ZOe:D.a.YOe:D.a.lJa,Da=
eb=>W.a.od(eb)?D.a.V9c:D.a.U9c;class Ba{constructor(eb,Fa){this.automateCommandManager=eb;this.$=Fa}ddd(eb){const Fa=this.automateCommandManager.Ua.Up().yC();if(!P()){var tb=Ba.XE(eb,L.a.instance.ga(2137));this.UFa(tb,w.a.TCd,this.automateCommandManager.Nd,w.a.Hzd,L.a.instance.ga(2133),this.automateCommandManager.Ua);Fa.MenuSectionList.push(tb)}tb=Ba.XE(eb,L.a.instance.ga(2138));this.UFa(tb,w.a.gyd,w.a.Dw?this.automateCommandManager.Rh.iub(this.automateCommandManager.Nd):this.automateCommandManager.pg.iub(this.automateCommandManager.Nd),
w.a.fEb,L.a.instance.ga(2134),this.automateCommandManager.Ua);Fa.MenuSectionList.push(tb);tb=Ba.XE(eb,L.a.instance.ga(2139));this.UFa(tb,w.a.ANd,this.automateCommandManager.Qk,w.a.fEb,"",this.automateCommandManager.Ua);Fa.MenuSectionList.push(tb);tb=Object(m.a)(new U.a,{Id:w.a.Tnb,ExternalId:w.a.Tnb,Command:"1606046412",LabelText:L.a.instance.ga(2130),Alt:L.a.instance.ga(2131),Image16by16:J.a.Ue(16),Image16by16Class:D.a.Z9c,Visible:!0});eb=Ba.XE(eb,null);eb.ControlsId="myScriptsSection.Controls";
if(P()){const dc=Object(m.a)(new U.a,{Id:w.a.WLb,ExternalId:w.a.WLb,Command:"1043696663",LabelText:L.a.instance.ga(2140),Alt:L.a.instance.ga(2140),ExternalImageId:"PeopleSharedIcon_16",Visible:!0});eb.ControlList.push(dc)}eb.ControlList.push(tb);Fa.MenuSectionList.push(eb);return Fa}UFa(eb,Fa,tb,dc,jc,fb){if(tb&&0<tb.length){Fa=fb.ZA(Fa,1,"Size150by20").ppb();jc={};fb={};fb.root=Ba.CY(320,30);fb.flexContainer=Ba.$3c(!1);fb.label=Ba.s4c(!1);jc.galleryButtonInExpanded=fb;Fa.GalleryStyle=jc;for(jc=0;jc<
tb.length&&jc<dc;jc++)fb=tb.rw(jc),Fa.GalleryItems.push(Ba.ZHa(fb.id,fb));eb.ControlList.push(Fa)}else tb=Object(m.a)(new H.a,{Id:Fa,ExternalId:Fa,LabelText:jc}),eb.ControlsId=tb.Id+".Controls",eb.ControlList.push(tb)}static fGh(eb){if(eb){const Fa=String.format(w.a.pbf,eb.isShared?w.a.hbg:w.a.PXf,J.a.Ue(16));eb=String.format(w.a.qbf,X.a.zg(eb.name));return String.format(w.a.obf,Fa,eb)}return""}static XE(eb,Fa){return Object(m.a)(new T.a,{Id:eb,Title:Fa,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,
ShowMenuSectionTitleIcon:!0,ControlList:[]})}static ZHa(eb,Fa){const tb=w.a.mYd,dc=w.a.TNd,jc=w.a.nYd,fb=w.a.UNd;return Fa?Ba.Arb(Fa.shareId||Fa.id,"1904816141",Fa.name,Fa.isShared&&!P()?tb:dc,eb,eb,Fa.isShared&&!P()?jc:fb):Ba.Arb("","1904816141","","",eb,eb)}static Arb(eb,Fa,tb,dc,jc=null,fb=null,ec=null){const lb={},ac={};lb.root=Ba.CY(20,20);ac.root=Ba.CY(20,20);return Object(m.a)(new G.a,{Id:eb,ExternalId:jc||eb,MenuItemId:fb||eb,Command:Fa,Icon:dc,Image:J.a.Ue(16),ImageClass:ec,LabelText:tb,
FullIconStyle:lb,PreviewIconStyle:ac,Alt:tb})}static $3c(eb){const Fa={display:"flex"};eb?Fa.flexDirection="column":(Fa.height="100%",Fa.flexWrap="nowrap",Fa.justifyContent="left",Fa.alignItems="left",Fa.lineHeight="normal");return Fa}static s4c(eb){const Fa={margin:"0px 3px"};eb&&(Fa["max-width"]="68px");return Fa}static CY(eb,Fa){const tb={};tb.width=eb;tb["min-width"]=eb;tb.height=Fa;return tb}}Object(n.a)(Ba,"AutomateCommandRenderer",null,[]);class ea{constructor(eb,Fa){this.scripts=eb;this.cNb=
Fa}get length(){return this.scripts.length}YM(eb){for(let Fa=0;Fa<this.scripts.length;Fa++)if(this.scripts[Fa].id===eb||this.scripts[Fa].shareId===eb)return Fa;return-1}sort(){this.cNb(this.scripts)}Nh(eb){return-1===this.YM(eb.id)?(this.scripts.push(eb),!0):!1}TFa(eb){return-1===this.YM(eb.id)?(this.scripts=[eb].concat(this.scripts),!0):!1}Sxd(eb){eb=this.YM(eb.id);if(-1!==eb){for(var Fa=this.scripts[eb].VT();0<eb;)this.scripts[eb]=this.scripts[eb-1],eb--;this.scripts[0]=Fa}}$W(eb){const Fa=this.YM(eb.id);
if(-1!==Fa){const tb=this.scripts[Fa].shareId;this.scripts[Fa]=eb;this.scripts[Fa].shareId=tb}}aAb(eb){const Fa=this.YM(eb.id);return-1!==Fa?eb.name===this.scripts[Fa].name:!1}mU(eb){eb=this.YM(eb);return-1!==eb?(this.scripts.splice(eb,1),!0):!1}clear(){this.scripts=[]}getScripts(){return this.scripts}Om(eb){eb=this.YM(eb);return-1!==eb?this.scripts[eb]:null}rw(eb){return 0<=eb&&this.length>eb?this.scripts[eb]:null}iub(eb){const Fa=new ea([],this.cNb);for(let tb=0;tb<this.scripts.length;tb++){const dc=
this.scripts[tb];eb.Om(dc.id)||Fa.Nh(dc)}return Fa}VW(){const eb=[];for(const Fa of this.scripts)eb.push(Fa.Seb());return eb}}Object(n.a)(ea,"ScriptCollection",null,[]);var Y=a(192);class ja{constructor(eb){this.hz=Y.b(eb)||{};this.shareId=this.shareId||null}get id(){return this.hz.id}get shareId(){return this.hz.shareId}set shareId(eb){this.hz.shareId=eb||null}get name(){return this.hz.name}get msb(){return this.hz.dateLastPublished}get body(){return this.hz.body}get description(){return this.hz.description}get gzb(){return this.hz.isCreator}get isShared(){return!!this.shareId&&
0<this.shareId.length}VT(){return new ja(this.hz)}Seb(){return this.hz}}Object(n.a)(ja,"ScriptCore",null,[]);var ca=a(41);class ba extends F{constructor(eb,Fa){super();this.$=eb;this.Oe=Fa}RKa(eb){switch(eb){case "1":case "2":case "3":case "4":case "5":case "6":return this.vu.rw(parseInt(eb,10)-1);default:return this.Oe.Rh.Om(eb)||this.Oe.pg.Om(eb)||this.Oe.Nd.Om(eb)||this.Oe.Qk.Om(eb)}}s4a(eb,Fa){let tb=null;if(this.Oe.r4)switch(eb){case "1":case "2":case "3":case "4":case "5":case "6":tb=this.vu.rw(parseInt(eb,
10)-1);break;default:tb=this.vu.Om(eb)}W.a.isReactRibbonEnabled()?Fa[I.a.GalleryButtonProps]=Ba.ZHa(eb,tb):Fa[I.a.InnerHTML]=Ba.fGh(tb);Fa[I.a.Alt]=tb?tb.name:""}Hp(eb){this.vu=this.xQa();this.$.$e();const Fa=[];Fa.push(Object(m.a)(new z.a,{name:"Operation",string:eb}));Fa.push(Object(m.a)(new z.a,{name:"HasReadRecentCachedScripts",bool:this.Oe.Zja}));Fa.push(Object(m.a)(new z.a,{name:"ReadScriptsDone",bool:this.Oe.uLa}));Fa.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Oe.R6}));
Fa.push(Object(m.a)(new z.a,{name:"SamplesScriptCount",int64:this.Oe.Qk.length}));Fa.push(Object(m.a)(new z.a,{name:"ReadRecentScriptsDone",bool:this.Oe.gW}));Fa.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.Oe.Rh.length}));Fa.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Oe.Cs}));Fa.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Oe.Nd.length}));B.a(r.a.Nmc,!0,0,Fa)}n5a(eb){let Fa=!1,tb="";const dc=new ja(eb.scriptMetadata),jc={Operation:"HandleRefreshRibbonGallery"};
jc.RefreshOperation=eb.operationName;switch(eb.operationName){case w.a.gIb:({message:tb,returnValue:Fa}=this.pLa(dc));break;case w.a.eIb:({message:tb,returnValue:Fa}=this.nLa(dc));break;case w.a.dIb:({message:tb,returnValue:Fa}=this.mLa(dc));break;case w.a.fIb:({message:tb,returnValue:Fa}=this.oLa(dc));break;case w.a.FId:({message:tb,returnValue:Fa}=this.hjd(dc))}(jc.GalleryUpdated=Fa)?(c.ULS.sendTraceTag(537170322,0,50,`AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: ${tb}`),this.Hp("RefreshGallery")):
c.ULS.sendTraceTag(537170321,0,15,`AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: ${tb}`);jc.Message=tb;c.ULS.sendTraceTag(537170320,0,50,ca.c(jc))}xQa(){const eb=new ea([],()=>{}),Fa=this.Oe.Nd?this.Oe.Nd.length:0,tb=this.Oe.Rh?this.Oe.Rh.length:0,dc=this.Oe.Qk?this.Oe.Qk.length:0;let jc=0,fb=w.a.fHb;for(let ec=0;ec<fb;ec++)if(ec<Fa)eb.Nh(this.Oe.Nd.rw(ec));else if(ec-Fa+jc<tb){const lb=this.Oe.Rh.rw(ec-Fa+jc);this.Oe.Nd.Om(lb.id)?(jc++,ec--):eb.Nh(lb)}else ec-
Fa-tb+jc<dc&&eb.Nh(this.Oe.Qk.rw(ec-Fa+jc-tb));return eb}pLa(eb){let Fa;if(this.Oe.Rh.TFa(eb))Fa="";else{Fa="";const tb=eb.VT();this.Oe.Nd.$W(tb);this.Oe.Nd.sort();this.Oe.Rh.$W(eb)}return{returnValue:!0,message:Fa}}nLa(eb){this.Oe.Nd.mU(eb.id);return this.Oe.Rh.mU(eb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}}mLa(eb){const Fa=eb.VT();Fa.shareId=null;this.Oe.Rh.TFa(Fa);return this.Oe.Nd.Nh(eb)?(this.Oe.Nd.sort(),
{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}oLa(eb){return this.Oe.Nd.mU(eb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}hjd(eb){const Fa=eb.VT();let tb=!1;this.Oe.Nd.aAb(Fa)&&(this.Oe.Nd.$W(Fa),this.Oe.Nd.sort(),tb=!0);this.Oe.Rh.TFa(eb)?tb=!0:this.Oe.Rh.aAb(eb)&&(this.Oe.Rh.$W(eb),this.Oe.Rh.Sxd(eb),tb=!0);return{returnValue:tb,message:""}}}Object(n.a)(ba,
"AutomateCommandGallery",F,[]);var ua=a(83);class wa{constructor(){this.yn=null}}Object(n.a)(wa,"AutomateCommandLicensingBase",null,[]);class ia{constructor(eb,Fa,tb=null,dc="",jc=""){this.value=eb;this.isSuccess=Fa;this.timeStamp=tb;this.errorCode=dc;this.errorMessage=jc}}Object(n.a)(ia,"BoolResultWrapper",null,[]);class xa extends wa{constructor(){super()}Rsa(){const eb=y.a.Pa.zb,Fa=[];return new Promise(tb=>{ua.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(dc=>
{dc.isFeatureEnabled("ExcelOfficeScripting",!1).then(jc=>{Fa.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:jc}));B.a(r.a.Jmc,!0,v.getElapsedMilliseconds(eb,y.a.Pa.zb),Fa);this.yn=new ia(jc,!0);tb(jc)}).catch(jc=>{Fa.push(Object(m.a)(new z.a,{name:"IsLicensed",bool:!1}));Fa.push(Object(m.a)(new z.a,{name:"Error",string:jc.toString()}));Fa.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"}));B.a(r.a.Jmc,!1,v.getElapsedMilliseconds(eb,y.a.Pa.zb),Fa);this.yn=new ia(!1,!1,void 0,"exception",
jc.toString());tb(!1)})})})}}Object(n.a)(xa,"AutomateCommandLicensing",wa,[]);var gb=a(1297),va=a(1295),sa=a(1294),ab=a(1296),Ua=a(1386),nb=a(27),Ha=a(173),sb=a(573),Qb=a(312),mb=a(5);class Pb{constructor(eb,Fa,tb,dc){this.Wxb=eb;this.jad=Fa;this.I_=tb;this.d3=dc}}Object(n.a)(Pb,"LaunchSDXParams",null,[]);class gc{constructor(eb,Fa,tb,dc,jc,fb){this.actionName=eb;this.shapeId=Fa;this.scriptLink=tb;this.clickId=dc;this.j5=jc;this.buttonText=fb}}Object(n.a)(gc,"RunfromButtonParameters",null,[]);var Xb=
a(160),Ca=a(58),ra=a(751),ma=a(51),hb=a(46),vb=a(159);class Va{constructor(eb,Fa,tb,dc,jc,fb,ec,lb,ac){this.OA=null;this.cache=new Qb.a;this.NZ=!1;this.lM={};this.$=eb;this.qlb=tb;this.indexedDB=dc;this.Rob=jc;this.Wu=fb;this.dha=ec;this.Oe=lb;this.tC=ac;this.DOg=new Ba(this,eb);this.KKc=y.a.Pa.zb;this.qNb="";dc.Xe()&&(this.NZ=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));eb=!0;if(nb.a.cZc){this.cache.Xe()&&!w.a.Lta&&(Fa=this.Oe.aYe(w.a.lKa(this.$)),Fa.isSuccess&&(eb=v.getElapsedSeconds(Fa.timeStamp,
y.a.Pa.zb),this.Wu.yn=new ia(!0,!0),this.OA=new ia(Fa.value,!0),eb=this.OA.value?604800<eb:86400<eb,this.qxb=this.PSa(!0)));this.tdd();if("undefined"!==typeof makerstorage&&this.R7a)if(this.qNb=pa(this.$),K(this.$))ka(this.$,"localstorageToken"),this.Wu.yn=new ia(!0,!0),this.OA=new ia(!0,!0),this.qxb=this.PSa(!0);else if((Fa=w.a.IKa())&&makerstorage.setStorageEnvironmentOverride(Fa),eb||w.a.Lta)try{this.$.ldb("automateTab",!0),this.qxb=w.a.Lta?this.Wu.Rsa().then(()=>this.dha.Maa()).then(()=>this.PSa(!1)).catch(()=>
this.PSa(!1)):this.Wu.Rsa().then(()=>this.dha.Maa()).then(Gb=>this.c5h(Gb)).then(()=>this.PSa(!1)).catch(()=>this.PSa(!1))}catch(Gb){c.ULS.sendTraceTag(537170314,0,15,`AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: ${Gb.message}`),this.qxb=Promise.resolve(!1),this.$.ldb("automateTab",!1)}this.qxb?this.qxb.then(Gb=>{this.pLd(Gb);this.Oe.Chd()}):this.pLd(!1)}else c.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),
this.pLd(!1)}get pg(){return this.Oe.pg}get Nd(){return P()?new ea([],()=>{}):this.Oe.Nd}get Qk(){return this.Oe.Qk}get Rh(){return this.Oe.Rh}get Ua(){return this.qlb}get r4(){return this.Oe.r4}get initTime(){return this.KKc}get j5(){const eb=!!this.Wu.yn&&this.Wu.yn.isSuccess&&this.Wu.yn.value;var Fa=!!this.OA&&!this.OA.isSuccess;const tb=!!this.OA&&this.Wu.yn.isSuccess&&this.OA.value;Fa=w.a.Lta||tb||Fa&&!nb.a.Rka(11);return this.R7a&&eb&&Fa}get R7a(){const eb="TestHost"===this.$.ya.DocumentHostInfo.HostTier;
var Fa=u.AFrameworkApplication.fa.Xa("UserPrincipalName");Fa=!u.AFrameworkApplication.fa.qa("IsAnonymousUser")&&!!Fa&&!Fa.includes("ext#")&&!Fa.includes("guest#");return!nb.a.Y4&&(eb||this.dha.Mob&&Fa)}PSa(eb){const Fa=u.AFrameworkApplication.fa.qa("IsO365CommercialHost");let tb="",dc="",jc=!1;var fb,ec=(fb=this.Wu.yn&&this.Wu.yn.isSuccess)&&this.Wu.yn.value;fb=w.a.Lta?fb:!(ec&&(!this.OA||!this.OA.isSuccess));this.Wu.yn&&!this.Wu.yn.isSuccess?(dc=this.Wu.yn.errorCode,tb=this.Wu.yn.errorMessage):this.OA&&
!this.OA.isSuccess&&(dc=this.OA.errorCode,tb=this.OA.errorMessage);ec=[];ec.push(Object(m.a)(new z.a,{name:"IsScriptingEnabled",bool:this.j5}));ec.push(Object(m.a)(new z.a,{name:"IsValidHost",bool:Fa}));ec.push(Object(m.a)(new z.a,{name:"IsUserLicensed",bool:this.Wu.yn?this.Wu.yn.value:!1}));w.a.Lta||ec.push(Object(m.a)(new z.a,{name:"IsAdminSwitchOn",bool:this.OA?this.OA.value:!1}));ec.push(Object(m.a)(new z.a,{name:"ShowTab",bool:this.j5}));w.a.Lta||ec.push(Object(m.a)(new z.a,{name:"ServiceChecked",
bool:!eb}));this.j5?W.a.qxa(this.$)&&(eb=Xb.a(this.$),(null===eb||void 0===eb?0:eb.cm)?(ec.push(Object(m.a)(new z.a,{name:"RibbonType",string:"React"})),eb.cm.ABj(mb.a.KHb),eb.cm.$wc(["AutomateAutomateTask"],!w.a.oEb),da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(jc=!0)):(dc="ribbon_manager_error",tb="The RibbonManager or RibbonUser is null")):this.U6h();
ec.push(Object(m.a)(new z.a,{name:"Error",string:tb}));ec.push(Object(m.a)(new z.a,{name:"ErrorCode",string:dc}));B.a(r.a.yFi,fb,v.getElapsedMilliseconds(this.initTime,y.a.Pa.zb),ec);this.$.ldb("automateTab",!1);return Promise.resolve(jc)}Oc(eb,Fa){if(!Fa)return!1;Fa.MenuItems=this.DOg.ddd(Fa.MenuId);return!0}JIf(){this.NZ&&(w.a.Dw?this.Oe.PHb(this.tC).continueWith(eb=>{eb.result&&this.tC.Hp(w.a.aO)}):this.Oe.XHd(this.tC));K(this.$)?this.Awb(Object(m.a)(new x.a,{IsSuccess:!0,Token:"FakeToken"})):
this.dha.Maa().then(eb=>{this.Awb(eb)})}s4a(eb,Fa,tb){if(w.a.Dw)this.tC.s4a(eb,Fa,tb);else{tb=null;if(this.Oe.r4)switch(eb){case "1":case "2":case "3":case "4":case "5":case "6":tb=this.tC.vu.rw(parseInt(eb,10)-1);break;default:tb=this.tC.vu.Om(eb)}Fa[I.a.GalleryButtonProps]=Ba.ZHa(eb,tb);Fa[I.a.Alt]=tb?tb.name:""}}n5a(eb){if(w.a.Dw)this.tC.n5a(eb);else{let Fa=!1,tb="";const dc=new ja(eb.scriptMetadata),jc={Operation:"HandleRefreshRibbonGallery"};jc.RefreshOperation=eb.operationName;switch(eb.operationName){case w.a.gIb:({message:tb,
returnValue:Fa}=this.pLa(dc));break;case w.a.eIb:({message:tb,returnValue:Fa}=this.nLa(dc));break;case w.a.dIb:({message:tb,returnValue:Fa}=this.mLa(dc));break;case w.a.fIb:({message:tb,returnValue:Fa}=this.oLa(dc))}(jc.GalleryUpdated=Fa)?(c.ULS.sendTraceTag(537170313,0,50,`AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: ${tb}`),this.Hp("RefreshGallery")):c.ULS.sendTraceTag(537170312,0,15,`AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: ${tb}`);
jc.Message=tb;c.ULS.sendTraceTag(537170311,0,50,ca.c(jc))}}q7e(eb,Fa,tb,dc){if(da.EwaSettings.isChangeGateEnabled("OfficeVSO:6254340_ExitCellEditModeOnRFBClick")||this.$.Sp(null,!1,1023))eb=new gc(w.a.hKb,eb,Fa,tb,this.j5,dc),this.Rob.cwa(eb)}kjd(eb,Fa,tb){eb=new gc(w.a.E0d,eb,Fa,tb,this.j5);this.Rob.cwa(eb)}f6e(eb){this.Rob.kLa(w.a.LTd,eb)}e6e(eb){this.Rob.kLa(w.a.M2c,eb)}g6e(eb){this.Rob.kLa(w.a.qVd,eb)}Ntd(eb,Fa){var tb=ma.b().ij(eb);const dc=[];dc.push(Object(m.a)(new z.a,{name:"SessionId",string:this.$.ya.UserSessionId}));
dc.push(Object(m.a)(new z.a,{name:"MenuItemId",string:Fa}));dc.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Nd.length}));dc.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.pg.length}));dc.push(Object(m.a)(new z.a,{name:"RecentScriptCount",int64:this.Rh.length}));dc.push(Object(m.a)(new z.a,{name:"Command",string:tb}));Fa=this.Vgd(eb,Fa);if(tb=this.Hfd(eb,tb,Fa))dc.push(Object(m.a)(new z.a,{name:w.a.HC,string:tb.I_.$g[w.a.HC]})),gb.a.instance.fla(tb.jad,"Taskpane",
tb.d3,tb.Wxb,tb.I_),1904816141===eb&&(dc.push(Object(m.a)(new z.a,{name:"ScriptId",string:Fa.id})),dc.push(Object(m.a)(new z.a,{name:"ShareId",string:Fa.shareId})),dc.push(Object(m.a)(new z.a,{name:"IsPreviewGallery",bool:!!this.tC.vu.Om(Fa.id)})),dc.push(Object(m.a)(new z.a,{name:"IsOwner",bool:Fa.gzb||!!this.pg.Om(Fa.id)})),this.$.$e());B.a(r.a.Nuf,void 0,void 0,dc)}Hfd(eb,Fa,tb){let dc=null;const jc=w.a.oq,fb=new va.a(w.a.Uxb,w.a.Hub,w.a.locale),ec=new sa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,
w.a.MRa),lb=new ab.a;lb.$g.AdminPolicyForFeedback=ca.c(this.lM);lb.$g.DocumentHostInfo=Ca.a.kc(this.$.ya.DocumentHostInfo);lb.$g.CodeEditorUrl=w.a.fZ(this.$);lb.$g.MakerTestService=da.EwaSettings.getBooleanFeatureGate(w.a.tla,!1);lb.$g[w.a.WJb]=w.a.PU(this.$);lb.$g.StorageModePreference=this.qNb||"";lb.$g.Source="Ribbon";lb.$g[w.a.RNb]=Ca.a.kc(jc);lb.$g[w.a.cpb]=this.$.Imc?"true":"false";lb.$g[w.a.HC]=Ha.a.create().toString();var ac=Ra(this.$);const Gb=Da(this.$);lb.optionalProperties.HeaderCssClass=
ac;lb.optionalProperties.TitleCssClass=Gb;lb.$g[w.a.Axb]=ac;lb.$g[w.a.pOb]=Gb;ac={};ac.ribbonCommand=Fa;ac[w.a.oNb]=this.dha.getAuthContext();ac[w.a.$V]=this.Oe.OHb?this.pg.VW():null;ac[w.a.o1d]=this.Oe.rQa?this.Nd.VW():null;w.a.Dw&&(ac[w.a.aO]=this.Oe.qQa?this.Rh.VW():null);lb.$g[w.a.Oyb]=Ca.a.kc(ac);Fa={};na(this.$,Fa);lb.$g[w.a.uub]=Ca.a.kc(Fa);switch(eb){case -45542983:lb.$g.Script="";lb.$g.Destination="Editor";lb.$g.IsOwner=!0;lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2126);lb.optionalProperties[Ua.a.taskPaneWidth]=
jc;lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.fZ(this.$);dc=w.a.Jha;break;case -1342227603:lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2128);lb.optionalProperties[Ua.a.taskPaneWidth]=jc;lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.Wbc(this.$);break;case 971811139:case 1606046412:lb.$g.Script="";lb.$g.Destination="BackStage";lb.$g.IsOwner=!0;lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2126);lb.optionalProperties[Ua.a.taskPaneWidth]=jc;lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=
w.a.fZ(this.$);dc=w.a.Jha;break;case 1043696663:lb.$g.Script="";lb.$g.Destination="BackStage_Workbook";lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2126);lb.optionalProperties[Ua.a.taskPaneWidth]=jc;lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.fZ(this.$);dc=w.a.Jha;break;case 1845457202:lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2127);lb.optionalProperties[Ua.a.taskPaneWidth]=jc;lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.bcc(this.$);dc=w.a.WNd;break;
case -2126202430:case 1623358083:case 1904816141:if(tb)lb.$g.Script=Ca.a.kc(tb.Seb()),lb.$g.Destination="Details",lb.$g.IsOwner=tb.gzb||!!this.pg.Om(tb.id),lb.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2126),lb.optionalProperties[Ua.a.taskPaneWidth]=jc,lb.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.fZ(this.$),dc=w.a.Jha;else return null;break;default:return null}return new Pb(fb,ec,lb,dc)}Vgd(eb,Fa){switch(eb){case -2126202430:eb=this.Oe.H7.Om(w.a.XNb);break;case 1623358083:eb=
this.Oe.H7.Om(w.a.YNb);break;default:eb=Fa?this.RKa(Fa):null}return eb}tdd(){ua.a.instance.Ub("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(eb=>{this.lM.FeedbackEnabled=!0;this.lM.ScreenshotEnabled=!0;this.lM.EmailEnabled=!0;eb.pF("Enabled").then(Fa=>{this.lM.FeedbackEnabled=Fa},()=>{});eb.pF("IncludeScreenshot").then(Fa=>{this.lM.ScreenshotEnabled=Fa},()=>{});eb.pF("IncludeEmail").then(Fa=>{this.lM.EmailEnabled=Fa},()=>{})})}c5h(eb){const Fa=y.a.Pa.zb,tb=[];if(!eb||!eb.IsSuccess){const dc=
eb?eb.ErrorCode:"need_token";eb=eb?eb.ErrorMessage:"No Access Token";tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1}));tb.push(Object(m.a)(new z.a,{name:"Error",string:eb}));tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:dc}));B.a(r.a.Vzd,!1,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);this.OA=new ia(!1,!1,void 0,dc,eb);return Promise.resolve(!1)}tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!0}));ka(this.$,eb.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(dc=>
{this.OA=new ia(dc.OfficeScriptingEnabled,!0);this.Oe.Awe(w.a.lKa(this.$),dc.OfficeScriptingEnabled);tb.push(Object(m.a)(new z.a,{name:"IsEnabled",bool:this.OA.value}));B.a(r.a.Vzd,!0,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);return Promise.resolve(this.OA.value)}).catch(dc=>{Object.getType(dc)===makerstorage.StorageServiceError?(tb.push(Object(m.a)(new z.a,{name:"Error",string:dc.message})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${dc.errorCode.toString()}_${dc.status.toString()}`}))):
(tb.push(Object(m.a)(new z.a,{name:"Error",string:dc.toString()})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.Vzd,!1,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);this.OA=new ia(!1,!1,void 0,"exception",dc.toString());return Promise.resolve(!1)})}Awb(eb){this.Oe.Rgd(this.tC);w.a.Dw?this.Oe.Igd(eb,this.tC,this.cache):this.Agd(eb);P()||this.Oe.WHd(Fa=>{this.Oe.ehd(Fa,eb,this.tC)},this.tC)}Agd(eb){const Fa=y.a.Pa.zb,tb=[];if(eb&&eb.IsSuccess){ka(this.$,eb.Token);var dc=
sb.a.create().toString();tb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:dc}));makerstorage.getScripts(dc).then(jc=>{tb.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Oe.u4}));this.pg.clear();for(const fb of jc)this.pg.Nh(new ja(fb));this.pg.sort();this.Oe.OHb=!0;this.Oe.fW=!0;this.NZ&&(jc=Ca.a.kc(this.pg.VW()),this.indexedDB.jna(new ra.a(w.a.$V,jc)));tb.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.pg.length}));B.a(r.a.qca,!0,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),
tb);this.Hp(w.a.$V)}).catch(jc=>{Object.getType(jc)===makerstorage.StorageServiceError?(tb.push(Object(m.a)(new z.a,{name:"Error",string:jc.message})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${jc.errorCode.toString()}_${jc.status.toString()}`})),17===jc.errorCode&&this.cache.EIb(w.a.lKa(this.$))):(tb.push(Object(m.a)(new z.a,{name:"Error",string:jc.toString()})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.qca,!1,v.getElapsedMilliseconds(Fa,
y.a.Pa.zb),tb);this.Oe.fW=!0;this.Hp(w.a.$V)})}else dc=eb?eb.ErrorCode:"need_token",eb=eb?eb.ErrorMessage:"No Access Token",tb.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1})),tb.push(Object(m.a)(new z.a,{name:"Error",string:eb})),tb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:dc})),B.a(r.a.qca,!1,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb),this.Oe.fW=!0,this.Hp(w.a.$V)}RKa(eb){if(w.a.Dw)return this.tC.RKa(eb);switch(eb){case "1":case "2":case "3":case "4":case "5":case "6":return this.tC.vu.rw(parseInt(eb,
10)-1);default:return this.pg.Om(eb)||this.Nd.Om(eb)||this.Qk.Om(eb)}}pLa(eb){let Fa;if(this.pg.Nh(eb))this.pg.sort(),Fa="";else{Fa="";const tb=eb.VT();this.Nd.$W(tb);this.Nd.sort();this.pg.$W(eb);this.pg.sort()}return{returnValue:!0,message:Fa}}nLa(eb){this.Nd.mU(eb.id);return this.pg.mU(eb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}}mLa(eb){const Fa=eb.VT();Fa.shareId=null;this.pg.Nh(Fa)&&this.pg.sort();return this.Nd.Nh(eb)?
(this.Nd.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}}oLa(eb){return this.Nd.mU(eb.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}}Hp(eb){if(w.a.Dw)this.tC.Hp(eb);else{this.xQa();this.$.$e();const Fa=[];Fa.push(Object(m.a)(new z.a,{name:"Operation",string:eb}));Fa.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Oe.u4}));Fa.push(Object(m.a)(new z.a,
{name:"ReadScriptsDone",bool:this.Oe.uLa}));Fa.push(Object(m.a)(new z.a,{name:"ReadSamplesScriptsDone",bool:this.Oe.R6}));Fa.push(Object(m.a)(new z.a,{name:"SamplesScriptCount",int64:this.Qk.length}));Fa.push(Object(m.a)(new z.a,{name:"ReadPublishedScriptsDone",bool:this.Oe.fW}));Fa.push(Object(m.a)(new z.a,{name:"PublishedScriptCount",int64:this.pg.length}));Fa.push(Object(m.a)(new z.a,{name:"ReadWorkbookScriptsDone",bool:this.Oe.Cs}));Fa.push(Object(m.a)(new z.a,{name:"WorkbookScriptCount",int64:this.Nd.length}));
B.a(r.a.Nmc,!0,0,Fa)}}xQa(){this.tC.vu=new ea([],()=>{});const eb=this.Nd?this.Nd.length:0,Fa=this.pg?this.pg.length:0,tb=this.Qk?this.Qk.length:0;let dc=0;const jc=w.a.fHb;for(let fb=0;fb<jc;fb++)if(fb<eb)this.tC.vu.Nh(this.Nd.rw(fb));else if(fb-eb+dc<Fa){const ec=this.pg.rw(fb-eb+dc);this.Nd.Om(ec.id)?(dc++,fb--):this.tC.vu.Nh(ec)}else fb-eb-Fa+dc<tb&&this.tC.vu.Nh(this.Qk.rw(fb-eb+dc-Fa))}pLd(eb){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&(eb?(hb.PageLoadTrackingInfo.instance.c0(mb.a.hO,["automateTab"]),hb.PageLoadTrackingInfo.instance.JR(mb.a.hO,["automateTab"]),hb.PageLoadTrackingInfo.instance.nW(mb.a.hO,["automateTab"])):hb.PageLoadTrackingInfo.instance.qda(mb.a.hO,["automateTab"]))}U6h(){da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&vb.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(mb.a.KHb))}}Object(n.a)(Va,"AutomateCommandManager",null,[376]);var db=a(1352),
oa=a(1299),Oa=a(248),Wa=a(858),Sa=a(50),yb=a(104),Ma=a(21),Bb=a(963);class Nb{constructor(eb,Fa,tb,dc){this.rV=!1;this.rca=()=>{this.oMb()?(this.YGb(),Ma.g(this.$).Ea.OIb(this.rca)):this.rV&&Ma.g(this.$).Ea.OIb(this.rca)};this.OAd=(jc,fb)=>{Object.getType(fb)===String&&fb.toString().endsWith(w.a.Qaa(this.$))&&(this.rV=!1)};this.$=eb;this.dha=Fa;this.Wu=tb;this.businessBarManager=dc;this.cRd()}cwa(eb){if(eb.j5){const Fa=[];Fa.push(Object(m.a)(new z.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.rV}));
Fa.push(Object(m.a)(new z.a,{name:"actionName",string:eb.actionName}));Fa.push(Object(m.a)(new z.a,{name:w.a.HC,string:eb.clickId.toString()}));this.rV?this.RKb(eb):this.Xid(eb);B.a(r.a.Ouf,void 0,void 0,Fa)}}kLa(eb,Fa){const tb={};tb[w.a.HC]=Fa;this.XRa(eb,tb)}cRd(){this.oMb()?this.YGb():Ma.g(this.$).Ea.kVc(this.rca)}oMb(){if(this.rV||K(this.$))return!1;const eb=yb.a(this.$);return Ma.g(this.$).Ea.Snb&&eb.Jcf()}YGb(){this.Wu.yn?this.Wu.yn.value&&this.dha.Maa():this.Wu.Rsa().then(eb=>{eb&&this.dha.Maa()});
B.a(r.a.Juf)}OOd(){const eb=Ha.a.create().toString();var Fa={};na(this.$,Fa);const tb={};tb[w.a.oNb]=this.dha.getAuthContext();const dc={};dc[w.a.uub]=Ca.a.kc(Fa);dc[w.a.Oyb]=Ca.a.kc(tb);dc[w.a.z7c]=Ca.a.kc(this.$.ya.DocumentHostInfo);dc[w.a.uVd]=pa(this.$);dc[w.a.RNb]=Ca.a.kc(w.a.oq);dc[w.a.cpb]=this.$.Imc?"true":"false";dc[w.a.WJb]=w.a.PU(this.$);dc[w.a.Axb]=Ra(this.$);dc[w.a.pOb]=Da(this.$);dc[w.a.HC]=eb;Fa=[];Fa.push(Object(m.a)(new z.a,{name:w.a.HC,string:eb}));B.a(r.a.Muf,void 0,void 0,Fa);
this.XRa(w.a.dmd,dc)}Xid(eb){this.WSd(eb);K(this.$)&&ka(this.$,"localstorage");f.TaskExtensions.Aa(Sa.GetServiceTaskFactory.Sa(this.$.da,374,375,1),Fa=>{this.wud(Fa.result).continueWith(()=>{this.NOd(eb)});this.rV=!0},this.$.la,3)}wud(eb){const Fa={};Fa.SolutionId=w.a.solutionId;Fa.Version=w.a.MRa;Fa.StoreType=OSF.StoreType.Sdx;Fa.StoreId=OSF.StoreType.Sdx;Fa.AssetId=w.a.solutionId;Fa.AssetStoreId=OSF.StoreType.Sdx;Fa.TargetType=1;Fa.SharedRuntimeId=w.a.Qaa(this.$);Fa.SourceLocationOverrideResourceId=
w.a.Qaa(this.$);Fa.IsToBePersisted=!1;const tb=new db.a;tb.Ui=L.a.instance.ga(2150);tb.taskPaneWidth=w.a.oq;const dc=new Wa.a;dc.STa=Da(this.$);dc.uZ=Ra(this.$);return eb.vKb(Fa,tb,void 0,void 0,dc)}NOd(eb){this.OOd();Oa.a(this.$)&&Oa.a(this.$).uVc(this.OAd);this.RKb(eb)}RKb(eb){const Fa={};Fa[w.a.uNd]=eb.shapeId;Fa[w.a.tNd]=eb.scriptLink;Fa[w.a.HC]=eb.clickId.toString();Fa[w.a.sNd]=eb.buttonText;this.XRa(eb.actionName,Fa)}XRa(eb,Fa){const tb=new sa.a(w.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,
w.a.MRa),dc=new va.a(w.a.Uxb,w.a.Hub,this.$.ya.UICultureTag),jc=new ab.a;jc.optionalProperties[Ua.a.Ui]=L.a.instance.ga(2150);jc.optionalProperties[Ua.a.sourceLocationOverrideResourceId]=w.a.Qaa(this.$);jc.optionalProperties[Ua.a.tYb]=Fa;jc.optionalProperties[Ua.a.taskPaneWidth]=w.a.oq;gb.a.instance.fla(tb,oa.a.action,eb,dc,jc)}WSd(eb){da.EwaSettings.getBooleanFeatureGate(w.a.SNb,!1)&&eb.actionName===w.a.hKb&&(eb=new Bb.a(eb.scriptLink,"initializing",eb.clickId.toString(),eb.buttonText),this.businessBarManager.ZUc(65,
eb))}}Object(n.a)(Nb,"AutomateCommandRunFromButton",null,[375]);var Ia=a(155),jb=a(22);class Ob{constructor(){this.Rh=null;this.u4=this.R6=this.Cs=this.fW=this.rQa=this.OHb=this.qQa=this.gW=this.Zja=!1;this.H7=this.Qk=this.Nd=this.pg=null}get r4(){const eb=w.a.Dw?this.Zja:this.u4;return this.R6||eb||this.uLa}get uLa(){return(w.a.Dw?this.gW:this.fW)&&this.Cs&&this.R6}static AUd(eb){eb.sort((Fa,tb)=>tb.msb-Fa.msb)}static Zna(eb){eb.sort((Fa,tb)=>jb.a.compare(Fa.name,tb.name,!0))}static phd(eb){let Fa,
tb;tb=Fa=null;if(eb){const dc=eb.indexOf(":");if(-1!==dc)return Fa=eb.substr(0,dc),tb=eb.substr(dc+1),{returnValue:!0,pNb:Fa,shareId:tb}}return{returnValue:!1,pNb:Fa,shareId:tb}}static $gd(eb,Fa){const tb={};tb[w.a.tQb]=encodeURIComponent(eb.workbookContext.WorkbookFileName);tb[w.a.AKb]=Fa.VW();return ca.c(tb)}static QHb(eb,Fa){return f.TaskExtensions.KJ(Fa.yja(w.a.Yoa),tb=>{tb=tb.result;if(""!==tb){var dc=ca.b(tb);tb=dc[w.a.AKb];if(dc[w.a.tQb]===encodeURIComponent(eb.workbookContext.WorkbookFileName)){dc=
new ea([],jc=>{Ob.Zna(jc)});for(const jc of tb)dc.Nh(new ja(jc));dc.sort();return dc}}},eb.la,3)}}Object(n.a)(Ob,"AutomateCommandStorageBase",null,[]);var Jb=a(116),Kb=a(99);class Qa extends Ob{constructor(eb,Fa){super();this.$=eb;this.eua=new DOMParser;this.cache=new Qb.a;this.indexedDB=Fa;Fa.Xe()&&this.indexedDB.initialize("Scripts","OfficeScriptingCache");this.u4=!1;this.pg=new ea([],tb=>{Ob.AUd(tb)});this.Nd=new ea([],tb=>{Ob.Zna(tb)});this.Qk=new ea([],tb=>{Ob.Zna(tb)});this.Rh=new ea([],()=>
{});this.H7=new ea([],tb=>{Ob.Zna(tb)})}Awe(eb,Fa){if(this.cache.Xe()){const tb={};tb.TimeStamp=y.a.Pa.zb;tb.IsEnabled=Fa;this.cache.Pwc(eb,Ca.a.kc(tb))}}aYe(eb){let Fa=!1,tb=!1,dc=null;this.cache.Xe()&&(eb=ca.b(this.cache.v4a(eb)))&&(tb=eb.IsEnabled,dc=new Date(eb.TimeStamp),Fa=!0);return new ia(tb,Fa,dc)}PHb(eb){const Fa=y.a.Pa.zb,tb=[];return f.TaskExtensions.KJ(this.indexedDB.yja(w.a.aO),dc=>{const jc=!this.gW||!this.Rh.length;dc=dc.result;tb.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",
int64:this.Rh.length}));if(""!==dc&&(dc=ca.b(dc),tb.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:dc.length})),jc)){for(const fb of dc)this.Rh.Nh(new ja(fb));this.Zja=!0;this.qQa=0<dc.length;B.a(r.a.Lmc,jc,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);this.DQa(eb);return!0}B.a(r.a.Lmc,jc,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);return!1},this.$.la,3)}XHd(eb){da.EwaSettings.getBooleanFeatureGate(w.a.HGa,!1)&&!P()&&this.$Hd(eb);w.a.Dw?this.PHb(eb):this.VHd(eb)}Igd(eb,Fa,tb){const dc=y.a.Pa.zb,
jc=[];if(eb&&eb.IsSuccess){ka(this.$,eb.Token);var fb=sb.a.create().toString();jc.push(Object(m.a)(new z.a,{name:"CorrelationId",string:fb}));makerstorage.getRecentScripts(fb).then(ec=>{jc.push(Object(m.a)(new z.a,{name:"HasReadCachedScripts",bool:this.Zja}));this.Rh.clear();for(const lb of ec)this.Rh.Nh(new ja(lb));this.gW=this.qQa=!0;this.indexedDB.Xe()&&(ec=Ca.a.kc(this.Rh.VW()),this.indexedDB.jna(new ra.a(w.a.aO,ec)));jc.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.Rh.length}));B.a(r.a.qca,
!0,v.getElapsedMilliseconds(dc,y.a.Pa.zb),jc);Fa.Hp(w.a.aO)}).catch(ec=>{Object.getType(ec)===makerstorage.StorageServiceError?(jc.push(Object(m.a)(new z.a,{name:"Error",string:ec.message})),jc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:`makerstorage_${ec.errorCode.toString()}_${ec.status.toString()}`})),17===ec.errorCode&&tb.EIb(w.a.lKa(this.$))):(jc.push(Object(m.a)(new z.a,{name:"Error",string:ec.toString()})),jc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));B.a(r.a.Kuf,
!1,v.getElapsedMilliseconds(dc,y.a.Pa.zb),jc);this.gW=!0;Fa.Hp(w.a.aO)})}else fb=eb?eb.ErrorCode:"need_token",eb=eb?eb.ErrorMessage:"No Access Token",jc.push(Object(m.a)(new z.a,{name:"ServiceChecked",bool:!1})),jc.push(Object(m.a)(new z.a,{name:"Error",string:eb})),jc.push(Object(m.a)(new z.a,{name:"ErrorCode",string:fb})),B.a(r.a.qca,!1,v.getElapsedMilliseconds(dc,y.a.Pa.zb),jc),this.gW=!0,Fa.Hp(w.a.aO)}WHd(eb,Fa){const tb=new Ia.a,dc=Z(this.$);Na(this.$,jc=>{if((jc=jc.Result)&&200===jc.ResponseStatusCode)jc=
jc.ResponseBody.join(""),jc=JSON.parse(jc),eb(this.$Dd(jc.value)),tb.setResult(!0);else{jc=jc?"RichApi_"+jc.ResponseStatusCode:"RichApiError";const fb=[];fb.push(Object(m.a)(new z.a,{name:"Error",string:"Failed to read shared script ids from document"}));fb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:jc}));this.Cs=!0;this.TT(Fa,y.a.Pa.zb,0,fb);tb.setResult(!1)}},jc=>{jc=Jb.a.ff(jc.data);c.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");const fb=
[];fb.push(Object(m.a)(new z.a,{name:"Error",string:"Failure using rich api: "+jc}));fb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"RichApiFailure"}));this.Cs=!0;this.TT(Fa,y.a.Pa.zb,0,fb);tb.setResult(!1)},dc,tb)}ehd(eb,Fa,tb){const dc=y.a.Pa.zb;let jc=0,fb=0;this.Cs=jc===eb.count;const ec=[];ec.push(Object(m.a)(new z.a,{name:"ScriptIds",int64:eb.count}));if(eb.count)if(Fa&&Fa.IsSuccess){ka(this.$,Fa.Token);for(var lb of eb){const ac=sb.a.create().toString();makerstorage.getSharedScript(lb.value,
ac).then(Gb=>{const wb=[];wb.push(Object(m.a)(new z.a,{name:"BodySize",int64:Gb.body.length}));wb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:ac}));B.a(r.a.Mmc,!0,v.getElapsedMilliseconds(dc,y.a.Pa.zb),wb);jc++;Gb=new ja(Gb);Gb.shareId=eb.na(Gb.id);this.Nd.Nh(Gb);this.Cs=jc===eb.count;this.rQa=!0;this.TT(tb,dc,fb,ec)}).catch(Gb=>{const wb=[];Object.getType(Gb)===makerstorage.StorageServiceError?(ec.push(Object(m.a)(new z.a,{name:"Error",string:Gb.message})),ec.push(Object(m.a)(new z.a,{name:"ErrorCode",
string:`makerstorage_${Gb.errorCode.toString()}_${Gb.status.toString()}`}))):(wb.push(Object(m.a)(new z.a,{name:"Error",string:Gb.toString()})),wb.push(Object(m.a)(new z.a,{name:"ErrorCode",string:"exception"})));wb.push(Object(m.a)(new z.a,{name:"CorrelationId",string:ac}));B.a(r.a.Mmc,!1,v.getElapsedMilliseconds(dc,y.a.Pa.zb),wb);jc++;fb++;this.Cs=jc===eb.count;this.TT(tb,dc,fb,ec)}).finally(()=>{if(da.EwaSettings.getBooleanFeatureGate(w.a.HGa,!1)&&this.indexedDB.Xe()&&this.Cs){const Gb=Ob.$gd(this.$,
this.Nd);this.indexedDB.jna(new ra.a(w.a.Yoa,Gb))}})}}else lb=Fa?Fa.ErrorCode:"need_token",Fa=Fa?Fa.ErrorMessage:"No Access Token",ec.push(Object(m.a)(new z.a,{name:"Error",string:Fa})),ec.push(Object(m.a)(new z.a,{name:"ErrorCode",string:lb})),this.Cs=!0,this.TT(tb,dc,fb,ec);else this.Cs=this.rQa=!0,this.TT(tb,dc,fb,ec),da.EwaSettings.getBooleanFeatureGate(w.a.HGa,!1)&&f.TaskExtensions.KJ(Ob.QHb(this.$,this.indexedDB),ac=>{ac.result&&(this.indexedDB.u6b(w.a.Yoa),this.Nd.clear(),tb.Hp("CachedScripts"))},
this.$.la,3)}Rgd(eb){const Fa={id:"samples-6"};Fa.name=L.a.instance.ga(2144);this.Qk.Nh(new ja(Fa));Fa.id="samples-8";Fa.name=L.a.instance.ga(2145);this.Qk.Nh(new ja(Fa));Fa.id="samples-2";Fa.name=L.a.instance.ga(2141);this.Qk.Nh(new ja(Fa));Fa.id="samples-4";Fa.name=L.a.instance.ga(2142);this.Qk.Nh(new ja(Fa));Fa.id="samples-5";Fa.name=L.a.instance.ga(2143);this.Qk.Nh(new ja(Fa));Fa.id="samples-9";Fa.name=L.a.instance.ga(2146);this.Qk.Nh(new ja(Fa));this.R6=!0;eb.Hp("SampleScripts")}Chd(){const eb=
{};eb.id=w.a.XNb;eb.name=L.a.instance.ga(2147);this.H7.Nh(new ja(eb));eb.id=w.a.YNb;eb.name=L.a.instance.ga(2148);this.H7.Nh(new ja(eb))}$Dd(eb){const Fa=new Kb.a;if(eb=this.eua.parseFromString(eb,"text/xml").querySelector('[id="script-ids-node-id"]')){eb=eb.getElementsByTagName("scriptId");for(let tb=0;tb<eb.length;tb++){const dc=eb[tb].getAttribute("id");if(dc){let jc,fb;({pNb:jc,shareId:fb}=Ob.phd(dc)).returnValue&&Fa.ia(jc,fb)}}}return Fa}$Hd(eb){const Fa=y.a.Pa.zb,tb=[];f.TaskExtensions.KJ(Ob.QHb(this.$,
this.indexedDB),dc=>{dc=dc.result;tb.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.Nd.length}));if(dc){tb.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:dc.length}));const jc=!this.Cs||0===this.Nd.length;if(jc){for(const fb of dc.getScripts())this.Nd.Nh(fb);this.Nd.sort();B.a(r.a.M9a,jc,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);this.DQa(eb);return!0}B.a(r.a.M9a,jc,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb)}else B.a(r.a.M9a,!1,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);
return!1},this.$.la,3)}VHd(eb){const Fa=y.a.Pa.zb,tb=[];f.TaskExtensions.KJ(this.indexedDB.yja(w.a.$V),dc=>{const jc=!this.fW||!this.pg.length;dc=dc.result;tb.push(Object(m.a)(new z.a,{name:"ExistingScriptCount",int64:this.pg.length}));if(""!==dc&&(dc=ca.b(dc),tb.push(Object(m.a)(new z.a,{name:"CachedScriptCount",int64:dc.length})),jc)){for(const fb of dc)this.pg.Nh(new ja(fb));this.pg.sort();B.a(r.a.Kmc,jc,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),tb);this.DQa(eb);return!0}B.a(r.a.Kmc,jc,v.getElapsedMilliseconds(Fa,
y.a.Pa.zb),tb);return!1},this.$.la,3)}TT(eb,Fa,tb,dc){this.Cs&&(dc.push(Object(m.a)(new z.a,{name:"ScriptCount",int64:this.Nd.length})),dc.push(Object(m.a)(new z.a,{name:"ScriptErrorCount",int64:tb})),B.a(r.a.Luf,!tb,v.getElapsedMilliseconds(Fa,y.a.Pa.zb),dc),this.Nd.sort(),eb.Hp(w.a.Yoa))}DQa(eb){this.u4=!0;eb.Hp("CachedScripts")}}Object(n.a)(Qa,"AutomateCommandStorage",Ob,[]);var ha=a(699);class qa extends b.a{constructor(eb){super();this.$=eb;this.Eb()}create(){const eb=Sa.GetServiceTaskFactory.Sa(this.$.da,
349,350,this.fb),Fa=J.a.loadScript(134,4,this.fb,void 0,void 0,351),tb=Sa.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.fb),dc=Sa.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.fb),jc=Sa.GetServiceTaskFactory.Sa(this.$.da,5,4,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([eb,Fa,tb,dc,jc],this.la,3),()=>{const fb=eb.result,ec=dc.result;var lb=jc.result;const ac=new xa,Gb=new A(this.$,fb,ac),wb=new Qa(this.$,ec),qc=new ba(this.$,wb),Ya=new Nb(this.$,Gb,ac,lb);da.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?
(lb=Object(ha.b)(this.$.da,352,()=>new Va(this.$,fb,tb.result,ec,Ya,ac,Gb,wb,qc)),this.pb(lb)):this.pb(this.$.da.za(352)||new Va(this.$,fb,tb.result,ec,Ya,ac,Gb,wb,qc))},this.la,3)}static ka(eb){eb&&eb.da.Ga(351,new qa(eb))}}Object(n.a)(qa,"AutomateCommandManagerFactory",b.a,[]);var pb=a(9);a.d(C,"a",function(){return bb});const bb=()=>{pb.a.Fa(eb=>{l.ka(eb);qa.ka(eb)})}},1183:function(n,C,a){n=a(0);var c=a(15),b=a(84),d;(function(T){T[T.generalException=0]="generalException";T[T.invalidArgument=
1]="invalidArgument";T[T.notAllowed=2]="notAllowed";T[T.apiNotAvailable=3]="apiNotAvailable";T[T.unresolvedPendingRequest=4]="unresolvedPendingRequest";T[T.timeout=5]="timeout";T[T.adalTimeout=6]="adalTimeout";T[T.userNotSignedIn=7]="userNotSignedIn";T[T.userAborted=8]="userAborted";T[T.silentSignInFailed=9]="silentSignInFailed";T[T.invalidResourceUrl=10]="invalidResourceUrl";T[T.invalidGrant=11]="invalidGrant";T[T.connectionLost=12]="connectionLost";T[T.clientError=13]="clientError";T[T.serverError=
14]="serverError"})(d||(d={}));Object(n.b)("ErrorCodes",d);a(1293);class f{constructor(T,G){this.requestCallback=this.requestParameters=null;this.requestParameters=T;this.requestCallback=G}}Object(n.a)(f,"OutstandingRequest",null,[]);class e{}e.QDi="AADSTS50058";e.invalidResourceUrl="AADSTS50001";e.LDi="AADSTS65001";e.$Di="AADSTS70011";e.userAborted="13002";e.RZi="Popup Window is null";e.QZi="Popup Window closed";e.adalTimeout="Token renewal operation failed due to timeout";e.UKj="tokenRevoked";Object(n.a)(e,
"WopiHostErrorType",null,[]);var k=a(4),l=a(731),m=a(573),u=a(41),t=a(1292);class w{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(n.a)(w,"WopiIdentityInfo",null,[685]);class r{constructor(T,G,D){this.expiration=this.authority=this.accessToken=null;this.accessToken=T;this.authority=G;this.expiration=D}}Object(n.a)(r,"WopiIdentityToken",null,[555]);var v=a(27),y=a(146),x=a(372),B=a(164),z=a(69),A=a(342);class I{constructor(T){this._initialized=
!1;this.U$a={};this.Azc={};this.xO=k.AFrameworkApplication.ta.ZD;this.Nkd=T}A2a(T){this._initialized||(T.qo(B.a.cJf),T.$l(B.a.cJf,Object(b.a)(this,this.tQi,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(T,G,D=null){this.iOa(T,G);return new Promise((J,L)=>{if(this.jnd(G))if(G in this.U$a)L("unresolvedPendingRequest");else{var H=window.setTimeout(()=>{c.ULS.sendTraceTag(37856032,344,10,u.c({["error"]:"Request timeout.",["callerId"]:G}));L("timeout")},12E4);this.idd(T,G,D,(R,Q)=>{window.clearTimeout(H);
R?J(R):(c.ULS.sendTraceTag(37856033,369,15,u.c({["error"]:d[Q]})),L(Q))})}else c.ULS.sendTraceTag(37856034,344,10,u.c({["error"]:"Caller is not allowed."})),L("notAllowed")})}getPrimaryIdentityInfo(T){return new Promise((G,D)=>{this.jnd(T)?this.gVh((J,L)=>{J?G(J):(c.ULS.sendTraceTag(37856064,369,10,u.c({["error"]:L.toString()})),D(L))}):(c.ULS.sendTraceTag(37856065,344,10,u.c({["error"]:"Caller is not allowed."})),D("notAllowed"))})}getAuthContext(T){return new Promise((G,D)=>{const J=this.getAuthContextSync(T);
J?G(J):D("notAllowed")})}getAuthContextSync(T){if(this.jnd(T)){const G=new t.a;G.upn=k.AFrameworkApplication.fa.Xa("UserPrincipalName");G.userId=k.AFrameworkApplication.fa.Xa("LoggableUserId");G.authority=k.AFrameworkApplication.fa.Xa("HostAuthAuthority");G.tenantId=k.AFrameworkApplication.fa.Xa("TenantId");G.isAnonymous=k.AFrameworkApplication.fa.qa("IsAnonymousUser");G.supportsAuthToken=this.K7h(T);T=k.AFrameworkApplication.fa.Xa("HostAuthType");G.authorityType="aad"===T.toLowerCase()?2:"msa"===
T.toLowerCase()?1:0;return G}c.ULS.sendTraceTag(40751647,344,10,u.c({["error"]:"Caller is not allowed."}));return null}K7h(T){const G=l.a.Vxb;return v.a.zxa?G&&l.a.X9f?Array.contains(l.a.X9f,T.toLowerCase()):!1:G}idd(T,G,D,J){var L=[];Array.add(L,Object.assign(new z.a,{name:"CallerId",string:G}));Array.add(L,Object.assign(new z.a,{name:x.a.KUd,string:T.correlationId}));y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:L}));
L=m.a.create().toString();const H="getAccessToken_"+L,R=this.xO.Bc("ComponentAttach",H);this.Azc[H]=R;const Q={};Q[x.a.LUd]=L;Q[x.a.qEj]=T.resource;Q[x.a.rEj]=T.scope;Q[x.a.V6f]=k.AFrameworkApplication.fa.Xa("HostAuthType");Q[x.a.uEj]=k.AFrameworkApplication.fa.Xa("UserPrincipalName");Q[x.a.sEj]=T.silentLogin;Q[x.a.nEj]=T.options;Q[x.a.KUd]=T.correlationId;Q[x.a.oEj]=G;D&&(Q[x.a.addinName]=D.AddinName,Q[x.a.mEj]=D.AddinTrustId);this.Nkd.execute(O=>{this.A2a(O);O.Mj(B.a.getAuthToken,Q)});this.U$a[L]=
new f(T,J)}gVh(T){const G=k.AFrameworkApplication.fa.Xa("UserName"),D=k.AFrameworkApplication.fa.Xa("UserPrincipalName"),J=k.AFrameworkApplication.fa.Xa("LoggableUserIdSpace"),L=new w;L.email=D;L.displayName=G;switch(J){case "OrgIdPuid":L.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":L.authority="MicrosoftAccount";break;default:L.authority=J}T(L,null)}tQi(T){let G=null;try{let J=T.Values[x.a.LUd];const L=T.Values[x.a.lEj],H=T.Values[x.a.V6f],R=T.Values[x.a.tEj];let Q=
null,O=null;const V=this.U$a[J];if("undefined"!==typeof V&&V){var D=[];Array.add(D,Object.assign(new z.a,{name:x.a.KUd,string:V.requestParameters.correlationId}));y.a.sendTelemetryEvent(Object.assign(new A.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:D}));G=V.requestCallback;delete this.U$a[J];"undefined"!==typeof L&&L&&L.length?O=new r(L,H,R):Q=d[this.Xyi(T)];D="getAccessToken_"+J;D in this.Azc&&(this.Azc[D].stop(),delete this.Azc[D]);G(O,Q)}else c.ULS.sendTraceTag(37856066,
344,10,u.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:J}))}catch(J){T=T.Values[x.a.LUd],T in this.U$a&&delete this.U$a[T],this.pkc(),c.ULS.sendTraceTag(37856067,344,10,u.c({["error"]:J.message,["stack"]:J.stack})),G&&G(null,"generalException")}}jnd(T){var G=k.AFrameworkApplication.Z0h();T=T.toLowerCase();for(const D of G)if(T===D.toLowerCase())return!0;G=l.a.SWc;for(let D in G)if(T===G[D].toLowerCase())return!0;return!1}Xyi(T){T=T.Values[x.a.pEj];this.pkc();c.ULS.sendTraceTag(39068821,
344,15,u.c({["error"]:T}));return T?-1<T.indexOf(e.QDi)?9:-1<T.indexOf(e.RZi)||-1<T.indexOf(e.QZi)?12:-1<T.indexOf(e.invalidResourceUrl)?10:-1<T.indexOf(e.userAborted)?8:-1<T.indexOf(e.$Di)||-1<T.indexOf(e.LDi)||T===e.UKj?11:-1<T.indexOf(e.adalTimeout)?6:0:13}iOa(T,G){T=this.k7i(T.resource);c.ULS.sendTraceTag(39921882,344,50,u.c({["callerId"]:G,["resource"]:T}))}pkc(){c.ULS.sendTraceTag(39068822,344,50,u.c({["userAgent"]:window.navigator.userAgent}))}k7i(T){return(T?T:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")}}Object(n.a)(I,"WopiIdentityManager",null,[519]);var F=a(247);class U{constructor(){this.gb=null}get name(){return"Common.App.WopiIdentity"}Wh(T){this.gb=T;T.register(I,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").wc().Fc(()=>new I(T.Ub("Postmessage.IHostPostmessenger")))}init(){k.AFrameworkApplication.fa&&k.AFrameworkApplication.fa.qv(Object(b.a)(this,this.zB,"onFullAppSettingsReady"))}zB(){try{this.gb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(T){c.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+T)}}dispose(){}static main(){F.a.instance.Gi(new U)}}Object(n.a)(U,"WopiIdentityPackage",null,[3,4]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.WopiIdentity");U.main()}},1188:function(n,C,a){a.r(C);n=a(0);var c=a(7),b=a(15),d=a(4),f=a(155),e=a(187),k=a(82),l=a(515),m=a(171),u=a(61),t=a(50),w=a(37),r=a(226),v=a(116),y=a(527);class x{constructor(Ba){Ba=Ba.split("|");this.lx=Ba[1];this.KRc=Ba[2];this.BVd=
Ba[3]}get solutionId(){return this.lx}get solutionVersion(){return this.KRc}get needToRestoreManifest(){return this.BVd===OSF.StoreTypeEnum.Registry.toString()}}Object(n.a)(x,"AddinStoreInfo",null,[]);class B{}Object(n.a)(B,"CustomFunctionRegistrationInfos",null,[]);var z=a(195),A=a(64);const I=(Ba,ea,Y)=>F(Ba,ea,z.a.none,A.a.current,Y),F=(Ba,ea,Y,ja,ca)=>{Y=Ba.continueWith(()=>{ea(Ba)},3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163463,0,10,ca)},4);return Y},U=(Ba,ea,Y)=>X(Ba,ea,z.a.none,A.a.current,
Y),X=(Ba,ea,Y,ja,ca)=>{Y=Ba.fp(()=>ea(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163462,0,10,ca)},4);return w.TaskExtensions.QBc(Y)},T=(Ba,ea,Y)=>G(Ba,ea,z.a.none,A.a.current,Y),G=(Ba,ea,Y,ja,ca)=>{Y=Ba.fp(()=>ea(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163461,0,10,ca)},4);return Y},D=(Ba,ea,Y)=>J(Ba,ea,z.a.none,A.a.current,Y),J=(Ba,ea,Y,ja,ca)=>{Y=Ba.fp(()=>ea(Ba),3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163460,0,10,ca)},4);return w.TaskExtensions.QBc(Y)},L=(Ba,ea,
Y)=>H(Ba,ea,z.a.none,A.a.current,Y),H=(Ba,ea,Y,ja,ca)=>{Y=Ba.continueWith(()=>{ea(Ba)},3,Y,ja);Y.continueWith(()=>{b.ULS.sendTraceTag(537163459,0,10,ca)},4);return Y},R=(Ba,ea)=>{T(a(1188).CustomFunctionsInstaller.H0e("CustomFunctionsRuntimeLogging"),Y=>{if(Y.result&&window.console)switch(Y=Q(Ba.severity)+" "+Ba.message+ea,Ba.severity){case 2:window.console.log&&window.console.log(Y);break;case 0:window.console.info&&window.console.info(Y);break;case 1:window.console.error&&window.console.error(Y)}return!0},
"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")},Q=Ba=>{switch(Ba){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};var O=a(964);class V{}Object(n.a)(V,"InstallationInfo",null,[]);class W{}Object(n.a)(W,"UninstallationInfo",null,[]);var da=a(28),ta=a(90),K=a(35),na=a(29),P=a(1),ka=a(22),pa=a(281),Na=a(751),Z=a(55);class Ra{constructor(Ba,ea){this.gRc=Ba;this._message=ea}get severity(){return this.gRc}get message(){return this._message}}
Object(n.a)(Ra,"CustomFunctionLog",null,[]);a.d(C,"CustomFunctionsInstaller",function(){return Da});class Da{constructor(Ba,ea,Y){this.NZ=!1;this.AF={};this.$=Ba;this.vj=ea;this.Hmd().ina();this.indexedDB=Y;this.indexedDB.Xe()&&(this.NZ=!0,this.indexedDB.initialize(Da.ryb,Da.syb))}get eV(){return this.vj.eV}Ebf(Ba,ea,Y,ja){if(ja.invariantNamespace)for(let ca=0;ca<ja.invariantNamespace.length;++ca){const ba=ja.invariantNamespace.charAt(ca);if("."!==ba&&"_"!==ba&&"a">ba&&"z"<ba&&"A">ba&&"Z"<ba&&"0">
ba&&"9"<ba)throw b.ULS.sendTraceTag(537163552,0,10,`CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='${ba}', Position=${ca}.`),Error.create("InvariantNamespace validation failed");}return U(this.vUg(Y,ja.manifest),()=>U(this.SHd(Ba),ca=>{let ba=ca.result;return(null===ba||void 0===ba?0:ba.isDynamicMetadata)?this.XId(Ba,ea,ba,!1,!1,!1):U(this.nYj(Ba,ea,ja),ua=>{let wa;ba=(wa=new V,wa.addinId=Y,wa.locale=ja.locale,wa.addinInvariantNamespace=ja.invariantNamespace,
wa.addinNamespace=ja.namespace,wa.addinTitle=ja.title,wa.isXllCompatible=ja.isXllCompatible,wa.metadataContent=JSON.stringify(JSON.parse(ua.result)),wa);return this.XId(Ba,ea,ba,!1,Da.hzh(ja.osfControl.getStoreType()),O.a(this.$,ja))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed"),"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")}Gbf(Ba,ea,Y,
ja){if(!Da.isd(Y))throw b.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return U(this.SHd(Ba),ca=>{ca=ca.result;if(!ca&&(ca=K.a.Cc(this.eV,Ba),!ca))throw b.ULS.sendTraceTag(537163550,0,10,`CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,ea,null)} hasn't been installed yet.`),Error.create("Customfunctions dynamic registration failed");
ca.metadataContent=JSON.stringify(JSON.parse(Y));ca.isDynamicMetadata=!0;return this.XId(Ba,ea,ca,!0,!0,ja)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")}Kcg(Ba,ea){this.vj.zia();const Y=Object(c.a)(new W,{solutionId:Ba}),ja=`CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,ea,null)}.`;return U(this.IJd(Ba),()=>U(this.OJd(Ba),()=>this.nZd(this.vj,
Ba,ea,Y),"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed"),ja)}nYj(Ba,ea,Y){const ja=new f.a;OSF.OUtil.xhrGet(Y.metadataUrl,ca=>{ca?ja.setResult(ca):ja.setException(Error.create("Invalid manifest"))},ca=>{b.ULS.sendTraceTag(537163548,0,10,`CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,ea,null)}. ErrorCode: ${ca}.`);ja.setException(Error.create("Failed to download manifest"))});
return ja.task}Hmd(){return U(this.Urc(),Ba=>{const ea=Ba.result;if(!ea.length)return Z.Task.Ta(!0);b.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ba=new e.a;const Y=[];for(let ja=0;ja<ea.length;ja++){const ca=Object(k.a)(String,ea[ja]);Ba.add(T(this.SHd(ca),ba=>{if(ba=ba.result){const ua=K.a.Cc(this.AF,ba.addinId);ua&&ua===ba.metadataContent||(this.AF[ba.addinId]=ba.metadataContent,this.eV[ca]=ba,Y.push(ba))}return!0},
"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"))}return D(Z.Task.WhenAllEnumerable(Ba),()=>{if(Y.length){let ja;const ca=(ja=new B,ja.registrationInfos=Y,ja);return this.R0b(this.vj,ea,ca)}b.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Z.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")}Hbf(){var Ba=
new f.a;new e.a;const ea=[],Y=[];Object.keys(this.eV).forEach(ja=>{ja=Object(k.a)(String,ja);const ca=K.a.Cc(this.eV,ja);ea.push(ca);Y.push(ja)});if(!Y.length)return Ba.setResult(!0),Ba.task;Ba=Object(c.a)(new B,{registrationInfos:ea});return this.R0b(this.vj,Y,Ba)}Urc(){return T(this.Kfd(y.a.sZa),Ba=>{Ba=Ba.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(Ba||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(Ba||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")}xig(Ba){return this.iQd(y.a.sZa,
Sys.Serialization.JavaScriptSerializer.serialize(Ba))}SHd(Ba){return U(this.Kfd(y.a.z4a(Ba)),ea=>{ea=ea.result||"";return 0<ea.length?Z.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(ea,!0)):Z.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")}fYj(Ba,ea){return U(this.HMe(Ba),()=>U(this.iQd(y.a.z4a(Ba),Sys.Serialization.JavaScriptSerializer.serialize(ea)),()=>Da.jQd(y.a.Ejd,"true"),"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed"),
"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")}IJd(Ba){return U(this.lQf(Ba),()=>U(this.EQf(y.a.z4a(Ba)),()=>U(this.Urc(),ea=>ea.result.length?Z.Task.Ta(!0):Da.jQd(y.a.Ejd,"false"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed"),"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}INf(Ba){return this.Kfd(y.a.y4a(Ba))}uig(Ba,
ea){return U(this.HMe(Ba),()=>this.iQd(y.a.y4a(Ba),ea),"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")}OJd(Ba){return U(this.lQf(Ba),()=>this.EQf(y.a.y4a(Ba)),"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")}HMe(Ba){return U(this.Urc(),ea=>{ea=ea.result;const Y=Ba.toLowerCase();if(ea.includes(Y))return Z.Task.Ta(!0);ea.push(Y);return this.xig(ea)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}lQf(Ba){return U(this.Urc(),
ea=>{ea=ea.result;const Y=Ba.toLowerCase();return ea.includes(Y)?(ea.splice(Array.indexOf(ea,Y),1),this.xig(ea)):Z.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")}vUg(Ba,ea){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return Ba=new OSF.AddinIdInfo(Ba),Ba.needToRestoreManifest()?this.uig(Ba.getSolutionId(),ea):Z.Task.Ta(!0);Ba=new x(Ba);return Ba.needToRestoreManifest?this.uig(Ba.solutionId,
ea):Z.Task.Ta(!0)}Bhj(Ba){if(P.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){const Y=new OSF.AddinIdInfo(Ba);return Y.needToRestoreManifest()?T(this.INf(Y.getSolutionId()),ja=>{(ja=ja.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Y.getSolutionId(),Y.getSolutionVersion(),ja,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Z.Task.Ta(!0)}const ea=new x(Ba);return ea.needToRestoreManifest?
T(this.INf(ea.solutionId),Y=>{(Y=Y.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ea.solutionId,ea.solutionVersion,Y,this.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Z.Task.Ta(!0)}EQf(Ba){return this.NZ?this.indexedDB.u6b(Ba):Da.U$i(Ba)}iQd(Ba,ea){return this.NZ?this.indexedDB.jna(new Na.a(Ba,ea)):Da.jQd(Ba,ea)}Kfd(Ba){return this.NZ?this.indexedDB.yja(Ba):Da.H0e(Ba)}XId(Ba,ea,Y,ja,ca,ba){const ua=`CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,
ea,null)}.`;return w.TaskExtensions.QBc(T(this.YId(this.vj,Ba,ea,Y,!1,ja,ba),()=>ca?this.fYj(Ba,Y):Z.Task.Ta(!0),ua))}YId(Ba,ea,Y,ja,ca,ba,ua){if(!ba&&(ba=K.a.Cc(this.AF,ja.addinId))&&ba===ja.metadataContent)return Z.Task.Ta(!0);this.AF[ja.addinId]=ja.metadataContent;this.eV[ea]=ja;ua||Ba.BIb(ea);Ba.zia();return U(this.r8i(ea,Y,ja),()=>this.zGd(ja.addinId,ca),"Failed to register functions for customfunction addin")}r8i(Ba,ea,Y){const ja=new f.a,ca=this.tpb(Y);return this.Gia(ba=>{P.EwaSettings.ma(256)&&
R(Da.gsb,Ba);(ba=ba.Result)&&204===ba.ResponseStatusCode?ja.setResult(!0):(delete this.AF[Y.addinId],delete this.eV[Ba],I(this.IJd(Ba),()=>{I(this.OJd(Ba),()=>{this.y4f()},"Failed to show customfunctions installation error info")},`CustomFunctionsInstaller: Failed to register Custom Functions for solution: ${Ba}. Received status code ${ba?ba.ResponseStatusCode.toString():"Unknown"}.`),ja.setResult(!1))},ba=>{ba=v.a.ff(ba.data);b.ULS.sendTraceTag(537163544,0,10,`CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Ba,
ea,null)}. Errors: ${na.a.xc(ba)}.`);P.EwaSettings.ma(256)&&R(Da.fsb,Ba);delete this.AF[Y.addinId];delete this.eV[Ba];ja.setResult(!1)},ca,ja,!0)}R0b(Ba,ea,Y){const ja=new f.a,ca=da.a.Pa.me.m;ea.forEach(ua=>{ua=Object(k.a)(String,ua);Ba.Zye(ua)});Ba.zia();const ba=this.iZc(Y);return this.Gia(ua=>{P.EwaSettings.ma(256)&&R(Da.gsb,Sys.Serialization.JavaScriptSerializer.serialize(ea));ua=ua.Result;let wa=!0;var ia=Sys.Serialization.JavaScriptSerializer.deserialize(ua.ResponseBody.toString());ia=Array.isArray(ia.value)?
ia.value:null;const xa=new e.a;for(let gb=0;gb<ia.length;gb++)if(!ia[gb]){wa=!1;const va=`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code ${ua.ResponseStatusCode}.`;xa.add(U(this.IJd(ea[gb]),()=>{delete this.AF[Y.registrationInfos[gb].addinId];delete this.eV[ea[gb]];return this.OJd(ea[gb])},va))}L(Z.Task.WhenAllEnumerable(xa),()=>{I(this.zGd("",!1),()=>{b.ULS.sendTraceTag(537163542,0,50,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes ${da.a.Pa.me.m-
ca} Millisecond.`);wa?ja.setResult(wa):L(this.y4f(),()=>{ja.setResult(wa)},"Failed to show customfunctions installation error info")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions")},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},ua=>{ua=v.a.ff(ua.data);b.ULS.sendTraceTag(537163541,0,10,`CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: ${na.a.xc(ua)}.`);
P.EwaSettings.ma(256)&&R(Da.fsb,Sys.Serialization.JavaScriptSerializer.serialize(ea));for(ua=0;ua<Y.registrationInfos.length;ua++)delete this.AF[Y.registrationInfos[ua].addinId],delete this.eV[ea[ua]];ja.setResult(!1)},ba,ja,!0)}nZd(Ba,ea,Y,ja){return U(this.rPj(Ba,ea,Y,ja),()=>this.zGd(ja.solutionId,!1),"Failed to unregister functions for customfunction addin")}rPj(Ba,ea,Y,ja){const ca=new f.a;Ba.BIb(ea);(Ba=K.a.Cc(this.eV,ea))&&delete this.AF[Ba.addinId];delete this.eV[ea];ja=this.vZc(ja);return this.Gia(()=>
{P.EwaSettings.ma(256)&&R(Da.A5c,ea);ca.setResult(!0)},ba=>{ba=v.a.ff(ba.data);b.ULS.sendTraceTag(537163539,0,10,`CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${Telemetry.PrivacyRules.GetPrivacyCompliantId(ea,Y,null)}. Errors: ${na.a.xc(ba)}.`);P.EwaSettings.ma(256)&&R(Da.z5c,ea);ca.setResult(!1)},ja,ca,!1)}Gia(Ba,ea,Y,ja,ca){const ba=this.$.userOperationManager,ua=this.$.pa;let wa=null,ia=null,xa=null;const gb=()=>{if(ba.fta()||0<ua.va.FU||
0<ua.Hk.FU)return!1;wa&&ba.ho(wa);ia&&ua.Fs(ia);xa&&ua.yy(xa);const va=Y.request,sa=(Ua,nb,Ha)=>{P.EwaSettings.ma(256)&&R(ca?Da.y5c:Da.B5c,va.RequestBody);return u.g(ua.va,"ExecuteRichApiRequest",Y,pa.b(Ua,Ba),pa.a(nb,ea),Ha,null,0)};let ab=0;P.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?va.RequestFlags&1&&256!==(va.RequestFlags&256)||(ab=16):ab=va.RequestFlags&1?0:16;P.EwaSettings.$b()?ba.cs(new m.a(507,0,sa,ab|64)):ba.cs(new l.a(507,0,sa,ab));return!0};gb()||
(wa=()=>{gb()},ia=()=>{gb()},xa=()=>{gb()},ba.nr(wa),ua.pr(ia),ua.ux(xa));return ja.task}tpb(Ba){const ea={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Ba);ea.RequestFlags=1;P.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Ba=this.$.pa.va.Na(1);Ba.request=ea;return Ba}iZc(Ba){const ea={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ea.RequestBody=
JSON.stringify(Ba);ea.RequestFlags=1;P.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Ba=this.$.pa.va.Na(1);Ba.request=ea;return Ba}vZc(Ba){const ea={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ea.RequestBody=JSON.stringify(Ba);ea.RequestFlags=1;P.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ea.RequestFlags|=256);Ba=this.$.pa.va.Na(1);Ba.request=ea;return Ba}zGd(Ba,
ea){const Y=t.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return X(Y,()=>{Y.result.ZLd();return Ba&&ea?this.Bhj(Ba):Z.Task.Ta(!0)},this.$.la,r.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")}y4f(){const Ba=new ta.a(1949669462,0,this.$.Kc,0,null);return this.$.Ka.Lb(Ba)}static H0e(Ba){try{return Z.Task.Ta(localStorage.getItem(Ba))}catch(ea){return b.ULS.sendTraceTag(537163537,0,50,`CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: ${ea.message||
"Unknown"}`),Z.Task.Ta(null)}}static jQd(Ba,ea){try{return localStorage.setItem(Ba,ea),Z.Task.Ta(!0)}catch(Y){return b.ULS.sendTraceTag(537163536,0,50,`CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: ${Y.message||"Unknown"}`),Z.Task.Ta(!1)}}static U$i(Ba){try{return localStorage.removeItem(Ba),Z.Task.Ta(!0)}catch(ea){return b.ULS.sendTraceTag(537163535,0,50,`CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: ${ea.message||
"Unknown"}`),Z.Task.Ta(!1)}}static hzh(Ba){return ka.a.equals(Ba,"registry",!0)||ka.a.equals(Ba,"uploadfiledevcatalog",!0)||d.AFrameworkApplication.userNameUnknown||d.AFrameworkApplication.limitedEdit}static isd(Ba){if(!Ba)return!1;try{JSON.parse(Ba)}catch(ea){return!1}return!0}}Da.ryb="CustomFunctionCache";Da.syb="CustomFunction";Da.y5c=new Ra(2,"CustomFunctions [Registration] [Begin] SolutionId=");Da.gsb=new Ra(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");Da.fsb=new Ra(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
Da.B5c=new Ra(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");Da.A5c=new Ra(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");Da.z5c=new Ra(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(n.a)(Da,"CustomFunctionsInstaller",null,[847])},1192:function(n,C,a){a.r(C);n=a(0);var c=a(7),b=a(15),d=a(936),f=a(155),e=a(82),k=a(515),l=a(171),m=a(61),u=a(50),t=a(37),w=a(116),r=a(527),v=a(964);class y{constructor(Q){Q=Q.split("|");this.lx=Q[1];this.KRc=Q[2];
this.BVd=Q[3]}get solutionId(){return this.lx}get solutionVersion(){return this.KRc}get needToRestoreManifest(){return this.BVd===OSF.StoreTypeEnum.Registry.toString()}}Object(n.a)(y,"AddinStoreInfo",null,[]);class x{}Object(n.a)(x,"CustomFunctionRegistrationInfos",null,[]);const B=(Q,O)=>{if(a(1192).CustomFunctionsLegacyInstaller.cwb("CustomFunctionsRuntimeLogging")&&window.console)switch(O=z(Q.severity)+" "+Q.message+O,Q.severity){case 2:window.console.log&&window.console.log(O);break;case 0:window.console.info&&
window.console.info(O);break;case 1:window.console.error&&window.console.error(O)}},z=Q=>{switch(Q){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}};class A{}Object(n.a)(A,"InstallationInfo",null,[]);class I{}Object(n.a)(I,"UninstallationInfo",null,[]);var F=a(152),U=a(35),X=a(29),T=a(1),G=a(14),D=a(281),J=a(864),L=a(55);class H{constructor(Q,O){this.gRc=Q;this._message=O}get severity(){return this.gRc}get message(){return this._message}}Object(n.a)(H,"CustomFunctionLog",
null,[]);a.d(C,"CustomFunctionsLegacyInstaller",function(){return R});class R{constructor(Q){this.AF={};this.$=Q;this.Hmd().ina()}Ebf(Q,O,V,W){const da=new f.a;if(W.invariantNamespace)for(O=0;O<W.invariantNamespace.length;++O){const K=W.invariantNamespace.charAt(O);if("."!==K&&"_"!==K&&"a">K&&"z"<K&&"A">K&&"Z"<K&&"0">K&&"9"<K)return b.ULS.sendTraceTag(537163530,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='${K}', Position=${O}.`),da.setResult(!1),
da.task}R.cacheManifest(V,W.manifest);let ta=R.THd(Q);(null===ta||void 0===ta?0:ta.isDynamicMetadata)?this.WId(Q,ta,da,!1,!1):OSF.OUtil.xhrGet(W.metadataUrl,K=>{ta=Object(c.a)(new A,{addinId:V,locale:W.locale,addinInvariantNamespace:W.invariantNamespace,addinNamespace:W.namespace,addinTitle:W.title,isXllCompatible:W.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(K))});this.WId(Q,ta,da,!1,v.a(this.$,W))},K=>{b.ULS.sendTraceTag(537163528,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution ${Q}. ErrorCode: ${K}.`);
da.setResult(!1)});return da.task}Gbf(Q,O,V,W){O=new f.a;if(!R.isd(V))return b.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),O.setResult(!1),O.task;const da=R.THd(Q);if(!da)return b.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),O.setResult(!1),O.task;da.metadataContent=JSON.stringify(JSON.parse(V));da.isDynamicMetadata=
!0;this.WId(Q,da,O,!0,W);return O.task}Kcg(Q){const O=new f.a,V=u.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.Aa(V,()=>{const W=V.result;W.zia();const da=Object(c.a)(new I,{solutionId:Q});R.JJd(Q);R.PJd(Q);t.TaskExtensions.Aa(this.nZd(W,Q,da),ta=>{F.b(ta)?O.setResult(ta.result):(ta.Tf?b.ULS.sendTraceTag(537163524,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: ${Q}.`):ta.Eh&&b.ULS.sendTraceTag(537163523,0,10,`CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: ${Q}.`),
O.setResult(!1))},this.$.la,0)},this.$.la,3);return O.task}Hmd(){const Q=new f.a,O=R.ZHd();0<O.length&&b.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");const V=[];O.forEach(da=>{da=Object(e.a)(String,da);if(da=R.THd(da)){const ta=U.a.Cc(this.AF,da.addinId);ta&&ta===da.metadataContent||(this.AF[da.addinId]=da.metadataContent,V.push(da))}});if(!V.length)return Q.setResult(!0),b.ULS.sendTraceTag(537163521,0,
50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),Q.task;const W=u.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.Aa(W,()=>{const da=W.result,ta=Object(c.a)(new x,{registrationInfos:V});t.TaskExtensions.Aa(this.R0b(da,O,ta),K=>{F.b(K)?Q.setResult(K.result):(K.Tf?b.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):K.Eh&&b.ULS.sendTraceTag(537163490,
0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),Q.setResult(!1))},this.$.la,0)},this.$.la,3);return Q.task}Ahj(Q){Q=new y(Q);if(Q.needToRestoreManifest){const O=R.T5i(Q.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(Q.solutionId,Q.solutionVersion,O,this.$.ya.UICultureTag)}}WId(Q,O,V,W,da){const ta=u.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);t.TaskExtensions.Aa(ta,()=>{t.TaskExtensions.Aa(this.YId(ta.result,Q,O,!1,W,da),
K=>{F.b(K)?((K=K.result)&&R.gYj(Q,O),V.setResult(K)):(K.Tf?b.ULS.sendTraceTag(537163488,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: ${Q}.`):K.Eh&&b.ULS.sendTraceTag(537163487,0,10,`CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: ${Q}.`),V.setResult(!1))},this.$.la,0)},this.$.la,3)}YId(Q,O,V,W,da,ta){if(!da&&(da=U.a.Cc(this.AF,V.addinId))&&da===V.metadataContent)return L.Task.Ta(!0);this.AF[V.addinId]=
V.metadataContent;const K=new f.a;ta||Q.BIb(O);Q.zia();Q=this.tpb(V);return this.Gia(na=>{T.EwaSettings.ma(256)&&B(R.gsb,O);const P=na.Result;204===P.ResponseStatusCode?t.TaskExtensions.Aa(this.yGd(K,V.addinId,W),ka=>{ka.Tf?O?b.ULS.sendTraceTag(537163485,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${O}.`):b.ULS.sendTraceTag(537163484,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId ${V.addinId}.`):
ka.Eh&&(O?b.ULS.sendTraceTag(537163483,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution ${O}.`):b.ULS.sendTraceTag(537163482,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId ${V.addinId}.`));K.setResult(!1)},this.$.la,4):(na=()=>{delete this.AF[V.addinId];R.JJd(O);R.PJd(O);b.ULS.sendTraceTag(537163481,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: ${O}. Received status code ${P.ResponseStatusCode}.`);
K.setResult(!1)},na=Object(c.a)(new J.a,{aMa:OSF.InfoType.Error,title:V.addinTitle,description:String.format(G.a.instance.mb(153),G.a.instance.ga(1890)),buttonText:G.a.instance.ga(4),pha:na,eec:!1,lia:na,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),d.a.SSd(na))},na=>{na=w.a.ff(na.data);b.ULS.sendTraceTag(537163480,0,10,`CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution ${O}. Errors: ${X.a.xc(na)}.`);T.EwaSettings.ma(256)&&
B(R.fsb,O);delete this.AF[V.addinId];K.setResult(!1)},Q,K,!0)}R0b(Q,O,V){const W=new f.a;O.forEach(ta=>{ta=Object(e.a)(String,ta);Q.Zye(ta)});Q.zia();const da=this.iZc(V);return this.Gia(ta=>{T.EwaSettings.ma(256)&&B(R.gsb,Sys.Serialization.JavaScriptSerializer.serialize(O));ta=ta.Result;let K=!0;var na=Sys.Serialization.JavaScriptSerializer.deserialize(ta.ResponseBody.toString());na=Array.isArray(na.value)?na.value:null;for(let P=0;P<na.length;P++)na[P]||(K=!1,delete this.AF[V.registrationInfos[P].addinId],
R.JJd(O[P]),R.PJd(O[P]),b.ULS.sendTraceTag(537163478,0,10,`CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: ${O[P]}. Received status code ${ta.ResponseStatusCode}.`));t.TaskExtensions.Aa(this.yGd(W,"",!1),P=>{P.Tf?b.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):P.Eh&&b.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
W.setResult(!1)},this.$.la,4);W.setResult(K)},ta=>{ta=w.a.ff(ta.data);b.ULS.sendTraceTag(537163475,0,10,`CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds ${Sys.Serialization.JavaScriptSerializer.serialize(O)}. Errors: ${X.a.xc(ta)}.`);T.EwaSettings.ma(256)&&B(R.fsb,Sys.Serialization.JavaScriptSerializer.serialize(O));for(const K of V.registrationInfos)delete this.AF[K.addinId];W.setResult(!1)},da,W,!0)}nZd(Q,O,V){const W=new f.a;
Q.BIb(O);Q=this.vZc(V);return this.Gia(()=>{T.EwaSettings.ma(256)&&B(R.A5c,O);t.TaskExtensions.Aa(this.yGd(W,V.solutionId,!1),da=>{da.Tf?O&&b.ULS.sendTraceTag(537163473,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${O}.`):da.Eh&&O&&b.ULS.sendTraceTag(537163472,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution ${O}.`);W.setResult(!1)},this.$.la,4)},
da=>{da=w.a.ff(da.data);b.ULS.sendTraceTag(537163471,0,10,`CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution ${O}. Errors: ${X.a.xc(da)}.`);T.EwaSettings.ma(256)&&B(R.z5c,O);W.setResult(!1)},Q,W,!1)}Gia(Q,O,V,W,da){const ta=this.$.userOperationManager,K=this.$.pa;let na=null,P=null,ka=null;const pa=()=>{if(ta.fta()||0<K.va.FU||0<K.Hk.FU)return!1;na&&ta.ho(na);P&&K.Fs(P);ka&&K.yy(ka);const Na=V.request,Z=(Da,Ba,ea)=>{T.EwaSettings.ma(256)&&
B(da?R.y5c:R.B5c,Na.RequestBody);return m.g(K.va,"ExecuteRichApiRequest",V,D.b(Da,Q),D.a(Ba,O),ea,null,0)};let Ra=Na.RequestFlags&1?0:16;T.EwaSettings.$b()?ta.cs(new l.a(507,0,Z,Ra|64)):ta.cs(new k.a(507,0,Z,Ra));return!0};pa()||(na=()=>{pa()},P=()=>{pa()},ka=()=>{pa()},ta.nr(na),K.pr(P),K.ux(ka));return W.task}tpb(Q){const O={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};O.RequestBody=JSON.stringify(Q);O.RequestFlags=1;Q=this.$.pa.va.Na(1);Q.request=O;return Q}iZc(Q){const O=
{HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};O.RequestBody=JSON.stringify(Q);O.RequestFlags=1;Q=this.$.pa.va.Na(1);Q.request=O;return Q}vZc(Q){const O={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};O.RequestBody=JSON.stringify(Q);O.RequestFlags=1;Q=this.$.pa.va.Na(1);Q.request=O;return Q}yGd(Q,O,V){const W=u.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);t.TaskExtensions.Aa(W,()=>{W.result.ZLd();O&&V&&this.Ahj(O);Q.setResult(!0)},
this.$.la,3);return W}Hbf(){return L.Task.Ta(!0)}static ZHd(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(R.cwb(r.a.sZa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(R.cwb(r.a.sZa)||"[]"):null)||[]}static yig(Q){R.kQd(r.a.sZa,Sys.Serialization.JavaScriptSerializer.serialize(Q))}static THd(Q){Q=R.cwb(r.a.z4a(Q))||"";return 0<Q.length?Sys.Serialization.JavaScriptSerializer.deserialize(Q,!0):null}static gYj(Q,O){R.GMe(Q);R.kQd(r.a.z4a(Q),Sys.Serialization.JavaScriptSerializer.serialize(O))}static JJd(Q){R.kQf(Q);
R.FQf(r.a.z4a(Q))}static T5i(Q){return R.cwb(r.a.y4a(Q))}static hYj(Q,O){R.GMe(Q);R.kQd(r.a.y4a(Q),O)}static PJd(Q){R.kQf(Q);R.FQf(r.a.y4a(Q))}static GMe(Q){const O=R.ZHd();Q=Q.toLowerCase();O.includes(Q)||(O.push(Q),R.yig(O))}static kQf(Q){const O=R.ZHd();Q=Q.toLowerCase();O.includes(Q)&&(O.splice(Array.indexOf(O,Q),1),R.yig(O))}static cacheManifest(Q,O){Q=new y(Q);Q.needToRestoreManifest&&R.hYj(Q.solutionId,O)}static cwb(Q){try{return localStorage.getItem(Q)}catch(O){return b.ULS.sendTraceTag(537163469,
0,50,`CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: ${O.message||"Unknown"}`),null}}static kQd(Q,O){try{localStorage.setItem(Q,O)}catch(V){b.ULS.sendTraceTag(537163468,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${V.message||"Unknown"}`)}}static FQf(Q){try{localStorage.removeItem(Q)}catch(O){b.ULS.sendTraceTag(537163467,0,50,`CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: ${O.message||
"Unknown"}`)}}static isd(Q){if(!Q)return!1;try{JSON.parse(Q)}catch(O){return!1}return!0}}R.y5c=new H(2,"CustomFunctions [Registration] [Begin] SolutionId=");R.gsb=new H(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");R.fsb=new H(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");R.B5c=new H(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");R.A5c=new H(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");R.z5c=new H(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(n.a)(R,"CustomFunctionsLegacyInstaller",null,[847])},1230:function(n,C,a){n=a(0);var c=a(195),b=a(15);class d{}Object(n.a)(d,"AddinCommandsHost",null,[]);var f=a(1309),e=a(1387),k=a(862),l=a(61);const m=(U,X,T,G,D,J)=>{const L=U.Na(9);L.sharedInfo=X;return l.g(U,"InsertAgaveTaskpane",L,T,G,D,J,0)},u=(U,X,T,G,D,J,L=null)=>{L=U.Na(9,L);L.sharedInfo=X;return l.g(U,"ShowAgaveTaskpane",L,T,G,D,J,0)};var t=a(515),w=a(370),r=a(171),v=a(37),y=a(1),x=a(281),B=a(144);class z extends B.a{constructor(U){super();
this.Ce=this.lDa="AddInCommandsDialog";this.Rb=5;this.dialogWidth=695;this.dialogHeight=438;this.V2g="100%";this.S2g="408px";this.T2g="15px";this.U2g="0";this.Dug=U}get containerDiv(){return this.Sk}Rz(){super.Rz();this.Sk.style.width=this.V2g;this.Sk.style.height=this.S2g;this.Sk.style.marginTop=this.T2g;this.Sk.style.padding=this.U2g}HI(){super.HI();this.wb.style.width=String.format("{0}px",this.dialogWidth);this.wb.style.height=String.format("{0}px",this.dialogHeight)}dispose(){super.dispose();
this.Dug()}}Object(n.a)(z,"AddInCommandsDialog",B.a,[]);var A=a(55),I=a(64);B=a(99);a.d(C,"a",function(){return F});class F extends d{constructor(U,X,T,G=null,D=null){super();this.$=U;this.re=X;this.ownerAddinInfo=T;this.Jd=D;this.rRa=G||A.Task.Ta(!0)}O2g(){const U=this.rRa;this.rRa=A.Task.Ta(!0);return U}disposeHost(U){this.re.RQa(U)}setOwnerAddinEToken(U){this.ownerAddinInfo.eToken=U}showTaskpane(U,X,T){b.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");let G=null,D=!1,J=(new f.a("m_excelWebRenderer_ewaCtl_",
this.ownerAddinInfo.solutionId,new k.a,!0)).eHe(U.solutionId.substr(this.ownerAddinInfo.solutionId.length));G=X.getSharedRuntimeForTaskpane("Workbook",J);D=!!G&&1===G.LifeTime;this.re.bze(D?this.ownerAddinInfo.solutionId:U.solutionId,D?G:null,null)||(this.dof(D,!0),this.rRa=this.Fmd(U,G,(L,H)=>{L?(D&&(L.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,L.SharedRuntime=G),L.WebExtensionOsfControlType=3,this.re.aIa(L),T(L.InstanceId,H),this.dof(D,!1),y.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&
b.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(b.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),T(null,H))}))}getSettings(U,X){let T=this.re.saa(U.solutionId);T?X(this.re.XY(T).OsfPropertyBag):this.rRa=this.Fmd(U,null,G=>{G?X(G.OsfPropertyBag):b.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})}showDialog(U,X,T){b.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");const G=this.$.pa.va,D=L=>{const H=L.Result,R=H?H.AgaveData:
null;R?(this.re.aGe(R,()=>{const Q=new z(()=>{this.disposeHost(R.InstanceId)});Q.initializeAndShow("",null,null);return Q.containerDiv}),T(R.InstanceId,0)):(b.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),T(null,L.Errors?L.Errors[0].ErrorCause:5001))},J=F.Nrb(U,this.ownerAddinInfo);U=(L,H,R)=>m(G,J,x.b(L,D),H,R,null);y.EwaSettings.$b()?this.rRa=w.a(this.$.userOperationManager,U,L=>new r.a(500,0,L,64),this.Jd):this.rRa=w.a(this.$.userOperationManager,U,L=>new t.a(500,0,L),this.Jd)}createUILessSandbox(U,
X,T){b.ULS.sendTraceTag(537170637,220,50,"UILess action called.");const G=X.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),D=!!G&&1===G.LifeTime;(X=this.re.QBh(D?this.ownerAddinInfo.solutionId:U.solutionId,D?G:null))?T(X,0):this.rRa=this.Fmd(U,G,(J,L)=>{J?(D?(J.PrimaryMarketplace.SolutionId=this.ownerAddinInfo.solutionId,J.SharedRuntime=G,J.TaskpaneVisible=!1,J.WebExtensionOsfControlType=3,this.re.aIa(J)):(J.WebExtensionOsfControlType=4,this.re.aGe(J,()=>{F.qfb.ia(J.InstanceId,new e.a);return F.qfb.na(J.InstanceId).Tta})),
T(J.InstanceId,L)):(b.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),T(null,L))})}Fmd(U,X,T){let G=null;const D=this.$.pa.va,J=O=>{const V=O.Result;(G=V?V.AgaveData:null)||T(null,O.Errors?O.Errors[0].ErrorCause:5001)},L=F.Nrb(U,this.ownerAddinInfo);X&&(b.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),L.SharedRuntimeId=X.Resid);let H=500;var R=(O,V,W)=>m(D,L,x.b(O,J),V,W,null);let Q=0;void 0===L.IsToBePersisted||null===L.IsToBePersisted||L.IsToBePersisted||
(H=538,R=(O,V,W)=>{b.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.ownerAddinInfo.solutionId,this.ownerAddinInfo.storeType,this.ownerAddinInfo.assetId,null,null,this.ownerAddinInfo.storeId));return u(D,L,x.b(O,J),V,W,null)},Q=16);y.EwaSettings.$b()?(Q|=64,R=w.a(this.$.userOperationManager,R,O=>new r.a(H,0,O,Q),this.Jd)):R=w.a(this.$.userOperationManager,R,O=>new t.a(H,0,O,Q),
this.Jd);return v.TaskExtensions.ts(R,()=>G?this.yud(D,G.InstanceId,(O,V)=>{if(O){X||(G.PrimaryMarketplace.MarketplaceType=U.storeType);G.OwnerAddinSolutionId=this.ownerAddinInfo.solutionId;G.OwnerAddinStoreType=this.ownerAddinInfo.storeType;G.OsfPropertyBag=[];for(V=0;V<O.Settings.length;V++){const W=[];W[0]=O.Settings[V].Name;W[1]=O.Settings[V].Value;G.OsfPropertyBag[V]=W}T(G,0)}else T(null,V.Errors?V.Errors[0].ErrorCause:5001)}):A.Task.Ta(!1),c.a.none,3,I.a.current)}yud(U,X,T){const G=J=>{T(J.Result,
J)},D=(J,L,H)=>{J=x.b(J,G);const R=U.Na(1);R.controlId=X;return l.g(U,"DdaLoadSettings",R,J,L,H,null,0)};return y.EwaSettings.$b()?w.a(this.$.userOperationManager,D,J=>new r.a(501,0,J,80),this.Jd):w.a(this.$.userOperationManager,D,J=>new t.a(501,0,J,16),this.Jd)}dof(U,X){var T;U&&(null===(T=window.performance)||void 0===T?0:T.memory)&&b.ULS.sendTraceTag(537170630,220,50,`Shared runtime memory usage: before=${X}, jsHeapSizeLimit=${window.performance.memory.jsHeapSizeLimit}, totalJSHeapSize=${window.performance.memory.totalJSHeapSize}, usedJSHeapSize=${window.performance.memory.usedJSHeapSize}`)}static showUILessDialog(U){F.qfb.lb(U)&&
F.qfb.na(U).initializeAndShowWithTitle()}static hideUILessDialog(U){F.qfb.lb(U)&&F.qfb.na(U).hide()}static Nrb(U,X){const T={};T.SolutionId=U.solutionId;T.Version=U.version;T.StoreType=X.storeType;T.StoreId=U.storeId;T.AssetId=U.solutionId;T.AssetStoreId="omex";T.TargetType=1;T.Width=350;T.OwnerAddinSolutionId=X.solutionId;T.OwnerAddinStoreType=X.storeType;T.SharedRuntimeId=null;T.Preload=!1;return T}}F.qfb=new B.a;Object(n.a)(F,"WACExcelAddinCommandsHost",d,[])},1236:function(n,C,a){var c=a(9);n=
a(0);var b=a(694),d=a(15),f=a(103),e=a(4),k=a(1300),l=a(1),m=a(183),u=a(55);class t{constructor(x,B,z){this.jsb=null;this.$=x;B?(d.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.jsb=new k.a(x,B,z)):d.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}Lc(){return!1}executeCommand(x,B,z){x=!1;switch(B.command){case 73979048:this.jsb&&
this.jsb.V_i(B,f.a.instance,e.AFrameworkApplication.fa,z),x=!0}return x?u.Task.Ta(!0):m.a(B.command)}Ac(x,B){return 73979048===B.command&&l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)}Oc(){return!1}dispose(){this.jsb&&this.jsb.dispose()}}Object(n.a)(t,"DataFromPictureCommandHandler",null,[164,10]);var w=a(37),r=a(50);class v extends b.a{constructor(x){super(x)}vd(){const x=r.GetServiceTaskFactory.Sa(this.$.da,328,327,1),B=r.GetServiceTaskFactory.Sa(this.$.da,
484,485,1);w.TaskExtensions.Aa(w.TaskExtensions.Td([x,B],this.$.la),()=>{this.$c([new t(this.$,x.result,B.result)])},this.$.la,3)}static ka(x){b.a.Od(452,new v(x))}}Object(n.a)(v,"DataFromPictureCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return y});const y=()=>{c.a.Fa(x=>{v.ka(x)})}},1292:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=
this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static iJh(b){switch(b){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(n.a)(c,"WopiAuthContext",null,[686])},1293:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.eGf="OneDriveWOPI";Object(n.a)(c,"HostApplicationType",null,[])},1300:function(n,C,a){(function(c){a.d(C,"a",function(){return A});var b=a(0),d=a(15),f=a(173),e=a(82),
k=a(1306),l=a(38),m=a(248),u=a(43),t=a(370),w=a(171),r=a(61),v=a(90),y=a(14),x=a(21),B=a(41),z=a(1307);class A extends l.a{constructor(I,F,U){super();this.Q$e=k.a.getTypeName();this.eyb=this.XT=this.Jd=null;this.imageHeight=this.imageWidth=0;this.YLa=this.errorMessage=this.tableData=null;this.Vkd=0;this.MTc=!1;this.kHe=X=>{if(X){var T={};if(({fu:T}=B.d(this.rdh(X.data))).returnValue&&(X=Object(e.a)(Object,T),"."===X.DataFromPictureWildcard))if(X.SessionId!==this.YLa)d.ULS.sendTraceTag(523805139,0,
10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(d.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),X.CmdType){case "ACK":this.MTc=!0;this.T9f.stop();d.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");this.anj();0<this.errorMessage.length?
this.SYf():0<this.tableData.length&&this.jZf();break;case "insert_html":const D=this.$.pa.va;T={};var G=x.g(this.$).ha.sa.Xc.clone();T.PasteId=f.a.create().toString();T.DestinationRanges=u.s(u.v(G,this.$));G=X.Parameters.split("|",3);d.ULS.sendTraceTag(523805136,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:${G[0]}|${G[1]}|${G[2]}.`);G=X.Parameters.indexOf("|");G=X.Parameters.indexOf("|",G+1);G=X.Parameters.indexOf("|",G+1);T.SourceHtml=X.Parameters.substring(G+1);
T.CopyOperationId=null;const J=D.Na(1,D.Tb());J.pasteHtmlParameters=T;t.a(this.$.userOperationManager,(L,H,R)=>r.g(D,"pasteHtmlContent",J,L,H,R,null,64),L=>new w.a(204,0,L,1),null);this.Vkd++;d.ULS.sendTraceTag(523805135,0,50,`DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:${this.Vkd.toString()}`)}}};this.I8h=(X,T)=>{if(X=T.oM)if(!T.parentPath||1>=T.parentPath.length||T.parentPath[1]!==this.YLa)d.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");
else{d.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");T=X.errorCode;switch(T){case null:case -1:this.errorMessage=y.a.instance.ga(2269);break;case 1:this.errorMessage=y.a.instance.ga(2270);break;case 2:this.errorMessage=y.a.instance.ga(2271)}0<this.errorMessage.length&&d.ULS.sendTraceTag(523805122,0,10,`DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:${T?T.toString():"null"}.`);this.bre.stop();this.tableData=X.html;
this.MTc&&(0<this.errorMessage.length?this.SYf():0<this.tableData.length&&this.jZf())}else d.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};this.$=I;this.augmentationLoopManager=F;this.uploaderCreator=U;this.initialize()}dispose(){window.removeEventListener("message",this.kHe,!1);super.dispose()}KSi(I,F){d.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");let U=new Image;U.onload=
()=>{var X=document.createElement("canvas");X.width=U.width;X.height=U.height;const T=X.getContext("2d");try{T.drawImage(U,0,0,U.width,U.height)}catch(J){d.ULS.sendTraceTag(523805145,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: ${J.message}`);return}let G;try{G=X.toDataURL("image/jpeg")}catch(J){d.ULS.sendTraceTag(523805144,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: ${J.message}`);return}X=G.split(",");if(2>X.length)d.ULS.sendTraceTag(523805143,
0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{X=X[1];try{var D=window.self.atob(X)}catch(J){d.ULS.sendTraceTag(523805142,0,10,`DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: ${J.message}`);return}28E5<D.length?(d.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),F.$zj()):(this.njj(this.Jd,this.XT,X,U.width,U.height),URL.revokeObjectURL(U.src),U=null,d.ULS.sendTraceTag(523805140,
0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};U.src=I}V_i(I,F,U,X){this.Jd=I;this.XT=X;this.uploaderCreator.pai(this.$,F,U,X,this)}njj(I,F,U,X,T){this.YLa=f.a.create().toString();this.Vkd=0;this.eyb=U;this.imageWidth=X;this.imageHeight=T;this.errorMessage=this.tableData="";this.MTc=!1;this.T9f=this.$.Jb.Rg("LoadResource","DataFromPictureTaskpaneLaunch");this.T9f.start();this.qVi(I,F);this.bre=this.$.Jb.Rg("LoadResource","DataFromPictureAnnotation");this.bre.start();this.yUj()}yUj(){if(this.eyb.length){var I=
window.self.atob(this.eyb);var F=new Uint8Array(I.length);for(let U=0;U<I.length;U++)F[U]=I.charCodeAt(U);this.augmentationLoopManager.xUj(F,this.YLa,this.imageWidth,this.imageHeight)}else d.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")}qVi(I,F){F.SessionID=this.YLa;F.DataFromPictureAssetId="FA000000050";F.LoadDataFromPictureTaskpane=!0;I=new v.a(-859308420,I.method,I.mode,I.Re,I.tabName);this.$.Ka.Lb(I,F)}A8c(I){try{const F=c.from(I,
"utf16le").toString("base64");return z.a.PHa(this.YLa,F)}catch(F){return d.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message."),""}}rdh(I){try{const F=z.a.PHa(this.YLa,I);return c.from(F,"base64").toString("utf16le")}catch(F){return d.ULS.sendTraceTag(523805132,0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message."),""}}anj(){if(this.eyb.length){var I=m.a(this.$).saa("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.imageData=
this.A8c(this.eyb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",F,U=>{U&&d.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else d.ULS.sendTraceTag(523805131,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")}jZf(){if(this.tableData.length){var I=m.a(this.$).saa("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.tableHtml=this.A8c(this.tableData);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",F,U=>{U&&d.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else d.ULS.sendTraceTag(523805129,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")}SYf(){if(this.errorMessage.length){var I=m.a(this.$).saa("FA000000050"),F={["DataFromPictureWildcard"]:"."};F.errorMessage=this.A8c(this.errorMessage);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(I,"onCustomMessage",F,U=>{U&&d.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else d.ULS.sendTraceTag(523805127,0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")}initialize(){window.addEventListener("message",this.kHe,!1);this.augmentationLoopManager.activateAnnotation(this.Q$e);
this.augmentationLoopManager.qP(this.Q$e,this.I8h)}}Object(b.a)(A,"DataFromPictureManager",l.a,[289])}).call(this,a(1301).hjg)},1301:function(n,C,a){(function(c){function b(){try{var G=new Uint8Array(1);G.__proto__={__proto__:Uint8Array.prototype,PZj:function(){return 42}};return"function"===typeof G.subarray&&0===G.subarray(1,1).byteLength}catch(D){return!1}}function d(G,D){if((f.WO?2147483647:1073741823)<D)throw new RangeError("Invalid typed array length");f.WO?(G=new Uint8Array(D),G.__proto__=
f.prototype):(null===G&&(G=new f(D)),G.length=D);return G}function f(G,D,J){if(!(f.WO||this instanceof f))return new f(G,D,J);if("number"===typeof G){if("string"===typeof D)throw Error("If encoding is specified then the first argument must be a string");return l(this,G)}return e(this,G,D,J)}function e(G,D,J,L){if("number"===typeof D)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&D instanceof ArrayBuffer){D.byteLength;if(0>J||D.byteLength<J)throw new RangeError("'offset' is out of bounds");
if(D.byteLength<J+(L||0))throw new RangeError("'length' is out of bounds");D=void 0===J&&void 0===L?new Uint8Array(D):void 0===L?new Uint8Array(D,J):new Uint8Array(D,J,L);f.WO?(G=D,G.__proto__=f.prototype):G=m(G,D);D=G}else if("string"===typeof D){L=G;G=J;if("string"!==typeof G||""===G)G="utf8";if(!f.lef(G))throw new TypeError('"encoding" must be a valid string encoding');J=w(D,G)|0;L=d(L,J);D=L.write(D,G);D!==J&&(L=L.slice(0,D));D=L}else D=u(G,D);return D}function k(G){if("number"!==typeof G)throw new TypeError('"size" argument must be a number');
if(0>G)throw new RangeError('"size" argument must not be negative');}function l(G,D){k(D);G=d(G,0>D?0:t(D)|0);if(!f.WO)for(var J=0;J<D;++J)G[J]=0;return G}function m(G,D){var J=0>D.length?0:t(D.length)|0;G=d(G,J);for(var L=0;L<J;L+=1)G[L]=D[L]&255;return G}function u(G,D){if(f.isBuffer(D)){var J=t(D.length)|0;G=d(G,J);if(0===G.length)return G;D.copy(G,0,0,J);return G}if(D){if("undefined"!==typeof ArrayBuffer&&D.buffer instanceof ArrayBuffer||"length"in D)return(J="number"!==typeof D.length)||(J=D.length,
J=J!==J),J?d(G,0):m(G,D);if("Buffer"===D.type&&U(D.data))return m(G,D.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function t(G){if(G>=(f.WO?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(f.WO?2147483647:1073741823).toString(16)+" bytes");return G|0}function w(G,D){if(f.isBuffer(G))return G.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(G)||
G instanceof ArrayBuffer))return G.byteLength;"string"!==typeof G&&(G=""+G);var J=G.length;if(0===J)return 0;for(var L=!1;;)switch(D){case "ascii":case "latin1":case "binary":return J;case "utf8":case "utf-8":case void 0:return B(G).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*J;case "hex":return J>>>1;case "base64":return A(G).length;default:if(L)return B(G).length;D=(""+D).toLowerCase();L=!0}}function r(G,D,J){var L=!1;if(void 0===D||0>D)D=0;if(D>this.length)return"";
if(void 0===J||J>this.length)J=this.length;if(0>=J)return"";J>>>=0;D>>>=0;if(J<=D)return"";for(G||(G="utf8");;)switch(G){case "hex":G=D;D=J;J=this.length;if(!G||0>G)G=0;if(!D||0>D||D>J)D=J;L="";for(J=G;J<D;++J)G=L,L=this[J],L=16>L?"0"+L.toString(16):L.toString(16),L=G+L;return L;case "utf8":case "utf-8":return x(this,D,J);case "ascii":G="";for(J=Math.min(this.length,J);D<J;++D)G+=String.fromCharCode(this[D]&127);return G;case "latin1":case "binary":G="";for(J=Math.min(this.length,J);D<J;++D)G+=String.fromCharCode(this[D]);
return G;case "base64":return 0===D&&J===this.length?F.dWe(this):F.dWe(this.slice(D,J));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":D=this.slice(D,J);J="";for(G=0;G<D.length;G+=2)J+=String.fromCharCode(D[G]+256*D[G+1]);return J;default:if(L)throw new TypeError("Unknown encoding: "+G);G=(G+"").toLowerCase();L=!0}}function v(G,D,J,L,H){if(0===G.length)return-1;"string"===typeof J?(L=J,J=0):2147483647<J?J=2147483647:-2147483648>J&&(J=-2147483648);J=+J;isNaN(J)&&(J=H?0:G.length-1);0>J&&(J=
G.length+J);if(J>=G.length){if(H)return-1;J=G.length-1}else if(0>J)if(H)J=0;else return-1;"string"===typeof D&&(D=f.from(D,L));if(f.isBuffer(D))return 0===D.length?-1:y(G,D,J,L,H);if("number"===typeof D)return D&=255,f.WO&&"function"===typeof Uint8Array.prototype.indexOf?H?Uint8Array.prototype.indexOf.call(G,D,J):Uint8Array.prototype.lastIndexOf.call(G,D,J):y(G,[D],J,L,H);throw new TypeError("val must be string, number or Buffer");}function y(G,D,J,L,H){function R(W,da){return 1===Q?W[da]:W.b6i(da*
Q)}var Q=1,O=G.length,V=D.length;if(void 0!==L&&(L=String(L).toLowerCase(),"ucs2"===L||"ucs-2"===L||"utf16le"===L||"utf-16le"===L)){if(2>G.length||2>D.length)return-1;Q=2;O/=2;V/=2;J/=2}if(H)for(L=-1;J<O;J++)if(R(G,J)===R(D,-1===L?0:J-L)){if(-1===L&&(L=J),J-L+1===V)return L*Q}else-1!==L&&(J-=J-L),L=-1;else for(J+V>O&&(J=O-V);0<=J;J--){O=!0;for(L=0;L<V;L++)if(R(G,J+L)!==R(D,L)){O=!1;break}if(O)return J}return-1}function x(G,D,J){J=Math.min(G.length,J);for(var L=[];D<J;){var H=G[D],R=null,Q=239<H?4:
223<H?3:191<H?2:1;if(D+Q<=J)switch(Q){case 1:128>H&&(R=H);break;case 2:var O=G[D+1];128===(O&192)&&(H=(H&31)<<6|O&63,127<H&&(R=H));break;case 3:O=G[D+1];var V=G[D+2];128===(O&192)&&128===(V&192)&&(H=(H&15)<<12|(O&63)<<6|V&63,2047<H&&(55296>H||57343<H)&&(R=H));break;case 4:O=G[D+1];V=G[D+2];var W=G[D+3];128===(O&192)&&128===(V&192)&&128===(W&192)&&(H=(H&15)<<18|(O&63)<<12|(V&63)<<6|W&63,65535<H&&1114112>H&&(R=H))}null===R?(R=65533,Q=1):65535<R&&(R-=65536,L.push(R>>>10&1023|55296),R=56320|R&1023);L.push(R);
D+=Q}G=L.length;if(G<=X)L=String.fromCharCode.apply(String,L);else{J="";for(D=0;D<G;)J+=String.fromCharCode.apply(String,L.slice(D,D+=X));L=J}return L}function B(G,D){D=D||Infinity;for(var J,L=G.length,H=null,R=[],Q=0;Q<L;++Q){J=G.charCodeAt(Q);if(55295<J&&57344>J){if(!H){if(56319<J){-1<(D-=3)&&R.push(239,191,189);continue}else if(Q+1===L){-1<(D-=3)&&R.push(239,191,189);continue}H=J;continue}if(56320>J){-1<(D-=3)&&R.push(239,191,189);H=J;continue}J=(H-55296<<10|J-56320)+65536}else H&&-1<(D-=3)&&R.push(239,
191,189);H=null;if(128>J){if(0>--D)break;R.push(J)}else if(2048>J){if(0>(D-=2))break;R.push(J>>6|192,J&63|128)}else if(65536>J){if(0>(D-=3))break;R.push(J>>12|224,J>>6&63|128,J&63|128)}else if(1114112>J){if(0>(D-=4))break;R.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw Error("Invalid code point");}return R}function z(G){for(var D=[],J=0;J<G.length;++J)D.push(G.charCodeAt(J)&255);return D}function A(G){var D=F,J=D.pKj;G=(G.trim?G.trim():G.replace(/^\s+|\s+$/g,"")).replace(T,"");if(2>
G.length)G="";else for(;0!==G.length%4;)G+="=";return J.call(D,G)}function I(G,D,J,L){for(var H=0;H<L&&!(H+J>=D.length||H>=G.length);++H)D[H+J]=G[H];return H}var F=a(1303);a(1304);var U=a(1305);C.hjg=f;C.pZj=function(G){+G!=G&&(G=0);return f.wqe(+G)};C.XYj=50;f.WO=void 0!==c.WO?c.WO:b();C.XZj=f.WO?2147483647:1073741823;f.from=function(G,D,J){return e(null,G,D,J)};f.WO&&(f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&f[Symbol.species]===
f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0}));f.wqe=function(G){k(G);return d(null,G)};f.oKg=function(G){return l(null,G)};f.isBuffer=function(G){return!(null==G||!G.nsg)};f.compare=function(G,D){if(!f.isBuffer(G)||!f.isBuffer(D))throw new TypeError("Arguments must be Buffers");if(G===D)return 0;for(var J=G.length,L=D.length,H=0,R=Math.min(J,L);H<R;++H)if(G[H]!==D[H]){J=G[H];L=D[H];break}return J<L?-1:L<J?1:0};f.lef=function(G){switch(String(G).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};f.concat=function(G,D){if(!U(G))throw new TypeError('"list" argument must be an Array of Buffers');if(0===G.length)return f.wqe(0);var J;if(void 0===D)for(J=D=0;J<G.length;++J)D+=G[J].length;D=f.oKg(D);var L=0;for(J=0;J<G.length;++J){var H=G[J];if(!f.isBuffer(H))throw new TypeError('"list" argument must be an Array of Buffers');H.copy(D,L);L+=H.length}return D};f.byteLength=w;f.prototype.nsg=!0;f.prototype.toString=function(){var G=this.length|0;return 0===G?"":0===arguments.length?
x(this,0,G):r.apply(this,arguments)};f.prototype.equals=function(G){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:0===f.compare(this,G)};f.prototype.compare=function(G,D,J,L,H){if(!f.isBuffer(G))throw new TypeError("Argument must be a Buffer");void 0===D&&(D=0);void 0===J&&(J=G?G.length:0);void 0===L&&(L=0);void 0===H&&(H=this.length);if(0>D||J>G.length||0>L||H>this.length)throw new RangeError("out of range index");if(L>=H&&D>=J)return 0;if(L>=H)return-1;if(D>=
J)return 1;D>>>=0;J>>>=0;L>>>=0;H>>>=0;if(this===G)return 0;var R=H-L,Q=J-D,O=Math.min(R,Q);L=this.slice(L,H);G=G.slice(D,J);for(D=0;D<O;++D)if(L[D]!==G[D]){R=L[D];Q=G[D];break}return R<Q?-1:Q<R?1:0};f.prototype.includes=function(G,D,J){return-1!==this.indexOf(G,D,J)};f.prototype.indexOf=function(G,D,J){return v(this,G,D,J,!0)};f.prototype.lastIndexOf=function(G,D,J){return v(this,G,D,J,!1)};f.prototype.write=function(G,D,J,L){if(void 0===D)L="utf8",J=this.length,D=0;else if(void 0===J&&"string"===
typeof D)L=D,J=this.length,D=0;else if(isFinite(D))D|=0,isFinite(J)?(J|=0,void 0===L&&(L="utf8")):(L=J,J=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var H=this.length-D;if(void 0===J||J>H)J=H;if(0<G.length&&(0>J||0>D)||D>this.length)throw new RangeError("Attempt to write outside buffer bounds");L||(L="utf8");for(H=!1;;)switch(L){case "hex":D=Number(D)||0;L=this.length-D;J?(J=Number(J),J>L&&(J=L)):J=L;L=G.length;if(0!==L%2)throw new TypeError("Invalid hex string");
J>L/2&&(J=L/2);for(L=0;L<J;++L){H=parseInt(G.substr(2*L,2),16);if(isNaN(H))break;this[D+L]=H}return L;case "utf8":case "utf-8":return I(B(G,this.length-D),this,D,J);case "ascii":return I(z(G),this,D,J);case "latin1":case "binary":return I(z(G),this,D,J);case "base64":return I(A(G),this,D,J);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":L=G;H=this.length-D;for(var R=[],Q=0;Q<L.length&&!(0>(H-=2));++Q){var O=L.charCodeAt(Q);G=O>>8;O%=256;R.push(O);R.push(G)}return I(R,this,D,J);default:if(H)throw new TypeError("Unknown encoding: "+
L);L=(""+L).toLowerCase();H=!0}};f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.tZj||this,0)}};var X=4096;f.prototype.slice=function(G,D){var J=this.length;G=~~G;D=void 0===D?J:~~D;0>G?(G+=J,0>G&&(G=0)):G>J&&(G=J);0>D?(D+=J,0>D&&(D=0)):D>J&&(D=J);D<G&&(D=G);if(f.WO)D=this.subarray(G,D),D.__proto__=f.prototype;else{J=D-G;D=new f(J,void 0);for(var L=0;L<J;++L)D[L]=this[L+G]}return D};f.prototype.b6i=function(G){if(0!==G%1||0>G)throw new RangeError("offset is not uint");
if(G+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[G]<<8|this[G+1]};f.prototype.copy=function(G,D,J,L){J||(J=0);L||0===L||(L=this.length);D>=G.length&&(D=G.length);D||(D=0);0<L&&L<J&&(L=J);if(L===J||0===G.length||0===this.length)return 0;if(0>D)throw new RangeError("targetStart out of bounds");if(0>J||J>=this.length)throw new RangeError("sourceStart out of bounds");if(0>L)throw new RangeError("sourceEnd out of bounds");L>this.length&&(L=this.length);G.length-
D<L-J&&(L=G.length-D+J);var H=L-J;if(this===G&&J<D&&D<L)for(L=H-1;0<=L;--L)G[L+D]=this[L+J];else if(1E3>H||!f.WO)for(L=0;L<H;++L)G[L+D]=this[L+J];else Uint8Array.prototype.set.call(G,this.subarray(J,J+H),D);return H};f.prototype.fill=function(G,D,J,L){if("string"===typeof G){"string"===typeof D?(L=D,D=0,J=this.length):"string"===typeof J&&(L=J,J=this.length);if(1===G.length){var H=G.charCodeAt(0);256>H&&(G=H)}if(void 0!==L&&"string"!==typeof L)throw new TypeError("encoding must be a string");if("string"===
typeof L&&!f.lef(L))throw new TypeError("Unknown encoding: "+L);}else"number"===typeof G&&(G&=255);if(0>D||this.length<D||this.length<J)throw new RangeError("Out of range index");if(J<=D)return this;D>>>=0;J=void 0===J?this.length:J>>>0;G||(G=0);if("number"===typeof G)for(L=D;L<J;++L)this[L]=G;else for(G=f.isBuffer(G)?G:B((new f(G,L)).toString()),H=G.length,L=0;L<J-D;++L)this[L+D]=G[L%H];return this};var T=/[^+\/0-9A-Za-z-_]/g}).call(this,a(1302))},1302:function(n){var C=function(){return this}();
try{C=C||(new Function("return this"))()}catch(a){"object"===typeof window&&(C=window)}n.exports=C},1303:function(n,C){function a(f){var e=f.length;if(0<e%4)throw Error("Invalid string. Length must be a multiple of 4");f=f.indexOf("=");-1===f&&(f=e);return[f,f===e?0:4-f%4]}C.byteLength=function(f){f=a(f);var e=f[1];return 3*(f[0]+e)/4-e};C.pKj=function(f){var e=a(f);var k=e[0];e=e[1];var l=new d(3*(k+e)/4-e),m=0,u=0<e?k-4:k,t;for(t=0;t<u;t+=4)k=b[f.charCodeAt(t)]<<18|b[f.charCodeAt(t+1)]<<12|b[f.charCodeAt(t+
2)]<<6|b[f.charCodeAt(t+3)],l[m++]=k>>16&255,l[m++]=k>>8&255,l[m++]=k&255;2===e&&(k=b[f.charCodeAt(t)]<<2|b[f.charCodeAt(t+1)]>>4,l[m++]=k&255);1===e&&(k=b[f.charCodeAt(t)]<<10|b[f.charCodeAt(t+1)]<<4|b[f.charCodeAt(t+2)]>>2,l[m++]=k>>8&255,l[m++]=k&255);return l};C.dWe=function(f){for(var e=f.length,k=e%3,l=[],m=0,u=e-k;m<u;m+=16383){for(var t=l,w=t.push,r,v=f,y=m+16383>u?u:m+16383,x=[],B=m;B<y;B+=3)r=(v[B]<<16&16711680)+(v[B+1]<<8&65280)+(v[B+2]&255),x.push(c[r>>18&63]+c[r>>12&63]+c[r>>6&63]+c[r&
63]);r=x.join("");w.call(t,r)}1===k?(f=f[e-1],l.push(c[f>>2]+c[f<<4&63]+"==")):2===k&&(f=(f[e-2]<<8)+f[e-1],l.push(c[f>>10]+c[f>>4&63]+c[f<<2&63]+"="));return l.join("")};var c=[],b=[],d="undefined"!==typeof Uint8Array?Uint8Array:Array;for(n=0;64>n;++n)c[n]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n],b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(n)]=n;b[45]=62;b[95]=63},1304:function(n,C){C.read=function(a,c,b,d,f){var e=8*f-d-1;var k=(1<<
e)-1,l=k>>1,m=-7;f=b?f-1:0;var u=b?-1:1,t=a[c+f];f+=u;b=t&(1<<-m)-1;t>>=-m;for(m+=e;0<m;b=256*b+a[c+f],f+=u,m-=8);e=b&(1<<-m)-1;b>>=-m;for(m+=d;0<m;e=256*e+a[c+f],f+=u,m-=8);if(0===b)b=1-l;else{if(b===k)return e?NaN:Infinity*(t?-1:1);e+=Math.pow(2,d);b-=l}return(t?-1:1)*e*Math.pow(2,b-d)};C.write=function(a,c,b,d,f,e){var k,l=8*e-f-1,m=(1<<l)-1,u=m>>1,t=23===f?Math.pow(2,-24)-Math.pow(2,-77):0;e=d?0:e-1;var w=d?1:-1,r=0>c||0===c&&0>1/c?1:0;c=Math.abs(c);isNaN(c)||Infinity===c?(c=isNaN(c)?1:0,d=m):
(d=Math.floor(Math.log(c)/Math.LN2),1>c*(k=Math.pow(2,-d))&&(d--,k*=2),c=1<=d+u?c+t/k:c+t*Math.pow(2,1-u),2<=c*k&&(d++,k/=2),d+u>=m?(c=0,d=m):1<=d+u?(c=(c*k-1)*Math.pow(2,f),d+=u):(c=c*Math.pow(2,u-1)*Math.pow(2,f),d=0));for(;8<=f;a[b+e]=c&255,e+=w,c/=256,f-=8);d=d<<f|c;for(l+=f;0<l;a[b+e]=d&255,e+=w,d/=256,l-=8);a[b+e-w]|=128*r}},1305:function(n){var C={}.toString;n.exports=Array.isArray||function(a){return"[object Array]"==C.call(a)}},1306:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);
C=a(724);var c=a(698);class b extends C.a{constructor(){super();this.html=this.errorDescription=this.errorCode=null;this.H_=Object.assign(new c.a,{T_:b.getTypeName(),B_:b.Qd()})}static getTypeName(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"}static Qd(){return["AugLoop_Core_Annotation"]}}Object(n.a)(b,"DetectedHtmlTableAnnotation",C.a,[])},1307:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{static PHa(b,d){if(!(b&&d&&b.length&&d.length)||256<b.length)return"";const f=
Array(256),e=Array(256);let k,l=0,m=0;let u,t="";for(k=0;256>k;k++)f[k]=k;for(k=0;256>k;k++){var w=b.charCodeAt(k%b.length);if(256<=w)return"";l=(l+f[k]+w)%256;w=f[k];f[k]=f[l];f[l]=w}for(k=0;256>k;k++)e[k]=f[256-k-1];l=k=0;for(b=0;b<d.length;b++){k=(k+1)%256;l=(l+f[k])%256;w=f[k];f[k]=f[l];f[l]=w;w=d.charCodeAt(b);if(256<=w)return"";u=w^f[(f[k]+f[l])%256];m=(m+e[k])%256;w=e[k];e[k]=e[m];e[m]=w;t+=String.fromCharCode(u^f[(e[k]+e[m])%256])}return t}}Object(n.a)(c,"RC4A",null,[])},1309:function(n,C,
a){a.d(C,"a",function(){return b});n=a(0);a(15);var c=a(4);class b{constructor(d,f,e,k){this.lkb=d;c.AFrameworkApplication.fa.qa("AddInCommandsMissingTabIsEnabled")&&e.BSh();this.Img=this.lx=f;this.oxg=k}get JDb(){return this.lkb}get solutionId(){return this.lx}get assetId(){return this.Img}get qSd(){return this.oxg}qKa(d){d=this.JDb+this.solutionId+d;return this.qSd?(d in b.r_b||(b.r_b[d]="AddinControl"+b.dJg++),b.r_b[d]):d}eHe(d){if(this.qSd){const e=b.r_b;for(let k in e){var f=k;if(d===e[k])return f.substr(this.JDb.length+
this.solutionId.length)}}return d}i4e(d){d=this.JDb+this.solutionId+d;return this.qSd?(d in b.hWc||(b.hWc[d]="AddinTab"+b.nJg++),b.hWc[d]):d}}b.r_b={};b.hWc={};b.nJg=0;b.dJg=0;Object(n.a)(b,"DefaultRibbonNamingProvider",null,[816])},1356:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(82),d;(function(r){r[r.none=0]="none";r[r.testEvent=1]="testEvent";r[r.test1Event=2]="test1Event";r[r.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";r[r.worksheetActivatedEvent=11]="worksheetActivatedEvent";
r[r.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";r[r.worksheetAddedEvent=13]="worksheetAddedEvent";r[r.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";r[r.worksheetDeletedEvent=15]="worksheetDeletedEvent";r[r.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";r[r.worksheetFilteredEvent=17]="worksheetFilteredEvent";r[r.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";r[r.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";r[r.worksheetColumnSortedEvent=
20]="worksheetColumnSortedEvent";r[r.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";r[r.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";r[r.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";r[r.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";r[r.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";r[r.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";r[r.worksheetMovedEvent=27]="worksheetMovedEvent";r[r.worksheetNavigationObjectChangedEvent=
28]="worksheetNavigationObjectChangedEvent";r[r.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";r[r.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";r[r.chartAddedEvent=50]="chartAddedEvent";r[r.chartActivatedEvent=51]="chartActivatedEvent";r[r.chartDeactivatedEvent=52]="chartDeactivatedEvent";r[r.chartDeletedEvent=53]="chartDeletedEvent";r[r.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";r[r.tableDataChangedEvent=101]="tableDataChangedEvent";
r[r.tableAddedEvent=102]="tableAddedEvent";r[r.tableDeletedEvent=103]="tableDeletedEvent";r[r.tableFilteredEvent=104]="tableFilteredEvent";r[r.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";r[r.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";r[r.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";r[r.commentAddedEvent=250]="commentAddedEvent";r[r.commentDeletedEvent=251]="commentDeletedEvent";r[r.commentChangedEvent=252]="commentChangedEvent";r[r.invocationMessage=
1E3]="invocationMessage";r[r.cancellationMessage=1001]="cancellationMessage";r[r.metadataMessage=1002]="metadataMessage";r[r.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";r[r.visualChangeEvent=2001]="visualChangeEvent";r[r.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";r[r.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";r[r.shapeActivatedEvent=2101]="shapeActivatedEvent";r[r.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";r[r.shapeAddedEvent=
2103]="shapeAddedEvent";r[r.shapeDeletedEvent=2104]="shapeDeletedEvent";r[r.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";r[r.wacOperationEvent=2201]="wacOperationEvent";r[r.recordingStateChangedEvent=2202]="recordingStateChangedEvent";r[r.workbookActivatedEvent=2203]="workbookActivatedEvent";r[r.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";r[r.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";r[r.linkedDataTypeRefreshRequestCompletedEvent=
2500]="linkedDataTypeRefreshRequestCompletedEvent";r[r.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";r[r.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";r[r.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";r[r.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";r[r.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";r[r.rangePickerDeactivatedEvent=
2701]="rangePickerDeactivatedEvent";r[r.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";r[r.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";r[r.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";r[r.pivotTableAddedEvent=2900]="pivotTableAddedEvent";r[r.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";r[r.namedItemAddedEvent=3E3]="namedItemAddedEvent";r[r.namedItemDeletedEvent=3001]="namedItemDeletedEvent";r[r.guidedReapplyManagerUpdateAvailableEvent=
3100]="guidedReapplyManagerUpdateAvailableEvent";r[r.vbaRecorderRecordingChangedEvent=3200]="vbaRecorderRecordingChangedEvent";r[r.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";r[r.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(d||(d={}));Object(n.b)("MessageType",d);var f=a(766),e=a(248),k=a(735),l=a(58),m=a(37),u=a(152),t=a(1);a.d(C,"DdaEventDispatch",function(){return w});class w{constructor(r){this.aB=null;this.Hag={};this.Jag=
{};this.qbd={};this.jzd={};this.ijd=(v,y)=>{v=this.$.Jb.Bc("Task","DdaEventDispatch.HandleServerEvent");y=y.pZf;for(let A=0;A<y.length;A++)switch(y[A].EventType){case 2:var x=y[A],B={};B.Name=x.Name;B.BindingType=x.BindingType;B.ColCount=x.ColCount;B.RowCount=x.RowCount;this.awa(x.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,B,null);break;case 4:this.awa(y[A].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(x=y[A],x.InstanceId){B=Array(x.Entries.length);
for(var z=0;z<x.Entries.length;z++)B[z]=w.dcc(x.Entries[z],x.IsRemoteOverride);0<x.Entries.length&&1===x.Entries[0].Category?this.n1i(x.InstanceId,B):x.InstanceId&&this.awa(x.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,B)}else{this.qbd={};this.jzd={};for(B=0;B<x.Entries.length;B++)this.DJe(x.Entries[B],x.IsRemoteOverride);x=JSON.stringify(this.qbd);B=JSON.stringify(this.jzd);z=JSON.stringify(this.Hag);const I=JSON.stringify(this.Jag);c.ULS.sendTraceTag(537170593,0,50,`Number of Fired event: ${x}, Number of Not Fired event: ${B}, Total Number of Fired event: ${z}, Total Number of Not Fired event: ${I}`)}}v.stop()};
this.QKb=(v,y)=>{this.awa(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,y)};this.$=r;this.cwc=this.ijd}VZb(r){r&&(this.zia(),this.aB.push(r))}qtc(r){this.aB&&(Array.remove(this.aB,r),this.aB.length||(this.$.wantServerEvents=!1,this.$.edj(this.cwc),this.aB=null))}n1i(r,v){const y=Object(b.a)(k.DdaFacade,e.a(this.$));m.TaskExtensions.Aa(y.WTh(r),x=>{if(u.b(x)){var B=x.result;x=y.pn(B);if(B)if(x.Chc)this.awa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v);else if(x.P5b)for(B=0;B<v.length;B++)x.P5b.push(v[B]);
else x.P5b=v}else x.Tf?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):x.Eh&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)}J1i(r,v){const y=Object(b.a)(k.DdaFacade,e.a(this.$)),x=y.jIh(r);x?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(x,v,this.QKb):y.m5g(r,v)}DJe(r,v){let y=!1;const x=parseInt(r.Type,
10);var B=r.Target;const z=Object(b.a)(k.DdaFacade,e.a(this.$));if((B=z.jj.bUh(x,B))&&0<Object.keys(B).length){y=!0;for(let I in B)if(B=I,z.jj.e0b(B)){const F=Array(1);F[0]=w.dcc(r,v);if(t.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var A=F[0][3];if(void 0!==A&&null!==A&&(A=Object(b.a)(Object,l.a.$h(A)))&&void 0!==A.triggerControlId&&null!==A.triggerControlId&&void 0!==A.triggerSource&&null!==A.triggerSource){let U=!1;v?(A.triggerSource="Unknown",U=!0):z.eih(A.triggerControlId,
B)&&(A.triggerSource="ThisLocalAddin",U=!0);U&&(F[0][3]=l.a.kc(A))}}this.awa(B,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,F)}}y?(this.Mec(d[x],this.qbd),this.Mec(d[x],this.Hag)):(this.Mec(d[x],this.jzd),this.Mec(d[x],this.Jag))}zia(){this.aB||(this.aB=[],this.$.tpe(this.cwc),this.$.wantServerEvents=!0)}Mec(r,v){r in v||(v[r]=0);v[r]+=1}NM(r,v,y){const x={};x.Target=v;x.Category=65536;x.Type=r;x.Message=y;x.Id=-1;this.DJe(x,!1)}eCh(r,v){const y={Target:"",Category:2,Type:1E3};y.Message=v;y.Id=
0;v=Array(1);v[0]=w.dcc(y,!1);this.J1i(r,v)}c$b(r,v,y,x){const B={};B.Target=y;B.Category=65536;B.Type=v;B.Message=x;B.Id=-1;v=Array(1);v[0]=w.dcc(B,!1);this.awa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)}dCh(r,v){this.awa(r,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)}awa(r,v,y,x){if(this.aB){var B=Object(b.a)(k.DdaFacade,e.a(this.$));if(!B||v!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&v!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||B.jj.e0b(r)){r=new f.a(v,r,
y,x);for(let z=0,A=this.aB.length;z<A;z++)(v=this.aB[z])&&v(r)}}}static dcc(r,v){const y=Array(6);y[0]=r.Category;y[1]=r.Type;y[2]=r.Target;y[3]=r.Message;y[4]=r.Id;y[5]=v;return y}}Object(n.a)(w,"DdaEventDispatch",null,[])},1387:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);C=a(144);var c=a(88);class b extends C.a{constructor(){super(void 0,void 0,void 0,!0);this.lDa="AddinCommandsUILessDialog";this.ISc="WACDialogTitleText";this.afa="0";this.uX=380;this.Spa=190;this.Ce=this.lDa;this.Rb=
5;this.xog=String.format("{0}px",this.uX);this.$ea=String.format("{0}px",this.Spa);this.O7e=this.ut=!1;this.Rz()}Rz(){super.Rz();this.Sk.style.width=this.xog;this.Sk.style.height=this.$ea;this.Sk.style.padding=this.afa}Cv(d){this.HI();document.getElementById(this.ni(this.ISc)).innerText=d}HI(){super.HI();this.wb.style.width=String.format("{0}px",this.uX);this.wb.style.height=String.format("{0}px",this.Spa);this.wb.removeAttribute(c.a.Kd);this.wb.removeAttribute(c.a.CE)}hide(){this.Pxb()}get Tta(){return this.Sk}initializeAndShowWithTitle(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,
null,null)}}Object(n.a)(b,"AddinCommandsUILessDialog",C.a,[825])},1417:function(n,C,a){a.r(C);var c=a(510),b=a(956),d=a(1183),f=a(9),e=a(0),k=a(222),l=a(187),m=a(587);class u{constructor(){this.Jgb=null}get $Og(){this.Jgb||(this.Jgb=new l.a,this.Jgb.add(12),this.Jgb.add(11));return this.Jgb}hfi(N){return this.$Og.contains(N.operation)}GOj(N){const La=[],Eb=N.payload;for(const kc of Eb.batchedOperations)La.push(new m.a(N.operation,kc));return La}}Object(e.a)(u,"MacroRecorderBatchedEventList",null,
[]);var t=a(15),w=a(58),r=a(121),v=a(641);class y{equals(N,La){return N===La}getHashCode(N){return N}wja(N){return N}}Object(e.a)(y,"UserOperationNameComparer",null,[108,109]);class x{static X0h(){x.Mc||(x.Mc=new v.a(new y),x.Mc.add(507),x.Mc.add(10),x.Mc.add(576),x.Mc.add(563),x.Mc.add(564),x.Mc.add(565),x.Mc.add(566),x.Mc.add(567),x.Mc.add(568),x.Mc.add(569),x.Mc.add(570),x.Mc.add(571),x.Mc.add(572),x.Mc.add(573),x.Mc.add(574),x.Mc.add(575),x.Mc.add(501),x.Mc.add(520),x.Mc.add(1),x.Mc.add(1002),
x.Mc.add(129),x.Mc.add(198),x.Mc.add(500),x.Mc.add(519),x.Mc.add(538),x.Mc.add(1E3),x.Mc.add(1003),x.Mc.add(144),x.Mc.add(502),x.Mc.add(505),x.Mc.add(179),x.Mc.add(205),x.Mc.add(134),x.Mc.add(230),x.Mc.add(103),x.Mc.add(110),x.Mc.add(112),x.Mc.add(113),x.Mc.add(124),x.Mc.add(133),x.Mc.add(154),x.Mc.add(162),x.Mc.add(168),x.Mc.add(172),x.Mc.add(201),x.Mc.add(222),x.Mc.add(227),x.Mc.add(513),x.Mc.add(534),x.Mc.add(539),x.Mc.add(545),x.Mc.add(600),x.Mc.add(547),x.Mc.add(555),x.Mc.add(558),x.Mc.add(562),
x.Mc.add(585),x.Mc.add(1001),x.Mc.add(1005),x.Mc.add(1008),x.Mc.add(1010),x.Mc.add(1011),x.Mc.add(1012),x.Mc.add(1018),x.Mc.add(252),x.Mc.add(253),x.Mc.add(258),x.Mc.add(101),x.Mc.add(102),x.Mc.add(108),x.Mc.add(257),x.Mc.add(119),x.Mc.add(120),x.Mc.add(123),x.Mc.add(126),x.Mc.add(127),x.Mc.add(130),x.Mc.add(140),x.Mc.add(159),x.Mc.add(160),x.Mc.add(165),x.Mc.add(166),x.Mc.add(167),x.Mc.add(169),x.Mc.add(189),x.Mc.add(223),x.Mc.add(214),x.Mc.add(228),x.Mc.add(233),x.Mc.add(247),x.Mc.add(504),x.Mc.add(511),
x.Mc.add(512),x.Mc.add(525),x.Mc.add(533),x.Mc.add(537),x.Mc.add(542),x.Mc.add(544),x.Mc.add(548),x.Mc.add(550),x.Mc.add(551),x.Mc.add(552),x.Mc.add(554),x.Mc.add(577),x.Mc.add(584),x.Mc.add(586),x.Mc.add(587),x.Mc.add(588),x.Mc.add(592),x.Mc.add(1009),x.Mc.add(1016),x.Mc.add(1017));return x.Mc}}x.Mc=null;Object(e.a)(x,"MacroRecorderUnrecognizedEventList",null,[]);class B{constructor(N,La,Eb){this.a$b=null;this.gyi=(kc,Mc)=>{this.x3f()&&this.nbd(Mc)};this.mqf=La;this.lqf=Eb;this.$=N;this.$.QZ&&this.$.yHg(this.gyi);
N.da.Ga(297,this)}init(N){this.$.QZ&&(N?this.a$b=N:t.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))}nbd(N){if(this.x3f())try{if(this.lqf.hfi(N)){const La=this.lqf.GOj(N);for(const Eb of La)this.xUe(Eb)}else this.xUe(N)}catch(La){N=`MacroRecorderEventHandler.FireMacroRecorderEvent: Error: ${r.a(N.operation)}, Exception: ${La.stack}`,t.ULS.sendTraceTag(537155423,0,10,N)}}xUe(N){var La=this.mqf.N0e(N,!0);La?(this.a$b(La.eventId,w.a.kc(N.payload)),
t.ULS.sendTraceTag(537155422,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${La.eventId}`)):(La=this.mqf.N0e(N,!1))?t.ULS.sendTraceTag(537155421,0,50,`MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: ${La.eventId}, but failed to match filters`):x.X0h().contains(N.operation)||(this.a$b(0,w.a.kc(N.operation)),N=`MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: ${r.a(N.operation)}`,t.ULS.sendTraceTag(537155420,0,50,N))}x3f(){return this.$.Jka&&this.a$b&&this.$.Cba?
!0:!1}}Object(e.a)(B,"MacroRecorderEventHandler",null,[851]);var z=a(1);class A{constructor(){this.IIc=this.JIc=this.GOc=this.gTc=null}get operations(){this.GOc||(this.GOc=new l.a,this.Yb());return this.GOc}get mDc(){this.gTc||(this.gTc=new l.a,this.eg());return this.gTc}get dTe(){this.IIc||(this.IIc=new l.a);return this.IIc}get featureGates(){this.JIc||(this.JIc=new l.a,this.ywa());return this.JIc}eg(){}ywa(){}ld(N){this.mDc.add(N)}Ob(N){this.operations.contains(N)||this.operations.add(N)}dnb(){this.featureGates.add(667)}Ime(N){this.dTe.add(N)}}
Object(e.a)(A,"MacroRecorderEventBase",null,[]);class I extends A{constructor(){super()}get eventId(){return 130}Yb(){this.Ob(100)}}Object(e.a)(I,"AccessibilityCheckRunEvent",A,[]);class F extends A{constructor(){super()}get eventId(){return 160}Yb(){this.Ob(241)}eg(){this.ld(N=>N.addToPrintArea)}}Object(e.a)(F,"AddedToPrintAreaEvent",A,[]);class U extends A{constructor(){super()}get eventId(){return 65}Yb(){this.Ob(516)}}Object(e.a)(U,"AutoFilterToggledEvent",A,[]);class X extends A{constructor(){super()}get eventId(){return 118}Yb(){this.Ob(502)}eg(){this.ld(N=>
!(N.P4a().FirstColumn===N.P4a().LastColumn&&N.P4a().FirstRow===N.P4a().LastRow))}}Object(e.a)(X,"AutoSumEvent",A,[]);class T extends A{constructor(N,La){super();this.qfa=N;this.xVj=La}get eventId(){return this.qfa}Yb(){this.Ob(529);this.Ob(594)}eg(){this.ld(N=>this.xVj.includes(N.ggd()))}}Object(e.a)(T,"ChartPropertyAppliedEventBase",A,[]);class G extends T{constructor(){super(84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])}}Object(e.a)(G,"ChartAxisChangedEvent",T,[]);class D extends T{constructor(){super(80,
[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])}}Object(e.a)(D,"ChartAxisTitleChangedEvent",T,[]);class J extends T{constructor(){super(82,[200,201,202,203,204,205,206,207,208,209,210])}}Object(e.a)(J,"ChartDataLabelsChangedEvent",T,[]);class L extends T{constructor(){super(76,[-100])}}Object(e.a)(L,"ChartDataSelectedEvent",T,[]);class H extends T{constructor(){super(83,[500,501,502])}}Object(e.a)(H,"ChartDataTableChangedEvent",T,[]);var R=a(554),Q=a(414),O=a(82);class V extends A{constructor(){super()}}
Object(e.a)(V,"RichApiRequestExecutedEventBase",A,[]);class W{constructor(N,La,Eb){this.response=this.request=this.eventId=this.source=null;N&&(this.source=N.source,this.eventId=N.eventId,this.request=La,this.response=Eb)}get isValid(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}Object(e.a)(W,"MacroRecorderRichApiRequestExecutedPayload",null,[115]);class da extends V{constructor(){super()}get eventId(){return 117}vw(N){da.U6||(da.U6=new v.a(R.a.Zk()),
da.U6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),da.U6.add("fa000000014"));return!!N&&da.U6.contains(N.toLowerCase())}Yb(){this.Ob(507);this.Ob(10);this.Ob(576)}eg(){this.ld(N=>Object(Q.a)(W,N)&&(N=Object(O.a)(W,N),N.isValid&&this.vw(N.source))?(t.ULS.sendTraceTag(537155427,0,50,`[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: ${N.eventId}`),!0):!1)}}da.U6=null;Object(e.a)(da,"ChartFormatRichApiRequestExecutedEvent",V,[]);class ta extends T{constructor(){super(85,
[328,329,330,331,332,333,334,335])}}Object(e.a)(ta,"ChartGridlinesChangedEvent",T,[]);class K extends A{constructor(){super()}get eventId(){return 66}Yb(){this.Ob(528)}}Object(e.a)(K,"ChartInsertedEvent",A,[]);class na extends T{constructor(){super(81,[100,101,102,103,104,105,106])}}Object(e.a)(na,"ChartLegendChangedEvent",T,[]);class P extends T{constructor(){super(75,[-101])}}Object(e.a)(P,"ChartRowColumnSwitchedEvent",T,[]);class ka extends T{constructor(){super(79,[0,1,2,-102])}}Object(e.a)(ka,
"ChartTitleChangedEvent",T,[]);class pa extends T{constructor(){super(78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])}}Object(e.a)(pa,"ChartTypeChangedEvent",T,[]);class Na extends A{constructor(){super()}get eventId(){return 131}Yb(){this.Ob(521)}}Object(e.a)(Na,"ConnectorFloatingObjectResizedEvent",A,[]);class Z extends A{constructor(){super()}get eventId(){return 129}Yb(){this.Ob(109)}}
Object(e.a)(Z,"EntitySelectedEvent",A,[]);class Ra extends A{constructor(){super()}get eventId(){return 49}Yb(){this.Ob(149);this.Ob(147)}}Object(e.a)(Ra,"FindCellEvent",A,[]);class Da extends A{constructor(){super()}get eventId(){return 96}Yb(){this.Ob(122)}}Object(e.a)(Da,"FloatingObjectAltTextAppliedEvent",A,[]);class Ba extends A{constructor(){super()}get eventId(){return 93}Yb(){this.Ob(522)}}Object(e.a)(Ba,"FloatingObjectDeletedEvent",A,[]);class ea extends A{constructor(){super()}get eventId(){return 94}Yb(){this.Ob(524)}}
Object(e.a)(ea,"FloatingObjectMovedAndResizedEvent",A,[]);class Y extends A{constructor(){super()}get eventId(){return 95}Yb(){this.Ob(523)}}Object(e.a)(Y,"FloatingObjectRotatedEvent",A,[]);class ja extends A{constructor(){super()}get eventId(){return 100}Yb(){this.Ob(543)}}Object(e.a)(ja,"GroupDetailsShownOrHiddenEvent",A,[]);class ca extends A{constructor(){super()}get eventId(){return 154}Yb(){this.Ob(125)}}Object(e.a)(ca,"HyperlinksRemovedFromRangeEvent",A,[]);class ba extends V{constructor(){super()}get eventId(){return 125}vw(N){ba.U6||
(ba.U6=new v.a(R.a.Zk()),ba.U6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ba.U6.add("fa000000005"));return!!N&&ba.U6.contains(N.toLowerCase())}Yb(){this.Ob(507);this.Ob(10);this.Ob(576)}eg(){this.ld(N=>Object(Q.a)(W,N)?(N=Object(O.a)(W,N),N.isValid&&this.vw(N.source)):!1)}}ba.U6=null;Object(e.a)(ba,"IdeasRichApiRequestExecutedEvent",V,[]);class ua extends A{constructor(){super()}get eventId(){return 136}Yb(){this.Ob(115)}}Object(e.a)(ua,"LinkedEntityConvertedEvent",A,[]);class wa extends A{constructor(){super()}get eventId(){return 148}Yb(){this.Ob(114)}}
Object(e.a)(wa,"LinkedEntityDisambiguationPaneToggledEvent",A,[]);class ia extends A{constructor(){super()}get eventId(){return 127}Yb(){this.Ob(119)}}Object(e.a)(ia,"MovedToEdgeEvent",A,[]);class xa extends A{constructor(){super()}get eventId(){return 135}Yb(){this.Ob(191)}ywa(){this.dnb()}}Object(e.a)(xa,"NamedSheetViewCreatedEvent",A,[]);class gb extends A{constructor(){super()}get eventId(){return 166}Yb(){this.Ob(200)}ywa(){this.dnb()}}Object(e.a)(gb,"NamedSheetViewDeletedEvent",A,[]);class va extends A{constructor(){super()}get eventId(){return 133}Yb(){this.Ob(192)}ywa(){this.dnb()}}
Object(e.a)(va,"NamedSheetViewExitedEvent",A,[]);class sa extends A{constructor(){super()}get eventId(){return 162}Yb(){this.Ob(199)}ywa(){this.dnb()}}Object(e.a)(sa,"NamedSheetViewRenamedEvent",A,[]);class ab extends A{constructor(){super()}get eventId(){return 167}Yb(){this.Ob(195)}ywa(){this.dnb()}}Object(e.a)(ab,"NamedSheetViewSwitchedEvent",A,[]);class Ua extends A{constructor(){super()}get eventId(){return 99}Yb(){this.Ob(174)}}Object(e.a)(Ua,"OutlineLevelSetEvent",A,[]);class nb extends A{constructor(){super()}get eventId(){return 156}Yb(){this.Ob(244)}}
Object(e.a)(nb,"PageBreakInsertedEvent",A,[]);class Ha extends A{constructor(){super()}get eventId(){return 157}Yb(){this.Ob(245)}}Object(e.a)(Ha,"PageBreakRemovedEvent",A,[]);class sb extends A{constructor(){super()}get eventId(){return 158}Yb(){this.Ob(246)}}Object(e.a)(sb,"PageBreaksAllResetEvent",A,[]);class Qb extends A{constructor(){super()}get eventId(){return 112}Yb(){this.Ob(503)}eg(){this.ld(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&
!N.isFromCurrentSession)}}Object(e.a)(Qb,"PasteArtOtherWorkbookEvent",A,[]);class mb extends A{constructor(){super()}get eventId(){return 52}Yb(){this.Ob(503)}eg(){this.ld(N=>!!N.pasteParameters.ClientEstimationFloatingObjectId&&2===N.pasteParameters.CopyPasteTargetType&&N.isFromCurrentSession)}}Object(e.a)(mb,"PasteArtSameWorkbookEvent",A,[]);class Pb extends A{constructor(){super()}get eventId(){return 110}Yb(){this.Ob(204)}}Object(e.a)(Pb,"PasteHtmlEvent",A,[]);class gc extends A{constructor(){super()}get eventId(){return 35}Yb(){this.Ob(506)}}
Object(e.a)(gc,"PasteRangeEvent",A,[]);class Xb extends A{constructor(){super()}get eventId(){return 111}Yb(){this.Ob(503)}eg(){this.ld(N=>1===N.pasteParameters.CopyPasteTargetType)}}Object(e.a)(Xb,"PasteShadowWorkbookRangeEvent",A,[]);class Ca extends A{constructor(){super()}get eventId(){return 42}Yb(){this.Ob(180)}}Object(e.a)(Ca,"PasteStringEvent",A,[]);class ra extends A{constructor(){super()}get eventId(){return 134}Yb(){this.Ob(220)}}Object(e.a)(ra,"PendingMergeEvent",A,[]);class ma extends A{constructor(){super()}get eventId(){return 122}Yb(){this.Ob(510)}}
Object(e.a)(ma,"PictureInsertedEvent",A,[]);class hb extends A{constructor(){super()}get eventId(){return 153}Yb(){this.Ob(161)}}Object(e.a)(hb,"PivotDrillToggledEvent",A,[]);class vb extends A{constructor(N,La){super();this.qfa=N;this.opType=La}get eventId(){return this.qfa}Yb(){this.Ob(225)}eg(){this.ld(N=>N.opType===this.opType)}}Object(e.a)(vb,"PivotTableSettingsChangedEventBase",A,[]);class Va extends vb{constructor(){super(171,4)}}Object(e.a)(Va,"PivotTableAllItemLabelsRepeatedEvent",vb,[]);
class db extends vb{constructor(){super(184,17)}}Object(e.a)(db,"PivotTableAltTextDescriptionChangedEvent",vb,[]);class oa extends vb{constructor(){super(183,16)}}Object(e.a)(oa,"PivotTableAltTextTitleChangedEvent",vb,[]);class Oa extends vb{constructor(){super(173,6)}}Object(e.a)(Oa,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",vb,[]);class Wa extends vb{constructor(){super(172,5)}}Object(e.a)(Wa,"PivotTableBlankLineAfterEachItemToggledEvent",vb,[]);class Sa extends vb{constructor(){super(170,
3)}}Object(e.a)(Sa,"PivotTableColumnGrandTotalShownEvent",vb,[]);class yb extends A{constructor(){super()}get eventId(){return 98}Yb(){this.Ob(132)}}Object(e.a)(yb,"PivotTableCreatedEvent",A,[]);class Ma extends vb{constructor(){super(177,10)}}Object(e.a)(Ma,"PivotTableDisplayErrorStringToggledEvent",vb,[]);class Bb extends vb{constructor(){super(178,11)}}Object(e.a)(Bb,"PivotTableDisplayNullStringToggledEvent",vb,[]);class Nb extends vb{constructor(){super(179,12)}}Object(e.a)(Nb,"PivotTableErrorStringChangedEvent",
vb,[]);class Ia extends vb{constructor(){super(174,7)}}Object(e.a)(Ia,"PivotTableExpandCollapseButtonsShownEvent",vb,[]);class jb extends vb{constructor(){super(187,20)}}Object(e.a)(jb,"PivotTableIndentChangedEvent",vb,[]);class Ob extends vb{constructor(){super(176,9)}}Object(e.a)(Ob,"PivotTableItemsWithNoDataOnColumnsShownEvent",vb,[]);class Jb extends vb{constructor(){super(175,8)}}Object(e.a)(Jb,"PivotTableItemsWithNoDataOnRowsShownEvent",vb,[]);class Kb extends vb{constructor(){super(186,19)}}
Object(e.a)(Kb,"PivotTableLayoutTypeSetEvent",vb,[]);class Qa extends vb{constructor(){super(180,13)}}Object(e.a)(Qa,"PivotTableNullStringChangedEvent",vb,[]);class ha extends A{constructor(){super()}get eventId(){return 149}Yb(){this.Ob(219)}}Object(e.a)(ha,"PivotTablePivotLocationChangedEvent",A,[]);class qa extends A{constructor(){super()}get eventId(){return 102}Yb(){this.Ob(145)}}Object(e.a)(qa,"PivotTablePivotedEvent",A,[]);class pb extends vb{constructor(){super(182,15)}}Object(e.a)(pb,"PivotTableRefreshDataOnLoadToggledEvent",
vb,[]);class bb extends A{constructor(){super()}get eventId(){return 104}Yb(){this.Ob(50)}eg(){this.ld(N=>!!N.pivotTableId&&!!N.pivotTableName)}}Object(e.a)(bb,"PivotTableRefreshedEvent",A,[]);class eb extends vb{constructor(){super(168,1)}}Object(e.a)(eb,"PivotTableRenamedEvent",vb,[]);class Fa extends vb{constructor(){super(169,2)}}Object(e.a)(Fa,"PivotTableRowGrandTotalShownEvent",vb,[]);class tb extends vb{constructor(){super(181,14)}}Object(e.a)(tb,"PivotTableSaveSourceDataWithFileToggledEvent",
vb,[]);var dc=a(607);class jc extends A{constructor(){super()}get eventId(){return 155}Yb(){this.Ob(131)}eg(){this.ld(N=>{N=Object(O.a)(dc.a,N);return!!N&&!!N.uKa()&&!!N.hierarchyName})}}Object(e.a)(jc,"PivotTableSortedEvent",A,[]);class fb extends vb{constructor(){super(185,18)}}Object(e.a)(fb,"PivotTableSubTotalsVisibilitySettingSetEvent",vb,[]);class ec extends A{constructor(){super()}get eventId(){return 206}Yb(){this.Ob(560)}}Object(e.a)(ec,"PivotValueFieldSettingAppliedEvent",A,[]);class lb extends A{constructor(){super()}get eventId(){return 161}Yb(){this.Ob(243)}}
Object(e.a)(lb,"PrintAreaClearedEvent",A,[]);class ac extends A{constructor(){super()}get eventId(){return 159}Yb(){this.Ob(241)}eg(){this.ld(N=>!N.addToPrintArea)}}Object(e.a)(ac,"PrintAreaSetEvent",A,[]);class Gb extends A{constructor(){super()}get eventId(){return 57}Yb(){this.Ob(517)}}Object(e.a)(Gb,"RangeAutoFilterClearedEvent",A,[]);class wb extends A{constructor(N,La){super();this.qfa=N;this.a0d=La}get eventId(){return this.qfa}Yb(){this.Ob(11)}eg(){this.ld(N=>16===N.dZ().ValidMembers);this.ld(N=>
N.dZ().Font.ValidMembers===this.a0d)}}Object(e.a)(wb,"RangeFontFormattedEventBase",A,[]);class qc extends wb{constructor(){super(3,4)}}Object(e.a)(qc,"RangeBoldedEvent",wb,[]);class Ya extends A{constructor(){super()}get eventId(){return 2}Yb(){this.Ob(11)}eg(){this.ld(N=>128===N.dZ().ValidMembers)}}Object(e.a)(Ya,"RangeBorderedEvent",A,[]);class xb{}xb.O$a="Table";xb.tpc="Sheet";Object(e.a)(xb,"MacroRecorderEventConstants",null,[]);class wc extends A{constructor(){super()}get eventId(){return 113}Yb(){this.Ob(208)}eg(){this.ld(N=>
N.getParameters().FilterType===xb.tpc)}}Object(e.a)(wc,"RangeCheckedItemsFilteredEvent",A,[]);class Oc extends A{constructor(){super()}get eventId(){return 109}Yb(){this.Ob(105)}}Object(e.a)(Oc,"RangeConditionalFormattingCreatedEvent",A,[]);class Cb extends A{constructor(){super()}get eventId(){return 124}Yb(){this.Ob(221)}}Object(e.a)(Cb,"RangeConditionalFormattingRuleDeletedEvent",A,[]);class Ib extends A{constructor(){super()}get eventId(){return 29}Yb(){this.Ob(508)}eg(){this.ld(N=>3===N.ot()||
1===N.ot()||4===N.ot())}}Object(e.a)(Ib,"RangeContentClearedEvent",A,[]);class fc extends A{constructor(){super()}get eventId(){return 40}Yb(){this.Ob(104)}}Object(e.a)(fc,"RangeCopiedCutCellsInsertedEvent",A,[]);class vc extends A{constructor(){super()}get eventId(){return 114}Yb(){this.Ob(209)}eg(){this.ld(N=>N.getParameters().FilterType===xb.tpc)}}Object(e.a)(vc,"RangeCustomFilteredEvent",A,[]);class Cc extends A{constructor(){super()}get eventId(){return 106}Yb(){this.Ob(121)}}Object(e.a)(Cc,
"RangeDataValidationChangedEvent",A,[]);class fd extends wb{constructor(){super(4,64)}}Object(e.a)(fd,"RangeDoubleUnderlinedEvent",wb,[]);class od extends A{constructor(){super()}get eventId(){return 69}Yb(){this.Ob(190)}}Object(e.a)(od,"RangeDuplicatesRemovedEvent",A,[]);class Ub extends A{constructor(){super()}get eventId(){return 1}Yb(){this.Ob(527);this.Ob(12)}}Object(e.a)(Ub,"RangeEditedEvent",A,[]);class Fc extends A{constructor(){super()}get eventId(){return 164}Yb(){this.Ob(255)}eg(){this.ld(N=>
4===N.actionType)}}Object(e.a)(Fc,"RangeExternalLinksBrokeAllLinksEvent",A,[]);class $b extends A{constructor(){super()}get eventId(){return 119}Yb(){this.Ob(255)}eg(){this.ld(N=>3===N.actionType)}}Object(e.a)($b,"RangeExternalLinksBrokeLinkEvent",A,[]);class zc extends A{constructor(){super()}get eventId(){return 205}Yb(){this.Ob(256)}ywa(){this.Ime("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")}}Object(e.a)(zc,"RangeExternalLinksChangeSourceEvent",A,[]);class Wc extends A{constructor(){super()}get eventId(){return 163}Yb(){this.Ob(553)}eg(){this.ld(N=>
1===N.actionType)}}Object(e.a)(Wc,"RangeExternalLinksRefreshedAllEvent",A,[]);class yc extends A{constructor(){super()}get eventId(){return 77}Yb(){this.Ob(553)}eg(){this.ld(N=>0===N.actionType)}}Object(e.a)(yc,"RangeExternalLinksRefreshedEvent",A,[]);class pd extends A{constructor(){super()}get eventId(){return 165}Yb(){this.Ob(224)}}Object(e.a)(pd,"RangeExternalLinksSetAutoRefreshEvent",A,[]);class xd extends A{constructor(){super()}get eventId(){return 5}Yb(){this.Ob(11)}eg(){this.ld(N=>64===N.dZ().ValidMembers)}}
Object(e.a)(xd,"RangeFillColoredEvent",A,[]);class Vb extends A{constructor(){super()}get eventId(){return 59}Yb(){this.Ob(155)}}Object(e.a)(Vb,"RangeFilledEvent",A,[]);class Uc extends A{constructor(){super()}get eventId(){return 115}Yb(){this.Ob(176)}eg(){this.ld(N=>N.QU().AutoFilterType===xb.tpc&&!!N.QU().CriteriaType)}}Object(e.a)(Uc,"RangeFilterAppliedEvent",A,[]);class ud extends A{constructor(){super()}get eventId(){return 58}Yb(){this.Ob(176)}eg(){this.ld(N=>N.QU().AutoFilterType===xb.tpc&&
!N.QU().CriteriaType)}}Object(e.a)(ud,"RangeFilterClearedEvent",A,[]);class Vc extends A{constructor(){super()}get eventId(){return 41}Yb(){this.Ob(518)}}Object(e.a)(Vc,"RangeFilterReappliedEvent",A,[]);class yd extends A{constructor(){super()}get eventId(){return 86}Yb(){this.Ob(150)}}Object(e.a)(yd,"RangeFlashFilledEvent",A,[]);class Sd extends wb{constructor(){super(6,32)}}Object(e.a)(Sd,"RangeFontColoredEvent",wb,[]);class Wd extends wb{constructor(){super(7,8)}}Object(e.a)(Wd,"RangeFontItalicizedEvent",
wb,[]);class Hd extends wb{constructor(){super(8,1)}}Object(e.a)(Hd,"RangeFontNamedEvent",wb,[]);class le extends wb{constructor(){super(9,2)}}Object(e.a)(le,"RangeFontSizedEvent",wb,[]);class Le extends A{constructor(){super()}get eventId(){return 74}Yb(){this.Ob(215)}}Object(e.a)(Le,"RangeFormattedAsTableEvent",A,[]);class Md extends A{constructor(){super()}get eventId(){return 97}Yb(){this.Ob(188)}}Object(e.a)(Md,"RangeGroupedOrUngroupedEvent",A,[]);class ke extends A{constructor(){super()}get eventId(){return 60}Yb(){this.Ob(11)}eg(){this.ld(N=>
2===N.dZ().ValidMembers)}}Object(e.a)(ke,"RangeHorizontallyAlignedEvent",A,[]);class ve extends A{constructor(){super()}get eventId(){return 43}Yb(){this.Ob(526)}}Object(e.a)(ve,"RangeHyperlinkAppliedEvent",A,[]);class ge extends A{constructor(){super()}get eventId(){return 63}Yb(){this.Ob(11)}eg(){this.ld(N=>256===N.dZ().ValidMembers)}}Object(e.a)(ge,"RangeIndentChangedEvent",A,[]);class we extends A{constructor(){super()}get eventId(){return 53}Yb(){this.Ob(156)}eg(){this.ld(N=>2===N.ot()||5===
N.ot()||6===N.ot()||7===N.ot())}}Object(e.a)(we,"RangeMergedEvent",A,[]);class De extends A{constructor(){super()}get eventId(){return 107}Yb(){this.Ob(216)}}Object(e.a)(De,"RangeNamedCellStyleAppliedEvent",A,[]);class ib extends A{constructor(){super()}get eventId(){return 12}Yb(){this.Ob(11)}eg(){this.ld(N=>32===N.dZ().ValidMembers)}}Object(e.a)(ib,"RangeNumberFormattedEvent",A,[]);var Yb=a(958);class pc extends A{constructor(){super()}get eventId(){return 108}Yb(){this.Ob(141)}eg(){this.ld(N=>
Object(Q.a)(Yb.a,N))}}Object(e.a)(pc,"RangeSortedEvent",A,[]);class Jc extends wb{constructor(){super(10,128)}}Object(e.a)(Jc,"RangeStrikedThroughEvent",wb,[]);class Xc extends wb{constructor(){super(11,16)}}Object(e.a)(Xc,"RangeUnderlinedEvent",wb,[]);class M extends A{constructor(){super()}get eventId(){return 61}Yb(){this.Ob(11)}eg(){this.ld(N=>1===N.dZ().ValidMembers)}}Object(e.a)(M,"RangeVerticallyAlignedEvent",A,[]);class $a extends A{constructor(){super()}get eventId(){return 62}Yb(){this.Ob(11)}eg(){this.ld(N=>
8===N.dZ().ValidMembers)}}Object(e.a)($a,"RangeWrapTextToggledEvent",A,[]);class ob extends A{constructor(){super()}get eventId(){return 103}Yb(){this.Ob(51)}}Object(e.a)(ob,"RefreshedAllEvent",A,[]);class Tb extends A{constructor(){super()}get eventId(){return 47}Yb(){this.Ob(148)}}Object(e.a)(Tb,"ReplaceAllEvent",A,[]);class Dc extends A{constructor(){super()}get eventId(){return 91}Yb(){this.Ob(532)}eg(){this.ld(N=>95!==N.getShapeType()&&96!==N.getShapeType()&&97!==N.getShapeType()&&98!==N.getShapeType()&&
100!==N.getShapeType()&&102!==N.getShapeType()&&103!==N.getShapeType())}}Object(e.a)(Dc,"ShapeInsertedEvent",A,[]);class ad extends A{constructor(){super()}get eventId(){return 92}Yb(){this.Ob(531)}}Object(e.a)(ad,"ShapeStyleSetEvent",A,[]);var ld=a(813);class md extends A{constructor(N,La){super();this.qfa=N;this.a0d=La}get eventId(){return this.qfa}Yb(){this.Ob(581)}eg(){this.ld(N=>Object(Q.a)(ld.a,N)&&4===N.getShapeTextFormat().ValidMembers);this.ld(N=>Object(Q.a)(ld.a,N)&&N.getShapeTextFormat().Font.ValidMembers===
this.a0d)}}Object(e.a)(md,"ShapeTextFontFormattedEventBase",A,[]);class Wb extends md{constructor(){super(193,4)}}Object(e.a)(Wb,"ShapeTextBoldedEvent",md,[]);var Nc=a(960);class gd extends A{constructor(){super()}get eventId(){return 191}Yb(){this.Ob(581)}eg(){this.ld(N=>Object(Q.a)(Nc.a,N))}}Object(e.a)(gd,"ShapeTextChangedEvent",A,[]);class Gd extends md{constructor(){super(196,32)}}Object(e.a)(Gd,"ShapeTextFontColorChangedEvent",md,[]);class Zd extends md{constructor(){super(197,1)}}Object(e.a)(Zd,
"ShapeTextFontNameChangedEvent",md,[]);class xe extends md{constructor(){super(198,2)}}Object(e.a)(xe,"ShapeTextFontSizeChangedEvent",md,[]);class Re extends A{constructor(){super()}get eventId(){return 199}Yb(){this.Ob(581)}eg(){this.ld(N=>Object(Q.a)(ld.a,N)&&2===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(Re,"ShapeTextHorizontallyAlignedEvent",A,[]);class Ue extends md{constructor(){super(194,8)}}Object(e.a)(Ue,"ShapeTextItalicizedEvent",md,[]);class jf extends md{constructor(){super(195,
16)}}Object(e.a)(jf,"ShapeTextUnderlinedEvent",md,[]);class Bf extends A{constructor(){super()}get eventId(){return 200}Yb(){this.Ob(581)}eg(){this.ld(N=>Object(Q.a)(ld.a,N)&&1===N.getShapeTextFormat().ValidMembers)}}Object(e.a)(Bf,"ShapeTextVerticallyAlignedEvent",A,[]);class Ae extends A{constructor(){super()}get eventId(){return 13}Yb(){this.Ob(138)}}Object(e.a)(Ae,"SheetAddedEvent",A,[]);var Qe=a(8);class Je extends A{constructor(){super()}get eventId(){return 142}Yb(){this.Ob(237)}eg(){this.ld(N=>
!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==Qe.a.Gz)||!N.DeltaColumn&&0>N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==Qe.a.Aw)})}}Object(e.a)(Je,"SheetCellsDeletedEvent",A,[]);class se extends A{constructor(){super()}get eventId(){return 143}Yb(){this.Ob(237)}eg(){this.ld(N=>
!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>{N=N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<N.DeltaColumn&&!N.DeltaRow&&(!!N.InsertDeleteRange.FirstRow||N.InsertDeleteRange.LastRow!==Qe.a.Gz)||!N.DeltaColumn&&0<N.DeltaRow&&(!!N.InsertDeleteRange.FirstColumn||N.InsertDeleteRange.LastColumn!==Qe.a.Aw)})}}Object(e.a)(se,"SheetCellsInsertedEvent",A,[]);class cb extends A{constructor(){super()}get eventId(){return 139}Yb(){this.Ob(237)}eg(){this.ld(N=>
!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ld(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===Qe.a.Gz)}}Object(e.a)(cb,"SheetColumnDeletedEvent",
A,[]);class Rb extends A{constructor(){super()}get eventId(){return 138}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow);this.ld(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
Qe.a.Gz)}}Object(e.a)(Rb,"SheetColumnInsertedEvent",A,[]);class uc extends A{constructor(){super()}get eventId(){return 14}Yb(){this.Ob(137)}}Object(e.a)(uc,"SheetDeletedEvent",A,[]);class Sc extends A{constructor(){super()}get eventId(){return 137}Yb(){this.Ob(185)}}Object(e.a)(Sc,"SheetDirectionChangedEvent",A,[]);class ub extends A{constructor(){super()}get eventId(){return 54}Yb(){this.Ob(139)}}Object(e.a)(ub,"SheetDuplicatedEvent",A,[]);class Zb extends A{constructor(){super()}get eventId(){return 15}Yb(){this.Ob(207)}}
Object(e.a)(Zb,"SheetNameEditedEvent",A,[]);class Ec extends A{constructor(){super()}get eventId(){return 90}Yb(){this.Ob(151)}}Object(e.a)(Ec,"SheetPaneFrozenEvent",A,[]);class ed extends A{constructor(){super()}get eventId(){return 120}Yb(){this.Ob(226)}}Object(e.a)(ed,"SheetPrintSettingsSavedEvent",A,[]);var Kd=a(856);class fe extends A{constructor(){super()}get eventId(){return 215}Yb(){this.Ob(507)}ywa(){this.Ime("Microsoft.Office.Excel.SheetProtectionMacroRecording")}eg(){this.ld(N=>Object.getType(N)===
Kd.a)}}Object(e.a)(fe,"SheetProtectionPausedResumedEvent",A,[]);class be extends A{constructor(){super()}get eventId(){return 64}Yb(){this.Ob(557)}}Object(e.a)(be,"SheetReorderedEvent",A,[]);class me extends A{constructor(){super()}get eventId(){return 141}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);
this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ld(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Qe.a.Aw)}}Object(e.a)(me,"SheetRowDeletedEvent",A,[]);class re extends A{constructor(){super()}get eventId(){return 140}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>!N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);
this.ld(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn);this.ld(N=>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===Qe.a.Aw)}}Object(e.a)(re,"SheetRowInsertedEvent",A,[]);class Xe extends A{constructor(){super()}get eventId(){return 39}Yb(){this.Ob(135)}}Object(e.a)(Xe,"SheetRowsColumnsAutoFitEvent",A,[]);class We extends A{constructor(){super()}get eventId(){return 36}Yb(){this.Ob(136)}}
Object(e.a)(We,"SheetRowsColumnsResizedEvent",A,[]);class ee extends A{constructor(){super()}get eventId(){return 68}Yb(){this.Ob(183)}}Object(e.a)(ee,"SheetShowGridlinesToggledEvent",A,[]);class xc extends A{constructor(){super()}get eventId(){return 67}Yb(){this.Ob(184)}}Object(e.a)(xc,"SheetShowHeadingsToggledEvent",A,[]);class jd extends A{constructor(){super()}get eventId(){return 89}Yb(){this.Ob(213)}}Object(e.a)(jd,"SheetSpellCheckedEvent",A,[]);class Nd extends A{constructor(){super()}get eventId(){return 70}Yb(){this.Ob(515)}}
Object(e.a)(Nd,"SheetTabColoredEvent",A,[]);class Ld extends A{constructor(){super()}get eventId(){return 71}Yb(){this.Ob(157)}}Object(e.a)(Ld,"SheetVisibilityChangedEvent",A,[]);class Za extends A{constructor(){super()}get eventId(){return 126}Yb(){this.Ob(239)}}Object(e.a)(Za,"SheetsVisibilityChangedEvent",A,[]);class Pa extends A{constructor(){super()}get eventId(){return 188}Yb(){this.Ob(203)}}Object(e.a)(Pa,"SlicerInsertedEvent",A,[]);class Ab extends A{constructor(){super()}get eventId(){return 189}Yb(){this.Ob(173)}eg(){this.ld(N=>
!N.clearFilter)}}Object(e.a)(Ab,"SlicerSelectionAppliedEvent",A,[]);class Aa extends A{constructor(){super()}get eventId(){return 190}Yb(){this.Ob(173)}eg(){this.ld(N=>N.clearFilter)}}Object(e.a)(Aa,"SlicerSelectionClearedEvent",A,[]);class rb extends A{constructor(){super()}get eventId(){return 27}Yb(){this.Ob(208)}eg(){this.ld(N=>N.getParameters().FilterType===xb.O$a)}}Object(e.a)(rb,"TableCheckedItemsFilteredEvent",A,[]);class Lb extends A{constructor(){super()}get eventId(){return 144}Yb(){this.Ob(237)}eg(){this.ld(N=>
!!N.insertDeleteMultiRangeParameters);this.ld(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Lb,"TableColumnDeletedEvent",A,[]);class oc extends A{constructor(){super()}get eventId(){return 145}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);
this.ld(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(oc,"TableColumnInsertedEvent",A,[]);var $c=a(959);class Fd extends A{constructor(){super()}get eventId(){return 121}Yb(){this.Ob(141)}eg(){this.ld(N=>Object(Q.a)($c.a,N))}}Object(e.a)(Fd,"TableColumnSortedEvent",A,[]);class Cd extends A{constructor(){super()}get eventId(){return 105}Yb(){this.Ob(193)}}Object(e.a)(Cd,
"TableConvertedToRangeEvent",A,[]);class $d extends A{constructor(){super()}get eventId(){return 16}Yb(){this.Ob(206)}}Object(e.a)($d,"TableCreatedEvent",A,[]);class he extends A{constructor(){super()}get eventId(){return 30}Yb(){this.Ob(209)}eg(){this.ld(N=>N.getParameters().FilterType===xb.O$a)}}Object(e.a)(he,"TableCustomFilteredEvent",A,[]);class ue extends A{constructor(){super()}get eventId(){return 25}Yb(){this.Ob(187)}eg(){this.ld(N=>1===N.options.OperationType)}}Object(e.a)(ue,"TableCustomSortedEvent",
A,[]);class Me extends A{constructor(){super()}get eventId(){return 28}Yb(){this.Ob(176)}eg(){this.ld(N=>N.QU().AutoFilterType===xb.O$a);this.ld(N=>0===N.QU().CriteriaType)}}Object(e.a)(Me,"TableFilterClearedEvent",A,[]);class ff extends A{constructor(){super()}get eventId(){return 32}Yb(){this.Ob(176)}eg(){this.ld(N=>N.QU().AutoFilterType===xb.O$a);this.ld(N=>{const La=new l.a;La.add(1);La.add(2);La.add(8);La.add(9);La.add(10);La.add(11);La.add(12);La.add(13);La.add(14);La.add(15);La.add(16);La.add(17);
La.add(18);La.add(19);La.add(20);La.add(21);La.add(22);La.add(23);La.add(24);La.add(25);La.add(26);La.add(27);La.add(28);La.add(29);La.add(30);La.add(31);La.add(32);La.add(33);La.add(34);La.add(35);La.add(36);La.add(37);La.add(38);La.add(39);return La.contains(N.QU().CriteriaType)})}}Object(e.a)(ff,"TableItemFilteredEvent",A,[]);class Ve extends A{constructor(){super()}get eventId(){return 101}Yb(){this.Ob(217)}}Object(e.a)(Ve,"TableRenamedEvent",A,[]);class Ze extends A{constructor(){super()}get eventId(){return 73}Yb(){this.Ob(211)}}
Object(e.a)(Ze,"TableResizedEvent",A,[]);class gf extends A{constructor(){super()}get eventId(){return 44}Yb(){this.Ob(514)}}Object(e.a)(gf,"TableRowColumnRearrangedEvent",A,[]);class Nf extends A{constructor(){super()}get eventId(){return 146}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>0>N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}
Object(e.a)(Nf,"TableRowDeletedEvent",A,[]);class Df extends A{constructor(){super()}get eventId(){return 147}Yb(){this.Ob(237)}eg(){this.ld(N=>!!N.insertDeleteMultiRangeParameters);this.ld(N=>N.insertDeleteMultiRangeParameters.IsTableCommand);this.ld(N=>!N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn);this.ld(N=>0<N.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow)}}Object(e.a)(Df,"TableRowInsertedEvent",A,[]);class tg extends A{constructor(){super()}get eventId(){return 26}Yb(){this.Ob(177)}eg(){this.ld(N=>
N.QU().AutoFilterType===xb.O$a)}}Object(e.a)(tg,"TableSortedEvent",A,[]);class Fg extends A{constructor(){super()}get eventId(){return 87}Yb(){this.Ob(212)}}Object(e.a)(Fg,"TableStyleAppliedEvent",A,[]);class Rf extends A{constructor(){super()}get eventId(){return 88}Yb(){this.Ob(196)}}Object(e.a)(Rf,"TableStyleOptionToggledEvent",A,[]);class Ea extends A{constructor(){super()}get eventId(){return 31}Yb(){this.Ob(210)}eg(){this.ld(N=>N.getParameters().FilterType===xb.O$a)}}Object(e.a)(Ea,"TableTop10FilteredEvent",
A,[]);class Fb extends A{constructor(){super()}get eventId(){return 207}Yb(){this.Ob(238)}}Object(e.a)(Fb,"TextToColumnsEvent",A,[]);class Gc extends A{constructor(){super()}get eventId(){return 128}Yb(){this.Ob(559)}}Object(e.a)(Gc,"ValuesSortedEvent",A,[]);class hd extends A{constructor(){super()}get eventId(){return 55}Yb(){this.Ob(197)}}Object(e.a)(hd,"WorkbookCalculationModeSetEvent",A,[]);class Ad extends A{constructor(){super()}get eventId(){return 34}Yb(){this.Ob(181)}eg(){this.ld(N=>!!N.parentCommentId)}}
Object(e.a)(Ad,"WorkbookCommentRepliedEvent",A,[]);class Td extends A{constructor(){super()}get eventId(){return 33}Yb(){this.Ob(181)}eg(){this.ld(N=>!N.parentCommentId)}}Object(e.a)(Td,"WorkbookCommentedEvent",A,[]);class pe extends A{constructor(){super()}get eventId(){return 56}Yb(){this.Ob(128)}}Object(e.a)(pe,"WorkbookRecalculatedEvent",A,[]);class qe extends A{constructor(){super()}get eventId(){return 46}Yb(){this.Ob(171)}}Object(e.a)(qe,"WorkbookRedoEvent",A,[]);class $e extends A{constructor(){super()}get eventId(){return 45}Yb(){this.Ob(170)}}
Object(e.a)($e,"WorkbookUndoEvent",A,[]);class Ie extends A{constructor(){super()}get eventId(){return 116}Yb(){this.Ob(507);this.Ob(576);this.Ob(10)}eg(){this.ld(N=>{if(Object(Q.a)(W,N)&&(N=Object(O.a)(W,N),void 0!==N.source&&null!==N.source&&void 0!==N.eventId&&null!==N.eventId))return t.ULS.sendTraceTag(537155426,0,50,`[RichApiRecorder]: received a valid but unhandled event: source: ${N.source}; eventId: ${N.eventId}.`),!0;t.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");
return!1})}}Object(e.a)(Ie,"DefaultRichApiRequestExecutedEvent",A,[]);class af extends A{constructor(){super()}get eventId(){return 216}Yb(){this.Ob(1022)}}Object(e.a)(af,"TablelAltTextEditedEvent",A,[]);class Ce extends A{constructor(){super()}get eventId(){return 217}Yb(){this.Ob(263)}}Object(e.a)(Ce,"FloatingObjectZOrderChangedEvent",A,[]);var uf=a(961);class mf extends A{constructor(){super()}get eventId(){return 192}Yb(){this.Ob(507)}eg(){this.ld(N=>Object(Q.a)(uf.a,N)?!0:!1)}}Object(e.a)(mf,
"VisualPropertySetEvent",A,[]);class Cf{constructor(N){this.yb=null;this.$=N}get macroRecorderEvents(){this.yb||(this.yb=new l.a,this.yb.add(new Ub),this.yb.add(new Ya),this.yb.add(new qc),this.yb.add(new fd),this.yb.add(new xd),this.yb.add(new Sd),this.yb.add(new Wd),this.yb.add(new Hd),this.yb.add(new le),this.yb.add(new Jc),this.yb.add(new Xc),this.yb.add(new ib),this.yb.add(new Ae),this.yb.add(new uc),this.yb.add(new Zb),this.yb.add(new $d),this.yb.add(new Lb),this.yb.add(new oc),this.yb.add(new Nf),
this.yb.add(new Df),this.yb.add(new Rb),this.yb.add(new cb),this.yb.add(new re),this.yb.add(new me),this.yb.add(new ue),this.yb.add(new tg),this.yb.add(new rb),this.yb.add(new Me),this.yb.add(new Ib),this.yb.add(new he),this.yb.add(new Ea),this.yb.add(new ff),this.yb.add(new Td),this.yb.add(new Ad),this.yb.add(new gc),this.yb.add(new We),this.yb.add(new Je),this.yb.add(new se),this.yb.add(new Xe),this.yb.add(new fc),this.yb.add(new Vc),this.yb.add(new ve),this.yb.add(new Ca),this.yb.add(new gf),this.yb.add(new qe),
this.yb.add(new $e),this.yb.add(new Tb),this.yb.add(new Ra),this.yb.add(new mb),this.yb.add(new we),this.yb.add(new ub),this.yb.add(new hd),this.yb.add(new pe),this.yb.add(new Gb),this.yb.add(new ud),this.yb.add(new Vb),this.yb.add(new ke),this.yb.add(new M),this.yb.add(new $a),this.yb.add(new ge),this.yb.add(new be),this.yb.add(new U),this.yb.add(new K),this.yb.add(new xc),this.yb.add(new ee),this.yb.add(new od),this.yb.add(new Ld),this.yb.add(new Nd),this.yb.add(new Ze),this.yb.add(new Le),this.yb.add(new P),
this.yb.add(new L),this.yb.add(new yc),this.yb.add(new pa),this.yb.add(new ka),this.yb.add(new D),this.yb.add(new na),this.yb.add(new J),this.yb.add(new H),this.yb.add(new G),this.yb.add(new ta),this.yb.add(new yd),this.yb.add(new Fg),this.yb.add(new Rf),this.yb.add(new jd),this.yb.add(new Ec),this.yb.add(new Dc),this.yb.add(new ad),this.yb.add(new Ba),this.yb.add(new ea),this.yb.add(new Y),this.yb.add(new Da),this.yb.add(new Md),this.yb.add(new yb),this.yb.add(new Ua),this.yb.add(new ja),this.yb.add(new Ve),
this.yb.add(new qa),this.yb.add(new ob),this.yb.add(new bb),this.yb.add(new Cd),this.yb.add(new Cc),this.yb.add(new De),this.yb.add(new pc),this.yb.add(new Oc),this.yb.add(new Pb),this.yb.add(new Xb),this.yb.add(new Qb),this.yb.add(new wc),this.yb.add(new vc),this.yb.add(new Uc),this.yb.add(new X),this.yb.add(new ma),this.yb.add(new $b),this.yb.add(new ed),this.yb.add(new Fd),this.yb.add(new Cb),this.yb.add(new Za),this.yb.add(new ia),this.yb.add(new Gc),this.yb.add(new Z),this.yb.add(new I),this.yb.add(new Na),
this.yb.add(new va),this.yb.add(new ra),this.yb.add(new xa),this.yb.add(new ua),this.yb.add(new Sc),this.yb.add(new wa),this.yb.add(new ha),this.yb.add(new hb),this.yb.add(new ca),this.yb.add(new jc),this.yb.add(new nb),this.yb.add(new Ha),this.yb.add(new sb),this.yb.add(new ac),this.yb.add(new F),this.yb.add(new lb),this.yb.add(new sa),this.yb.add(new Wc),this.yb.add(new Fc),this.yb.add(new pd),this.yb.add(new gb),this.yb.add(new ab),this.yb.add(new eb),this.yb.add(new Fa),this.yb.add(new Sa),this.yb.add(new Va),
this.yb.add(new Wa),this.yb.add(new Oa),this.yb.add(new Ia),this.yb.add(new Jb),this.yb.add(new Ob),this.yb.add(new Ma),this.yb.add(new Bb),this.yb.add(new Nb),this.yb.add(new Qa),this.yb.add(new tb),this.yb.add(new pb),this.yb.add(new oa),this.yb.add(new db),this.yb.add(new fb),this.yb.add(new Kb),this.yb.add(new jb),this.yb.add(new Pa),this.yb.add(new Ab),this.yb.add(new Aa),this.yb.add(new gd),this.yb.add(new Wb),this.yb.add(new Ue),this.yb.add(new jf),this.yb.add(new Gd),this.yb.add(new Zd),this.yb.add(new xe),
this.yb.add(new Re),this.yb.add(new Bf),this.yb.add(new zc),this.yb.add(new ec),this.yb.add(new Fb),this.yb.add(new fe),this.yb.add(new af),this.yb.add(new Ce),this.yb.add(new mf),z.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.x$i());return this.yb}N0e(N,La){let Eb=this.O0e(N,this.macroRecorderEvents,La);Eb||(Eb=this.O0e(N,Cf.R0h(),La),!Eb&&this.hgf(N,Cf.UHe,La)&&(Eb=Cf.UHe));return Eb}O0e(N,La,Eb){const kc=new l.a;for(let Mc of La)this.hgf(N,Mc,Eb)&&kc.add(Mc);
return 1===kc.count?kc.na(0):1<kc.count?Cf.yJh(kc):null}hgf(N,La,Eb){const kc=Cf.wVi(N,La);return Eb?kc&&Cf.ZVj(N,La):kc}x$i(){const N=new l.a;for(let La of this.yb){let Eb=!1;for(let kc of La.featureGates)if(!z.EwaSettings.ma(kc)){N.add(La);Eb=!0;break}if(!Eb)for(let kc of La.dTe)if(!z.EwaSettings.getBooleanFeatureGate(kc,!1)){N.add(La);break}}for(let La of N)this.yb.remove(La)}static R0h(){Cf.$Cb||(Cf.$Cb=new l.a,Cf.$Cb.add(new da),Cf.$Cb.add(new ba));return Cf.$Cb}static wVi(N,La){return La.operations.contains(N.operation)}static ZVj(N,
La){La=La.mDc;if(!La.count)return!0;let Eb=!0;for(let kc of La)if(!kc(N.payload)){Eb=!1;break}return Eb}static yJh(N){let La=N.na(0);for(let Eb of N)Eb.mDc.count>La.mDc.count&&(La=Eb);return La}}Cf.$Cb=null;Cf.UHe=new Ie;Object(e.a)(Cf,"MacroRecorderEventList",null,[]);class hg extends k.a{constructor(N){super();this.$=N;this.Eb()}create(){this.pb(this.$.da.za(297)||new B(this.$,new Cf(this.$),new u))}static ka(N){N.da.Ga(298,new hg(N))}}Object(e.a)(hg,"MacroRecorderEventHandlerFactory",k.a,[]);var Ta=
a(1143),zb=a(1236),cc=a(7);a(561);class Bc{constructor(){this.Ang=new l.a}get E1b(){return this.Ang}LTh(N){t.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",N);const La=new l.a;for(let Eb of this.E1b)for(let kc of Eb.lEb)kc.id===N&&La.add(kc);return La}ume(N){this.E1b.add(N)}s$i(N){for(let La of this.E1b)if(La.rqe===N.rqe){this.E1b.remove(La);break}}static Egh(N,La,Eb=null){N=Bc.aMh(N);0<N.length&&(Bc.Hwc(N,!1),Eb&&Eb(La,N))}static aMh(N){const La=[];if(N&&N.lEb&&0<N.lEb.count)for(let Eb of N.lEb)if(Eb.controls&&
0<Eb.controls.count)for(let kc of Eb.controls)if(kc.menuItems&&0<kc.menuItems.count)for(let Mc of kc.menuItems)Array.add(La,Mc.id);return La}static Hwc(N,La){if(N.length){var Eb=[];for(const kc of N)Eb.push(appChrome.actions.updateControlEnabledDisabledState(kc,La));appChrome.api.dispatch(Eb)}}}Object(e.a)(Bc,"ContextMenuExtensibilityCache",null,[820,821]);var Zc=a(1456),nd=a(84),sd=a(4),h=a(864),Hb=a(811);class hc{XYa(N,La=null){if(N=Hb.a.J3a(N)){appChrome.addInApi.dispatchActionsToInstallAddIn(N,
La);for(const Eb of N.tabs)if(Eb.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(N,()=>{});break}}}YJd(N){(N=Hb.a.J3a(N))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(N)}static Mgh(N,La,Eb=null){N=hc.IWh(N);0<N.length&&(hc.Hwc(N,!1),Eb&&Eb(La,N))}static IWh(N){const La=[];if(N&&(N=N.JV,N.Vs&&0<N.Vs.count))for(let Eb of N.Vs)if(Eb.groups&&0<Eb.groups.length)for(const kc of Eb.groups)if(kc.controls&&0<kc.controls.length)for(const Mc of kc.controls)Array.add(La,Mc.id);return La}static Hwc(N){if(N.length){var La=
[];for(const Eb of N)La.push(appChrome.actions.updateControlEnabledDisabledState(Eb,!0));appChrome.api.dispatch(La)}}}Object(e.a)(hc,"OneLineRibbonExtensibilityManager",null,[841]);var Hc=a(936);class id{constructor(){this.y3d=this.CEc=null}get OTc(){return this.CEc||(this.CEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set OTc(N){this.CEc=N}get AOg(){return this.y3d||(this.y3d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromAssetIdRuntimeId(N,
La){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(N,La)}Jid(N,La,Eb,kc,Mc,kd=null,rd=null){t.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",N);if((N=La.Oia(Mc.ownerAddinInfo.storeType,Mc.ownerAddinInfo.solutionId))&&N.CB&&!N.CB.getIsUpgrading())if(La=null,0<N.CB.getNotificationParams().length&&(La=this.Qve(N.CB.getNotificationParams()[0]))&&2147758681===La.errorCode&&(N.isUpgraded=!0),2!==N.CB.getStatus()&&(1!==N.CB.getStatus()||La&&2147758681===La.errorCode))La&&
this.i4f(N,La,rd);else try{Eb.setOwnerAddinEToken(N.CB.getEToken()),Mc.action(Eb,kc.Dca),kd&&kd()}catch(zd){t.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",sd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?zd.stack:zd.message)),Hc.a.QSd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}i4f(N,La,Eb=null){const kc=N.CB;if(1===kc.getNotificationParams().length||La.eec){const Mc=
La.pha,kd=La.lia;La.pha=()=>{kc.removeFirstNotification();if(0<kc.getNotificationParams().length){const rd=this.Qve(kc.getNotificationParams()[0]);this.i4f(N,rd)}2147758681===La.errorCode&&(hc.Mgh(N.No,kc,Object(nd.a)(this,this.Gaf,"initUpgradeStateDetectTask")),Bc.Egh(N.drb,kc,Object(nd.a)(this,this.Gaf,"initUpgradeStateDetectTask")));Mc&&Mc()};La.lia=()=>{kd&&kd();Eb&&Eb()};Hc.a.SSd(La)}}Gaf(N,La){let Eb=null;Eb=()=>{N.getIsUpgrading()?window.setTimeout(Eb,1E3):N.getUpgradingFailed()?hc.Hwc(La,
!0):sd.AFrameworkApplication.ta.updateCommandUI()};window.setTimeout(Eb,1E3)}Qve(N){const La=new h.a;La.aMa=N.infoType;La.id=N.id;La.title=N.title;La.description=N.description;La.buttonText=N.buttonTxt;La.pha=N.buttonCallback;La.eec=N.highPriority;La.lia=N.dismissCallback;La.errorCode=N.errorCode;La.G$e=N.iframeNotificationUrl;return La}}Object(e.a)(id,"AddinCommandsActionHandler",null,[826]);var Ed=a(83),Id=a(155),Xd=a(694),ie=a(5),He=a(736),te=a(695);class xf{constructor(N,La){this.Ua=N;this.m3g=
La}HGh(N){if(void 0!==N&&null!==N&&N===ie.a.aDe)N="ContextMenuCell";else return null;const La=this.Ua.Dc();this.ZFh(La,N);return La}ZFh(N,La){La=this.m3g.LTh(La);for(let Eb of La){La=Eb.controls;for(let kc of La)this.MFh(N,kc)}}MFh(N,La){var Eb=La.bU[He.a.id];const kc=La.bU[He.a.YUa],Mc=La.bU[He.a.aVa];let kd="Image16by16",rd=La.bU[He.a.ZUa];te.c(Mc)&&(kd="None");0<La.menuItems.count?(Eb=this.Ua.ew(Eb,Eb,kc,798637440),Eb.uLb(kd,Mc,null),this.FGh(Eb.menu,La),N.buttons.push(Eb)):N.buttons.push(this.Ua.SHa(Eb,
kc,rd,Mc,kd,null,!1))}FGh(N,La){const Eb=this.Ua.Dc();for(let kc of La.menuItems){La=kc.xla[He.a.id];const Mc=kc.xla[He.a.YUa],kd=kc.xla[He.a.aVa];let rd="Image16by16";const zd=kc.xla[He.a.ZUa];te.c(kd)&&(rd="None");La=this.Ua.SHa(La,Mc,zd,kd,rd,null,!1);Eb.buttons.push(La)}N.sc.push(Eb)}}Object(e.a)(xf,"AddInCommandsContextMenuExtensibilityHandler",null,[867]);var Ga=a(859);class Mb{constructor(){this.xi=null;this.visible=!1}}Object(e.a)(Mb,"AddinStatusCommandValues",null,[]);class ic{static F2i(N){const La=
new Mb;La.xi=N.rZa;La.visible=La.xi?!0:!1;return La}static vyc(N,La,Eb,kc,Mc){const kd=document.getElementById(Eb);kd?ic.HAj(N,La,kd,kc,Mc):t.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Eb))}static HAj(N,La,Eb,kc,Mc){Eb?N.rZa===CommonUIStrings.l_ErrorLoadingAddInsTitle?Hc.a.szj(La,Eb,kc,Mc):N.rZa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&Hc.a.MAj(La,Eb):t.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}
Object(e.a)(ic,"AddinCommandsStatusHandler",null,[]);var Pc=a(38),Rc=a(225),vd=a(14);class Yd extends Pc.a{constructor(N,La){super();this.agaveCommandManager=this.statusBarManager=null;this.aAe=()=>{this.fG&&this.fG.Fze()};this.b6e=()=>{this.raiseEvent("LAC")};this.Wc=(Eb,kc)=>{!Eb.fc&&Rc.b(kc)&&this.statusBarManager&&(this.statusBarManager.aG(this),this.statusBarManager=null)};this.fG=La;this.$=N;this.GFj=N.Cb+"OfficeAddinLabel-Medium14";this.$.da.Za(29,Eb=>{this.statusBarManager=Eb;Eb.uJ(this)});
this.$.ea.rk(this.Wc);this.fG.hFg(this.b6e);this.$.da.Za(206,Eb=>{this.agaveCommandManager=Eb;Eb.IGg(this.aAe)})}Cq(N){this.addHandler("LAC",N)}Yq(N){this.removeHandler("LAC",N)}ds(N,La){if("QueryAddinLabel"!==N)return!1;La[Ga.a.LabelText]!==this.fG.rZa&&(N=ic.F2i(this.fG),La[Ga.a.LabelText]=N.xi,La[Ga.a.Visible]=N.visible,window.setTimeout(()=>{this.vyc()},0));return!0}vn(){return!0}vyc(){this.$&&ic.vyc(this.fG,this.$.domElement,this.GFj,vd.a.instance.ga(338),vd.a.instance.ga(339))}dispose(){this.$.ea.Pk(this.Wc);
this.fG.Caj(this.b6e);this.agaveCommandManager&&(this.agaveCommandManager.Obj(this.aAe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.aG(this),this.statusBarManager=null);this.fG=this.$=null;super.dispose()}}Object(e.a)(Yd,"AddinCommandsStatusBarManager",Pc.a,[160,161]);var ne=a(1308),Pd=a(720),je=a(146),ze=a(124),Pe=a(573),Ff=a(137);class Yf{constructor(){this.qZa=null}setErrorMessageForAddin(N,La){this.qZa||(this.qZa={});this.qZa[N]=La}sOh(N){return this.qZa&&N in
this.qZa?this.qZa[N]:null}}Object(e.a)(Yf,"AddinCommandsErrorManager",null,[]);var ya=a(331),za=a(95);class Ac{constructor(){this.Qq=this.ZN=0;this.dWc=null;this.nrc=this.YAc=0;this.Cpa=this.oJc=this.UEc=this.X3b=this.gja=this.H9=null}get Kpe(){this.UEc||(this.UEc=new l.a);return this.UEc}get Dcd(){this.oJc||(this.oJc=new l.a);return this.oJc}get JHa(){this.Cpa||(this.Cpa=new l.a);return this.Cpa}}Object(e.a)(Ac,"AddinCommandsListLoaderContext",null,[]);var Bd=a(815);class ce{}Object(e.a)(ce,"AppsForOfficeEntitlementQueryInfo",
null,[]);var oe=a(41);const Ye=N=>{const La={};La.solutionId=N.solutionId;La.version=N.version;La.storeType=N.storeType;La.storeId=N.storeId;La.assetId=N.assetId;La.assetStoreId=N.assetStoreId;La.targetType=N.targetType;La.requireConsent=N.requireConsent||!1;La.isAddinCommands=!0;La.addinCommandsActionType=0;return La};class yf{constructor(N,La){this.entitlement=N;this.metadata=La}sKj(){const N=Ye(this.entitlement);N.targetType=this.targetType;return N}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==
this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}Object(e.a)(yf,"AddinEntitlementEx",null,[]);var Sf=a(256),vf=a(30);class fg{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}Object(e.a)(fg,"AddinAbstract",null,[]);class pf extends Sys.EventArgs{constructor(){super();
this.No=this.ik=null}}Object(e.a)(pf,"InsertionParamEventArgs",Sys.EventArgs,[]);class pg{constructor(N,La,Eb,kc=null){this.XJb=sd.AFrameworkApplication.fa.Xa("RoamingServiceHandlerWebServiceBase");this.appName=N;this.Nib=La;this.Jib=Eb;this.Rkb=kc}g9b(N){const La=new Sys.StringBuilder(this.XJb);La.append("RoamingServiceHandler.ashx?action=");La.append("getAddinTeachingCalloutSettings");La.append("&");La.append(this.Bgd(N));La.append("&");La.append(sd.AFrameworkApplication.qj);sd.AFrameworkApplication.yd.Jm(La.toString(),
1,null,null,!0,2,Object(nd.a)(this,this.Jja,"getRequestSuccessCallback"),Object(nd.a)(this,this.i4,"getRequestFailureCallback"),null)}V2a(N){var La=new Sys.StringBuilder(this.XJb);La.append("RoamingServiceHandler.ashx?action=");La.append("saveAddinTeachingCalloutSettings");La.append("&");La.append(sd.AFrameworkApplication.qj);La=La.toString();N=oe.c(N);sd.AFrameworkApplication.yd.Jm(La,2,N,null,!0,4,null,Object(nd.a)(this,this.VV,"postRequestFailureCallback"),null)}Jja(N){let La=!1,Eb=null;try{if(0<
N.data.Xd.length){const kc=Object(O.a)(Object,oe.a(N.data.Xd)),Mc=kc?kc[this.appName]:null;Mc&&(Eb=Object(O.a)(Object,oe.a(Mc.toString())))}La=!0}catch(kc){this.i4(null)}La&&this.Nib&&this.Nib(Eb)}i4(N){this.Jib&&this.Jib(N?N.data:null)}VV(N){this.Rkb&&this.Rkb(N?N.data:null)}Bgd(N){const La=new Sys.StringBuilder("requestedsettings=");for(let Eb=0;Eb<N.count;Eb++)La.append(N.na(Eb)),Eb<N.count-1&&La.append(";");return La.toString()}}Object(e.a)(pg,"AddinTeachingUIRoamingRequestHandler",null,[]);class ig extends Sys.EventArgs{constructor(N){super();
this.solutionId=N.solutionId;this.assetId=N.assetId;this.storeType=N.storeType;this.storeId=N.storeId;this.assetStoreId=N.assetStoreId;this.targetType=N.targetType;this.width=N.width;this.height=N.height;this.displayName=N.displayName;this.version=N.version}}Object(e.a)(ig,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Hf=a(342);class Jf{constructor(N){this.tZa=this.ik=null;this.wRa=!1;this.Cpa=this.UQb=this.Ima=this.Xh=this.kX=this.iO=null;this.Ra=N}get appName(){return sd.AFrameworkApplication.fa.Xa("WebAppShortName")}get Nnb(){this.kX||
(this.kX=new pg(this.appName,Object(nd.a)(this,this.Jja,"getRequestSuccessCallback"),Object(nd.a)(this,this.i4,"getRequestFailureCallback"),Object(nd.a)(this,this.VV,"postRequestFailureCallback")));return this.kX}get Xra(){this.UQb||(this.UQb=new l.a);return this.UQb}set Xra(N){this.UQb=N}get JHa(){this.Cpa||(this.Cpa=new l.a);return this.Cpa}set JHa(N){this.Cpa=N}KUc(N,La){window.addEventListener?(this.ik=N,this.tZa=La,window.addEventListener("LaunchAddinTaskpane",Object(nd.a)(this,this.NBd,"onLaunchButtonClickedEventHandler"),
!0),window.addEventListener("DismissCallout",Object(nd.a)(this,this.SAd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(nd.a)(this,this.IAd,"onCloseButtonClickedEventHandler"),!0),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(nd.a)(this,this.zEb,"onCampaignLaunchedHandler"),!0)):t.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}HMj(N,
La,Eb,kc){this.Xh=N;this.Xra=La;this.JHa=Eb;this.Ima=kc;t.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",La?La.count.toString():"null",Eb?Eb.count.toString():"null");0<this.Xra.count||0<this.JHa.count?(N=new l.a,N.add(this.appName),this.Nnb.g9b(N)):this.Ima(new l.a,null)}NBd(){const N=new Sf.ScriptSharpLegacyMap;this.tZa&&this.tZa.tabs&&!this.tZa.tabs[0].isOfficeTab&&N.ia("SDX.FeatureFlags","NonOfficeTab");this.ila(Jf.WU(this.ik),
"ClickOnLaunch",N);sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.ula();this.tZa?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.tZa,()=>{const La=new pf;La.ik=this.ik;this.Ra.raiseEvent(Pd.a.Jtd,La)}):t.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}IAd(){this.ila(Jf.WU(this.ik),"ClickOnClose");sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.ula()}SAd(){this.ila(Jf.WU(this.ik),"ClickOnDismiss");sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.ula()}zEb(N){if(N&&(N=N.detail)&&N.id&&this.Bnd(N.id)){const La=(N.action||"").toLowerCase();if(N.success&&"opened"===La)this.ila(Jf.WU(this.ik),"CampaignLaunched"),t.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.ula(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(nd.a)(this,this.zEb,"onCampaignLaunchedHandler"),!0);else{let Eb;try{Eb=JSON.stringify(N),t.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Eb)}catch(kc){Eb="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,t.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Eb+" Error: "+(kc?kc.toString():""))}}}}Bnd(N){N=vf.a.sl(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}e7(N){if(this.appName){const La={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=N;La[this.appName]=oe.c(Eb);this.Nnb.V2a(La);t.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else t.ULS.sendTraceTag(539530528,220,10,
"Fail to save roaming service since AppName is null")}ula(){if(!this.wRa){const N=window.g_roamingAddinList;N&&(this.e7(N),this.wRa=!0)}}Jja(N){N?this.GSd(N)?(t.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.iO="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Rqb()):(t.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.Ima(this.Xra,null)):(t.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.iO=null,this.Rqb())}i4(N){t.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",N?N.httpStatus:-1);this.Ima(this.Xra,null)}VV(N){t.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Rqb(){const N=this.L6c();0===N.targetType?(N.solutionId?this.XGd(N):this.ila(null,"NoSolutionId"),this.ifg(N),this.Ima(this.Xra,null)):this.Ima(this.Xra,N);t.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",N.addinId)}XGd(N){const La=new ce;
La.callbackFunc=Eb=>{if(Eb.errorCode){if(this.ila(N.solutionId,"FailToGetAppDetails"),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var kc=window.g_roamingAddinList;kc&&this.e7(kc)}}else if(Eb.value)for(kc of Eb.value){var Mc=kc[1];if(Mc===N.solutionId){Eb={};Eb.solutionId=Mc;Eb.assetId=kc[5];Mc=sd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");Eb.storeType=Mc?kc[12]:kc[6];sd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?
Eb.storeId=N.storeId:Eb.storeId=kc[11];Eb.assetStoreId=kc[6];Eb.targetType=kc[3];Eb.width=kc[7];Eb.height=kc[8];Eb.displayName=kc[0];Eb.version=kc[4];t.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",N.solutionId);kc=new ig(Eb);this.Ra.raiseEvent(Pd.a.XSd,kc);break}}};La.storeType=OSF.StoreTypeEnum.PrivateCatalog;La.fromInsertDialog=!1;La.refresh=!1;this.Xh.queryEntitlementDetails(La)}GSd(N){if("LastTeachingUIShowTime"in N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),
N<sd.AFrameworkApplication.fa.UM("AddinShowTeachingUIIntervalInMS",864E5))return t.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else t.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}L6c(){let N=new ya.a(new fg,0),La=new ya.a(new fg,0),Eb=0,kc=0,Mc=0;var kd=new l.a;for(var rd of this.Xra)kd.add(rd);for(let zd of this.JHa)kd.add(zd);for(let zd of kd)if(!("excatalog"!==zd.storeType||te.c(zd.installTimeInMS)||!zd.installTimeInMS||
zd.installTimeInMS<=sd.AFrameworkApplication.fa.UM("DateTimeInMSForNewAddin",16409952E5))){kd=Jf.evb(zd);if(this.iO&&(rd=this.iO.split(","),0<rd.length&&Array.contains(rd,kd))){Mc++;t.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}kd.startsWith("private_")?(N=Jf.y0e(zd,N),kc++):(La=Jf.y0e(zd,La),Eb++)}t.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",kc,Eb,Mc);return 0<La.value?
La.key:0<N.value?N.key:Object.assign(new fg,{addinId:null,targetType:-1,solutionId:null,storeId:null})}ila(N,La,Eb=null){N={["AppTeachingUICalloutAction"]:La,["SDX.Id"]:N,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Eb)for(let kc of Eb.keys)N[kc]=Eb.na(kc);je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}))}ifg(N){N&&(N=this.iO?this.iO+","+N.addinId:N.addinId,sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=N:this.e7(N))}static WU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static y0e(N,La){return La.value<N.installTimeInMS?new ya.a(Object.assign(new fg,{addinId:Jf.evb(N),targetType:N.targetType,storeId:N.storeId,solutionId:N.solutionId}),N.installTimeInMS):La}static evb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(Jf,
"PrivateCatalogTeachingCalloutHandler2",null,[]);var bg=a(80);const lh=()=>{const N=bg.a.nZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"4"===N},ug=()=>bg.a.nZ(window.location.href.toLowerCase(),"wdtpl"),gh=()=>{const N=bg.a.nZ(window.location.href.toLowerCase(),"wdomexsrctype");return!!N&&"1"===N},hh=N=>{let La=null;switch(N){case 0:La="omex";break;case 1:La="spcatalog";break;case 2:La="spapp";break;case 3:La="filesystem";break;case 4:La="exchange";break;case 6:La="registry";break;
case 7:La="inmemory";break;case 8:La="uploadfiledevcatalog";break;case 9:La="hardcodedpreinstall";break;case 10:La="excatalog";break;case 16:La="wopicatalog"}return La},ah=N=>{let La=-1;switch(N.toLowerCase()){case "omex":La=0;break;case "spcatalog":La=1;break;case "spapp":La=2;break;case "filesystem":La=3;break;case "exchange":La=4;break;case "registry":La=6;break;case "inmemory":La=7;break;case "uploadfiledevcatalog":La=8;break;case "hardcodedpreinstall":La=9;break;case "excatalog":La=10;break;
case "wopicatalog":La=16}return La};var Rg=a(683);class vg{constructor(N){this.Or=null;this.yA=N}get_current(){if(!this.Or)throw Error.argumentOutOfRange();return this.Or.data}moveNext(){if(!this.Or)return this.Or=this.yA,!!this.yA;if(!this.Or.next)return!1;this.Or=this.Or.next;return!0}Plc(){if(!this.Or)return this.Or=this.yA,!!this.yA;if(!this.Or.previous)return!1;this.Or=this.Or.previous;return!0}reset(){this.Or=this.yA}}Object(e.a)(vg,"ListEnumerator",null,[0]);class Bg{constructor(N,La,Eb){this.next=
Eb;this.previous=La;this.data=N}}Object(e.a)(Bg,"ListNode",null,[]);class ih{constructor(){this.GA=this.sq=null;this._count=0}add(N){this.sq?this.GA=this.GA.next=new Bg(N,this.GA,null):this.sq=this.GA=new Bg(N,null,null);this._count=this.count+1}insert(N,La){if(N>this.count||0>N)throw Error.argumentOutOfRange("pos");if(N===this.count)this.add(La);else{for(var Eb=this.sq;0!==N--;)Eb=Eb.next;N=new Bg(La,Eb.previous,Eb);N.previous?N.previous.next=N:this.sq=N;N.next?N.next.previous=N:this.GA=N;this._count=
this.count+1}}remove(N){let La=this.sq;for(;La&&La.data!==N;)La=La.next;if(!La)return!1;La.previous?La.previous.next=La.next:this.sq=La.next;La.next?La.next.previous=La.previous:this.GA=La.previous;this._count=this.count-1;return!0}clear(){let N=this.sq,La;for(this.GA=this.sq=null;N;)La=N.next,N.previous=null,N.next=null,N=La;this._count=0}indexOf(N){let La=this.sq,Eb=0;for(;La&&La.data!==N;)La=La.next,Eb++;return La?Eb:-1}na(N){return this.at(N).data}get count(){return this._count}getEnumerator(){return new vg(this.sq)}[Symbol.iterator](){return Object(Rg.a)(this.getEnumerator())}$ac(N){N=
this.at(N);return new vg(N)}toArray(){const N=Array(this.count);let La=0;for(let Eb of this)N[La]=Eb,La++;return N}at(N){let La=this.sq,Eb=0;for(;Eb!==N;){if(!La)throw Error.argumentOutOfRange("pos");La=La.next;Eb++}return La}}Object(e.a)(ih,"List",null,[1]);class $g extends Sys.EventArgs{constructor(N){super();this.properties=N}}Object(e.a)($g,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class Gg{constructor(){this.addinId=null;this.targetType=0;this.storeId=this.solutionId=null}}
Object(e.a)(Gg,"MiniAddinInfo",null,[]);class wg{constructor(N,La,Eb){this.Ra=new za.a;this.context=new Ac;this.oSc=this.a8f=this.yUd=this.fGa=this.iO=this.kX=null;this.contextActivationMgr=N;this.eJg=La;this.gGa=Eb;this.appName=sd.AFrameworkApplication.fa.Xa("WebAppShortName")}get TNb(){this.oSc||(this.oSc=new Jf(this.Ra));return this.oSc}fFg(N){this.Ra.addHandler(Pd.a.Jnb,N)}AIg(N){this.Ra.addHandler(Pd.a.XSd,N)}aOj(N){null!==N&&(this.context.ZN=N[Pd.a.I9],this.context.Qq=N[Pd.a.tP],this.context.YAc=
this.context.nrc=0,N=Pd.a.hGa in N?N[Pd.a.hGa]:0,-1!==this.context.ZN&&0!==this.context.Qq&&(this.context.H9=new ih,this.context.gja=new ih,this.context.X3b=new ih,this.context.dWc=this.eJg.createAddinDataProvider(hh(this.context.ZN),this.contextActivationMgr),this.context.dWc?this.context.dWc.getEntitlementsAsync(this.contextActivationMgr.Dca,!0,N,La=>{this.mOi(La)}):t.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.ZN)))}mOi(N){if(N&&0<N.length){this.context.YAc=
N.length;const Eb=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?ug():null;for(let kc=0;kc<N.length;kc++){const Mc=N[kc];if(sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&gh()&&Mc&&Mc.storeType&&"omex"===Mc.storeType.toLowerCase()&&Mc.assetId&&Eb&&Mc.assetId.toLowerCase()===Eb.toLowerCase()){var La={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:wg.WU(Mc)};je.a.sendTelemetryEvent(Object.assign(new Hf.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj(La)}))}!Mc||1!==Mc.targetType&&-1!==Mc.targetType?this.Umc():(La={},sd.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(La.solutionId=Mc.solutionId,La.version=Mc.version):(La.marketplaceId=Mc.solutionId,La.marketplaceVersion=Mc.version),La.storeType=Mc.storeType,La.storeId=Mc.storeId,La.targetData=Mc,wg.UNb?this.contextActivationMgr.isAddinCommandsExAsync(La,
Object(nd.a)(this,this.INi,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(La,(kd,rd,zd)=>{kd?(rd&&this.context.H9.add(zd.targetData),10===this.context.ZN&&(kd=zd.targetData,rd=kd.targetType,te.c(zd.targetTypeForExp)||(rd=zd.targetTypeForExp,kd.targetType=rd),this.context.gja.add(kd),0===rd&&this.context.X3b.add(kd))):(zd=zd.targetData,t.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(zd.solutionId,
zd.storeType,zd.assetId,null,null,zd.storeId),zd.storeType));this.Umc()}))}}else this.Umc()}Umc(){var N;(N=this.context).nrc=N.nrc+1;this.context.nrc>=this.context.YAc&&(this.gGa.FZf(this.context.ZN,!1),0<this.context.YAc&&10===this.context.ZN&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(N=!1,sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&lh()&&(N=this.Qui()),this.dui(),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&!N?wg.UNb?this.TNb.HMj(this.contextActivationMgr,this.context.Kpe,this.context.JHa,(La,Eb)=>{const kc=new l.a;for(let Mc of La)La=Mc.sKj(),Eb&&Eb.solutionId===Mc.solutionId&&(La.showCallout=!0,this.TNb.ifg(Eb)),kc.add(La);this.Ima(kc)}):this.pIh(this.context.H9):this.nZb(this.context.H9)):this.nZb(this.context.H9))}nZb(N){if(wg.UNb)this.Ima(this.J1g(N));else{var La=new l.a;if(N)for(let Eb of this.context.H9)La.add(Ye(Eb));this.context.H9&&1>this.context.H9.count&&Bd.a.nfb(Pd.a.Knb,"false",this.context.ZN);
N={["ack2"]:La};N[Pd.a.I9]=this.context.ZN;N[Pd.a.tP]=this.context.Qq;this.Ra.raiseEvent(Pd.a.Jnb,new $g(N),this)}}J1g(N){const La=new l.a;if(N)for(let Eb of N)La.add(Ye(Eb));return La}Ima(N){N&&N.count||Bd.a.nfb(Pd.a.Knb,"false",this.context.ZN);N={["ack2"]:N};N[Pd.a.I9]=this.context.ZN;N[Pd.a.tP]=this.context.Qq;this.Ra.raiseEvent(Pd.a.Jnb,new $g(N),this)}e7(N){if(this.appName){const La={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=N;La[this.appName]=oe.c(Eb);this.kX&&
(this.kX.V2a(La),t.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else t.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}pIh(N){(this.fGa=N)?(N=new l.a,N.add(this.appName),this.kX=new pg(this.appName,Object(nd.a)(this,this.Jja,"getRequestSuccessCallback"),Object(nd.a)(this,this.i4,"getRequestFailureCallback"),Object(nd.a)(this,this.VV,"postRequestFailureCallback")),
this.kX.g9b(N)):(N={["ack2"]:new l.a},N[Pd.a.I9]=this.context.ZN,N[Pd.a.tP]=this.context.Qq,this.Ra.raiseEvent(Pd.a.Jnb,new $g(N),this))}Jja(N){N?this.GSd(N)?(t.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.iO="AddinHasShown"in N&&N.AddinHasShown?N.AddinHasShown.toString():null,this.Rqb()):(t.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.nZb(this.fGa)):(t.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.iO=null,this.Rqb())}i4(N){t.ULS.sendTraceTag(539530529,
306,10,"GET data from Roaming Settings Service with status: {0}, fallback",N?N.httpStatus:-1);this.nZb(this.fGa)}VV(N){t.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}Rqb(){const N=this.L6c();if(0===N.targetType){N.solutionId?(this.yUd=N.solutionId,this.a8f=N.storeId,this.XGd()):this.ila("NoSolutionId");if(N.addinId){const La=this.iO?this.iO+","+N.addinId:N.addinId;sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)?window.g_roamingAddinList=La:this.e7(La)}this.Tme(null)}else this.Tme(N.addinId);t.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",N.addinId)}XGd(){const N=new ce;N.callbackFunc=La=>{if(La.errorCode){if(this.ila("FailToGetAppDetails"),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)){var Eb=window.g_roamingAddinList;Eb&&this.e7(Eb)}}else if(La.value)for(Eb of La.value){var kc=Eb[1];if(kc===this.yUd){La={};La.solutionId=
kc;La.assetId=Eb[5];kc=sd.AFrameworkApplication.fa.isChangeGateEnabled("QueryEntitlementDetailsStoreTypeFixEnabled");La.storeType=kc?Eb[12]:Eb[6];sd.AFrameworkApplication.fa.isChangeGateEnabled("StoreIdFixEnabled")?La.storeId=this.a8f:La.storeId=Eb[11];La.assetStoreId=Eb[6];La.targetType=Eb[3];La.width=Eb[7];La.height=Eb[8];La.displayName=Eb[0];La.version=Eb[4];Eb=new ig(La);this.Ra.raiseEvent(Pd.a.XSd,Eb);break}}};N.storeType=OSF.StoreTypeEnum.PrivateCatalog;N.fromInsertDialog=!1;N.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(N)}GSd(N){if("LastTeachingUIShowTime"in
N){if(N=+new Date-+new Date(N.LastTeachingUIShowTime.toString()),N<sd.AFrameworkApplication.fa.UM("AddinShowTeachingUIIntervalInMS",864E5))return t.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",N),!1}else t.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}L6c(){let N=new ya.a(new Gg,0),La=new ya.a(new Gg,0),Eb=0,kc=0,Mc=0;var kd=new ih;if(0<this.context.H9.count)for(var rd of this.context.H9)kd.add(rd);if(0<this.context.X3b.count)for(let zd of this.context.X3b)kd.add(zd);
for(let zd of kd)if(!("excatalog"!==zd.storeType||te.c(zd.installTimeInMS)||!zd.installTimeInMS||zd.installTimeInMS<=sd.AFrameworkApplication.fa.UM("DateTimeInMSForNewAddin",16409952E5))){kd=wg.evb(zd);if(this.iO&&(rd=this.iO.split(","),0<rd.length&&Array.contains(rd,kd))){Mc++;t.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}kd.startsWith("private_")?(N.value<zd.installTimeInMS&&(N=new ya.a(Object.assign(new Gg,{addinId:kd,targetType:zd.targetType,storeId:zd.storeId,
solutionId:zd.solutionId}),zd.installTimeInMS)),kc++):(La.value<zd.installTimeInMS&&(La=new ya.a(Object.assign(new Gg,{addinId:kd,targetType:zd.targetType,storeId:zd.storeId,solutionId:zd.solutionId}),zd.installTimeInMS)),Eb++)}t.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",kc,Eb,Mc);return 0<La.value?La.key:0<N.value?N.key:Object.assign(new Gg,{addinId:null,targetType:-1,solutionId:null,storeId:null})}Tme(N){const La=
new l.a;for(let kc of this.fGa){const Mc=Ye(kc);if(N){var Eb=wg.evb(kc);N===Eb&&(Mc.showCallout=!0,Eb=this.iO?this.iO+","+N:N,sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)?window.g_roamingAddinList=Eb:this.e7(Eb))}La.add(Mc)}this.fGa&&1>this.fGa.count&&Bd.a.nfb(Pd.a.Knb,"false",this.context.ZN);N={["ack2"]:La};N[Pd.a.I9]=this.context.ZN;N[Pd.a.tP]=this.context.Qq;this.Ra.raiseEvent(Pd.a.Jnb,new $g(N),this)}Qui(){if(wg.UNb)return this.Rui(this.context.Dcd);
var N=!1;if(this.context.gja&&1>this.context.gja.count)return N;const La=ug();if(!La)return N;for(let Eb of this.context.gja)if(Eb.storeId&&Eb.storeId.toLowerCase()===La.toLowerCase()||Eb.assetId&&Eb.assetId.toLowerCase()===La.toLowerCase())N={["SDX_Id"]:wg.WU(Eb),["SDX_TargetType"]:te.c(Eb.targetType)?"":Eb.targetType.toString()},je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:ze.a.Sj(N)})),N=!0;return N}dui(){if(wg.UNb)this.eui(this.context.Dcd);
else if(!(this.context.gja&&1>this.context.gja.count))if(this.gGa.dgf()){var N=this.gGa.p2e();N?(N=this.eZe(this.context.gja,N),t.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(N=this.eZe(this.context.gja,null),t.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.gGa.e1f(N)}else t.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}eZe(N,La){const Eb={};let kc=!1;for(let Mc of N)if(N=wg.WU(Mc))!La||N in La||(this.Xxa(Mc,N),t.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?kc||(kc=!0,Eb[N]=null):Eb[N]=null;return Eb}Xxa(N,La){var Eb=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";Eb={["SDX.Id"]:La,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:te.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Eb};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj(Eb)}));1===N.targetType&&(N={["SDX.Id"]:La,
["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ze.a.Sj(N)})))}Rui(N){let La=!1;if(N&&1>N.count)return La;const Eb=ug();if(!Eb)return La;for(let kc of N)if(kc.storeId&&kc.storeId.toLowerCase()===Eb.toLowerCase()||kc.assetId&&kc.assetId.toLowerCase()===Eb.toLowerCase())N={["SDX_Id"]:wg.r2e(kc),["SDX_TargetType"]:te.c(kc.targetType)?"":kc.targetType.toString()},je.a.sendTelemetryEvent(Object.assign(new Hf.a,
{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:ze.a.Sj(N)})),La=!0;return La}eui(N){if(!(N&&1>N.count))if(this.gGa.dgf()){var La=this.gGa.p2e();La?(N=this.fZe(N,La),t.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(N=this.fZe(N,null),t.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.gGa.e1f(N)}else t.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}fZe(N,La){const Eb={};let kc=!1;for(let Mc of N)if(N=wg.r2e(Mc))!La||N in
La||(this.Qwi(Mc,N),t.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===N.toLowerCase()?kc||(kc=!0,Eb[N]=null):Eb[N]=null;return Eb}Qwi(N,La){var Eb=N.installTimeInMS?(new Date(N.installTimeInMS)).toISOString():"";Eb={["SDX.Id"]:La,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:te.c(N.targetType)?"":N.targetType.toString(),["SDX.AdminDeploymentTime"]:Eb};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj(Eb)}));
1===N.targetType&&(N={["SDX.Id"]:La,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ze.a.Sj(N)})))}INi(N,La,Eb,kc){N?(-1===kc.targetType&&(kc.targetType=Eb.targetTypeForExp),N=new yf(Eb.targetData,kc),La&&this.context.Kpe.add(N),10===this.context.ZN&&(this.context.Dcd.add(N),0===N.targetType&&this.context.JHa.add(N))):(La=Eb.targetData,t.ULS.sendTraceTag(542978528,220,
15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(La.solutionId,La.storeType,La.assetId,null,null,La.storeId),La.storeType));this.Umc()}ila(N){N={["AppTeachingUICalloutAction"]:N,["SDX.Id"]:this.yUd,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}))}static get UNb(){return sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)}static WU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static r2e(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static evb(N){return Telemetry.PrivacyRules.IsPrivateAddin(N.storeType,N.assetId,null,null,N.storeId)?"private_"+N.installTimeInMS:N.solutionId}}Object(e.a)(wg,"AddInCommandsListLoader",null,[]);class Sg{constructor(N){this.Oug=N}get Dca(){return this.Oug}insertOsfControl(N){return this.Dca.insertOsfControl(N)}getManifestInvaildErrorString(){return this.Dca.getManifestInvaildErrorString()}isAddinCommandsAsync(N,
La){this.Dca.isAddinCommandsAsync(N,La)}isAddinCommandsExAsync(N,La){this.Dca.isAddinCommandsExAsync(N,La)}ownerAddinControlRecreated(N,La){this.Dca.ownerAddinControlRecreated(N,La)}queryEntitlementDetails(N){this.Dca.queryEntitlementDetails(N)}}Object(e.a)(Sg,"ContextActivationMgrWrapper",null,[817]);class lf{createAddinDataProvider(N,La){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(N,La.Dca)}static get instance(){lf.Ma||(lf.Ma=new lf);return lf.Ma}}lf.Ma=null;Object(e.a)(lf,
"OSFAddinDataProviderFactory",null,[815]);class la{constructor(){this.Ver=1}}Object(e.a)(la,"CacheItem",null,[]);class qb{constructor(N){this.kEa=N}Ql(N){const La=this.kEa.getItem(N);if(La){let Eb=new la;try{Eb=Sys.Serialization.JavaScriptSerializer.deserialize(La,!0)}catch(kc){return this.kEa.removeItem(N),null}return Eb.Data?Eb.Data:Eb.data}return null}PQa(N){this.kEa.removeItem(N)}}Object(e.a)(qb,"AppsDataCacheManager",null,[360]);var rc=a(816);class Ic{constructor(){new qb(rc.a.instance)}FZf(N,
La){N=Pd.a.i_e()+N;rc.a.instance.setItem(N,La.toString())}p2e(){var N=Pd.a.s2e();t.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",N);N=rc.a.instance.getItem(N);return oe.a(N)}e1f(N){const La=Pd.a.s2e();t.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",La);rc.a.instance.setItem(La,oe.c(N))}dgf(){return!!rc.a.instance.localStorage}static get instance(){Ic.Ma||(Ic.Ma=new Ic);return Ic.Ma}}Ic.Ma=null;Object(e.a)(Ic,"AddInCommandsCacheManager",null,[819]);class Dd{constructor(N,La,Eb,kc,Mc,
kd){this.Qq=N;this.ik=La;this.vW=Eb;this.displayName=Mc;this.Hkf=kd}}Object(e.a)(Dd,"PostLaunchAddinCommandsParameters",null,[]);class Rd{constructor(N,La,Eb){this.wRa=!1;this.kX=null;this.$a=N;this.ejb=La;this.ygb=Eb}KUc(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(nd.a)(this,this.NBd,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(nd.a)(this,this.SAd,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(nd.a)(this,this.IAd,"onCloseButtonClickedEventHandler"),!0),sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&window.addEventListener("FGWebSurfaceEvent",Object(nd.a)(this,this.zEb,"onCampaignLaunchedHandler"),!0)):t.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}NBd(){const N={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Rd.WU(this.ejb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};this.ygb&&this.ygb.tabs&&!this.ygb.tabs[0].isOfficeTab&&(N["SDX.FeatureFlags"]="NonOfficeTab");je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.ula();this.ygb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.ygb,()=>{const La=new pf;La.ik=this.ejb;this.$a.raiseEvent(Pd.a.Jtd,
La)}):t.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}IAd(){const N={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Rd.WU(this.ejb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&this.ula()}SAd(){const N={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Rd.WU(this.ejb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&this.ula()}zEb(N){if(N&&(N=N.detail)&&N.id&&this.Bnd(N.id)){const Eb=
(N.action||"").toLowerCase();if(N.success&&"opened"===Eb){var La={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:Rd.WU(this.ejb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(La)}));t.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");this.ula();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(nd.a)(this,this.zEb,"onCampaignLaunchedHandler"),!0)}else try{La=JSON.stringify(N),t.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+La)}catch(kc){La="id : "+N.id+" telemetryEventName: "+N.telemetryEventName,t.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+La+" Error: "+(kc?kc.toString():""))}}}Bnd(N){N=vf.a.sl(N);return-1!==N.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==N.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==N.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==N.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==N.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==N.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}e7(N){const La=sd.AFrameworkApplication.fa.Xa("WebAppShortName");if(La){const Eb={},kc={};kc.LastTeachingUIShowTime=(new Date).toUTCString();kc.AddinHasShown=N;Eb[La]=oe.c(kc);this.kX=new pg(La,null,null,Object(nd.a)(this,this.VV,"postRequestFailureCallback")),this.kX.V2a(Eb),t.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else t.ULS.sendTraceTag(523535565,
220,10,"Fail to save roaming service since AppName is null")}ula(){if(!this.wRa){const N=window.g_roamingAddinList;N&&(this.e7(N),this.wRa=!0)}}VV(N){t.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",N?N.httpStatus:-1)}static WU(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}}Object(e.a)(Rd,"PrivateCatalogTeachingCalloutHandler",null,[]);class aa{constructor(N){this.Iae=null;this.D9d=
N}get Jxa(){return this.Iae}XYa(N,La=null){this.D9d.XYa(N,La);this.Iae=N}YJd(N){this.D9d.YJd(N)}}Object(e.a)(aa,"RibbonExtensibilityManagerWithChangeDetection",null,[841]);var Xa=a(863),Sb=a(99);class E{static X_e(N){const La=new l.a;if(E.eCe)for(var Eb of E.eCe)La.add(Eb);Eb=null;switch(N){case "Workbook":Eb=E.SXj;break;case "Document":Eb=E.zih;break;case "Presentation":Eb=E.p0i}if(Eb)for(const kc of Eb)La.add(kc);return La}}E.eCe=["PrimaryCommandSurface","ContextMenu"];E.SXj=null;E.zih=null;E.p0i=
null;Object(e.a)(E,"ExtensionPointType",null,[]);class fa{constructor(N){this.Ede=null;if(te.c(N))throw t.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.emg=N}get lEb(){return this.Ede||(this.Ede=new l.a)}get rqe(){return this.emg}}Object(e.a)(fa,"ContextMenuExtensibility",null,[827]);class Ja{constructor(N,La=null,Eb=0){if(te.c(N))throw t.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.Hug=N;this.Yxg=La;this.Iqg=Eb}get JV(){return this.Hug}get startedNode(){return this.Yxg}get FHh(){return this.Iqg}}Object(e.a)(Ja,"RibbonExtensibility",null,[881]);class Db{constructor(N){this.Ipg=N.entitlement}get entitlement(){return this.Ipg}createActionContext(N,La){N={};N.ownerAddinInfo=this.entitlement;N.action=La;return N}}Object(e.a)(Db,"AddInCommandsContextProvider",null,[]);class nc{constructor(N,La,
Eb){this.S2d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=N;this.eventBuilder=La;this.contextMenuBuilder=Eb}get Mpe(){return this.S2d}K6g(N){return new Db(N)}createActionBuilder(N,La){return OfficeExt.DefaultControlActionBinder.createActionBuilder(N,La.entitlement,La.manifest)}startApplyAddin(N){this.S2d=N;const La=this.K6g(N);this.actionBuilder=this.createActionBuilder(La,N)}endApplyAddin(){}cdd(N,La,Eb=0){return this.ribbonBuilder.Vs&&
0<this.ribbonBuilder.Vs.count?new Ja(this.VGh(N,La),this.Mpe.startedNode,Eb):null}EWe(){var N=null;if(this.contextMenuBuilder.ulc&&0<this.contextMenuBuilder.ulc.count){N||(N=this.Mpe.entitlement.solutionId);N=new fa(N);for(let La of this.contextMenuBuilder.ulc)N.lEb.add(La);return N}return null}VGh(N,La){return this.ribbonBuilder.Vs&&0<this.ribbonBuilder.Vs.count?new Hb.a(this.ribbonBuilder.Vs,N,La):null}}Object(e.a)(nc,"AddinCommandsBuilder",null,[]);class lc{constructor(N,La,Eb,kc,Mc,kd,rd){this.vTa=
new Sb.a;this.Qq=N;this.Xh=La;this.Xo=Eb;this.ribbonManager=kc;this.contextMenuManager=Mc;this.fG=kd;this.Qga=rd;this.xO=sd.AFrameworkApplication.ta.ZD}XBb(N,La,Eb,kc,Mc,kd,rd){const zd=(Od,Ud,Ne,Oe)=>{Mc(Od,Ud,Ne,Oe);Od=Xa.a[this.Qq]+Ud.assetId;({value:Ud}=this.vTa.Cc(Od)).returnValue&&(Ud.stop(),this.vTa.remove(Od))};if(0!==this.Qq&&N){t.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",N.count);4===this.Qq&&(t.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",
kc)),this.UYg(N,kc),kd());for(let Od of N)if(N=Od,t.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId))),this.Ygg(N))if(rd&&N.requireConsent)rd(N,Ud=>{try{if(this.xO){const Oe=Xa.a[this.Qq]+Ud.solutionId,ef=this.xO.Bc("ComponentAttach",Oe);this.vTa.ia(Oe,ef)}const Ne=this.fG.Oia(Ud.storeType,Ud.solutionId);6!==this.Qq&&(Ne&&(this.K2b(Ne),Ne.CB.purge(!1)),
this.Xh.insertOsfControl(this.aHb(Ud,La,Eb,zd)),Ne&&this.Xh.ownerAddinControlRecreated(Ud.solutionId,Ud.storeType))}catch(Ne){t.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(Ud.solutionId,Ud.ownerAddinStoreType||Ud.storeType,Ud.assetId,null,null,Ud.storeId),Ud.version,Ud.storeType,Ud.storeId,Ne.message)),zd(!1,Ud,null,null)}});
else try{if(this.xO){const Ne=Xa.a[this.Qq]+N.solutionId,Oe=this.xO.Bc("ComponentAttach",Ne);this.vTa.ia(Ne,Oe)}const Ud=this.fG.Oia(N.storeType,N.solutionId);6!==this.Qq&&(Ud&&(this.K2b(Ud),Ud.CB.purge(!1)),this.Xh.insertOsfControl(this.aHb(N,La,Eb,zd)),Ud&&this.Xh.ownerAddinControlRecreated(N.solutionId,N.storeType))}catch(Ud){t.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.Xo.dN,
Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,Ud.message)),zd(!1,N,null,null)}else zd(!1,N,null,null)}}vri(N,La,Eb,kc,Mc,kd){const rd=(zd,Od,Ud,Ne)=>{kd(zd,Od,Ud,Ne);zd=Xa.a[this.Qq]+Od.solutionId;({value:Od}=this.vTa.Cc(zd)).returnValue&&(Od.stop(),this.vTa.remove(zd))};if(6===this.Qq&&N)if(t.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,
N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId))),this.Ygg(N))try{if(this.xO){const Od=Xa.a[this.Qq]+N.solutionId,Ud=this.xO.Bc("ComponentAttach",Od);this.vTa.ia(Od,Ud)}const zd=this.fG.Oia(N.storeType,N.solutionId);zd||rd(!1,N,null,null);sd.AFrameworkApplication.ta&&sd.AFrameworkApplication.ta.Oa.delayInstallAddInIsEnabled?this.bXe(N,La,kc,Mc,Eb,Od=>{rd(Od,N,Eb,zd.displayName)}):(this.bXe(N,La,kc,Mc,Eb),rd(!0,N,Eb,zd.displayName))}catch(zd){t.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,zd.message)),rd(!1,N,null,null)}else rd(!1,N,null,null)}VFi(N,La,Eb,kc,Mc,kd){if(kd)if(kd._isAddinCommandsManifest(this.Xo.dN))try{sd.AFrameworkApplication.ta&&sd.AFrameworkApplication.ta.Oa.delayInstallAddInIsEnabled?this.aXe(N,La,Eb,Mc,kd,rd=>{kc(rd,N,kd,kd.getDefaultDisplayName())}):(this.aXe(N,La,Eb,Mc,kd),kc(!0,N,kd,kd.getDefaultDisplayName()))}catch(rd){t.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId,rd.message)),kc(!1,N,kd,kd.getDefaultDisplayName())}else t.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),kc(!1,N,null,null);else t.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.Xo.dN,Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.ownerAddinStoreType||N.storeType,N.assetId,null,null,N.storeId),N.version,N.storeType,N.storeId)),
kc(!1,N,null,null)}aHb(N,La,Eb,kc){const Mc={},kd=document.createElement("div");kd.setAttribute("visible","false");Mc.div=kd;Mc.id=N.solutionId;Mc.solutionId=N.solutionId;Mc.version=N.version;Mc.storeType=N.storeType;Mc.storeId=N.storeId;Mc.assetId=N.assetId;Mc.assetStoreId=N.assetStoreId;Mc.isvirtualOsfControl=!0;Mc.virtualOsfControlActivationCallback=(rd,zd)=>{const Od=this.fG.Oia(N.storeType,N.solutionId);Od&&(Od.isUpgraded&&(N.isUpgraded=!0),this.K2b(Od));this.VFi(N,La,Eb,kc,rd,zd)};Mc.reason=
3===this.Qq?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;return Mc}aXe(N,La,Eb,kc,Mc,kd=null){const rd={};rd.solutionId=kc.getSolutionId();rd.version=kc.getVersion();rd.storeType=kc.getStoreType();rd.storeId=kc.getStoreId();rd.assetId=kc.getSolutionId();rd.assetStoreId=kc.getAssetStoreId();rd.targetType=kc.getOsfControlType();let zd=null,Od=null;if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))zd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Xo.dN,this.Xo.formFactor)).parseExtensions(rd,Mc,this.Qga),Od=E.X_e(this.Xo.dN);else try{zd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.Xo.dN,this.Xo.formFactor)).parseExtensions(rd,Mc,this.Qga),Od=E.X_e(this.Xo.dN)}catch(Ne){throw t.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ne.message),Ne;}if(Od&&0<Od.count){if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var Ud=La(N);La=Eb(N);Eb=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Ud=new nc(Ud,null,La);for(let Ne of Od)Ud.commandSurface=Ne,zd.apply(Ud,this.Qga,Eb)}else try{let Ne=La(N),Oe=Eb(N),ef=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("AddinCommandsMultipleCustomTabsEnabled");Ud=new nc(Ne,null,Oe);for(let lg of Od)Ud.commandSurface=lg,zd.apply(Ud,this.Qga,ef)}catch(Ne){throw t.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+
Ne.message),Ne;}if(OSF.OUtil.checkFlight(14))try{let Ne=Ud.cdd(N.solutionId,Mc.getDefaultDisplayName()),Oe=Ud.EWe();Ne&&this.ribbonManager.XYa(Ne,kd);Oe&&this.contextMenuManager.ume(Oe);this.fG.$me(kc,Ne,Oe,Mc.getDefaultDisplayName());t.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Mc.getDefaultDisplayName())}catch(Ne){throw OfficeExt.DevConsole.log(Ne),t.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Ne.message),Ne;}else try{let Ne=Ud.cdd(N.solutionId,
Mc.getDefaultDisplayName()),Oe=Ud.EWe();Ne&&this.ribbonManager.XYa(Ne);Oe&&this.contextMenuManager.ume(Oe);this.fG.$me(kc,Ne,Oe,Mc.getDefaultDisplayName());t.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Mc.getDefaultDisplayName())}catch(Ne){throw t.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ne.message),Ne;}}}bXe(N,La,Eb,kc,Mc,kd=null){const rd={};rd.solutionId=N.solutionId;rd.version=N.version;rd.storeType=N.storeType;rd.storeId=N.assetStoreId;
rd.assetId=N.assetId;rd.assetStoreId=N.assetStoreId;rd.targetType=N.targetType;const zd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.Xo.dN,this.Xo.formFactor);try{const Od=La.getManifest(),Ud=zd.parse(rd,Od,Mc,this.Qga,La.getSharedRuntimeId(),La),Ne=Eb(N),Oe=kc(N),ef=new nc(Ne,null,Oe);ef.commandSurface="PrimaryCommandSurface";Ud.apply(ef,this.Qga,!0);if(ef.ribbonBuilder.Vs&&0<ef.ribbonBuilder.Vs.count){const lg=ef.cdd(N.solutionId,La.getManifest().getDefaultDisplayName(),1);sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ribbonManager.XYa(lg,kd):lg&&this.ribbonManager.XYa(lg,kd);this.fG.jDg(La,lg,Mc,La.getManifest().getDefaultDisplayName());t.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",La.getManifest().getDefaultDisplayName())}}catch(Od){t.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",La.getManifest().getDefaultDisplayName(),Od.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Od)}}K2b(N){N.No&&this.ribbonManager.YJd(N.No);
N.drb&&this.contextMenuManager.s$i(N.drb);this.fG.a$i(N.CB.getStoreType(),N.CB.getSolutionId())}UYg(N,La){La=hh(La);for(let Eb of this.fG.d6a){if(Eb.CB.getStoreType()!==La)continue;let kc=!0;for(let Mc of N){const kd=Mc;if(kd&&Eb.Ohf(kd.storeType,kd.solutionId)){kc=!1;break}}kc&&(this.K2b(Eb),Eb.CB.purge(!1))}}Ygg(N){return!!N&&!!N.solutionId&&!!N.version&&!!N.storeType&&!!N.storeId}}Object(e.a)(lc,"AddInCommandsIntegration",null,[]);class mc{constructor(N,La,Eb,kc,Mc,kd,rd,zd=null){this.$a=new za.a;
this.WEc=N;this.Cog=La;this.$m=Eb;this.Oje=kc;this.IXa=Mc;this.Tlg=kd;this.VQb=rd;this.zug=zd;this.rsg=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.XKc=sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}gFg(N){this.$a.addHandler(Pd.a.Lpe,N)}YGg(N){this.$a.addHandler(Pd.a.Jtd,N)}zIg(N){this.$a.addHandler(Pd.a.o4f,N)}nFg(N){this.$a.addHandler(Pd.a.eYc,N)}Ori(N,La,Eb){const kc=Eb[Pd.a.Inb],
Mc=void 0===Eb[Pd.a.tP]?0:Eb[Pd.a.tP];if(kc&&0!==Mc)if(0>=kc.count&&4!==Mc)this.iJf(new Dd(Mc,null,null,La,null,!0));else{var kd=kc.count,rd=new aa(new hc),zd=void 0===Eb[Pd.a.I9]?-1:Eb[Pd.a.I9],Od=new lc(Mc,this.$m,this.WEc,rd,this.Cog,this.IXa,this.VQb),Ud=$f=>this.Oje.sSg($f.solutionId,this.VQb,this.WEc,N),Ne=$f=>this.Oje.DRg($f.solutionId),Oe=($f,ag,Mf)=>{kd--;Mf=new Dd(Mc,ag,rd,La,Mf,0>=kd);if($f&&ag)this.iJf(Mf);else{if(3===Mc||ag&&ag.isUpgraded)$f="",ag&&($f=Telemetry.PrivacyRules.GetPrivacyCompliantId(ag.solutionId,
ag.ownerAddinStoreType||ag.storeType,ag.assetId,null,null,ag.storeId)),ag={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:$f},je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj(ag)}));this.hJf(Mf)}kd||sd.AFrameworkApplication.ta.updateCommandUI()},ef=($f,ag,Mf,mg)=>{Oe($f,ag,mg)},lg=()=>{this.wzd();0>=kc.count&&4===Mc&&this.IXa.KPd()};6===Mc?(zd=Eb[Pd.a.UIa],Eb=Eb[Pd.a.VIa],Od.vri(kc.na(0),
zd,Eb,Ud,Ne,($f,ag,Mf,mg)=>{Oe($f,ag,mg)})):Od.XBb(kc,Ud,Ne,zd,ef,lg,this.zug)}else je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj({["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),t.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.WEc.dN)),this.hJf(new Dd(Mc,null,null,La,null,!0))}hJf(N){this.wzd(N);this.g5f(!1,
N)}iJf(N){const La=N.ik;let Eb=null;null!==La&&(Eb=La.storeType,Eb=Eb.toLowerCase());if(N&&"omex"===Eb&&(3===N.Qq||La.isUpgraded)){var kc={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(La.solutionId,La.ownerAddinStoreType||La.storeType,La.assetId,null,null,La.storeId)};je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ze.a.Sj(kc)}))}this.wzd(N);kc=this.XKc&&gh()&&"omex"===
Eb&&!!N.vW&&!!La.solutionId&&2===N.Qq&&La.solutionId.toLowerCase()===ug().toLowerCase();if("omex"===Eb&&N.vW&&(3===N.Qq&&"hardcodedpreinstall"!==Eb||La.isUpgraded)||kc)kc=new pf,kc.ik=La,kc.No=N.vW.Jxa,this.$a.raiseEvent(Pd.a.eYc,kc);if(this.rsg){kc=lh();const Mc=ug();kc&&La&&"excatalog"===La.storeType&&N.vW&&5===N.Qq&&Mc&&(La.storeId&&La.storeId.toLowerCase()===Mc.toLowerCase()||La.assetId&&La.assetId.toLowerCase()===Mc.toLowerCase())&&(kc=new pf,kc.ik=La,kc.No=N.vW.Jxa,this.$a.raiseEvent(Pd.a.eYc,
kc),t.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}La&&(Ic.instance.FZf(ah(Eb),!0),"uploadfiledevcatalog"===Eb&&(kc=this.Tlg.createAddinDataProvider(Eb,this.$m))&&kc.localCacheAddinCommands(this.$m.Dca,La.solutionId,La.version,La.storeId),Bd.a.nfb(Pd.a.Knb,"true",ah(Eb)));this.g5f(!0,N)}g5f(N,La){N?sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&La.vW&&5===La.Qq&&La.vW.Jxa&&void 0!==La.ik.showCallout&&
null!==La.ik.showCallout&&La.ik.showCallout?(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)?(new Jf(this.$a)).KUc(La.ik,Hb.a.J3a(La.vW.Jxa)):(new Rd(this.$a,La.ik,Hb.a.J3a(La.vW.Jxa))).KUc(),N=new pf,N.No=La.vW.Jxa,N.ik=La.ik,this.$a.raiseEvent(Pd.a.o4f,N)):3!==La.Qq?La.Hkf&&this.IXa.KPd():La.vW&&La.vW.Jxa&&"hardcodedpreinstall"!==La.ik.storeType&&Hc.a.uzj(La.displayName,La.vW.Jxa,La.ik.isAutoLaunched):3===La.Qq?La.ik&&"uploadfiledevcatalog"===
La.ik.storeType.toLowerCase()?(La=this.VQb.sOh(La.ik.solutionId),Hc.a.QSd(La?La:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.IXa.L_f():La.Hkf&&this.IXa.KPd()}wzd(N=null){var La=N?N.ik:null;const Eb=new pf;if(Eb.ik=La){var kc=this.IXa.Oia(La.storeType,La.solutionId,6===N.Qq?1:0);if(kc&&kc.No){Eb.No=kc.No;var Mc=this.XKc?ug():null;Mc=this.XKc&&gh()&&!!La.solutionId&&!!Mc&&La.solutionId.toLowerCase()===Mc.toLowerCase()&&2===N.Qq;if(3===N.Qq&&"hardcodedpreinstall"!==
La.storeType||Mc)N="",kc.No.JV&&kc.No.JV.Vs&&(kc=kc.No.JV.Vs.na(0))&&(N=kc.id),La={["SDX_CommandPlacement"]:N,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(La.solutionId,La.ownerAddinStoreType||La.storeType,La.assetId,null,null,La.storeId)},je.a.sendTelemetryEvent(Object.assign(new Hf.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ze.a.Sj(La)}))}}this.$a.raiseEvent(Pd.a.Lpe,Eb)}}Object(e.a)(mc,"LaunchAddinCommandsHandler",
null,[824]);class bd{}bd.YUa="Alt";bd.ZUa="Command";bd.id="Id";bd.aVa="Image16by16";bd.EQb="LabelText";bd.bVa="Title";bd.GROUP="Group";bd.a2d="Groups";bd.pgb="Controls";bd.button="Button";bd.yaa="FlyoutAnchor";bd.LARGE="Large";bd.SMALL="Small";Object(e.a)(bd,"AddinDataNodeConstants",null,[]);a(374);a(569);a(564);a(159);class wd{constructor(N,La){this.rEa=this.s5d=null;if(te.c(N)||te.c(La))throw t.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.Iog=La;this._id=N;this.bU[bd.id]=this._id}get id(){return this._id||""}get bU(){return this.s5d||(this.s5d={})}get controlType(){return this.Iog||""}get menuItems(){return this.rEa||(this.rEa=new l.a)}}Object(e.a)(wd,"ControlDefinition",null,[822]);class td{constructor(N){this.nce=null;if(te.c(N))throw t.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=N;this.xla[bd.id]=this._id}get xla(){return this.nce||
(this.nce={})}get id(){return this._id||""}}Object(e.a)(td,"MenuItemDefinition",null,[856]);class Vd{constructor(N){this.Epa=null;if(te.c(N))throw t.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=N}get id(){return this._id}get controls(){return this.Epa||(this.Epa=new l.a)}}Object(e.a)(Vd,"OfficeMenuDefinition",null,[823]);var ae=a(25);class Ge{constructor(N,La,Eb){this.cJ=
this.NVa=null;this.fOc=N;this.CVa=La;this.dVa=Eb;this.Ytg=new l.a}get amc(){return this.fOc}get Fqb(){return this.CVa}get NTc(){return this.dVa}addButton(N){t.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",N.actionType);this.cJ=new wd(this.Asa(N.id),bd.button);this.cJ.bU[bd.EQb]=N.label;this.cJ.bU[bd.YUa]=N.label;this.cJ.bU[bd.aVa]=N.icon["16"];this.apb(this.cJ.bU[bd.id],N.action);this.PFa(this.cJ.bU);this.NVa.controls.add(this.cJ);this.cJ=null}startBuildMenu(N){if(te.c(this.NVa))this.NVa=
new Vd(N.id);else{const La=this.Asa(N.id);this.cJ=new wd(La,bd.yaa);this.G_a(this.cJ.bU,N);this.cJ.bU[bd.aVa]=N.icon["16"];this.cJ.bU[bd.ZUa]=ae.a.alwaysEnabled}}addMenuItem(N){t.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",N.actionType);const La=new td(this.Asa(N.id));this.G_a(La.xla,N);N.icon&&(La.xla[bd.aVa]=N.icon["16"]);this.apb(La.xla[bd.id],N.action);this.PFa(La.xla);this.cJ.menuItems.add(La)}endBuildMenu(){te.c(this.cJ)?(this.ulc.add(this.NVa),this.NVa=null):(this.NVa.controls.add(this.cJ),
this.cJ=null)}get ulc(){return this.Ytg}apb(N,La){this.NTc.bindAction(N,La)}PFa(N){this.Fqb.PFa(N)}Asa(N){return this.amc.qKa(N)}G_a(N,La){N[bd.EQb]=La.label;N[bd.YUa]=La.label}}Object(e.a)(Ge,"ContextMenuExtensibilityCreator",null,[840,836]);class Be{constructor(N){this.lkb=N}get JDb(){return this.lkb}qKa(N){return this.JDb+N}}Object(e.a)(Be,"DefaultContextMenuNamingProvider",null,[839]);var Fe=a(1309);class df{bindAction(N,La){OfficeExt.DefaultControlActionBinder.bindAction(N,La)}}Object(e.a)(df,
"DefaultUIControlActionBinder",null,[838]);class bf{constructor(N){this.ZCa=N}get command(){return this.ZCa}PFa(N){N[bd.ZUa]=this.command}}Object(e.a)(bf,"DefaultUIControlCommandBinder",null,[837]);var kf=a(32);class of{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}}Object(e.a)(of,"AddInControl",null,[]);class nf{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(e.a)(nf,
"AddInGroup",null,[]);class Kf{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(e.a)(Kf,"AddInMenuItem",null,[]);class rf{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}}Object(e.a)(rf,"AddInTab",null,[]);class Dg{constructor(N,La,Eb,kc,Mc,kd){this.SQb=new l.a;this.Ehb=this.cfa=this.OVa=null;this.fOc=N;this.dVa=La;this.CVa=Eb;
this.lx=kc;this.VQb=Mc;this.q7d=kd}get amc(){return this.fOc}get Vs(){return this.SQb}get NTc(){return this.dVa}get Fqb(){return this.CVa}startBuildTab(N){const La=N.isOfficeTab?N.id:this.amc.i4e(N.id),Eb=N.isOfficeTab?null:N.label;this.OVa=Object.assign(new rf,{id:La,title:Eb,isOfficeTab:N.isOfficeTab,visible:N.visible,groups:[],tabType:N.tabType,insertBefore:N.insertBefore,insertAfter:N.insertAfter,autoFocus:N.autoFocus})}startBuildGroup(N){const La=this.Asa(N.id);this.cfa=Object.assign(new nf,
{id:La,mlrId:N.mlrId,title:N.label,controls:[],groupType:0})}addNativeGroup(N){this.cfa=Object.assign(new nf,{id:N.id,mlrId:N.mlrId,title:N.label,controls:[],groupType:1});this.OVa.groups.push(this.cfa)}addButton(N){const La=this.Asa(N.id);La&&(this.apb(La,N.action),t.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new of,{id:La,title:N.label,iconLocation:this.sfd(N),enabled:N.enabled,controlType:0,attributes:this.G_a()}),this.q7d.hme(new kf.a(La,
this.Fqb.command.toString())),this.cfa.controls.push(N))}addNativeControl(N){N.id&&(t.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",N.actionType),N=Object.assign(new of,{id:N.id,title:"",iconLocation:"",enabled:N.enabled,controlType:2,attributes:this.G_a()}),this.cfa.controls.push(N))}startBuildMenu(N){const La=this.Asa(N.id);La&&(this.Ehb=Object.assign(new of,{id:La,title:N.label,iconLocation:this.sfd(N),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(N){const La=
this.Asa(N.id);La&&(this.apb(La,N.action),t.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",N.actionType),N=Object.assign(new Kf,{id:La,title:N.label,iconLocation:this.sfd(N),enabled:N.enabled,attributes:this.G_a()}),this.q7d.hme(new kf.a(La,this.Fqb.command.toString())),this.Ehb.menuItems.push(N))}endBuildMenu(){te.c(this.Ehb.id)||this.cfa.controls.push(this.Ehb);this.Ehb=null}endBuildGroup(){te.c(this.cfa.id)||this.OVa.groups.push(this.cfa);this.cfa=null}endBuildTab(){te.c(this.OVa.id)||
this.SQb.add(this.OVa);this.OVa=null}G_a(){const N={};this.PFa(N);return N}sfd(N){return N.icon["80"]?N.icon["80"]:N.icon["32"]}PFa(N){this.Fqb.PFa(N)}Asa(N){return this.amc.qKa(N)}apb(N,La){this.NTc.bindAction(N,La)}}Object(e.a)(Dg,"OneLineRibbonExtensibilityCreator",null,[835,836]);class Eg{constructor(N,La){this.lkb=N;this.dVa=new df;this.CVa=new bf(La)}DRg(N){N=new Be(N);return new Ge(N,this.CVa,this.dVa)}sSg(N,La,Eb,kc){Eb=new Fe.a(this.lkb,N,Eb,!0);return new Dg(Eb,this.dVa,this.CVa,N,La,kc)}}
Object(e.a)(Eg,"UIExtensibilityFactory",null,[818]);var xg=a(90),Tg=a(862),ch=a(22),cf=a(37),Kg=a(77),jg=a(50);class Pg{constructor(N){this.eGa=this.jGa=this.ik=this.No=null;this.wQf=0;this.aOi=()=>{if(this.ik&&this.eGa){const La=new xg.a(ae.a.n2,0,0,2,null);this.addinUICommandHandler.executeCommand(0,La,{["SourceControlId"]:this.eGa},null);t.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.vzj=(La,Eb)=>{La=null;if(Eb)if(La=Eb,this.ik=La.ik,(this.No=La.No)&&this.No.JV&&
this.No.JV.Vs&&(this.jGa=this.No.JV.Vs.na(0)),this.jGa&&this.jGa.id)if(this.jGa.isOfficeTab)if(Eb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),La=this.ik.solutionId,La in Eb?this.eGa=Eb[La]:(Eb=Pg.GetPrivacyCompliantId(this.ik),t.ULS.sendTraceTag(537170695,220,15,`Failed to get button id from controlIdMap for add-in: ${Eb}`),this.eGa=this.oIh(this.No)),this.eGa)if(ch.a.contains(this.jGa.id,ie.a.eW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Hb.a.J3a(this.No),
()=>{this.I5f(this.Cgd(this.eGa))});else{if(Eb=this.$.Ka)Eb.Bpe(this.XEf),t.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else t.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Eb={["AppTeachingUICalloutAction"]:"NoEnabledButtonFound",["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:ze.a.Sj(Eb)})),this.L5();else this.K5f(this.Cgd(this.jGa.id),0);else t.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Eb={["AppTeachingUICalloutAction"]:"NoTabFound",["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(Eb)})),this.L5();
else this.L5()};this.XEf=()=>{if(ch.a.contains(this.jGa.id,appChrome.selectors.getSelectedTabId(),!0)){var La=this.$.Ka;La&&La.tSf(this.XEf);this.I5f(this.Cgd(this.eGa))}};this.cOi=()=>{var La={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(La)}));this.L5();let Eb=
{};Eb[Kg.a.kg]=this.MC;La={};La.solutionId=this.MC.solutionId;La.assetId=this.MC.assetId;La.assetStoreId=this.MC.assetStoreId;La.height=0!=this.MC.height?this.MC.height:600;La.storeId=this.MC.storeId;La.storeType=this.MC.storeType;La.targetType=this.MC.targetType;La.width=0!=this.MC.width?this.MC.width:600;La.displayName=this.MC.displayName;La.version=this.MC.version;La.isAddinCommands=!1;Eb[Pd.a.Yra]=La;let kc=new xg.a(-741808261,0,0,2,null);cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.Sa(this.$.da,
374,375,1),Mc=>{Mc=Mc.result;null!=Mc&&Mc.insertAgave(Eb,kc)},this.$.la,3)};this.OHi=()=>{let La={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(La)}));this.L5()};this.iJi=()=>{let La={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(La)}));this.L5()};this.VV=La=>{t.ULS.sendTraceTag(522981591,306,10,`failed to POST data to Roaming Settings Service with status: ${La?La.httpStatus:-1}`)};this.$=N.$;this.addinUICommandHandler=N;this.appName=sd.AFrameworkApplication.fa.Xa("WebAppShortName")||"Excel";this.hJg=sd.AFrameworkApplication.fa.qd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)}static GetPrivacyCompliantId(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}static $Ua(N){return Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,N.storeType,N.assetId,null,null,N.storeId)}w9i(N){this.MC=N;window.addEventListener&&(window.addEventListener("LaunchContentAddin",this.cOi,!0),window.addEventListener("DismissCallout",this.iJi,!0),window.addEventListener("CloseCallout",this.OHi,!0))}Cgd(N){return"[id="+N+"]"}K5f(N,
La){La>this.hJg?(window.clearTimeout(this.wQf),this.J5f("[data-unique-id='pivotOverflowButton']"),t.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+N)?this.J5f(N):this.wQf=window.setTimeout(()=>{this.K5f(N,La+1)},1E3)}I5f(N){var La=document.querySelector("button[data-unique-id='RightPaddle']");if(La)N={["AppTeachingUICalloutAction"]:"RightPaddlePresent",["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));else if(La=document.querySelector("button"+N),!La||"none"===window.getComputedStyle(La).display)if(La=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!La){La={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};
je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(La)}));t.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");this.L5();return}this.ibg(La,"ShowTeachingUIForAddinButton")}J5f(N){N=document.querySelector("button"+N);if(!N&&(N=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!N)){N={["AppTeachingUICalloutAction"]:"NoAnchor",["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));t.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.L5();return}this.ibg(N,"ShowTeachingUIForAddinTab")}ibg(N,La){N.setAttribute("lpp-id","latestAddin");const Eb=Ed.a.instance.Ub("Common.ISystemInitiatedFeedback");Eb&&N?(Eb.execute(kc=>{kc.logActivity(La,null)}),N={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)})),t.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(t.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",
["SDX.Id"]:Pg.GetPrivacyCompliantId(this.ik),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)})),this.L5())}oIh(N){if(!N)return null;N=N.JV;if((null===N||void 0===N?0:N.Vs)&&0<N.Vs.count)for(let La of N.Vs)if(La.groups&&0<La.groups.length)for(const Eb of La.groups)if(Eb.controls&&0<Eb.controls.length)for(const kc of Eb.controls){if(kc.attributes&&
0===kc.controlType&&kc.enabled)return kc.id;if(kc.menuItems)for(const Mc of kc.menuItems)if(Mc.attributes&&Mc.enabled)return kc.id}return null}QBj(){var N=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(N&&"none"!==window.getComputedStyle(N).display)t.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");else{N=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==N){N={["AppTeachingUICalloutAction"]:"NoAnchor",
["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)}));t.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");this.L5();return}t.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}const La=Ed.a.instance.Ub("Common.ISystemInitiatedFeedback");null==
La||null==N?(N={["AppTeachingUICalloutAction"]:"NoSifFutureObject",["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)})),t.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"),this.L5()):(La.execute(Eb=>{Eb.logActivity("ShowTeachingUIForContentAddin",null)}),N={["AppTeachingUICalloutAction"]:"Show",
["SDX.Id"]:Pg.$Ua(this.MC),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"},je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj(N)})),t.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))}e7(N){const La={},Eb={};Eb.LastTeachingUIShowTime=(new Date).toUTCString();Eb.AddinHasShown=N;La[this.appName]=oe.c(Eb);this.Nnb=new pg(this.appName,null,null,
this.VV),this.Nnb.V2a(La),t.ULS.sendTraceTag(522981592,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}L5(){if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",!1)&&!this.wRa){const N=window.g_roamingAddinList;N&&(this.e7(N),this.wRa=!0)}}}Object(e.a)(Pg,"AddinTeachingCalloutHandler",null,[]);var Oh=a(1230),Gi=a(418),Eh=a(11),ci=a(183),Ph=a(40),zg=a(21),mh=a(55);class Hi{constructor(N,
La,Eb,kc,Mc,kd,rd=null){this.disposed=!1;this.AGi=(zd,Od)=>{if(Od)if(Od)if(zd=Od.ik){Od=Od.No;var Ud=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(zd.solutionId in Ud)Od=Ud[zd.solutionId];else if(Od=this.eMh(Od),void 0===Od||null===Od){t.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Ud=new xg.a(ae.a.n2,0,0,2,null);this.executeCommand(0,Ud,{["SourceControlId"]:Od},null);zd.isAutoLaunched=!0}else t.ULS.sendTraceTag(528098435,220,
15,"insertionParam is null");else t.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else t.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.Abf=(zd,Od)=>{"Insert"==Od.tabName&&(zd=this.$.Ka,null!=zd&&(zd.tSf(this.Abf),t.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.TNb.QBj())};this.bOi=(zd,Od)=>{zd=null;Od&&(zd=Od);(null===zd||void 0===zd?0:zd.No)&&this.Gsj(zd.No);this.$.$e();z.EwaSettings.ma(87)&&zd&&zd.ik&&this.zOg(zd.ik)};this.$=
N;t.ULS.shipAssertTag(537170659,0,!(void 0===La||null===La),`AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: ${Ph.a.i3()}`);this.re=La;this.$Ce=Eb;this.q_b=kc;this.Rga=Mc;this.Lnb=kd;this.Xo=new Tg.a;this.Qga=new Yf;this.oad=rd;ne.a.Txb=ne.a.cSe;this.l6c=new l.a;this.$1a=new l.a}dispose(){void 0!==this.Lnb&&null!==this.Lnb&&(this.Lnb.dispose(),this.Lnb=null);this.re=this.$=null;this.disposed=!0}Mwj(N,La){switch(N){case ae.a.n2:N=this.xwj(La);break;default:N=!1}return N}Lc(){return!1}executeCommand(N,
La,Eb){N=cf.TaskExtensions.ak();La=La.command;switch(La){case 843847158:break;case -2025863019:Hc.a.QSd(Eb[Pd.a.eWc].toString(),()=>{zg.g(this.$).focus()});break;case -1777565636:Oh.a.showUILessDialog(Eb[Pd.a.Mnb].toString());this.re.Jzj(Eb[Pd.a.Mnb].toString());break;case 1592314317:Oh.a.hideUILessDialog(Eb[Pd.a.Mnb].toString());this.re.G6h(Eb[Pd.a.Mnb].toString());break;case ae.a.n2:N=this.Jid(Eb);break;case ae.a.WBb:this.XBb(Eb);break;case ae.a.dna:this.dna(Eb);break;case ae.a.RSd:this.Lnb.vyc();
break;case ae.a.refreshAddinCommands:this.m7i();break;case 1949669462:this.Rga.L_f(!0);break;case -1014260128:N=this.executeDynamicAddInCommandsAPI(Eb);break;default:N=ci.a(La)}return N}Ac(N,La){N=!1;switch(La.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case ae.a.dna:case ae.a.RSd:case ae.a.refreshAddinCommands:case 1949669462:case ae.a.WBb:case -1014260128:N=!0;break;case ae.a.n2:N=!sd.AFrameworkApplication.protectedFile}return N}Oc(){return!1}eMh(N){if(!N)return t.ULS.sendTraceTag(528098432,
220,10,"Failed to get button id for addin"),null;if((N=N.JV)&&N.Vs&&0<N.Vs.count)for(let La of N.Vs){if(La.groups&&1===La.groups.length){N=La.groups[0];if(N.controls&&1===N.controls.length){const Eb=N.controls[0];if(Eb.attributes&&!Eb.controlType&&Eb.enabled)return Eb.id}N.controls&&t.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}La.groups&&t.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}return null}m7i(){if(this.Rga.Bud()){this.Rga.Fze();var N=this.zdd();if(N&&0<N.count)for(let La of N)N=
{[Pd.a.I9]:La,[Pd.a.tP]:4,[Pd.a.hGa]:(new Date).getTime()},this.dna(N)}}dna(N){t.ULS.sendTraceTag(537170657,220,50,`Launch AddinCommands entitlements list, LaunchOperationType ${N[Pd.a.tP]}, DataProvider ${N[Pd.a.I9]}.`);this.Rga.Toj();window.setTimeout(()=>{if(void 0===this.re||null===this.re)t.ULS.sendTraceTag(537170656,220,10,`AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: ${Ph.a.i3()}`);else{const La=new wg(new Sg(this.re.Xh),lf.instance,
Ic.instance);La.fFg((Eb,kc)=>{this.XBb(kc.properties)});sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&La.AIg((Eb,kc)=>{null==kc?je.a.sendTelemetryEvent(Object(cc.a)(new Hf.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ze.a.Sj({["AppTeachingUICalloutAction"]:"InvalidEventArgs",["AppTeachingUICalloutGoal"]:"NewAdminDeployment",
["SDX.AppInstallOrigin"]:"Organization"})})):(this.TNb=new Pg(this),this.TNb.w9i(kc),Eb=this.$.Ka,null!=Eb&&(Eb.Bpe(this.Abf),t.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});La.aOj(N)}},0)}XBb(N){if(!this.disposed){t.ULS.sendTraceTag(537170655,220,50,`LaunchOperationType ${N[Pd.a.tP]}.`);try{if(z.EwaSettings.ma(186)){const Eb=N[Pd.a.Inb];if(Eb&&0<Eb.count){const kc=Eb.count;for(let Mc=kc-1;0<=Mc;Mc--){const kd=Eb.na(Mc);OSF.OsfControl.isFirstPartyStoreString(kd.storeType)||
Eb.remove(Eb.na(Mc))}if(Eb.count<kc){const Mc=jg.GetServiceTaskFactory.Sa(this.$.da,5,4,0);cf.TaskExtensions.Aa(Mc,()=>{Mc.result.Zf(36,null)},this.$.la,3)}if(!Eb.count)return}}if(void 0===this.re||null===this.re)t.ULS.sendTraceTag(537170654,220,10,`LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: ${Ph.a.i3()}`);else{var La=null;La=sd.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled")?new mc(this.Xo,this.$Ce,new Sg(this.re.Xh),new Eg(this.$.Cb,ae.a.n2),this.Rga,
lf.instance,this.Qga,(Eb,kc)=>{const Mc={};Mc.InstanceId=Pe.a.create().toString();Mc.PrimaryMarketplace={};Mc.PrimaryMarketplace.SolutionId=Eb.solutionId;Mc.PrimaryMarketplace.SolutionVersion=Eb.version;Mc.PrimaryMarketplace.MarketplaceType=Eb.storeType;Mc.PrimaryMarketplace.MarketplaceRef=Eb.storeId;Mc.WebExtensionType=1;this.re.WBj(Mc,()=>{kc(Eb)})}):new mc(this.Xo,this.$Ce,new Sg(this.re.Xh),new Eg(this.$.Cb,ae.a.n2),this.Rga,lf.instance,this.Qga);La.nFg(this.AGi);La.gFg(this.bOi);if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)){const Eb=new Pg(this);La.YGg(Eb.aOi);La.zIg(Eb.vzj)}this.$.da.za(53).cm&&Ff.a.get_instance().yk(5,null).continueWith(()=>{this.disposed||La.Ori(this.oad,this.$.domElement,N)})}}catch(Eb){t.ULS.sendTraceTag(537170653,220,10,`LaunchAddinCommands error message : ${Eb.message}.`)}}}Jid(N){const La=cf.TaskExtensions.ak();N=N[this.Xo.Sha];const Eb=this.q_b.OTc(N),kc=new Oh.a(this.$,this.re,Eb.ownerAddinInfo,La);return this.a6e(La,N,Eb,kc)}a6e(N,La,Eb,kc){this.q_b.Jid(La,this.Rga,kc,new Sg(this.re.Xh),
Eb,()=>{N=kc.O2g()},()=>{zg.g(this.$).focus()});return N}zOg(N){const La=cf.TaskExtensions.ak();var Eb=this.re.saa(N.solutionId);if(Eb){var kc=this.re.XY(Eb);if(Eh.HelperMethods.tw(kc)&&0!==kc.SharedRuntime.State)return}kc=this.q_b.AOg;const Mc=N.solutionId in kc?kc[N.solutionId]:null;if(Mc){const kd=this.q_b.OTc(Mc),rd=new Oh.a(this.$,this.re,kd.ownerAddinInfo,La),zd=Telemetry.PrivacyRules.GetPrivacyCompliantId(N.solutionId,null!==kd.ownerAddinInfo?kd.ownerAddinInfo.storeType:N.storeType,N.assetId,
null,null,N.storeId);kc=Od=>{if(Od){const Ud={};for(const Ne of Od)Ud[Ne[0]]=Ne[1];(Od=Pd.a.Jpe in Ud?Ud[Pd.a.Jpe]:null)&&"true"===Od.toLowerCase()&&(t.ULS.sendTraceTag(537170652,220,50,`Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${zd}.`),this.a6e(La,Mc,kd,rd))}};t.ULS.sendTraceTag(537170651,220,50,`Check Auto-Show AddinCommands TaskPane, StoreType ${N.storeType}, StoreId ${N.storeId}, SolutionId ${zd}.`);if(Eb)kc(this.re.XY(Eb).OsfPropertyBag);else if(Eb=
this.$.ea.workbookContext.WebExtensions)for(const Od of Eb)if((1===Od.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===N.targetType&&Od.PrimaryMarketplace.MarketplaceType.toLowerCase()===N.storeType.toLowerCase()&&Od.PrimaryMarketplace.MarketplaceRef.toLowerCase()===N.storeId.toLowerCase()&&Od.PrimaryMarketplace.SolutionId.toLowerCase()===N.solutionId.toLowerCase()){kc(Od.OsfPropertyBag);break}}}mWd(N,La,Eb=!1){N&&(!Eb||La||this.l6c.contains(N)||this.l6c.add(N),(Eb=
this.$1a.contains(N))&&La&&this.$1a.remove(N),Eb||La||this.$1a.add(N))}Gsj(N){if((N=N.JV)&&N.Vs)for(let La of N.Vs)if(La.groups)for(const Eb of La.groups)if(Eb.controls)for(const kc of Eb.controls)if(this.mWd(kc.id,kc.enabled,!0),1===kc.controlType&&kc.menuItems)for(const Mc of kc.menuItems)this.mWd(Mc.id,Mc.enabled,!0)}zdd(){const N=new l.a;z.EwaSettings.ma(53)&&(this.$.ea.Wg.get(27)&&(N.add(0),N.add(16)),this.$.ea.Wg.get(33)&&N.add(1),N.add(8));return N}executeDynamicAddInCommandsAPI(N){let La=
!0;if(void 0===N||null===N||void 0===N[Pd.a.btb]||null===N[Pd.a.btb])return mh.Task.Ta(!1);switch(N[Pd.a.btb]){case 1:La=this.gRj(N);break;case 2:La=this.Ksj(N);break;case 4:this.$1a.clear();this.$1a.addRange(this.l6c);break;case 3:La=this.installContextualTab(N);break;default:La=!1}return mh.Task.Ta(La)}xwj(N){return N&&this.Xo.Sha in N?(N=N[this.Xo.Sha])?this.$1a.contains(N):!1:!1}gRj(N){var La=null;let Eb=null,kc=null,Mc=!0;void 0!==N[Pd.a.E3]&&null!==N[Pd.a.E3]&&void 0!==N[this.Xo.Sha]&&null!==
N[this.Xo.Sha]&&void 0!==N[Pd.a.D3]&&null!==N[Pd.a.D3]&&(La=N[Pd.a.E3],Eb=N[Pd.a.I7b],kc=N[this.Xo.Sha],Mc=N[Pd.a.D3]);if(!La||!kc)return t.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;N=(new Fe.a(this.$.Cb,La,this.Xo,!0)).qKa(kc);La={DynamicAddinCommandsApiName:"UpdateControlEnableState"};La.AssetId=Eb;La.MaskedTabId=N;La.IsToEnable=Mc;t.ULS.sendTraceTag(537170648,220,50,w.a.kc(La));this.mWd(N,Mc);Gi.a.pC.updateCommandUI();return!0}Ksj(N){var La,
Eb,kc=null,Mc=null;let kd=null;var rd=null;let zd=!0;void 0!==N[Pd.a.T7c]&&null!==N[Pd.a.T7c]&&void 0!==N[Pd.a.E3]&&null!==N[Pd.a.E3]&&void 0!==N[this.Xo.Sha]&&null!==N[this.Xo.Sha]&&void 0!==N[Pd.a.D3]&&null!==N[Pd.a.D3]&&(kc=N[Pd.a.T7c],Mc=N[Pd.a.E3],kd=N[Pd.a.I7b],rd=N[this.Xo.Sha],zd=N[Pd.a.D3]);if(!kc||!Mc||!rd)return t.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;N=(new Fe.a(this.$.Cb,Mc,this.Xo,!0)).i4e(rd);rd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
rd.StoreType=kc;rd.AssetId=kd;rd.MaskedTabId=N;rd.IsToShow=zd;t.ULS.sendTraceTag(537170646,220,15,w.a.kc(rd));kc=this.Rga.Oia(kc,Mc,1);Mc=!1;if(null===(Eb=null===(La=null===kc||void 0===kc?void 0:kc.No)||void 0===La?void 0:La.JV)||void 0===Eb?0:Eb.Vs)for(let Od of kc.No.JV.Vs)if(Od.id===N){Mc=!0;break}if(!Mc)return t.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;La=[];zd?appChrome.selectors.getSelectedTabId()!==N&&La.push(appChrome.actions.activateRibbonTab(N)):
(appChrome.selectors.getSelectedTabId()===N&&La.push(appChrome.actions.setCurrentTab(ie.a.eW)),La.push(appChrome.actions.deactivateRibbonTab(N)));appChrome.api.dispatch(La);return!0}installContextualTab(N){let La=null,Eb=null,kc=null;var Mc=null;if(void 0!==N[Pd.a.E3]&&null!==N[Pd.a.E3]&&void 0!==N[Pd.a.D3]&&null!==N[Pd.a.D3]){const kd=N[Pd.a.D3];La=N[Pd.a.E3];void 0!==kd[Pd.a.UIa]&&null!==kd[Pd.a.UIa]&&void 0!==kd[Pd.a.VIa]&&null!==kd[Pd.a.VIa]&&(Eb=kd[Pd.a.UIa],kc=kd[Pd.a.VIa],Mc=kd[Pd.a.U7c])}if(!(La&&
kc&&Eb&&Mc))return t.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;N=this.Rga.Oia(Mc.PrimaryMarketplace.MarketplaceType,Mc.PrimaryMarketplace.SolutionId,1);if(null===N||void 0===N?0:N.No)return t.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;N={};N.solutionId=Mc.PrimaryMarketplace.SolutionId;N.version=Mc.PrimaryMarketplace.SolutionVersion;N.storeType=Mc.PrimaryMarketplace.MarketplaceType;N.storeId=Mc.PrimaryMarketplace.MarketplaceRef;
N.assetId=Mc.PrimaryMarketplace.SolutionId;N.assetStoreId=Mc.PrimaryMarketplace.MarketplaceRef;N.targetType=Mc.WebExtensionOsfControlType;N.width=Mc.TaskpaneWidth;N.height=0;N.isAddinCommands=!0;Mc=new l.a;Mc.add(N);N={};N[Pd.a.Inb]=Mc;N[Pd.a.tP]=6;N[Pd.a.UIa]=Eb;N[Pd.a.VIa]=kc;this.XBb(N);return!0}}Object(e.a)(Hi,"AddinUICommandHandler",null,[166,164,10]);var Wi=a(62),Ii=a(601),Xi=a(18),Ji=a(16);class di extends Xd.a{constructor(N){super(N);this.handler=null;this.SAg=()=>{t.ULS.sendTraceTag(38410434,
0,50,`AddinUICommandHandlerFactory.ActivateFeature, isEditMode [${this.$.isEditMode}] ShowCommandUI [${!!(this.$.Cd&16384)}]`);const La=new Id.a;this.$.da.Za(53,Ud=>{t.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");La.setResult(Ud)});const Eb=La.task,kc=new Bc,Mc=Zc.a.getInstance(),kd=new Yd(this.$,Mc),rd=jg.GetServiceTaskFactory.create(this.$.da,203,this.la,this.fb),zd=this.Y7i(kc),Od=jg.GetServiceTaskFactory.Sa(this.$.da,349,
350,this.fb);return cf.TaskExtensions.Aa(cf.TaskExtensions.Td([Eb,rd,zd,Od],this.la),()=>{t.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(this.$.da,106,this.la,this.fb),Ud=>{this.handler=new Hi(this.$,Ud.result,kc,new id,Mc,kd,Ed.a.instance.yh("Common.IExternalUICommandDefinitionMapping"));t.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");
this.$c([this.handler]);this.$.da.Ga(198,this.handler)},this.la,3)},this.la,3)};this.fdh=()=>{void 0!==this.handler&&null!==this.handler?(this.$.Ka.Dbb(this.handler),this.$.da.nU(198),this.handler=null):t.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");this.$.da.nU(204);Ji.a(Xi.a,21,this.$.da,198)}}vd(){t.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");Wi.a(this.$).add(Object(cc.a)(new Ii.a,
{Dxc:()=>{const N=this.$.ea.HF&&this.$.ea.fc&&!!(this.$.Cd&16384)&&this.$.isEditMode;this.$.ea.fc&&t.ULS.sendTraceTag(38410433,0,50,`AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [${N}] IsSessionFullyLoaded [${this.$.ea.HF}] IsSessionActive [${this.$.ea.fc}] ShowCommandUI [${!!(this.$.Cd&16384)}] IsEditMode [${this.$.isEditMode}]`);return N},BYb:this.SAg,a6b:this.fdh,a3a:2}))}Y7i(N){const La=jg.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb);
return cf.TaskExtensions.Aa(La,()=>{t.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");this.$.da.Ga(204,new xf(La.result,N))},this.la,3)}static ka(N){Xd.a.Od(199,new di(N))}}Object(e.a)(di,"AddinUICommandHandlerFactory",Xd.a,[]);var ei=a(1188),fi=a(1192),Qh=a(699);class wi extends k.a{constructor(N){super();this.$=N;this.Eb()}create(){let N;if(z.EwaSettings.ma(400)){const La=jg.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.fb),Eb=jg.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.fb);cf.TaskExtensions.Aa(mh.Task.XI(La,Eb),()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?this.pb(Object(Qh.a)(this.$.da,278,()=>new ei.CustomFunctionsInstaller(this.$,La.result,Eb.result))):this.pb(this.$.da.za(278)||new ei.CustomFunctionsInstaller(this.$,La.result,Eb.result))},this.$.la,3)}else z.EwaSettings.isChangeGateEnabled("OfficeVSO:6894126_FAMServiceRegistrationFixes")?
N=Object(Qh.c)(this.$.da,278,()=>new fi.CustomFunctionsLegacyInstaller(this.$)):(N=this.$.da.za(278))||(N=this.$.da.Ga(278,new fi.CustomFunctionsLegacyInstaller(this.$))),this.pb(N)}static ka(N){N.da.Ga(279,new wi(N))}}Object(e.a)(wi,"CustomFunctionsInstallerFactory",k.a,[]);var xi=a(86),Fh=a(47),dh=a(45);class gi{constructor(N,La){this.tQa=this.uQa=null;this.lbg=(Eb,kc)=>{let Mc=null,kd=null,rd=null;kc?(Object(Q.a)(405,kc)?(Mc=kc.pGa,rd=kc.instanceId):Object(Q.a)(607,kc)&&(Mc=kc.get_element(),rd=
kc.instanceId),Mc)?(kd=Object(O.a)(750,Eb),kd)?this.bOf(rd,Mc,kd)||rd in this.tQa||(this.uQa[rd]=0,this.tQa[rd]=Fh.a.instance.WE(()=>{10<=this.uQa[rd]||this.bOf(rd,Mc,kd)?(delete this.uQa[rd],this.tQa[rd].dispose(),delete this.tQa[rd]):this.uQa[rd]+=1},500,dh.a.TJg,!0,!1)):t.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):t.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):t.ULS.sendTraceTag(537170626,
0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=N;this.$=La;this.UXc=!1;this.$.da.Ga(224,this)}ka(N){this.UXc?t.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.UXc=!0,this.tQa={},this.uQa={},N?N.RFg(this.lbg):t.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))}detach(N){if(N){N.ebj(this.lbg);N=this.tQa;for(let La in N)xi.a.Ia(N[La]);this.uQa=this.tQa=
null;this.UXc=!1}else t.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")}bOf(N,La,Eb){if(this.Nei(Eb,N))return!1;N=La.querySelector("iframe");if(!N)return t.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;N=N.title;if(!N||!N.length)return t.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(N);
return!0}Nei(N,La){return(N=N.Xh.getOsfControl(La))?N.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0}}Object(e.a)(gi,"AgaveOnSelectedReadoutHandler",null,[751]);class Rh extends k.a{constructor(N){super();this.$=N;this.Eb()}create(){const N=this.$.da;cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.Sa(N,211,212,this.fb),La=>{La=N.za(224)||new gi(La.result,this.$);this.pb(La)},this.la,3)}static ka(N){N.da.Ga(225,new Rh(N))}}Object(e.a)(Rh,"AgaveOnSelectedReadoutHandlerFactory",k.a,[]);var sg=a(735),
hi=a(53);const nh=(N,La)=>hi.a.xud(66,()=>window.OfficeExtension&&!!window.OfficeExtension.WacRuntime,sd.AFrameworkApplication.fa.qd("MaxRetriesForLoadingScript",0),N,La);var Ki=a(238);class Sh{constructor(N,La,Eb){this.iframe=N;this.onSuccess=La;this.onError=Eb;$addHandler(window,"message",Object(nd.a)(this,this.k7e,"handleResponse"))}k7e(N){try{if(N&&N.rawEvent&&N.rawEvent.origin&&this.iframe&&this.iframe.id){var La=this.AHf(N.rawEvent.origin);const Eb=this.AHf(document.domain);if(R.a.Zk().equals(Eb,
La))if(N.rawEvent.source&&N.rawEvent.source.frameElement&&N.rawEvent.source.frameElement.id&&R.a.Zk().equals(N.rawEvent.source.frameElement.id,this.iframe.id)){La=null;try{La=JSON.parse(N.rawEvent.data)}catch(kc){t.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",kc.message)}La?(La.statusCode!==Ki.a.VO||void 0!==La.error&&La.error?(t.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
La.statusCode,La.error),this.onError()):(t.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(La.authorizationCode?La.authorizationCode:La.signInUrl)),$removeHandler(window,"message",Object(nd.a)(this,this.k7e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):t.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):t.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):t.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else t.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else t.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else t.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Eb){t.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",Eb.message)}}AHf(N){let La="";try{N&&(La=-1<N.indexOf("//")?N.split("/")[2]:N.split("/")[0])&&(La=La.split(":")[0],La=La.split("?")[0])}catch(Eb){t.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Eb.message)}return La}static ka(N,La,Eb){new Sh(N,La,Eb)}}Object(e.a)(Sh,"ResponseHandler",null,[]);var dd=a(251);class Jd{constructor(N){this.BFa=N}tryAuthenticate(N,La){this.kab(Jd.Hrg,()=>{N()},La)}tryAuthorize(N,
La){this.kab(Jd.Pmg,N,La)}getSignInUrl(N,La){this.kab(Jd.mie,N,La)}signOut(N,La){this.kab(Jd.Jxg,N,La)}kab(N,La,Eb){var kc=new dd.QueryStringBuilder("AuthenticationProxyHandler.aspx");kc.Zi("responseType",N);sd.AFrameworkApplication.SYa(kc);kc=String.format("{0}{1}&{2}",this.BFa,kc.toString(),sd.AFrameworkApplication.qj);const Mc=document.createElement("iframe");Mc.setAttribute("id","privateCatalogIframe");Mc.setAttribute("name","privateCatalogIframe");Mc.setAttribute("style","display: none");R.a.Zk().equals(N,
Jd.mie)||Mc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Sh.ka(Mc,La,Eb);Mc.setAttribute("src",kc);document.body.appendChild(Mc)}}Jd.Pmg="authcode";Jd.Hrg="identitytoken";Jd.mie="signinurl";Jd.Jxg="signout";Object(e.a)(Jd,"AuthenticationProxy",null,[]);class Lf{}Lf.getUserId="getUserId";Lf.getLastStoreUpdate="laststoreupdate";Lf.getEntitlement="getEntitlements";Lf.getEToken="getEToken";Lf.getManifest="getManifest";Lf.getAppState="getAppState";
Lf.getKilledApps="getRemovedAddins";Lf.getAppDetails="getAppDetails";Lf.removeApps="removeAddin";Lf.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Lf.getPrivateCatalogAddIns="getAddIns";Lf.getPrivateCatalogManifests="getAppManifests";Lf.isStoreDisabled="isStoreDisabled";Object(e.a)(Lf,"S2SWebRequestActions",null,[]);var Yi=a(578);class zh{getUserId(N,La){const Eb=new l.a;Eb.add(new ya.a("corr",N));this.BW(Lf.getUserId,Eb,1,La)}getLastStoreUpdate(N,La,Eb){const kc=new l.a;kc.add(new ya.a("lc",
N));kc.add(new ya.a("corr",La));this.BW(Lf.getLastStoreUpdate,kc,1,Eb)}getEntitlement(N,La,Eb,kc){N=new l.a;N.add(new ya.a("av",La));N.add(new ya.a("corr",Eb));this.BW(Lf.getEntitlement,N,1,kc)}getEToken(N,La,Eb,kc,Mc,kd){const rd=new l.a;rd.add(new ya.a("cmu",N));rd.add(new ya.a("cmf",La));rd.add(new ya.a("assetid",Eb));rd.add(new ya.a("expver",kc));rd.add(new ya.a("corr",Mc));this.BW(Lf.getEToken,rd,1,kd)}getManifest(N,La,Eb,kc){const Mc=new l.a;Mc.add(new ya.a("cmu",N));Mc.add(new ya.a("assetid",
La));Mc.add(new ya.a("corr",Eb));this.BW(Lf.getManifest,Mc,1,kc)}getAppState(N,La,Eb){const kc=new l.a;kc.add(new ya.a("ma",N));kc.add(new ya.a("corr",La));this.BW(Lf.getAppState,kc,1,Eb)}getKilledApps(N,La){const Eb=new l.a;Eb.add(new ya.a("corr",N));this.BW(Lf.getKilledApps,Eb,1,La)}getAppDetails(N,La,Eb,kc){const Mc=new l.a;Mc.add(new ya.a("cmo",N));Mc.add(new ya.a("corr",Eb));this.sendWithBody(Lf.getAppDetails,Mc,La,2,kc,!1)}removeApps(N,La,Eb){const kc=new l.a;kc.add(new ya.a("corr",La));this.sendWithBody(Lf.removeApps,
kc,N,2,Eb,!1)}getLastPrivateCatalogUpdate(N,La,Eb,kc,Mc,kd){const rd=new l.a;rd.add(new ya.a("catalog","privatecatalog"));rd.add(new ya.a("clientCode",N));rd.add(new ya.a("clientVersion",La));rd.add(new ya.a("corr",Mc));N=String.format("authorizationCode={0}&refreshToken={1}",Eb?vf.a.mf(Eb):"",kc?vf.a.mf(kc):"");this.sendWithBody(Lf.getLastPrivateCatalogUpdate,rd,N,2,kd,!0)}getPrivateCatalogAddIns(N,La,Eb,kc,Mc,kd){const rd=new l.a;rd.add(new ya.a("catalog","privatecatalog"));rd.add(new ya.a("clientCode",
N));rd.add(new ya.a("clientVersion",La));rd.add(new ya.a("corr",Mc));N=String.format("authorizationCode={0}&refreshToken={1}",Eb?vf.a.mf(Eb):"",kc?vf.a.mf(kc):"");this.sendWithBody(Lf.getPrivateCatalogAddIns,rd,N,2,kd,!0)}getPrivateCatalogManifests(N,La,Eb,kc,Mc){const kd=new l.a;kd.add(new ya.a("catalog","privatecatalog"));kd.add(new ya.a("corr",kc));N=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",vf.a.mf(N),La?vf.a.mf(La):"",Eb?vf.a.mf(Eb):"");this.sendWithBody(Lf.getPrivateCatalogManifests,
kd,N,2,Mc,!0)}isStoreDisabled(N,La){const Eb=new l.a;Eb.add(new ya.a("corr",N));this.BW(Lf.isStoreDisabled,Eb,2,La)}BW(N,La,Eb,kc){this.sendWithBody(N,La,null,Eb,kc,!1)}sendWithBody(N,La,Eb,kc,Mc,kd){const rd=new dd.QueryStringBuilder("AddinServiceHandler.ashx");rd.Zi("action",N);rd.Zi("app",Yi.a[sd.AFrameworkApplication.ta.Oa.Dj]);for(let zd of La)rd.Zi(zd.key,zd.value);La=String.format("{0}{1}&{2}",sd.AFrameworkApplication.ta.Oa.AV,rd.toString(),sd.AFrameworkApplication.qj);sd.AFrameworkApplication.yd.Jm(La,
kc,Eb,null,!1,2,zd=>{let Od=null,Ud=null;zd&&zd.data&&(zd.data.responseHeaders["X-BlockedForMinor"]&&"1"===zd.data.responseHeaders["X-BlockedForMinor"].toString()&&(zd.data.httpStatus=451),Od=zd.data.Xd,Ud=zd.data.responseHeaders);Mc(zd.data.httpStatus,Od,Ud)},zd=>{var Od=null;let Ud=null;kd&&zd&&zd.data&&zd.data.Xd&&(Od=zd.data.Xd,Ud=zd.data.responseHeaders);Mc(zd.data.httpStatus,Od,Ud);if(sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",
!0)){Od={message:"AddinServiceHandler request failed"};Od.code=zd.data.httpStatus;Od.action=N;if(zd.data.request||zd.data.request.get_headers())Od["X-UserSessionId"]=zd.data.request.get_headers()["X-UserSessionId"];408===zd.data.httpStatus||503===zd.data.httpStatus?t.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Od)):t.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Od))}else t.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",zd.data.httpStatus)},null,void 0,void 0,void 0,void 0,
"AddinServiceHandler_"+N,void 0,void 0,void 0,void 0,["X-UserKey"])}}Object(e.a)(zh,"S2SWebRequestManager",null,[]);class ii extends k.a{constructor(N){super();this.aOf=this.ddaFacade=null;this.$=N;N.da.Ga(106,this);this.Eb()}get re(){return this.ddaFacade||(this.ddaFacade=new sg.DdaFacade(this.$,this.aOf))}create(){t.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");sd.AFrameworkApplication.disableWholeAppsForOfficeFeature?t.ULS.sendTraceTag(537170506,0,50,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [${sd.AFrameworkApplication.disableWholeAppsForOfficeFeature}]`):
z.EwaSettings.ma(404)?Ed.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(N=>{N.isFeatureEnabled("mso_officeStore",!0).then(La=>{sg.DdaFacade.h4b=La;this.jFe();return null})}):this.jFe()}jFe(){const N=jg.GetServiceTaskFactory.Sa(this.$.da,224,225,this.fb),La=hi.a.xud(65,()=>!(void 0===window.OSF||null===window.OSF),this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.fb,106),Eb=nh(this.la,this.fb);cf.TaskExtensions.Aa(cf.TaskExtensions.Td([N,La,Eb],this.$.la),
()=>{"undefined"===typeof OfficeExt||"undefined"===typeof OSF?t.ULS.sendTraceTag(537170505,0,15,`DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: ${Ph.a.i3()}`):this.l$h();t.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");this.aOf=N.result;this.pb(this.re);t.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)}l$h(){z.EwaSettings.ma(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new zh);
this.$.pe.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new zh,new Jd(sd.AFrameworkApplication.fa.appSettings.WebServiceBase),z.EwaSettings.ma(71),z.EwaSettings.ma(431));OfficeExt.MosRequestHandler.init&&OfficeExt.MosRequestHandler.init(new zh);OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new zh)}dispose(){xi.a.Ia(this.ddaFacade);this.$=this.ddaFacade=null;super.dispose()}static ka(N){new ii(N)}}Object(e.a)(ii,"DdaFacadeServiceFactory",
k.a,[]);var ji=a(457);class Th{constructor(N,La,Eb,kc,Mc,kd){this.$=N;this.agaveCommandManager=kd}Oc(){return!1}Lc(){return!1}Ac(N,La,Eb,kc){let Mc=!1;switch(La.command){case -684355545:Mc=!0;break;case -741808261:Mc=!!Eb;break;case -859308420:Mc=!!kc&&1===kc.$y;break;case 418618014:Mc=1===N&&!!kc&&1===kc.$y;break;case -515602470:La=z.EwaSettings.ma(234)&&2===N;Mc=(1===N||La)&&!!kc&&1===kc.$y;break;case 2086613372:Mc=z.EwaSettings.ma(234)&&2===N&&!!kc&&1===kc.$y;break;case -1336341324:Mc=z.EwaSettings.ma(479)&&
1===N&&!!kc&&1===kc.$y;break;case 451940422:Mc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AnalyzeDataInAutoFilter",!1)&&1===N&&!!kc&&1===kc.$y;break;case -1444574190:case -336193495:Mc=1===N&&!!kc&&1===kc.$y;break;case 1296389134:Mc=1===N&&!!kc&&1===kc.$y;break;case -1473679467:Mc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===N&&!!kc&&1===kc.$y;break;case 1221897806:Mc=z.EwaSettings.ma(166)&&2===N;break;case 1172793074:case 1930653487:Mc=
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===N;break;case -1753056834:Mc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Mc=!0;break;case 301511274:Mc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Mc=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Mc=this.$.isEditMode&&
this.$.ea.ZLb}return Mc}executeCommand(N,La,Eb){let kc=cf.TaskExtensions.ak();const Mc=La.command;switch(La.command){case -1473679467:ji.a(this.$,488,489,1,kd=>{kc=kd.ici(Eb.SourceControlId,La)});break;case 1296389134:this.agaveCommandManager.SEj(Eb.SourceControlId,Eb.LabelText);break;case -684355545:this.agaveCommandManager.p_c();break;case -741808261:kc=this.agaveCommandManager.insertAgave(Eb,La);ji.a(this.$,488,489,1,kd=>{kd.tBg(Eb)});break;case -1336341324:z.EwaSettings.ma(479)&&(kc=this.agaveCommandManager.Wid(Eb,
N,La));break;case 1172793074:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(kc=this.agaveCommandManager.Wid(Eb,N,La));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 451940422:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:kc=this.agaveCommandManager.Wid(Eb,N,La);break;default:kc=ci.a(Mc)}return kc}}Object(e.a)(Th,"AgaveCommandHandler",null,
[164]);class Li{}Object(e.a)(Li,"Selection",null,[]);var yi=a(1295),wh=a(1294),zi=a(1296),Ng=a(1386),Mi=a(1297);class Gh{}Object(e.a)(Gh,"SmartLookupApplicationInterface",null,[]);class ki{}Object(e.a)(ki,"ApplicationProperties",null,[]);class Hh{}Object(e.a)(Hh,"EnterpriseUserInfo",null,[]);class ng{}Object(e.a)(ng,"FeatureGates",null,[]);class xh{constructor(N,La,Eb=!0){this.QKj=9E5;this.TKj=3E5;this.$vd=null;this.$of="";this.Xvd=0;this.nsb=Date.now;this.dya=N;this.X8a=La;Eb&&this.wdd()}eYh(){const N=
this.nsb();if(N<this.Xvd+this.QKj)return N>this.Xvd+this.TKj&&this.wdd(),this.$of;this.wdd();return""}wdd(){this.$vd=this.$vd||new Promise(N=>{this.fYh().then(La=>{this.$of=La;this.Xvd=this.nsb();this.$vd=null;N(La)})})}fYh(){return this.X8a&&this.X8a.length?new Promise(N=>{this.dya.CL("SmartLookup",this.X8a).then(La=>{La.IsSuccess?La.Token||(N(""),t.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(t.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
La.ErrorCode+": "+La.ErrorMessage),N(""));N(La.Token)}).catch(La=>{La=oe.c(La);t.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+La);N("")})}):(t.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))}}Object(e.a)(xh,"SmartLookupAuthenticationManager",null,[227]);class li{static mOh(){switch(Object(O.a)(String,sd.AFrameworkApplication.Mb.AudienceGroup)||""){case "Dogfood":if(sd.AFrameworkApplication.fa){let N=
sd.AFrameworkApplication.fa.Xa("UserPrincipalName");N=vf.a.sl(N);const La=sd.AFrameworkApplication.fa.wo("SmartLookupINTEnabledForSKITeam")?sd.AFrameworkApplication.fa.ow("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(La,N)?"INT":"EDOG"}return"EDOG";default:return"PROD"}}static EXh(){switch(sd.AFrameworkApplication.fa.qa("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":sd.AFrameworkApplication.fa.qa("IntentSvcEnableProdSourceLocationOverride")?"PROD":sd.AFrameworkApplication.fa.qa("IntentSvcEnableIntSourceLocationOverride")?
"INT":li.mOh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}}Object(e.a)(li,"Utils",null,[]);var qh=a(558),Uh=a(173);class yh{constructor(N){t.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Ipf=sd.AFrameworkApplication.fa.qa("IsTellMeUpSellEnterpriseEnabled");
this.wxi=sd.AFrameworkApplication.fa.Xa("SmartLookupApprovedOriginPattern");this.X8a=sd.AFrameworkApplication.fa.Xa("SmartLookupShredderServiceEndpoint");this.ayi=bg.a.TM(sd.AFrameworkApplication.fa.Xa("AppCatalogUrl")||"");this.W8a=new ng;this.W8a.EnableAllTabV2=!0;this.W8a.EnableIntentService=!0;this.W8a.EnableInDocumentSearch=sd.AFrameworkApplication.fa.qa("SmartLookupEnableInDocumentSearch");this.W8a.EnableLocalSearch=sd.AFrameworkApplication.fa.qa("SmartLookupEnableLocalSearch");this.W8a.IntentServiceEndpoint=
li.EXh();this.Wxi=new xh(N,this.X8a)}get approvedOriginPattern(){return this.wxi}RIh(){return Promise.resolve(this.SIh())}SIh(){const N=new ki;N.anid="";N.applicationVersion=sd.AFrameworkApplication.buildVersion;N.appCorrelationId=Uh.a.create().toString();N.themePlatform=yh.$Wj;N.lcid=sd.AFrameworkApplication.lcid;N.launchUtcTime=(new Date).toUTCString();N.featureGates=this.W8a;var La=qh.a.fK(sd.AFrameworkApplication.lcid);La=La?La.name:null;N.market=this.Nac(La);N.uiLanguage=La;N.sessionId=sd.AFrameworkApplication.userSessionId;
N.themeId=0;N.parentalControl=yh.GWi;const Eb=new Hh;Eb.CountryCode=this.Nac(La);Eb.ServiceEndpoint=this.X8a;Eb.IsGoLocal=!1;Eb.IsEnabled=this.Ipf;Eb.IsEnterpriseEnabled=this.Ipf;Eb.TenantRoot=this.ayi;N.enterpriseUserInfo=Eb;N.accessToken=this.Wxi.eYh();return N}Nac(N){N=N.split("-");return N[N.length-1]}}yh.$Wj="web";yh.GWi="yes";Object(e.a)(yh,"SmartLookupManager",null,[201]);class Ug extends Pc.a{constructor(N){super();this.$=N;this.isFirstLaunch=!1}Oc(){return!1}Lc(){return!1}Ac(N,La){N=z.EwaSettings.ma(134);
return-983891024===La.command&&N}executeCommand(N,La){N=cf.TaskExtensions.ak();-983891024===La.command&&this.wri();return N}wri(){var N=new yh(null);const La={};var Eb=zg.g(this.$).Vb(null).originalText;Eb=Object(cc.a)(new Li,{neighborhood:Eb,mentionStart:0,mentionLength:Eb?Eb.length:0});const kc=Object(cc.a)(new Gh,{selection:Eb,entryPoint:0});N.RIh().then(kd=>{kd.applicationName=Ug.appName;kd.isFirstLaunch=this.isFirstLaunch;kd.themeId=5;La[Ug.smartLookupApplicationInterface]=JSON.stringify(kc);
La[Ug.iLg]=JSON.stringify(kd);this.isFirstLaunch=!1});N=new yi.a("ExcelOnline","Web","en-Us");Eb=new wh.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");const Mc=new zi.a;Mc.optionalProperties[Ng.a.Ui]=vd.a.instance.ga(1808);Mc.optionalProperties[Ng.a.taskPaneWidth]=350;Mc.optionalProperties[Ng.a.sourceLocationOverrideResourceId]="WAC.PROD.URL";Mc.$g=La;Mi.a.instance.fla(Eb,"Taskpane","SmartLookupSDXTaskpane",N,Mc)}}Ug.iLg="AppProperties";Ug.appName="Excel";Ug.smartLookupApplicationInterface=
"SmartLookupApplicationInterface";Object(e.a)(Ug,"SmartLookupCommandHandler",Pc.a,[164]);class Ih extends Xd.a{constructor(N){super(N)}vd(){ji.a(this.$,374,375,this.fb,N=>{this.$c([new Th(this.$,null,null,null,null,N),new Ug(this.$)])})}static ka(N){Xd.a.Od(76,new Ih(N))}}Object(e.a)(Ih,"AgaveCommandHandlerFactory",Xd.a,[]);var hf=a(1310),eh=a(106);class yg{constructor(){this.re=null;this.Uab=(N,La,Eb,kc,Mc)=>{if(2===Eb){N=Mc?Mc:{};La=N.callback;Eb=N.refresh?N.refresh:!1;if(!La)return 16;sd.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType")&&
null!=N.storeType?this.re.ALf(La,Eb,N.storeType):this.re.Xca(La,Eb)}return 32};this.X8i=(N,La,Eb,kc,Mc)=>{2===Eb&&(N=Mc?Mc.callback:null)&&this.re.QFg(N);return 32};this.hci=(N,La,Eb,kc,Mc)=>{2===Eb&&this.re.dCd(null,OSF.AgaveHostAction.InsertAgave,Mc);return 32}}initialize(N){yg.initialized||(this.re=N,this.Ig(),yg.initialized=!0)}Ig(){sd.AFrameworkApplication.vb.Le(ae.a.Uab,eh.a.frame,this.Uab,96);sd.AFrameworkApplication.vb.Nb(ae.a.N7i,eh.a.frame,this.X8i);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterInsertOfficeAddinCommand",
!1)&&sd.AFrameworkApplication.vb.Le(ae.a.xbf,eh.a.frame,this.hci,96)}static get instance(){yg.Ma||(yg.Ma=new yg);return yg.Ma}}yg.Ma=null;yg.initialized=!1;Object(e.a)(yg,"AgaveCommandActor",null,[]);var dg=a(1352),Qg=a(1299),Jh=a(111),Kh=a(352),Ni=a(349),Ai=a(1234),Cg=a(19),Bi=a(344);class mi{constructor(){this.CWd=this.oAc=null;this.oq=0;this.mAc=null}}Object(e.a)(mi,"FirstPartyAddinTaskpaneOverrides",null,[]);class Lh{constructor(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=
null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}}Object(e.a)(Lh,"IdeasSelectionContext",null,[]);class Oi extends Lh{constructor(){super();this.hasTableHeaders=this.isPivotTable=this.isTable=!1;this.tableName=null;this.userSelectedPivotTable=!1}}Object(e.a)(Oi,"IdeasTableSelectionContext",Lh,[]);class Pi{constructor(){this.sheetName=null;this.lastRow=this.firstRow=this.lastColumn=this.firstColumn=0}}Object(e.a)(Pi,"AutoFilterRange",
null,[]);class Ci{constructor(){this.autoFilterType=this.autoFilterRange=null;this.id=this.itemIndex=0}}Object(e.a)(Ci,"IdeasAutoFilterSource",null,[]);class ni{constructor(N,La){this.selection=N;this.tables=La}}Object(e.a)(ni,"IdeasXLIMTableBoundaries",null,[]);var Hg=a(61);const Qi=(N,La,Eb,kc,Mc,kd,rd=null)=>{rd=N.Na(9,rd);rd.sharedInfo=La;return Hg.g(N,"ShowAgaveTaskpane",rd,Eb,kc,Mc,kd,0)};var Vg=a(858),Wg=a(65),Di=a(132),vh=a(43),oi=a(515),Ah=a(370),Bh=a(171),Ri=a(162),Si=a(567),Of=a(281),kg=
a(104),Ti=a(133),Ei=a(51),pi=a(144),jh=a(180);class th extends pi.a{constructor(){super();this.$ea="calc(100% - 46px)";this.dDa="15px";this.afa="0";this.bIc="WACDialogPanel";this.uX=695;this.cIc=462;this.Spa="80%";this.RFc=350;this.Ngb="100%";this.Rb=5;this.Ce="AppsForOfficeInsertionDialog";this.oIc=!!sd.AFrameworkApplication.fa&&sd.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}Rz(){super.Rz();this.Sk.style.width=this.Ngb;this.Sk.style.height=this.$ea;this.Sk.style.marginTop=
this.dDa;this.Sk.style.padding=this.afa}Mza(){this.Sk.style.width=this.Ngb;this.Sk.style.height=this.$ea;this.Sk.style.marginTop=this.dDa;this.Sk.style.padding=this.afa;this.uX>jh.a.rma?(this.wb.style.width=String.format("{0}px",jh.a.rma),this.wb.style.overflowX="scroll",sd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.uX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>jh.a.qma||this.cIc+50>jh.a.qma?(this.wb.style.height=
String.format("{0}px",jh.a.qma),this.wb.style.overflowY="scroll",this.wb.style.top="0",sd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.oIc||(this.wb.style.marginTop="-48px"),this.Sk.style.minHeight=String.format("{0}px",this.RFc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.Spa);this.Msa()}Msa(){if(this.wb){var N=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.uX>jh.a.rma)sd.AFrameworkApplication.isRtl?this.wb.style.marginRight=
"0":this.wb.style.marginLeft="0";else{const La=String.format("{0}px",Math.floor(-this.wb.offsetWidth/2));sd.AFrameworkApplication.isRtl?this.wb.style.marginRight=La:this.wb.style.marginLeft=La;sd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(N)}else t.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}HI(){super.HI();const N=document.getElementById(this.ni(this.bIc));N.style.width=String.format("{0}px",this.uX);
N.style.height=this.Spa}get Tta(){return this.Sk}}Object(e.a)(th,"AppsForOfficeInsertionDialog",pi.a,[357]);class Ui extends pi.a{constructor(){super();this.$ea="calc(100% - 46px)";this.dDa="15px";this.afa="0";this.bIc="WACDialogPanel";this.uX=695;this.cIc=462;this.Spa="80%";this.RFc=350;this.Ngb="100%";this.Rb=5;this.Ce="SDXDialog"}Rz(){super.Rz();this.Sk.style.width=this.Ngb;this.Sk.style.height=this.$ea;this.Sk.style.marginTop=this.dDa;this.Sk.style.padding=this.afa}Mza(){this.Sk.style.width=this.Ngb;
this.Sk.style.height=this.$ea;this.Sk.style.marginTop=this.dDa;this.Sk.style.padding=this.afa;this.uX>jh.a.rma?(this.wb.style.width=String.format("{0}px",jh.a.rma),this.wb.style.overflowX="scroll",sd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0"):(this.wb.style.width=String.format("{0}px",this.uX),this.wb.style.overflowX="hidden");this.wb.offsetHeight>jh.a.qma||this.cIc+50>jh.a.qma?(this.wb.style.height=String.format("{0}px",jh.a.qma),this.wb.style.overflowY="scroll",
this.wb.style.top="0",sd.AFrameworkApplication.isRtl?this.wb.style.right="0":this.wb.style.left="0",this.Sk.style.minHeight=String.format("{0}px",this.RFc)):(this.wb.style.overflowY="hidden",this.wb.style.top="10%",this.wb.style.height=this.Spa);this.Msa()}Msa(){if(this.wb){var N=this.wb.style.zIndex;this.wb.style.zIndex="-9999";if(this.uX>jh.a.rma)sd.AFrameworkApplication.isRtl?this.wb.style.marginRight="0":this.wb.style.marginLeft="0";else{const La=String.format("{0}px",Math.floor(-this.wb.offsetWidth/
2));sd.AFrameworkApplication.isRtl?this.wb.style.marginRight=La:this.wb.style.marginLeft=La;sd.AFrameworkApplication.isRtl?this.wb.style.right="50%":this.wb.style.left="50%"}this.wb.style.zIndex=String(N)}else t.ULS.sendTraceTag(524892188,306,10,"_divMessageBox is null in CenterDialog()")}HI(){super.HI();const N=document.getElementById(this.ni(this.bIc));N.style.width=String.format("{0}px",this.uX);N.style.height=this.Spa}get Tta(){return this.Sk}}Object(e.a)(Ui,"SDXDialog",pi.a,[]);var Xg=a(962),
uh=a(172),qi=a(576),ri;(function(N){N[N.Valid=2]="Valid";N[N.Invalid=4]="Invalid";N[N.All=6]="All"})(ri||(ri={}));Object(e.b)("MetadataState",ri);var Vi=a(341);class sf extends Pc.a{constructor(N,La,Eb,kc,Mc){super();this.OAa={};this.wbd={};this.yza=this.sdxDialog=this.Awa=null;this.wbb=!1;this.q3h=(kd,rd,zd,Od,Ud)=>{if(2!==zd)return 32;kd=Ud[Xg.a.Vtb];rd=Ud[Xg.a.d3];zd=Ud[Xg.a.I_];Ud=new dg.a;Ud.lfc=zd.optionalProperties.InstanceToken;Ud.sourceLocationOverrideResourceId=zd.optionalProperties[Ng.a.sourceLocationOverrideResourceId];
Ud.wB=zd.$g;Ud.d3=rd;rd=null!=Ud.lfc?Ud.lfc:(new Pe.a(Uh.a.create(),1)).toString();zd=null!=Ud.wB?Ud.wB:{};Od={};Od.id=rd;Od.solutionId=kd.getId();Od.version=kd.GCa;Od.storeType=kd.getStoreType();Od.storeId=kd.getStoreId();Od.assetId=null;Od.assetStoreId=null;Od.settings=zd;Od.reason=Microsoft.Office.WebExtension.InitializationReason.Inserted;Od.osfControlType=OSF.OsfControlType.ContainerLevel;Od.sourceLocationOverrideResourceId=Ud.sourceLocationOverrideResourceId;Od.featureGates=sd.AFrameworkApplication.fa.j_e(kd.getId());
this.Rjc(Ud,Od);return 32};this.Rjc=(kd,rd)=>{this.sdxDialog=new Ui;this.sdxDialog.initializeAndShow("",null,null);rd.div=this.sdxDialog.Tta;kd={};kd.InstanceId=rd.id;kd.WebExtensionType=2;kd.PrimaryMarketplace={};kd.PrimaryMarketplace.SolutionId=rd.solutionId;kd.PrimaryMarketplace.MarketplaceType=rd.storeType;kd.PrimaryMarketplace.MarketplaceRef=rd.storeId;kd.PrimaryMarketplace.SolutionVersion=rd.version;kd.SrcLocationOverrideResourceId=rd.sourceLocationOverrideResourceId;kd.WebExtensionOsfControlType=
6;this.OAa[rd.solutionId]=rd.settings;kd.OsfPropertyBag=this.wlc([],rd.solutionId);this.re.aIa(kd);this.re.Xh.insertOsfControl(rd)};this.B4h=(kd,rd,zd,Od,Ud)=>{if(2!==zd)return 32;kd=Ud[Xg.a.Vtb];zd=Ud[Xg.a.d3];Ud=Ud[Xg.a.I_];rd=new dg.a;rd.lfc=Ud.optionalProperties.InstanceToken;rd.Ui=Ud.optionalProperties[Ng.a.Ui];rd.kS=Ud.optionalProperties[Ng.a.kS];Ng.a.taskPaneWidth in Ud.optionalProperties&&(rd.taskPaneWidth=Ud.optionalProperties[Ng.a.taskPaneWidth]);rd.sourceLocationOverrideResourceId=Ud.optionalProperties[Ng.a.sourceLocationOverrideResourceId];
rd.wB=Ud.$g;rd.onTaskPaneClose=Ud.optionalProperties[Ng.a.onTaskPaneClose];rd.d3=zd;zd=new xg.a(-859308420,0,2,0,"");Od=kd.getStoreType()===OSF.StoreType.Sdx;const Ne=new Vg.a;Ne.uZ=Ud.optionalProperties.HeaderCssClass||Cg.a.lJa;Ne.STa=Ud.optionalProperties.TitleCssClass;this.v7(zd,kd.getId(),rd,Od,Ne);return 32};this.m4h=(kd,rd,zd,Od,Ud)=>{if(2!==zd)return 32;kd=Ud[Xg.a.Vtb].getId();Ud=Ud[Xg.a.I_].optionalProperties[Ng.a.sourceLocationOverrideResourceId];return kd?(this.re.Xh.refreshOsfControl(kd,
Ud),32):8};this.d_i=kd=>{kd=kd.Result;if(kd=null===kd?null:kd.SolutionId)this.re.xme(kd),kg.a(this.$).ona(3,kd)};this.gJf=(kd,rd)=>{var zd;const Od=(kd=kd.Result)?kd.AgaveData:null;if(Od){var Ud=Telemetry.PrivacyRules.GetPrivacyCompliantId(Od.PrimaryMarketplace.SolutionId,Od.PrimaryMarketplace.MarketplaceType,null===(zd=null===Od||void 0===Od?void 0:Od.AssetMarketplace)||void 0===zd?void 0:zd.SolutionId,null,null,Od.PrimaryMarketplace.MarketplaceRef);t.ULS.shipAssertTag(537170434,0,Od.TaskpaneWidth===
sf.Wdh,`Taskpane width is ${Od.TaskpaneWidth}, assetId is ${Ud}.`);if(zd=this.wbd[Od.PrimaryMarketplace.SolutionId])zd.oAc&&(Od.TaskpaneTitle=zd.oAc),zd.mAc&&(Od.TaskpaneIconId=zd.mAc),zd.CWd&&(Od.TaskpaneButtonTooltip=zd.CWd),0<zd.oq&&(Od.TaskpaneWidth=zd.oq);rd&&(Od.FocusOnIframeWhenLoaded=rd.focusOnIframeWhenLoaded,rd.width&&(Od.TaskpaneWidth=rd.width),Od.TaskpaneIconCssClass=rd.$k,Od.TaskpaneHeaderCssClass=rd.uZ,Od.TaskpaneTitleCssClass=rd.STa,Od.IsFirstPartyOptOutAppContextOptmization=rd.isFirstPartyOptOutAppContextOptmization);
this.OAa[Od.PrimaryMarketplace.SolutionId]&&(Od.OsfPropertyBag=this.wlc(Od.OsfPropertyBag,Od.PrimaryMarketplace.SolutionId));Si.a(Od)||(Od.WebExtensionOsfControlType=1);Od&&(this.re.xme(kd.SolutionId),this.re.aIa(Od))}else t.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};this.uzh=kd=>{kd&&(this.Dad.jkf(kd),this.hye())};this.kJf=kd=>{kd=kd.toDataURL("image/jpeg");const rd=this.re.saa(sf.$8e+"."+sf.Rcc),zd={};zd.screenshot=
kd;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(rd,"onScreenshot",zd,()=>{})};this.N2h=(kd,rd,zd,Od,Ud)=>{if(2!==zd)return 32;if(Jh.a.Fh(Ud)||Ud[Xg.a.oCe]!==Qg.a.action)return 8;rd=Ud[Xg.a.I_];return rd?(kd=(kd=this.aUh(Ud))?this.re.saa(kd):null)?(Ud=this.re.j5g(Ud[Xg.a.d3],rd.optionalProperties[Ng.a.tYb]),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(zd=this.re.XY(kd),zd.TaskpaneTitle!==rd.optionalProperties[Ng.a.Ui]&&(zd.TaskpaneTitle=rd.optionalProperties[Ng.a.Ui],
zd.TaskpaneIconCssClass=rd.optionalProperties.IconCssClass,zd.TaskpaneIconUrl=rd.optionalProperties.TaskPaneIconUrl,zd.TaskpaneIconId=rd.optionalProperties.TaskPaneIconId,z.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(rd=this.re.Xh,rd.changeIframeTitle(kd,zd.TaskpaneTitle),zd=rd.getOsfControl(kd),rd.raiseOsfControlStatusChange(zd)):(rd=this.re.Xh.getOsfControl(kd),this.re.Xh.raiseOsfControlStatusChange(rd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(kd,
Ud,this.QKb),32):8:8};this.QKb=(kd,rd)=>{this.re.$Bh(kd,rd)};this.gJd=()=>{cf.TaskExtensions.KJ(jg.GetServiceTaskFactory.Sa(this.$.da,20,404,1),kd=>{kd.result.U4a()},this.$.la)};this.$=N;this.viewBlockContainerHelpers=Eb;this.re=La;this.Dad=kc;this.gi=Mc;this.gi.Nb(ae.a.H4f,eh.a.frame,this.B4h);this.gi.Nb(ae.a.cVf,eh.a.frame,this.m4h);this.gi.Nb(ae.a.gSe,eh.a.frame,this.N2h);this.gi.Nb(ae.a.Rjc,eh.a.frame,this.q3h)}IGg(N){this.addHandler(sf.mDd,N)}Obj(N){this.removeHandler(sf.mDd,N)}dispose(){xi.a.Ia(this.Awa);
this.Awa=null;this.wbb&&(this.$.ea.fo(this.gJd),this.wbb=!1);super.dispose()}p_c(){this.Awa.hide()}SEj(N,La){if(N){this.raiseEvent(sf.mDd);const Eb=N.split("|");this.Dvi(N,La,Eb);this.Awa=new th;this.Awa.initializeAndShow("",null,null);this.re.Qri(this.Awa.Tta,Eb)}}Wid(N,La,Eb){var kc=cf.TaskExtensions.ak();if(-515602470===Eb.command||-336193495===Eb.command||2086613372===Eb.command||-1444574190===Eb.command||-1336341324===Eb.command||451940422===Eb.command)kc=this.f3h(N,La,Eb);418618014===Eb.command&&
(La=new dg.a,La.Ui=vd.a.instance.ga(1821),kc=this.v7(Eb,sf.s6h,La,!0));if((Eb.tabName===this.$.Cb+ie.a.BVf||Eb.tabName===ie.a.dW)&&2===Eb.Re||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),N[Kg.a.Qc])||N[Kg.a.Qc]===ie.a.aV)return this.Q6e(N,Eb);if(7===Eb.Re&&N.SourceControlId===this.$.Cb+ie.a.Qcc)return N.MenuItemId=ie.a.bId,this.Q6e(N,Eb);1221897806===Eb.command&&(kc=this.r4f(Eb,"Format"));if(1930653487===Eb.command||1172793074===Eb.command)kc=this.r4f(Eb,"Data");
-1753056834===Eb.command&&(kc=this.FAj(Eb));932597253===Eb.command&&(t.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),uh.c(932597253,!0),La=new dg.a,La.Ui=vd.a.instance.ga(2161),La.sourceLocationOverrideResourceId=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?sf.m_i:sf.o_i,La.focusOnIframeWhenLoaded=!0,La.taskPaneWidth=sf.D$e,kc={},kc.LaunchSource=Object(O.a)(String,N.SourceControlId),kc.LaunchMode="Default",La.wB=kc,kc=this.v7(Eb,
sf.n_i,La,!0));301511274===Eb.command&&(kc=this.PAj(Eb));515196233===Eb.command&&((La=this.$.da.za(465))&&La.g9e(),La=new dg.a,La.Ui=vd.a.instance.ga(2233),kc={},kc.SourceUILocation=Kh.a[Eb.Re],La.wB=kc,kc=new Vg.a,kc.uZ=Cg.a.lJa,kc=this.v7(Eb,sf.xVi,La,!0,kc,void 0,La.Ui));1723441034===Eb.command&&(La=new dg.a,La.Ui=vd.a.instance.ga(2245),La.focusOnIframeWhenLoaded=!0,La.taskPaneWidth=sf.f2i,kc=new Vg.a,kc.uZ=Cg.a.nqh,kc=this.v7(Eb,qi.a,La,!0,kc));z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&N.LoadDataFromPictureTaskpane&&(La={},kc=new dg.a,kc.Ui=vd.a.instance.ga(2272),La.SessionID=N.SessionID,kc.wB=La,kc.focusOnIframeWhenLoaded=!0,kc=this.v7(Eb,N.DataFromPictureAssetId,kc,!0));return kc}insertAgave(N,La){var Eb=cf.TaskExtensions.ak();const kc=this.$;let Mc;var kd=N[Pd.a.Yra];Mc=N[Kg.a.kg];let rd=null;Vg.a.key in N&&(rd=N[Vg.a.key]);this.Awa&&this.Awa.hide();if(!Mc||!kd)return t.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Eb;this.$.h5&&ie.a.moa in
N&&(Mc.EnabledInViewMode=N[ie.a.moa]);N=this.DLh(La.command);if(!Mc.EnabledInViewMode&&!kc.Sp(null,!1,N))return Eb;let zd=void 0===Mc.IsToBePersisted||null===Mc.IsToBePersisted||Mc.IsToBePersisted?0:16;if(1===Mc.TargetType)Eb=this.Cci(Mc,kd,La,rd,zd);else{kd=zg.g(kc);Eb=this.viewBlockContainerHelpers.bgb(kd);const Od=kc.ea.isNamedObjectViewMode?kc.oa.sheetName:kc.oa.name;let Ud,Ne,Oe,ef;Eb?(kd=Eb.Ee,Ud=kd.tf.top,Ne=kd.tf.left,Oe=Eb.WI.x,ef=Eb.WI.y):(Ud=Ne=1,Eb=this.viewBlockContainerHelpers.ZKa(kd),
Oe=Eb.x,ef=Eb.y);const lg=this.$.pa.va.Tb();Eb=($f,ag,Mf)=>{var mg=kc.pa.va,Lg=Ud,Jg=Ne,Mg=Oe,Dh=ef;$f=Of.b($f,this.d_i);const bi=mg.Na(9,lg);bi.sharedInfo=Mc;bi.sheetName=Od;bi.positionRow=Lg;bi.positionCol=Jg;bi.positionOffsetX=Mg;bi.positionOffsetY=Dh;return Hg.g(mg,"InsertWebExtension",bi,$f,ag,Mf,null,0)};z.EwaSettings.$b()?(zd|=64,Eb=Ah.a(this.$.userOperationManager,Eb,$f=>new Bh.a(534,0,$f,zd),La)):Eb=Ah.a(this.$.userOperationManager,Eb,$f=>new oi.a(534,0,$f,zd),La)}return Eb}H2g(){var N=Ed.a.instance.Ub("Common.App.ICustomerFeedbackUiWrapper");
if(!z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OcvFeedbackvNextEnabled",!1)){var La=Ed.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Dad?this.Dad.wjb?this.hye():La.instance.C7c(this.uzh):t.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined")}La={};sd.AFrameworkApplication.fa.Rme(La);N=N.instance.getContext(La);La={};"telemetryGroup"in N&&(La=N.telemetryGroup);La.processSessionId=N.sessionId;La.officeBuild=N.build;N.telemetryGroup=
La;N.feedbackType=-1;N.userVoiceEnabled=!1;"disableIncludeScreenshot"in N||(N.disableIncludeScreenshot=!1);"screenshot"in N||(N.screenshot=!1);N.disableScreenshotPreview=!1;N.includeScreenshotSelectedDefault=!0;return N}B_i(N){if(!this.yza&&z.EwaSettings.getBooleanFeatureGate(sf.n8h,!1)){var La=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";La=this.Kve(La);const Eb=new Vg.a;Eb.$k=Cg.a.w$c;Eb.uZ=Cg.a.XOe;Eb.STa=Cg.a.T9c;
this.yza=this.vKb(La,null,!1,null,Eb);Ti.b(this.$).Hd(Di.a.C_i,{["Location"]:Kh.a[N.Re],["InputMethod"]:Ni.a[N.method]},void 0,!0);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&this.uYd()}}M_f(N){const La=this.$.ea.Wg.get(17);Ed.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Eb=>{Eb.isFeatureEnabled("mso_sendASmile",La).then(kc=>{N.FeedbackEnabled=La&&kc;return null})})}r4f(N,La){const Eb=zg.g(this.$),kc=new dg.a;
var Mc={};Mc.ActiveTab=La;Mc.DatapaneFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);Mc.AceFlighting=!0;Mc.ChartNewSDXRecording=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Mc.ThemeColorsFlighting=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Mc.UOMirror=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);Mc.FormatTaskPaneAceButtonDark=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneAceButtonDark",!1);Mc.FormatTaskPaneBetterFeedbackButton=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterFeedbackButton",!1);Mc.FormatTaskPaneBetterScrollbar=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneBetterScrollbar",!1);Mc.FormatTaskPaneUXImprovePhase2=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormatTaskPaneUXImprovePhase2",
!1);this.M_f(Mc);Mc.startTimeMs=Date.now();Mc.UserSessionId=this.$.ya.UserSessionId;(La=Eb.ha.Qa.jo)&&(Mc.SubSelection=La);t.ULS.sendTraceTag(592524688,0,50,`Chart task pane launched. UserSessionId: ${Mc.UserSessionId}, UILocation: ${void 0===N.Re||null===N.Re?"Null":Kh.a[N.Re]}, SubSelection: ${La||"ChartRoot"}`);kc.wB=Mc;kc.Ui=vd.a.instance.ga(984);Mc=new Vg.a;Mc.uZ=Cg.a.lJa;return this.v7(N,sf.DXg,kc,!0,Mc)}FAj(N){const La=new dg.a;La.wB={};La.Ui=vd.a.instance.ga(1807);La.kS=sf.emf;const Eb=new Vg.a;
Eb.uZ=Cg.a.lJa;return this.v7(N,sf.emf,La,!0,Eb,void 0,La.Ui)}PAj(N){const La=new dg.a;La.wB={};La.Ui=vd.a.instance.ga(2185);const Eb=new Vg.a;Eb.uZ=Cg.a.Rrh;Eb.STa=Cg.a.bPe;return this.v7(N,sf.$Ci,La,!0,Eb)}Q6e(N,La){const Eb=sf.$8e;var kc=N[Kg.a.Qc].toString();const Mc={},kd=new dg.a;kd.Ui=vd.a.instance.ga(9);switch(kc){case "A0":Mc.query=(N[Kg.a.kg]||"").split("|").slice(2,Bi.a.wS).join("|");break;case "A1":Mc.query=N.CommandValueId;break;case "Help":Mc.gwdropdownflightinfo=z.EwaSettings.ma(239);
Mc.query="";break;case ie.a.bId:z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(kd.Ui=vd.a.instance.ga(1773),kd.sourceLocationOverrideResourceId=sf.Rcc,Mc.feedback=this.H2g()):Mc.query=kc;break;case "HelpArticle":Mc.query=N[Kg.a.kg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Mc.query=kc;break;default:return mh.Task.Ta(!0)}kd.wB=Mc;kc=new Vg.a;kc.uZ=Cg.a.lJa;return this.v7(La,Eb,kd,!1,kc,N[ie.a.moa]||!1)}Kve(N){const La={Version:"0.0.0.0"};
La.AssetId=sf.ULa;La.SolutionId=sf.ULa;La.AssetStoreId="";La.StoreType=OSF.StoreType.Sdx;La.Height=0;La.Width=0;La.StoreId=OSF.StoreType.Sdx;La.TargetType=OSF.OsfControlTarget.TaskPane;La.IsToBePersisted=!1;La.SourceLocationOverrideResourceId=N;La.SharedRuntimeId=N;return La}f3h(N,La,Eb){function kc(){rd.LaunchMode="Default";z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId=
"Insights.Https.Bundle";Mc.Ui=vd.a.instance.ga(1820);Mc.kS=sf.JWc;Mc.$k=Cg.a.w$c;kd.$k=Cg.a.w$c}const Mc=new dg.a,kd=new Vg.a,rd={};this.yza&&this.M_f(rd);rd.LaunchSource="";rd.StartTimeMs=Date.now();rd.CorrelationId=Uh.a.create().toString();Mc.wB=rd;Mc.focusOnIframeWhenLoaded=!0;Mc.taskPaneWidth=sf.D$e;kd.uZ=Cg.a.XOe;kd.STa=Cg.a.T9c;switch(Eb.command){case -1444574190:let Ud;rd.LaunchMode="RecommendedPivotTables";rd.SelectionContext="";rd.LaunchSource="PivotTableHandRaise"===Object(O.a)(String,N.SourceControlId)?
"PivotTableHandRaise":"InsertPivotTable";if(this.$&&z.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&N.SourceSelection){var zd=N.SourceSelection.split(",")[0];La=z.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(({sheetName:zd,ZMf:Ud,range:Od}=vh.Z(zd,this.$.xa)).returnValue&&!zg.g(this.$).Fb.e5(Od))N=this.$.xa.getItemByName(zd),rd.SelectionContext=JSON.stringify(Object(cc.a)(new Lh,{address:Ud,addressWithSheet:zd+"!"+Od.pz(!1),
sheetId:Wg.d(N),sheetName:zd,isSheetEmpty:!1,columnCount:Od.width,rowCount:Od.height,columnIndex:Od.left+La,rowIndex:Od.top+La,selectionType:"Continuous"}));else if((N=this.$.Ab.getItemByName(Object(O.a)(String,N.SourceSelection)))&&Wg.n(N)){var Od=Ri.a(N,!0);zd=this.$.xa.getItemByName(N.sheetName);rd.SelectionContext=JSON.stringify(Object(cc.a)(new Oi,{tableName:N.name,hasTableHeaders:Ri.d(N),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Od.pz(!1),addressWithSheet:zd.name+"!"+Od.pz(!1),
sheetId:Wg.d(zd),sheetName:zd.name,isSheetEmpty:!1,columnCount:Od.width,rowCount:Od.height,columnIndex:Od.left+La,rowIndex:Od.top+La,selectionType:"Continuous"}))}}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Mc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Mc.Ui=vd.a.instance.ga(1819);Mc.kS=sf.BYi;Mc.$k=Cg.a.pRe;kd.$k=Cg.a.pRe;break;case -336193495:rd.LaunchMode="RecommendedCharts";
z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Mc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Mc.Ui=vd.a.instance.ga(1818);Mc.kS=sf.r6i;Mc.$k=Cg.a.qRe;kd.$k=Cg.a.qRe;break;case -1336341324:if(!z.EwaSettings.ma(479))return mh.Task.Ta(!1);rd.LaunchMode="NL";Mc.kS=sf.JWc;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":
Mc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(z.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Mc.Ui=vd.a.instance.ga(1823);rd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Mc.Ui=vd.a.instance.ga(1824);rd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Mc.Ui=vd.a.instance.ga(1822),rd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!z.EwaSettings.ma(234))return mh.Task.Ta(!1);rd.LaunchMode=
"ChartDesigner";rd.LaunchSelectionMode=La.toString();z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Mc.Ui=vd.a.instance.ga(1825);Mc.kS=sf.JWc;break;case 451940422:rd.LaunchSource="AutoFilter";Od=JSON.parse(N.CommandValueId);rd.AutoFilterSource=JSON.stringify(Object.assign(new Ci,{autoFilterRange:{sheetName:Od.AutoFilterRange.SheetName,firstColumn:Od.AutoFilterRange.FirstColumn,
lastColumn:Od.AutoFilterRange.LastColumn,firstRow:Od.AutoFilterRange.FirstRow,lastRow:Od.AutoFilterRange.LastRow},autoFilterType:Od.AutoFilterType,itemIndex:Od.ItemIndex,id:Od.Id}));kc();break;default:z.EwaSettings.ma(234)&&(rd.LaunchSelectionMode=La.toString()),z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PassXlimTableBoundariesToIdeas",!1)&&(rd.XlimTableBoundaries=this.hZh()),kc()}z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Mc.sourceLocationOverrideResourceId=
"Insights.Https.PPE.Bundle":Mc.sourceLocationOverrideResourceId="Insights.Https.Bundle";return this.yza?this.yza.fp(()=>this.KYf(rd,Mc)):this.Mai(Eb,Mc,kd,rd)}Mai(N,La,Eb,kc){this.yza=this.vKb(this.Kve(La.sourceLocationOverrideResourceId),La,!1,N,Eb,!1);return z.EwaSettings.isChangeGateEnabled("OfficeVSO:6256725_NoActionMsgOnFirstInstance")?(kc.NoActionMsgOnFirstInstance=!0,this.OAa[sf.ULa]=kc,this.yza):this.yza.fp(()=>this.KYf(kc,La))}KYf(N,La){const Eb=this.re.saa(this.re.M3a(sf.ULa,La.sourceLocationOverrideResourceId));
if(Eb){this.OAa[sf.ULa]=N;const kc=this.wlc(this.re.XY(Eb).OsfPropertyBag,sf.ULa);this.re.XY(Eb).OsfPropertyBag=kc}this.fla(sf.ULa,"LaunchIdeasAction",N,La);return mh.Task.Ta(!0)}v7(N,La,Eb=null,kc=!1,Mc=null,kd=!1,rd=null){cf.TaskExtensions.ak();Eb||(Eb=new dg.a);const zd={Version:"0.0.0.0"};zd.AssetId=La;zd.SolutionId=La;zd.AssetStoreId="";zd.StoreType=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;zd.Height=0;zd.Width=0;zd.StoreId=kc?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;zd.TargetType=OSF.OsfControlTarget.TaskPane;
zd.IsToBePersisted=!1;zd.SourceLocationOverrideResourceId=Eb.sourceLocationOverrideResourceId;if(Eb.Ui||rd)this.wbd[La]=Object(cc.a)(new mi,{oAc:Eb.Ui,CWd:rd,mAc:Eb.kS});z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Eb.wB||(Eb.wB={}),Eb.wB.ShowFeedback=this.$.isFeedbackEnabled,this.OAa[La]=Eb.wB):Eb.wB&&(this.OAa[La]=Eb.wB);La={};La[Kg.a.kg]=zd;rd={};rd.solutionId=zd.SolutionId;rd.version=zd.Version;rd.storeType=zd.StoreType;
rd.storeId=zd.StoreId;rd.assetId=zd.AssetId;rd.assetStoreId=zd.AssetStoreId;rd.height=zd.Height;rd.targetType=zd.TargetType;rd.width=zd.Width;rd.isAddinCommands=!kc;La[Pd.a.Yra]=rd;Mc||(Mc=new Vg.a);Mc.focusOnIframeWhenLoaded=Eb.focusOnIframeWhenLoaded;Mc.width=Eb.taskPaneWidth;La[Vg.a.key]=Mc;La[ie.a.moa]=kd;return this.insertAgave(La,N)}Cci(N,La,Eb,kc,Mc){const kd=(Ud,Ne)=>{var Oe=Ud.SolutionId;var ef=OSF.OsfControl.isFirstPartyStoreString(Ud.StoreType);ef&&Ud.SourceLocationOverrideResourceId&&
(Oe=this.re.M3a(Oe,Ud.SourceLocationOverrideResourceId));var lg=this.re.bze(Oe,null,Ud.SharedRuntimeId);ef&&(z.EwaSettings.ma(295)&&lg&&(ef=this.re.saa(Oe))&&(Oe=null,Oe=this.wlc(this.re.XY(ef).OsfPropertyBag,Ud.SolutionId),(ef=this.re.Xh.getOsfControl(ef))&&ef.setSettings(Oe)),Ud.SharedRuntimeId&&lg||this.re.Xh.refreshOsfControl(Ud.SolutionId,Ud.SourceLocationOverrideResourceId));if(!lg){const $f=this.$.pa.va.Tb();let ag=519;lg=(Mf,mg,Lg)=>{var Jg=this.$.pa.va;Mf=Of.b(Mf,this.gJf);const Mg=Jg.Na(9,
$f);Mg.sharedInfo=Ud;return Hg.g(Jg,"InsertAgaveTaskpane",Mg,Mf,mg,Lg,kc,0)};void 0===Ud.IsToBePersisted||null===Ud.IsToBePersisted||Ud.IsToBePersisted||(ag=538,lg=(Mf,mg,Lg)=>{const Jg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ud.SolutionId,Ud.StoreType,Ud.AssetId,null,null,Ud.StoreId);t.ULS.sendTraceTag(537170442,220,50,`Web Method ShowAgaveTaskpane is called, StoreType ${Ud.StoreType}, StoreId ${Ud.StoreId}, SolutionId ${Jg}.`);return Qi(this.$.pa.va,Ud,Of.b(Mf,this.gJf),mg,Lg,kc,$f)});return z.EwaSettings.$b()?
(Mc|=64,Ah.a(this.$.userOperationManager,lg,Mf=>new Bh.a(ag,0,Mf,Mc),Ne)):Ah.a(this.$.userOperationManager,lg,Mf=>new oi.a(ag,0,Mf,Mc),Ne)}return cf.TaskExtensions.Uaa()},rd=Ud=>{var Ne=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ud.solutionId,Ud.storeType,Ud.assetId,null,null,Ud.storeId);t.ULS.sendTraceTag(537170440,220,50,`Insert addincommands for ${Ne} from ${Ud.storeType}.`);Ne={};const Oe=new l.a;Oe.add(Ud);Ne[Pd.a.Inb]=Oe;Ne[Pd.a.tP]=3;Ud=new xg.a(ae.a.WBb,0,this.$.Kc,0,null);return this.$.Ka.Lb(Ud,
Ne)};if(!z.EwaSettings.ma(53)||N.StoreId===OSF.StoreType.FirstParty)return kd(N,Eb,kc);if(La.isAddinCommands)return rd(La);const zd=new Id.a,Od={};Od.marketplaceId=N.SolutionId;Od.marketplaceVersion=N.Version;Od.storeType=N.StoreType;Od.storeId=N.StoreId;Od.targetData=N;z.EwaSettings.ma(93)&&(Od.clearCache=!0);this.re.Xh.isAddinCommandsAsync(Od,(Ud,Ne,Oe)=>{zd.setResult(Ne);Ud||(Ud=Oe.targetData,Ne=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ud.SolutionId,Ud.StoreType,Ud.AssetId,null,null,Ud.StoreId),
t.ULS.sendTraceTag(537170438,220,10,`Judging AddinCommands failed for ${Ne} from ${Ud.StoreType} during addin inserting`))});return cf.TaskExtensions.ts(zd.task,Ud=>Ud.result?rd(La):kd(N,Eb,kc),this.$.la)}wlc(N,La){if(!this.OAa[La])return N;const Eb={};if(N)for(const Mc of N)Eb[Mc[0]]=Mc[1];N=this.OAa[La];for(var kc of Object.keys(N))kc===sf.wzh&&z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Eb[kc]=Sys.Serialization.JavaScriptSerializer.serialize(N[kc]):
Eb[kc]=Sys.Serialization.JavaScriptSerializer.serialize(N[kc].toString());kc=Object.keys(Eb).length;kc=Array(kc);N=0;for(const Mc of Object.keys(Eb))kc[N]=[Mc,Eb[Mc].toString()],N++;return kc}Dvi(N,La,Eb){const kc=this.$.ya.UserSessionId,Mc=this.$.ya.UICultureTag,kd=this.$.ya.UICultureTagLcid,rd=this.$.ya.WacHostId;let zd="",Od="";5<=Eb.length&&(zd=Eb[3],Od=Eb[4]);this.Evi(zd,Od,N,La,Mc,kd,kc,rd)}Evi(N,La,Eb,kc,Mc,kd,rd,zd){const Od={};Od.a=rd;Od.b=Eb;Od.c=kc;Od.d=N;Od.e=La;Od.f=Mc;Od.g=kd;Od.h=zd;
Ei.b().Ne(36,Od)}hye(){if(Ai.a.Buf())t.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.kJf);return}catch(N){t.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(N?N.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.kJf)}catch(N){t.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(N?N.toString():null))}}}vKb(N,La=null,Eb=!1,kc=null,Mc=null,kd=!0){var rd=
N.SolutionId;let zd=mh.Task.Ta(!1);N&&rd&&N.SharedRuntimeId&&(kc=kc||new xg.a(-859308420,0,2,0,""),rd={},rd.solutionId=N.SolutionId,rd.version=N.Version,rd.storeType=N.StoreType,rd.storeId=N.StoreId,rd.assetId=N.AssetId,rd.assetStoreId=N.AssetStoreId,rd.height=N.Height,rd.targetType=N.TargetType,rd.width=0,rd.isAddinCommands=!1,rd.sharedRuntimeId=N.SharedRuntimeId,N.Preload=kd,Mc=Mc?Mc:new Vg.a,Mc.width=0,La&&(Mc.focusOnIframeWhenLoaded=La.focusOnIframeWhenLoaded,kd=new mi,La.Ui&&(kd.oAc=La.Ui),0<
La.taskPaneWidth&&(kd.oq=La.taskPaneWidth),La.kS&&(kd.mAc=La.kS),this.wbd[N.SolutionId]=kd),La={},La[Kg.a.kg]=N,La[Pd.a.Yra]=rd,La[Vg.a.key]=Mc,La[ie.a.moa]=Eb,zd=this.insertAgave(La,kc));return zd}fla(N,La,Eb,kc=null){if(N&&La){N=new wh.a(N,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");const Mc=new yi.a("ExcelOnline","Web",this.$.ya.UICultureTag),kd=new zi.a;kd.optionalProperties[Ng.a.tYb]=Eb;kc&&(kc.sourceLocationOverrideResourceId&&(kd.optionalProperties[Ng.a.sourceLocationOverrideResourceId]=
kc.sourceLocationOverrideResourceId),kc.Ui&&(kd.optionalProperties[Ng.a.Ui]=kc.Ui),kc.$k&&(kd.optionalProperties.IconCssClass=kc.$k),kc.zWd&&(kd.optionalProperties.TaskPaneIconUrl=kc.zWd),kc.kS&&(kd.optionalProperties.TaskPaneIconId=kc.kS));Mi.a.instance.fla(N,Qg.a.action,La,Mc,kd)}}aUh(N){if(!Jh.a.Fh(N)){var La=N[Xg.a.Vtb];if(La&&(La=La.getId(),N=N[Xg.a.I_],La&&N))return this.M3a(La,N.optionalProperties[Ng.a.sourceLocationOverrideResourceId])}return null}M3a(N,La=null){return N&&La?`${N}.${La}`:
N}DLh(N){switch(N){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return z.EwaSettings.ma(234)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}}uYd(){this.$.ea.Hg?this.gJd():(this.$.ea.Ll(this.gJd),this.wbb=!0)}hZh(){var N=this.$.da.za(20);if(!N)return this.uYd(),"";N=N.U4a();if(!N)return this.uYd(),"";var La=this.$.xa.getItemByName(this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.oa.name);
La=Wg.d(La);var Eb=zg.g(this.$).ha.sa.selectedRanges;const kc=[];for(const kd of Eb){Eb=new Vi.a(kd,La);var Mc=N.acc(Eb,ri.Valid);Eb=[];if(Mc)for(const rd of Mc)(Mc=rd.table.AE)&&(Mc=Mc.range.toString())&&Eb.push(Mc);Eb=new ni(kd.toString(),Eb);kc.push(Eb)}return JSON.stringify(kc)}}sf.n8h="Microsoft.Office.Excel.IdeasXLOPreload";sf.mDd="IDS";sf.$8e="FA000000012";sf.ULa="FA000000005";sf.s6h="HelloWorld";sf.DXg="FA000000014";sf.Rcc="Help.GiveFeedback.Url";sf.wzh="feedback";sf.emf="FA000000066";sf.o_i=
"PowerBi.Url";sf.m_i="PowerBi.DevUrl";sf.n_i="FA000000054";sf.$Ci="FA000000064";sf.xVi="FA000000075";sf.JWc="AnalyzeDataTaskPane";sf.r6i="RecommendedChartsTaskPane";sf.BYi="PivotTableTaskPane";sf.Wdh=350;sf.D$e=320;sf.f2i=320;Object(e.a)(sf,"AgaveCommandManager",Pc.a,[759,760]);class Vh extends k.a{constructor(N){super();this.$=N;this.Eb()}create(){const N=this.$.da,La=jg.GetServiceTaskFactory.create(N,106,this.la,this.fb),Eb=jg.GetServiceTaskFactory.create(N,104,this.la,this.fb),kc=hi.a.loadScript(36,
0,this.fb,void 0,void 0,375);cf.TaskExtensions.Aa(cf.TaskExtensions.Td([Eb,La,kc],this.la),()=>{let Mc=null;z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Mc=Ed.a.instance.Ub("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);yg.instance.initialize(La.result);const kd=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PreloadRaceCondition6395242",!0)?Object(Qh.c)(this.$.da,374,()=>new sf(this.$,La.result,Eb.result,
Mc,sd.AFrameworkApplication.vb)):new sf(this.$,La.result,Eb.result,Mc,sd.AFrameworkApplication.vb);N.Ga(206,kd);this.pb(N.za(374)||N.Ga(374,kd))},this.la,3);Ed.a.instance.register(hf.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").wc().Fc(()=>new hf.a(this.$.$u))}static ka(N){N.da.Ga(375,new Vh(N))}}Object(e.a)(Vh,"AgaveCommandManagerFactory",k.a,[]);var Fi=a(563);class oh{constructor(){this.initialized=!1;this.agaveCommandManager=this.re=this.J0a=null;this.$T={}}initialize(N){z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&!this.initialized&&this.pjj(N)}ici(N,La){let Eb=cf.TaskExtensions.ak();if(this.initialized&&N&&0<N.length){let kc=this.uIh(N);N in this.$T&&(Eb=this.agaveCommandManager.insertAgave(kc,La))}return Eb}tBg(N){this.initialized&&(N=N[Kg.a.kg]||{},!N.SolutionId||N.SolutionId in this.$T||this.re.Xca(La=>{this.Xca(La)},!0))}h4h(N){this.initialized&&(N=N||"")&&0<N.length&&N in this.$T&&(delete this.$T[N],this.re.Xca(La=>{this.Xca(La)},!0))}uIh(N){return N in this.$T?this.$T[N]:{}}Xca(N){var La=!1;if(N&&
!N.errorCode){if(N.value)for(const Eb of N.value)N=Eb[1],Eb[3]==OSF.OsfControlTarget.InContent&&N&&0<N.length&&!(N in this.$T)&&(La={NoReporting:!1,IsSystemInitiated:!1},La.description=Eb[2],La.iconUrl=Eb[9],La[Pd.a.Yra]={solutionId:Eb[1],version:Eb[4],storeType:Eb[12],storeId:Eb[11],assetId:Eb[5],assetStoreId:Eb[6],targetType:Eb[3],width:Eb[7],height:Eb[8],displayName:Eb[0],id:Eb[1]},La[Kg.a.kg]={SolutionId:Eb[1],Version:Eb[4],StoreType:Eb[12],StoreId:Eb[11],AssetId:Eb[5],AssetStoreId:Eb[6],TargetType:Eb[3],
Width:Eb[7],Height:Eb[8],Id:Eb[1]},this.$T[N]=La,La=!0);La&&this.E6g()}}E6g(){let N=[];for(const La in this.$T)N.push({id:La,controlType:0,title:this.$T[La][Pd.a.Yra].displayName});if(0<N.length){for(const La in this.$T)appChrome.addInApi.registerAddinIcon("AddinIcon_"+La,this.$T[La].iconUrl);this.LYg();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:oh.Iuf,isOfficeTab:!0,groups:[{id:oh.Ibf,title:oh.Jbf,controls:N}]}]});for(const La in this.$T)this.J0a.addCommandToMaps(Object(cc.a)(new kf.a(La,
"-1473679467"),{legacyControlId:La}))}}LYg(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:oh.Iuf,isOfficeTab:!0,groups:[{id:oh.Ibf,title:oh.Jbf,controls:[]}]}]})}pjj(N){const La=jg.GetServiceTaskFactory.Sa(N.da,374,375,1),Eb=jg.GetServiceTaskFactory.create(N.da,106,N.la,1);cf.TaskExtensions.Aa(cf.TaskExtensions.Td([La,Eb],N.la),()=>{this.agaveCommandManager=La.result;this.J0a=Ed.a.instance.yh("Common.IExternalUICommandDefinitionMapping")||new Fi.a(N.Cb,N);sd.AFrameworkApplication.vb.Nb(ae.a.gQf,
eh.a.frame,(kc,Mc,kd,rd,zd)=>{this.h4h(zd)});this.re=Eb.result;this.re.Xca(kc=>{this.Xca(kc)},!0);this.initialized=!0},N.la,3)}}oh.Iuf="tabinsert";oh.Ibf="installedContentAddins";oh.Jbf=vd.a.instance.ga(2280);Object(e.a)(oh,"AgaveCommandRibbon",null,[752]);class si extends k.a{constructor(N){super();this.$=N;this.Eb()}create(){if(z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){const N=this.$.da,La=new oh;La.initialize(this.$);this.pb(N.za(488)||
N.Ga(488,La))}}static ka(N){N.da.Ga(489,new si(N))}}Object(e.a)(si,"AgaveCommandRibbonFactory",k.a,[]);var ti=a(1293),eg=a(733);class Wh{constructor(){this.C7d=this.X6d=this.ifa=null;this.$ib=0}get displayName(){return this.ifa}set displayName(N){this.ifa=N}get email(){return this.X6d}set email(N){this.X6d=N}get federationProvider(){return this.C7d}set federationProvider(N){this.C7d=N}get identityType(){return this.$ib}set identityType(N){this.$ib=N}getTypeName(){return"Microsoft.Authentication.OfficeIdentityInfo"}invokePropertyGet(N){switch(N){case 4:return this.displayName;
case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,La){switch(N){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,
0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,La){N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}static O7g(N){const La=new Wh;La.displayName=N.displayName;La.email=N.email;switch(N.authority){case ti.a.eGf:La.identityType=1;break;default:La.identityType=0}La.federationProvider="";return La}}Object(e.a)(Wh,"OfficeIdentityInfo",null,[]);class rh{static get kNe(){return rh.Mpg}static abc(N){return N in rh.kNe?rh.kNe[N].toString():N}}rh.map=null;rh.Mpg={["GeneralException"]:eg.a.generalException,
["AccessDenied"]:eg.a.JTc,["ApiNotAvailable"]:eg.a.apiNotAvailable,["UserNotSignedIn"]:eg.a.userNotSignedIn,["UserAborted"]:eg.a.userAborted,["UnsupportedUserIdentity"]:eg.a.fQj,["InvalidResourceUrl"]:eg.a.invalidResourceUrl,["InvalidGrant"]:eg.a.invalidGrant,["AddinIsAlreadyRequestingToken"]:eg.a.gJg,["ResourceNotAllowed"]:eg.a.khj,["ClientError"]:eg.a.clientError,["ServerError"]:eg.a.serverError};Object(e.a)(rh,"SingleSignOnErrorCodeMap",null,[]);class ui{constructor(N,La){this.JQb=N;this.$ib=La}get accessToken(){return this.JQb}set accessToken(N){this.JQb=
N}get tokenIdenityType(){return this.$ib}set tokenIdenityType(N){this.$ib=N}getTypeName(){return"Microsoft.Authentication.SingleSignOnToken"}invokePropertyGet(N){switch(N){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,La){switch(N){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,
0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}
Object(e.a)(ui,"SingleSignOnToken",null,[]);class Mh{constructor(){this.v3d=null;this.bhe=this.kWb=this.gE="";this.oie=!0;this.options=null}get authChallenge(){return this.v3d}set authChallenge(N){this.v3d=N}get correlationId(){return this.gE}set correlationId(N){this.gE=N}get policy(){return null}set policy(N){}get resource(){return this.kWb}set resource(N){this.kWb=N}get scope(){return this.bhe}set scope(N){this.bhe=N}get silentLogin(){return this.oie}set silentLogin(N){this.oie=N}getTypeName(){return"Microsoft.Authentication.TokenParameters"}invokePropertyGet(N){switch(N){case 3:return this.authChallenge;
case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,La){switch(N){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(Mh,"TokenParameters",null,[401]);class Xh{constructor(N,La){this.whb=La;this.zA=N}get roamingSettings(){return null}getAccessToken(N){const La=this.whb.getOsfControl(this.zA),
Eb=La.getManifest(),kc=Eb.getMarketplaceID();this.iOa(N,kc);return OfficeExtension.WacRuntime.Utility.createPromise((Mc,kd)=>{La.isFirstParty()&&this.whb._enableFirstPartySSO?this.cfi(Eb,N)?Ed.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(N,kc).then(rd=>{Mc(rd)},rd=>{kd(rd)}):kd(eg.a.JTc):kd(eg.a.apiNotAvailable)}).then(Mc=>{let kd;switch(Mc.authority){case ti.a.eGf:kd=1;break;default:kd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new ui(Mc.accessToken,
kd))},Mc=>{this.logErrorResponse(N,kc,Mc);return Mc?OfficeExtension.WacRuntime.Utility.createPromise((kd,rd)=>{rd(OfficeExtension.WacRuntime.Utility.createRichApiException(Mc,rh.abc(Mc)))}):OfficeExtension.WacRuntime.Utility.createPromise((kd,rd)=>{rd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,rh.abc(eg.a.generalException)))})})}getAuthContext(){return null}getPrimaryIdentityInfo(){const N=this.whb.getOsfControl(this.zA);N.getManifest();const La=N.getManifest().getMarketplaceID();
return OfficeExtension.WacRuntime.Utility.createPromise((Eb,kc)=>{Ed.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(La).then(Mc=>{Eb(Mc)},Mc=>{kc(Mc.toString())})}).then(Eb=>{Eb=Wh.O7g(Eb);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Eb)},Eb=>Eb?OfficeExtension.WacRuntime.Utility.createPromise((kc,Mc)=>{Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(Eb,rh.abc(Eb)))}):OfficeExtension.WacRuntime.Utility.createPromise((kc,Mc)=>
{Mc(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,rh.abc(eg.a.generalException)))}))}getTypeName(){return"Microsoft.Authentication.AuthenticationService"}invokePropertyGet(N){switch(N){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 1:return this.RHh(La);case 3:return this.fJh();case 2:return this.fVh()}N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}RHh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,Mh);return this.getAccessToken(N)}fJh(){return this.getAuthContext()}fVh(){return this.getPrimaryIdentityInfo()}cfi(N,
La){let Eb=!1;const kc=N.getWebApplicationAuthorizations();N=null;for(const Mc of kc)if(Mc.getResource().toLowerCase()===La.resource.toLowerCase()){N=Mc;Eb=!0;break}if(!Eb)return!1;La=La.scope.split(" ,+");for(const Mc of La)if(Mc&&Mc.length){La=!1;for(const kd of N.getScopes())Mc.toLowerCase()===kd.toLowerCase()&&(La=!0);if(!La)return!1}return!0}iOa(N,La){N=this.uuf(N.resource);t.ULS.sendTraceTag(538572831,369,50,"{0}",{["manifestId"]:La,["resource"]:N})}logErrorResponse(N,La,Eb){N=this.uuf(N.resource);
t.ULS.sendTraceTag(538572830,369,10,"{0}",{["manifestId"]:La,["resource"]:N,["error"]:Eb})}uuf(N){return N.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(e.a)(Xh,"AuthenticationService",null,[]);class Yh{create(N,La){return new Xh(N,La)}}Object(e.a)(Yh,"AuthenticationServiceFactory",null,[]);var Zh=a(845),Nh=a(965),S=a(947);class Ka{}Ka.generalException="generalException";Ka.invalidArgument="invalidArgument";Ka.notAllowed="notAllowed";Ka.apiNotAvailable="apiNotAvailable";
Ka.unresolvedPendingRequest="unresolvedPendingRequest";Ka.timeout="timeout";Ka.adalTimeout="adalTimeout";Ka.userNotSignedIn="userNotSignedIn";Ka.userAborted="userAborted";Ka.silentSignInFailed="silentSignInFailed";Ka.invalidResourceUrl="invalidResourceUrl";Ka.invalidGrant="invalidGrant";Ka.connectionLost="connectionLost";Ka.clientError="clientError";Ka.serverError="serverError";Object(e.a)(Ka,"WopiHostErrorCodes",null,[]);var kb=a(731);class bc{}Object(e.a)(bc,"OAuthCallerMetadata",null,[]);var sc=
a(27);class Qc{constructor(N){this.dya=N;this.Dpg=sd.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}FAg(N,La,Eb,kc,Mc,kd){if(!this.dya)return kc=new Nh.a,kc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(kc);const rd=new bc;rd.AddinName=Mc;rd.AddinTrustId=kd;let zd=-1;kd=null;if(kc&&this.Hff())kd=this.dya.Qbg(Pd.a.CAc,N,kc,Qc.u2e(Mc),rd);else{const Od=Date.now();kd=this.dya.CL(Pd.a.CAc,N,rd).then(Ud=>{zd=Date.now()-
Od;const Ne=(La||Eb)&&"login_required"===Ud.ErrorCode;return(La&&("interaction_required"===Ud.ErrorCode||"consent_required"===Ud.ErrorCode||"invalid_grant"===Ud.ErrorCode)||Ne)&&this.Hff()?this.dya.Qbg(Pd.a.CAc,N,null,Qc.u2e(Mc),rd):Promise.resolve(Ud)})}return kd.then(Od=>{const Ud=new Nh.a;Od.IsSuccess?(Ud.token=Od.Token,Od.Telemetry&&(Ud.YTa=Od.Telemetry.fromCache,Ud.expiresOn=Od.Telemetry.expiresOn)):(Ud.errorCode=this.Wyi(Od),Ud.GWd=this.IWi(Od));return Ud}).catch(()=>{const Od=new Nh.a;Od.errorCode=
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Od)}).then(Od=>{Od.bha="OauthManager";0<=zd&&(Od.Kwb=zd);return Od})}yhi(N){const La=(sd.AFrameworkApplication.fa.Xa(sd.AFrameworkApplication.R7)||"").toLowerCase();return(sc.a.zxa||"teams"===La&&kb.a.Vxb)&&!Qc.chi(N)||!this.dya||!this.dya.qMa()?!1:!0}Hff(){return this.Dpg||1!==S.a.lac()}Wyi(N){switch(N.ErrorCode){case "UserCancelled":case "interaction_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;
case "consent_required":case "invalid_grant":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":N=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:N=
N.ErrorCode===Ka.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:N.ErrorCode===Ka.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:N.ErrorCode===Ka.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:N.ErrorCode===Ka.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:N.ErrorCode===Ka.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return N}IWi(N){let La=
"";(N=RegExp("AADSTS(\\d+)").exec(N.ErrorMessage))&&1<N.length&&(La=N[1]);return La}static u2e(N){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,N)}static chi(N){if(!N)return!1;N=N.toLowerCase();for(const La of Zh.AppsForOfficeSingleSignOnManager.FUe)if(La===N)return!0;return!1}}Object(e.a)(Qc,"AppsforOfficeTokenFromOauthManager",null,[807]);class Lc{constructor(N){this.cyi=N}static Coa(){if(sd.AFrameworkApplication.fa.qa("AppForOfficeSSOV2IsEnabled")){var N=
null;try{N=Ed.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(La){t.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+La)}N=new Qc(N);Lc.Ma=new Lc(N)}}static getInstance(){Lc.w9d||(Lc.Coa(),Lc.w9d=!0);return Lc.Ma}}Lc.Ma=null;Lc.w9d=!1;Object(e.a)(Lc,"AppsForOfficeOauthManagerFactory",null,[801]);var Kc=a(1292),tc=a(134);class Yc{constructor(N,La,Eb,kc){this.menuItemId=N;this.nG=La;this.iGj=Eb;this.iAh=kc}}Object(e.a)(Yc,"NewDocumentParameters",null,[]);const cd=N=>
{var La=N.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Eb=La.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Eb.addParameter("shortcuts","String[]",1,null,0);La.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Eb=La.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Eb.addParameter("shortcuts","Object",1,null,0);La=N.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}",
"{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Eb=La.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Eb.addParameter("pickerCustomizationJsonString","String",1,null,0);La=N.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Eb=La.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Eb.addParameter("base64File","String",1,null,0);La=N.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}",
"",3,0);La.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Eb=La.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);La=N.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);La.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,
0);Eb=La.addMethod("Register",1,"Void",0,0,"Register",0);Eb.addParameter("metadata","String",1,null,0);Eb.addParameter("javascript","String",1,null,0);La=N.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);La.addProperty("Enabled",1,"Boolean",1,!1,null,0);La.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);La.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);La=N.addEnumType("Microsoft.Authentication.IdentityType");La.addEnumField("OrganizationAccount",
0);La.addEnumField("MicrosoftAccount",1);La=N.addEnumType("Microsoft.Authentication.AuthorityType");La.addEnumField("External",0);La.addEnumField("Msa",1);La.addEnumField("Aad",2);La=N.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);La.addProperty("DisplayName",4,"String",1,!1,null,0);La.addProperty("Email",3,"String",1,!1,null,0);La.addProperty("FederationProvider",2,"String",1,!1,null,0);La.addProperty("IdentityType",
1,"Microsoft.Authentication.IdentityType",1,!1,null,0);La=N.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);La.addProperty("AppId",4,"String",1,!1,null,0);La.addProperty("Authority",2,"String",1,!1,null,0);La.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);La.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);La.addProperty("TenantId",6,"String",1,!1,null,0);La.addProperty("Upn",
1,"String",1,!1,null,0);La=N.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);La.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Eb=La.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Eb.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);La.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",
2,1,"AuthContext",0);La.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);La=N.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);La.addProperty("AuthChallenge",3,"String",1,!1,null,0);La.addProperty("CorrelationId",7,"String",1,!1,null,0);La.addProperty("Policy",4,"String",1,!1,null,0);La.addProperty("Resource",2,"String",1,!1,null,0);La.addProperty("Scope",
5,"String",1,!1,null,0);La.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);La=N.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);La.addProperty("AccessToken",2,"String",1,!1,null,0);La.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);La=N.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);La.addProperty("Id",1,"String",1,
!0,null,0);La.addProperty("Value",2,"Object",1,!1,null,0);La=N.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Eb=La.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Eb.addParameter("id","String",1,null,0);Eb=La.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Eb.addParameter("id","String",1,null,0);La=N.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}",
"{43a4559c-806b-4e89-914e-da9256212148}",3,0);La.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Eb=La.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Eb.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);La=N.addEnumType("Microsoft.AppRuntime.AppRuntimeState");La.addEnumField("Inactive",0);La.addEnumField("Background",1);La.addEnumField("Visible",2);La=N.addEnumType("Microsoft.AppRuntime.Visibility");
La.addEnumField("Hidden",1);La.addEnumField("Visible",2);La=N.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);La.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Eb=La.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Eb.addParameter("jsonCreate","String",1,null,0);Eb=La.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Eb.addParameter("jsonUpdate",
"String",1,null,0);Eb=La.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Eb.addParameter("id","String",1,null,0);Eb=La.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Eb.addParameter("id","String",1,null,0);La.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);La=N.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);La.addProperty("Id",2,"String",1,!0,null,0);Eb=La.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",
0);Eb.addParameter("visibility","Boolean",1,null,0);La.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);La=N.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);La.addProperty("Enabled",3,"Boolean",1,!1,null,0);La.addProperty("Id",2,"String",1,!0,null,0);La.addProperty("Label",4,"String",1,!0,null,0);Eb=La.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Eb.addParameter("enabled","Boolean",1,null,0);La.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",
0);La=N.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);La.addMethod("GetCount",3,"Int32",1,1,"Count",0);Eb=La.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Eb.addParameter("key","String",1,null,0);La.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);La.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);La=N.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");La.addEnumField("Unknown",0);La.addEnumField("Basic",
1);La.addEnumField("Premium",2);La=N.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Eb=La.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Eb.addParameter("feature","String",1,null,0);Eb.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Eb=La.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",
0);Eb.addParameter("feature","String",1,null,0);Eb=La.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Eb.addParameter("feature","String",1,null,0);Eb.addParameter("fallbackValue","Boolean",1,null,0);La.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Eb=La.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Eb.addParameter("experienceId","String",1,null,0);Eb=La.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",
4);Eb.addParameter("feature","String",1,null,0);La=N.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);La.addProperty("Id",5,"String",1,!0,null,0);La.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);La.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);La=N.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);
La.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);La=N.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);La.addMethod("Disable",3,"Void",0,1,"Disable",0);La.addMethod("Enable",2,"Void",0,1,"Enable",0);La.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)};var qd=a(185);class Qd{constructor(N,La){this.Stg=N;this.mug=La}createAndOpenWorkbook(N){if(N&&
N.length>this.Stg)throw t.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",N.length),OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,qd.a.ga(1767));const La=new Yc("blank","agave",N?"streamBase64":"streamEmpty",N);let Eb=null;return OfficeExtension.WacRuntime.Utility.createPromise((kc,Mc)=>{const kd=new tc.StandardDialog;kd.Rb=4;kd.Dl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,rd=>{2===rd||0===rd?Mc("Cancelled"):
(Eb=window.open(""),this.mug.create(kc,Mc,La).k1a())})}).then(kc=>{if(!kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,qd.a.ga(1763));try{Eb.top.location.href=kc}catch(Mc){t.ULS.sendTraceTag(538572820,0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",sc.a.yp,Mc),t.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),
Eb.location.replace(kc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},kc=>{if("Cancelled"===kc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.pDd,qd.a.ga(1766));Eb.close();this.lJj();return null})}getTypeName(){return"Microsoft.ExcelServices.WacWorkbook"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 1:return this.C5g(La)}N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}C5g(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.createAndOpenWorkbook(N)}lJj(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
qd.a.ga(1763));}}Object(e.a)(Qd,"WacWorkbook",null,[]);const de=(N,La)=>{console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof N+", objectId="+N+", value="+La);return null},ye=N=>{N.add("InternalTest","PreviewExecutionMethod",de)};var Ee=a(248),Ke=a(732),zf=a(738);class Ef{constructor(N){this.jb=N}get $(){return this.jb}}Object(e.a)(Ef,"RichApiPreviewExecutionContext",null,[]);var Se=a(24),gg=a(866),Zf=a(33),Pf=a(208),qg=a(210),Ag=a(119),Yg=a(12);class ph extends qg.a{constructor(N,
La,Eb,kc){super(N,"Select Data");this.bpb=null;this.sHe=La;this.c6c=Eb;this.callback=kc}get uc(){return"DdaBindingPrompt"}start(N,La){let Eb="<div class='"+Ag.a.Qoh+" "+Cg.a.lp+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+Ag.a.gF+"' /></div>";Eb=String.format(Eb,vf.a.zg(this.c6c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Pb.innerHTML=Eb;this.bpb=Yg.DOMElementExtensions.getElementById(this.Pb,"bindingText");N=La?N.i3a(La,this.c6c.DdaBindingsMethod.BindingId):
null;(null===N||void 0===N?0:N.IsValidRef)?(La=new Se.Range(N.Reference.FirstRow+1,N.Reference.FirstColumn+1,N.Reference.LastRow+1,N.Reference.LastColumn+1,!1,!1),this.bpb.value=N.Reference.SheetName+"!"+La):(N=zg.g(this.$).ha,this.bpb.value=Wg.f(this.$.oa)||!N.sa.Bg?"":N.eia);this.initialize();this.ig()}Po(){this.L0c();this.addButton(0);this.addButton(1);super.Po()}setFocus(){Yg.DOMElementExtensions.setFocus(this.bpb)}validate(){return!0}commit(){let N=this.bpb.value.trim();const La=N.indexOf("!");
-1!==La&&(N=this.YXh(N.substring(0,La))+N.substr(La));this.sHe.addBinding(this.c6c,N,0,this.callback);return!0}Isa(){this.sHe.lQ.uf(Ke.a.internalError,this.callback);super.Isa()}YXh(N){N=ch.a.trimStart(N.trim(),"=");return N.length?N.startsWith("'")&&N.endsWith("'")?N:Eh.HelperMethods.t8b(N):""}}Object(e.a)(ph,"DdaBindingPrompt",qg.a,[]);class wf{constructor(N){this.ea=N}uf(N,La){if(La){const Eb={};Eb.Error=N;Eb.Version=this.ea.Je;La(Eb)}}eKa(N,La){this.uf(N,La)}wH(N,La){this.uf(Ke.a.eWe(N.Errors[0].MessageId),
La)}jv(N){N&&N(this.XP())}XP(){const N={Error:0};N.Version=this.ea.Je;return N}}Object(e.a)(wf,"DdaErrorGenerator",null,[]);var Te=a(282),tf=a(97);class If{constructor(N,La,Eb){this.$=N;this.lQ=La;this.mA=Eb}pyd(N,La){const Eb=N.DdaGoToByIdMethod.GoToType,kc=N.DdaGoToByIdMethod.SelectionMode,Mc=N.DdaGoToByIdMethod.Id.toString().trim(),kd=rd=>{const zd=this.$.xa.getItemByName(rd.SheetName);(null===zd||void 0===zd?0:zd.visible)?(zg.g(this.$).yg(rd,null,null,null,3,tf.a.bdh,void 0,void 0,void 0,void 0,
!0),this.lQ.jv(La)):this.lQ.uf(Ke.a.lWg,La)};0===Eb?this.QCi(Mc,kc,N.DdaMethod.ControlId,kd,La):1===Eb?this.UCi(Mc,kc,kd,La):this.lQ.uf(Ke.a.cQj,La)}QCi(N,La,Eb,kc,Mc){this.mA.ddaGetBinding(Eb,N,kd=>{if(!Te.a(kd)&&kd.Result&&kd.Result.Reference){kd=kd.Result;var rd={};rd.SheetName=kd.Reference.SheetName;rd.FirstRow=kd.Reference.FirstRow;rd.FirstColumn=kd.Reference.FirstColumn;rd.LastRow=kd.Reference.LastRow;rd.LastColumn=kd.Reference.LastColumn;If.tWc(rd,La);1!==kd.BindingType?kc(rd):this.mA.ddaGetBindingData(Eb,
N,1,0,2,0,0,-1,-1,zd=>{Te.a(zd)||!zd.Result?this.lQ.wH(zd,Mc):(zd=zd.Result,2!==La&&(rd.FirstRow-=zd.Headers.length,0>rd.FirstRow&&(rd.FirstRow=0)),kc(rd))},Mc)}else this.lQ.eKa(Ke.a.L6f,Mc)},Mc)}UCi(N,La,Eb,kc){var Mc=vh.z(N);Mc?(Mc=vh.v(Mc,this.$),If.tWc(Mc,La),Eb(Mc)):this.$.ea.isNamedObjectViewMode&&this.$.Ab.Lk(N)?this.$.Ab.oa=this.$.Ab.getItemByName(N):(Mc=kd=>{Te.a(kd)||!kd.Result?this.$.xa.contains(N)?(kd={},kd.SheetName=N,kd.FirstRow=0,kd.FirstColumn=0,kd.LastRow=0,kd.LastColumn=0,Eb(kd)):
this.lQ.eKa(Ke.a.L6f,kc):(kd=kd.Result,If.tWc(kd,La),Eb(kd))},this.$.xa.oa?this.mA.parseRangeForGoto(N,this.$.xa.oa.name,Mc,kc):this.mA.parseRange(N,Mc,kc))}static tWc(N,La){N.LastRow=2===La?N.FirstRow:N.LastRow;N.LastColumn=2===La?N.FirstColumn:N.LastColumn}}Object(e.a)(If,"DdaNavigator",null,[]);const og=(N,La,Eb,kc,Mc,kd)=>{const rd=N.Na(1);rd.request=La;return Hg.g(N,"ExecuteRichApiRequest",rd,Eb,kc,Mc,kd,0)};var cg=a(294),Tf;(function(N){N[N.unsupported=0]="unsupported";N[N.surface=1]="surface";
N[N.combo=2]="combo";N[N.column=3]="column";N[N.column3D=4]="column3D";N[N.bar=5]="bar";N[N.bar3D=6]="bar3D";N[N.line=7]="line";N[N.line3D=8]="line3D";N[N.pie=9]="pie";N[N.pie3D=10]="pie3D";N[N.scatter=11]="scatter";N[N.bubble=12]="bubble";N[N.area=13]="area";N[N.area3D=14]="area3D";N[N.doughnut=15]="doughnut";N[N.radar=16]="radar";N[N.stock=17]="stock";N[N.waterfall=18]="waterfall";N[N.funnel=19]="funnel";N[N.treemap=20]="treemap";N[N.sunburst=21]="sunburst";N[N.boxWhisker=22]="boxWhisker";N[N.histogram=
23]="histogram";N[N.pareto=24]="pareto";N[N.regionMap=25]="regionMap";N[N.noVisibleSeries=26]="noVisibleSeries";N[N.complexDataSource=27]="complexDataSource";N[N.pivotChart=28]="pivotChart"})(Tf||(Tf={}));Object(e.b)("ChartCategory",Tf);class Qf{constructor(N,La){this.source=N;this.eventId=La}}Object(e.a)(Qf,"MacroRecorderEventData",null,[]);class Gf{constructor(N,La,Eb){this.parentName=N;this.$=La;this.request=Eb}sWh(N){var La;if(void 0===N||null===N||void 0===N.RequestBody||null===N.RequestBody)return null;
const Eb=JSON.parse(N.RequestBody);if(void 0!==N.ActiveChartId&&null!==N.ActiveChartId){Eb.ActiveChartId=N.ActiveChartId;const kc=zg.g(this.$).ha.Qa.dc;if(null===(La=null===kc||void 0===kc?void 0:kc.floatingObject)||void 0===La?0:La.Tc)Eb.ActiveChartType=Tf[kc.floatingObject.Tc.ChartCategory]}void 0!==N.SheetMultiRange&&null!==N.SheetMultiRange&&(Eb.SheetName=N.SheetMultiRange.SheetName);return Eb}FWh(N){if(void 0===N||null===N||void 0===N.Result||null===N.Result)return null;N=N.Result;return void 0===
N.ResponseBody||null===N.ResponseBody||N.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(N.ResponseBody.join(""))}Lli(N){return!!N&&!(void 0===N.eventId||null===N.eventId)&&0<N.eventId.length}Qj(N){return()=>{if(this.$.Cba){const La=this.BSg(this.request);if(this.Lli(La)){const Eb=this.sWh(this.request),kc=this.FWh(N);if(Eb&&!Jh.a.isEmpty(Eb)&&kc&&!Jh.a.isEmpty(kc))return t.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new W(La,Eb,kc);t.ULS.sendTraceTag(537163163,0,50,`[RichApiRecorder]: Failed due to bad data: ${`requestInfo: ${Eb?"(not null)":"(null)"}; responseInfo: ${kc?"(not null)":"(null)"}`}`)}}return new W(null,null,null)}}BSg(N){const La=this.Mli(N.SolutionId),Eb=Gf.aWh(N);if(Eb&&La)return t.ULS.sendTraceTag(537163162,0,50,`[RichApiRecorder][${this.parentName}]: ${({["recorderEventId"]:Eb,["request.SolutionId"]:N.SolutionId})}`),new Qf(N.SolutionId,Eb);N=JSON.stringify({["recorderEventId"]:Eb,["isRecorderAwareAddin"]:La,
["request.SolutionId"]:N.SolutionId});t.ULS.sendTraceTag(537163161,0,50,`[RichApiRecorder][${this.parentName}]: ${N}`);return null}Mli(N){if(!N)return!1;N=N.toLowerCase();return Gf.U0h().contains(N)}static U0h(){Gf.Sza||(Gf.Sza=new v.a(R.a.Zk()),Gf.Sza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Gf.Sza.add("fa000000005"),Gf.Sza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Gf.Sza.add("fa000000014"),Gf.Sza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return Gf.Sza}static aWh(N){let La=null;var Eb=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',
"mi");if(Eb.test(N.RequestBody))La=Eb.exec(N.RequestBody)[1];else{N=N.RequestHeaders;if(!N)return La;Eb=Qe.a.uFi.toLowerCase();for(let kc=0;kc<N.length;kc++)if(N[kc].Name.toLowerCase()===Eb){La=N[kc].Value;break}}return La}}Gf.Sza=null;Object(e.a)(Gf,"DdaRichApiRequestRecorder",null,[]);class Uf extends cg.a{constructor(N,La,Eb,kc,Mc,kd,rd,zd){super(10,0,La,zd);this.Ylb=Eb;this.qib=kc;this.t3=Mc;this.vFa=kd;this.request=rd;this.cNd=new Gf("10",N,rd)}get WF(){return z.EwaSettings.$b()?super.WF:2}get $Cc(){return this.vFa}get It(){return this.Ylb}get naa(){return this.qib}G2(N){return super.G2(N)||
this.hVg(N)}Qj(){return this.cNd.Qj(this.ed)}Teb(){const N={OperationType:3};N.RichApiRequest=this.request;return N}hVg(N){return(La,Eb,kc)=>og(N,this.request,Of.b(La,this.Ylb),Of.a(Eb,this.qib),kc,this.t3)}}Object(e.a)(Uf,"DdaRichApiRequestBatchOperation",cg.a,[]);class rg extends Bh.a{constructor(N,La,Eb,kc){super(576,0,Eb,kc);this.cNd=new Gf("576",N,La)}get WF(){return z.EwaSettings.$b()?super.WF:0}Qj(){return this.cNd.Qj(this.ed)}}Object(e.a)(rg,"DdaRichApiRequestOperation",Bh.a,[]);class bh{constructor(N,
La){this.pI=(Eb,kc)=>{this.lQ.eKa(Ke.a.internalError,kc)};this.$=N;this.lQ=La}ddaAddBinding(N,La,Eb,kc,Mc,kd,rd){this.XJ((zd,Od,Ud)=>{var Ne=this.$.pa.va,Oe=this.tja();zd=Of.b(zd,kd);Od=Of.a(Od,this.pI);const ef=Ne.Na(9);ef.controlId=N;ef.bindingId=La;ef.bindingType=Eb;ef.currentSheetName=Oe;ef.formula=kc;ef.options=Mc;return Hg.g(Ne,"DdaAddBinding",ef,zd,Od,Ud,rd,0)},rd,563)}ddaReleaseBinding(N,La,Eb,kc){this.XJ((Mc,kd,rd)=>{var zd=this.$.pa.va;Mc=Of.b(Mc,Eb);kd=Of.a(kd,this.pI);const Od=zd.Na(9);
Od.controlId=N;Od.bindingId=La;return Hg.g(zd,"DdaReleaseBinding",Od,Mc,kd,rd,kc,0)},kc,564)}ddaGetBinding(N,La,Eb,kc){this.XJ((Mc,kd,rd)=>{var zd=this.$.pa.va;Mc=Of.b(Mc,Eb);kd=Of.a(kd,this.pI);const Od=zd.Na(1);Od.controlId=N;Od.bindingId=La;return Hg.g(zd,"DdaGetBinding",Od,Mc,kd,rd,kc,0)},kc,565,16)}ddaGetAllBindings(N,La,Eb){this.XJ((kc,Mc,kd)=>{var rd=this.$.pa.va;kc=Of.b(kc,La);Mc=Of.a(Mc,this.pI);const zd=rd.Na(1);zd.controlId=N;return Hg.g(rd,"DdaGetAllBindings",zd,kc,Mc,kd,Eb,0)},Eb,566,
16)}ddaGetBindingData(N,La,Eb,kc,Mc,kd,rd,zd,Od,Ud,Ne){this.XJ((Oe,ef,lg)=>{var $f=this.$.pa.va,ag=this.tja();Oe=Of.b(Oe,Ud);ef=Of.a(ef,this.pI);const Mf=$f.Na(1);Mf.controlId=N;Mf.bindingId=La;Mf.coerceType=Eb;Mf.valueFormat=kc;Mf.filterType=Mc;Mf.startRow=kd;Mf.startCol=rd;Mf.rowCount=zd;Mf.colCount=Od;Mf.currentSheetName=ag;return Hg.g($f,"DdaGetBindingData",Mf,Oe,ef,lg,Ne,0)},Ne,567,16)}ddaSetBindingData(N,La,Eb,kc,Mc,kd,rd){this.XJ((zd,Od,Ud)=>{var Ne=this.$.pa.va,Oe=this.tja();zd=Of.b(zd,kd);
Od=Of.a(Od,this.pI);const ef=Ne.Na(9);ef.controlId=N;ef.bindingId=La;ef.startRow=Eb;ef.startCol=kc;ef.currentSheetName=Oe;ef.bindingData=Mc;return Hg.g(Ne,"DdaSetBindingData",ef,zd,Od,Ud,rd,0)},rd,568)}ddaGetSelectedData(N,La,Eb,kc,Mc,kd,rd){this.XJ((zd,Od,Ud)=>{var Ne=this.$.pa.va,Oe=this.tja();zd=Of.b(zd,kd);Od=Of.a(Od,this.pI);const ef=Ne.Na(1);ef.controlId=N;ef.coerceType=La;ef.valueFormat=Eb;ef.filterType=kc;ef.currentSheetName=Oe;ef.formula=Mc;return Hg.g(Ne,"DdaGetSelectedData",ef,zd,Od,Ud,
rd,0)},rd,569,16)}ddaSetSelectedData(N,La,Eb,kc,Mc){this.XJ((kd,rd,zd)=>{var Od=this.$.pa.va,Ud=this.tja();kd=Of.b(kd,kc);rd=Of.a(rd,this.pI);const Ne=Od.Na(9);Ne.controlId=N;Ne.currentSheetName=Ud;Ne.formula=La;Ne.bindingData=Eb;return Hg.g(Od,"DdaSetSelectedData",Ne,kd,rd,zd,Mc,0)},Mc,570)}ddaLoadSettings(N,La,Eb){this.XJ((kc,Mc,kd)=>{var rd=this.$.pa.va;kc=Of.b(kc,La);Mc=Of.a(Mc,this.pI);const zd=rd.Na(1);zd.controlId=N;return Hg.g(rd,"DdaLoadSettings",zd,kc,Mc,kd,Eb,0)},Eb,501,16)}ddaSaveSettings(N,
La,Eb,kc,Mc){this.XJ((kd,rd,zd)=>{var Od=this.$.pa.va;kd=Of.b(kd,kc);rd=Of.a(rd,this.pI);const Ud=Od.Na(9);Ud.controlId=N;Ud.settings=La;Ud.overwriteIfStale=Eb;return Hg.g(Od,"DdaSaveSettings",Ud,kd,rd,zd,Mc,0)},Mc,571)}ddaAddRowsColumns(N,La,Eb,kc,Mc,kd){this.XJ((rd,zd,Od)=>{var Ud=this.$.pa.va,Ne=this.tja();rd=Of.b(rd,Mc);zd=Of.a(zd,this.pI);const Oe=Ud.Na(9);Oe.controlId=N;Oe.bindingId=La;Oe.isRow=Eb;Oe.currentSheetName=Ne;Oe.bindingData=kc;return Hg.g(Ud,"DdaAddRowsColumns",Oe,rd,zd,Od,kd,0)},
kd,572)}ddaDeleteAllDataValues(N,La,Eb,kc){this.XJ((Mc,kd,rd)=>{var zd=this.$.pa.va,Od=this.tja();Mc=Of.b(Mc,Eb);kd=Of.a(kd,this.pI);const Ud=zd.Na(9);Ud.controlId=N;Ud.bindingId=La;Ud.currentSheetName=Od;return Hg.g(zd,"DdaDeleteAllDataValues",Ud,Mc,kd,rd,kc,0)},kc,573)}ddaClearBindingFormats(N,La,Eb,kc){this.XJ((Mc,kd,rd)=>{var zd=this.$.pa.va,Od=this.tja();Mc=Of.b(Mc,Eb);kd=Of.a(kd,this.pI);const Ud=zd.Na(9);Ud.controlId=N;Ud.bindingId=La;Ud.currentSheetName=Od;return Hg.g(zd,"DdaClearBindingFormats",
Ud,Mc,kd,rd,kc,0)},kc,574)}ddaSetBindingFormats(N,La,Eb,kc,Mc,kd){this.XJ((rd,zd,Od)=>{var Ud=this.$.pa.va,Ne=this.tja();rd=Of.b(rd,Mc);zd=Of.a(zd,this.pI);const Oe=Ud.Na(9);Oe.controlId=N;Oe.bindingId=La;Oe.currentSheetName=Ne;Oe.bindingData=Eb;Oe.isSetFormats=kc;return Hg.g(Ud,"DdaSetBindingFormats",Oe,rd,zd,Od,kd,0)},kd,575)}parseRange(N,La,Eb){this.XJ((kc,Mc,kd)=>{const rd=this.$.pa.va.Tb();return Hg.v(this.$.pa.va,N,-1,Of.b(kc,La),Of.a(Mc,this.pI),kd,Eb,rd)},Eb,162,16)}parseRangeForGoto(N,La,
Eb,kc){this.XJ((Mc,kd,rd)=>{const zd=this.$.pa.va.Tb();return Hg.w(this.$.pa.va,N,La,Of.b(Mc,Eb),Of.a(kd,this.pI),rd,kc,zd)},kc,562,16)}executeRichApiRequest(N,La,Eb){z.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(N.RequestFlags&=8191);if(z.EwaSettings.ma(258))this.kyh(this.$.pa.va.Tb(),La,()=>{this.lQ.eKa(Ke.a.internalError,Eb)},Eb,N);else{let kc=sg.DdaFacade.fgd(N);!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.rb.iy||kc&16?(z.EwaSettings.$b()&&(kc|=64),this.$.userOperationManager.cs(new rg(this.$,N,(Mc,kd,rd)=>og(this.$.pa.va,N,Of.b(Mc,La),Of.a(kd,this.pI),rd,Eb),kc))):(this.lQ.eKa(Ke.a.ZDc,Eb),t.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}}tja(){return this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.activeItemName}XJ(N,La,Eb,kc=0){!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.iy||kc&16?z.EwaSettings.$b()?
this.$.userOperationManager.cs(new Bh.a(Eb,0,N,kc|64)):this.$.userOperationManager.cs(new oi.a(Eb,0,N,kc)):(this.lQ.eKa(Ke.a.ZDc,La),t.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))}kyh(N,La,Eb,kc,Mc){let kd=sg.DdaFacade.fgd(Mc);if(!z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.rb.iy||kd&16){var rd=this.$.Jb.Bc("UserAction","Rich Api request");z.EwaSettings.$b()&&(kd|=64);this.$.userOperationManager.Wb(new Uf(this.$,N,La,
Eb,kc,rd,Mc,kd),null)}else this.lQ.eKa(Ke.a.ZDc,kc),t.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")}}Object(e.a)(bh,"DdaWebServiceHelper",null,[]);class Vf{constructor(N,La,Eb,kc){this.Yzh=N;this.fileSize=La;this.JCj=kc}}Object(e.a)(Vf,"DocumentFile",null,[]);class kh{}kh.generalException="GeneralException";kh.YKg="ApiNotFound";kh.pDd="OperationCancelled";kh.invalidArgument="InvalidArgument";Object(e.a)(kh,"ErrorCodes",null,[]);class vi{replaceShortcuts(){return Promise.reject("ReplaceShortcuts method is not overridden")}getShortcuts(){return Promise.reject("GetShortcuts method is not overridden")}checkShortcutsInUse(){return Promise.reject("CheckShortcutsInUse method is not overridden")}}
Object(e.a)(vi,"WacApiDelegates",null,[]);var Zi=a(616);class $h extends vi{constructor(N,La){super();this.qif=(Eb,kc)=>{Eb=$h.Y3g(Eb,kc);if(!Zi.a(this.$,Eb))return!0;Eb=this.$.shortcutKeyManager.K3e(Eb);return!!Eb&&0<Eb.length};this.addinId=N;this.$=La}replaceShortcuts(N){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,N,this.qif)}getShortcuts(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)}checkShortcutsInUse(N){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(N,
this.qif)}static w8g(N,La){const Eb=document.createEvent("KeyboardEvent");if(sc.a.JF)Eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(N&8),!!(N&32),!!(N&4),!!(N&256));else{const kc=[];N&4&&kc.push("Shift");N&8&&kc.push("Control");N&32&&kc.push("Alt");Eb.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,kc.join(" "),!1,"en-US")}N=new Sys.UI.DomEvent(Eb);N.keyCode=La;return N}static Y3g(N,La){if(sc.a.Uf)switch(La){case 189:La=173;break;case 187:La=61;break;case 186:La=59}return $h.w8g(N,
La)}}Object(e.a)($h,"ExcelWacApiDelegates",vi,[]);class Xf{constructor(N){this.NIa={};this.Lzi=N}nCg(N,La){this.Adc(N)||(this.NIa[N]={});if(this.bhi(N))return t.ULS.sendTraceTag(537163157,344,50,`App ${N} has reach the limit of number of cached files.`),Ke.a.rAi;this.NIa[N][La.Yzh.toString()]=La;return Ke.a.success}ONh(N,La){let Eb=null;this.Adc(N)&&(Eb=this.NIa[N][La.toString()]);Eb||t.ULS.sendTraceTag(537163156,344,15,`File cache for [agave:${N}, fileHandler:${La}] doesn't exist`);return Eb}Adc(N){return N in
this.NIa}T9i(N,La){if(this.Adc(N)){const Eb=this.NIa[N];delete Eb[La.toString()];1>Object.keys(Eb).length&&delete this.NIa[N];return La.toString()in Eb?Ke.a.internalError:Ke.a.success}return Ke.a.internalError}bhi(N){return this.Adc(N)?Object.keys(this.NIa[N]).length>=this.Lzi:!1}static getInstance(N){return N.da.za(200)||N.da.Ga(200,new Xf(Xf.Mzi))}static DDi(){return++Xf.zUg}}Xf.pzi=4194304;Xf.Mzi=1;Xf.zUg=0;Object(e.a)(Xf,"GetFileApiHelper",null,[]);class Og{constructor(N){this.zA=N}notifyActionHandlerReady(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.zA)}getTypeName(){return"Microsoft.InternalService.AddinInternalService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.hEi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){N=this.invokeMethod(N,
La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}hEi(){this.notifyActionHandlerReady();return null}}Object(e.a)(Og,"AddinInternalService",null,[]);class Zg{constructor(N,La){this.dJ=La;this.zA=N}getAppRuntimeState(){return this.dJ.getAppRuntimeState(this.zA)?2:1}setAppRuntimeState(N){switch(N){case 2:N=!0;break;case 1:N=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,qd.a.ga(1767));}this.dJ.setAppRuntimeState(this.zA,N)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,La){switch(N){case 2:return this.TIh();case 1:return this.Joj(La)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,
La){N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}TIh(){return this.getAppRuntimeState()}Joj(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"int");this.setAppRuntimeState(N);return null}}Object(e.a)(Zg,"AppRuntimeService",null,[]);var Wf=a(969);class Ig{constructor(N,La,Eb,kc){this.lx=N;this.q1=Eb;this.Ny=kc.Xh.getOsfControl(La)}disable(){try{if(!qd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.jEe();
if(!this.Nhf())return this.kEe();this.q1.jPj(this.lx)}catch(N){return t.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",N.message||"Unknown"),this.hEe()}return null}enable(){try{if(!qd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.jEe();if(!this.Nhf())return this.kEe();this.q1.S7i(this.lx)}catch(N){return t.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
N.message||"Unknown"),this.hEe()}return null}_OnAccess(){}getTypeName(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,
La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){switch(N){case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 3:return this.Igh();case 2:return this.Clh()}N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Igh(){return this.disable()}Clh(){return this.enable()}ACa(){this._OnAccess();return null}jEe(){return Wf.a(eg.a.notImplemented,
qd.a.ga(1768))}kEe(){return Wf.a(eg.a.sharedRuntimeNotAvailable,qd.a.ga(1772))}hEe(){return Wf.a(eg.a.generalException,qd.a.ga(1763))}Nhf(){const N=this.Ny.getSharedRuntimeId();return!!N&&0<N.length}}Object(e.a)(Ig,"BeforeDocumentCloseNotification",null,[]);class fh{constructor(){this.Qie=this.Xce=this.vA=!1}get enabled(){return this.vA}set enabled(N){this.vA=N}get nativeRuntime(){return this.Xce}set nativeRuntime(N){this.Xce=N}get streamingEnabled(){return this.Qie}set streamingEnabled(N){this.Qie=
N}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"}invokePropertyGet(N){switch(N){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N,La){switch(N){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,
0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(La,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,La){N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}}Object(e.a)(fh,"CustomFunctionEngineStatus",null,[]);class sh{constructor(N,La,Eb){this.dsg=N;this.esg=La;this.awg=Eb}get status(){const N=new fh;N.enabled=this.dsg;N.streamingEnabled=this.esg;N.nativeRuntime=!1;return N}register(N){return OfficeExtension.WacRuntime.Utility.createPromise(this.awg(N))}getTypeName(){return"Microsoft.ExcelServices.CustomFunctionManager"}invokePropertyGet(N){switch(N){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 1:return this.I8i(La)}N=this.invokeMethod(N,
La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}I8i(N){const La=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"string");return this.register(La,N)}}Object(e.a)(sh,"CustomFunctionManager",null,[]);var Ch=a(946);class ai{constructor(N,La,Eb,kc){this.g4d="";this.XSb=0;this.ZO=N;this._id=La;this.zA=Eb;this.dJ=kc}get id(){return this._id}_RegisterStateChange(){this.XSb||this.ZO.execute(N=>
{this.g4d=N.Mma(this._id,La=>{this.dJ.cCh(this.zA,this._id,JSON.stringify(La))})});this.XSb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.XSb--;this.XSb||this.ZO.execute(N=>{N.DJd(this._id,this.g4d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(N){switch(N){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 6:return this.Glg();case 7:return this.Ilg()}N=
this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}Glg(){return this._RegisterStateChange()}Ilg(){return this._UnregisterStateChange()}}Object(e.a)(ai,"LicenseFeature",null,[]);class cj{constructor(N,La){this.ZO=Ed.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.zA=N;this.dJ=La;this.Pug=this.dJ.Xh.getOsfControl(this.zA)}getFeatureTier(N,La){return OfficeExtension.WacRuntime.Utility.createPromise(Eb=>{const kc=1===La?1:2===
La?2:0;this.ZO.execute(Mc=>{Mc.getFeatureTier(N,kc).then(kd=>{Eb(this.XRh(kd))},()=>{Eb(La)})})})}getLicenseFeature(N){N=new ai(this.ZO,N,this.zA,this.dJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}isFeatureEnabled(N,La){return OfficeExtension.WacRuntime.Utility.createPromise(Eb=>{this.ZO.execute(kc=>{kc.isFeatureEnabled(N,La).then(Mc=>{Eb(Mc)},()=>{Eb(La)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(N=>{this.ZO.execute(La=>{La=
La.isFreemiumUpsellEnabled();N(La)})})}launchUpsellExperience(N){if(this.Pug.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.ZO.execute(La=>{La.launchUpsellExperience(N)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.JTc,"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N,La){switch(N){case 6:return this.Hlg(La)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 2:return this.HOh(La);case 5:return this.WRh(La);
case 1:return this.Ohi(La);case 3:return this.vii();case 4:return this.Yri(La)}N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}HOh(N){const La=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"int");return this.getFeatureTier(La,N)}WRh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getLicenseFeature(N)}Ohi(N){const La=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,
0,"string");N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,1,"boolean");return this.isFeatureEnabled(La,N)}vii(){return this.isFreemiumUpsellEnabled()}Yri(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.launchUpsellExperience(N)}Hlg(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");this._TestFireStateChangedEvent(N);return null}XRh(N){switch(N){case 1:return 1;case 2:return 2;default:return 0}}}Object(e.a)(cj,"License",
null,[]);var ij=a(152);const dj=(N,La,Eb)=>kc=>(Mc,kd)=>{cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(La.da,279,La.la,1),rd=>{rd=rd.result;let zd=!1;var Od=Eb.Xh.getOsfControl(N);let Ud=null;Od&&(Ud=Od.getStoreType(),(Od=Od.getManifest())&&Od.getSharedRuntimeForCustomFunctions("Workbook")&&(zd=!0));cf.TaskExtensions.Aa(rd.Gbf(N,Ud,kc,zd),Ne=>{ij.b(Ne)?Ne.result?Mc(null):kd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.invalidArgument,vd.a.instance.ga(1767))):kd(OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,
vd.a.instance.ga(1763)))},La.la,3)},La.la,3)};class $i{constructor(N){if(!N)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.xwd=N}areShortcutsInUse(N){return OfficeExtension.WacRuntime.Utility.createPromise((La,Eb)=>{this.xwd.checkShortcutsInUse(N).then(kc=>{La(kc)}).catch(kc=>{Eb(kc)})})}getShortcuts(){return OfficeExtension.WacRuntime.Utility.createPromise((N,La)=>{this.xwd.getShortcuts().then(Eb=>{N(Eb)}).catch(Eb=>{La(Eb)})})}replaceShortcuts(N){return OfficeExtension.WacRuntime.Utility.createPromise((La,
Eb)=>{this.xwd.replaceShortcuts(N).then(()=>{La(null)}).catch(kc=>{Eb(kc)})})}getTypeName(){return"Microsoft.Office.ActionService"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokeMethodAsync(N,La){switch(N){case 3:return this.GMg(La);case 1:return this.bYh();case 2:return this.qej(La)}N=this.invokeMethod(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}GMg(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"Array<string>");return this.areShortcutsInUse(N)}bYh(){return this.getShortcuts()}qej(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"any");return this.replaceShortcuts(N)}}Object(e.a)($i,"ActionService",
null,[]);var jj=a(518);class ej{constructor(){this.tra=null}QXh(){this.tra||(this.tra=jj.a.er(Ed.a.instance.Ub("Common.App.SharedFilePicker.ISharedFilePicker")));return this.tra}getSharedFilePickerResponse(N){return OfficeExtension.WacRuntime.Utility.createPromise((La,Eb)=>{try{const kc=this.QXh();mh.Task.WAA.call(null,kc).continueWith(()=>{const Mc=kc.result;if(Mc){let kd={};({fu:kd}=oe.d(N)).returnValue?Mc.Ped(kd).then(rd=>{rd&&0<rd.length?La(rd):Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(rd=>{Eb(rd)}):Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Eb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(kc){Eb(kc)}})}getTypeName(){return"Microsoft.Office.SharedFilePicker"}invokePropertyGet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);
}invokePropertyGetAsync(N){N=this.invokePropertyGet(N);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}invokePropertySet(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokePropertySetAsync(N,La){this.invokePropertySet(N,La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(N){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(N);}invokeMethodAsync(N,La){switch(N){case 1:return this.PXh(La)}N=this.invokeMethod(N,
La);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(N)}PXh(N){N=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(N,0,"string");return this.getSharedFilePickerResponse(N)}}Object(e.a)(ej,"SharedFilePicker",null,[]);class fj{createInstance(N,La){switch(N){case "Microsoft.Office.ActionService":return new $i(La);case "Microsoft.Office.SharedFilePicker":return new ej}return null}}Object(e.a)(fj,"WacApiHost",null,[]);class gj{constructor(N,La,Eb,kc,Mc){this.nTc=null;this.eRb=
N;this.zA=La;this.dJ=Eb;this.jb=kc;this.Xzg=Mc}hostName(){return"ExcelOnline"}appId(){return this.eRb}createInstance(N){switch(N){case "Microsoft.Authentication.AuthenticationService":return Ed.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.zA,this.dJ.Xh);case "Microsoft.Authentication.TokenParameters":return new Mh;case "Microsoft.ExcelServices.CustomFunctionManager":N=this.jb.ma(121);var La=this.jb.ma(122);return new sh(N,La,dj(this.eRb,
this.jb,this.dJ));case "Microsoft.AppRuntime.AppRuntimeService":return new Zg(this.zA,this.dJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return N=Ee.a(this.jb),new Ig(this.eRb,this.zA,N,this.dJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return N=Ee.a(this.jb),new Ch.DynamicRibbon(this.eRb,this.zA,this.dJ,N,N.pn(this.zA).tl);case "Microsoft.Office.Licensing.License":return new cj(this.zA,this.dJ);case "Microsoft.InternalService.AddinInternalService":return new Og(this.zA);
default:if(this.nTc||(this.nTc=new fj),La=this.nTc.createInstance(N,this.Xzg))return La}t.ULS.sendTraceTag(537163155,0,10,`Typename: ${N} is an invalid parameter for the RichApiHost.CreateInstance method.`);throw OfficeExtension.WacRuntime.Utility.createRichApiException(eg.a.generalException,eg.a.generalException);}}Object(e.a)(gj,"RichApiHost",null,[]);var kj=a(380),hj=a(28),lj=a(118),aj=a(35),mj=a(100),nj=a(285),oj=a(42),pj=a(249),qj=a(6),rj=a(68),sj=a(199);class qf{constructor(N,La,Eb){this.rangePicker=
null;this.$=N;this.re=La;this.xe=new wf(N.ea);this.mA=new bh(N,this.xe);this.ktf=Eb;this.w9b=new Map}get lQ(){return this.xe}dispose(){this.$=this.w9b=null}Lc(){return!1}Oc(){return!1}executeCommand(N,La,Eb){N=La.command;switch(N){case 451041795:this.xe.uf(Eb[Kg.a.kg],Eb[Kg.a.t3]);break;case 974713501:this.w3h(Eb[Kg.a.kg],Eb[Kg.a.t3]);break;case 1237877382:this.xe.jv(Eb[Kg.a.t3]);break;default:return ci.a(N)}return mh.Task.Ta(!0)}Ac(N,La,Eb){if(N=!!Eb)switch(La.command){case 974713501:case 1237877382:case 451041795:break;
default:N=!1}return N}w3h(N,La){var Eb;const kc=N.DdaMethod;if("undefined"===typeof kc.DispatchId)this.xe.uf(Ke.a.internalError,La);else if(qf.Vgi(N)||this.$.Cd&1){if(kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new ph(this.$,this,N,La)).start(this.re,N.DdaMethod.ControlId):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.qXh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.htj(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(N,this.med(N.DdaMethod.ControlId),0,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.AJh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.Uoj(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.zJh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.S9i(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.xIh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.yud(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(N.DdaAddRowsColumns.IsRow=!0,this.une(N,La)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(N.DdaAddRowsColumns.IsRow=!1,this.une(N,La)):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.peh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.ZYg(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(N.DdaSetBindingFormats.IsSetFormats=!0,this.UZf(N,La)):kc.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(N.DdaSetBindingFormats.IsSetFormats=!1,this.UZf(N,La)):kc.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(N,N.DdaBindingsMethod.ItemName,N.DdaBindingsMethod.FailOnCollision?2:1,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.LOh(La):kc.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pyd(N,La):kc.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.LNh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.MNh(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.U9i(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(N.DdaMethod.ControlId,N),this.xe.jv(La)):
kc.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?z.EwaSettings.ma(23)?this.xe.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,La):this.NAi(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?z.EwaSettings.ma(23)?this.xe.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,La):this.JAi(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(N,La):kc.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(N,La):this.xe.uf(Ke.a.tDd,La),z.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&kc.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){N=this.re.XY(N.DdaMethod.ControlId);La="";if(N){La=sg.DdaFacade.getSolutionId(N,this.$);let Mc=N.PrimaryMarketplace.MarketplaceType;Mc===OSF.StoreType.InMemory?N.OwnerAddinSolutionId&&N.AssetMarketplace&&(Mc=N.AssetMarketplace.MarketplaceType):Mc===OSF.StoreType.WopiCatalog&&(Mc=OSF.StoreType.OMEX);
La=Telemetry.PrivacyRules.GetPrivacyCompliantId(La,Mc,null===(Eb=N.AssetMarketplace)||void 0===Eb?void 0:Eb.SolutionId,null,null,N.PrimaryMarketplace.MarketplaceRef)}t.ULS.sendTraceTag(537163224,344,50,`DDA method Id: ${kc.DispatchId}, AppID: ${La}`)}}else this.xe.uf(Ke.a.fKe,La)}AJh(N,La){N.DdaGetBindingData.CoerceType=qf.j3b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.FilterType=qf.OTe(N.DdaGetBindingData.FilterType);N.DdaGetBindingData.ValueFormat=qf.Sgg(N.DdaGetBindingData.ValueFormat);
if(this.Kic(N.DdaGetBindingData.CoerceType,La)){if(N.DdaGetBindingData){const Eb=N.DdaGetBindingData;0===Eb.FilterType&&(Eb.FilterType=2);Eb.StartCol|=0;Eb.StartRow|=0;Eb.ColCount=void 0===Eb.ColCount?-1:Eb.ColCount;Eb.RowCount=void 0===Eb.RowCount?-1:Eb.RowCount}this.mA.ddaGetBindingData(N.DdaMethod.ControlId,N.DdaGetBindingData.BindingId,N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,N.DdaGetBindingData.StartRow,N.DdaGetBindingData.StartCol,N.DdaGetBindingData.RowCount,
N.DdaGetBindingData.ColCount,Eb=>{if(Te.a(Eb)||!Eb.Result)this.xe.wH(Eb,La);else{const kc=this.xe.XP();kc.Data=qf.Ive(Eb.Result);La(kc)}},La)}}Uoj(N,La){N.DdaSetBindingData.CoerceType=qf.j3b(N.DdaSetBindingData.CoerceType);if(this.Kic(N.DdaSetBindingData.CoerceType,La)){var Eb=qf.jZc(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data);qf.Nfc(Eb)?this.xe.uf(Ke.a.MBc,La):(1===Eb.CoerceType&&(Eb.CellFormat||(Eb.CellFormat=N.DdaSetBindingData.CellFormat),Eb.TableOptions||(Eb.TableOptions=N.DdaSetBindingData.TableOptions)),
N.DdaSetBindingData&&(N.DdaSetBindingData.StartCol|=0,N.DdaSetBindingData.StartRow|=0),this.mA.ddaSetBindingData(N.DdaMethod.ControlId,N.DdaSetBindingData.BindingId,N.DdaSetBindingData.StartRow,N.DdaSetBindingData.StartCol,Eb,kc=>{Te.a(kc)?this.xe.wH(kc,La):this.xe.jv(La)},La))}}qXh(N,La){N.DdaGetBindingData.CoerceType=qf.j3b(N.DdaGetBindingData.CoerceType);N.DdaGetBindingData.ValueFormat=qf.Sgg(N.DdaGetBindingData.ValueFormat);N.DdaGetBindingData.FilterType=qf.OTe(N.DdaGetBindingData.FilterType);
if(this.Kic(N.DdaGetBindingData.CoerceType,La)){var Eb=this.med(N.DdaMethod.ControlId);Eb?this.mA.ddaGetSelectedData(N.DdaMethod.ControlId,N.DdaGetBindingData.CoerceType,N.DdaGetBindingData.ValueFormat,N.DdaGetBindingData.FilterType,Eb,kc=>{if(Te.a(kc))this.xe.wH(kc,La);else{const Mc=this.xe.XP();Mc.Data=qf.Ive(kc.Result);La(Mc)}},La):this.xe.uf(Ke.a.s3e,La)}}LNh(N,La){const Eb=N[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],kc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],
Mc=N.DdaMethod.ControlId,kd=Xf.getInstance(this.$);if(0>=kc)t.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.xe.uf(Ke.a.Cdi,La);else if(kc>Xf.pzi)t.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.xe.uf(Ke.a.rZe,La);else{var rd=null;switch(Eb){case 1:rd="Compressed";break;case 0:rd="Text";break;case 2:rd="Pdf";break;default:t.ULS.sendTraceTag(537163219,344,15,`Requested file type ${Eb} is not supported.`);
this.xe.uf(Ke.a.CTe,La);return}if("Text"===rd)t.ULS.sendTraceTag(537163218,344,15,`Requested file type ${rd} is not supported.`),this.xe.uf(Ke.a.CTe,La);else{z.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(N=new Sys.StringBuilder,N.append(gg.a(this.$,rd)),"Pdf"===rd&&Pf.a.Kg(N,Qe.a.$Gd,"WholeWorkbook"),N=N.toString()):N=gg.a(this.$,rd);var zd=null,Od=new XMLHttpRequest;Od.onreadystatechange=()=>{if(4===Od.readyState)if(200===Od.status){var Ud=Od.response;
if(Ud){zd=new Uint8Array(Ud);Ud=this.xe.XP();var Ne=zd.length,Oe=Xf.DDi(),ef={},lg=0;for(let $f=0;$f<Ne;$f+=kc){const ag=[],Mf=$f+kc<Ne?$f+kc:Ne;for(let mg=0,Lg=$f;Lg<Mf;mg++,Lg++)ag[mg]=zd[Lg];ef[(lg++).toString()]=ag}ef=new Vf(Oe,Ne,kc,ef);ef=kd.nCg(Mc,ef);ef!==Ke.a.success?this.xe.uf(ef,La):(Ud[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Oe,Ud[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Ne,t.ULS.sendTraceTag(537163216,344,50,`GetFileAsync get file successfully for file type ${rd}, the file size is ${Ne}`),
La(Ud))}else t.ULS.sendTraceTag(537163217,344,15,`Request is successful, but respone have no data for file type ${rd}.`),this.xe.uf(Ke.a.internalError,La)}else 500===Od.status?this.xe.uf(Ke.a.eWe(parseInt(Od.statusText,10)),La):(t.ULS.sendTraceTag(537163215,344,15,`Request failed to obtain the file for type ${rd}.`),this.xe.uf(Ke.a.kDi,La))};Od.open("GET",N,!0);Od.responseType="arraybuffer";Od.setRequestHeader("If-Modified-Since","0");Od.send(null)}}}MNh(N,La){var Eb=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],
kc=N[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];N=N.DdaMethod.ControlId;(Eb=Xf.getInstance(this.$).ONh(N,Eb))?(Eb=Eb.JCj,0>kc||kc>=Object.keys(Eb).length?this.xe.uf(Ke.a.n9h,La):(kc=Eb[kc.toString()],Eb=this.xe.XP(),Eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=kc,Eb[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=kc.length,La(Eb))):this.xe.uf(Ke.a.internalError,La)}U9i(N,La){var Eb=N[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];N=
N.DdaMethod.ControlId;Eb=Xf.getInstance(this.$).T9i(N,Eb);Eb===Ke.a.success?this.xe.jv(La):this.xe.uf(Eb,La)}htj(N,La){N.DdaSetBindingData.CoerceType=qf.j3b(N.DdaSetBindingData.CoerceType);if(this.Kic(N.DdaSetBindingData.CoerceType,La)){var Eb=this.med(N.DdaMethod.ControlId);if(Eb){var kc=qf.jZc(N.DdaSetBindingData.CoerceType,N.DdaSetBindingData.Data),Mc=zg.g(this.$).ha;1===kc.CoerceType&&(!kc.Data&&Mc.sa.n5&&(kc.Headers||(kc.Headers=[]),kc.Headers.length||kc.Headers.push([]),kc.Headers[0].length||
kc.Headers[0].push("")),qf.Nfc(kc)||(kc.CellFormat||(kc.CellFormat=N.DdaSetBindingData.CellFormat),kc.TableOptions||(kc.TableOptions=N.DdaSetBindingData.TableOptions)));if(qf.Nfc(kc))this.xe.uf(Ke.a.MBc,La);else{var kd=Mc.sa.Xc.clone(),rd=Mc.sa.activeCell.clone();this.mA.ddaSetSelectedData(N.DdaMethod.ControlId,Eb,kc,zd=>{var Od;if(Te.a(zd))this.xe.wH(zd,La);else{zd=kd.clone();const Ud=kc.Headers?kc.Headers[0].length:kc.Data[0].length;1!==kc.CoerceType||kc.Data?1===kc.CoerceType&&(null===(Od=kc.TableOptions)||
void 0===Od?0:Od.length)&&0==kc.TableOptions[0]?(zd.top+=1,zd.bottom=zd.top+kc.Data.length-1):zd.bottom=zd.top+kc.Data.length-(1===kc.CoerceType?0:1):zd.bottom=zd.top+1;zd.right=zd.left+Ud-1;Od=zd.contains(rd)?rd:zd.topLeft;Mc.updateSelection(zd,Od,0);this.xe.jv(La)}},La)}}else this.xe.uf(Ke.a.dye,La)}}addBinding(N,La,Eb,kc){La?this.mA.ddaAddBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,N.DdaBindingsMethod.BindingType,La,Eb,Mc=>{if(Te.a(Mc))this.xe.wH(Mc,kc);else{const kd=this.xe.XP();
kd.Bindings=Array(1);kd.Bindings[0]=this.re.V0b(Mc.Result);kc(kd)}},kc):this.xe.uf(Ke.a.imj,kc)}zJh(N,La){this.mA.ddaGetBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Eb=>{if(Te.a(Eb)||!Eb.Result)this.xe.wH(Eb,La);else{const kc=this.xe.XP();kc.Bindings=Array(1);kc.Bindings[0]=this.re.V0b(Eb.Result);La(kc)}},La)}LOh(N){const La=this.xe.XP(),Eb={};Eb[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;La[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=
Eb;N(La)}S9i(N,La){this.mA.ddaReleaseBinding(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Eb=>{Te.a(Eb)?this.xe.wH(Eb,La):this.xe.jv(La)},La)}xIh(N,La){this.mA.ddaGetAllBindings(N.DdaMethod.ControlId,Eb=>{if(Te.a(Eb))this.xe.wH(Eb,La);else{const kc=this.xe.XP();if(Eb.Result){Eb=Eb.Result;kc.Bindings=Array(Eb.length);for(let Mc=0;Mc<Eb.length;Mc++)kc.Bindings[Mc]=this.re.V0b(Eb[Mc])}else kc.Bindings=null;La(kc)}},La)}yud(N,La){this.mA.ddaLoadSettings(N.DdaMethod.ControlId,Eb=>{if(Te.a(Eb))this.xe.wH(Eb,
La);else{const kc=this.xe.XP();kc.Properties=Eb.Result;La(kc)}},La)}saveSettings(N,La){const Eb={Settings:[]};for(let kc=0;kc<N.DdaSettingsMethod.Properties.length;kc++){const Mc={};Mc.Name=N.DdaSettingsMethod.Properties[kc][0];Mc.Value=N.DdaSettingsMethod.Properties[kc][1];Eb.Settings[kc]=Mc}this.mA.ddaSaveSettings(N.DdaMethod.ControlId,Eb,N.DdaSettingsMethod.OverwriteIfStale,kc=>{Te.a(kc)?this.xe.wH(kc,La):this.xe.jv(La)},La)}une(N,La){const Eb=qf.jZc(1,N.DdaAddRowsColumns.Data);qf.Nfc(Eb)?this.xe.uf(Ke.a.MBc,
La):this.mA.ddaAddRowsColumns(N.DdaMethod.ControlId,N.DdaAddRowsColumns.BindingId,N.DdaAddRowsColumns.IsRow,Eb,kc=>{Te.a(kc)?this.xe.wH(kc,La):this.xe.jv(La)},La)}peh(N,La){this.mA.ddaDeleteAllDataValues(N.DdaMethod.ControlId,N.DdaBindingsMethod.BindingId,Eb=>{Te.a(Eb)?this.xe.wH(Eb,La):this.xe.jv(La)},La)}ZYg(N,La){this.mA.ddaClearBindingFormats(N.DdaMethod.ControlId,N.DdaClearBindingFormats.BindingId,Eb=>{Te.a(Eb)?this.xe.wH(Eb,La):this.xe.jv(La)},La)}UZf(N,La){const Eb={},kc=N.DdaSetBindingFormats.IsSetFormats;
kc?Eb.CellFormat=N.DdaSetBindingFormats.CellFormat:Eb.TableOptions=N.DdaSetBindingFormats.TableOptions;this.mA.ddaSetBindingFormats(N.DdaMethod.ControlId,N.DdaSetBindingFormats.BindingId,Eb,kc,Mc=>{Te.a(Mc)?this.xe.wH(Mc,La):this.xe.jv(La)},La)}executeRichApiRequest(N,La){var Eb;const kc=N.ArrayData,Mc={},kd=zg.g(this.$).ha;if(kc){if("WacPartition"===kc[0]){this.Rxh(N,La);return}const Oe=Object(O.a)(sg.DdaFacade,Ee.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===kc[0]){var rd=Oe.pn(N.DdaMethod.ControlId);
rd&&(rd.Chc=!0,rd.ZKf())}Mc.HttpMethod=kc[1];Mc.PathAndQuery=kc[2];Mc.RequestHeaders=qf.N_e(kc[3]);Mc.RequestBody=kc[4];Mc.AppPermission=kc[5];rd=kc[6];Mc.RequestFlags=rd;var zd=0;if(Wg.i(this.$.oa))switch(kd.Me){case 1:zd=2;break;case 2:zd=3;break;case 128:zd=4;break;default:zd=1}var Od=null;kd.Qa.$A&&(Od=kd.Qa.$A.mj);Mc.SheetMultiRange=vh.r(kd.sa.selectedRanges,this.$);Mc.ActiveCell=vh.v(kd.sa.activeCell,this.$);Mc.ActiveChartId=Od;Mc.SelectionState=zd;zd=this.re.XY(N.DdaMethod.ControlId);Mc.InstanceId=
zd?zd.InstanceId:"";if(zd&&zd.PrimaryMarketplace){Od=sg.DdaFacade.getSolutionId(zd,this.$);let ef=zd.PrimaryMarketplace.MarketplaceType;if(ef===OSF.StoreType.InMemory){if(!zd.OwnerAddinSolutionId){this.xe.uf(Ke.a.Lyb,La);return}if(zd.AssetMarketplace)ef=zd.AssetMarketplace.MarketplaceType;else{this.xe.uf(Ke.a.Lyb,La);return}}else ef===OSF.StoreType.WopiCatalog&&(ef=OSF.StoreType.OMEX);let lg=Telemetry.PrivacyRules.GetPrivacyCompliantId(Od,ef,null===(Eb=zd.AssetMarketplace)||void 0===Eb?void 0:Eb.SolutionId,
null,null,zd.PrimaryMarketplace.MarketplaceRef);Mc.CompliantSolutionId=lg;Mc.SolutionId=Od;Mc.MarketplaceType=ef;Mc.SolutionVersion=zd.PrimaryMarketplace.SolutionVersion;Mc.StoreLocation=zd.PrimaryMarketplace.MarketplaceRef}else Mc.SolutionId=Mc.MarketplaceType="",Mc.CompliantSolutionId="";Mc.IsEventsEnabled=void 0===Oe||null===Oe||Oe.jj.e0b(Mc.InstanceId);Mc.RequestGuid=Uh.a.create().toString();Eb=Mc.RequestBody.length;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&
Eb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.xe.uf(Ke.a.Jfj,La);t.ULS.sendTraceTag(537163213,0,50,`Request payload size:${Eb} exceeded the limit`);return}z.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&rd&4096&&(Eb=new Ef(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(Eb,ye,kc),Mc.RequestBody=kc[4])}const Ud=qf.X2e(Mc.RequestHeaders);qf.lEd++;const Ne=hj.a.Pa.zb;z.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&
Mc&&Mc.RequestBody&&t.ULS.sendTraceTag(537163212,0,50,`Richapi json request body size is ${Mc.RequestBody.length}`);this.mA.executeRichApiRequest(Mc,Oe=>{var ef;this.cZf(Ne,!0,Oe.ServerCorrelationId);var lg=null;let $f=null;var ag=Oe.ServerCorrelationId;if(null===(ef=null===Oe||void 0===Oe?void 0:Oe.Errors)||void 0===ef?0:ef[0])lg=Oe.Errors[0].MessageIdName,$f=Oe.Errors[0].Description,z.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&rj.a(this.$).kd.gM(Oe.Errors[0].MessageId);
if(Te.a(Oe)||!Oe.Result)this.hOa(ag,Ud,"Server error",lg,$f),this.xe.wH(Oe,La);else{let mg=null;if(z.EwaSettings.ma(258))if((ef=Oe.Result)&&ef.length){for(let Mg=0;Mg<ef.length;Mg++)if(ef[Mg].RequestGuid===Mc.RequestGuid){mg=ef[Mg];break}mg||this.xe.wH(Oe,La)}else mg=Oe.Result;else mg=Oe.Result;if(!lg&&mg&&mg.ResponseBody&&mg.ResponseBody[0])if(Oe=mg.ResponseBody[0],Oe.startsWith('{"Error":')){1<mg.ResponseBody.length&&(Oe=Oe.substring(0,Oe.indexOf("}")+1),Oe+="}");try{var Mf=w.a.$h(Oe);Mf.Error&&
this.hOa(ag,Ud,"Pipeline error",Mf.Error.Code,Mf.Error.Message)}catch(Mg){this.hOa(ag,Ud,"Json deserialize error",null,"Error info cannot be deserialized.")}}else this.hOa(ag,Ud);else this.hOa(ag,Ud,"Server error",lg,$f);const Lg=(Mf=mg.SheetMultiRange)?Mf.SheetName:null;Oe=mg.ActiveChartId;const Jg=mg.SelectionState;lg=5===Jg&&!!Mf||6===Jg||7===Jg||8===Jg;if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&this.$.rb.iy&&lg)this.xe.uf(Ke.a.ZDc,La),t.ULS.sendTraceTag(537163211,
0,50,`${Jg.toString()} is not allowed`);else if(5===Jg&&Mf){if(this.$.xa&&Lg)if(this.$.xa.Lk(Lg))this.gUc(Lg);else{let Mg=null;Mg=()=>{this.$.xa.Lk(Lg)&&(t.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),this.gUc(Lg),this.$.xa.YIb(Mg))};this.$.xa.ynb(Mg);if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){let Dh=null;Dh=()=>{this.$.xa.Lk(Lg)&&(this.gUc(Lg),this.$.xa.Vma(Dh))};this.$.xa.Oga(Dh)}}}else if(6===Jg||7===Jg||8===
Jg||9===Jg){if(Mf){const Mg=vh.g(Mf.Ranges);if(Lg&&vh.cb(Mg,!0))if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!this.$.xa.Lk(Lg)){let Dh=null;Dh=()=>{this.ofg(kd,Mg,Lg,Jg);this.$.xa.Vma(Dh)};this.$.xa.Oga(Dh)}else this.ofg(kd,Mg,Lg,Jg)}7===Jg?(Oe="38.{"+sj.e(Oe)+"}",kg.a(this.$).ona(0,Oe,!0)):8===Jg&&kg.a(this.$).ona(2,Oe,!0);9===Jg&&(this.$.ya.ApiCallToSetPageLayout=!0)}mg.PostProcessActions?this.$.hhf?(ag=w.a.$h(mg.PostProcessActions),this.i_i(ag).then(()=>
{this.Pcb(mg,La);this.obd(N.DdaMethod.ControlId,Mc);return Promise.resolve(null)},Mg=>{this.Pcb(mg,La,Mg);return Promise.reject(Mg)})):(this.hOa(ag,Ud,"Promise not supported",null,"Promise is not supported on this browser."),this.xe.uf(Ke.a.internalError,La)):this.Pcb(mg,La)}},Oe=>{this.cZf(Ne,!1,null);this.hOa(null,Ud,"Web service error");La(Oe)})}obd(N,La){const Eb=Object(O.a)(sg.DdaFacade,Ee.a(this.$));(null===Eb||void 0===Eb?0:Eb.bNd)&&Eb.pn(N)&&qf.Vwj(La.RequestHeaders)&&(t.ULS.sendTraceTag(537163209,
0,50,`ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: ${N}; SolutionId: ${La.SolutionId}.`),Eb.bNd.Hmh(N))}Rxh(N,La){var Eb=this.re.XY(N.DdaMethod.ControlId);const kc=sg.DdaFacade.getSolutionId(Eb,this.$);var Mc=null;Mc=sg.DdaFacade.gva(Eb,this.$);Mc=new $h(Mc,this.$);Mc=new gj(kc,N.DdaMethod.ControlId,this.re,this.$,Mc);const kd={ResponseHeaders:[]};kd.ResponseBody=Array(1);Eb=qf.N_e(N.ArrayData[3]);const rd=qf.X2e(Eb);Eb=new Qd(this.$.ya.CreateWorkbookMaxAllowedBase64Size,
this.ktf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Mc,cd,Eb,N.ArrayData).then(zd=>{if(!zd)return this.nvd(!1,"The rich api executor call failed",rd),t.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),kd.ResponseStatusCode=500,this.Pcb(kd,La),null;this.nvd(!0,"The rich api executor call succeeded",rd);kd.ResponseStatusCode=zd[0];kd.ResponseBody[0]=zd[2];this.Pcb(kd,La);return null},zd=>{kd.ResponseStatusCode=400;kd.ResponseBody[0]=zd.toString();this.nvd(!1,"The rich api executor call failed",
rd);t.ULS.sendTraceTag(537163207,0,10,`A Excel Rich API batch execution was failed, AppId:${kc}`);this.Pcb(kd,La);return null})}cZf(N,La,Eb){qf.lEd--;N=lj.a(hj.a.Pa,N);t.ULS.sendTraceTag(36763356,0,50,`Rich Api perf log -- total milliseconds used:${N}, requests pending:${qf.lEd}, request result:${La?"success":"false"}, server correlationid: ${Eb}.`)}Pcb(N,La,Eb=null){const kc=Array(3);kc[0]=N.ResponseStatusCode;kc[1]=qf.HYh(N.ResponseHeaders);const Mc=[];var kd=!1;if(Eb&&N.ResponseBody){const rd=
w.a.$h(N.ResponseBody.join(""));rd.Error||(kd={},kd.Error=Eb,kd.TraceIds=rd.TraceIds,kd.ProcessedResults={},kd.ProcessedResults.Results=rd.Results,Mc[0]=w.a.kc(kd),kd=!0)}kc[2]=kd?Mc:N.ResponseBody;N=this.xe.XP();N.Data=kc;La(N)}pyd(N,La){(new If(this.$,this.xe,this.mA)).pyd(N,La)}NAi(N,La){t.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");const Eb=N[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],kc=N[Pd.a.fWc],Mc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];N=this.$.da.za(232).W1a.OAi(N.DdaMethod.ControlId,
Eb,kc,Mc);N===Ke.a.success?this.xe.jv(La):(t.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.xe.uf(N,La))}JAi(N,La){t.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");const Eb=N[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],kc=N[Pd.a.fWc],Mc=N[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.za(232).W1a.enj(N.DdaMethod.ControlId,Eb,kc,Mc);this.xe.jv(La)}getAccessToken(N,La){t.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");const Eb=(Mc,kd)=>
{var rd;if(Mc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Mc=this.xe.XP(),Mc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=kd.accessToken,La(Mc);else{kd=this.re.XY(N.DdaMethod.ControlId);let zd=null!==kd.OwnerAddinStoreType?kd.OwnerAddinStoreType:kd.PrimaryMarketplace.MarketplaceType;t.ULS.sendTraceTag(537163202,0,10,`${({["errorCode"]:Mc.toString(),["appId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(sg.DdaFacade.getSolutionId(kd,this.$),zd,null===(rd=kd.AssetMarketplace)||
void 0===rd?void 0:rd.SolutionId,null,null,kd.PrimaryMarketplace.MarketplaceRef),["storeType"]:zd})}.`);this.xe.uf(Mc,La)}},kc=!z.EwaSettings.ma(23);cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),Mc=>{const kd=this.re.Xh,rd=Lc.getInstance();Zh.AppsForOfficeSingleSignOnManager.getInstance(kd,Mc.result,rd).getAccessToken(N.DdaMethod.ControlId,kc,N,Eb)},this.$.la)}getAuthContext(N,La){cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),()=>
{var Eb=this.re.Xh.getOsfControl(N.DdaMethod.ControlId);if(Eb.isFirstParty()){Eb=Eb.getManifest();var kc=Eb.getMarketplaceID(),Mc=Eb.getWebApplicationId(),kd=Eb.getWebApplicationMsaId();Ed.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(kc).then(rd=>{const zd=this.xe.XP(),Od={};Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=kd||Mc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
rd.upn;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=rd.userId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=rd.authority;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Kc.a.iJh(rd.authorityType);Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=rd.isAnonymous;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=rd.tenantId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=rd.supportsAuthToken;
zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Od;La(zd)},rd=>{const zd=this.xe.XP(),Od={},Ud=new Kc.a;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Mc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=kd||Mc;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Ud.upn;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Ud.userId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Ud.authority;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
Ud.authorityType;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Ud.isAnonymous;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Ud.tenantId;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=rd;Od[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Ud.supportsAuthToken;zd[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Od;zd.Error=1;La(zd)})}},this.$.la)}Jgi(N){const La=zg.g(this.$).ha;return 16===La.Me&&!!La.Qa.dc&&
!!La.Qa.dc.floatingObject&&ch.a.equals(La.Qa.dc.floatingObject.id,N,!0)}med(N){const La=zg.g(this.$).ha;return La.sa.Bg?1===La.Me||this.Jgi(N)?La.eia:null:null}Kic(N,La){return 1!==N&&2!==N&&3!==N?(this.xe.uf(Ke.a.lBe,La),!1):!0}nvd(N,La,Eb){const kc={};kc.a=this.$.ya.UserSessionId;kc.b=N;kc.c=La;kc.d=null;kc.e=Eb;Ei.b().Ne(37,kc)}hOa(N,La,Eb=null,kc=null,Mc=null){const kd={};N&&(kd.ServerCorrelationId=N);void 0!==La&&null!==La&&(kd.Source=La);Eb&&(kd.ErrorType=Eb);kc&&(kd.MessageId=kc);Mc&&(kd.StatusDescription=
Mc);z.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&kc&&"ExternalDataRefreshFailed"===kc&&(kd.StatusDescription="");t.ULS.sendTraceTag(50688452,0,50,w.a.kc(kd))}i_i(N){let La=new Promise(Eb=>{Eb(null)});for(let Eb=0;Eb<N.length;Eb++)La=this.h_i(La,N[Eb]);return La}h_i(N,La){if(!La)return t.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),N.then(()=>Promise.reject(qf.N3a(kh.generalException,vd.a.instance.ga(1763),null)));switch(La.actionType){case 1:case 2:N=N.then(()=>
{const Eb=Object(O.a)(sg.DdaFacade,Ee.a(this.$));if(Eb.pn(La.controlId))switch(Eb.jj.M2h(La),La.messageType){case 14:case 100:Eb.aNd.B0b(La);break;case 11:case 12:Eb.xij.Job(La);break;case 51:case 52:Eb.vij.Job(La);break;case 2101:case 2102:Eb.wij.Job(La);break;case 2E3:Eb.yij.B0b(La);break;case 2201:this.$.Jka&&Eb.bNd.zNg(La);break;case 2203:Eb.zij.ANg(La);break;case 2700:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&Eb.$Md.B0b(La)}else t.ULS.sendTraceTag(537163171,0,10,`OsfControl with instanceId[${La.controlId}] doesn't exist.`);
return Promise.resolve(null)});break;case 3:N=N.then(()=>{this.y2h(La);return Promise.resolve(null)});break;case 15:z.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(N=N.then(()=>{this.c4h(La);return Promise.resolve(null)}));break;case 4:N=N.then(()=>{if(z.EwaSettings.ma(104)){var Eb=zg.g(this.$).ha.sa.activeCell;Eb.top!==La.row+1&&Eb.left!==La.column+1&&(Eb=vh.v(Se.Range.Uc(La.row+1,La.column+1),this.$),zg.g(this.$).yg(Eb,null,null,null,3,tf.a.$ch));ji.a(this.$,243,242,0,kc=>{kc.Sdb(La.row+
1,La.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:N=N.then(()=>{Object(O.a)(sg.DdaFacade,Ee.a(this.$)).jj.dMe(La.controlId,La.isEnableEvents);return Promise.resolve(null)});break;case 5:N=N.then(()=>this.ubh(La));break;case 6:N=N.then(()=>this.rVi(La));break;case 8:N=N.then(()=>{z.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&Object(O.a)(sg.DdaFacade,Ee.a(this.$)).YYg();const Eb=new pj.a(qj.a.Rj,5,null);oj.a(this.$).Bs(Eb);
return Promise.resolve(null)});break;case 9:N=N.then(()=>this.Yoj(La));break;case 10:N=N.then(()=>this.ZXj(La));break;case 11:N=N.then(()=>this.YXj());break;case 12:N=N.then(()=>this.VXj());break;case 13:N=N.then(()=>this.WXj(La));break;case 14:N=N.then(()=>this.XXj(La));break;case 16:N=N.then(()=>Promise.resolve(La));break;case 17:N=N.then(()=>this.hlj(La,Object(O.a)(sg.DdaFacade,Ee.a(this.$))));break;case 18:zg.g(this.$).focus();break;case 19:this.i6e(La.entryType,!1,La.options);break;case 20:this.i6e(La.entryType,
!0,La.options);break;default:N=N.then(()=>Promise.reject(qf.N3a(kh.YKg,vd.a.instance.ga(1764),null)))}return N}c4h(N){var La=Object(O.a)(sg.DdaFacade,Ee.a(this.$)).pn(N.controlId);if(La&&!(0===N.operationType^!La.yda)){zg.g(this.$).iic=!0;switch(N.operationType){case 0:var Eb=new nj.a(document.createElement("input"));Eb.text=N.range;La.tbi(zg.g(this.$).Ff.Q$g(Eb,new kj.a(this.$)));La.yda.startEdit(!0);break;case 1:La.VQf();this.rangePicker=null;break;case 2:La.yda.Dfg(N.range);break;case 3:La.yda.Dfg(N.startingRange);
La=N.expandSelection;Eb=N.getNextDataRegionCell;let kc=0;switch(N.keyboardDirectionValue){case 2:kc=38;N=La&&Eb?105288353:La?-31900117:Eb?542791952:137938150;break;case 3:kc=40;N=La&&Eb?-1297307319:La?-1603798598:Eb?1713663844:-798660877;break;case 0:kc=37;N=La&&Eb?-403586027:La?2039316657:Eb?-2012742350:-1470715894;break;case 1:kc=39;N=La&&Eb?784916030:La?589730764:Eb?1324884057:-1231471547;break;default:N=1461300262}La=this.R4b("keydown",kc,La,Eb);zg.g(this.$).ZJb(La,new xg.a(N,1,0,8,null))}zg.g(this.$).iic=
!1}}R4b(N,La,Eb,kc){const Mc=document.createEvent("KeyboardEvent");if(sc.a.JF)Mc.initKeyboardEvent(N,!1,!1,window.self,"A",0,kc,!1,Eb,!1);else{let kd="";Eb&&(kd+="Shift");kc&&(kd+=0<kd.length?" Control":"Control");Mc.initKeyboardEvent(N,!1,!1,window.self,"A",0,kd,!1,"en-US")}N=new Sys.UI.DomEvent(Mc);N.keyCode=La;return N}y2h(N){switch(N.operationType){case 1:cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),La=>{La.result.ZLd()},this.$.la,3);break;case 2:if(N=Object(O.a)(sg.DdaFacade,
Ee.a(this.$)).pn(N.controlId))N.Chc=!0,N.ZKf()}}ubh(N){const La=N.fileBase64;return La&&La.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(qf.N3a(kh.invalidArgument,vd.a.instance.ga(1767),"Application.CreateWorkbook")):(new Promise((Eb,kc)=>{const Mc=new tc.StandardDialog;Mc.Rb=4;Mc.Dl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,kd=>{2!==kd&&0!==kd||kc(qf.N3a(kh.pDd,vd.a.instance.ga(1766),"Application.CreateWorkbook"));kd=new Yc("blank",
"agave",La?"streamBase64":"streamEmpty",La);this.ktf.create(Eb,kc,kd).k1a()})})).then(Eb=>{this.w9b.set(N.fakeFileId,Eb);return Promise.resolve(null)},Eb=>Eb?Promise.reject(Eb):Promise.reject(qf.N3a(kh.generalException,vd.a.instance.ga(1763),"Application.CreateWorkbook")))}rVi(N){return new Promise((La,Eb)=>{if(this.w9b.has(N.fakeFileId)){const kc=this.w9b.get(N.fakeFileId);Eb=new tc.StandardDialog;Eb.Rb=4;Eb.Dl(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,
1,Mc=>{1===Mc&&Eh.HelperMethods.Ze(kc,void 0,void 0,"DdaMethodHandler.fileUrl");La(null)})}else Eb(qf.N3a(kh.generalException,vd.a.instance.ga(1763),"Document.Open"))})}Yoj(N){return new Promise(La=>{Object(O.a)(sg.DdaFacade,Ee.a(this.$)).IVf=N.runtimeCalculationMode;const Eb=this.$.da.za(268);Eb&&Eb.pzd(3===N.runtimeCalculationMode);La(null)})}ZXj(N){Zf.a.bBb(this.$)&&this.$.da.za(331).Qcb(0,N.urlStr,!0,!0,null);return Promise.resolve(null)}YXj(){Zf.a.bBb(this.$)&&this.$.da.za(331).Qcb(1,null,!0,
!0,null);return Promise.resolve(null)}VXj(){Zf.a.bBb(this.$)&&this.$.da.za(331).aMe();return Promise.resolve(null)}WXj(N){Zf.a.bBb(this.$)&&this.$.da.za(331).Qcb(5,N.urlStr,!0,!0,null);return Promise.resolve(null)}XXj(N){if(Zf.a.bBb(this.$)){const La=this.$.da.za(331);for(const Eb of La.laa)Eb.IsActive&&Eb.HostEditUrl&&Eb.UrlStr===N.hostEditUrlStr&&Eh.HelperMethods.Ze(Eb.HostEditUrl,"_blank")}return Promise.resolve(null)}hlj(N,La){const Eb=zf.a.wW;N=w.a.$h(N.payload);const kc={};"eventId"in N&&"payload"in
N&&(kc.eventId=N.eventId,kc.payload=N.payload);La.NM(2201,Eb,w.a.kc(kc));return Promise.resolve(null)}i6e(N,La,Eb){const kc=this.$.da.za(5);kc&&(N=this.cKh(N))&&(La?kc.removeEntry(N):kc.ZUc(N,Eb))}cKh(N){switch(N){case 0:return 65;case 1:if(z.EwaSettings.isChangeGateEnabled("OfficeVSO:7109926_MsFormsBusinessBarApi"))return 70}}gUc(N){N=Object(O.a)(mj.a,this.$.xa.getItemByName(N));(null===N||void 0===N?0:N.visible)&&N.activate(!0)}ofg(N,La,Eb,kc){var Mc=N.sa.ls;const kd=Mc<La.length&&La[Mc].contains(N.sa.activeCell);
N=kd?N.sa.activeCell:La[0].topLeft;Mc=kd?Mc:0;zg.g(this.$).rZ(La,Mc,Eb,null,N,null,null,3,tf.a.adh,void 0,void 0,void 0,6===kc)}static get Wch(){qf.Npa||(qf.Npa={},qf.Npa[Microsoft.Office.WebExtension.CoercionType.Table]=1,qf.Npa[Microsoft.Office.WebExtension.CoercionType.Text]=2,qf.Npa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,qf.Npa[Microsoft.Office.WebExtension.CoercionType.Html]=4,qf.Npa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return qf.Npa}static get Zch(){qf.Khb||(qf.Khb=
{},qf.Khb[Microsoft.Office.WebExtension.FilterType.All]=1,qf.Khb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return qf.Khb}static get cdh(){qf.Lhb||(qf.Lhb={},qf.Lhb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,qf.Lhb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return qf.Lhb}static N_e(N){if(!N||!N.length)return null;const La=Array(N.length/2);for(let Eb=0;Eb<N.length/2;Eb++)La[Eb]={},La[Eb].Name=N[2*Eb],La[Eb].Value=N[2*Eb+1];return La}static HYh(N){if(!N||!N.length)return null;
const La=Array(2*N.length);for(let Eb=0;Eb<N.length;Eb++)La[2*Eb]=N[Eb].Name,La[2*Eb+1]=N[Eb].Value;return La}static Ebd(N){if(!N||!N.length)return null;const La=Array(N.length);for(let Eb=0,kc=N.length;Eb<kc;Eb++){const Mc=N[Eb].length;if(Mc){La[Eb]=Array(Mc);for(let kd=0;kd<Mc;kd++)La[Eb][kd]=null==N[Eb][kd]?null:N[Eb][kd].toString()}else return null}return La}static j3b(N){return"string"===typeof N?aj.a.pq(qf.Wch,N,0):N}static OTe(N){return"string"===typeof N?aj.a.pq(qf.Zch,N,0):N}static Sgg(N){return"string"===
typeof N?aj.a.pq(qf.cdh,N,0):N}static Vgi(N){switch(N.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1}static jZc(N,La){const Eb={};Eb.CoerceType=N;1===Eb.CoerceType?(Eb.Data=qf.Ebd(La.Rows),Eb.Headers=qf.Ebd(La.Headers)):Eb.Data=qf.Ebd(La);return Eb}static Ive(N){return 1===N.CoerceType?{["Headers"]:N.Headers,["Rows"]:N.Data}:N.Data}static Nfc(N){return 1===N.CoerceType?!N.Data&&!N.Headers:!N.Data}static X2e(N){let La="Unknown";if(!N)return La;
for(let Eb=0;Eb<N.length;Eb++)if(N[Eb].Name.toLowerCase()===Qe.a.Aij){La=N[Eb].Value;break}return La}static Vwj(N){if(!N)return!1;const La=Qe.a.vFi.toLowerCase();for(let Eb=0;Eb<N.length;Eb++)if(N[Eb].Name.toLowerCase()===La)return!0;return!1}static N3a(N,La,Eb){const kc={};kc.Code=N;kc.Message=La;kc.Location=Eb;kc.ActionIndex=0;return kc}}qf.Npa=null;qf.Khb=null;qf.Lhb=null;qf.lEd=0;Object(e.a)(qf,"DdaMethodHandler",null,[164,10]);class bj extends Xd.a{constructor(N){super(N)}vd(){const N=jg.GetServiceTaskFactory.create(this.$.da,
106,this.la,this.fb),La=jg.GetServiceTaskFactory.create(this.$.da,165,this.la,this.fb),Eb=nh(this.la,this.fb);cf.TaskExtensions.Aa(cf.TaskExtensions.Td([N,La,Eb],this.la),()=>{const Mc=N.result,kd=Ed.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");this.$c([new qf(this.$,Mc,kd)])},this.la,3);const kc=Ed.a.instance;cf.TaskExtensions.Aa(jg.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.fb),()=>{kc.register(Yh,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").wc().Fc(()=>
new Yh)},this.$.la)}static ka(N){Xd.a.Od(82,new bj(N))}}Object(e.a)(bj,"DdaCommandHandlerFactory",Xd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");c.a.Qi("");c.a.Qi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");
Object(b.a)();Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(d.a)();(()=>{f.a.Fa(N=>{hg.ka(N)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Object(Ta.a)();Object(zb.a)();Type.registerNamespace("CommandUI.AddInCommands");(()=>{f.a.Fa(N=>{z.EwaSettings.ma(53)&&di.ka(N)})})();(()=>{f.a.Fa(N=>{z.EwaSettings.ma(121)&&wi.ka(N)})})();f.a.Fa(Rh.ka);f.a.Fa(ii.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(()=>{f.a.Fa(N=>{Ih.ka(N);Vh.ka(N);si.ka(N)})})();f.a.Fa(bj.ka)},1456:function(n,C,a){n=a(0);var c=a(187),b=a(95);class d{constructor(){this.aLe=this.displayName=this.drb=this.No=this.CB=null;this.isUpgraded=!1}Ohf(e,k){return this.CB.getStoreType().toLowerCase()===e.toLowerCase()&&this.CB.getSolutionId().toLowerCase()===k.toLowerCase()}}Object(n.a)(d,"AddinCommandsResourceItem",null,[]);a.d(C,"a",function(){return f});class f{constructor(){this.VEc=
null;this.JJc=0;this.oLc=!1;this.$a=new b.a;this.Yrg=new c.a}hFg(e){this.$a.addHandler("AddinCommandsLoadingMessageChanged",e)}Caj(e){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",e)}get rZa(){return this.VEc}qdb(e){e!==this.VEc&&(this.VEc=e,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))}Toj(){this.JJc++;this.rZa||this.qdb(CommonUIStrings.l_LoadingAddInsTitle)}KPd(){this.JJc--;this.Bud()&&(this.oLc?this.rZa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.qdb(CommonUIStrings.l_ErrorLoadingAddInsTitle):
this.qdb(null))}L_f(e=!1){this.oLc=!0;this.qdb(e?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)}Fze(){this.oLc=!1;this.Bud()?this.qdb(null):this.qdb(CommonUIStrings.l_LoadingAddInsTitle)}Bud(){return 0>=this.JJc}get d6a(){return this.Yrg}Oia(e,k,l=0){for(let m of this.d6a)if(m.Ohf(e,k)&&(!m.No||m.No.FHh===l))return m;return null}$me(e,k,l,m){const u=new d;u.CB=e;u.No=k;u.drb=l;u.displayName=m;this.d6a.add(u)}jDg(e,k,l,m){const u=new d;u.CB=
e;u.No=k;u.drb=null;u.aLe=l;u.displayName=m;this.d6a.add(u)}a$i(e,k){let l=0;for(let m of this.d6a)m.CB.getStoreType()===e&&m.CB.getSolutionId()===k?this.d6a.removeAt(l):l++}static getInstance(){f.Ma||(f.Ma=new f);return f.Ma}}f.Ma=null;Object(n.a)(f,"AddinCommandsResourceManager",null,[])},732:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(35);class b{static get LAi(){return b.vce||(b.vce={["-2002156328"]:b.lBe,["-1954750170"]:b.s3e,["317650254"]:b.O_g,["-1005263101"]:b.vdi,["1353664579"]:b.Amj,
["159671765"]:b.wdi,["1446690022"]:b.rZe,["1150069548"]:b.MBc,["-1409306331"]:b.dye,["338507772"]:b.lHe,["-457159301"]:b.fWi,["-1037701970"]:b.xch,["-1893322318"]:b.Bdi,["965579896"]:b.zch,["93287890"]:b.ych,["358088857"]:b.Jpj,["-1223650923"]:b.lHe,["2007306190"]:b.PWg,["1549955423"]:b.Rue,["-1275974171"]:b.Adi,["382101082"]:b.uVi,["-898776235"]:b.uCi,["335464256"]:b.kCi,["1677378049"]:b.zdi,["-261992848"]:b.cPj,["-980820954"]:b.Rue,["-931375837"]:b.tVi,["929186550"]:b.ikh,["-982144310"]:b.e2i,["-785741187"]:b.tdi,
["2125217573"]:b.Ddi,["299124955"]:b.udi,["1669853884"]:b.Pij,["-1515932330"]:b.P_g,["314621024"]:b.aEh,["-300049690"]:b.TWg,["14766835"]:b.Kuj,["-1251992761"]:b.fKe,["-2087635043"]:b.invalidOrTimedOutSession,["2100961153"]:b.invalidOrTimedOutSession,["-1218744139"]:b.invalidSheetName,["-1468309555"]:5006,["-315732528"]:b.invalidOrTimedOutSession,["611268539"]:b.invalidOrTimedOutSession,["1531005923"]:5006,["1593924569"]:5006,["299476328"]:b.KFa,["49173765"]:b.KFa,["-907155566"]:b.KFa,["-1201603824"]:b.KFa,
["1541165282"]:b.KFa,["-1347753427"]:b.KFa,["134912532"]:b.KFa,["1780971550"]:b.responsePayloadSizeLimitExceeded})}static eWe(d){return c.a.pq(b.LAi,d.toString(),b.internalError)}}b.success=0;b.lBe=1E3;b.s3e=1001;b.O_g=1002;b.vdi=1003;b.Amj=1004;b.wdi=1005;b.rZe=1008;b.CTe=1009;b.invalidSheetName=1014;b.MBc=2E3;b.dye=2001;b.lHe=2002;b.fWi=2003;b.xch=2004;b.Bdi=2005;b.zch=2007;b.ych=2008;b.Jpj=2009;b.PWg=2014;b.imj=3E3;b.Rue=3002;b.Adi=3004;b.uVi=3005;b.uCi=3006;b.kCi=3007;b.zdi=3008;b.cPj=3009;b.tVi=
3010;b.Kuj=4002;b.tDd=5E3;b.internalError=5001;b.fKe=5002;b.Lyb=5004;b.cQj=5007;b.n9h=5008;b.invalidOrTimedOutSession=5012;b.ZDc=5016;b.KFa=5102;b.Jfj=5103;b.responsePayloadSizeLimitExceeded=5104;b.lWg=7001;b.L6f=7002;b.ikh=8E3;b.e2i=8001;b.tdi=8010;b.Ddi=8011;b.udi=8012;b.Pij=8020;b.P_g=8021;b.aEh=8022;b.TWg=8023;b.rAi=11E3;b.kDi=11001;b.Cdi=11002;b.vce=null;Object(n.a)(b,"DdaErrorIds",null,[])},733:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.generalException="GeneralException";
c.invalidArgument="InvalidArgument";c.notImplemented="NotImplemented";c.JTc="AccessDenied";c.notSupported="NotSupported";c.apiNotAvailable="ApiNotAvailable";c.notAllowed="NotAllowed";c.pDd="OperationCancelled";c.userNotSignedIn="UserNotSignedIn";c.userAborted="UserAborted";c.fQj="UnsupportedUserIdentity";c.invalidResourceUrl="InvalidResourceUrl";c.invalidGrant="InvalidGrant";c.gJg="AddinIsAlreadyRequestingToken";c.khj="ResourceNotAllowed";c.clientError="ClientError";c.serverError="ServerError";c.K3g=
"ControlIdNotFound";c.$hj="RibbonApiNotAvailable";c.hostRestartNeeded="HostRestartNeeded";c.invalidRibbonDefinition="InvalidRibbonDefinition";c.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(n.a)(c,"ErrorCodes",null,[])},735:function(n,C,a){a.r(C);var c=a(0),b=a(7),d=a(15),f=a(1297),e=a(84),k=a(95);class l{constructor(M,$a,ob){this._id=M;this.Vlg=$a;this.fog=ob;this.ocf=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get fJg(){return this.Vlg}get s0g(){return this.fog}execute(M,
$a,ob){ob=ob||{};ob.commandMode=this.ocf;$a.invokeAppCommand(this.fJg,this.s0g,ob,()=>{M.ROi(this.id)})}}Object(c.a)(l,"AddinNativeActionBase",null,[97]);class m extends l{constructor(M,$a){super(1,M,$a);this.ocf=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(c.a)(m,"AddinTakeSnapshotAction",l,[]);class u{n5g(M){return new l(3,M,this.mIh().getNativeActionName(3))}mIh(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}Object(c.a)(u,"AddinNativeActionManager",null,[85]);var t=a(144);
class w{invokeAppCommand(M,$a,ob,Tb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,$a,ob,Tb)}static getInstance(){w.Ma||(w.Ma=new w);return w.Ma}}w.Ma=null;Object(c.a)(w,"OSFAddinCommandsRuntimeManager",null,[84]);var r=a(4),v=a(180),y=a(27);class x extends t.a{constructor(M,$a,ob){super();this.n9=null;this.ISc="WACDialogTitleText";this.afa="0";this.dDa="15px";this.wog="0px";this.$ea="calc(100% - 30px)";this.vog="100%";this.Xfe=0;this.$a=new k.a;this.Xlg=new u;this.Rb=5;this.Ce=this.lDa=
ob;this.YHc=M;this.m6d=$a;this.oIc=!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.qa("OfficeAddinEnableInsertDialogAccessibilityFix")}tHg(M){this.$a.addHandler("OnDialogClosedEventKey",M)}Grj(){this.tEa=null}Rz(){super.Rz();this.Sk.style.width="100%";this.Sk.style.height=this.Gdc?this.$ea:this.vog;this.Sk.style.marginTop=this.Gdc?this.dDa:this.wog;this.Sk.style.padding=this.afa}HI(){super.HI();this.wb.style.width=String.format("{0}px",this.YHc*window.innerWidth/100);this.wb.style.height=
String.format("{0}px",this.m6d*window.innerHeight/100);this.wb.style.minWidth="0px";this.oIc&&r.AFrameworkApplication.isRtl&&100===this.YHc&&(this.wb.style.right="0px",this.wb.style.marginRight="0px");this.n9=document.getElementById(this.ni(this.ISc));this.n9.style.position="absolute";this.n9.style.whiteSpace="nowrap";this.n9.style.textOverflow="ellipsis";r.AFrameworkApplication.isRtl?(this.n9.style.right="14px",this.n9.style.left="44px"):(this.n9.style.right="44px",this.n9.style.left="14px")}Cv(M){super.Cv(M);
this.n9&&this.n9.setAttribute("title",M)}get Tta(){return this.Sk}eMd(){this.wb.style.width=String.format("{0}px",this.YHc*window.innerWidth/100);this.wb.style.height=String.format("{0}px",this.m6d*window.innerHeight/100);this.wb.style.overflowY="hidden";this.wb.style.overflowX="hidden";this.wb.style.marginTop="";this.wb.style.top="";y.a.V4&&r.AFrameworkApplication.isRtl?(this.wb.style.right="",this.wb.style.marginRight=""):(this.wb.style.left="",this.wb.style.marginLeft="")}hide(){this.Xlg.n5g(this.lDa).execute(this,
w.getInstance(),{});this.Xfe=window.setTimeout(()=>{this.$a.raiseEvent("OnDialogClosedEventKey",this.lDa);v.a.prototype.hide.call(this)},500)}ROi(M){3===M&&(window.clearTimeout(this.Xfe),this.$a.raiseEvent("OnDialogClosedEventKey",this.lDa),super.hide())}}Object(c.a)(x,"AppsForOfficeDialog",t.a,[63,64]);class B{constructor(){this.dialog=this.Ce=null}}Object(c.a)(B,"DialogInfo",null,[]);class z{}z.url="url";z.height="height";z.width="width";z.i7c="displayInIframe";z.dec="hideTitle";Object(c.a)(z,"DialogSettings",
null,[]);class A{constructor(){this.height=this.width=0;this.Ce=this.controlId=this.pageUrl=null;this.dec=this.i7c=!1}}Object(c.a)(A,"DisplayDialogParams",null,[]);class I extends Sys.EventArgs{constructor(M,$a,ob=null,Tb="",Dc=""){super();this.controlId=M;this.messageType=$a;this.messageContent=ob;this.messageOrigin=Tb;this.targetOrigin=Dc}}Object(c.a)(I,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(M,$a,ob=null,Tb="",Dc=""){super();this.controlId=M;this.messageType=
$a;this.messageContent=ob;this.messageOrigin=Tb;this.targetOrigin=Dc}}Object(c.a)(F,"OnMessageParentEventArgs",Sys.EventArgs,[]);var U=a(41),X=a(30),T=a(173),G=a(99);class D{constructor(M){this.$a=new k.a;this.$m=M}BHg(M){this.$a.addHandler("OnMessageParentEventKey",M)}AHg(M){this.$a.addHandler("OnMessageDialogEventKey",M)}showDialog(M,$a,ob,Tb){if(D.e8.lb($a))d.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);
else try{const Gd=U.b(M),Zd=Gd[z.url];if(this.$m.getOsfControl($a).checkAppDomains(Zd)){var Dc=new A;Dc.width=Gd[z.width];Dc.height=Gd[z.height];Dc.pageUrl=Zd;Dc.i7c=Gd[z.i7c];Dc.dec=Gd[z.dec];Dc.controlId=$a;Dc.Ce=T.a.create().toString();var ad=new B;ad.Ce=Dc.Ce;var ld=this.$m.getOsfControl(Dc.controlId).getManifest().getDefaultDisplayName(),md=this.$m.getOsfControl(Dc.controlId).getStoreType().toLowerCase();M=null;var Wb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",
!1);M=(4===r.AFrameworkApplication.ta.Oa.Dj&&"hardcodedpreinstall"===md||Wb&&"sdxcatalog"===md)&&Dc.dec?this.createAndShowAppsForOfficeDialog(Dc.width,Dc.height,Dc.Ce,!0,ld):this.createAndShowAppsForOfficeDialog(Dc.width,Dc.height,Dc.Ce,!1,ld);var Nc=this.$m.getOsfControl(Dc.controlId),gd=Nc.getManifest();Wb={};Wb.id=Dc.Ce;Wb.solutionId=Nc.getSolutionId();Wb.version=Nc.getVersion();Wb.storeType=md;Wb.storeId=Nc.getStoreId();Wb.assetId=Nc.getAssetId();Wb.assetStoreId=Nc.getAssetStoreId();Wb.ownerAddinSolutionId=
Nc.getOwnerAddinSolutionId();Wb.ownerAddinStoreType=Nc.getOwnerAddinStoreType();Wb.appDomains=gd.getAppDomains();Wb.dialogUrl=Zd;Wb.osfControlType=1;Wb.agaveName=ld;Wb.div=M.Tta;d.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Wb.solutionId,Wb.ownerAddinStoreType||Wb.storeType,Wb.assetId,null,null,Wb.storeId),X.a.Zv(Dc.pageUrl));this.$m.insertDialogControl(Wb);M.tHg(Object(e.a)(this,this.dJi,"onDialogClosed"));ad.dialog=
M;D.e8.ia(Dc.controlId,ad);Tb&&Tb(Wb);ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else d.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Gd){d.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Gd.message),ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}OAi(M,$a,ob,Tb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Tb&&(Tb=ob);try{const Dc=this.qKa(M);Dc&&this.$a.raiseEvent("OnMessageParentEventKey",new F(Dc,OSF.DialogMessageType.DialogMessageReceived,$a,ob,Tb))}catch(Dc){return d.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Dc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}zqb(M,$a){if(D.e8.lb(M))try{const ob=D.e8.na(M);ob.dialog&&ob.dialog.hide();this.$m.purgeDialogControl(ob.Ce);
D.e8.remove(M);$a(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(ob){d.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",ob.message),$a(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else d.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),$a(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}enj(M,$a,ob,Tb){r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Tb&&(Tb=ob);if(D.e8.lb(M)&&(M=D.e8.na(M),M.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new I(M.Ce,OSF.DialogMessageType.DialogParentMessageReceived,$a,ob,Tb))}catch(Dc){d.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Dc.message)}}qKa(M){let $a=null;for(let ob of D.e8)if(ob.value.Ce===M){$a=ob.key;break}return $a}dJi(M,$a){if(M=this.qKa($a))this.$m.purgeDialogControl($a),D.e8.remove(M),this.$a.raiseEvent("OnMessageParentEventKey",
new F(M,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(M,$a,ob,Tb,Dc){M=new x(M,$a,ob);Dc=Tb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Dc);Tb&&(M.Gdc=!1,M.ut=!1);M.initializeAndShow(Dc,null,null);M.Grj();return M}static D0h(){return D.e8}static getInstance(M){D.Ma||(D.Ma=new D(M));return D.Ma}}D.Ma=null;D.e8=new G.a;Object(c.a)(D,"AppsForOfficeDialogManager",null,[42]);var J=a(845),L=a(1309),H=a(1387),R=a(936),Q=a(720),O=a(175),V=a(1310),
W=a(120),da=a(83),ta=a(86),K=a(641),na=a(554),P=a(684),ka=a(82),pa=a(414),Na=a(155),Z=a(187),Ra=a(38),Da=a(5),Ba=a(862),ea=a(1230),Y=a(78);class ja{constructor(){this.command=0;this.properties=null}}Object(c.a)(ja,"DdaRequestInfo",null,[]);var ca=a(732),ba=a(77);class ua extends Y.a{constructor(M,$a){super();this.requests=[];this.disposed=this.i2b=!1;this.Lf=()=>{if(!this.disposed){this.grid.Xb.Fl(this.Lf);this.i2b=!1;const ob=this.requests;this.requests=[];for(let Tb of ob)this.ddaFacade.nK(Tb.command,
Tb.properties)}};this.ddaFacade=M;this.grid=$a}geh(M,$a){this.disposed||(this.i2b||(this.grid.Xb.lm(this.Lf),this.i2b=!0),this.requests.push(Object(b.a)(new ja,{command:M,properties:$a})))}dispose(){if(!this.disposed){this.disposed=!0;this.i2b&&this.grid.Xb.Fl(this.Lf);var M=this.requests;this.requests=null;for(let $a of M)(M=$a.properties?$a.properties[ba.a.t3]:null)&&this.ddaFacade.uf(ca.a.Lyb,M);this.ddaFacade=this.grid=null;super.dispose()}}static v0g(M,$a){var ob=!1;974713501===M&&($a=(M=$a?
$a[ba.a.kg]:null)?M.DdaMethod:null)&&$a.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(ob=M.ArrayData,ob=!!ob&&64===(ob[6]&64));return ob}}Object(c.a)(ua,"DdaCellEditDelayRequestHandler",Y.a,[]);var wa=a(766);class ia extends wa.a{constructor(M,$a,ob,Tb,Dc,ad,ld){super(M,$a,ob);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Tb;this.messageContent=Dc;this.messageOrigin=ad;this.targetOrigin=ld}}Object(c.a)(ia,"DialogMessageReceivedEventArgs",
wa.a,[]);class xa extends wa.a{constructor(M,$a,ob,Tb,Dc,ad,ld){super(M,$a,ob);this.messageType=0;this.targetOrigin=this.messageOrigin=this.messageContent=null;this.messageType=Tb;this.messageContent=Dc;this.messageOrigin=ad;this.targetOrigin=ld}}Object(c.a)(xa,"DialogParentMessageReceivedEventArgs",wa.a,[]);var gb=a(1),va=a(21);class sa{constructor(M){this.Xh=this.iXc=null;this.GOi=($a,ob)=>{this.handlers.lb(ob.controlId)&&($a=new ia(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,ob.controlId,
null,ob.messageType,ob.messageContent,ob.messageOrigin,ob.targetOrigin),this.handlers.na(ob.controlId)($a),ob.messageType===OSF.DialogMessageType.DialogClosed&&this.handlers.remove(ob.controlId))};this.FOi=($a,ob)=>{this.ylc.lb(ob.controlId)&&($a=new xa(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,ob.controlId,null,ob.messageType,ob.messageContent,ob.messageOrigin,ob.targetOrigin),this.ylc.na(ob.controlId)($a))};this.handlers=new G.a;this.ylc=new G.a;this.Ng=M;this.W1a.BHg(this.GOi);
this.W1a.AHg(this.FOi)}get W1a(){this.iXc||(this.iXc=D.getInstance(this.contextActivationMgr));return this.iXc}get contextActivationMgr(){!this.Xh&&this.Ng&&(this.Xh=this.Ng.Xh);return this.Xh}addHandler(M,$a,ob,Tb){if(gb.EwaSettings.ma(23))this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob);else{d.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");const Dc=ad=>{ad===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(this.handlers.ia(M,$a),
this.Ng.jv(ob)):(d.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),this.Ng.uf(ad,ob))};this.handlers.lb(M)?Dc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(M,Tb,Dc)}}aDg(M,$a,ob){gb.EwaSettings.ma(23)?this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ob):(d.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.ylc.ia(M,$a),this.Ng.jv(ob))}removeHandler(M,$a){gb.EwaSettings.ma(23)?
this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$a):this.handlers.lb(M)?(d.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.W1a.zqb(M,ob=>{this.handlers.remove(M);ob===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?this.Ng.jv($a):(d.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),this.Ng.uf(ob,$a))})):this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,$a)}W$i(M,$a){gb.EwaSettings.ma(23)?
this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$a):(d.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.ylc.remove(M),this.Ng.jv($a))}showDialog(M,$a,ob){try{gb.EwaSettings.isChangeGateEnabled("OfficeVSO:6254758_ExitCellEditModeDialogAPI")&&va.g(this.Ng.$).eb&&va.g(this.Ng.$).Qo(!0),this.W1a.showDialog($a,M,ob,Tb=>{this.Ng.sDg(this.uTg(Tb))})}catch(Tb){d.ULS.sendTraceTag(537170496,0,10,`DialogMessageReceivedEventManager: show dialog failed. Exception message: ${Tb.message}`),
ob(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}uTg(M){const $a={};$a.InstanceId=M.id;$a.WebExtensionType=M.osfControlType===OSF.OsfControlTarget.InContent?0:1;$a.PrimaryMarketplace={};$a.PrimaryMarketplace.SolutionId=M.solutionId;$a.PrimaryMarketplace.SolutionVersion=M.version;$a.PrimaryMarketplace.MarketplaceRef=M.storeId;$a.PrimaryMarketplace.MarketplaceType=M.storeType;return $a}static ka(M){if(!M.$.da.za(232)){const $a=new sa(M);M.$.da.Ga(232,$a)}}}Object(c.a)(sa,"DialogMessageReceivedEventManager",
null,[812]);class ab{constructor(M,$a){this.aB=null;this.qfa=M;this.yyg=$a}VZb(M){M&&(this.aB||(this.aB=[]),this.aB.push(M))}qtc(M){this.aB&&Array.remove(this.aB,M)}get eventId(){return this.qfa}get targetId(){return this.yyg}get z5h(){return 0<this.aB.length}mzi(M){return this.eventId!==M.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===M.ddaBinding.Name:!0}O1b(M){this.aB&&Array.forEach(this.aB,
$a=>{$a(M)})}Pma(){this.aB=[]}}Object(c.a)(ab,"DdaEventRegistration",null,[]);class Ua{constructor(M){this.bF=null;this.swa=!1;this.Vc=()=>{this.bF.forEach($a=>{$a.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&$a.O1b(new wa.a($a.eventId,"",null))})};this.Ng=M}invokeDdaMethod(M,$a){const ob={};ob[ba.a.kg]=M;ob[ba.a.t3]=$a;this.Ng.nK(974713501,ob)}registerDdaEventAsync(M,$a,ob,Tb,Dc){Ua.yzb(M)?(Ua.eod(M)&&this.Ekd(),this.bF||(this.bF=[]),$a=this.gub(M,ob),$a||($a=new ab(M,ob),this.bF.push($a)),
$a.VZb(Tb),this.Ng.jv(Dc)):this.Ng.uf(-1,Dc)}unregisterDdaEventAsync(M,$a,ob,Tb,Dc){Ua.yzb(M)?((M=this.gub(M,ob))&&M.qtc(Tb),this.Ng.jv(Dc)):this.Ng.uf(-1,Dc)}Ekd(){this.swa||(va.g(this.Ng.$).ha.yE(this.Vc),this.swa=!0)}gub(M,$a){if(!this.bF)return null;for(let ob=0;ob<this.bF.length;ob++){const Tb=this.bF[ob];if(Tb.eventId===M&&Tb.targetId===$a)return Tb}return null}static yzb(M){return M===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static eod(M){return M===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}}
Object(c.a)(Ua,"EmbeddingPage",null,[758]);var nb=a(178);class Ha extends wa.a{constructor(M,$a,ob,Tb,Dc,ad,ld,md){super(M,$a,ob);this.columnCount=this.rowCount=this.startColumn=this.startRow=0;this.startColumn=ad-Tb.Reference.FirstColumn;this.columnCount=md;M=Math.max(Dc,Tb.Reference.FirstRow);Dc=Math.min(Dc+ld-1,Tb.Reference.LastRow);M>Dc?this.startRow=this.rowCount=void 0:(this.startRow=M-Tb.Reference.FirstRow,this.rowCount=Dc-M+1)}getStartRow(){return this.startRow}getStartColumn(){return this.startColumn}getRowCount(){return this.rowCount}getColumnCount(){return this.columnCount}}
Object(c.a)(Ha,"DdaBindingSelectionEventArgs",wa.a,[]);var sb=a(198),Qb=a(24),mb=a(43),Pb=a(50),gc=a(415),Xb=a(33),Ca=a(37),ra=a(567),ma=a(109),hb=a(53),vb=a(90),Va=a(12),db=a(11),oa=a(104);class Oa{}Oa.tth="ewa-wx-disabled-div";Oa.sth="ewa-wx-container-div";Oa.aPe="ewa-ptp-nov2-flex";Object(c.a)(Oa,"CssClassNames",null,[]);const Wa=Oa.tth,Sa=Oa.sth;class yb extends nb.a{constructor(M,$a,ob,Tb=!1){super();this.Tcb=0;this.bF=null;this.swa=!1;this.Yqc=null;this.pU=0;this.Q5b=this.QVa=this.BHc=this.u3d=
null;this.T$d=!1;this.HOc=this.yda=this.T0d=null;this.Vc=()=>{this.enabled&&(this.onj(),this.Yqc=mb.d(va.g(this.$).ha.sa.selectedRanges))};this.r6e=Dc=>{Dc.controlId===this.Ld.InstanceId&&Array.forEach(this.bF,ad=>{ad.mzi(Dc)&&ad.O1b(Dc)})};this.ovf=Dc=>{if((Dc=Object(ka.a)(405,Dc))&&!Dc.ns())if(!this.Ld||OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)||this.$.V9){Dc.qf=this.Ld;Dc.vj=this.Ng;this.T0d=Dc;this.Vwc(Dc.pGa);const ad=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&
Xb.a.od(this.$)&&db.HelperMethods.tw(this.Ld)&&this.Ld.Preload&&!this.Ld.TaskpaneVisible;ad?Dc.FBd():gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(Dc.FBd(),(this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&Dc.qg(!1)):((this.Ld.SharedRuntime&&1===this.Ld.SharedRuntime.LifeTime||this.Ld.SharedRuntimeId)&&!this.Ld.TaskpaneVisible&&Dc.qg(!1),Dc.FBd());this.m6a||(Xb.a.od(this.$)?ad||Dc.v6():
gc.a(this.$).result.gG(Dc,!0));this.$.da.za(77).lRf(this.ovf);this.Z9=Object(ka.a)(483,Dc)}else d.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};this.onFloatingObjectControlAdded=(Dc,ad)=>{3===ad.control.floatingObject.type&&ad.control.floatingObject.tl.InstanceId===this.c1.WebExtensionId&&(this.Z9=Object(ka.a)(483,ad.control),this.Vwc(ad.control.Fd.firstChild),oa.a(this.$).htc(this.onFloatingObjectControlAdded))};this.jb=M.$;this.Ng=M;this.Ld=ob;this.Ld.InstanceId=ob.SrcLocationOverrideResourceId?
M.M3a(ob.InstanceId,ob.SrcLocationOverrideResourceId):ob.InstanceId;this.ji=$a;this.c1={};this.c1.WebExtensionId=ob.InstanceId;this.NGf="osfControl_"+ob.InstanceId;this.Z6c="disabled_"+ob.InstanceId;this.c1.BindingData=ob.BindingData;this.m6a=this.Ng.m6a(ob.InstanceId);this.Efc=this.Ng.Efc(ob.InstanceId);this.iee=ob.WebExtensionOsfControlType;this.$Jf=Tb}get controlId(){return this.Ld.InstanceId}tbi(M){this.yda||(this.yda=M)}VQf(){this.yda&&(this.yda.dispose(),this.yda=null)}get controlType(){return this.Ld.WebExtensionType}get ownerAddinSolutionId(){return this.Ld.OwnerAddinSolutionId}get $(){return this.jb}get enabled(){return!this.pU}get qy(){return this.HOc}get cU(){return this.Ld.SrcLocationOverrideResourceId?
this.Ng.M3a(this.Ld.PrimaryMarketplace.SolutionId,this.Ld.SrcLocationOverrideResourceId):this.Ld.PrimaryMarketplace.SolutionId}get sourceLocationOverrideResourceId(){return this.Ld.SrcLocationOverrideResourceId}get tl(){return this.Ld}get Z9(){return this.u3d}set Z9(M){this.u3d=M}get osfControlType(){return this.iee}get Fta(){return this.BHc}set Fta(M){this.BHc=M}get P5b(){return this.QVa}set P5b(M){this.QVa=M}get focusOnIframeWhenLoaded(){return this.Ld.FocusOnIframeWhenLoaded}get Chc(){return this.T$d}set Chc(M){this.T$d=
M}Uld(){if(!OSF.OsfControl.isFirstPartyStoreString(this.Ld.PrimaryMarketplace.MarketplaceType)&&gb.EwaSettings.ma(186)){const $a=Pb.GetServiceTaskFactory.Sa(this.$.da,5,4,0);Ca.TaskExtensions.Aa($a,()=>{$a.result.Zf(36,null)},this.la,3);return this}if(1===this.Ld.WebExtensionType)Ca.TaskExtensions.Aa(gc.a(this.$),$a=>{$a.result.yrb(this.$.da,77,6,this.ovf,1)},this.la,3);else{var M=this.UTe();const $a=oa.a(this.$);M||(M={Type:3},M.Id=this.c1.WebExtensionId,M.WebExtensionData=this.Ld,M.ContentHtml=
"<div/>",M.Version=0,M.AbsoluteLeft=0,M.AbsoluteTop=0,M.AbsoluteRight=0,M.AbsoluteBottom=0,M.Width=0,M.Height=0,M.ZOrder=0,M.OriginDeltaX=0,M.OriginDeltaY=0,M=new sb.a(M),$a.A4b(M,null),M=$a.Gq(M.Og()));M?(this.Vwc(M.Fd.firstChild),this.Z9=Object(ka.a)(483,M)):$a.LZb(this.onFloatingObjectControlAdded)}return this}zaf(M){this.Vwc(M);return this}tnc(){this.$Jf||this.Ng.Xh.purgeOsfControl(this.controlId,!1);this.Hcg(!0);const M=this.UTe();M&&oa.a(this.$).deleteFloatingObject(M);this.Ng.jj.F$i(this.controlId);
this.Ng.jj.dMe(this.controlId,!0);this.HOc=null}SBd(M){this.c1=M}invokeDdaMethod(M,$a){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var ob={};ob[ba.a.kg]=M;ob[ba.a.t3]=$a;this.Ng.nK(974713501,ob)}else this.Ng.uf(ca.a.Lyb,$a)}$7i(M,$a,ob,Tb){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!yb.Iih(M)||void 0!==$a&&null!==$a&&void 0!==this.i3a($a)&&null!==this.i3a($a))if(d.ULS.sendTraceTag(36444195,0,50,`eventId: ${M}, targetId: ${$a}`),
yb.Wdf(M)&&this.v7h(),yb.eod(M)&&this.Ekd(),yb.Udf(M))gb.EwaSettings.ma(23)?this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Tb):this.Ng.$.da.za(232).addHandler(this.controlId,ob,Tb,$a);else if(yb.Vdf(M))gb.EwaSettings.ma(23)?this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Tb):this.Ng.$.da.za(232).aDg(this.controlId,ob,Tb);else{yb.Tdf(M)&&this.t6e(-1777565636,Tb);this.bF||(this.bF=[]);var Dc=this.gub(M,$a);Dc||(Dc=new ab(M,$a),this.bF.push(Dc));Dc.Pma();
Dc.VZb(ob);this.Ng.jv(Tb);M===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.QVa&&(this.Q5b=ob)}else this.Ng.uf(3002,Tb);else this.Ng.uf(-1,Tb)}mPj(M,$a,ob,Tb){yb.Udf(M)?gb.EwaSettings.ma(23)?this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Tb):this.Ng.$.da.za(232).removeHandler(this.controlId,Tb):yb.Vdf(M)?gb.EwaSettings.ma(23)?this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Tb):this.Ng.$.da.za(232).W$i(this.controlId,Tb):(yb.Tdf(M)&&this.t6e(1592314317,
Tb),$a=this.gub(M,$a),this.enabled?($a&&($a.qtc(ob),$a.z5h||Array.remove(this.bF,$a),this.bF.length?yb.Wdf(M)&&this.Icg(!1):this.Hcg(!1)),this.Ng.jv(Tb)):this.Ng.uf(-1,Tb))}ka(M){Va.DOMElementExtensions.getElementById(M,this.NGf)||M.appendChild(Va.DOMElementExtensions.sf(this.qy))}showHide(M){Va.DOMElementExtensions.setVisible(this.qy,M)}resize(M,$a){Va.DOMElementExtensions.Jv(this.qy,M);Va.DOMElementExtensions.TI(this.qy,$a)}cJe(M){if(!this.pU&&!Va.DOMElementExtensions.getElementById(this.qy,this.Z6c)&&
this.qy){const $a=document.createElement("div");$a.id=this.Z6c;$a.className=Wa;$a.style.backgroundImage="url("+hb.a.current.Zn(104)+")";$a.style.opacity=M?"1":"0";$a.style.backgroundRepeat="no-repeat";$a.style.backgroundPosition="center";this.qy.insertBefore($a,this.qy.firstChild)}this.pU++}zlh(){0<this.pU&&this.pU--;this.pU||(Va.DOMElementExtensions.sf(Va.DOMElementExtensions.getElementById(this.qy,this.Z6c)),this.swa&&!mb.Q(this.Yqc,va.g(this.$).ha.sa.selectedRanges)&&this.Vc(null,null))}i3a(M){if(!this.c1||
!this.c1.BindingData)return null;for(let $a=0;$a<this.c1.BindingData.length;$a++)if(this.c1.BindingData[$a].Name===M)return this.c1.BindingData[$a];return null}getDefaultIconUrl(){const M=this.Q1e();return M?M.getDefaultIconUrl():null}getDefaultDisplayName(){if(this.Ld.TaskpaneTitle)return this.Ld.TaskpaneTitle;const M=this.Q1e();return M?M.getDefaultDisplayName():null}ZKf(){if(this.QVa&&this.Q5b){const M=new wa.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.QVa);this.Q5b(M);
this.Q5b=this.QVa=null}}qg(M){this.T0d&&this.T0d.qg(M)}vpj(){this.$.ea.isNamedObjectViewMode&&this.ili()&&(this.$.da.za(34).upj(this.qy),this.showHide(!1));if(this.Ng.nXj){if(!this.$Jf){const M={};M.div=this.qy;M.id=this.Ld.InstanceId;M.solutionId=this.Ld.PrimaryMarketplace.SolutionId;M.version=this.Ld.PrimaryMarketplace.SolutionVersion;M.storeId=this.Ld.PrimaryMarketplace.MarketplaceRef;M.storeType=this.Ld.PrimaryMarketplace.MarketplaceType;M.ownerAddinSolutionId=this.Ld.OwnerAddinSolutionId;M.ownerAddinStoreType=
this.Ld.OwnerAddinStoreType;this.Ld.AssetMarketplace&&(M.assetId=this.Ld.AssetMarketplace.SolutionId,M.assetStoreId=this.Ld.AssetMarketplace.MarketplaceRef);M.settings=this.Ld.OsfPropertyBag;gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?M.reason=this.m6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Efc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:
M.reason=this.m6a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;M.osfControlType=0===this.Ld.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;M.isForUILessAction=4===this.Ld.WebExtensionOsfControlType;M.sourceLocationOverrideResourceId=this.Ld.SrcLocationOverrideResourceId;M.focusOnIframeWhenLoaded=this.Ld.FocusOnIframeWhenLoaded;ra.a(this.Ld)&&(M.featureGates=r.AFrameworkApplication.fa.j_e(M.solutionId));
M.hostInfoFlags=0;this.Fta&&(M.hostInfoFlags|=2);db.HelperMethods.tw(this.Ld)&&(M.hostInfoFlags|=1);this.$.V9||(d.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),M.hostInfoFlags|=4);gb.EwaSettings.ma(632)&&(M.hostInfoFlags|=8);gb.EwaSettings.ma(53)&&gb.EwaSettings.ma(93)&&!this.BHc&&(M.virtualOsfControlActivationCallback=()=>{this.Ng.XCd(this.Ld)});M.sharedRuntimeId=this.Ld.SharedRuntime?this.Ld.SharedRuntime.Resid:this.Ld.SharedRuntimeId;!db.HelperMethods.tw(this.Ld)||this.Ld.Preload||
ra.a(this.Ld)||this.Ng.Xh.getOsfControl(a(735).DdaFacade.getSolutionId(this.Ld,this.$))||(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.Ng.XCd(this.Ld):this.Ng.XCd(this.Ld));M.initialDisplayMode=this.Ld.TaskpaneVisible?2:1;gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(M.titleOverride=this.tl.TaskpaneTitle);this.Ng.Xh.insertOsfControl(M)}this.pU=0}else this.cJe(!0)}Hcg(M){this.Icg(M);this.WOj()}v7h(){this.Tcb||
this.ji.VZb(this.r6e);this.Tcb++}Icg(M){0<this.Tcb&&(M?this.Tcb=0:this.Tcb--,this.Tcb||this.ji.qtc(this.r6e))}Ekd(){if(!this.swa){const M=va.g(this.$).ha;this.Yqc=mb.d(va.g(this.$).ha.sa.selectedRanges);M.yE(this.Vc);this.swa=!0}}WOj(){this.swa&&(va.g(this.$).ha.tI(this.Vc),this.swa=!1)}jmj(M){var $a=new Qb.Range(M.Reference.FirstRow+1,M.Reference.FirstColumn+1,M.Reference.LastRow+1,M.Reference.LastColumn+1,!1,!1);1===M.BindingType&&(M.HasHeaders&&--$a.top,M.HasTotals&&($a.bottom+=1));var ob=va.g(this.$).ha.sa.selectedRanges;
M=$a.Kyb(this.Yqc);ob=$a.Kyb(ob);return($a=$a.Ie(va.g(this.$).ha.sa.activeRange))&&(ma.e(M)&&!ma.e(ob)||!ma.e(M)&&!ma.e(ob)&&!mb.Q(M,ob))?$a:null}onj(){Array.forEach(this.bF,M=>{if(M.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&M.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||this.Ng.jj.e0b(this.controlId))if(M.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)M.O1b(new wa.a(M.eventId,this.controlId,null));else if(M.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){const $a=
this.i3a(M.targetId);if((null===$a||void 0===$a?0:$a.IsValidRef)&&(this.$.ea.isNamedObjectViewMode?this.$.Ab.oa.sheetName:this.$.xa.oa.name)===$a.Reference.SheetName){const ob=this.jmj($a);ob&&M.O1b(new Ha(M.eventId,this.controlId,this.Ng.V0b($a),$a,ob.top-1,ob.left-1,ob.height,ob.width))}}})}gub(M,$a){if(!this.bF)return null;for(let ob=0;ob<this.bF.length;ob++){const Tb=this.bF[ob];if(Tb.eventId===M&&Tb.targetId===$a)return Tb}return null}UTe(){const M=oa.a(this.$).KU;for(let $a=M.length-1;0<=$a;--$a){const ob=
M[$a];if(3===ob.floatingObject.type&&ob.floatingObject.tl.InstanceId===this.c1.WebExtensionId)return ob}return null}ili(){for(let M=0;M<this.$.Ab.count;M++)if(this.$.Ab.getItem(M).WLa===this.c1.WebExtensionId)return!0;return!1}Vwc(M){this.HOc=M;this.qy.id=this.NGf;this.qy.className=Sa;this.qy.dir=this.$.isChromeRtl?"rtl":"ltr";this.vpj()}Q1e(){if(!this.enabled)return null;const M=ra.a(this.tl)?"":this.tl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.tl.PrimaryMarketplace.SolutionId,
M)}t6e(M,$a){if(gb.EwaSettings.ma(23))this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,$a);else try{if(d.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.iee)this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,$a);else{const ob={};ob[Q.a.Mnb]=this.controlId;const Tb=new vb.a(M,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Lb(Tb,ob);this.Ng.jv($a)}}catch(ob){d.ULS.sendTraceTag(537170461,0,10,`HandleDialogNotificationShownInAddinEvent called. Error message: ${ob.message}.`),
this.Ng.uf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,$a)}}static Iih(M){return M===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||M===OSF.DDA.EventDispId.dispidBindingDataChangedEvent}static Wdf(M){return M===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||M===OSF.DDA.EventDispId.dispidSettingsChangedEvent||M===OSF.DDA.EventDispId.dispidRichApiMessageEvent}static eod(M){return M===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||M===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent}static Udf(M){return M===
OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent}static Vdf(M){return M===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static Tdf(M){return M===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent}}Object(c.a)(yb,"OsfControl",nb.a,[811]);class Ma{constructor(){this.uZa={}}add(M){this.uZa[M]=!0}remove(M){delete this.uZa[M]}clear(){for(const M of Object.keys(this.uZa))delete this.uZa[M]}J7e(){return 0<Object.keys(this.uZa).length}lIh(){return Object.keys(this.uZa)}}Object(c.a)(Ma,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Bb=a(58);class Nb{constructor(M,$a,ob){this.MPf=this.LPf=0;this.YLb=this.Gab=null;this.mHi=()=>{var Tb=va.g(this.$).ha.Qa.$A;if(this.Ond(Tb)&&(Tb=this.svb(Tb))){var Dc={};Dc.chartId=Tb;Dc.worksheetId=this.uja();Dc=Bb.a.kc(Dc);this.Ria(51,Tb,Dc);this.Ria(51,this.uja(),Dc)}};this.nHi=()=>{if(this.Gab){var Tb={};Tb.chartId=this.Gab;Tb.worksheetId=this.YLb;Tb=Bb.a.kc(Tb);this.Ria(52,this.Gab,Tb);this.Ria(52,this.YLb,Tb)}Tb=va.g(this.$).ha.Qa.$A;
this.Ond(Tb)?(this.Gab=this.svb(Tb),this.YLb=this.uja()):this.YLb=this.Gab=null};this.$=M;this.jj=$a;this.ji=ob}Job(M){51===M.messageType?this.LPf=this.CGa(M.actionType,this.LPf,this.mHi):52===M.messageType&&(this.MPf=this.CGa(M.actionType,this.MPf,this.nHi))}CGa(M,$a,ob){if(1===M)$a||va.g(this.$).ha.Qa.xVc(ob),$a++,this.gtj();else if(2===M){if(1>$a)return $a;1===$a&&va.g(this.$).ha.Qa.nKd(ob);$a--}return $a}Ria(M,$a,ob){$a&&this.jj.KZ(M,$a)&&this.ji.NM(M,$a,ob)}svb(M){return M&&M.floatingObject?
(M=M.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===M.length?M[0]:null:null}uja(){const M=this.$.xa.oa;return M&&0===M.mG?M.sheetId:null}gtj(){const M=va.g(this.$).ha.Qa.$A;this.Ond(M)&&(this.Gab=this.svb(M),this.YLb=this.uja())}Ond(M){return!!M&&!!M.floatingObject&&0===M.floatingObject.type}}Object(c.a)(Nb,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ia=a(738),jb=a(192),Ob=a(612),Jb=a(100),Kb=a(345),Qa=a(55);class ha extends Y.a{constructor(M,$a,
ob){super();this.pU=this.Yza=0;this.Vc=(Tb,Dc)=>{if(this.enabled&&!(this.Mff()||null!==Dc&&void 0!==Dc&&Dc.Xif)&&(Tb=Object(ka.a)(Jb.a,this.$.xa.oa))&&0===Tb.mG){const ad=Tb.sheetId,ld=this.jZe();let md=null,Wb=null;this.jj.Lif()&&(md=this.grid.Fb.hk(this.grid.ha.sa.activeCell),Wb=ad in this.rjc?this.rjc[ad]:null);this.$se(ad,ld)&&Ca.TaskExtensions.Aa(Qa.Task.Ta(!0),()=>{this.X4h(ad,ld);this.J4h(ad,ld,md,Wb)},this.la);this.aKe(ad,ld,md)}};this.$=M;this.jj=$a;this.ji=ob;this.grid=va.g(M);this.JNa=
{};this.rjc={}}get enabled(){return!this.pU&&0<this.Yza}B0b(M){Object(ka.a)(Kb.a,this.$.xa);1===M.actionType?(this.Yza||this.grid.ha.yE(this.Vc),this.Yza++):2!==M.actionType||1>this.Yza||(1===this.Yza&&this.grid.ha.tI(this.Vc),this.Yza--)}Fwc(M){M?this.pU++:(0<this.pU&&this.pU--,this.pU||this.Vc(null,new Ob.a(!1)))}jZe(){return this.grid.ha.sa.selectedRanges}$se(M,$a){return gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!M&&jb.e(this.JNa)||
M in this.JNa)&&!mb.Q(this.JNa[M],$a):M in this.JNa&&!mb.Q(this.JNa[M],$a)}aKe(M,$a,ob){this.JNa[M]=mb.d($a);this.rjc[M]=ob}Mff(){return this.grid.eb||this.grid.Fi}tUe(M,$a){this.jj.KZ(14,M)&&this.ji.NM(14,M,$a);this.jj.KZ(14,Ia.a.wW)&&this.ji.NM(14,Ia.a.wW,$a)}X4h(M,$a){const ob={};ob.worksheetId=M;ob.address=this.Ggd($a);$a=Bb.a.kc(ob);this.tUe(M,$a)}J4h(M,$a,ob,Tb){if(this.jj.Lif()){var Dc="";let ad="";Tb&&(Dc=Tb.mj);ob&&(ad=ob.mj);Tb?ob?($a=ob.usedRange.Kyb($a),Dc!==ad&&this.d$b(Dc,"",M),this.d$b(ad,
this.Ggd($a),M)):this.d$b(Dc,"",M):ob&&(Dc=ob.usedRange.Kyb($a),this.d$b(ad,this.Ggd(Dc),M))}}d$b(M,$a,ob){if(this.jj.KZ(100,M)){const Tb={};Tb.address=$a;Tb.worksheetId=ob;this.ji.NM(100,M,Bb.a.kc(Tb))}}Ggd(M){return mb.i(M,",",this.$,!1)}dispose(){0<this.Yza&&this.grid.ha.tI(this.Vc);this.rjc=this.JNa=null;this.Yza=0;this.ji=this.jj=this.$=this.grid=null}}Object(c.a)(ha,"RichApiEventSelectionChangedHandler",Y.a,[]);var qa=a(341);class pb extends ha{constructor(M,$a,ob){super(M,$a,ob);this.Rkf=this.Skf=
null}jZe(){return qa.a.Jrb(this.grid.ha.rangePicker.XK)}$se(M,$a){return this.Skf!==M||!mb.Q(this.Rkf,$a)}aKe(M,$a){this.Skf=M;this.Rkf=mb.d($a)}Mff(){return!this.grid.eb&&!this.grid.Fi}tUe(M,$a){this.jj.KZ(2700,Ia.a.wW)&&this.ji.NM(2700,Ia.a.wW,$a)}}Object(c.a)(pb,"RichApiEventPickedRangesChangedHandler",ha,[]);class bb{constructor(M,$a,ob){this.JQa=this.IQa=0;this.YGa=this.tha=null;this.Jyf=()=>{var Tb=va.g(this.$).ha.Qa.$A;if(0<this.JQa&&this.tha&&this.YGa){var Dc={};Dc.shapeId=this.tha;Dc.worksheetId=
this.YGa;Dc=Bb.a.kc(Dc);this.fireEvent(2102,this.tha,Dc)}this.Vmi(Tb)?(this.tha=this.yNj(Tb),this.YGa=this.uja(),this.tha&&this.YGa)?0<this.IQa&&(Tb={},Tb.shapeId=this.tha,Tb.worksheetId=this.YGa,Tb=Bb.a.kc(Tb),this.fireEvent(2101,this.tha,Tb)):d.ULS.sendTraceTag(537170458,344,10,`Something goes wrong, we got invalid shape id: '${this.tha}', or worksheet id: '${this.YGa}' from a Floating object or gridview.`):this.YGa=this.tha=null};this.$=M;this.jj=$a;this.ji=ob}Job(M){const $a=va.g(this.$).ha;1===
M.actionType?(this.IQa||this.JQa||$a.Qa.xVc(this.Jyf),2101===M.messageType?this.IQa++:2102===M.messageType&&this.JQa++):2===M.actionType&&(2101===M.messageType?this.IQa=0<this.IQa?this.IQa-1:0:2102===M.messageType&&(this.JQa=0<this.JQa?this.JQa-1:0),this.IQa||this.JQa||$a.Qa.nKd(this.Jyf))}Vmi(M){return!!M&&!!M.floatingObject&&(0===M.floatingObject.type||7===M.floatingObject.type||1===M.floatingObject.type||3===M.floatingObject.type||5===M.floatingObject.type)}yNj(M){if(!M||!M.floatingObject)return null;
M=M.floatingObject.id;var $a=M.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));$a=$a&&1===$a.length?$a[0]:null;return $a?$a:(d.ULS.sendTraceTag(537170457,344,10,`Expect get the guid like shape id from the floating object id: '${M}', but we failed.`),null)}uja(){const M=this.$.xa.oa;return M&&0===M.mG?M.sheetId:null}fireEvent(M,$a,ob){$a&&this.jj.KZ(M,$a)&&this.ji.NM(M,$a,ob)}}Object(c.a)(bb,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);class eb{constructor(M,$a,ob){this.PPf=this.OPf=
this.QPf=this.NPf=0;this.CUi=(Tb,Dc)=>{Tb=Object(ka.a)(Jb.a,Dc.oa);this.S7a(Tb)&&(Dc={},Dc.worksheetId=Tb.sheetId,Dc=Bb.a.kc(Dc),this.Ria(11,Tb.sheetId,Dc))};this.FUi=(Tb,Dc)=>{Tb=Object(ka.a)(Jb.a,Dc.ED);this.S7a(Tb)&&(Dc={},Dc.worksheetId=Tb.sheetId,Dc=Bb.a.kc(Dc),this.Ria(12,Tb.sheetId,Dc))};this.DUi=(Tb,Dc)=>{Tb=Object(ka.a)(Jb.a,Dc.oa);this.S7a(Tb)&&(Dc={},Dc.worksheetId=Tb.sheetId,Tb=Bb.a.kc(Dc),this.Ria(11,null,Tb,!0))};this.EUi=(Tb,Dc)=>{Tb=Object(ka.a)(Jb.a,Dc.ED);this.S7a(Tb)&&(Dc={},Dc.worksheetId=
Tb.sheetId,Tb=Bb.a.kc(Dc),this.Ria(12,null,Tb,!0))};this.$=M;this.jj=$a;this.ji=ob}Job(M){11===M.messageType?M.targetId===Ia.a.wW?this.CNg(M.actionType):this.BNg(M.actionType):12===M.messageType&&(M.targetId===Ia.a.wW?this.DNg(M.actionType):this.ENg(M.actionType))}BNg(M){this.NPf=this.CGa(M,this.NPf,this.CUi)}ENg(M){this.QPf=this.CGa(M,this.QPf,this.FUi)}CNg(M){this.OPf=this.CGa(M,this.OPf,this.DUi)}DNg(M){this.PPf=this.CGa(M,this.PPf,this.EUi)}CGa(M,$a,ob){1===M?$a=this.SXc($a,ob):2===M&&($a=this.K6c($a,
ob));return $a}SXc(M,$a){M||this.$.xa.Qf($a);M++;return M}K6c(M,$a){if(1>M)return M;1===M&&this.$.xa.Eg($a);M--;return M}S7a(M){return!!M&&0===M.mG}Ria(M,$a,ob,Tb=!1){$a=Tb?Ia.a.wW:$a;this.jj.KZ(M,$a)&&this.ji.NM(M,$a,ob)}}Object(c.a)(eb,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Fa=a(237),tb=a(13),dc=a(223);class jc extends Sys.EventArgs{constructor(M,$a,ob,Tb){super();this.sheet=M;this.MWg=$a;this.offsetX=ob;this.offsetY=Tb}}Object(c.a)(jc,"ClickInActiveCellEventArgs",Sys.EventArgs,
[]);class fb{constructor(M,$a,ob){this.Y2b=null;this.Wrd=!1;this.onPointerDown=Tb=>{let Dc;3===Tb.tb?({u0a:Dc}=this.gridView.tac(Tb.clientPoint),this.Wrd=!!Dc&&this.gridView.ha.sa.gKe(Dc)):this.Wrd=!1;this.Y2b=Tb.clientPoint;return!1};this.gd=Tb=>{if(this.gridView.inRangePicker||this.gridView.Fi||this.Wrd||Tb.shiftKey||Tb.ctrlKey||Tb.Ca.button!==Sys.UI.MouseButton.leftButton||!this.Y2b||!Tb.clientPoint||Tb.clientPoint.x!==this.Y2b.x||Tb.clientPoint.y!==this.Y2b.y)return!1;const Dc=({u0a:Tb}=this.gridView.tac(Tb.clientPoint)).returnValue,
ad=Object(ka.a)(Jb.a,this.$.xa.oa);if(Dc&&ad&&0===ad.mG){if(!this.gridView.ha.sa.b4.contains(Tb))return!1;Tb=new jc(ad,Tb,db.HelperMethods.HEd(Dc.x),db.HelperMethods.HEd(Dc.y));this.GUi(Tb)}return!1};this.$=M;this.gridView=va.g(M);this.jj=$a;this.ji=ob;this.z9i()}dispose(){this.HPj()}z9i(){for(const M of this.gridView.Cn){const $a=M.domElement;Fa.a.instance.ra(tb.a.pointerDown,$a,this.onPointerDown);dc.a.instance.ra(tb.a.click,$a,this.gd)}}HPj(){for(const M of this.gridView.Cn){const $a=M.domElement;
Fa.a.instance.Ba(tb.a.pointerDown,$a,this.onPointerDown);dc.a.instance.Ba(tb.a.click,$a,this.gd)}}GUi(M){var $a=M.sheet;if(this.S7a($a)){var ob={};ob.worksheetId=$a.sheetId;ob.address=M.MWg.toString();ob.offsetX=M.offsetX;ob.offsetY=M.offsetY;M=$a.sheetId;this.jj.KZ(21,M)&&($a=Bb.a.kc(ob),this.ji.NM(21,M,$a));M=Ia.a.wW;this.jj.KZ(21,M)&&(ob=Bb.a.kc(ob),this.ji.NM(21,M,ob))}}S7a(M){return!!M&&0===M.mG}}Object(c.a)(fb,"RichApiEventSingleClickedHandler",null,[]);class ec{constructor(M,$a,ob){this.qIb=
0;this.xab=this.Dab=null;this.QFf=()=>{const Tb=va.g(this.$).ha.Qa.$A;if(Tb)if(this.zjf(Tb)){const Dc=this.uja();this.pbd(Dc);this.Dab=Tb.floatingObject.id;this.xab=Dc}else this.Dab&&(this.pbd(this.xab),this.xab=this.Dab=null);else this.Dab&&(this.pbd(this.xab),this.xab=this.Dab=null)};this.$=M;this.jj=$a;this.ji=ob}B0b(M){2E3===M.messageType&&(1===M.actionType?(this.qIb||va.g(this.$).ha.Qa.xVc(this.QFf),this.qIb++,this.Cpj()):2===M.actionType&&this.qIb&&(1===this.qIb&&va.g(this.$).ha.Qa.nKd(this.QFf),
this.qIb--))}pbd(M){var $a;const ob={};ob.worksheetId=M;ob.revisionLoad=!1;if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(gb.EwaSettings.ma(709)||gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){const Tb=va.g(this.$).ha.Qa.$A;(null===($a=null===Tb||void 0===Tb?void 0:Tb.floatingObject)||void 0===$a?0:$a.Tc)?ob.selectedVisualId=Tb.floatingObject.Tc.VisualID:ob.selectedVisualId=null}$a=
Bb.a.kc(ob);M&&this.jj.KZ(2E3,M)&&this.ji.NM(2E3,M,$a)}uja(){const M=this.$.xa.oa;return M&&0===M.mG?M.sheetId:null}Cpj(){const M=va.g(this.$).ha.Qa.$A;this.zjf(M)&&(this.Dab=M.floatingObject.id,this.xab=this.uja())}zjf(M){return!!M&&M.ssd()}}Object(c.a)(ec,"RichApiEventVisualSelectionChangedHandler",null,[]);class lb{constructor(M,$a,ob){this.rIb=0;this.sig=!0;this.t$b=0;this.Rqd=!0;this.jze=()=>{const Tb=document.hasFocus();if(this.sig!==Tb){if(Tb){const Dc=Bb.a.kc({});this.ji.NM(2203,Ia.a.wW,Dc)}this.sig=
Tb}};this.kze=Tb=>{(0<Tb.timeRemaining()||Tb.didTimeout)&&this.jze();window.requestIdleCallback(this.kze)};this.$=M;this.jj=$a;this.ji=ob;window.requestIdleCallback||(this.Rqd=!1)}ANg(M){1===M.actionType?(this.rIb||this.UNg(),this.rIb++):2!==M.actionType||1>this.rIb||(1===this.rIb&&this.sfh(),this.rIb--)}UNg(){if(this.jj.KZ(2203,Ia.a.wW))if(this.Rqd){const M={};M.timeout=this.$.ya.CheckFocusTimeout;this.t$b=window.requestIdleCallback(this.kze,M)}else this.t$b=window.setInterval(this.jze,this.$.ya.CheckFocusTimeInterval)}sfh(){this.Rqd?
window.cancelIdleCallback(this.t$b):window.clearInterval(this.t$b)}}Object(c.a)(lb,"RichApiEventWorkbookActivatedHandler",null,[]);var ac;(function(M){M[M.none=0]="none";M[M.registerEvent=1]="registerEvent";M[M.unregisterEvent=2]="unregisterEvent";M[M.customFunction=3]="customFunction";M[M.showCard=4]="showCard";M[M.createWorkbook=5]="createWorkbook";M[M.openWorkbook=6]="openWorkbook";M[M.enableEvents=7]="enableEvents";M[M.closeWorkbook=8]="closeWorkbook";M[M.setCalculationMode=9]="setCalculationMode";
M[M.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";M[M.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";M[M.workbookLinksEnableContent=12]="workbookLinksEnableContent";M[M.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";M[M.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";M[M.rangePicker=15]="rangePicker";M[M.enableRichApiRecording=16]="enableRichApiRecording";M[M.recordAction=17]="recordAction";M[M.focus=18]="focus";M[M.businessBarShow=19]="businessBarShow";
M[M.businessBarHide=20]="businessBarHide"})(ac||(ac={}));Object(c.b)("PostProcessActionType",ac);var Gb=a(248);class wb{constructor(M,$a,ob){this.OGf=null;this.nbd=(Tb,Dc)=>{const ad=Ia.a.wW,ld={};ld.eventId=Tb;ld.payload=Dc;this.jj.KZ(2201,ad)&&this.ji.NM(2201,ad,Bb.a.kc(ld))};this.$=M;this.jj=$a;this.ji=ob;this.Wai()}zNg(M){1===M.actionType?(this.$.Cba=!0,Object(ka.a)(a(735).DdaFacade,Gb.a(this.$)).obd(!0)):2===M.actionType&&(this.$.Cba=!1);this.OGf=M.controlId;d.ULS.sendTraceTag(537170456,0,50,
`AttachOrDetachMacroRecorderEventHandler: actionType: ${ac[M.actionType]}; controlId: ${this.OGf}; this.ewaControl.IsMacroRecorderListening: ${this.$.Cba}.`)}Hmh(M){Object(ka.a)(a(735).DdaFacade,Gb.a(this.$)).wUe(M,this.$.Cba)}Wai(){this.$.QZ&&Ca.TaskExtensions.Aa(Pb.GetServiceTaskFactory.Sa(this.$.da,297,298,1),M=>{(M=M.result)&&M.init(this.nbd)},this.$.la,3)}}Object(c.a)(wb,"RichApiMacroRecorderEventHandler",null,[]);class qc{}Object(c.a)(qc,"SessionRecreationInfo",null,[]);class Ya{constructor(M,
$a,ob){this.$=M;this.jj=$a;this.runtimeCalculationMode=ob}cDi(){return gb.EwaSettings.ma(259)?this.jj.J5h()||0!==this.runtimeCalculationMode:!1}GSg(){var M={};M.eventRegistrationInfos=this.jj.xOh();M.runtimeCalculationMode=this.runtimeCalculationMode;M=Object(b.a)(new qc,{runtimeState:M});const $a={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};$a.RequestBody=JSON.stringify(M);$a.RequestFlags=1;return $a}}Object(c.a)(Ya,"RichApiRuntimeStateHandler",null,[]);class xb{constructor(M,
$a,ob,Tb,Dc,ad,ld,md,Wb){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=M;this.processUtcTime=$a;this.dequeueUtcTime=ob;this.inQueueDurationInMS=Tb;this.executionDurationInMS=Dc;this.operationCount=ad;this.ServerCorrelationId=ld;this.UserOperationName=md;this.IsDocumentHidden=Wb}}Object(c.a)(xb,"UserOperationQueueItemsStatisticsData",
null,[]);var wc=a(327),Oc=a(31),Cb=a(19),Ib=a(293),fc=a(49),vc=a(595),Cc=a(65),fd=a(59),od=a(71);class Ub extends wc.a{constructor(M,$a,ob){super(ob,M);this.Vva=this.hashCode=null;this.$3b=!1;this.Tm=(Tb,Dc)=>{Dc.hd.hash===this.hashCode&&this.Vva&&Object(ka.a)(a(735).DdaFacade,this.$.da.za(35)).pAj(this.Vva.InstanceId)};this.rf=(Tb,Dc)=>{switch(Dc.hd.block.state){case 1:case 3:case 5:this.Bna(Dc)}};this.Ej=()=>{this.BHb(!0)};this.Jo=(Tb,Dc)=>{this.isVisible&&this.pUa(Dc.ED);this.clearCache()};this.te=
(Tb,Dc)=>{this.rTa(Dc.oa,!!Dc.ED)};this.JN=()=>{this.$.ea.mma()};this.RUa=$a;this.domElement.classList.add(Oc.a.V8b);this.domElement.classList.add(Cb.a.lp);ob.tabIndex=0;this.rTa(this.$.oa,!1);this.Gc.ka("mousedown",this.JN);this.Gc.ka("contextmenu",Tb=>{od.g(Tb)});this.$.xa.wJ(this.Jo);this.$.Ab.wJ(this.Jo);this.$.Ab.Qf(this.te);this.$.xa.Qf(this.te);this.Ea.Ws(this.rf);this.Ea.XG(this.Tm);this.Ea.Wv(this.Ej);gb.EwaSettings.$b()&&this.Uu(this.Nya)}get Ea(){return this.RUa}dispose(){this.$&&(this.$.xa.cL(this.Jo),
this.$.Ab.cL(this.Jo),this.$.Ab.Eg(this.te),this.$.xa.Eg(this.te));this.RUa&&(this.RUa.Xq(this.rf),this.RUa.sI(this.Tm),this.RUa.Rw(this.Ej));gb.EwaSettings.$b()&&this.xy(this.Nya);this.clearCache();ta.a.Ia(this.RUa);this.RUa=null;Va.DOMElementExtensions.sf(this.domElement);super.dispose()}upj(M){Va.DOMElementExtensions.sf(Va.DOMElementExtensions.getElementById(this.domElement,M.id));this.domElement.appendChild(M)}hmd(){if(this.Vva&&!this.$3b){var M=Object(ka.a)(a(735).DdaFacade,Gb.a(this.$)).pn(this.Vva.InstanceId);
M&&(M.resize(this.Vva.Width,this.Vva.Height),M.ka(this.domElement),M.showHide(!0),this.$3b=!0)}}U7a(){return!0}Bna(M){this.Vva=M.hd.block.je;this.$3b=!1;this.hmd()}pUa(M){this.$.ea.IZ&&M&&(M.Iu||(M.Iu=new Ib.a),M.Iu.Uh=new fc.a(this.domElement.scrollLeft,this.domElement.scrollTop),M.Iu.TGb=20)}clearCache(){this.Ea.PQa(this.hashCode);this.Vva=this.hashCode=null;this.$3b=!1}rTa(M,$a){if(this.isVisible=!!M&&Cc.o(M))this.hashCode=this.Ea.Pra(M,fd.a.f6b,this.hashCode),this.kxc($a)}static DGa(M){if(!M.da.za(34)){const $a=
M.Ef;M.da.Ga(34,new Ub(M,new vc.a(M,M.ea,M.pa.Hk,3,0),$a.appendChild($a.ownerDocument.createElement("div"))))}}}Object(c.a)(Ub,"WebExtensionView",wc.a,[808,170,10]);var Fc=a(225),$b=a(515),zc=a(370),Wc=a(435),yc=a(171),pd=a(61),xd=a(116),Vb=a(47),Uc=a(45),ud=a(152),Vc=a(110),yd=a(62),Sd=a(28),Wd=a(29),Hd=a(282),le=a(22),Le=a(14),Md=a(281),ke=a(737),ve=a(51),ge=a(146),we=a(865);const De=M=>{ge.a.sendOtelEvent(Object.assign(new we.a,{otelEvent:M}))},ib=M=>{ge.a.sendOtelCustomerContent(Object.assign(new we.a,
{otelEvent:M}))};var Yb=a(199),pc=a(864),Jc=a(25);a.d(C,"DdaFacade",function(){return Xc});class Xc extends Ra.a{constructor(M,$a){super();this.ji=this.$m=this.ea=null;this.yf=[];this.$Ia=null;this.disposed=this.initialized=this.sQb=this.UGe=!1;this.mCa=null;this.ypc=[];this.PGe=[];this.OPa=[];this.L1a=null;this.yEd=new K.a(na.a.Zk());this.p_b=new P.a(na.a.Zk());this.AGb=[];this.gIf=[];this.l6b=350;this.Gxa=this.Wea=null;this.sTc=!1;this.Ege=this.Dge=this.Cge=this.zge=this.vge=this.Bge=this.wge=this.yge=
this.uge=this.xge=null;this.Vf=()=>{this.mCa=this.ea.Eo.WebExtensions;for(var ob=this.yf.length-1;0<=ob;--ob){var Tb=this.yf[ob],Dc;if(Dc=!this.WBh(Tb.controlId))Dc=Tb,Dc=gb.EwaSettings.ma(121)?!Dc.Fta:!0;Dc&&(Tb.tnc(),this.yf.splice(ob,1))}if(this.mCa)for(let ad=0,ld=this.mCa.length;ad<ld;ad++)ob=this.mCa[ad],(Tb=this.pn(ob.WebExtensionId))&&Tb.SBd(ob)};this.voc=ob=>{this.raiseEvent("csc",ob.getID())};this.dCd=(ob,Tb,Dc)=>{if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&
Tb===OSF.AgaveHostAction.KeyboardShortcuts){var ad=Object(ka.a)(Object,Dc);Tb={};Tb.keyCode=ad.keyCode;Tb.type="keydown";Tb.ctrlKey=ad.ctrlKey;Tb.shiftKey=ad.shiftKey;Tb.altKey=ad.altKey;Tb.metaKey=ad.metaKey;ad=this.pn(ob);ob=ad.Z9;Tb.srcElement=Object(pa.a)(405,ob)?ob.pGa:va.g(this.$).nc;ob=new Sys.UI.DomEvent(Tb);ad=Xc.gva(ad.tl,this.$);Tb={};Tb.focusedAddinId=ad;ad=new vb.a(1461300262,1,this.$.Kc,6,null);va.g(this.$).ZJb(ob,ad,Tb)}else if(Tb===OSF.AgaveHostAction.Select)this.c6e(!0);else if(Tb===
OSF.AgaveHostAction.UnSelect)this.c6e(!1);else if(Tb===OSF.AgaveHostAction.CancelDialog)this.nK(-684355545,null);else if(Tb===OSF.AgaveHostAction.InsertAgave)ob={},Dc&&(ob[Q.a.Yra]=Dc,ob[ba.a.kg]=Xc.Nrb(Dc),this.nK(-741808261,ob));else if(Tb===OSF.AgaveHostAction.InsertDevManifest)ob={},Dc&&(ob[Q.a.Yra]=Dc,ob[ba.a.kg]=Xc.Nrb(Dc),this.nK(-741808261,ob));else if(Tb===OSF.AgaveHostAction.InsertDevManifestError)ob=Object(ka.a)(Object,Dc),ob={[Q.a.eWc]:this.$m.getDevManifestInvalidUrlErrorString(ob.manifestUrl)},
this.nK(-2025863019,ob);else if(Tb===OSF.AgaveHostAction.NotifyHostError)ob={[Q.a.eWc]:this.$m.getManifestInvaildErrorString()},this.nK(-2025863019,ob);else if(Tb===OSF.AgaveHostAction.RefreshAddinCommands)gb.EwaSettings.ma(53)&&this.nK(Jc.a.refreshAddinCommands,null);else if(Tb===OSF.AgaveHostAction.CtrlF6Exit||Tb===OSF.AgaveHostAction.CtrlF6ExitShift){if(ad=this.$.da.za(15)){(ob=this.pn(ob).Z9)&&ob.vzc();y.a.Uf&&document.activeElement.blur();var ld={keyCode:117,type:"keydown",ctrlKey:!0};ld.shiftKey=
Tb===OSF.AgaveHostAction.CtrlF6ExitShift;ld.srcElement=Object(pa.a)(405,ob)?ob.pGa:va.g(this.$).nc;ob=new Sys.UI.DomEvent(ld);ad.fma(ob)}}else if(Tb===OSF.AgaveHostAction.PageIsReady){if((ob=this.pn(ob).Z9)&&ob.BZa===OSF.OsfControlTarget.TaskPane&&(ob=this.$.da.za(183))&&this.yf){Tb=Xb.a.od(this.$);for(ad of this.yf)Xc.wMa(ad.cU)&&(Tb?ob.hg(!0,!1):ob.setFocusOnToolbarFirstElement())}}else if(Tb===OSF.AgaveHostAction.TabExit){Tb=this.pn(ob);const Nc=Tb.Z9;if(Nc)if(Nc.BZa===OSF.OsfControlTarget.InContent)Nc.ukf();
else{if(Nc.BZa===OSF.OsfControlTarget.TaskPane)if(Xb.a.od(this.$))y.a.Uf&&document.activeElement.blur(),O.UISurfaces.Tj().then(gd=>{const Gd=Object(pa.a)(405,Nc)?Nc:null;Gd?Gd.isResizable?gd.focusResizeHandle():gd.focusTabbedTaskPaneArea():gd.focusTabbedTaskPaneArea();return null});else if(Tb=this.$.da.za(183))y.a.Uf&&document.activeElement.blur(),(ob=document.getElementById(this.$.Cb+Da.a.umc))&&Va.DOMElementExtensions.isVisible(ob)?Va.DOMElementExtensions.setFocus(ob):Tb.setFocusOnToolbarFirstElement()}else Tb&&
4===Tb.osfControlType&&this.$m.notifyAgave(ob,OSF.AgaveHostAction.TabIn)}else if(Tb===OSF.AgaveHostAction.TabExitShift)(Tb=this.pn(ob),ad=Tb.Z9)?ad.BZa===OSF.OsfControlTarget.InContent?ad.vkf():ad.BZa===OSF.OsfControlTarget.TaskPane&&(ob=Object(pa.a)(405,ad)?ad:null)&&(y.a.Uf&&document.activeElement.blur(),ob.T_f()):Tb&&4===Tb.osfControlType&&this.$m.notifyAgave(ob,OSF.AgaveHostAction.TabIn);else if(Tb===OSF.AgaveHostAction.EscExit||Tb===OSF.AgaveHostAction.ExitNoFocusable||Tb===OSF.AgaveHostAction.ExitNoFocusableShift)if(ad=
this.pn(ob).Z9)ad.vzc();else{if(Tb===OSF.AgaveHostAction.EscExit){Tb=null;for(ld of D.D0h())if(ld.value.Ce===ob){ld.value.dialog.hide();Tb=ld.key;break}Tb&&(ob=this.pn(Tb))&&4!==ob.osfControlType&&this.Xh.notifyAgave(Tb,OSF.AgaveHostAction.TabIn)}}else if(Tb===OSF.AgaveHostAction.InstallCustomFunctions)if(gb.EwaSettings.ma(121)){yd.a(this.$).BVe(()=>!1);var md=this.$.da;Ca.TaskExtensions.Aa(Pb.GetServiceTaskFactory.Sa(md,278,279,1),Nc=>{Nc=Nc.result;md.za(278)||md.Ga(278,Nc);const gd=Dc.osfControl.getStoreType();
Nc.Ebf(Dc.osfControl.getSolutionId(),gd,Xc.OMh(Dc.osfControl),Dc).ina()},this.la,3)}else d.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Tb===OSF.AgaveHostAction.UninstallCustomFunctions)if(gb.EwaSettings.ma(121)){yd.a(this.$).BVe(()=>!1);var Wb=this.$.da;Ca.TaskExtensions.Aa(Pb.GetServiceTaskFactory.Sa(Wb,278,279,1),Nc=>{Nc=Nc.result;Wb.za(278)||Wb.Ga(278,Nc);Nc.Kcg(Dc.solutionId,Dc.storeType).ina()},this.la,
3)}else d.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Tb===OSF.AgaveHostAction.SendTelemetryEvent?De(Dc):Tb===OSF.AgaveHostAction.SendCustomerContent?ib(Dc):Tb===OSF.AgaveHostAction.LaunchExtensionComponent?f.a.instance.yri(Dc):Tb===OSF.AgaveHostAction.RefreshRibbonGallery?(ob=this.$.da.za(352))&&ob.n5a(Dc):Tb===OSF.AgaveHostAction.RemoveAppCommandsAddin?(this.caj(Dc.solutionId),Xb.a.od(this.$)||(ob=this.$.da.za(183))&&
ob.gA(),gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&r.AFrameworkApplication.vb.de(Jc.a.gQf,2,Dc.solutionId)):Tb===OSF.AgaveHostAction.GetOriginalControlId&&(ob=new L.a(this.$.Cb,Dc.ownerAddinSolutionId,new Ba.a,!0),Dc.originalControlId=ob?ob.eHe(Dc.controlId):Dc.controlId)};this.pnj=(ob,Tb)=>{const Dc=Array(2);Dc[0]=Tb;Dc[1]=null;this.ji.eCh(ob,JSON.stringify(Dc))};this.kUi=()=>{this.$.oa&&Cc.o(this.$.oa)&&this.$.da.za(34).hmd()};
this.dd=()=>{this.qmf()};this.rR=(ob,Tb)=>{var Dc,ad;1===Tb.Vq&&(ob=Tb.zf)&&(Tb=new xb(Vc.toTimestamp(ob.enqueueUtcTime),Vc.toTimestamp(ob.processUtcTime),Vc.toTimestamp(ob.dequeueUtcTime),Vc.getElapsedMilliseconds(ob.enqueueUtcTime,ob.processUtcTime),Vc.getElapsedMilliseconds(ob.processUtcTime,ob.dequeueUtcTime),ob.operationCount,(null===(ad=null===(Dc=ob.operation)||void 0===Dc?void 0:Dc.ed)||void 0===ad?0:ad.ServerCorrelationId)?ob.operation.ed.ServerCorrelationId:null,ob.operation?Enum.toString(Wc.a,
ob.operation.operationName):null,ke.a.lD(Vc.getElapsedMilliseconds(ob.enqueueUtcTime,Sd.a.Pa.zb))),Dc=Sys.Serialization.JavaScriptSerializer.serialize(Tb),d.ULS.sendTraceTag(50872916,0,50,Dc))};this.Wc=(ob,Tb)=>{!this.ea.fc&&Fc.a(Tb)?(Array.forEach(this.yf,this.zxf),this.yf.length=0,this.sQb=!1):(Tb.LH&&(d.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),this.GUf()),this.gL(),gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(this.sQb=!1))};this.Lo=()=>{gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(d.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),this.GUf());this.gL();gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(this.sQb=!1)};this.zxf=ob=>{ob.tnc();this.raiseEvent("cd",ob.controlId)};this.jb=M;this.xWc=$a;this.initialize();sa.ka(this);this.IVf=0;(M=(M=!(y.a.Ap||y.a.Y4))&&(!gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!y.a.Uf))&&OfficeExt.ShortcutKeyDispatchManager.init();this.Zrg={}}get m0b(){return this.Wea||(this.Wea=new V.a(this.$.$u))}uVc(M){this.addHandler("cd",M)}dbj(M){this.removeHandler("cd",M)}SFg(M){this.addHandler("csc",M)}fbj(M){this.removeHandler("csc",M)}PFg(M){this.addHandler("ca",M)}cbj(M){this.removeHandler("ca",M)}QFg(M){this.addHandler("ci",M)}RFg(M){this.addHandler("ekros",M)}ebj(M){this.removeHandler("ekros",M)}aEd(M,$a){try{return JSON.parse(M)[$a].toLowerCase()}catch(ob){return""}}Wvj(M){const $a=
this.aEd(M,"AudienceGroup"),ob=this.aEd(M,"SessionOrigin");try{const Tb=parseInt(this.aEd(M,"Ring"),10);if("automation"!==$a&&"bluechicken"!==ob&&-2<=Tb)return!0}catch(Tb){if("automation"!==$a&&"bluechicken"!==ob)return!0}return!1}get Xh(){if(!this.$m){const M={},$a=!(this.$.Cd&1),ob=hb.a.current.WN,Tb=this.$.workbookContext,Dc=W.a.vL+W.a.w3b;M.pageBaseUrl=ob.LayoutsContentUrlPrefix;M.appName=OSF.AppName.ExcelWebApp;M.appVersion="16";M.appSettings=this.HQh();M.singleSignOnSettings=J.AppsForOfficeSingleSignOnManager.iYh();
M.clientMode=$a?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;M.appUILocale=this.$.ya.UICultureTag;M.dataLocale=this.$.ya.DataCultureTag;M.docUrl=Tb.ClientUrl;M.hostControl=this;M.formFactor=OSF.FormFactor.Default;M.lcid=this.$.xG.toString();M.localizedScriptsUrl=W.a.vL+W.a.q2c;M.localizedImagesUrl=Dc;M.localizedStylesUrl=W.a.vL+W.a.dCe;M.localizedResourcesUrl=Dc;M.osfOmexBaseUrl=ob.OsfOmexBaseUrl;M.firstPartyManifestCDNUrl=ob.FirstPartyAddInManifestCDN;M.sdxAssetsToPrefetchMapping=r.AFrameworkApplication.fa.Xa("SdxAssetsToPrefetchMapping");
M.sdxCdnUrl=ob.SdxCdnUrl;M.sdxDmsUrl=ob.SdxDmsUrl;M.devCatalogUrl=ob.DevCatalogUrl;M.controlStatusChanged=this.voc;M.notifyHost=this.dCd;M.allowExternalMarketplace=this.$.ea.Wg.get(27)&&Xc.h4b;M.enableAddinCommands=gb.EwaSettings.ma(53);M.enableBlackForestRedirect=gb.EwaSettings.ma(88);M.enableMyOrg=this.$.ea.Wg.get(33);M.enableMyApps=this.$.ea.Wg.get(34);M.enableDevCatalog=gb.EwaSettings.ma(44);M.enablePrivateCatalog=this.Owj();M.enableTaskpaneUpgradeToAppCommand=gb.EwaSettings.ma(93);M.showSignOutFromPrivateCatalogMessage=
this.$.ea.Wg.get(36);M.enableUploadFileDevCatalog=gb.EwaSettings.ma(53)&&!gb.EwaSettings.ma(282);M.userNameHashCode=X.a.Zv(r.AFrameworkApplication.userName);M.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();M.enableSingleSignOnForAddin=!gb.EwaSettings.ma(23)&&r.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;M.enableDisplayBlockedMinorError=gb.EwaSettings.ma(183);M.hideAppsExtensionUrl=r.AFrameworkApplication.hideAppsExtensionUrl;M.enableAnonymousUseLegacyCatalogService=
gb.EwaSettings.ma(173);M.enableInsertDialogAccessibilityFix=gb.EwaSettings.ma(180);M.disableAppsForOfficeThirdParty=gb.EwaSettings.ma(186);M.enableFirstPartySSO=gb.EwaSettings.ma(198);M.wacSessionId=this.$.ya.UserSessionId;M.disableLogging=!this.$.ya.AriaLoggingIsEnabled;M.enableFirstPartySDXErrorMessages=gb.EwaSettings.ma(211);M.enableRichApiCellEditDelay=gb.EwaSettings.ma(190);M.isHostDocumentDomain=gb.EwaSettings.ma(226);M.loggableUserId=r.AFrameworkApplication.fa.Xa("LoggableUserId");M.sessionStartInfoJson=
r.AFrameworkApplication.fa.Xa("SessionStartInfoJson");M.wopiHostOriginFromPostMessage=r.AFrameworkApplication.wopiHostOriginFromPostMessage;M.wopiHostOriginFromWacPropBag=r.AFrameworkApplication.fa.Xa("PostMessageOrigin");M.wacIsEmbedded=r.AFrameworkApplication.fa.qa("IsEmbedded");M.accessibilityAllowFocusAddinTaskpane=r.AFrameworkApplication.fa.qa("AccessibilityAllowFocusAddinTaskpane");M.enableRemoveAppCommandsAddin=r.AFrameworkApplication.fa.qa("RemoveAppCommandsAddinIsEnabled");M.isHostFrameTrustCheckEnabledForAddIns=
r.AFrameworkApplication.fa.qa("HostFrameTrustCheckIsEnabledForAddIns");M.isHostFrameTrusted=r.AFrameworkApplication.isHostFrameTrusted;M.agaveAddinUploadEnabled=gb.EwaSettings.ma(46);M.hostAllowedOfficeStore=r.AFrameworkApplication.fa.qa("HostAllowedOfficeStore");M.hostAllowedSdxEmbedding=r.AFrameworkApplication.fa.qa("HostAllowedSdxEmbedding");M.hostInstallAddIns=r.AFrameworkApplication.fa.Xa("HostInstallAddIns");M.hostInstallAddInsIsEnabled=r.AFrameworkApplication.fa.qa("HostInstallAddInsIsEnabled");
M.approvedAddIns=r.AFrameworkApplication.fa.Xa("ApprovedAddIns");M.addinEnforceHttpsIsEnabled=this.Wvj(M.sessionStartInfoJson);M.hostFeatureGateFlag=0;M.isUpnCheckEnabled=r.AFrameworkApplication.fa.qa("IsUpnCheckEnabled");M.wacUpn=r.AFrameworkApplication.fa.Xa("UserPrincipalName");M.isReactRibbonEnabled=Xb.a.isReactRibbonEnabled();M.enableSetFocusOnTaskpaneOnUserAction=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);M.isSafariWithIndexedDBDisabled=
gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.eNa;M.isIndexedDBDisabled=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&y.a.eNa||gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&y.a.Uf;M.enableCustomShortcuts=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");M.changeGetModifierKeyStringOutputOrder=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");
M.officeJsUrl=r.AFrameworkApplication.lL("OfficeJs/excel.js",5);M.enableOfficeJsUrlParam=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableOfficeJsUrlParam",!1);this.$m=new OSF.ContextActivationManager(M);this.$m.setIframeAttributeBag({["frameborder"]:0,["marginheight"]:0,["marginwidth"]:0});this.$m.setWSA(r.AFrameworkApplication.Ln);this.$m&&"undefined"!==typeof this.$m.hostCheckReadyHandler&&r.AFrameworkApplication.NGg(Object(e.a)(this.$m,this.$m.hostCheckReadyHandler,"hostCheckReadyHandler"));
try{const ad=da.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.$m.setOAuthManager(ad)}catch(ad){}}return this.$m}get nXj(){return this.sTc}get jj(){return this.xge}get ena(){return this.uge}get aNd(){return this.yge}get $Md(){return this.wge}get xij(){return this.Bge}get vij(){return this.vge}get wij(){return this.zge}get yij(){return this.Cge}get zij(){return this.Dge}get bNd(){return this.Ege}get eV(){return this.Zrg}get $(){return this.jb}V0b(M){const $a={};$a.Name=M.Name;$a.BindingType=
M.BindingType;$a.HasHeaders=M.HasHeaders;M.IsValidRef&&($a.ColCount=M.Reference.LastColumn-M.Reference.FirstColumn+1,$a.RowCount=M.Reference.LastRow-M.Reference.FirstRow+1);return $a}Qri(M,$a){this.$m.launchInsertDialog(M,null,this.KRg($a))}Xca(M,$a){if(r.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6458904_QueryEntitledAppsForStoreType"))this.ALf(M,$a,OSF.StoreTypeEnum.MarketPlace);else{const ob={};ob.callbackFunc=M;ob.storeType=OSF.StoreTypeEnum.MarketPlace;ob.fromInsertDialog=!1;ob.refresh=
$a;this.$m.queryEntitlementDetails(ob)}}ALf(M,$a,ob){const Tb={};Tb.callbackFunc=M;Tb.storeType=ob;Tb.fromInsertDialog=!1;Tb.refresh=$a;this.$m.queryEntitlementDetails(Tb)}invokeDdaMethod(M,$a){const ob=this.pn(M.DdaMethod.ControlId);ob?ob.invokeDdaMethod(M,$a):this.uf(ca.a.internalError,$a)}registerDdaEventAsync(M,$a,ob,Tb,Dc){($a=this.pn($a))?Xc.yzb(M)?$a.$7i(M,ob,Tb,Dc):this.uf(ca.a.tDd,Dc):this.uf(ca.a.internalError,Dc)}unregisterDdaEventAsync(M,$a,ob,Tb,Dc){($a=this.pn($a))?Xc.yzb(M)?$a.mPj(M,
ob,Tb,Dc):this.uf(ca.a.tDd,Dc):this.uf(ca.a.internalError,Dc)}dispose(){this.disposed||(this.$.Hl(this.dd),this.ea.Pk(this.Wc),this.ea.GR(this.Lo),this.ea.Sw(this.Vf),this.xWc.detach(this),this.$.userOperationManager.ho(this.rR),this.ypc=this.yf=this.ji=this.xWc=this.jb=null,this.$Ia&&(this.$Ia.dispose(),this.$Ia=null),ta.a.Ia(this.aNd),ta.a.Ia(this.$Md),this.L1a&&(this.L1a.dispose(),this.L1a=null),super.dispose(),this.disposed=!0,d.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))}ped(M){return(M=
this.pn(M))?M.getDefaultIconUrl():null}Fwc(M){if(this.UGe!==M){this.UGe=M;for(let $a=0,ob=this.yf.length;$a<ob;$a++){const Tb=this.yf[$a];M?Tb.cJe(!1):Tb.zlh()}this.aNd.Fwc(M);this.$Md.Fwc(M)}}iNh(M){return(M=this.pn(M))?M.getDefaultDisplayName():null}uf(M,$a,ob=!0){const Tb={};Tb[ba.a.kg]=M;Tb[ba.a.t3]=$a;this.nK(451041795,Tb,ob)}jv(M){const $a={};$a[ba.a.t3]=M;this.nK(1237877382,$a)}nK(M,$a,ob=!0){const Tb=new vb.a(M,0,this.$.Kc,0,null),Dc=$a?$a[ba.a.t3]:null;this.L1a&&va.g(this.$).eb&&ua.v0g(M,
$a)?this.L1a.geh(M,$a):(M=this.$.Ka.Lb(Tb,$a),ob&&Ca.TaskExtensions.Aa(M,ad=>{ud.a(ad)?this.uf(ca.a.internalError,Dc,!1):ad.result||(va.g(this.$).eb?this.uf(ca.a.Lyb,Dc,!1):this.uf(ca.a.internalError,Dc,!1))},this.la,8))}W2g(M){return!!this.Qia($a=>Xc.getSolutionId($a.tl,this.$)===Xc.getSolutionId(M,this.$)&&$a.tl.PrimaryMarketplace.MarketplaceType===M.PrimaryMarketplace.MarketplaceType&&$a.tl.PrimaryMarketplace.MarketplaceRef===M.PrimaryMarketplace.MarketplaceRef&&$a.tl.PrimaryMarketplace.SolutionVersion===
M.PrimaryMarketplace.SolutionVersion)}pn(M){return this.Qia($a=>$a.controlId.startsWith(M))}JBh(M){return this.Qia($a=>$a.Fta===M)}VTe(M){return this.Qia($a=>$a.cU===M&&!!$a.Fta)}mUe(M,$a,ob,Tb){return this.Qia(Dc=>Dc.cU===M&&Dc.tl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===$a.toLowerCase()&&Dc.tl.PrimaryMarketplace.MarketplaceType.toLowerCase()===ob.toLowerCase()&&!!Dc.tl.SharedRuntime&&!!Dc.tl.SharedRuntime.Resid&&!!Tb&&!!Tb.Resid&&Dc.tl.SharedRuntime.Resid.toLowerCase()===Tb.Resid.toLowerCase())}oNg(M,
$a){if(M=this.pn(M))M.ka($a),M.showHide(!0)}pAj(M){(M=this.pn(M))&&M.showHide(!1)}aIa(M){var $a;if(1!==M.WebExtensionType||this.$.Cd&8388608&&M.TaskpaneVisible||this.$.Cd&8388608&&!M.TaskpaneVisible&&db.HelperMethods.tw(M)){let ob=null;db.HelperMethods.tw(M)&&(ob=Xc.gva(M,this.$),M.TaskpaneWidth||(M.TaskpaneWidth=this.l6b));const Tb=(new yb(this,this.ji,M)).Uld();d.ULS.sendTraceTag(51263011,0,50,`DdaFacade::CreateOsfControl: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(M.PrimaryMarketplace.SolutionId,
M.PrimaryMarketplace.MarketplaceType,null===($a=M.AssetMarketplace)||void 0===$a?void 0:$a.SolutionId,null,null,M.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${M.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${db.HelperMethods.tw(M)}`);ob&&(Tb.Fta=ob);this.yf.push(Tb);this.Gxa=null;this.m6a(M.InstanceId)||(M=String.format("{0}|{1}|{2}|{3}|{4}",M.PrimaryMarketplace.SolutionId,M.PrimaryMarketplace.SolutionVersion,M.PrimaryMarketplace.MarketplaceRef,M.PrimaryMarketplace.MarketplaceType,M.WebExtensionType),
this.raiseEvent("ci",M))}}WBj(M,$a){M.TaskpaneWidth=this.l6b;M.TaskpaneVisible=!0;const ob={};ob.SolutionId=M.PrimaryMarketplace.SolutionId;ob.TargetType=M.WebExtensionType;ob.Version=M.PrimaryMarketplace.SolutionVersion;ob.StoreType=M.PrimaryMarketplace.MarketplaceType;ob.StoreId=M.PrimaryMarketplace.MarketplaceRef;ob.AssetId=M.PrimaryMarketplace.SolutionId;ob.AssetStoreId=M.PrimaryMarketplace.MarketplaceRef;ob.Width=M.TaskpaneWidth;const Tb=new yb(this,this.ji,M,!0);Tb.Uld();this.yf.push(Tb);const Dc=
()=>{this.RQa(Tb.controlId);this.Xh.purgeOsfControl(Tb.controlId,!1);$a()};let ad=null;ad=Vb.a.instance.WE(()=>{Tb.qy&&(ta.a.Ia(ad),ad=null,this.Xh.insertBlankControlWithErrorUX(this.aHb(Tb,ob),Dc))},100,Uc.a.Ych)}R6g(M){if(M&&M.length){var $a=[];M.forEach(ob=>{if(ob.ContainsCustomFunctions){const Tb=Xc.gva(ob,this.$);this.yEd.contains(Tb)||(this.yEd.add(Tb),this.gIf.push(ob));this.W2g(ob)||$a.push(ob)}});$a.length&&this.$De($a)}}aGe(M,$a){this.pn(M.InstanceId)||($a=$a(),M=(new yb(this,this.ji,M)).zaf($a),
this.yf.push(M),this.Gxa=null)}Jzj(M){Xc.E1a.lb(M)&&Xc.E1a.na(M).initializeAndShowWithTitle()}G6h(M){Xc.E1a.lb(M)&&Xc.E1a.na(M).hide()}WTh(M){var $a=null;let ob,Tb,Dc=null;ob=Xc.fid(M,!0);if(!ob)return d.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Qa.Task.Ta(null);(Tb=this.$m.getOsfControl(Xc.getSolutionId(ob,this.$)))&&($a=Tb.getManifest())&&(Dc=$a.getSharedRuntimeForCustomFunctions("Workbook"));if($a=Dc&&1===Dc.LifeTime?this.mUe(ob.PrimaryMarketplace.SolutionId,
ob.PrimaryMarketplace.MarketplaceRef,ob.PrimaryMarketplace.MarketplaceType,Dc):this.JBh(M))return Qa.Task.Ta($a.controlId);const ad=new Na.a;db.HelperMethods.Nic(Dc)&&(ob.SharedRuntime=Dc);M=Tb?Tb.getNotificationParams():[];if(!M.length)return this.DEe(ob);this.k4f(M,()=>{Ca.TaskExtensions.Aa(ad.task,()=>{this.DEe(ob)},this.la,3)},()=>{});return ad.task}jIh(M){M=Xc.fid(M,!1);if(!M)return d.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;let $a=null;
var ob=this.$m.getOsfControl(Xc.getSolutionId(M,this.$));ob&&(ob=ob.getManifest())&&($a=ob.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return db.HelperMethods.Nic($a)&&(M=this.mUe(M.PrimaryMarketplace.SolutionId,M.PrimaryMarketplace.MarketplaceRef,M.PrimaryMarketplace.MarketplaceType,$a))?M.controlId:null}m5g(M,$a){var ob=Xc.fid(M,!1);if(ob){var Tb=null,Dc=this.$m.getOsfControl(Xc.getSolutionId(ob,this.$));Dc&&(Dc=Dc.getManifest())&&(Tb=Dc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
if(db.HelperMethods.Nic(Tb)){ob.SharedRuntime=Tb;var ad=ob.PrimaryMarketplace.SolutionId;Dc=ob.PrimaryMarketplace.SolutionVersion;var ld=OSF.OsfManifestManager.getCachedManifest(ad,Dc);if(ld)if(this.p_b.lb(M))Tb=this.p_b.na(M),Ca.TaskExtensions.Aa(Tb,Nc=>{(Nc=Nc.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Nc,$a,this.ji.QKb)},this.la,3);else{var md={};md.solutionId=ad;md.version=Dc;md.storeType=ob.PrimaryMarketplace.MarketplaceType;md.storeId=ob.PrimaryMarketplace.MarketplaceRef;
md.assetId=ad;md.assetStoreId=null;md.targetType=OSF.OsfControlTarget.TaskPane;var Wb=new Na.a;ob=Ca.TaskExtensions.ak();ob=new ea.a(this.$,this,md,ob);Tb=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(ad,Tb.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(ld,Tb,Dc);ob.createUILessSandbox(md,ld,(Nc,gd)=>{Nc&&!gd?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Nc,$a,this.ji.QKb),Wb.setResult(Nc)):Wb.setResult(null);this.p_b.remove(M)});this.p_b.ia(M,
Wb.task)}}}else d.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")}Zye(M){(M=this.VTe(M))&&(M.tl.SharedRuntime||this.BIb(M.controlId))}BIb(M){(M=this.VTe(M))&&this.RQa(M.controlId)}eih(M,$a){if(!this.yf||!M||!$a)return!1;if(M.toLowerCase()===$a.toLowerCase())return!0;let ob=null,Tb=null;for(let Dc=0,ad=this.yf.length;Dc<ad;Dc++){const ld=this.yf[Dc];if(ld.ownerAddinSolutionId&&(ld.controlId===M&&(ob=ld.ownerAddinSolutionId.toLowerCase()),ld.controlId===
$a&&(Tb=ld.ownerAddinSolutionId.toLowerCase()),ob&&Tb))break}return ob&&ob===Tb?!0:!1}sDg(M){this.pn(M.InstanceId)||(M=new yb(this,this.ji,M),this.yf.push(M),this.Gxa=null)}LQf(M){if(this.yf&&0<=M&&M<this.yf.length){const $a=this.yf[M],ob=$a.qy;this.yf.splice(M,1);this.zxf($a);Va.DOMElementExtensions.sf(ob)}}RQa(M){if(this.yf)for(let $a=0,ob=this.yf.length;$a<ob;$a++)if(this.yf[$a].controlId===M){this.LQf($a);break}}caj(M){if(this.yf){M=M.toLowerCase();for(let $a=0,ob=this.yf.length;$a<ob;$a++)if(M===
this.yf[$a].ownerAddinSolutionId.toLowerCase()){this.LQf($a);break}}}TNg(M){M.tn&&(this.pn(M.floatingObject.tl.InstanceId)||(this.Efc(M.floatingObject.tl.InstanceId)||this.ypc.push(M.floatingObject.tl.InstanceId),this.aIa(M.floatingObject.tl)),this.ea.isNamedObjectViewMode&&this.oNg(M.floatingObject.tl.InstanceId,M.Fd))}saa(M){if(this.yf)for(let $a=0,ob=this.yf.length;$a<ob;$a++)if(1===this.yf[$a].controlType&&le.a.equals(this.yf[$a].cU,M,!0))return this.yf[$a].controlId;return null}kBh(M){const $a=
[];if(this.yf)for(let ob=0,Tb=this.yf.length;ob<Tb;ob++)le.a.equals(this.yf[ob].cU,M,!0)&&$a.push(this.yf[ob].controlId);return $a}QBh(M,$a){if(!$a||!M)return null;if(this.yf)for(let ob=0,Tb=this.yf.length;ob<Tb;ob++)if(1===this.yf[ob].controlType&&le.a.equals(this.yf[ob].cU,M,!0)&&this.yf[ob].tl.SharedRuntime&&le.a.equals(this.yf[ob].tl.SharedRuntime.Resid,$a.Resid,!0))return this.yf[ob].controlId;return null}M3a(M,$a=null){return M?$a?`${M}.${$a}`:M:""}bze(M,$a,ob){if(this.Gxa===M)return!0;this.Gxa=
M;let Tb=null,Dc=!1;if(!Tb&&this.yf)for(let ad=0,ld=this.yf.length;ad<ld;ad++)if(1===this.yf[ad].controlType&&le.a.equals(this.yf[ad].cU,M,!0)){let md=!1,Wb=!1;$a?(md=!0,Wb=!!this.yf[ad].tl.SharedRuntime&&le.a.equals(this.yf[ad].tl.SharedRuntime.Resid,$a.Resid,!0)):ob&&(md=!0,Wb=le.a.equals(this.yf[ad].tl.SharedRuntimeId,ob,!0));if(!md||Wb){Wb&&this.yf[ad].qg(!0);Tb=this.yf[ad].controlId;Dc=!0;this.Gxa=null;break}}Tb&&this.raiseEvent("ca",Tb);return Dc}setAppRuntimeState(M,$a){var ob;if(M){const Tb=
this.pn(M);if(Tb&&db.HelperMethods.tw(Tb.tl))Tb.qg($a),$a&&(this.raiseEvent("ca",M),(null===(ob=Tb.qy)||void 0===ob?0:ob.firstChild)&&(M=Tb.qy.firstChild.title)&&0<M.length&&this.m0b.gnj(M));else throw d.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Le.a.instance.ga(2246));}else throw d.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Le.a.instance.ga(2247));}getAppRuntimeState(M){if(M)if((M=
this.pn(M))&&db.HelperMethods.tw(M.tl))M=M.tl.TaskpaneVisible;else throw d.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Le.a.instance.ga(2246));else throw d.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Le.a.instance.ga(2247));return M}i3a(M,$a){return(M=this.pn(M))?M.i3a($a):null}m6a(M){return this.dze(this.ypc,M)}Efc(M){return this.dze(this.PGe,M)}xme(M){this.PGe.push(M)}XY(M){return(M=
this.pn(M))?M.tl:null}rzd(M){this.raiseEvent("ekros",M,this)}XCd(M){if(M){var $a=this.pn(M.InstanceId);$a&&(M.SharedRuntime||M.SharedRuntimeId||(this.RQa($a.controlId),this.Xh.purgeOsfControl($a.controlId,!1)),$a={},$a.SolutionId=M.PrimaryMarketplace.SolutionId,$a.TargetType=M.WebExtensionType,$a.Version=M.PrimaryMarketplace.SolutionVersion,$a.StoreType=M.PrimaryMarketplace.MarketplaceType,$a.StoreId=M.PrimaryMarketplace.MarketplaceRef,$a.AssetId=M.PrimaryMarketplace.SolutionId,$a.AssetStoreId=M.PrimaryMarketplace.MarketplaceRef,
$a.Width=M.TaskpaneWidth,$a.SharedRuntimeId=M.SharedRuntimeId,this.jbg($a))}}zia(){this.ji.zia()}NM(M,$a,ob){this.ji.NM(M,$a,ob)}wUe(M,$a){$a=Xc.z$g($a);M=this.XY(M);this.ji.c$b(M.InstanceId,2202,Ia.a.wW,$a)}obd(M){for(let $a=0,ob=this.yf.length;$a<ob;$a++)this.wUe(this.yf[$a].controlId,M)}aCh(M,$a){$a=Xc.S5g($a);this.ji.c$b(M,65539,"",$a)}cCh(M,$a,ob){this.ji.c$b(M,1,$a,ob)}$Bh(M,$a){this.ji.dCh(M,$a)}j5g(M,$a){return[[2,1E3,"",JSON.stringify([M,$a]),0,!1]]}ifi(){return!!this.ena&&this.ena.J7e()}YYg(){this.ena&&
this.ena.clear()}bCh(){if(this.ena&&this.ena.J7e()){var M=this.ena.lIh();for(const $a of M){M=this.kBh($a);for(const ob of M)this.ji.c$b(ob,65540,"","{}")}}}S7i(M){this.ena.add(M)}jPj(M){this.ena.remove(M)}Qia(M){if(!this.yf)return null;for(const $a of this.yf)if(M($a))return $a;return null}DEe(M){const $a=new Na.a,ob=Xc.gva(M,this.$);if(db.HelperMethods.tw(M))d.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.dIf(M,Tb=>{Tb?(M.InstanceId=Tb.InstanceId,M.WebExtensionOsfControlType=
3,M.TaskpaneVisible=!1,this.aIa(M),$a.setResult(M.InstanceId)):(d.ULS.sendTraceTag(537170530,0,10,`InsertAgaveTaskPane for customfunction: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(M.PrimaryMarketplace.SolutionId,M.PrimaryMarketplace.MarketplaceType,null,null,null,M.PrimaryMarketplace.MarketplaceRef)} failed`),$a.setException(Error.create("Null insert data")))});else{Xc.E1a.ia(M.InstanceId,new H.a);const Tb=Xc.E1a.na(M.InstanceId).Tta;this.Q6g(M,Tb,ob);this.dIf(M,null);$a.setResult(M.InstanceId)}return $a.task}Q6g(M,
$a,ob){this.pn(M.InstanceId)||(M=new yb(this,this.ji,M),M.Fta=ob,M.zaf($a),this.yf.push(M),this.Gxa=null)}dIf(M,$a){const ob=Xc.gva(M,this.$);if(!this.yEd.contains(ob))this.AGb.push(M),1<=this.AGb.length&&this.eIf(M,$a);else if($a)for(const Tb of this.gIf)if(Xc.gva(Tb,this.$)===ob){$a(Tb,0);break}}eIf(M,$a){let ob=null;const Tb={};Tb.SolutionId=Xc.getSolutionId(M,this.$);Tb.TargetType=M.WebExtensionType;Tb.Version=M.PrimaryMarketplace.SolutionVersion;Tb.StoreType=M.PrimaryMarketplace.MarketplaceType;
Tb.StoreId=M.PrimaryMarketplace.MarketplaceRef;Tb.AssetId=M.PrimaryMarketplace.SolutionId;Tb.AssetStoreId=M.PrimaryMarketplace.MarketplaceRef;Tb.Width=M.TaskpaneWidth;Tb.ContainsCustomFunctions=!0;db.HelperMethods.tw(M)&&(Tb.SharedRuntimeId=M.SharedRuntime.Resid);const Dc=this.$.pa.va;M=this.$.pa.va.Tb();const ad=Dc.Na(9,M);ad.sharedInfo=Tb;const ld=Wb=>{Wb=xd.a.ff(Wb.data);d.ULS.sendTraceTag(537170528,0,10,`DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: ${Wd.a.xc(Wb)}`)},
md=Wb=>{Wb&&!Hd.a(Wb)||d.ULS.sendTraceTag(537170527,0,10,`InsertAgaveTaskPane for addin ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Tb.SolutionId,Tb.StoreType,Tb.AssetId,null,null,Tb.StoreId)} finish with errors: ${Wd.a.xc(Wb.Errors)}`);this.AGb.shift();0<this.AGb.length&&this.eIf(this.AGb[0],$a)};if($a){const Wb=Nc=>{const gd=Nc.Result;(ob=gd?gd.AgaveData:null)||$a(null,Nc.Errors?Nc.Errors[0].ErrorCause:5001);$a(ob,0)};M=(Nc,gd,Gd)=>pd.g(Dc,"InsertAgaveTaskpane",ad,Md.b(Nc,md,Wb),Md.a(gd,ld),
Gd,null,0)}else M=(Wb,Nc,gd)=>pd.g(Dc,"InsertAgaveTaskpane",ad,Md.b(Wb,md),Md.a(Nc,ld),gd,null,0);gb.EwaSettings.$b()?zc.a(this.$.userOperationManager,M,Wb=>new yc.a(519,0,Wb,64),null):zc.a(this.$.userOperationManager,M,Wb=>new $b.a(519,0,Wb),null)}Owj(){return this.$.pe.get(35)}UJd(M){M=this.pn(M);(null===M||void 0===M?0:M.yda)&&M.VQf()}mEi(M){var $a=this.Qia(ob=>Xc.wMa(ob.cU));$a&&($a=this.Xh.getOsfControl($a.controlId))&&$a.notifyAgave(OSF.AgaveHostAction.SendMessage,M)}Xfi(){return!!this.Qia(M=>
1===M.controlType&&Xc.wMa(M.cU))}Wfi(){const M=this.Qia($a=>Xc.wMa($a.cU));return M?M.qy?Va.DOMElementExtensions.isVisible(M.qy):!1:!1}wqj(){const M=this.Qia($a=>Xc.wMa($a.cU));M&&(M.qg(!0),this.raiseEvent("ca",M.controlId))}initialize(){const {DdaEventDispatch:M}=a(1356),$a=void 0===this.$||null===this.$||gb.EwaSettings.ma(259);void 0!==this.$&&null!==this.$||d.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");$a&&d.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+
this.initialized);this.initialized||(Ub.DGa(this.$),this.ea=this.$.ea,this.ji=new M(this.$),this.$.kl(this.dd),this.ea.rk(this.Wc),this.ea.jM(this.Lo),this.ea.Vu(this.Vf),this.$.userOperationManager.nr(this.rR),this.qmf(),this.pOi(),this.hai(),this.$.da.Ga(35,this),this.xWc.ka(this),$a&&d.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.xge=new Ia.a,$a&&d.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Bge=new eb(this.$,
this.jj,this.ji),new fb(this.$,this.jj,this.ji),this.yge=new ha(this.$,this.jj,this.ji),this.wge=new pb(this.$,this.jj,this.ji),this.vge=new Nb(this.$,this.jj,this.ji),this.zge=new bb(this.$,this.jj,this.ji),this.Cge=new ec(this.$,this.jj,this.ji),this.Dge=new lb(this.$,this.jj,this.ji),this.$.QZ&&(this.Ege=new wb(this.$,this.jj,this.ji)),gb.EwaSettings.ma(190)&&(this.L1a=new ua(this,va.g(this.$))),gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.uge=new Ma),this.initialized=!0,d.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))}WBh(M){if(!this.mCa)return null;for(let $a=0,ob=this.mCa.length;$a<ob;$a++)if(M.startsWith(this.mCa[$a].WebExtensionId))return this.mCa[$a];return null}qmf(){var M,$a=this.ea;if($a.fc&&!this.sQb){if($a.workbookContext){if(this.sTc=this.$.ea.Wg.get(22),null===(M=$a.workbookContext.WebExtensions)||void 0===M?0:M.length){M=$a.workbookContext.WebExtensions;$a=!1;for(let ob=M.length-1;0<=ob;ob--){if(!this.ea.isNamedObjectViewMode){this.ypc.push(M[ob].InstanceId);
if(1!==M[ob].WebExtensionType){M.splice(ob,1);continue}if(db.HelperMethods.tw(M[ob])&&0!==M[ob].SharedRuntime.State)1===M[ob].SharedRuntime.State?M[ob].TaskpaneVisible=!1:2===M[ob].SharedRuntime.State?M[ob].TaskpaneVisible=!0:d.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!M[ob].ContainsCustomFunctions&&!M[ob].TaskpaneVisible&&!ra.a(M[ob])){M.splice(ob,1);continue}}const Tb=OSF.OsfControl.isFirstPartyStoreString(M[ob].PrimaryMarketplace.MarketplaceType);if(gb.EwaSettings.ma(186)&&
!Tb&&(M.splice(ob,1),!$a)){$a=!0;const Dc=Pb.GetServiceTaskFactory.Sa(this.$.da,5,4,3);Ca.TaskExtensions.Aa(Dc,()=>{Dc.result.Zf(36,null)},this.la,3)}gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&M[ob].PrimaryMarketplace&&Xc.wMa(M[ob].PrimaryMarketplace.SolutionId)&&(d.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),M.splice(ob,1))}this.$De(M)}}else this.sTc=!1;this.sQb=!0}}c6e(M){const $a=va.g(this.$),
ob=$a.ha.Qa.dc;if(ob&&M){M=!1;if(this.yf)for(const Tb of this.yf)if(Xc.wMa(Tb.cU)||Xc.Yii(Tb.cU)){M=!0;break}M||$a.ha.Qa.lH(ob)}}pOi(){this.Xh&&this.ea.isNamedObjectViewMode&&this.$.oa&&Cc.o(this.$.oa)&&(this.$.da.za(34).OQ?this.$.da.za(34).hmd():this.$.da.za(34).Uu(this.kUi))}$De(M){let $a=null;$a=ob=>{const Tb=ob.WebExtensionData,Dc=ob.IsTaskPane,ad=ob.RecordHandler,ld=()=>{this.OPa.shift();0<this.OPa.length&&$a(this.OPa[0])};if(this.saa(Tb.PrimaryMarketplace.SolutionId))ld();else{Dc&&(Tb.WebExtensionOsfControlType=
1);var md=ra.a(Tb);if(!Dc||Tb.TaskpaneVisible||md||Tb.SharedRuntime&&0!==Tb.SharedRuntime.State||Tb.ContainsCustomFunctions){var Wb=new yb(this,this.ji,Tb,!Dc);d.ULS.sendTraceTag(537170517,0,50,`DdaFacade::CreateAllOsfControls: SolutionId: ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Tb.PrimaryMarketplace.SolutionId,Tb.PrimaryMarketplace.MarketplaceType,null,null,null,Tb.PrimaryMarketplace.MarketplaceRef)}, StoreType: ${Tb.PrimaryMarketplace.MarketplaceType}, UseShareRuntime: ${db.HelperMethods.tw(Tb)}`);
Wb.Uld();db.HelperMethods.tw(Tb)&&(Wb.Fta=Xc.gva(Tb,this.$),Tb.TaskpaneWidth=this.l6b);md&&(Tb.WebExtensionToolTip="");Dc&&Tb.TaskpaneVisible&&!md&&(Tb.TaskpaneWidth=this.l6b);this.yf.push(Wb);var Nc=this.Gxa=null;Nc=Vb.a.instance.WE(()=>{Wb.qy&&(ta.a.Ia(Nc),Nc=null,ad&&ad(ob,Wb),ld())},100,Uc.a.Xch)}else ld()}};for(let ob=0;ob<M.length;ob++)if(!this.pn(M[ob].InstanceId))if(1!==M[ob].WebExtensionType)this.aIa(M[ob]);else if(!gb.EwaSettings.ma(53))this.Emb(M[ob],$a);else if(this.$.Cd&8388608||M[ob].TaskpaneVisible){const Tb=
{};Tb.marketplaceId=M[ob].PrimaryMarketplace.SolutionId;Tb.marketplaceVersion=M[ob].PrimaryMarketplace.SolutionVersion;Tb.storeType=M[ob].PrimaryMarketplace.MarketplaceType;Tb.storeId=M[ob].PrimaryMarketplace.MarketplaceRef;Tb.targetData=M[ob];this.Xh.isAddinCommandsAsync(Tb,(Dc,ad,ld)=>{if(Dc){var md=ld.targetData;if(ad){if(gb.EwaSettings.ma(87))if(Tb.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())Dc=Tb.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),ad=Tb.storeType.toLowerCase()===
OSF.StoreType.PrivateCatalog.toLowerCase(),(Dc||ad)&&db.HelperMethods.tw(md)&&this.Emb(md,$a);else if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))this.I3h(ld,$a);else{let Wb=!1;this.Xca(Nc=>{if(!Nc.errorCode){if(Nc.value)for(const gd of Nc.value){if(Wb)break;Wb=Yb.e(gd[1])===Yb.e(md.PrimaryMarketplace.SolutionId)}Wb?db.HelperMethods.tw(md)&&this.Emb(md,$a):(Nc={},Nc.SolutionId=ld.marketplaceId,Nc.TargetType=md.WebExtensionType,Nc.Version=ld.marketplaceVersion,
Nc.StoreType=md.PrimaryMarketplace.MarketplaceType,Nc.StoreId=ld.storeId,Nc.AssetId=ld.marketplaceId,Nc.AssetStoreId=ld.storeId,Nc.Width=md.TaskpaneWidth,md.TaskpaneVisible=!0,this.lle(Nc,md,$a))}},!0)}}else this.Emb(md,$a)}else Dc=ld.targetData,d.ULS.sendTraceTag(542185164,220,15,`Judging AddinCommands failed for ${Telemetry.PrivacyRules.GetPrivacyCompliantId(Dc.PrimaryMarketplace.SolutionId,Dc.PrimaryMarketplace.MarketplaceType,null,null,null,Dc.PrimaryMarketplace.MarketplaceRef)} from ${Dc.PrimaryMarketplace.MarketplaceType} during document loading`)})}}I3h(M,
$a){let ob=!1;this.Xca(Tb=>{const Dc=M.targetData;if(!Tb.errorCode){if(Tb.value)for(const ad of Tb.value){if(ob)break;ob=Yb.e(ad[1])===Yb.e(Dc.PrimaryMarketplace.SolutionId)}ob?db.HelperMethods.tw(Dc)&&this.Emb(Dc,$a):(Tb={},Tb.SolutionId=M.marketplaceId,Tb.TargetType=Dc.WebExtensionType,Tb.Version=M.marketplaceVersion,Tb.StoreType=Dc.PrimaryMarketplace.MarketplaceType,Tb.StoreId=M.storeId,Tb.AssetId=M.marketplaceId,Tb.AssetStoreId=M.storeId,Tb.Width=Dc.TaskpaneWidth,Dc.TaskpaneVisible=!0,this.lle(Tb,
Dc,$a))}},!0)}Emb(M,$a){const ob={};ob.WebExtensionData=M;ob.IsTaskPane=!0;this.OPa.push(ob);1===this.OPa.length&&$a(ob)}lle(M,$a,ob){const Tb={};Tb.ActivationInfo=M;Tb.WebExtensionData=$a;Tb.IsTaskPane=!1;Tb.RecordHandler=(Dc,ad)=>{const ld=Dc.ActivationInfo;this.Xh.insertBlankControlWithErrorUX(this.aHb(ad,ld),()=>{this.RQa(ad.controlId);this.Xh.purgeOsfControl(ad.controlId,!1);this.jbg(ld)})};this.OPa.push(Tb);1===this.OPa.length&&ob(Tb)}jbg(M){var $a={};$a.solutionId=M.SolutionId;$a.version=M.Version;
$a.storeType=M.StoreType;$a.storeId=M.StoreId;$a.assetId=M.AssetId;$a.assetStoreId=M.AssetStoreId;$a.targetType=M.TargetType;$a.sharedRuntimeId=M.SharedRuntimeId;M=new Z.a;M.add($a);$a={};$a[Q.a.Inb]=M;$a[Q.a.tP]=3;M=new vb.a(Jc.a.WBb,0,this.$.Kc,0,null);this.$.Ka.Lb(M,$a)}aHb(M,$a){const ob={};ob.div=M.qy;ob.id=M.controlId;ob.solutionId=$a.SolutionId;ob.version=$a.Version;ob.storeId=$a.StoreId;ob.storeType=$a.StoreType;ob.osfControlType=OSF.OsfControlTarget.TaskPane;return ob}GUf(){if(gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){const ob=
[];for(var M=0;M<this.yf.length;M++){var $a=this.yf[M];0!==$a.osfControlType&&3!==$a.osfControlType&&4!==$a.osfControlType||ob.push($a)}M=!1;for($a=0;$a<ob.length;$a++){const Tb=ob[$a];this.RQa(Tb.controlId);!M&&Tb&&Tb.tl&&(M=db.HelperMethods.tw(Tb.tl))}M&&this.nK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:4})}gb.EwaSettings.ma(400)&&Ca.TaskExtensions.Aa(Pb.GetServiceTaskFactory.Sa(this.$.da,278,279,3),ob=>{ob&&(ob=ob.result)&&(this.$.da.za(278)||this.$.da.Ga(278,ob),ob.Hbf().ina())},this.la,
3)}gL(){var M=new Ya(this.$,this.jj,this.IVf);void 0===this.$||null===this.$?d.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):gb.EwaSettings.ma(259)&&d.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.jj||null===this.jj));if(M.cDi()){const $a=()=>{},ob=ad=>{ad=xd.a.ff(ad.data);d.ULS.sendTraceTag(537170511,0,10,`ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: ${Wd.a.xc(ad)}.`)},
Tb=M.GSg();M=(ad,ld,md)=>pd.g(this.$.pa.va,"ExecuteRichApiRequest",this.HSg(Tb),Md.b(ad,$a),Md.a(ld,ob),md,null,0);let Dc=Xc.fgd(Tb);gb.EwaSettings.$b()?(Dc|=64,this.$.userOperationManager.cs(new yc.a(507,0,M,Dc))):this.$.userOperationManager.cs(new $b.a(507,0,M,Dc))}}HSg(M){const $a=this.$.pa.va.Na(1);$a.request=M;return $a}dze(M,$a){if(M)for(let ob=0;ob<M.length;ob++)if(le.a.equals(M[ob],$a,!0))return!0;return!1}KRg(M){const $a={};$a.navigationMode=OSF.OsfNavigationMode.DefaultMode;$a.assetId=null;
$a.category=null;if(!M||3>M.length)return $a;if(M[0]){const ob=parseInt(M[0],10);isNaN(parseInt(ob,10))||($a.navigationMode=ob)}M[1]&&($a.assetId=M[1]);M[2]&&($a.category=M[2]);return $a}hai(){if(gb.EwaSettings.ma(61)){var M=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(M&&"*"!==M.trim()){this.$Ia=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new Ua(this),M,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.pe.get(2));try{this.$Ia.init()}catch($a){try{this.$Ia.dispose()}catch(ob){}this.$Ia=
null;d.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+$a.message)}M={};M.a=this.$.ya.UserSessionId;ve.b().Ne(39,M)}}}k4f(M,$a,ob){const Tb=Xc.XQg(M[0]),Dc=Tb.pha,ad=Tb.lia;Tb.pha=()=>{Dc&&Dc();const ld=Tb.aMa!==OSF.InfoType.Error?$a:null;M.shift();M.length?this.k4f(M,ld,ob):ld&&ld()};Tb.lia=()=>{ad&&ad();ob&&Tb.aMa!==OSF.InfoType.Error&&ob()};R.a.SSd(Tb)}HQh(){const M={};M.AddinRibbonControlsOverriddenByApi=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();
M.AddinActionDefinitionHybridMode=gb.EwaSettings.ma(635).toString();M.UseActionIdForUILessCommand=gb.EwaSettings.ma(638).toString();M.AllowStorageAccessByUserActivationOnIFrame=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();M.RequirementSetRibbonApiOnePointTwo=gb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();M.flightingTreatmentVariables=r.AFrameworkApplication.fa.l$b;
M.ShortcutInfoArrayInUserPreferenceData=gb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return M}static get h4b(){return Xc.t5d}static set h4b(M){Xc.t5d=M}static getSolutionId(M){let $a=M.PrimaryMarketplace.SolutionId;gb.EwaSettings.ma(293)&&M.OwnerAddinSolutionId&&($a=M.OwnerAddinSolutionId);return $a}static fgd(M){let $a=0;gb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?M.RequestFlags&1&&256!==(M.RequestFlags&
256)||($a=16):$a=M.RequestFlags&1?0:16;return $a}static gva(M,$a){$a=Xc.getSolutionId(M,$a);return Xc.nZe($a,M.PrimaryMarketplace.SolutionVersion,M.PrimaryMarketplace.MarketplaceType,M.PrimaryMarketplace.MarketplaceRef)}static z$g(M){return JSON.stringify({["recording"]:M})}static S5g(M){const $a={};$a.visibility=M?"Visible":"Hidden";return JSON.stringify($a)}static OMh(M){let $a=M.getSolutionId(),ob=M.getVersion(),Tb=M.getStoreType();M=M.getStoreId();return Xc.nZe($a,ob,Tb,M)}static nZe(M,$a,ob,
Tb){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",M,$a,Xc.FYh(ob).toString(),Tb)}static fid(M,$a){var ob=M.split("|");if(7>ob.length)return d.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==ob[0])return d.ULS.sendTraceTag(537170508,0,10,`DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='${ob[0]}'.`),null;let Tb=ob[1];const Dc=ob[2],ad=Xc.GYh(ob[3]),ld=ob[4];ob=ob[5];Tb&&Tb.length||(Tb=ob);ob=
{};ob.InstanceId=String.format("{{{0}}}",T.a.create().toString());ob.WebExtensionOsfControlType=4;ob.WebExtensionType=1;ob.PrimaryMarketplace={};ob.PrimaryMarketplace.SolutionId=Tb;ob.PrimaryMarketplace.SolutionVersion=Dc;ob.PrimaryMarketplace.MarketplaceRef=ld;ob.PrimaryMarketplace.MarketplaceType=ad;ob.ContainsCustomFunctions=$a?!0:!1;$a&&(ob.OsfPropertyBag=[["customFunctionAddinId",M]]);return ob}static GYh(M){M=parseInt(M,10);return M===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:M===OSF.StoreTypeEnum.Catalog?
OSF.StoreType.SPCatalog:M===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:M===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:M===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:M===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:M===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:M===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:M===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:M===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:
M===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null}static FYh(M){return M===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:M===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:M===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:M===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:M===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:M===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:M===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:M===OSF.StoreType.HardCodedPreinstall?
OSF.StoreTypeEnum.HardCodedPreinstall:M===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:M===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:M===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1}static Nrb(M){const $a={};$a.Version=M.version;$a.AssetId=M.assetId;$a.AssetStoreId=null!==M.assetStoreId?M.assetStoreId.toString():null;$a.StoreType=M.storeType;$a.Height=M.height;$a.SolutionId=M.solutionId;$a.StoreId=M.storeId;$a.TargetType=M.targetType;$a.Width=
1===$a.TargetType?0:M.width;$a.SharedRuntimeId=M.sharedRuntimeId;return $a}static yzb(M){return M===OSF.DDA.EventDispId.dispidSettingsChangedEvent||M===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||M===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||M===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||M===OSF.DDA.EventDispId.dispidRichApiMessageEvent||M===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||M===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||M===
OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent}static XQg(M){return Object(b.a)(new pc.a,{aMa:M.infoType,id:M.id,title:M.title,description:M.description,buttonText:M.buttonTxt,pha:M.buttonCallback,eec:M.highPriority,lia:M.dismissCallback,errorCode:M.errorCode,G$e:M.iframeNotificationUrl})}static wMa(M){let $a="FA000000014"===M;$a||($a="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===M);return $a}static Yii(M){return"FA000000005"===M}}Xc.E1a=new G.a;Xc.t5d=!0;Object(c.a)(Xc,"DdaFacade",
Ra.a,[204,756,750,757,758,10])},738:function(n,C,a){a.d(C,"a",function(){return d});n=a(0);var c=a(15),b=a(111);class d{constructor(){this.qJd=0;this.jW={};this.hta={}}bUh(f,e){return this.jW[d.mZc(f,e)]}dMe(f,e){e||void 0!==this.hta[f]&&null!==this.hta[f]?e&&void 0!==this.hta[f]&&null!==this.hta[f]&&delete this.hta[f]:this.hta[f]=1}e0b(f){return void 0===this.hta[f]||null===this.hta[f]}M2h(f){const e=d.mZc(f.messageType,f.targetId);1===f.actionType?this.g4h(f.controlId,f.messageType,e):2===f.actionType&&
this.Q4h(f.controlId,f.messageType,e)}F$i(f){if(f){var e=Object.keys(this.jW);if(!(void 0===e||null===e||0>=e.length))for(const k of e)e=this.jW[k],e[f]&&(delete e[f],Object.keys(e).length||delete this.jW[k])}}KZ(f,e){f=d.mZc(f,e);f=this.jW[f];return!!f&&0<Object.keys(f).length}J5h(){return!b.a.isEmpty(this.jW)}Lif(){return 0<this.qJd}xOh(){const f=[],e=this.jW;for(let m in e){var k=m,l=e[m];for(let u in l){l=u;const t={};t.eventType=parseInt(k.split("#")[0],10);t.targetId=k.split("#")[1];t.addinId=
l;f.push(t)}}return f}g4h(f,e,k){if(this.jW[k])k=this.jW[k],k[f]=k[f]?k[f]+1:1;else{let l={};l[f]=1;this.jW[k]=l}100===e&&this.qJd++}Q4h(f,e,k){if(this.jW[k]){const l=this.jW[k];if(f){const m=l[f];1===m?(delete l[f],Object.keys(l).length||delete this.jW[k]):l[f]=m-1;100===e&&this.qJd--}else c.ULS.sendTraceTag(537170459,0,50,`The OsfControl[${f}] doesn't register event with key[${k}].`)}else c.ULS.sendTraceTag(537170460,0,50,`The event with key[${k}] that will be unregistered doesn't exist.`)}static mZc(f,
e){return String.format("{0}#{1}",f,e)}}d.wW="Workbook";Object(n.a)(d,"RichApiEventRegistration",null,[])},766:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b,d,f,e=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=b;this.controlId=d;this.ddaBinding=f;this.ArrayData=e}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}Object(n.a)(c,"DdaEventArgs",null,[])},811:function(n,C,a){n=a(0);class c{constructor(){this.title=
this.id=this.tabs=null}}Object(n.a)(c,"AddInDataTransferObject",null,[]);a.d(C,"a",function(){return b});class b{constructor(d,f,e){this.SQb=d;this.Rlg=f;this.Slg=e}get Vs(){return this.SQb}get NCg(){return this.Rlg}get OCg(){return this.Slg}static J3a(d){return(d=d.JV)?Object.assign(new c,{tabs:d.Vs.toArray(),id:d.NCg,title:d.OCg}):null}}Object(n.a)(b,"OneLineRibbonExtensibility",null,[])},845:function(n,C,a){a.r(C);n=a(0);var c=a(187),b=a(15),d=a(99);class f{constructor(){this.startTime=0;this.callback=
null}}Object(n.a)(f,"SSOCallbackInfo",null,[]);class e{constructor(){this.accessToken=null}}Object(n.a)(e,"AccessTokenInformation",null,[83]);var k=a(965);class l{constructor(){this.token=null;this.expiresOn=0;this.bha=this.authChallenge=null}}Object(n.a)(l,"CachedTokenInfo",null,[]);class m{constructor(){this.vRb=new c.a;this.Q9=this.P9=!1;this.toa=this.authChallenge=null;this.startTime=this.retryCount=0;this.Qpe=null}get callbacks(){return this.vRb}}Object(n.a)(m,"SSORequestInfo",null,[]);class u extends m{constructor(){super();
this.errorCode=0}}Object(n.a)(u,"SSOFailedRequestInfo",m,[]);var t=a(4);class w{constructor(U,X,T,G){this.aT=new c.a;this.LG=new c.a;this.wpa=null;this.elb=new c.a;this.fbe=Promise.resolve(null);this.kie=!1;this.kWb=X;this.Hog=U;this.Pie=T;this.Wlg=G}Mxj(U){if(this.wpa&&this.wpa.authChallenge===U.authChallenge){if(Date.now()/1E3+w.Bzi>this.wpa.expiresOn)return this.wpa=null,!1;U=new k.a;U.token=this.wpa.token;U.expiresOn=this.wpa.expiresOn;U.bha=this.wpa.bha;U.YTa=!0;U.Kwb=0;this.bxb(U);return!0}return!1}twj(U){for(let X=
0;X<this.LG.count;X++)if(this.LG.na(X).authChallenge===U.authChallenge&&this.LG.na(X).toa===U.toa){let T;(T=this.LG.na(X)).retryCount=T.retryCount+1;U.retryCount=this.LG.na(X).retryCount;if(this.LG.na(X).retryCount<w.Zzi||!this.LG.na(X).P9&&U.P9||!this.LG.na(X).Q9&&U.Q9){if(!this.LG.na(X).P9&&U.P9||!this.LG.na(X).Q9&&U.Q9)U.retryCount=0;this.LG.removeAt(X);break}U=new k.a;U.errorCode=this.LG.na(X).errorCode;this.bxb(U);return!0}return!1}HEg(U,X){for(let T=0;T<this.LG.count;T++)if(this.LG.na(T).toa===
U.toa&&this.LG.na(T).authChallenge===U.authChallenge)return;this.LG.add(Object.assign(new u,{P9:U.P9,Q9:U.Q9,authChallenge:U.authChallenge,toa:U.toa,errorCode:X,retryCount:U.retryCount}))}get resource(){return this.kWb}hdd(U,X,T,G,D,J){const {AppsForOfficeSingleSignOnManager:L}=a(845);""===T&&(T=null);if(this.kie)L.H5(J,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var H=null;for(let R of this.aT)if(R.P9===U&&R.Q9===X&&R.authChallenge===T&&R.toa===D){H=R;break}H||(H=Object.assign(new m,
{P9:U,Q9:X,authChallenge:T,Qpe:G,toa:D,retryCount:0,startTime:L.mw()}),this.aT.add(H));H.retryCount=0;H.callbacks.add(J);this.fbe=this.fbe.then(()=>{var {AppsForOfficeSingleSignOnManager:R}=a(845);if(0<this.aT.count){var Q=this.aT.na(0);if(this.Mxj(Q)||this.twj(Q))return null;for(let V=0;V<this.elb.count;)this.elb.na(V)+w.dJj<R.mw()?this.elb.removeAt(V):V++;if(this.elb.count>=w.Vzi||this.aT.count>=w.xzi)return Q=new k.a,Q.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.bxb(Q),
null;let O=null;t.AFrameworkApplication.ta&&(R=t.AFrameworkApplication.ta.ZD)&&(O=R.Bc("ComponentAttach",this.Hog+w.eyg));return Q.toa.FAg(this.resource,Q.P9,Q.Q9,Q.authChallenge,this.Wlg,Q.Qpe).then(V=>{O&&O.stop();this.bxb(V)},()=>{O&&O.stop();const V=new k.a;V.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.bxb(V)})}return null})}}bxb(U){const {AppsForOfficeSingleSignOnManager:X}=a(845);try{if(this.aT.count){var T=this.aT.na(0);this.aT.removeAt(0);var G=null;U.errorCode||(G=
new e,G.accessToken=U.token);U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&U.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.HEg(T,U.errorCode);var D={};null!=U.Kwb&&(D.getTokenSilentTime=U.Kwb.toString());null!=U.Jhd&&(D.getTokenPopupTime=U.Jhd.toString());null!=U.rfd&&(D.getIDTokenTime=U.rfd.toString());null!=
U.YTa&&(D.tokenCached=U.YTa.toString());U.GWd&&(D.detailedError=U.GWd);U.bha&&(D.authLibrary=U.bha);T.retryCount&&(D.retryCount=T.retryCount);for(var J of T.callbacks)X.H5(J,U.errorCode,G,D);null!=U.YTa&&U.YTa||this.elb.add(T.startTime);if(!U.errorCode)for(null!=U.expiresOn&&(this.wpa=Object.assign(new l,{token:U.token,expiresOn:U.expiresOn,authChallenge:T.authChallenge,bha:U.bha})),this.LG.clear(),J=0;J<this.aT.count;)if(this.aT.na(J).authChallenge===T.authChallenge){for(let L of this.aT.na(J).callbacks)X.H5(L,
U.errorCode,G,D);this.aT.removeAt(J)}else J++}}catch(L){b.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",L.message)}}shutdown(){this.kie=!0;this.aT.clear()}}w.dJj=6E4;w.Vzi=6;w.xzi=6;w.Zzi=3;w.Bzi=300;w.eyg="GetAccessToken";Object(n.a)(w,"SSOCallbackManager",null,[]);var r=a(720),v=a(731),y=a(124),x=a(80),B=a(27),z=a(30),A=a(146),I=a(342);a.d(C,"AppsForOfficeSingleSignOnManager",function(){return F});class F{constructor(U,X,T=null){this.TEc=new d.a;const G=new c.a;
X&&G.add(X.cyi);T&&G.addRange(T);this.$m=U;this.fzg=G}idd(U,X,T,G,D,J,L,H,R,Q){Q=Object.assign(new f,{startTime:F.mw(),callback:Q});try{const W=!!T&&""!==T;var O=Q.startTime;const da=this.getOsfControl(U);let ta=da.getStoreType()||"",K=da.getOwnerAddinStoreType()||"",na=da.getSolutionId()||"";const P=da.getVersion()||"";ta=ta.toLowerCase();K=K.toLowerCase();na=na.toLowerCase();var V=x.a.qfd(X)||"";const ka=x.a.qfd(da.getIframeUrl())||"",pa=V.toLowerCase()===ka.toLowerCase();V=ta;"inmemory"===ta&&
(V=K);const Na=Telemetry.PrivacyRules.GetPrivacyCompliantId(na,V,da.getAssetId(),null,null,da.getStoreId()),Z={["callInstanceId"]:O.toString(),["controlAssetId"]:Na,["controlVersion"]:P,["storeType"]:ta,["ownerStoreType"]:K,["allowConsentPrompt"]:G.toString(),["forMSGraphAccess"]:D.toString(),["allowSignInPrompt"]:J.toString(),["hasAddinAuthChallenge"]:W.toString(),["securityOriginEqualsSourceLocation"]:pa.toString(),["singleSignOnEnabled"]:L.toString(),["accountTypeFilter"]:H||""};b.ULS.sendTraceTag(51401115,
344,50,"{0}",Z);A.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:y.a.Sj(Z)}));O=!0;const Ra=t.AFrameworkApplication.fa.Xa("HostAuthType");switch(H){case "aad":O="aad"===Ra;break;case "msa":O="msa"===Ra;break;default:O=!H||"noFilter"===H}if(O){H=null;if(L)for(let Da of this.fzg)if(Da.yhi(na)){H=Da;break}H?this.isSSOAddin(U)?(L=!0,"omex"===V&&(L=!1),"spapp"===V||"spcatalog"===V?(b.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),
F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):D&&!L?(b.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(D&&"exchange"===V&&(G=!1),this.hdd(U,X,T,V,G,J,R,H,Q))):(b.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,
null,null)}else F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(W){this.pkc(),b.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",W.message),F.H5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(U,X,T,G){this.idd(U,T[r.a.fWc]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,X,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,T[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,G)}hdd(U,X,T,G,D,J,L,H,R){this.TEc.lb(U)?G=this.TEc.na(U):(G=new w(U,this.getWebApplicationResource(U).split(",")[0],G,this.getDefaultDisplayName(U)),this.TEc.add(U,G));const Q=G.resource;U=F.DWh(Q,this.getWebApplicationId(U));const O=OfficeExt.WACUtils.getHostSecure(X);
U&&O?U.toLowerCase()===O.toLowerCase()?G.hdd(D,J,T,L,H,R):(F.jOa('SSO Resource "'+Q+'" cannot be used from "'+X+'" origin due to domain mismatch.'),b.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),F.H5(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(U||b.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),O||b.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),F.H5(R,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,
null,null))}pkc(){b.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(U){return this.$m.getOsfControl(U)}isSSOAddin(U){return this.getOsfControl(U).getManifest().isSSOAddin()}getWebApplicationId(U){return this.getOsfControl(U).getManifest().getWebApplicationId()}getWebApplicationResource(U){return this.getOsfControl(U).getManifest().getWebApplicationResource()}getDefaultDisplayName(U){return this.getOsfControl(U).getManifest().getDefaultDisplayName()}static iYh(){try{const U=
{};B.a.zxa&&v.a.Vxb&&(U.UiHostSupportsAuthTokenAddinList=F.FUe);U.UiHostSupportsAuthToken=v.a.Vxb;return U}catch(U){b.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",U.message)}return null}static getInstance(U,X,T=null){F.Ma||(F.Ma=new F(U,T));return F.Ma}static jOa(U){window.console.warn&&window.console.warn(U)}static DWh(U,X){if(!U)return"";X||(X="");let T=U.toLowerCase();var G=X.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(G)||
(F.jOa('SSO App Id "'+X+'" is not a valid format. It will be rejected from store submission.'),b.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));T.endsWith(G)||(F.jOa('SSO Resource "'+U+'" does not end with App Id "'+X+'". It will be rejected from store submission.'),b.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!T.startsWith("https://")&&!T.startsWith("api://"))return F.jOa('SSO Resource "'+U+'" must be https:// or api:// protocol.'),b.ULS.sendTraceTag(590962909,
344,10,"Resource not using https or api protocol."),"";for(X=0;X<U.length;X++){G=U.charAt(X);const D=z.a.charCodeAt(U,X);if(33>D||126<D||"&"===G||"?"===G||"#"===G||"%"===G||"\\"===G)return F.jOa('SSO Resource "'+U+'" contains an invalid character "'+G+'".'),b.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+G+"' in resource URI."),""}if(0<=U.indexOf("::"))return F.jOa('SSO Resource "'+U+'" contains an invalid string "::".'),b.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<
U.length)return F.jOa('SSO Resource "'+U+'" is '+U.length+" characters and exceeds the max length of 120 characters."),b.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+U.length+"."),"";T.startsWith("api://")&&(T="https://"+T.substring(6,T.length));return 8===T.length?"":OfficeExt.WACUtils.getHostSecure(T)||""}static H5(U,X,T,G){var D=U.startTime;let J=0;0<D&&(J=F.mw()-D);D={["callInstanceId"]:D.toString(),["callDuration"]:J.toString(),["errorCode"]:X.toString()};if(G)for(let L in G)D[L]=
G[L];b.ULS.sendTraceTag(51401116,344,50,"{0}",D);A.a.sendTelemetryEvent(Object.assign(new I.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:y.a.Sj(D)}));U.callback(X,T)}static mw(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(U){}return Date.now()}}F.FUe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");F.Ma=null;Object(n.a)(F,
"AppsForOfficeSingleSignOnManager",null,[43])},862:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(14);class b{constructor(){this.bSe={["tabhome"]:"Ribbon.Home",["tabinsert"]:"Ribbon.Insert",["tabdata"]:"Ribbon.Data",["tabreview"]:"Ribbon.Review",["tabview"]:"Ribbon.View"};this.aSe={["tabpagelayoutexcel"]:["Ribbon.PageLayoutExcel",c.a.instance.ga(1635),c.a.instance.ga(1639)],["tabformulas"]:["Ribbon.Formulas",c.a.instance.ga(1636),c.a.instance.ga(1640)],["tabdeveloper"]:["Ribbon.Developer",
c.a.instance.ga(1637),c.a.instance.ga(1641)],["tabaddins"]:["Ribbon.AddIns",c.a.instance.ga(1638),c.a.instance.ga(1642)]};this.d9b=null}get Sha(){return"SourceControlId"}get dN(){return"Workbook"}get formFactor(){return"DesktopFormFactor"}BSh(){if(!this.d9b){this.d9b={};for(const d of Object.keys(this.bSe))this.d9b[d]=this.bSe[d];for(const d of Object.keys(this.aSe))this.d9b[d]=this.aSe[d][0]}}}Object(n.a)(b,"AddinCommandsStringProvider",null,[813])},864:function(n,C,a){a.d(C,"a",function(){return c});
n=a(0);class c{constructor(){this.aMa=0;this.pha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.eec=!1;this.G$e=this.lia=null}}Object(n.a)(c,"AddInCommandsNotificationParameters",null,[])},936:function(n,C,a){n=a(0);var c=a(15),b=a(84),d=a(151),f=a(13),e=a(88);class k extends Sys.UI.Control{constructor(G,D,J,L){super(document.createElement("div"));this.FS=this.DS=this.dx=this.GG=this.NG=this.rpa=this.Vqa=null;this.Qib=this.iqa=!1;this.content=this.Pp=null;this.d1=0;
this.Bue=null;this.HT=0;this.xEf=null;this.kje=G;this.wee=D;this.iP=J;this.HJ=L;this.tg=D.ownerDocument;this.Fdc=this.ut=this.ijb=!1}get MV(){this.Vqa||(this.Vqa=this.tg.createElement("div"),this.Vqa.id=this.ni("WACCalloutOuter"),this.Vqa.className="WACCalloutOuter",this.Vqa.setAttribute(e.a.Kd,e.a.VZa),this.Vqa.style.width=this.d1+"px");return this.Vqa}get Xob(){if(!this.rpa){this.rpa=this.tg.createElement("div");this.rpa.id=this.ni("WACCalloutBeakContainer");this.rpa.className="WACCalloutBeakContainer";
var G="CalloutBeakTopFilled_32x16x32";if(5===this.HT||6===this.HT||4===this.HT)G="CalloutBeakBottomFilled_32x16x32";G=d.createClusteredImage(32,16,G,"WACCalloutBeak",!0,"");this.rpa.appendChild(G)}return this.rpa}set Xob(G){this.rpa=G}get FMa(){return this.ijb}get title(){return this.Pp}set title(G){this.Pp!==G&&(this.Pp=G,this.DS&&(this.DS.innerText=this.Pp))}get ut(){return this.iqa}set ut(G){this.iqa!==G&&(this.iqa=G,this.NG&&(this.NG.contains(this.dx)&&!this.iqa?this.NG.removeChild(this.dx):!this.NG.contains(this.dx)&&
this.iqa&&this.qme()))}get Fdc(){return this.Qib}set Fdc(G){this.Qib!==G&&(this.Qib=G,this.NG&&(this.NG.contains(this.DS)&&!this.Qib?this.NG.removeChild(this.DS):!this.NG.contains(this.DS)&&this.Qib&&this.Jne()))}show(){this.ijb||(this.i7g(),this.so(),this.wee.appendChild(this.MV),this.MV.style.display="Block",this.stj(),this.ijb=!0,this.xEf&&this.xEf())}dismiss(){this.ijb&&(this.T1a(),this.wee.removeChild(this.MV),this.ijb=!1,this.HJ&&this.HJ())}dispose(){this.dismiss();this.DS=this.dx=this.GG=this.rpa=
this.NG=this.Vqa=null;Sys.Component.prototype.dispose.call(this)}ni(G){return this.get_element().id+G}i7g(){this.NG=this.tg.createElement("div");this.NG.id=this.ni("WACCalloutHeader");this.NG.className="WACCalloutHeader";this.ut&&this.qme();this.Fdc&&this.Jne();this.GG=this.tg.createElement("div");this.GG.id=this.ni("WACCalloutContent");this.GG.className="WACCalloutContent";this.GG.style.width=190<this.d1?this.d1-26+"px":"164px";this.GG.appendChild(this.content);this.MV.appendChild(this.Xob);this.MV.appendChild(this.NG);
this.MV.appendChild(this.GG)}qme(){this.dx=this.tg.createElement("a");this.dx.className="WACCalloutCloseAnchor";this.dx.id=this.ni("WACCalloutCloseAnchor");this.dx.href="#";this.NG.appendChild(this.dx);const G=d.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.dx.appendChild(G)}Jne(){this.DS=this.tg.createElement("div");this.DS.className="WACCalloutTitle UIFontBold";this.DS.style.width=190<this.d1?this.d1-30+"px":"160px";this.DS.id=
this.ni("WACCalloutTitle");this.DS.innerText=this.title;this.NG.contains(this.dx)?this.NG.insertBefore(this.DS,this.dx):this.NG.appendChild(this.DS)}stj(){var G=this.kje;let D;if(1===this.HT){var J=this.Bue.y+16;D=-16}else 2===this.HT||3===this.HT||0===this.HT?(J=G.y+G.height+15,D=-15):(J=G.y-this.MV.clientHeight-15-2,D=this.MV.clientHeight-1);this.MV.style.top=J+"px";this.Xob.style.top=D+"px";1===this.HT?(G=this.Bue.x-16,this.MV.style.left="50%",this.MV.style.marginLeft=-this.d1/2+"px",J=Sys.UI.DomElement.getBounds(this.MV),
this.Xob.style.left=G-J.x+"px"):(J=G.x+this.kje.width/2,2===this.HT||5===this.HT?(G=20,J-=36):0===this.HT||4===this.HT?(G=this.d1/2-16,J-=this.d1/2):(G=this.d1-20-32,J=J-this.d1+36),this.MV.style.left=J+"px",this.Xob.style.left=G+"px")}so(){this.ut&&!this.FS&&(this.FS=Object(b.a)(this,this.w$,"closeHandler"),this.iP.ra(f.a.click,this.dx,this.FS,null))}T1a(){this.ut&&this.FS&&(this.iP.Ba(f.a.click,this.dx,this.FS),this.FS=null)}w$(){this.dismiss();return!0}}Object(n.a)(k,"Callout",Sys.UI.Control,[82]);
class l extends k{constructor(G,D,J,L,H,R=null){super(G,J,H.QW,R);this.Ece=0;this.d1=this.GSh(L);this.pYa=D;this.af=H;this.eKj=7;this.wl=this.pYa.ownerDocument.createElement("div");this.wl.className="ModalCalloutControlOverlay";this.wl.tabIndex=0;this.pYa.insertBefore(this.wl,this.pYa.firstChild)}show(){this.FMa||(this.af.Lqc(),this.af.EP(!1),this.wl.style.zIndex=String(this.af.f2),super.show(),this.Ij(),this.Ece=window.setTimeout(Object(b.a)(this,this.dismiss,"dismiss"),1E3*this.eKj))}dismiss(){this.FMa&&
(this.af.JM(!1),this.mk(),this.pYa&&this.pYa.contains(this.wl)&&this.pYa.removeChild(this.wl),super.dismiss(),window.clearTimeout(this.Ece))}Ij(){this.af.Vra(Object(b.a)(this,this.dismiss,"dismiss"));this.af.Iy.ra(f.a.click,this.wl,Object(b.a)(this,this.gd,"onClick"))}mk(){this.af.Pbb(Object(b.a)(this,this.dismiss,"dismiss"));this.af.Iy.Ba(f.a.click,this.wl,Object(b.a)(this,this.gd,"onClick"))}gd(){this.dismiss();return!0}GSh(G){let D=0;switch(G){case 0:D=190;break;case 1:D=250;break;case 2:D=300;
break;case 3:D=360}return D}}Object(n.a)(l,"ModalCallout",k,[]);var m=a(460),u=a(175);class t extends l{constructor(G,D,J,L,H,R=null){super(G,D,J,L,H,R);this.bVb=null}show(){if(!this.FMa){const G=Object.assign(new m.a,{onShow:()=>{l.prototype.show.call(this)}});u.UISurfaces.BH().then(D=>{const J=D.externalNotification();this.bVb=D.addNotification(J,G);return null},D=>{c.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",D);return null})}}dismiss(){this.FMa&&this.bVb&&(u.UISurfaces.BH().then(G=>
{G.removeNotification(this.bVb);return this.bVb=null},G=>{c.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null}),super.dismiss())}}Object(n.a)(t,"ReactManagedModalCallout",l,[]);var w=a(4);class r{static U8g(G,D,J){return w.AFrameworkApplication.ta.Oa.TQ?new t(G,D,J,3,w.AFrameworkApplication.ta,null):new l(G,D,J,3,w.AFrameworkApplication.ta,null)}}Object(n.a)(r,"ModalCalloutControlFactory",null,[]);var v=a(54),y=a(860),x=a(465),B=a(861),z=a(134),A=a(56),I=a(39),
F=a(83),U=a(811),X=a(695);a.d(C,"a",function(){return T});class T{static get m0b(){return T.Wea||(T.Wea=F.a.instance.yh("Common.Utils.IAriaNotifier"))}static gEe(G,D,J,L){T.kJ&&T.kJ.FMa&&T.kJ.dismiss();T.kJ=r.U8g(D,G,G);T.kJ.content=J;X.b(L)||(T.kJ.title=L,T.kJ.Fdc=!0);G=new Sys.UI.Bounds(0,0,A.a.Dcc(),A.a.Ccc());T.kJ.HT=T.zKh(G,D,T.kJ.d1);T.kJ.show();T.m0b&&T.m0b.sendNotification(J.innerText,!0)}static J3c(G,D,J,L=null){u.UISurfaces.BH().then(H=>{let R=null;T.blb&&(H.removeNotification(T.blb),T.blb=
null);const Q=H.callout(Object.assign(new y.a,{target:G,title:D,content:J,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:()=>{H.removeNotification(R)},directionalHint:null!=L?L:null})})),O=Object.assign(new m.a,{expirationOptions:Object.assign(new x.a,{displayTimeoutSeconds:7,onExpire:()=>{H.removeNotification(T.blb)}})});R=T.blb=H.addNotification(Q,O);return null},H=>{c.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
H);return null})}static QSd(G,D=null){T.kJ&&T.kJ.FMa&&T.kJ.dismiss();const J=new z.StandardDialog;J.YSa=!1;J.Rb=0;J.bA(v.a.hri,CommonUIStrings.l_DialogError,X.b(G)?T.wZe():G,D)}static SSd(G){T.kJ&&T.kJ.FMa&&T.kJ.dismiss();c.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",G.errorCode));const D=X.b(G.description)?T.wZe():G.description,J=new z.StandardDialog;let L=null;G.pha?(J.Rb=1,J.rc(1,G.buttonText),J.s0(1)):J.Rb=0;L=H=>{1===H?G.pha():G.lia&&G.lia()};
J.YSa=!1;0===G.aMa?J.bA(G.errorCode,G.title?G.title:CommonUIStrings.l_DialogError,D,L):1===G.aMa?J.JW(G.title?G.title:CommonUIStrings.l_DialogWarning,D,L):J.ZAa(G.title?G.title:CommonUIStrings.l_DialogInfo,D,L)}static zKh(G,D,J){let L=4;const H=G.x+G.width-D.x-D.width;D.x-G.x+D.width/2<=J/2?L=5:H+D.width/2<=J/2&&(L=6);return L}static tzj(G,D,J,L=!1){(D=U.a.J3a(D))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(D,H=>{H&&(L||T.J3c(H,
J,G,5))})}static uzj(G,D,J=!1){T.tzj(D.startedNode?D.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,G),D,D.startedNode?D.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,G),J)}static szj(G,D,J,L){if(T.bgg)G=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,L,CommonUIStrings.l_InsertionDialogRefresh)),T.J3c(D,G,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{D=
I.a.qp(D);var H=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),R=document.createElement("span");R.innerText=H[0];var Q=document.createElement("span");Q.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,J,L,CommonUIStrings.l_InsertionDialogRefresh);Q.className="UIFontBold";J=document.createElement("span");J.innerText=H[1];L=document.createElement("div");Sys.UI.DomElement.addCssClass(L,"ModalCalloutControl");L.appendChild(R);L.appendChild(Q);L.appendChild(J);
T.gEe(G,D,L,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static MAj(G,D){var J=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,L=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;T.bgg?T.J3c(D,J,L):(D=I.a.qp(D),T.gEe(G,D,T.mTg(L),J))}static mTg(G){const D=document.createElement("div");Sys.UI.DomElement.addCssClass(D,"ModalCalloutControl");D.innerText=G;return D}static wZe(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive}static get bgg(){return w.AFrameworkApplication.ta.Oa.Ri&&
w.AFrameworkApplication.ta.Oa.TQ}}T.kJ=null;T.blb=null;T.Wea=null;Object(n.a)(T,"AddInCommandsNotificationFactory",null,[])},946:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(1456),d=a(146),f=a(124),e=a(720),k=a(733),l=a(342);class m{constructor(v,y,x,B){this.vA=!1;this._id=v;this.lx=y;this.q1=x;this.Ld=B}get enabled(){return this.vA}set enabled(v){const {DynamicRibbon:y}=a(946);var x=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.lx,x,null,null,null,B);x={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,z,null,null,B),["ownerAddinStoreType"]:x,["ribbonControlType"]:"Button",["toggle"]:v};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:y.qAc+"ControlUpdate",dataFields:f.a.Sj(x)}));this.vA=v;this.q1.nK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.lx,["PrivacyCompliantSolutionId"]:A,
["SourceControlId"]:this.id,["MethodData"]:this.vA})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(v){switch(v){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v,
y){switch(v){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(y,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertySetAsync(v,y){this.invokePropertySet(v,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,y){switch(v){case 5:return this.cqj(y);case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,y){v=this.invokeMethod(v,
y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}cqj(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setEnabled(v);return null}ACa(){this._OnAccess();return null}}Object(n.a)(m,"RibbonButton",null,[]);class u{constructor(v,y,x,B){this._id=v;this.lx=y;this.q1=x;this.Ld=B}get id(){return this._id}setVisibility(v){const {DynamicRibbon:y}=a(946),x=this.Ld.OwnerAddinStoreType;var B=this.Ld.PrimaryMarketplace.MarketplaceRef;const z=this.Ld.AssetMarketplace?
this.Ld.AssetMarketplace.SolutionId:null,A=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.lx,x,z,null,null,B);B={["addinSolutionId"]:A,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,x,z,null,null,B),["ownerAddinStoreType"]:x,["ribbonControlType"]:"Tab",["toggle"]:v};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:y.qAc+"ControlUpdate",dataFields:f.a.Sj(B)}));this.q1.nK(-1014260128,{["DynamicAddinCommandsMethodDispatchId"]:2,["SolutionId"]:this.lx,
["PrivacyCompliantSolutionId"]:A,["StoreType"]:x,["SourceControlId"]:this.id,["MethodData"]:v})}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(v){switch(v){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertySetAsync(v,y){this.invokePropertySet(v,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v,y){switch(v){case 3:return this.Wtj(y);case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,y){v=this.invokeMethod(v,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}Wtj(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setVisibility(v);
return null}ACa(){this._OnAccess();return null}}Object(n.a)(u,"RibbonTab",null,[]);var t=a(969),w=a(185);a.d(C,"DynamicRibbon",function(){return r});class r{constructor(v,y,x,B,z){this.lx=v;this.dJ=x;this.q1=B;this.Ld=z;this.whb=this.dJ.Xh;this.Ny=this.whb.getOsfControl(y);this.Rtg=this.Ny.getManifest()}get buttons(){return null}executeRequestCreate(v){try{var y=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:
null;var x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.lx,y,z,null,null,B);const A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,y,z,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.qAc+"ExecuteRequestCreate",dataFields:f.a.Sj(A)}));const I=w.a.$h(v);v={};y={};y[e.a.UIa]=this.Ny;y[e.a.VIa]=I;y[e.a.U7c]=this.Ld;v[e.a.btb]=
3;v[e.a.E3]=this.lx;v[e.a.I7b]=x;v[e.a.D3]=y;this.q1.nK(-1014260128,v);let F=r.Z$b("ExecuteRequestCreate",!0,"");c.ULS.sendTraceTag(538572826,0,50,F)}catch(B){x=r.Z$b("ExecuteRequestCreate",!1,B.toString()),c.ULS.sendTraceTag(538572825,0,50,x)}return null}executeRequestUpdate(v){try{var y=this.Ld.OwnerAddinStoreType;const B=this.Ld.PrimaryMarketplace.MarketplaceRef,z=this.Ld.AssetMarketplace?this.Ld.AssetMarketplace.SolutionId:null;var x=Telemetry.PrivacyRules.GetPrivacyCompliantId(this.lx,y,z,null,
null,B);const A={["addinSolutionId"]:x,["ownerAddinSolutionId"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(this.Ld.OwnerAddinSolutionId,y,z,null,null,B),["ownerAddinStoreType"]:this.Ld.OwnerAddinStoreType,["ribbonControlType"]:"Ribbon"};d.a.sendTelemetryEvent(Object.assign(new l.a,{name:r.qAc+"ExecuteRequestUpdate",dataFields:f.a.Sj(A)}));const I=w.a.$h(v);v={};y={};y[e.a.UIa]=this.Ny;y[e.a.VIa]=I;y[e.a.U7c]=this.Ld;v[e.a.btb]=3;v[e.a.E3]=this.lx;v[e.a.I7b]=x;v[e.a.D3]=y;this.q1.nK(-1014260128,
v);let F=r.Z$b("ExecuteRequestUpdate",!0,"");c.ULS.sendTraceTag(538572824,0,50,F)}catch(B){x=r.Z$b("ExecuteRequestUpdate",!1,B.toString()),c.ULS.sendTraceTag(538572823,0,50,x)}return null}getButton(v){let y=null;if(!this.fef())return this.iEe();if(v&&0<v.length){if(!this.pze(v))return this.BEe(v);y=new m(v,this.lx,this.q1,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}getTab(v){let y=null;if(!this.fef())return this.iEe();if(this.Ny.getOwnerAddinControlRecreated())return this.h8g();
if(v&&0<v.length){if(!this.pze(v))return this.BEe(v);y=new u(v,this.lx,this.q1,this.Ld)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(y)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(v){switch(v){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokePropertyGetAsync(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}invokePropertySet(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
}invokePropertySetAsync(v,y){this.invokePropertySet(v,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(v){switch(v){case 1:return this.ACa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);}invokeMethodAsync(v,y){switch(v){case 7:return this.fyh(y);case 6:return this.gyh(y);case 3:return this.fKh(y);case 5:return this.gZh(y)}v=this.invokeMethod(v,y);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)}fyh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,
0,"string");return this.executeRequestCreate(v)}gyh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestUpdate(v)}fKh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getButton(v)}gZh(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getTab(v)}ACa(){this._OnAccess();return null}BEe(v){return t.a(k.a.K3g,w.a.ga(1769)+v)}iEe(){return t.a(k.a.$hj,w.a.ga(1765))}h8g(){return t.a(k.a.hostRestartNeeded,
w.a.ga(1770))}fef(){var v=this.Ny.getSharedRuntimeId();v=!!v&&0<v.length;c.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",v));return v}pze(v){const y=this.Rtg.getRibbonExtensionControlMap();return v in y||this.WXg(v)}WXg(v){var y=this.MBh();if(y){y=y.aLe;for(const x of y.tabs){if(x.id===v)return!0;for(const B of x.groups)for(const z of B.controls){if(z.id===v)return!0;if("Menu"===z.type){y=z;for(const A of y.items)if(A.id===v)return!0}}}}return!1}MBh(){return b.a.getInstance().Oia(this.Ld.PrimaryMarketplace.MarketplaceType,
this.Ld.PrimaryMarketplace.SolutionId,1)}static Z$b(v,y,x){const B={};B.methodName="DynamicRibbon."+v;B.result=y?"Succeeded":"Failed";B.message=x;return w.a.kc(B)}}r.qAc="Office.Online.Extensibility.Ribbon.";Object(n.a)(r,"DynamicRibbon",null,[])},956:function(n,C,a){a.d(C,"a",function(){return b});var c=a(957);const b=()=>{Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=c.a}},964:function(n,C,a){a.d(C,"a",function(){return c});
const c=(b,d)=>{let f=!1;b&&(b=d.osfControl,(d=b.getManifest())&&d.getSharedRuntimeForCustomFunctions("Workbook")&&!b.getIsUpgrading()&&(f=!0));return f}},965:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.bha=this.YTa=this.rfd=this.Jhd=this.Kwb=this.GWd=null}}Object(n.a)(c,"AppsForOfficeOauthResult",null,[])},969:function(n,C,a){a.d(C,"a",function(){return c});const c=(b,d)=>OfficeExtension.WacRuntime.Utility.createPromise((f,
e)=>{e(OfficeExtension.WacRuntime.Utility.createRichApiException(b,d))})}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.agave.js.map/e97a4502d0d8e5b0b0d87df015c19bf4/EwaDSEsNext.agave.js.map