'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[26],{1128:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}},
1444:function(n,C,a){a.r(C);var c=a(9);n=a(0);var b=a(694),d=a(15),f=a(822),e=a(8),k=a(77),l=a(183),m=a(371),u=a(34),t=a(55);class w{constructor(pa){this.$=pa}Lc(){return!1}executeCommand(pa,Na,Z){let Ra=!1;pa=Na.command;const Da=u.a(this.$);11!==Na.Re&&7!==Na.Re&&6!==Na.Re&&2!==Na.Re&&14!==Na.Re&&15!==Na.Re&&16!==Na.Re&&d.ULS.sendTraceTag(537149787,0,15,`ZoomCommandHandler.ExecuteCommand - unsupported zoom origin ${Na.Re}`);const Ba=6===Na.Re;switch(Na.command){case -1365094462:case -1441674458:Da.fEc(Math.floor(10*
Da.zoom)/10+.1,Ba);Ra=!0;break;case 1056010365:case 1664364901:Da.fEc(Math.ceil(10*Da.zoom)/10-.1,Ba);Ra=!0;break;case 346087880:Da.fEc(e.a.u_,Ba);Ra=!0;break;case -1918142559:case 1517993347:k.a.Qc in Z?(Z=parseFloat(Z[k.a.Qc]),Z!==Da.zoom&&Da.eEc(Z,1517993347===Na.command),Ra=!0):d.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:Na=parseFloat(Z[f.a.Value]);isNaN(Na)||Da.eEc(Na/100,!0);Ra=!0;break;case 1409187195:Da.zoomFitToScreen();
Ra=!0;break;case -1836771825:Da.zoomFitToScreenUndo(),Ra=!0}return Ra?t.Task.Ta(!0):l.a(pa)}Ac(pa,Na){switch(Na.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return u.a(this.$).fX();case -1365094462:case 1056010365:case -2096586688:return m.a(this.$);default:return!1}}Oc(){return!1}}Object(n.a)(w,"ZoomCommandHandler",null,[164]);class r extends b.a{constructor(pa){super(pa)}vd(){this.$c([new w(this.$)])}static ka(pa){b.a.Od(370,
new r(pa))}}Object(n.a)(r,"ZoomCommandHandlerFactory",b.a,[]);C=a(222);var v=a(86),y=a(27),x=a(83),B=a(545),z=a(49),A=a(5),I=a(160),F=a(65),U=a(291),X=a(132),T=a(43),G=a(33),D=a(12),J=a(11),L=a(104),H=a(97),R=a(21),Q=a(306),O=a(133);class V{constructor(pa){this.Z5a=this.Yec=0;this.o2b=null;this.Pef=!1;this.$=pa;this.Pef=pa.Ric}Aii(){return R.g(this.$).eb?(d.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.rb.iy?(d.ULS.sendTraceTag(537149794,
0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),!1):!0}RKi(pa){this.o2b=new Sys.UI.Point(Math.round(pa.fva.center.x),Math.round(pa.fva.center.y));this.Yec=u.a(this.$).zoom;this.Z5a=pa.fva.scale;let Na={["InitialZoom"]:this.Yec,["Location"]:"canvas",["InputMethod"]:pa.tb};O.b(this.$).Hd(X.a.oYi,Na);d.ULS.sendTraceTag(537149793,0,50,`PinchToZoomAdapter.OnGestureStart starting gesture. center (${this.o2b.x},${this.o2b.y}), initial zoom ${this.Yec}, initial scale ${this.Z5a}`);
this.a9a(pa,"onGestureStart");return!0}QKi(pa){if(!this.Z5a)return d.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.a9a(pa,"OnGestureEvent"),!0;if(!isFinite(this.Z5a))return d.ULS.sendTraceTag(537149791,0,15,`PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale=${this.Z5a}`),this.a9a(pa,"OnGestureEvent"),!0;const Na=pa.fva.scale/this.Z5a*this.Yec;u.a(this.$).Hig(Na,this.o2b);d.ULS.sendTraceTag(537149790,
0,50,`PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom ${Na}. Current scale ${pa.fva.scale}`);this.a9a(pa,"OnGestureEvent");return!0}PKi(pa){u.a(this.$).Iig();d.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.a9a(pa,"OnGestureEnd")}OKi(pa){d.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.a9a(pa,"OnGestureCancel")}a9a(pa,Na){var Z,Ra,Da;this.Pef&&(d.ULS.sendTraceTag(536990857,0,50,`PinchToZoomAdapter.markGestureEventAsHandled - Invoked from ${Na},        eventArgs non-null: ${isNullOrUndefined(pa)}, gestureData non-null: ${isNullOrUndefined(null===
pa||void 0===pa?void 0:pa.fva)},        srcEvent non-null: ${isNullOrUndefined(null===(Z=null===pa||void 0===pa?void 0:pa.fva)||void 0===Z?void 0:Z.srcEvent)}`),null===(Da=null===(Ra=null===pa||void 0===pa?void 0:pa.fva)||void 0===Ra?void 0:Ra.srcEvent)||void 0===Da?void 0:Da.preventDefault())}}Object(n.a)(V,"PinchToZoomAdapter",null,[436]);var W=a(38);class da extends W.a{constructor(){super()}Hpe(pa){this.addHandler("ZCIEK",pa)}ySf(pa){this.removeHandler("ZCIEK",pa)}Gpe(pa){this.addHandler("ZCUIK",
pa)}xSf(pa){this.removeHandler("ZCUIK",pa)}aJg(pa){this.addHandler("ZCEK",pa)}Edj(pa){this.removeHandler("ZCEK",pa)}D4i(){this.raiseEvent("ZCIEK")}C4i(){this.raiseEvent("ZCUIK")}E4i(){this.raiseEvent("ZCEK")}}Object(n.a)(da,"ZoomEventManager",W.a,[435]);var ta=a(22);class K extends W.a{constructor(pa){super();this.statusBarManager=null;this.ZVe=!1;this.$=pa;this.$.da.Za(29,Na=>{this.statusBarManager=Na;Na.uJ(this)})}Cq(pa){this.addHandler("Zoom",pa)}Yq(pa){this.removeHandler("Zoom",pa)}Jz(){this.vn("QueryZoomStatus")&&
this.raiseEvent("Zoom")}ds(pa,Na){return"QueryZoomStatus"!==pa?!1:this.b4h(Na)}vn(){return u.a(this.$).fX()}dispose(){this.statusBarManager&&(this.statusBarManager.aG(this),this.statusBarManager=null);this.$=null;super.dispose()}j5e(pa){pa=this.y0h(pa);if(!pa)return null;pa=pa.getElementsByClassName("cui-ctl-mediumlabel");return 1!==pa.length?(d.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):pa[0]}b4h(pa){if(!this.$)return!1;const Na=
u.a(this.$).wQb,Z=this.j5e("HandleQueryZoomStatusCommand");Z?ta.a.equals(pa.LabelText.toString(),Na,!1)||(Z.innerText="",this.y0f(pa,Na)):this.y0f(pa,Na);return!0}y0f(pa,Na){pa.LabelText=Na}y0h(pa){var Na=D.DOMElementExtensions.getElementById(this.$.domElement,"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Na)return Na=(Na=this.$.ea.jc)?Na.inEmbedView:!1,y.a.Ap||Na||d.ULS.sendTraceTag(537149763,0,15,`ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from ${pa}`),null;this.ZVe||
(this.ZVe=!0,d.ULS.sendTraceTag(537149762,0,50,`ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from ${pa}`));return Na}}Object(n.a)(K,"ZoomStatusBarManager",W.a,[10,160,161]);class na extends B.a{constructor(pa){super(pa);this.zoomEventManager=this.Mxa=this.NBb=null;this.SBb=-1;this.Kef=!1;this.Vc=()=>{this.SBb=-1};d.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");this.mgb=new K(pa);this.pYi()&&(d.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),
this.vNg());this.O9i()}dispose(){this.mgb&&(v.a.Ia(this.mgb),this.mgb=null);this.zoomEventManager&&(this.$.da.nU(419),this.zoomEventManager=null);this.Kef&&this.Pfh();super.dispose()}fX(){return!0}Hig(pa,Na){pa=this.Sua(pa);if(R.g(this.$).rtl){const Z=Math.round(D.DOMElementExtensions.getBounds(this.$.Ef).width*u.a(this.$).zoom);this.NBb=new Sys.UI.Point(Z-Na.x,Na.y)}else this.NBb=Na;this.LAa(pa,!1,"ZoomWithPinch")}dEc(){return!0}cEc(pa,Na){var Z=y.a.isMac?.07:.15;pa=this.zoom+(pa?Z:-Z);pa=this.Sua(pa);
R.g(this.$).rtl?(Z=Math.round(D.DOMElementExtensions.getBounds(this.$.Ef).width*u.a(this.$).zoom),this.Mxa=new Sys.UI.Point(Z-Na.x,Na.y)):this.Mxa=Na;Na=this.zoom;this.LAa(pa,!0,"ZoomWithMouse");Na={["InitialZoom"]:Na,["FinalZoom"]:pa,["Location"]:"canvas"};O.b(this.$).Hd(X.a.IYj,Na)}Iig(){this.NBb=null}eEc(pa,Na){this.LAa(this.Sua(pa),!1,Na?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")}Jig(pa){isNaN(pa)?d.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):
this.LAa(this.Sua(pa),!1,"ZoomToLevelInExcelLive")}Kig(pa){this.LAa(this.Sua(pa),!1,"ZoomWithActionPen")}fEc(pa,Na){this.LAa(this.Sua(pa),!0,Na?"ZoomWithShortcuts":"ZoomWithButtons")}f3e(pa,Na){const Z=R.g(this.$).rtl,[Ra,Da]=this.ngd(Z),[Ba,ea]=this.did(pa,Da);return this.Mxa?(pa=this.Wfd(this.Mxa,pa,Na,Da,Ra,"ZoomWithMouse"),this.Mxa=null,pa):this.NBb?this.Wfd(this.NBb,pa,Na,Da,Ra,"ZoomWithPinch"):R.g(this.$).ha.Qa.LZ?this.HYj(pa,Na,Da,Ra,Ba,ea,R.g(this.$).rtl):this.JYj(pa,Na,Da,Ra,Ba,ea,R.g(this.$).rtl)}aYf(pa,
Na,Z){if(pa){d.ULS.sendTraceTag(537149782,0,50,`Zoom To: (${pa.x} ${pa.y}) (new top-left) from zoom:${Na} to zoom:${Z}`);pa=new z.a(pa.x,pa.y);Z=R.g(this.$).rtl;[,Z]=this.ngd(Z);const [Ra,Da]=this.did(Na,Z);R.g(this.$).kqe(pa,Ra,Da,H.a.Bse)}else d.ULS.sendTraceTag(537149781,0,50,`Zooming top-left: from zoom:${Na} to zoom:${Z}`)}zoomFitToScreen(){const pa=this.zoom;var Na=R.g(this.$).rtl;const [Z,Ra]=this.ngd(Na),[Da,Ba]=this.did(pa,Ra);var ea=R.g(this.$).ha.Qa.LZ;(Na=ea?this.m_e(this.Q$a,Da,Ba,!1):
this.o3e(this.Q$a,Ra,Z,Da,Ba,Na,!1))?(Na=Math.min(Da/(Na.width+100),Ba/(Na.height+100)),Na=this.BCh(Na),this.LAa(Na,!0,"ZoomWithFitToScreen"),ea?R.g(this.$).ha.Qa.Psa(R.g(this.$).ha.Qa.dc,!1):(ea=T.v(R.g(this.$).ha.sa.activeRange,this.$),R.g(this.$).yg(ea,null,null,null,3,H.a.Eig)),this.SBb=pa,this.Kef||this.sNg()):d.ULS.sendTraceTag(537149780,0,15,`ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: ${ea}`)}zoomFitToScreenUndo(){this.LAa(this.SBb,!1,"ZoomWithFitToScreen")}ISd(){return-1!==
this.SBb}sNg(){const pa=R.g(this.$);pa&&(pa.ha.YG(this.Vc),pa.rC(this.Vc))}Pfh(){const pa=R.g(this.$);pa&&(pa.ha.cG(this.Vc),pa.MD(this.Vc))}BCh(pa){pa=Math.min(pa,e.a.iAi);pa=Math.max(pa,e.a.bBi);return Math.round(100*pa)/100}LAa(pa,Na,Z){if(this.aEc()){var Ra=R.g(this.$).view.visibleArea.toString();pa=this.Sua(pa);var Da=F.d(this.$.xa.oa);Da||(Da=B.a.Dtf);R.g(this.$).Pi.A7(5,Q.a.$Dc,Z);R.g(this.$).Pi.vla(Q.a.$Dc,this.$.ea.Je);d.ULS.sendTraceTag(537149779,0,50,`ZoomManager.SetNewZoomLevel Setting zoom ${pa} to sheet ${Da} origin ${Z} prevZoom ${this.zoom}`);
this.euj(Da,pa);this.zoomEventManager.E4i();this.nMj(Z);this.yMj(Na);this.SBb=-1;m.b(this.$,Z);pa=R.g(this.$).view.visibleArea.toString();d.ULS.sendTraceTag(537149778,0,50,`ZoomManager.SetNewZoomLevel OldGridVisibleArea: ${Ra}, NewGridVisibleArea: ${pa}, IsShyRibbonActive: ${this.$.UZ}`)}}TLh(pa){return(pa=J.HelperMethods.dD(this.$.Ef,this.$.domElement,pa))?pa:new Sys.UI.Point(0,0)}ngd(pa){const Na=this.TLh(pa);pa=this.CQh(Na,pa);return[Na,pa]}did(pa,Na){const Z=D.DOMElementExtensions.getBounds(this.$.Ef);
return[Math.round((Z.width-Na.x)*pa),Math.round((Z.height-Na.y)*pa)]}CQh(pa,Na){Na=J.HelperMethods.dD(R.g(this.$).domElement,this.$.domElement,Na);return Na?(pa=new Sys.UI.Point(Math.round(Na.x-pa.x),Math.round(Na.y-pa.y)),pa):new Sys.UI.Point(0,0)}JYj(pa,Na,Z,Ra,Da,Ba,ea){return(ea=this.o3e(pa,Z,Ra,Da,Ba,ea))?this.g2e(ea,pa,Na,Z,Ra,Da,Ba):null}o3e(pa,Na,Z,Ra,Da,Ba,ea=!0){var Y=T.F(R.g(this.$).ha.sa.selectedRanges);if(ea&&(Y=Y.Ie(T.F(R.g(this.$).Fcc())),!Y))return d.ULS.sendTraceTag(537149777,0,50,
"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),null;const ja=R.g(this.$).Vb(Y.topLeft);Y=R.g(this.$).Vb(Y.bottomRight);if(!ja||!Y)return d.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;pa=ja.cell.JQ===Y.cell.JQ&&ja.cell.IQ===Y.cell.IQ?this.LKh(pa,Y,Na,Z,Ra,Ba):this.n_h(pa,ja,Y,Na,Z,Ra,Ba);return pa?ea?this.RUe(pa,Ra,Da):pa:(d.ULS.sendTraceTag(537149775,
0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)}RUe(pa,Na,Z){if(0>pa.x||pa.x>Na)pa.x=0;if(0>pa.y||pa.y>Z)pa.y=0;pa.x+pa.width>Na&&(pa.width=Na-pa.x);pa.y+pa.height>Z&&(pa.height=Z-pa.y);return pa}n_h(pa,Na,Z,Ra,Da,Ba,ea){Na=R.g(this.$).getCellBounds(Na.cell);if(!Na)return null;const Y=R.g(this.$).getCellBounds(Z.cell);if(!Y)return null;let ja=Da.x;ea&&(ja=0,Na.x=Math.round(Ba/pa)-Na.x-Math.round(Na.width),Y.x=Math.round(Ba/pa)-Y.x-Math.round(Y.width));pa=new Sys.UI.Bounds(Math.round((Na.x-
Ra.x)*pa)-ja,Math.round((Na.y-Ra.y)*pa-Da.y),Math.round((Y.x+Y.width-Na.x)*pa),Math.round((Y.y+Y.height-Na.y)*pa));Z=Z.cell.getRange();d.ULS.sendTraceTag(537149774,0,50,`ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:${Z.top}, b:${Z.bottom}, r:${Z.right}, l:${Z.left}) in bounds (${pa.x}, ${pa.y}, ${pa.width}, ${pa.height})`);return pa}LKh(pa,Na,Z,Ra,Da,Ba){const ea=R.g(this.$).getCellBounds(Na.cell);if(!ea)return null;let Y=Ra.x;Ba&&(Y=0,
ea.x=Math.round(Da/pa)-ea.x-Math.round(ea.width));pa=new Sys.UI.Bounds(Math.round((ea.x-Z.x)*pa)-Y,Math.round((ea.y-Z.y)*pa-Ra.y),Math.round(ea.width*pa),Math.round(ea.height*pa));Na=Na.cell.getRange();d.ULS.sendTraceTag(537149773,0,50,`ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:${Na.top}, l:${Na.left}) in bounds (${pa.x}, ${pa.y}, ${pa.width}, ${pa.height})`);return pa}HYj(pa,Na,Z,Ra,Da,Ba){const ea=this.m_e(pa,Da,Ba);return ea?this.g2e(ea,pa,Na,Z,Ra,Da,Ba):
null}g2e(pa,Na,Z,Ra,Da,Ba,ea){pa=new Sys.UI.Point(this.K2e(Ba,pa.x,pa.width),this.K2e(ea,pa.y,pa.height));return this.Wfd(pa,Na,Z,Ra,Da)}K2e(pa,Na,Z){return pa===Z?(d.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),pa/2):pa*Na/(pa-Z)}m_e(pa,Na,Z,Ra=!0){const Da=R.g(this.$).ha.Qa.dc.domElement;var Ba=J.HelperMethods.dD(Da,R.g(this.$).domElement,R.g(this.$).rtl);if(!Ba)return d.ULS.sendTraceTag(537149771,0,50,
"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;const ea=R.g(this.$).Mwb();Ba=new Sys.UI.Point(Math.round((Ba.x-ea.topLeft.x)*pa),Math.round((Ba.y-ea.topLeft.y)*pa));pa=new Sys.UI.Bounds(Ba.x,Ba.y,Math.round(Da.offsetWidth*pa),Math.round(Da.offsetHeight*pa));return Ra?this.RUe(pa,Na,Z):pa}$tf(){this.mgb.Jz()}GEi(pa){"ZoomToLevelInExcelLive"===pa?this.zoomEventManager.D4i():this.zoomEventManager.C4i()}O9i(){this.zoomEventManager=this.$.da.Ga(419,new da)}Wfd(pa,Na,
Z,Ra,Da,Ba=""){var ea=R.g(this.$).rtl?0:Da.x;Da="ZoomWithPinch"===Ba||"ZoomWithMouse"===Ba?new Sys.UI.Point(pa.x-ea-Math.round(Ra.x*Na),pa.y-Da.y-Math.round(Ra.y*Na)):pa;Da=new Sys.UI.Point(Math.round(Da.x/Na),Math.round(Da.y/Na));d.ULS.shipAssertTag(537149770,0,!!Na,"Original zoom level must be different than 0");ea=Z/Na;Da=new Sys.UI.Point(Math.round(Da.x*(1-1/ea)),Math.round(Da.y*(1-1/ea)));"ZoomWithMouse"===Ba||"ZoomWithPinch"===Ba?(Da.x+=Math.round((Ra.x-R.g(this.$).OD)*(ea-1)),Da.y+=Math.round((Ra.y-
R.g(this.$).IJ)*(ea-1))):(ea=Math.round(Ra.x*(Z-Na)),0<ea&&Da.x>ea&&(Da.x+=ea),Na=Math.round(Ra.y*(Z-Na)),0<Na&&Da.y>Na&&(Da.y+=Na));"ZoomWithMouse"===Ba&&(pa.x||(Da.x=0),pa.y||(Da.y=0));pa=R.g(this.$).Mwb();return new Sys.UI.Point(Da.x+pa.topLeft.x,Da.y+pa.topLeft.y)}vNg(){const pa=[];x.a.instance.Ub("Common.IGestureInputManager").execute(Na=>{0===Na.aQh()&&Na.t8i(document.body,new V(this.$),pa)})}pYi(){return this.aEc()&&(y.a.yp&&y.a.xMa(67)||this.$.Ric)}euj(pa,Na){m.a(this.$)?this.setZoomLevel(pa,
Na,this.A1d,e.a.RJf):this.setZoomLevel(pa,Na,this.zoomPerSheetId,this.Q$a)}setZoomLevel(pa,Na,Z,Ra){Z.remove(pa);Na!==Ra&&Z.add(pa,Na)}nMj(pa){this.n1f();this.$.Jza(U.a.jZ("TriggerImmediateZoomOperations"));this.qUj();this.GEi(pa)}qUj(){this.emi()?this.$.$e():this.mgb.Jz();const pa=this.mgb.j5e("UpdateZoomStatusBar");pa&&(pa.innerText=this.wQb)}emi(){const pa=I.a(this.$);return pa?pa.cm.Yz===(G.a.qxa(this.$)?A.a.Rrc:this.$.Cb+A.a.HVf):!1}yMj(pa){R.g(this.$).GYj(pa);this.JJg()}JJg(){const pa=L.a(this.$);
if(pa)for(const Na of R.g(this.$).Ea.oF()){if(!Na){d.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");continue}if(!Na.Kk)continue;const Z=Na.Ni;if(Z)for(let Ra=0;Ra<Z.count;Ra++)if(2===Z.ag(Ra).type){const Da=pa.Gq(Z.ag(Ra).Og());Da?(Da.wea(!1),d.ULS.sendTraceTag(537149766,0,50,`ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom ${this.zoom}`)):d.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else d.ULS.sendTraceTag(537149769,
0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")}}Object(n.a)(na,"ZoomManager",B.a,[]);var P=a(1);class ka extends C.a{constructor(pa){super();this.$=pa;this.Eb()}create(){const pa=new na(this.$);this.sUj(pa);P.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&this.$.da.Ga(368,pa);this.pb(pa)}sUj(pa){const Na=u.a(this.$);if(Na){var Z=Na.iid("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");pa.RQd(Z);pa.ivc(Na.PBc)}else d.ULS.shipAssertTag(537149765,
0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")}static ka(pa){pa.da.Ga(369,new ka(pa))}}Object(n.a)(ka,"ZoomManagerFactory",C.a,[]);a=a(1128);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(()=>{c.a.Fa(pa=>{ka.ka(pa);r.ka(pa)})})();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.zoom.js.map/7d444205b9fffc22fa48b03b55d2af5b/EwaDSEsNext.zoom.js.map