'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[25],{1119:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie,.ewr-selection-draghandle-top-ie-enhanced{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-top,.ewr-selection-draghandle-top-enhanced{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-top-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom-ie,.ewr-selection-draghandle-bottom-ie-enhanced{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom-ie-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-bottom,.ewr-selection-draghandle-bottom-enhanced{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-enhanced{border-top:1.25px solid transparent}.ewr-selection-draghandle-left-ie,.ewr-selection-draghandle-left-ie-enhanced{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left-ie-enhanced{border-top:1.5px solid transparent}.ewr-selection-draghandle-left,.ewr-selection-draghandle-left-enhanced{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-enhanced{border-left:1.5px solid transparent}.ewr-selection-draghandle-right-ie,.ewr-selection-draghandle-right-ie-enhanced{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right-ie-enhanced{border-right:1.5px solid transparent}.ewr-selection-draghandle-right,.ewr-selection-draghandle-right-enhanced{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-enhanced{border-right:1.5px solid transparent}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}")}},
1120:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}a.ewa-stb-navbutton.cui-disabled:focus{outline:auto 1px}.ewa-stb-navareaextra a.ewa-stb-navbutton:focus-visible{outline-offset:-1px}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.tab-anchor-text:focus-visible{outline-offset:-1px}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}')}},
1121:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-svg-icon{height:100%;width:100%}")}},1122:function(n,C,a){function c(m,u){this.ID=m;this.type=u}function b(m,u){this.value=m;this.contextId=u}function d(m,u,t,w,r,v,y,x){this.type=m;this.startTime=null==t||void 0==t.value?new b(t,null):t;this.endTime=null==w||void 0==w.value?new b(w,null):w;null!=r&&void 0!=r.value||new b(r,null);null!=v&&void 0!=v.value||new b(v,null);this.operationType=x}function f(m){this.ID=
m}function e(){this.Ne=[];this.Znb=[];this.NWc=0;this.duration=this.startTime=null;this.Q7b={};this.Ywd=this.Cxd=this.jYc=-1}function k(m){var u;return(null!=document.body.style.msTransform?u=m.style.msTransform:null!=document.body.style.webkitTransform?u=m.style.webkitTransform:null!=document.body.style.mozTransform?u=m.style.e_j:null!=document.body.style.oTransform?u=m.style.g_j:null!=document.body.style.transform&&(u=m.style.transform),u)?(u=u.replace("rotate(",""),u=u.replace("deg)",""),parseFloat(u)):
0}a.d(C,"a",function(){return k});new c(0,0,0,0,0,0);new c(1,1,0,0,0,0);new c(2,2,0,0,0,0);new c(3,3,0,0,0,1);new c(4,3,1,0,1,1);new c(5,3,0,0,.42,1);new c(6,3,.83,0,1,1);new c(7,3,0,0,.58,1);new c(8,3,.42,0,.58,1);new c(9,3,.1,.25,.75,.9);new c(10,3,.1,.9,.2,1);new c(11,3,.1,.9,.2,1);new c(12,3,.9,.1,.2,1);new c(13,3,.4,0,0,1);new c(14,3,.13,.21,.1,.7);new c(15,3,.02,.33,.38,.77);new c(16,3,.57,.17,.95,.75);new c(17,3,0,.19,.07,.72);new c(18,3,0,0,.95,.37);new c(19,3,.66,0,.34,1);new c(20,3,.8,0,
.2,1);new c(21,3,.8,0,.2,1);d.prototype={type:0,startTime:new b(0,null),endTime:new b(0,null),s_j:new b(0,null),KZj:new b(0,null),operationType:0};n=Array(1);n[0]=new b(0,0);new f(0,[new d(5,0,0,0,null,1,1,0)]);new f(1,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0)]);new f(2,[new d(1,3,0,167,null,0,1,1),new d(2,3,0,167,null,0,1,1)]);new f(3,[new d(3,3,0,167,null,0,1,1),new d(4,3,0,167,null,0,1,1)]);new f(4,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,167,null,1,1,0)]);new f(5,[new d(5,2,0,167,null,
0,1,0)]);new f(6,[new d(1,3,0,100,null,0,1,1),new d(2,3,0,100,null,0,1,1)]);new f(7,[new d(3,3,0,100,null,0,1,1),new d(4,3,0,100,null,0,1,1)]);new f(8,[new d(5,2,0,100,null,1,1,0)]);new f(9,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,1,1,0)]);new f(10,[new d(5,2,0,100,null,0,1,0)]);new f(11,[new d(1,3,0,267,null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(12,[new d(3,3,0,267,null,0,1,1),new d(4,3,0,267,null,0,1,1)]);new f(13,[new d(5,2,0,267,null,1,1,0)]);new f(14,[new d(5,2,0,0,null,0,2,0),new d(5,
2,0,267,null,1,1,0)]);new f(15,[new d(5,2,0,267,null,0,1,0)]);new f(16,[new d(6,3,0,267,null,0,1,1),new d(7,3,0,267,null,0,1,1)]);new f(17,[new d(1,3,0,750,null,0,1,1),new d(2,3,0,750,null,0,1,1)]);new f(18,[new d(3,3,0,750,null,0,1,1),new d(4,3,0,750,null,0,1,1)]);new f(19,[new d(5,2,0,750,null,1,1,0)]);new f(20,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,750,null,1,1,0)]);new f(21,[new d(6,3,0,1E3,null,0,1,1),new d(7,3,0,1E3,null,0,1,1)]);new f(22,[new d(1,3,0,367,null,0,1,1),new d(2,3,0,367,null,0,
1,1)]);new f(23,[new d(3,3,0,367,null,0,1,1),new d(4,3,0,367,null,0,1,1)]);new f(24,[new d(5,2,0,367,null,1,1,0)]);new f(25,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,367,null,1,1,0)]);new f(26,[new d(5,2,0,367,null,0,1,0)]);new f(27,[new d(6,2,0,n[0],null,0,1,1),new d(7,2,0,n[0],null,0,1,1)]);new f(28,[new d(5,2,0,0,null,1,1,0),new d(5,2,0,50,null,0,1,0)]);new f(29,[new d(1,3,0,433,null,0,1,1),new d(2,3,0,433,null,0,1,1)]);new f(30,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,50,null,1,1,0),new d(2,3,0,0,
null,40,1,1),new d(2,3,0,100,null,0,1,1)]);new f(31,[new d(2,0,0,0,null,32,1,1),new d(2,0,0,100,null,32,1,1),new d(2,3,101,350,null,0,1,1),new d(3,0,0,0,null,0,2,1),new d(3,0,0,100,null,0,2,1),new d(3,3,101,350,null,0,1,1),new d(5,0,0,0,null,0,2,0),new d(5,0,0,100,null,1,1,0)]);new f(32,[new d(2,3,0,267,null,32,1,1),new d(3,3,0,267,null,0,2,1),new d(5,2,0,0,null,1,0,0),new d(5,2,0,267,null,0,2,0)]);new f(33,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,100,null,0,2,0),new d(5,2,101,267,null,1,1,0)]);new f(34,
[new d(1,10,0,300,null,0,1,1),new d(2,10,0,300,null,0,1,1)]);new f(35,[new d(3,10,0,300,null,0,1,1),new d(4,10,0,300,null,0,1,1)]);new f(36,[new d(1,8,0,750,null,0,1,1),new d(2,8,0,750,null,0,1,1)]);new f(37,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,200,null,0,2,0),new d(5,3,201,500,null,1,1,0)]);new f(38,[new d(1,2,0,0,null,0,2,1),new d(2,2,0,0,null,0,2,1),new d(1,2,0,200,null,0,2,1),new d(2,2,0,200,null,0,2,1),new d(1,3,201,267,null,0,1,1),new d(2,3,201,267,null,0,1,1)]);new f(39,[new d(1,3,0,267,
null,0,1,1),new d(2,3,0,267,null,0,1,1)]);new f(40,[new d(5,2,0,0,null,0,2,0),new d(5,2,0,267,null,1,1,0)]);new f(41,[new d(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(m,16)}}();e.prototype={Ne:null,SKg:5,Znb:null,NWc:0,startTime:null,
duration:null,Q7b:null,jYc:-1,Cxd:-1,Ywd:-1};e.prototype.Start=function(){this.startTime=new Date;this.Q7b={}};e.prototype.GetRecentAnimationStats=function(){var m,u=[],t=0;for(m=l.NWc;m<l.SKg;m++)null!=l.Znb[m]&&(u[t]=l.Znb[m],t++);for(m=0;m<l.NWc;m++)null!=l.Znb[m]&&(u[t]=l.Znb[m],t++);return u};e.prototype.GetAnimationSqmStats=function(){var m=[];return m[0]=0>l.jYc?0:l.jYc,m[1]=0>l.Cxd?0:l.Cxd,m[2]=0>l.Ywd?0:l.Ywd,m};var l=new e},1123:function(n,C,a){a.d(C,"a",function(){return k});n=a(0);C=a(38);
var c=a(215),b=a(358),d=a(186),f=a(43),e=a(609);class k extends C.a{constructor(l){super();this.ZS=[];this.rf=(u,t)=>{var w,r=t.hd.block;u=!1;if(r.Kk&&r.state&1&&(w=this.view.Hf(t.hd.block.qe.BlockCachePosition.PaneType).AG(t.hd.hash))){r=this.wHd(r.je);if(w=w.tf)for(let v=this.ZS.length-1;0<=v;v--)w.contains(this.ZS[v].bottomRight)&&(this.ZS.splice(v,1),u=!0);if(r)for(let v=0,y=r.length;v<y;v++)this.rangeList.push(d.a.tQ(r[v])),u=!0;u&&(t=this.view.Jpc(t.hd.block.qe.BlockCachePosition.PaneType).AG(t.hd.hash),
this.raiseEvent(k.xHd,new e.a(t)))}};this.Tm=()=>{this.wIb()};this.Jo=()=>{this.ZS=[]};this.zke=l;var m=l.Ea;m.Ws(this.rf);m.Mga(this.rf);m.CZb(this.rf);m.XG(this.Tm);l.$.xa.wJ(this.Jo);l.$.Ab.wJ(this.Jo);for(const u of l.Cn)for(let t of u)for(let w of t)m=l.Ea.Ql(w.hashCode),this.rf(this,new b.a(new c.a(m,w.hashCode),null))}get rangeList(){return this.ZS}get view(){return this.zke}dispose(){this.view&&(this.view.Ea.Xq(this.rf),this.view.Ea.sI(this.Tm),this.view.Ea.Hbb(this.rf),this.view.Ea.QIb(this.rf),
this.view.$.xa.cL(this.Jo),this.view.$.Ab.cL(this.Jo));this.ZS=this.zke=null;super.dispose()}vZb(l){l=this.wHd(l);const m=this.view.vH;if(l&&0<l.length&&m)for(let u=0,t=l.length;u<t;u++)m.contains(this.ZS[u])||this.ZS.push(d.a.tQ(l[u]))}wIb(){const l=this.view.vH;if(this.ZS.length&&l)for(let m=this.ZS.length-1;0<=m;m--)l.contains(this.ZS[m])||this.ZS.splice(m,1)}B2e(l){return this.U1e(l)}U1e(l){l=f.I(l,this.ZS,!0);return 0<l.length?l[0]:null}}k.xHd="lrc";Object(n.a)(k,"LoadedRangeCollection",C.a,
[])},1124:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}")}},
1138:function(n,C,a){var c=a(9),b=a(0),d=a(222),f=a(38);class e extends f.a{constructor(fb){super();fb.da.Ga(376,this)}GIg(fb){this.addHandler("TAF",fb)}qdj(fb){this.removeHandler("TAF",fb)}E3i(){this.raiseEvent("TAF")}}Object(b.a)(e,"GridHighlightBehaviorEventManager",f.a,[351,10]);class k extends d.a{constructor(fb){super();this.$=fb;this.Eb()}create(){this.pb(this.$.da.za(376)||new e(this.$))}static ka(fb){fb.da.Ga(377,new k(fb))}}Object(b.a)(k,"GridHighlightBehaviorEventManagerFactory",d.a,[]);
var l=a(50),m=a(37),u=a(27),t=a(78),w=a(15),r=a(237),v=a(13),y=a(154),x=a(5),B=a(113),z=a(12);class A extends Sys.EventArgs{constructor(fb,ec){super();this.start=fb;this.X5a=ec}}Object(b.a)(A,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var I=a(33);class F extends f.a{constructor(fb){super();this.flc=[3];this.hqa=void 0;this.gridView=fb;this.tBc=I.a.iV(this.gridView.$);this.zz=I.a.zz(this.gridView.$)}get coloredReferencesManager(){const fb=this.gridView.$.da.za(281);fb||w.ULS.sendTraceTag(537159395,
0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return fb}get nz(){if(this.hqa)return this.hqa;const fb=this.gridView.$.da.za(464);fb||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaAssistanceManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
fb.nz||w.ULS.sendTraceTag(0,0,50,"BehaviorHelperMethods.formulaAssistanceManager: formulaHighlightsControl is null.");return this.hqa=fb.nz}fHg(fb){this.addHandler("mrek",fb)}Qw(fb,ec,lb){for(const ac of this.gridView.Cn)r.a.instance.ra(v.a.Gj,ac.domElement,fb);r.a.instance.ra(v.a.Nf,document.documentElement,ec);this.gridView.hc.X7b(!0);lb&&r.a.instance.ra(v.a.sy,this.gridView.zj,ec)}pZd(fb,ec,lb){for(const ac of this.gridView.Cn)r.a.instance.Ba(v.a.Gj,ac.domElement,fb);r.a.instance.Ba(v.a.Nf,document.documentElement,
ec);this.gridView.hc.X7b(!1);lb&&r.a.instance.Ba(v.a.sy,this.gridView.zj,ec)}z8i(fb,ec){for(const lb of this.gridView.Cn)y.a.instance.ra(v.a.Yf,lb.domElement,fb);y.a.instance.ra(v.a.ue,document.documentElement,ec)}uPj(fb,ec){for(const lb of this.gridView.Cn)y.a.instance.Ba(v.a.Yf,lb.domElement,fb);y.a.instance.Ba(v.a.ue,document.documentElement,ec)}HEe(fb,ec,lb,ac){const Gb=document.createElement("div");Gb.className=ec;for(const wb of lb)Gb.classList.add(wb);fb.appendChild(Gb);r.a.instance.ra(v.a.pointerDown,
Gb,ac);return Gb}n3e(fb){fb=fb.Db.parentNode;if(!fb)return w.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;fb=parseInt(fb.getAttribute(x.a.X5a),10);return isNaN(fb)?(w.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.ob.nv(3,1,fb)}HLb(fb,ec,lb=!0){fb=lb&&(this.zz?!!this.nz&&this.nz.Mji(fb):!!this.coloredReferencesManager&&
this.coloredReferencesManager.Lji(fb));for(const ac of ec)z.DOMElementExtensions.setVisible(ac,fb)}bac(){return this.gridView.tm?B.a(this.gridView.$):this.gridView.Xb}gOf(){if(this.zz){var fb=this.bac();fb&&this.nz?this.tBc?fb.SB(null):this.nz.ofb(fb,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.ob.Pg(this.flc),this.gridView.ob.zi(null,this.flc))}else this.h6i()}h6i(){const fb=
this.bac();fb&&this.coloredReferencesManager?this.tBc?fb.SB(null):this.coloredReferencesManager.SB(fb,null):(w.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.ob.Pg(this.flc),this.gridView.ob.zi(null,this.flc))}rMf(fb,ec){this.raiseEvent("mrek",new A(fb,ec))}}Object(b.a)(F,"BehaviorHelperMethods",f.a,[]);var U=a(86),X=a(39),T=a(93);class G extends T.a{constructor(fb,ec=null){super(fb,
ec)}vZa(){}}Object(b.a)(G,"HighlightFlyweightBehavior",T.a,[]);var D=a(19),J=a(461),L=a(77),H=a(11),R=a(117),Q=a(223),O=a(44),V=a(236),W=a(8),da=a(73),ta=a(1),K=a(34);class na extends V.a{constructor(fb,ec,lb){super(document.createElement("div"));this.B5b=null;this.gQb=!1;this.onPointerDown=ac=>{ac=K.a(this.$)?K.a(this.$).Vd(ac):ac;this.gQb=!1;if(3===(L.a.Gb=ac.tb)){const Gb=ac.Ca.rawEvent,wb=Gb.srcElement||Gb.target;z.DOMElementExtensions.xf(this.domElement,wb)&&z.DOMElementExtensions.xf(Gb.currentTarget,
wb)&&(this.gQb=!0,this.B5b=ac.clientPoint)}return!1};this.Mf=ac=>{ac=K.a(this.$)?K.a(this.$).Vd(ac):ac;this.raiseEvent("GrPointerUp",ac);return this.gQb=!1};this.Jh=ac=>{ac=K.a(this.$)?K.a(this.$).Vd(ac):ac;3===ac.tb&&this.gQb&&this.F5h(ac.clientPoint)&&(this.raiseEvent("GrDrag"),this.gQb=!1);return!1};this.gd=ac=>{K.a(this.$)&&K.a(this.$).Vd(ac);return!0};this.$=lb;lb=!ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.domElement.classList.add(lb?da.a.CRe:da.a.BRe);this.domElement.classList.add(da.a.Z8b);
fb.appendChild(this.domElement);z.DOMElementExtensions.setVisible(this.domElement,!1);this.hLa=document.createElement("div");this.hLa.classList.add(da.a.Y8b);this.hLa.style.borderColor=ec;this.domElement.appendChild(this.hLa);r.a.instance.ra(v.a.pointerDown,this.domElement,this.onPointerDown);r.a.instance.ra(v.a.Nf,this.domElement,this.Mf);y.a.instance.ra(v.a.ue,this.domElement,this.Mf);r.a.instance.ra(v.a.Gj,this.domElement,this.Jh);y.a.instance.ra(v.a.Yf,this.domElement,this.Jh);Q.a.instance.ra(v.a.click,
this.domElement,this.gd)}Doe(fb){this.addHandler("GrDrag",fb)}NRf(fb){this.removeHandler("GrDrag",fb)}Coe(fb){this.addHandler("GrContxt",fb)}MRf(fb){this.removeHandler("GrContxt",fb)}Eoe(fb){this.addHandler("GrPointerUp",fb)}ORf(fb){this.removeHandler("GrPointerUp",fb)}dispose(){O.a.Pma(this.domElement);super.dispose()}Xeg(fb){this.domElement.parentNode.removeChild(this.domElement);fb.appendChild(this.domElement)}PZf(){this.domElement.classList.remove(da.a.Z8b);this.hLa.classList.remove(da.a.Y8b);
this.hLa.classList.add(da.a.DRe)}ldg(){this.hLa.classList.remove(da.a.DRe);this.hLa.classList.add(da.a.Y8b);this.domElement.classList.add(da.a.Z8b)}F5h(fb){return!!this.B5b&&(3<Math.abs(fb.x-this.B5b.x)||3<Math.abs(fb.y-this.B5b.y))}static tvb(fb){return ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?(fb=K.a(fb.$)?K.a(fb.$).zoom:W.a.u_,Math.round(9/Math.max(fb,1))):9}}na.Iwd=0;Object(b.a)(na,"TouchGrippie",V.a,[]);class P extends G{constructor(fb,ec,lb,ac){super(ec);this.Zrd=
this.mXc=this.kob=!1;this.Hpb=null;this.zba=this.Vrd=!1;this.Hw=()=>{this.kob&&this.Vrd?this.Sna():this.w4()};this.Ezf=wb=>{3===wb.tb&&(this.Vrd=!0,this.Sna());return!1};this.Fzf=wb=>{if(3===wb.tb){if(!wb.Db||this.Ihi(wb))return!1;this.Vrd=!1;this.w4()}return!1};this.Dg=()=>{this.zba&&this.tZd();this.Sna();this.Zrd=!1};this.Fp=()=>{this.w4();this.Zrd=!0};this.$ya=(wb,qc)=>{qc.z4===this.z4&&(qc.visible?this.Zrd||this.Sna():this.w4())};this.sFf=()=>{this.Gzf(this.LO.domElement,!1)};this.Zvf=()=>{this.Gzf(this.qM.domElement,
!0)};this.Rnc=(wb,qc)=>{this.ha.Kza(qc)};this.Snc=(wb,qc)=>{this.ha.Kza(J.b(qc))};this.bFb=()=>{3===L.a.Gb?this.Sna():this.w4();this.zba&&1===L.a.Gb&&this.tZd()};this.tFf=()=>{this.Poj()};this.eLe=()=>{this.w4()};this.Bn=()=>{this.ha.Qa.dc&&this.w4()};this.Nvf=()=>{this.w4()};this.xzf=(wb,qc)=>{this.tZd();3===qc.tb?this.Sna():this.w4()};this.Nrc=()=>{this.kob&&(this.w4(),this.Sna())};const Gb=lb.$;this.rq=lb;this.ha=lb.ha;this.dba=fb;this.lmj=ec;this.paneType=ac;fb=this.domElement.currentStyle;ec=
"#000000";fb&&(ec=fb.borderTopColor);this.LO=new na(this.hbd(),ec,Gb);this.qM=new na(this.hbd(),ec,Gb);this.Fgf=Gb.ea.isNamedObjectViewMode&&1===Gb.workbookContext.NovMode;this.LO.Doe(this.sFf);this.LO.Coe(this.Rnc);this.LO.Eoe(this.Snc);this.qM.Doe(this.Zvf);this.qM.Coe(this.Rnc);this.qM.Eoe(this.Snc);for(const wb of this.gridView.Cn)y.a.instance.ra(v.a.Cf,wb.domElement,this.Fzf),y.a.instance.ra(v.a.ue,wb.domElement,this.Ezf);lb.view.Xs(this.Hw);lb.Xb.Vk(this.eLe);lb.ob.Enb(this.$ya);lb.nVc(this.Nvf);
Gb.LA(this.Nrc);lb.Uu(this.Nrc);this.ha.cY(this.Dg);this.ha.s2(this.Fp);lb.rC(this.Bn);this.ha.GZb(this.xzf);L.a.Moe(this.bFb);m.TaskExtensions.Aa(l.GetServiceTaskFactory.Sa(Gb.da,376,377,0),wb=>{wb.result.GIg(this.tFf)},Gb.la,3)}get gridView(){return this.rq}dispose(){U.a.qc([this.LO,this.qM]);this.LO.NRf(this.sFf);this.LO.MRf(this.Rnc);this.LO.ORf(this.Snc);this.qM.NRf(this.Zvf);this.qM.MRf(this.Rnc);this.qM.ORf(this.Snc);for(var fb of this.gridView.Cn)y.a.instance.Ba(v.a.Cf,fb.domElement,this.Fzf),
y.a.instance.Ba(v.a.ue,fb.domElement,this.Ezf);this.gridView.view.Zq(this.Hw);this.gridView.Xb.Ak(this.eLe);this.gridView.ob.eJb(this.$ya);this.gridView.cKd(this.Nvf);this.gridView.$.LD(this.Nrc);this.gridView.xy(this.Nrc);this.ha.kW(this.Dg);this.ha.W6(this.Fp);this.gridView.MD(this.Bn);this.ha.ctc(this.xzf);L.a.VRf(this.bFb);this.zba&&w.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(fb=this.gridView.$.da.za(376))&&fb.qdj(this.tFf);super.dispose()}KSa(){if(!this.dba.range||
!this.dba.range.equals(this.Lcb))return!1;const fb=!this.gridView.UMa();return this.gridView.eb&&fb&&(this.Lcb.isRow||this.Lcb.gf)?!1:this.zba?!0:3===L.a.Gb}w4(){this.kob&&(this.LO.set_visible(!1),this.qM.set_visible(!1),this.kob=!1)}Sna(){if(this.KSa()){this.XSj();var fb=z.DOMElementExtensions.getBoundingClientRect(this.Hpb);fb||w.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.Fgf,this.mXc,this.gridView.zj,this.gridView.ib.tj);var ec=z.DOMElementExtensions.getBoundingClientRect(this.lmj),lb=new Sys.UI.Bounds(ec.x-fb.x,ec.y-fb.y,ec.width,ec.height),ac=this.Lcb,Gb=ac.topLeft,wb=ac.bottomRight,qc=ac.isRow||ac.gf;if(ac.gf){var Ya=this.wBh();ac=lb.x-2*na.tvb(this.gridView);var xb=Ya;var wc=lb.x+ec.width}else ac.isRow?(ac=wc=this.vBh(),xb=lb.y-2*na.tvb(this.gridView),Ya=lb.y+ec.height):(xb=lb.y,Ya=lb.y+ec.height,this.gridView.rtl?
(ac=lb.x+ec.width,wc=lb.x):(ac=lb.x,wc=lb.x+ec.width));ec=na.Iwd+(qc?0:na.tvb(this.gridView));this.LO.style.left=H.HelperMethods.pc(ac-ec);this.LO.style.top=H.HelperMethods.pc(xb-ec);this.qM.style.left=H.HelperMethods.pc(wc-ec);this.qM.style.top=H.HelperMethods.pc(Ya-ec);this.LO.set_visible(this.dff(xb,ac,Gb,qc,fb));this.qM.set_visible(this.dff(Ya,wc,wb,qc,fb));this.kob=!0}}dff(fb,ec,lb,ac,Gb){const wb=z.DOMElementExtensions.getBoundingClientRect(this.gridView.Hf(this.paneType).domElement);Gb=new Sys.UI.Bounds(wb.x-
Gb.x-3,wb.y-Gb.y-3,wb.width+6,wb.height+6);return(this.gridView.ib.Oi(lb)===this.paneType||ac)&&X.a.lN(Gb,new Sys.UI.Point(ec,fb))}XSj(){if(this.Fgf!==this.mXc){this.Hpb=null;const fb=this.hbd();this.LO.Xeg(fb);this.qM.Xeg(fb)}}wBh(){return(this.gridView.view.visibleArea.height+this.gridView.ib.height+na.Iwd-na.tvb(this.gridView))/2}vBh(){return(this.gridView.view.visibleArea.width+this.gridView.ib.width+na.Iwd-na.tvb(this.gridView))/2}EDf(){this.Sna()}Ihi(fb){return z.DOMElementExtensions.Bcb(fb.Db,
D.a.lp)&&(this.Hii(fb)||this.Iii(fb))}Iii(fb){if(this.gridView.rtl)fb=fb.clientPoint.x;else{const ec=z.DOMElementExtensions.getBoundingClientRect(fb.Db);fb=fb.clientPoint.x-(ec.x+ec.width-R.a.xu)}return 0<fb&&fb<=R.a.xu}Hii(fb){const ec=z.DOMElementExtensions.getBoundingClientRect(fb.Db);fb=fb.clientPoint.y-(ec.y+ec.height-R.a.xu);return 0<fb&&fb<=R.a.xu}Gzf(fb,ec){this.zba&&w.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.D_c(fb,ec,this.zba);
this.w4()}Poj(){this.zba||(w.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.zba=!0,this.LO.PZf(),this.qM.PZf(),this.gridView.ha.sourceRange=this.gridView.ha.sa.Xc,this.Sna())}tZd(){this.zba&&(w.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.zba=!1,this.LO.ldg(),this.qM.ldg())}hbd(){this.Hpb||(this.mXc=!1,this.Hpb=this.gridView.zj);return this.Hpb}}Object(b.a)(P,"SelectionTouchGrippiesBehaviorBase",G,[]);class ka extends P{constructor(fb,
ec,lb,ac){super(fb,ec,lb,ac)}get z4(){return 19}get Lcb(){return this.gridView.ha.sa.activeRange}KSa(){const fb=this.gridView.Fi||this.gridView.eb;return!this.gridView.ha.sa.Bg&&!fb&&super.KSa()}}Object(b.a)(ka,"DiscontinuousSelectionTouchGrippiesBehavior",P,[]);var pa=a(176);class Na extends G{constructor(fb){super(fb);const ec=document.createElement("div");ec.className=da.a.Dwh;fb.appendChild(ec)}}Object(b.a)(Na,"SelectionBorderBehavior",G,[]);class Z{}Z.iwh="ewr-selection-draghandle";Z.nwh="ewr-selection-draghandle-grab";
Z.ywh="ewr-selection-draghandle-top-ie";Z.zwh="ewr-selection-draghandle-top-ie-enhanced";Z.wwh="ewr-selection-draghandle-top";Z.xwh="ewr-selection-draghandle-top-enhanced";Z.lwh="ewr-selection-draghandle-bottom-ie";Z.mwh="ewr-selection-draghandle-bottom-ie-enhanced";Z.jwh="ewr-selection-draghandle-bottom";Z.kwh="ewr-selection-draghandle-bottom-enhanced";Z.qwh="ewr-selection-draghandle-left-ie";Z.rwh="ewr-selection-draghandle-left-ie-enhanced";Z.owh="ewr-selection-draghandle-left";Z.pwh="ewr-selection-draghandle-left-enhanced";
Z.uwh="ewr-selection-draghandle-right-ie";Z.vwh="ewr-selection-draghandle-right-ie-enhanced";Z.swh="ewr-selection-draghandle-right";Z.twh="ewr-selection-draghandle-right-enhanced";Z.JRe="ewr-selection-dragtooltip";Z.KRe="ewr-selection-dragtooltip-updated";Z.Kwh="ewr_selection_rearrangeleft";Z.Lwh="ewr_selection_rearrangeright";Z.Mwh="ewr_selection_rearrangetop";Z.Jwh="ewr_selection_rearrangebottom";Z.selecting="selecting";Z.Nwh="ewr-selection-resizemarqueehandle";Z.Qwh="ewr-selection-resizemarqueehandle-topleft";
Z.Rwh="ewr-selection-resizemarqueehandle-topright";Z.Owh="ewr-selection-resizemarqueehandle-bottomleft";Z.Pwh="ewr-selection-resizemarqueehandle-bottomright";Z.Zvh="ewr-marquee-thick";Z.cwh="ewr-resizemarqueehandle-thick";Object(b.a)(Z,"CssClassNames",null,[]);var Ra=a(248),Da=a(21);class Ba extends Na{constructor(fb,ec,lb,ac){super(fb);this.tTa=!1;this.Ble=this.Cle=null;this.Kra=0;this.Zh=ta.EwaSettings.getBooleanFeatureGate(pa.a.x7b,!1);this.fhi=ta.EwaSettings.getBooleanFeatureGate(pa.a.ajh,!1);
this.rDc=this.lec=this.TE=0;this.Kw=this.hb=this.sourceRange=this.Ema=null;this.Mf=Gb=>{Gb=K.a(this.$).Vd(Gb);return this.mCd(Gb)};this.onPointerDown=Gb=>{Gb=K.a(this.$).Vd(Gb);if(2===Gb.tb&&Gb.ao===Sys.UI.MouseButton.leftButton&&!this.tTa){var wb=this.hcc(Gb);if(!wb)return w.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;this.hb=wb.clone();this.sourceRange=this.hb.clone();this.Ema=this.hb;if(wb=this.SSh(Gb))this.nh=5,this.rDc=wb.top-this.sourceRange.top,
this.lec=wb.left-this.sourceRange.left,Da.g(this.$).Ff.dm(this.Zh?Ba.TIa:Ba.F7c),this.Boc(Gb),this.tTa=!0,Ra.b(this.$,!0)}return!1};this.Jh=Gb=>{Gb=K.a(this.$).Vd(Gb);if(this.Zh&&this.Eoc(Gb))return!0;if(Gb=this.ha.eo(Gb.clientPoint,Gb.Db,5,void 0,void 0,!0)){Gb=this.wha(Gb);if(this.hb.equals(Gb))return!0;this.hb=Gb;if(!this.Ky())return w.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.aub(!0),!1}return!0};this.dd=(Gb,wb)=>{wb.pN||
(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")?this.HAa(this.$.isEditMode&&this.Pna()):this.HAa(this.$.isEditMode))};this.Yr=[];this.$=ec;this.ha=Da.g(this.$).ha;this.paneType=lb;this.to=ac;ec=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ec=this.fhi?ec?[Z.xwh,Z.kwh,Z.pwh,Z.twh]:[Z.zwh,Z.mwh,Z.rwh,Z.vwh]:ec?[Z.wwh,Z.jwh,Z.owh,Z.swh]:[Z.ywh,Z.lwh,Z.qwh,Z.uwh];for(const Gb of ec)ec=this.to.HEe(fb,Gb,this.Zh?[Z.nwh]:[Z.iwh],this.onPointerDown),
this.Yr.push(ec);this.$.kl(this.dd);ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")||this.HAa(this.$.isEditMode)}get ob(){return Da.g(this.$).ob}get nh(){return this.ha.selectionType}set nh(fb){this.ha.selectionType=fb}dispose(){this.Yr.forEach(fb=>{r.a.instance.Ba(v.a.pointerDown,fb,this.onPointerDown)});this.Yr.length=0;this.Ema=this.sourceRange=this.hb=null;w.ULS.sendTraceTag(537159381,0,50,`DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = ${this.Kra}, EwaControl is null : ${!this.$}`);
this.$&&(this.$.Hl(this.dd),1===this.Kra&&(w.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.jt(this.Ble,this.Cle,!1)));super.dispose()}mCd(fb){if(5!==this.nh)return!1;(fb=this.Yya(fb))||this.aub(!1);Ra.b(this.$,!1);return fb}Qw(fb,ec){w.ULS.shipAssertTag(537159377,0,!this.Kra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Kra+=1;this.Ble=fb;this.Cle=ec;this.to.Qw(fb,
ec,this.fBc())}wha(fb){if(!fb||!this.hb)return w.ULS.shipAssertTag(537159376,0,!!fb,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),w.ULS.shipAssertTag(537159375,0,!!this.hb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;const ec=this.hb.clone();1!==this.TE&&(ec.left=Math.max(fb.left-this.lec,1),ec.right=ec.left+this.sourceRange.width-1);2!==this.TE&&(ec.top=Math.max(fb.top-this.rDc,1),ec.bottom=ec.top+this.sourceRange.height-1);return this.wZa(ec)}jt(fb,
ec,lb=!0,ac=!0){w.ULS.shipAssertTag(537159374,0,1===this.Kra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Kra;this.Zh||Da.g(this.$).Ff.dm(x.a.BQ);this.to.pZd(fb,ec,this.fBc());lb&&this.I0c(ac);this.TE=0;this.tTa=!1}wZa(fb){var ec=Da.g(this.$);let lb=fb;if(ec.ib.s4){if(!ec.Vb(fb.topLeft)){ec=ec.uk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",ec.vH,this.Ema.top!==fb.top?1:2);try{ec.Mk=this.Ema.top<fb.top||this.Ema.left<fb.left,ec.vs(fb.topLeft),
lb=ec.$$cu().range}finally{ec&&ec.dispose()}}lb.right=lb.left+fb.width-1;lb.bottom=lb.top+fb.height-1}return this.Ema=lb}HAa(fb){this.Yr.forEach(ec=>{z.DOMElementExtensions.setVisible(ec,fb)})}SSh(fb){const ec=fb.Db;fb=fb.clientPoint;if(!ec||!fb)return w.ULS.shipAssertTag(537159373,0,!!ec,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159372,0,!!fb,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;fb.y+=ec===this.Yr[Ba.SIa]?
2:ec===this.Yr[Ba.I7c]?-2:0;fb.x+=ec===this.Yr[Ba.J7c]?2:ec===this.Yr[Ba.RIa]?-2:0;return this.ha.eo(fb,ec,5,void 0,void 0,!0)}}Ba.F7c="move";Ba.c1a="copy";Ba.TIa="grabbing";Ba.SIa=0;Ba.I7c=1;Ba.J7c=2;Ba.RIa=3;Object(b.a)(Ba,"DragSelectionClickBehaviorBase",Na,[]);class ea extends Ba{constructor(fb,ec,lb,ac,Gb,wb){super(fb,ec,lb,Gb);this.Ya=this.hG=null;this.U6e=()=>{this.aub(!0)};ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.HAa(this.Pna()&&this.$.isEditMode);
this.gridView=Da.g(this.$);this.NF=ac;this.coloredReferencesManager=this.$.da.za(281);w.ULS.shipAssertTag(537159391,0,!!this.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.zz=I.a.zz(this.$))fb=this.$.da.za(464),w.ULS.shipAssertTag(512312961,0,!!fb,"DragMarqueeClickBehavior Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.nz=fb.nz;
for(const qc of this.Yr)r.a.instance.ra(v.a.TV,qc,this.NF.k$e),r.a.instance.ra(v.a.sy,qc,this.NF.l$e);this.vZa(wb)}vZa(fb){this.to.HLb(fb,this.Yr);this.NF.iAa()}Boc(fb){w.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.ZLa=!0;this.Ya.BC(!1);this.nh=5;this.NF.IKe(fb.Db);this.Ya.textBox.removeSelection();this.Ya.QZb(this.U6e);this.Qw(this.Jh,this.Mf);this.TE=this.sourceRange.isRow?1:this.sourceRange.gf?2:0}Yya(){const fb=
this.kG();this.nh=-1;this.jt(this.Jh,this.Mf);return fb}I0c(){this.gridView.ZLa=!1;this.NF.JKe(this.Yr[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.ntc(this.U6e);this.to.gOf()}aub(fb){w.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");fb&&this.jt(this.Jh,this.Mf)}hcc(fb){this.Ya=this.to.bac();this.hG=this.to.n3e(fb);return this.Ya&&this.hG&&this.hG.range?this.hG.range:(w.ULS.shipAssertTag(537159388,
0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),w.ULS.shipAssertTag(537159387,0,!!this.hG,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),w.ULS.shipAssertTag(537159386,0,!!this.hG.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)}kG(){return this.hG?this.zz?this.nz.yDb(this.Ya,this.hG,this.hb):this.coloredReferencesManager.yDb(this.Ya,this.hG,this.hb):(w.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),
!1)}Ky(){return this.kG()}fBc(){return!0}Eoc(){return!1}Pna(){return!0}}Object(b.a)(ea,"DragMarqueeClickBehavior",Ba,[]);var Y=a(85),ja=a(108),ca=a(173),ba=a(414),ua=a(14),wa=a(224),ia=a(24),xa=a(762),gb=a(43),va=a(515),sa=a(171),ab=a(708),Ua=a(116),nb=a(29),Ha=a(281),sb=a(61);const Qb=(fb,ec,lb,ac,Gb,wb,qc,Ya=null)=>{Ya=fb.Na(41,Ya);Ya.sourceRange=ec;Ya.destinationRange=lb;return sb.g(fb,"RearrangeRowColumn",Ya,ac,Gb,wb,qc,0)},mb=(fb,ec,lb,ac,Gb,wb,qc=null)=>{qc=fb.Na(1,qc);qc.moveRange=ec;return sb.g(fb,
"MoveLineItems",qc,lb,ac,Gb,wb,0)};class Pb{constructor(fb,ec){this.destinationRange=this.sourceRange=null;this.sourceRange=fb;this.destinationRange=ec}}Object(b.a)(Pb,"MacroRecorderTableRowColumnRearrangedPayload",null,[115]);var gc=a(42);class Xb extends Ba{constructor(fb,ec,lb,ac,Gb){super(fb,ec,lb,Gb);this.pia=ua.a.instance.ga(2265);this.Vsb=ua.a.instance.ga(2266);this.Mna=ua.a.instance.ga(2267);this.cMb=ua.a.instance.ga(2268);this.cA=this.Ph=null;this.Nq=this.gf=this.isRow=this.Oq=!1;this.sO=
this.FM=null;this.Tn=this.pBb=0;this.onKeyDown=wb=>{if(this.Zh){if(this.N4(wb)||wb.Ca.keyCode===Y.a.Jea)return this.W4||(ja.KeyInputManager.instance.ra(v.a.Ed,this.domElement.ownerDocument.body,this.onKeyUp),this.W4=!0),!this.nu&&this.N4(wb)&&(Da.g(this.$).Ff.dm(Xb.c1a),this.nu=!0),this.ou||wb.Ca.keyCode!==Y.a.Jea||(Da.g(this.$).Ff.dm(Ba.TIa),this.ou=!0,2===this.Tn?(this.Bx(!1),this.TE=0,this.Ph=this.Nq?[11]:[12],this.Oq=this.Nq,this.GQa(),this.VI()):3===this.Tn?(this.U2(!1),this.TE=this.isRow?1:
2,this.bO(),this.Ky()):1===this.Tn&&(this.Cha(!1),this.bO(),this.Ky())),!0}else if(!this.nu&&(wb.Ca.keyCode===Y.a.Z7||u.a.isMac&&wb.Ca.keyCode===Y.a.Qoa))return ja.KeyInputManager.instance.ra(v.a.Ed,this.domElement.ownerDocument.body,this.onKeyUp),Da.g(this.$).Ff.dm(Xb.c1a),this.nu=!0;return!1};this.onKeyUp=wb=>{if(this.Zh){if(this.N4(wb)||wb.Ca.keyCode===Y.a.Jea)return this.pBb=this.N4(wb)?0:1,this.zp&&Da.g(this.$).Ff.dm(Ba.TIa),wb.Ca.keyCode===Y.a.Jea&&(2===this.Tn?(this.U2(!1),this.TE=0,this.bO(!0),
this.Ky(!0)):3===this.Tn?(this.Bx(!1),this.TE=this.isRow?1:2,this.Ph=this.isRow?[11]:[12],this.GQa(!0),this.VI(!0)):1===this.Tn&&(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Wza(!0),this.VI(!0))),this.Ioa(this.pBb),!0}else if(wb.Ca.keyCode===Y.a.Z7||u.a.isMac&&wb.Ca.keyCode===Y.a.Qoa)return this.Ioa(),this.zp&&Da.g(this.$).Ff.dm(Ba.F7c),!0;return!1};this.SK=wb=>{wb=K.a(this.$).Vd(wb);5===this.nh?this.mCd(wb):(this.zp=!1,this.ob.Pg(this.Ph),!this.$.Sp([this.hb],!1)||this.fId()||this.bAb()||(this.ha.sourceRange=
this.sourceRange.clone(),this.Zh?this.BGd():this.Ttb(),this.hy()?this.hb.top>this.sourceRange.top&&(wb=this.hb.height,this.hb.top-=wb,this.hb.bottom-=wb):this.hb.left>this.sourceRange.left&&(wb=this.hb.width,this.hb.left-=wb,this.hb.right-=wb),this.kG()));this.jt(this.RK,this.SK);this.tableRange=null;this.nh=-1;this.Zh&&(this.cA=null,this.Tn=0);return!0};this.m6=()=>{this.zp=!1;this.Tn=0;this.ob.Pg(this.Ph);if(!this.$.Sp([this.hb],!1))return this.jt(this.l6,this.m6),this.nh=-1,!0;if(!(this.ha.sa.Xc.equals(this.hb)||
this.qba(this.hb)||this.qba(this.sourceRange)||this.bAb()||(this.kG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,[x.a.y7b]:!0,[x.a.z7b]:this.Oq,[x.a.tU]:this.ha.sourceRange,[x.a.sU]:this.ha.sa.Xc,[x.a.QIa]:this.ou}),this.nu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Oq)){var wb=this.hb.height;this.hb.top-=wb;this.hb.bottom-=wb}else this.hb.left>this.sourceRange.left&&(this.gf||this.hb.top===this.sourceRange.top&&
!this.Oq)&&(wb=this.hb.width,this.hb.left-=wb,this.hb.right-=wb);this.kG()}this.jt(this.l6,this.m6);this.cA=this.tableRange=null;this.nh=-1;this.Oq=!1;return!0};this.RK=wb=>{var qc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");qc&&(wb=K.a(this.$).Vd(wb));var Ya=wb.clientPoint;qc||(wb=K.a(this.$).Vd(wb));this.Zh&&(this.Kw=wb);if(wb=this.ha.eo(Ya,wb.Db,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){qc=Da.g(this.$);const wc=qc.dg(wb);var xb=qc.Hf(this.paneType);
Ya=ab.a.Js(xb.view.Uh,this.domElement.parentNode,Ya,qc.rtl);xb=!1;let Oc=2;this.hy()&&Ya.y-wc.topLeft.y>wc.height/2?(xb=!0,Oc=1):!this.hy()&&Ya.x-wc.topLeft.x>wc.width/2&&(xb=!0);if(xb){qc=qc.uk("DragSelectionClickBehavior.OnPointerMoveRearrange",qc.vH,Oc);try{qc.vs(wb),qc.$$mn(),wb=qc.$$cu().range}finally{qc&&qc.dispose()}}this.hb=this.K2(wb);this.ha.sourceRange=this.hb;this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.ob.Pg(this.kB());if(6!==this.nh){for(wb=1;4>=wb;wb++)qc=this.Th[wb.toString()],
qc.parentNode.removeChild(qc),this.ob.nv(this.hy()?11:12,wb).wf.appendChild(qc);this.nh=6}}else if(this.hb=this.wha(wb),this.Zh)this.Wwb(!1);else if(this.ob.zi(this.hb,this.kB()),this.ob.Jn(this.kB()),this.ob.Pg(this.Ph),5!==this.nh){for(wb=1;4>=wb;wb++)qc=this.Th[wb.toString()],qc.parentNode.removeChild(qc),this.ob.nv(this.Haa(),wb).wf.appendChild(qc);this.nh=5}this.Gy()}return!0};this.l6=wb=>{var qc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");qc&&(wb=K.a(this.$).Vd(wb));
var Ya=wb.clientPoint;qc||(wb=K.a(this.$).Vd(wb));this.Kw=wb;if(qc=this.ha.eo(Ya,wb.Db,5,void 0,void 0,!0)){if(this.jxb(qc))return this.hb=this.wha(qc),this.Vwb(!1),!0;var xb=Da.g(this.$),wc=xb.dg(qc),Oc=xb.Hf(this.paneType);Ya=ab.a.Js(Oc.view.Uh,this.domElement.parentNode,Ya,xb.rtl);Oc=!1;let Cb=2;this.Oq=!1;if(this.isRow||this.gf){this.isRow&&Ya.y-wc.topLeft.y>wc.height/2?(Oc=!0,Cb=1):this.gf&&Ya.x-wc.topLeft.x>wc.width/2&&(Oc=!0);if(Oc){wb=xb.uk("DragSelectionClickBehavior.OnPointerMoveDragInsert",
xb.vH,Cb);try{wb.vs(qc),wb.$$mn(),qc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.hb=this.wha(qc)}else{Ya.x-wc.topLeft.x===wc.width?(this.Oq=!1,Oc=!0):Ya.y-wc.topLeft.y>wc.height/2&&(this.Oq=Oc=!0,Cb=1);this.cA&&(this.Oq=this.Nq);if(Oc){xb=xb.uk("DragSelectionClickBehavior.OnPointerMoveDragInsert",xb.vH,Cb);try{xb.vs(qc),xb.$$mn(),qc=xb.$$cu().range}finally{xb&&xb.dispose()}}this.ob.Pg(this.Ph);this.Ph=this.Oq?[11]:[12];for(xb=1;4>=xb;xb++)(wc=this.Th[xb.toString()])&&wc.parentNode.removeChild(wc),
this.Th[xb.toString()]=null;this.Zz(wb.clientPoint,wb.Db,this.Oq?11:12,!0);this.hb=this.K2(qc)}this.ha.sourceRange=this.hb;this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.ob.Pg(this.kB());if(6!==this.nh){for(wb=1;4>=wb;wb++)qc=this.Th[wb.toString()],qc.parentNode.removeChild(qc),this.ob.nv(this.isRow||this.Oq?11:12,wb).wf.appendChild(qc);this.nh=6}this.Gy()}return!0};this.Dg=()=>{this.domElement.classList.remove(Z.selecting)};this.Fp=()=>{this.domElement.classList.add(Z.selecting)};this.Vc=()=>
{if(this.$.isEditMode){const wb=this.Pna();this.HAa(wb)}};this.pPa=()=>{this.Zh?this.zp&&5<=this.nh&&(this.tableRange?this.ou?this.Bx(!0):this.Cha(!0):this.ou?this.isRow||this.gf?this.Bx(!0):this.U2(!0):this.isRow||this.gf?this.U2(!0):this.Bx(!0)):this.zp&&5<=this.nh&&(this.tableRange?(this.ob.Pg(this.Ph),this.jt(this.RK,this.SK)):(this.ob.Pg(this.kB()),this.jt(this.Jh,this.Mf)))};this.tableManager=ac;ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.HAa(this.Pna()&&
this.$.isEditMode);this.tableRange=null;this.Th={};this.W4=this.ou=this.nu=this.zp=!1;this.ha.s2(this.Fp);this.ha.cY(this.Dg);this.ha.g_b(this.pPa);this.ha.yE(this.Vc)}dispose(){this.ha&&(this.ha.W6(this.Fp),this.ha.kW(this.Dg),this.ha.JKd(this.pPa),this.ha.tI(this.Vc));if(this.Th)for(let fb=1;4>=fb;fb++)z.DOMElementExtensions.sf(this.Th[fb.toString()]);this.Th=this.Ph=null;this.nu&&this.Ioa();this.Zh&&this.ou&&this.Ioa(1);super.dispose()}Boc(fb){this.Zh&&(this.Kw=fb,this.cA=null,this.Nq=this.isRow=
this.gf=this.Oq=!1,ja.KeyInputManager.instance.ra(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown));this.zp=!0;this.tableRange=this.XZc(this.tableManager.qn(this.sourceRange.topLeft));Da.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.cA=this.tableRange,this.Tn=1,this.Ph=(this.Nq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.Qw(this.RK,this.SK),this.FM=this.pia,this.sO=this.Mna,this.Zz(fb.clientPoint,
fb.Db,this.Nq?11:12,!0,!0),this.VI(!0)):(this.Ph=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.Qw(this.RK,this.SK),this.Zz(fb.clientPoint,fb.Db,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.gf=this.sourceRange.gf,this.isRow||this.gf?(this.Tn=3,this.TE=this.isRow?1:2,this.nh=6,this.Ph=this.isRow?[11]:[12],this.Qw(this.l6,this.m6),this.FM=this.pia,this.sO=this.Mna,this.Zz(fb.clientPoint,
fb.Db,this.isRow?11:12,!0,!0),this.VI(!0)):(this.Tn=2,this.TE=0,this.Qw(this.Jh,this.Mf),this.FM=this.Vsb,this.sO=this.cMb,this.Zz(fb.clientPoint,fb.Db,this.Haa(),!1,!0),this.Ky(!0))):(this.Qw(this.Jh,this.Mf),ja.KeyInputManager.instance.ra(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown),this.TE=this.sourceRange.isRow?1:this.sourceRange.gf?2:0,this.Zz(fb.clientPoint,fb.Db,this.Haa(),!1),this.Ky()))}Yya(){this.zp=!1;this.Zh&&(this.Tn=0);this.ob.Pg(this.kB());if(!this.$.Sp([this.hb],!1))return this.jt(this.Jh,
this.Mf),this.nh=-1,!0;if(this.ha.sa.Xc.equals(this.hb)||this.qba(this.hb)||this.qba(this.sourceRange))this.nh=-1;else{this.kG();this.ha.sourceRange=this.sourceRange.clone();const fb=this.ha.sourceRange,ec=this.ha.sa.Xc;this.Zh?this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,[x.a.tU]:fb,[x.a.sU]:ec,[x.a.QIa]:this.ou}):this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,[x.a.tU]:fb,[x.a.sU]:ec})}!this.Zh&&this.tableRange||this.jt(this.Jh,this.Mf);return!0}I0c(fb){fb&&(ja.KeyInputManager.instance.Ba(v.a.Qb,this.domElement.ownerDocument.body,
this.onKeyDown),this.Zh&&Da.g(this.$).Ff.dm(x.a.BQ),this.zp=!1);for(fb=1;4>=fb;fb++){const ec=this.Th[fb.toString()];ec&&ec.parentNode.removeChild(ec);this.Th[fb.toString()]=null}this.Ph=null}Eoc(fb){const ec=this.ha.eo(fb.clientPoint,fb.Db,5,void 0,void 0,!0);this.Kw=fb;return this.jxb(ec)?(this.hb=this.K2(ec),this.Vwb(!0),!0):this.Fjd(ec)?(this.hb=this.wha(ec),this.Wwb(!0),!0):!1}jxb(fb){return!!this.cA&&1!==this.Tn&&!!fb&&this.cA.contains(fb.topLeft)}Fjd(fb){return!!this.cA&&1===this.Tn&&!!fb&&
!this.cA.contains(fb.topLeft)}Vwb(fb){this.tableRange=this.cA;this.Tn=1;const ec=!this.ou;fb?(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Wza(ec),this.VI(ec)):(this.U2(!1),this.bO(ec),this.Ky(ec))}Wwb(fb){this.tableRange=null;this.Tn=2;const ec=!this.ou;fb?(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Oq=this.Nq,this.GQa(ec),this.VI(ec)):(this.Cha(!1),this.bO(ec),this.Ky(ec))}hcc(){return this.ha.sa.Xc}kG(){this.ha.updateSelection(this.hb,this.hb.topLeft,0);return!0}Ky(fb=!1){this.ob.zi(this.hb,this.kB());
this.ob.Jn(this.kB());this.Gy(fb);return!0}VI(fb=!1){this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.Gy(fb)}aub(){w.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")}fBc(){return!1}Pna(){if(!Da.g(this.$).ha.sa.Bg)return!1;const fb=Da.g(this.$).getRangeInformation(this.ha.sa.Xc);for(const ec of fb)if(Object(ba.a)(wa.PivotTableRange,ec))return!1;return!0}XZc(fb){if(fb&&fb.contains(this.sourceRange)&&!fb.equals(this.sourceRange)){if(fb.aba&&
this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===fb.top){const ec=new ia.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,this.sourceRange.right,!1,!1);if(!ec.equals(fb))return this.sourceRange=ec,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),fb}this.Zh?this.Nq=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right:this.isRow=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right;if(fb.top===this.sourceRange.top&&fb.bottom===
this.sourceRange.bottom||this.hy())return fb}return null}K2(fb){const ec=fb.clone();this.hy()?ec.left=Math.max(fb.left-this.lec,1):ec.top=Math.max(fb.top-this.rDc,1);ec.right=ec.left+this.sourceRange.width-1;ec.bottom=ec.top+this.sourceRange.height-1;return this.wZa(ec)}bAb(){const fb=this.hb.topLeft.Bd(this.sourceRange);return fb||this.Zh&&!this.tableRange?fb:this.hy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+1}fId(){if(this.hy()&&this.hb.left!==this.tableRange.left||
!this.hy()&&this.hb.top!==this.tableRange.top){const fb=nb.a.Yc(1,1,0,918,0,2065438552,"RearrangeInvalidDest");gc.a(this.$).Hr([fb]);return!0}return!1}BGd(){const fb=this.$.Jb.Bc("UserAction","RearrangeRowColumnClientSide"),ec={["CopyPasteTargetType"]:1,["OperationId"]:ca.a.create().toString(),["Stopwatch"]:fb,["DragDropIsShiftKeyDown"]:this.ou,["EncounteredDeploymentErrors"]:!1},lb=this.nu?2:1,ac=this.$.da.za(254);(new Promise((Gb,wb)=>{this.Ttb(qc=>{qc.Errors&&0<qc.Errors.length?wb(new xa.a(22,
qc.Errors)):Gb(!0)},qc=>{qc=Ua.a.ff(qc.data);wb(new xa.a(22,qc))})})).then(()=>{w.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="1"');ac&&ac.Rnf(ec,lb,this.sourceRange,this.hb);return Promise.resolve(!0)},Gb=>{w.ULS.sendTraceTag(537159382,0,10,`DragSelectionClickBehavior.RearrangeRowColumn: ${Gb?copyPasteInfra.getStringifiedError(Gb):"null"}, copyPasteTargetType="${1}"`);return ac?ac.LCf(Gb,ec,lb,this.sourceRange,this.hb):Promise.reject(Gb)})}Ttb(fb=
null,ec=null){const lb={};this.hy()?(lb.FirstRow=this.hb.top-1,lb.FirstColumn=0,lb.DeltaColumn=0,lb.DeltaRow=this.hb.bottom-this.hb.top+1):(lb.FirstRow=0,lb.FirstColumn=this.hb.left-1,lb.DeltaColumn=this.hb.right-this.hb.left+1,lb.DeltaRow=0);lb.LastRow=W.a.Gz;lb.LastColumn=W.a.Aw;lb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Ab.getItemByName(this.$.Ab.oa.name).sheetName;const ac=gb.v(this.sourceRange,this.$),Gb=(qc,Ya,xb)=>Qb(this.$.pa.va,ac,lb,fb?Ha.b(qc,fb):qc,ec?Ha.a(Ya,ec):Ya,xb,null),wb=
()=>new Pb(ac,lb);ta.EwaSettings.$b()?this.$.userOperationManager.Wb(new sa.a(514,0,Gb,64,wb),null):this.$.userOperationManager.Wb(new va.a(514,0,Gb,void 0,wb),null)}qba(fb){fb=Da.g(this.$).getRangeInformation(fb);for(let ec=0,lb=fb.length;ec<lb;++ec)if(Object(ba.a)(wa.PivotTableRange,fb[ec]))return fb=nb.a.Yc(1,0,0,905,0,2105176604,"InsDelCellsPivotTable"),gc.a(this.$).Hr([fb]),!0;return!1}Zz(fb,ec,lb,ac,Gb=!1){var wb=z.DOMElementExtensions.getBoundingClientRect(ec);let qc=ec===this.Yr[Ba.SIa]||
ec===this.Yr[Ba.I7c];if(this.Zh){var Ya=ec===this.Yr[Ba.J7c]||ec===this.Yr[Ba.RIa];this.isRow&&Ya||this.gf&&qc?Ya="100px":(qc=this.isRow||qc,Ya=(qc?Gb?Xb.HXd:Xb.NXd:Gb?Xb.GXd:Xb.KXd)+"px");ec=qc?ec===this.Yr[Ba.SIa]?"top":"bottom":ec===this.Yr[Ba.RIa]?"right":"left";fb=100*(qc?fb.x-wb.x:fb.y-wb.y)/(qc?wb.width:wb.height);for(wb=1;4>=wb;wb++){ac=document.createElement("div");var xb=document.createElement("div");const wc=document.createElement("div");ac.appendChild(xb);ac.appendChild(wc);Gb&&(xb=document.createElement("div"),
ac.appendChild(xb),wc.style.fontWeight="bold");ac.className=Z.KRe;this.Th[wb.toString()]=ac;this.ob.nv(lb,wb).wf.appendChild(ac);ac=this.Th[wb.toString()];ac.style[ec]=Ya;ac.style[qc?"left":"top"]=fb+"%"}}else for(Gb=(qc?-Xb.MXd:-Xb.JXd)+"px",Ya=qc?ec===this.Yr[Ba.SIa]?"top":"bottom":ec===this.Yr[Ba.RIa]||ac?"right":"left",ec=100*(qc?ac?0:fb.x-wb.x:fb.y-wb.y)/(qc?wb.width:wb.height),fb=1;4>=fb;fb++)wb=document.createElement("div"),wb.className=Z.JRe,this.Th[fb.toString()]=wb,this.ob.nv(lb,fb).wf.appendChild(wb),
wb=this.Th[fb.toString()],wb.style[Ya]=Gb,wb.style[qc?"left":"top"]=ec+"%"}Gy(fb=!1){const ec=this.hb.toString();if(this.Zh)for(let lb=1;4>=lb;lb++)this.Th[lb.toString()].childNodes[0].innerText=ec,this.Th[lb.toString()].childNodes[1].innerText=this.FM,fb&&(this.Th[lb.toString()].childNodes[2].innerText=this.sO);else for(fb=1;4>=fb;fb++)this.Th[fb.toString()].innerText=ec}Ioa(fb=0){0===fb?this.nu=!1:1===fb&&(this.ou=!1);this.Zh&&(this.nu||this.ou)||(ja.KeyInputManager.instance.Ba(v.a.Ed,this.domElement.ownerDocument.body,
this.onKeyUp),this.W4=!1)}Bx(fb){this.ob.Pg(this.kB());this.jt(this.Jh,this.Mf,void 0,fb)}U2(fb){this.ob.Pg(this.Ph);this.jt(this.l6,this.m6,void 0,fb)}Cha(fb){this.ob.Pg(this.Ph);this.jt(this.RK,this.SK,void 0,fb)}bO(fb=!1){this.nh=5;this.Qw(this.Jh,this.Mf);this.FM=this.Vsb;this.sO=this.cMb;this.Zz(this.Kw.clientPoint,this.Kw.Db,this.Haa(),!1,fb)}GQa(fb=!1){this.nh=6;this.Qw(this.l6,this.m6);this.FM=this.pia;this.sO=this.Mna;this.Zz(this.Kw.clientPoint,this.Kw.Db,this.isRow||this.Nq?11:12,!0,fb)}Wza(fb=
!1){this.nh=6;this.Qw(this.RK,this.SK);this.FM=this.pia;this.sO=this.Mna;this.Zz(this.Kw.clientPoint,this.Kw.Db,this.hy()?11:12,!0,fb)}N4(fb){return fb.Ca.keyCode===Y.a.Z7||u.a.isMac&&fb.Ca.keyCode===Y.a.Qoa}hy(){return!this.Zh&&this.isRow||this.Zh&&this.Nq}Haa(){return this.Zh?47:6}kB(){return this.Zh?Xb.H7c:Xb.K7c}}Xb.JXd=50;Xb.MXd=25;Xb.KXd=-85;Xb.NXd=-40;Xb.GXd=-120;Xb.HXd=-50;Xb.c1a="copy";Xb.K7c=[6];Xb.H7c=[47];Object(b.a)(Xb,"DragSelectionClickBehavior",Ba,[]);var Ca=a(83);class ra extends Ba{constructor(fb,
ec,lb,ac,Gb){super(fb,ec,lb,Gb);this.Ph=null;this.gf=this.isRow=!1;this.Dg=()=>{this.domElement.classList.remove(Z.selecting)};this.Fp=()=>{this.domElement.classList.add(Z.selecting)};this.Vc=()=>{if(this.$.isEditMode){const wb=this.Pna();this.HAa(wb)}};this.tableManager=ac;ta.EwaSettings.isChangeGateEnabled("OfficeVSO:7062716_ViewToEditFixForDragDrop")&&this.HAa(this.Pna()&&this.$.isEditMode);this.Th={};this.zp=!1;this.ha.s2(this.Fp);this.ha.cY(this.Dg);this.ha.yE(this.Vc)}dispose(){this.ha&&(this.ha.W6(this.Fp),
this.ha.kW(this.Dg),this.ha.JKd(this.pPa),this.ha.tI(this.Vc));if(this.Th)for(let fb=1;4>=fb;fb++)z.DOMElementExtensions.sf(this.Th[fb.toString()]);this.Th=this.Ph=null;super.dispose()}I0c(fb){fb&&(this.Zh&&Da.g(this.$).Ff.dm(x.a.BQ),ja.KeyInputManager.instance.Ba(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown),this.zp=!1);for(fb=1;4>=fb;fb++){const ec=this.Th[fb.toString()];ec&&ec.parentNode.removeChild(ec);this.Th[fb.toString()]=null}this.Ph=null}hcc(){return this.ha.sa.Xc}kG(){this.ha.updateSelection(this.hb,
this.hb.topLeft,0);return!0}Ky(fb=!1){this.ob.zi(this.hb,this.kB());this.ob.Jn(this.kB());this.Gy(fb);return!0}VI(fb=!1){this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.Gy(fb)}aub(){w.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")}fBc(){return!1}Zz(fb,ec,lb,ac,Gb=!1){var wb=z.DOMElementExtensions.getBoundingClientRect(ec);let qc=ec===this.Yr[Ba.SIa]||ec===this.Yr[Ba.I7c];if(this.Zh){var Ya=ec===
this.Yr[Ba.J7c]||ec===this.Yr[Ba.RIa];this.isRow&&Ya||this.gf&&qc?Ya="100px":(qc=this.isRow||qc,Ya=(qc?Gb?ra.HXd:ra.NXd:Gb?ra.GXd:ra.KXd)+"px");ec=qc?ec===this.Yr[Ba.SIa]?"top":"bottom":ec===this.Yr[Ba.RIa]?"right":"left";fb=100*(qc?fb.x-wb.x:fb.y-wb.y)/(qc?wb.width:wb.height);for(wb=1;4>=wb;wb++){ac=document.createElement("div");var xb=document.createElement("div");const wc=document.createElement("div");ac.appendChild(xb);ac.appendChild(wc);Gb&&(xb=document.createElement("div"),ac.appendChild(xb),
wc.style.fontWeight="bold");ac.className=Z.KRe;this.Th[wb.toString()]=ac;this.ob.nv(lb,wb).wf.appendChild(ac);ac=this.Th[wb.toString()];ac.style[ec]=Ya;ac.style[qc?"left":"top"]=fb+"%"}}else for(Gb=(qc?-ra.MXd:-ra.JXd)+"px",Ya=qc?ec===this.Yr[Ba.SIa]?"top":"bottom":ec===this.Yr[Ba.RIa]||ac?"right":"left",ec=100*(qc?ac?0:fb.x-wb.x:fb.y-wb.y)/(qc?wb.width:wb.height),fb=1;4>=fb;fb++)wb=document.createElement("div"),wb.className=Z.JRe,this.Th[fb.toString()]=wb,this.ob.nv(lb,fb).wf.appendChild(wb),wb=
this.Th[fb.toString()],wb.style[Ya]=Gb,wb.style[qc?"left":"top"]=ec+"%"}Qeg(fb,ec,lb){const ac=Da.g(this.$),Gb=ac.dg(fb);var wb=ac.Hf(this.paneType);lb=ab.a.Js(wb.view.Uh,this.domElement.parentNode,lb,ac.rtl);wb=!1;let qc=2;ec&&lb.y-Gb.topLeft.y>Gb.height/2?(wb=!0,qc=1):!ec&&lb.x-Gb.topLeft.x>Gb.width/2&&(wb=!0);if(wb){ec=ac.uk("DragSelectionClickBehaviorTemporary.updateMouseSelectionRange",ac.vH,qc);try{ec.vs(fb),ec.$$mn(),ec.$$cu()}finally{ec&&ec.dispose()}}}Cha(fb){this.ob.Pg(this.Ph);this.jt(this.RK,
this.SK,void 0,fb)}Bx(fb){this.ob.Pg(this.kB());this.jt(this.Jh,this.Mf,void 0,fb)}Haa(){return this.Zh?47:6}kB(){return this.Zh?ra.H7c:ra.K7c}N4(fb){return fb.Ca.keyCode===Y.a.Z7||u.a.isMac&&fb.Ca.keyCode===Y.a.Qoa}qba(fb){fb=Da.g(this.$).getRangeInformation(fb);for(let ec=0,lb=fb.length;ec<lb;++ec)if(Object(ba.a)(wa.PivotTableRange,fb[ec]))return fb=nb.a.Yc(1,0,906,905,0,2105176604,"InsDelCellsPivotTable"),gc.a(this.$).Hr([fb]),!0;return!1}}ra.JXd=50;ra.MXd=25;ra.KXd=-85;ra.NXd=-40;ra.GXd=-120;
ra.HXd=-50;ra.K7c=[6];ra.H7c=[47];Object(b.a)(ra,"DragSelectionClickBehaviorTemporary",Ba,[]);class ma extends ra{constructor(fb,ec,lb,ac,Gb){super(fb,ec,lb,ac,Gb);this.cA=null;this.Nq=this.Oq=!1;this.pBb=0;this.sO=this.FM=null;this.Tn=0;this.pia=ua.a.instance.ga(2265);this.Vsb=ua.a.instance.ga(2266);this.Mna=ua.a.instance.ga(2267);this.cMb=ua.a.instance.ga(2268);this.onKeyDown=wb=>{if(this.Zh){if(this.N4(wb)||wb.Ca.keyCode===Y.a.Jea)return this.W4||(ja.KeyInputManager.instance.ra(v.a.Ed,this.domElement.ownerDocument.body,
this.onKeyUp),this.W4=!0),!this.nu&&this.N4(wb)&&(Da.g(this.$).Ff.dm(Ba.c1a),this.nu=!0),this.ou||wb.Ca.keyCode!==Y.a.Jea||(Da.g(this.$).Ff.dm(Ba.TIa),this.ou=!0,2===this.Tn?(this.Bx(!1),this.TE=0,this.Ph=this.Nq?[11]:[12],this.Oq=this.Nq,this.GQa(),this.VI()):3===this.Tn?(this.U2(!1),this.TE=this.isRow?1:2,this.bO(),this.Ky()):1===this.Tn&&(this.Cha(!1),this.bO(),this.Ky())),!0}else if(!this.nu&&(wb.Ca.keyCode===Y.a.Z7||u.a.isMac&&wb.Ca.keyCode===Y.a.Qoa))return ja.KeyInputManager.instance.ra(v.a.Ed,
this.domElement.ownerDocument.body,this.onKeyUp),Da.g(this.$).Ff.dm(Ba.c1a),this.nu=!0;return!1};this.onKeyUp=wb=>{if(this.Zh){if(this.N4(wb)||wb.Ca.keyCode===Y.a.Jea)return this.pBb=this.N4(wb)?0:1,this.zp&&Da.g(this.$).Ff.dm(Ba.TIa),wb.Ca.keyCode===Y.a.Jea&&(2===this.Tn?(this.U2(!1),this.TE=0,this.bO(!0),this.Ky(!0)):3===this.Tn?(this.Bx(!1),this.TE=this.isRow?1:2,this.Ph=this.isRow?[11]:[12],this.GQa(!0),this.VI(!0)):1===this.Tn&&(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Wza(!0),this.VI(!0))),
this.Ioa(this.pBb),!0}else if(wb.Ca.keyCode===Y.a.Z7||u.a.isMac&&wb.Ca.keyCode===Y.a.Qoa)return this.Ioa(),this.zp&&Da.g(this.$).Ff.dm(Ba.F7c),!0;return!1};this.SK=wb=>{wb=K.a(this.$).Vd(wb);5===this.nh?this.mCd(wb):(this.zp=!1,this.ob.Pg(this.Ph),!this.$.Sp([this.hb],!1)||this.fId()||this.bAb()||(this.ha.sourceRange=this.sourceRange.clone(),this.Zh?this.BGd():this.Ttb(),this.hy()?this.hb.top>this.sourceRange.top&&(wb=this.hb.height,this.hb.top-=wb,this.hb.bottom-=wb):this.hb.left>this.sourceRange.left&&
(wb=this.hb.width,this.hb.left-=wb,this.hb.right-=wb),this.kG()),this.Oud());this.jt(this.RK,this.SK);this.tableRange=null;this.nh=-1;this.Zh&&(this.cA=null,this.Tn=0);return!0};this.m6=()=>{this.zp=!1;this.Tn=0;this.ob.Pg(this.Ph);if(!this.$.Sp([this.hb],!1))return this.jt(this.l6,this.m6),this.nh=-1,!0;if(!(this.ha.sa.Xc.equals(this.hb)||this.qba(this.hb)||this.qba(this.sourceRange)||this.bAb()||(this.kG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,
[x.a.y7b]:!0,[x.a.z7b]:this.Oq,[x.a.tU]:this.ha.sourceRange,[x.a.sU]:this.ha.sa.Xc,[x.a.QIa]:this.ou}),this.nu))){if(this.hb.top>this.sourceRange.top&&(this.isRow||this.hb.left===this.sourceRange.left&&this.Oq)){var wb=this.hb.height;this.hb.top-=wb;this.hb.bottom-=wb}else this.hb.left>this.sourceRange.left&&(this.gf||this.hb.top===this.sourceRange.top&&!this.Oq)&&(wb=this.hb.width,this.hb.left-=wb,this.hb.right-=wb);this.kG()}this.jt(this.l6,this.m6);this.cA=this.tableRange=null;this.nh=-1;this.Oq=
!1;this.Oud();return!0};this.RK=wb=>{const qc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");qc&&(wb=K.a(this.$).Vd(wb));var Ya=wb.clientPoint;qc||(wb=K.a(this.$).Vd(wb));this.Zh&&(this.Kw=wb);if(wb=this.ha.eo(Ya,wb.Db,5,void 0,void 0,!0)){if(this.tableRange.contains(wb.topLeft)){if(this.Qeg(wb,this.hy(),Ya),this.hb=this.K2(wb),this.ha.sourceRange=this.hb,this.ob.zi(this.hb,this.Ph),this.ob.Jn(this.Ph),this.ob.Pg(this.kB()),6!==this.nh){for(Ya=1;4>=Ya;Ya++)wb=
this.Th[Ya.toString()],wb.parentNode.removeChild(wb),this.ob.nv(this.hy()?11:12,Ya).wf.appendChild(wb);this.nh=6}}else if(this.hb=this.wha(wb),this.Zh)this.Wwb(!1);else if(this.ob.zi(this.hb,this.kB()),this.ob.Jn(this.kB()),this.ob.Pg(this.Ph),5!==this.nh){for(Ya=1;4>=Ya;Ya++)wb=this.Th[Ya.toString()],wb.parentNode.removeChild(wb),this.ob.nv(this.Haa(),Ya).wf.appendChild(wb);this.nh=5}this.Gy()}return!0};this.l6=wb=>{var qc=ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");
qc&&(wb=K.a(this.$).Vd(wb));var Ya=wb.clientPoint;qc||(wb=K.a(this.$).Vd(wb));this.Kw=wb;if(qc=this.ha.eo(Ya,wb.Db,5,void 0,void 0,!0)){if(this.jxb(qc))return this.hb=this.wha(qc),this.Vwb(!1),!0;var xb=Da.g(this.$),wc=xb.dg(qc),Oc=xb.Hf(this.paneType);Ya=ab.a.Js(Oc.view.Uh,this.domElement.parentNode,Ya,xb.rtl);Oc=!1;let Cb=2;this.Oq=!1;if(this.isRow||this.gf){this.isRow&&Ya.y-wc.topLeft.y>wc.height/2?(Oc=!0,Cb=1):this.gf&&Ya.x-wc.topLeft.x>wc.width/2&&(Oc=!0);if(Oc){wb=xb.uk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",
xb.vH,Cb);try{wb.vs(qc),wb.$$mn(),qc=wb.$$cu().range}finally{wb&&wb.dispose()}}this.hb=this.wha(qc)}else{Ya.x-wc.topLeft.x===wc.width?(this.Oq=!1,Oc=!0):Ya.y-wc.topLeft.y>wc.height/2&&(this.Oq=Oc=!0,Cb=1);this.cA&&(this.Oq=this.Nq);if(Oc){xb=xb.uk("DragSelectionClickBehaviorCellRangeAndTable.OnPointerMoveDragInsert",xb.vH,Cb);try{xb.vs(qc),xb.$$mn(),qc=xb.$$cu().range}finally{xb&&xb.dispose()}}this.ob.Pg(this.Ph);this.Ph=this.Oq?[11]:[12];for(xb=1;4>=xb;xb++)(wc=this.Th[xb.toString()])&&wc.parentNode.removeChild(wc),
this.Th[xb.toString()]=null;this.Zz(wb.clientPoint,wb.Db,this.Oq?11:12,!0);this.hb=this.K2(qc)}this.ha.sourceRange=this.hb;this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.ob.Pg(this.kB());if(6!==this.nh){for(wb=1;4>=wb;wb++)qc=this.Th[wb.toString()],qc.parentNode.removeChild(qc),this.ob.nv(this.isRow||this.Oq?11:12,wb).wf.appendChild(qc);this.nh=6}this.Gy()}return!0};this.pPa=()=>{this.Zh?this.zp&&5<=this.nh&&(this.tableRange?this.ou?this.Bx(!0):this.Cha(!0):this.ou?this.isRow||this.gf?this.Bx(!0):
this.U2(!0):this.isRow||this.gf?this.U2(!0):this.Bx(!0)):this.zp&&5<=this.nh&&(this.tableRange?(this.ob.Pg(this.Ph),this.jt(this.RK,this.SK)):(this.ob.Pg(this.kB()),this.jt(this.Jh,this.Mf)))};this.tableRange=null;this.W4=this.nu=this.ou=!1;this.ha.g_b(this.pPa)}dispose(){this.nu&&this.Ioa();this.Zh&&this.ou&&this.Ioa(1);super.dispose()}Boc(fb){this.Zh&&(this.Kw=fb,this.cA=null,this.Nq=this.isRow=this.gf=this.Oq=!1,ja.KeyInputManager.instance.ra(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown));
this.zp=!0;this.tableRange=this.XZc(this.tableManager.qn(this.sourceRange.topLeft));Da.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.cA=this.tableRange,this.Tn=1,this.Ph=(this.Nq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.Qw(this.RK,this.SK),this.FM=this.pia,this.sO=this.Mna,this.Zz(fb.clientPoint,fb.Db,this.Nq?11:12,!0,!0),this.VI(!0)):(this.Ph=(this.isRow=this.tableRange.left===this.sourceRange.left&&
this.tableRange.right===this.sourceRange.right)?[11]:[12],this.nh=6,this.Qw(this.RK,this.SK),this.Zz(fb.clientPoint,fb.Db,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.gf=this.sourceRange.gf,this.isRow||this.gf?(this.Tn=3,this.TE=this.isRow?1:2,this.nh=6,this.Ph=this.isRow?[11]:[12],this.Qw(this.l6,this.m6),this.FM=this.pia,this.sO=this.Mna,this.Zz(fb.clientPoint,fb.Db,this.isRow?11:12,!0,!0),this.VI(!0)):(this.Tn=2,this.TE=0,this.Qw(this.Jh,this.Mf),
this.FM=this.Vsb,this.sO=this.cMb,this.Zz(fb.clientPoint,fb.Db,this.Haa(),!1,!0),this.Ky(!0))):(this.Qw(this.Jh,this.Mf),ja.KeyInputManager.instance.ra(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown),this.TE=this.sourceRange.isRow?1:this.sourceRange.gf?2:0,this.Zz(fb.clientPoint,fb.Db,this.Haa(),!1),this.Ky()))}Yya(){this.zp=!1;this.Zh&&(this.Tn=0);this.ob.Pg(this.kB());if(!this.$.Sp([this.hb],!1))return this.jt(this.Jh,this.Mf),this.nh=-1,!0;if(this.ha.sa.Xc.equals(this.hb)||this.qba(this.hb)||
this.qba(this.sourceRange))this.nh=-1;else{this.kG();this.ha.sourceRange=this.sourceRange.clone();const fb=this.ha.sourceRange,ec=this.ha.sa.Xc;this.Zh?this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,[x.a.tU]:fb,[x.a.sU]:ec,[x.a.QIa]:this.ou}):this.$.fd(-694765314,2,30,{[x.a.V$]:this.nu,[x.a.tU]:fb,[x.a.sU]:ec})}!this.Zh&&this.tableRange||this.jt(this.Jh,this.Mf);this.Oud();return!0}Eoc(fb){const ec=this.ha.eo(fb.clientPoint,fb.Db,5,void 0,void 0,!0);this.Kw=fb;return this.jxb(ec)?(this.hb=this.K2(ec),
this.Vwb(!0),!0):this.Fjd(ec)?(this.hb=this.wha(ec),this.Wwb(!0),!0):!1}Gy(fb=!1){const ec=this.hb.toString();if(this.Zh)for(let lb=1;4>=lb;lb++)this.Th[lb.toString()].childNodes[0].innerText=ec,this.Th[lb.toString()].childNodes[1].innerText=this.FM,fb&&(this.Th[lb.toString()].childNodes[2].innerText=this.sO);else for(fb=1;4>=fb;fb++)this.Th[fb.toString()].innerText=ec}jxb(fb){return!!this.cA&&1!==this.Tn&&!!fb&&this.cA.contains(fb.topLeft)}Fjd(fb){return!!this.cA&&1===this.Tn&&!!fb&&!this.cA.contains(fb.topLeft)}Vwb(fb){this.tableRange=
this.cA;this.Tn=1;const ec=!this.ou;fb?(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Wza(ec),this.VI(ec)):(this.U2(!1),this.bO(ec),this.Ky(ec))}Wwb(fb){this.tableRange=null;this.Tn=2;const ec=!this.ou;fb?(this.Bx(!1),this.Ph=this.Nq?[11]:[12],this.Oq=this.Nq,this.GQa(ec),this.VI(ec)):(this.Cha(!1),this.bO(ec),this.Ky(ec))}Pna(){if(!Da.g(this.$).ha.sa.Bg)return!1;const fb=Da.g(this.$).getRangeInformation(this.ha.sa.Xc);for(const ec of fb)if(Object(ba.a)(wa.PivotTableRange,ec))return!1;return!0}XZc(fb){if(fb&&
fb.contains(this.sourceRange)&&!fb.equals(this.sourceRange)){if(fb.aba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===fb.top){const ec=new ia.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,this.sourceRange.right,!1,!1);if(!ec.equals(fb))return this.sourceRange=ec,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),fb}this.Zh?this.Nq=fb.left===this.sourceRange.left&&fb.right===this.sourceRange.right:this.isRow=fb.left===this.sourceRange.left&&fb.right===
this.sourceRange.right;if(fb.top===this.sourceRange.top&&fb.bottom===this.sourceRange.bottom||this.hy())return fb}return null}K2(fb){const ec=fb.clone();this.hy()?ec.left=Math.max(fb.left-this.lec,1):ec.top=Math.max(fb.top-this.rDc,1);ec.right=ec.left+this.sourceRange.width-1;ec.bottom=ec.top+this.sourceRange.height-1;return this.wZa(ec)}bAb(){const fb=this.hb.topLeft.Bd(this.sourceRange);return fb||this.Zh&&!this.tableRange?fb:this.hy()?this.hb.top===this.sourceRange.bottom+1:this.hb.left===this.sourceRange.right+
1}fId(){if(this.hy()&&this.hb.left!==this.tableRange.left||!this.hy()&&this.hb.top!==this.tableRange.top){const fb=nb.a.Yc(1,1,0,918,0,2065438552,"RearrangeInvalidDest");gc.a(this.$).Hr([fb]);return!0}return!1}BGd(){const fb=this.$.Jb.Bc("UserAction","RearrangeRowColumnClientSide"),ec={["CopyPasteTargetType"]:1,["OperationId"]:ca.a.create().toString(),["Stopwatch"]:fb,["DragDropIsShiftKeyDown"]:this.ou,["EncounteredDeploymentErrors"]:!1},lb=this.nu?2:1,ac=this.$.da.za(254);(new Promise((Gb,wb)=>{this.Ttb(qc=>
{qc.Errors&&0<qc.Errors.length?wb(new xa.a(22,qc.Errors)):Gb(!0)},qc=>{qc=Ua.a.ff(qc.data);wb(new xa.a(22,qc))})})).then(()=>{w.ULS.sendTraceTag(520747156,0,50,'DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: success. copyPasteTargetType="1"');ac&&ac.Rnf(ec,lb,this.sourceRange,this.hb);return Promise.resolve(!0)},Gb=>{w.ULS.sendTraceTag(520747155,0,10,`DragSelectionClickBehaviorCellRangeAndTable.RearrangeRowColumn: ${Gb?copyPasteInfra.getStringifiedError(Gb):"null"}, copyPasteTargetType="${1}"`);
return ac?ac.LCf(Gb,ec,lb,this.sourceRange,this.hb):Promise.reject(Gb)})}Ttb(fb=null,ec=null){const lb={};this.hy()?(lb.FirstRow=this.hb.top-1,lb.FirstColumn=0,lb.DeltaColumn=0,lb.DeltaRow=this.hb.bottom-this.hb.top+1):(lb.FirstRow=0,lb.FirstColumn=this.hb.left-1,lb.DeltaColumn=this.hb.right-this.hb.left+1,lb.DeltaRow=0);lb.LastRow=W.a.Gz;lb.LastColumn=W.a.Aw;lb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Ab.getItemByName(this.$.Ab.oa.name).sheetName;const ac=gb.v(this.sourceRange,this.$),Gb=
(qc,Ya,xb)=>Qb(this.$.pa.va,ac,lb,fb?Ha.b(qc,fb):qc,ec?Ha.a(Ya,ec):Ya,xb,null),wb=()=>new Pb(ac,lb);ta.EwaSettings.$b()?this.$.userOperationManager.Wb(new sa.a(514,0,Gb,64,wb),null):this.$.userOperationManager.Wb(new va.a(514,0,Gb,void 0,wb),null)}Ioa(fb=0){0===fb?this.nu=!1:1===fb&&(this.ou=!1);this.Zh&&(this.nu||this.ou)||(ja.KeyInputManager.instance.Ba(v.a.Ed,this.domElement.ownerDocument.body,this.onKeyUp),this.W4=!1)}bO(fb=!1){this.nh=5;this.Qw(this.Jh,this.Mf);this.FM=this.Vsb;this.sO=this.cMb;
this.Zz(this.Kw.clientPoint,this.Kw.Db,this.Haa(),!1,fb)}GQa(fb=!1){this.nh=6;this.Qw(this.l6,this.m6);this.FM=this.pia;this.sO=this.Mna;this.Zz(this.Kw.clientPoint,this.Kw.Db,this.isRow||this.Nq?11:12,!0,fb)}Wza(fb=!1){this.nh=6;this.Qw(this.RK,this.SK);this.FM=this.pia;this.sO=this.Mna;this.Zz(this.Kw.clientPoint,this.Kw.Db,this.hy()?11:12,!0,fb)}hy(){return!this.Zh&&this.isRow||this.Zh&&this.Nq}U2(fb){this.ob.Pg(this.Ph);this.jt(this.l6,this.m6,void 0,fb)}Oud(){const fb=Ca.a.instance.Ub("Common.ISystemInitiatedFeedback");
fb&&fb.execute(ec=>{ec.logActivity("DragDrop",null)})}}Object(b.a)(ma,"DragSelectionClickBehaviorCellRangeAndTable",ra,[]);var hb=a(317),vb=a(145);class Va extends ra{constructor(fb,ec,lb,ac,Gb){super(fb,ec,lb,ac,Gb);this.pPa=()=>{this.zp&&this.Cha(!0);5===this.nh&&this.Bx(!0)};this.SK=wb=>{K.a(this.$).Vd(wb);this.zp=!1;this.ob.Pg(this.Ph);this.ha.sourceRange=this.sourceRange.clone();this.oif?this.$.fd(927125067,L.a.Gb,30,null):this.w6a?(this.kG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.fd(-694765314,
2,30,{[x.a.V$]:!0,[x.a.tU]:this.ha.sourceRange,[x.a.sU]:this.ha.sa.Xc,[x.a.QIa]:!1}),Da.g(this.$).Ff.dm(x.a.BQ),this.w6a=!1):this.w1i();this.jt(this.RK,this.SK);this.nh=-1;return!0};this.RK=wb=>{wb=K.a(this.$).Vd(wb);const qc=wb.clientPoint;this.Kw=wb;let Ya=this.ha.eo(qc,wb.Db,5,void 0,void 0,!0);if(Ya){if(!this.Fqd(Ya))return this.C2h(wb),!0;this.Qeg(Ya,this.isRow,qc);if(this.isRow||this.gf)this.hb=this.K2(Ya);this.ha.sourceRange=this.hb;this.ob.zi(this.hb,this.Ph);this.ob.Jn(this.Ph);this.ob.Pg(this.kB());
this.Gy()}return!0};this.onKeyDown=wb=>this.N4(wb)?(this.W4||(ja.KeyInputManager.instance.ra(v.a.Ed,this.domElement.ownerDocument.body,this.onKeyUp),this.W4=!0),this.w6a||(Da.g(this.$).Ff.dm(Ba.c1a),this.w6a=!0),!0):!1;this.onKeyUp=wb=>{this.N4(wb)&&(ja.KeyInputManager.instance.Ba(v.a.Ed,this.domElement.ownerDocument.body,this.onKeyUp),this.W4=!1,this.zp?Da.g(this.$).Ff.dm(Ba.TIa):Da.g(this.$).Ff.dm(x.a.BQ),this.w6a=!1);return!0};this.rBf=wb=>{wb.Errors&&0<wb.Errors.length?(w.ULS.sendTraceTag(521410185,
0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsSuccess: Errors: [${nb.a.xc(wb.Errors)}]`),this.hb.left=this.sourceRange.left,this.hb.right=this.sourceRange.right,this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):this.isRow?this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1?(this.hb.top=this.sourceRange.top,this.hb.bottom=this.sourceRange.bottom):(this.sourceRange.top>this.hb.top||(this.hb.top-=this.sourceRange.height),this.hb.bottom=this.hb.top+
this.sourceRange.height-1):this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1?(this.hb.left=this.sourceRange.left,this.hb.right=this.sourceRange.right):(this.sourceRange.left>this.hb.left||(this.hb.left-=this.sourceRange.width),this.hb.right=this.hb.left+this.sourceRange.width-1);this.kG();this.nh=-1};this.qBf=wb=>{wb=Ua.a.ff(wb.data);w.ULS.sendTraceTag(521410184,0,10,`DragSelectionClickBehaviorPivotTableRange.onMoveLineItemsFail: Errors: [${nb.a.xc(wb)}]`)};this.ha.g_b(this.pPa);
this.w6a=this.W4=!1}Boc(fb){this.Kw=fb;this.isRow=this.gf=!1;this.zp=!0;ja.KeyInputManager.instance.ra(v.a.Qb,this.domElement.ownerDocument.body,this.onKeyDown);(this.lc=this.tableManager.Gja(this.sourceRange))||w.ULS.sendTraceTag(512341332,0,50,"DragSelectionClickBehaviorPivotTableRange.onPointerDownInternal: pivotTableRange null for range {0}",this.sourceRange);this.oif=(new vb.a(this.$.xa)).wi;Da.g(this.$);Da.g(this.$).Ff.dm(Ba.TIa);this.Fqd(this.hb)?(this.isRow=this.mmi(),this.gf=this.ngi(),this.isRow||
this.gf?(this.g7a=!1,this.Wza(fb),this.hb=this.K2(this.hb),this.VI()):(this.g7a=!0,this.bO(fb),this.Ky())):(this.g7a=!0,this.bO(fb),this.Ky())}Yya(){return this.oif?(this.$.fd(927125067,L.a.Gb,30,null),this.Bx(!0),this.g7a=!1,this.nh=-1,!0):this.w6a?(this.kG(),this.ha.sourceRange=this.sourceRange.clone(),this.$.fd(-694765314,2,30,{[x.a.V$]:!0,[x.a.tU]:this.ha.sourceRange,[x.a.sU]:this.ha.sa.Xc,[x.a.QIa]:!1}),Da.g(this.$).Ff.dm(x.a.BQ),this.Bx(!0),this.zp=this.g7a=!1,this.nh=-1,!0):5===this.nh?(this.Bx(!0),
this.g7a=!1,this.Qzj(),this.nh=-1,!0):!1}Eoc(fb){const ec=this.ha.eo(fb.clientPoint,fb.Db,5,void 0,void 0,!0);this.Kw=fb;return this.g7a?!1:this.Fqd(ec)?(this.D2h(fb),!0):!1}Gy(){let fb=new ia.Range(this.hb.top,this.hb.left,this.hb.bottom,this.hb.right,!1,!0);6===this.nh&&(this.isRow?(--fb.top,fb.bottom=fb.top+this.hb.height-1):(--fb.left,fb.right=fb.left+this.hb.width-1));for(let ec=1;4>=ec;ec++)this.Th[ec.toString()].childNodes[0].innerText=fb.toString()}Pna(){if(!Da.g(this.$).ha.sa.Bg)return!1;
var fb=Da.g(this.$).getRangeInformation(this.ha.sa.Xc);for(var ec of fb)if(Object(ba.a)(wa.PivotTableRange,ec)&&(fb=this.tableManager.Gja(ec)))return ec=!fb.isOlap||!fb.tNa(!0),w.ULS.sendTraceTag(512341331,0,50,"DragSelectionClickBehaviorPivotTableRange.shouldShowHandlesOnSelectionChanged: enabling for range {0}",fb),fb.isActionable&&ec;return!1}K2(fb){fb=fb.clone();this.isRow?(fb.left=this.sourceRange.left,fb.right=this.lc.right,fb.bottom=fb.top+this.sourceRange.height-1):this.gf?(fb.top=this.sourceRange.top,
fb.bottom=this.lc.jL.bottom,fb.right=fb.left+this.sourceRange.width-1):w.ULS.sendTraceTag(520176346,0,10,"DragSelectionClickBehaviorPivotTableRange.calculateRearrangeRange: no row/column rearrange");return this.wZa(fb)}w1i(){const fb={},ec=gb.v(this.sourceRange,this.$);Da.g(this.$).getRangeInformation(this.hb);if(this.isRow){ec.FirstColumn=fb.FirstColumn=this.hb.left-1;ec.LastColumn=fb.LastColumn=this.hb.right-1;if(this.sourceRange.top<=this.hb.top&&this.sourceRange.bottom>=this.hb.top-1){w.ULS.sendTraceTag(520176345,
0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}this.sourceRange.top>this.hb.top?fb.LastRow=fb.FirstRow=this.hb.top-1:(fb.FirstRow=this.hb.top-this.sourceRange.height-1,fb.LastRow=fb.FirstRow+this.sourceRange.height-1)}else{fb.FirstRow=this.hb.top;fb.LastRow=this.hb.bottom-1;if(this.sourceRange.left<=this.hb.left&&this.sourceRange.right>=this.hb.left-1){w.ULS.sendTraceTag(520176344,0,50,"DragSelectionClickBehaviorPivotTableRange.processMoveLineItems: no-op");return}fb.LastColumn=
this.sourceRange.left>this.hb.left?fb.FirstColumn=this.hb.left-1:fb.FirstColumn=this.hb.left-this.sourceRange.width-1}const lb={};lb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Ab.getItemByName(this.$.Ab.oa.name).sheetName;lb.Ranges=Array(2);lb.Ranges[0]=ec;lb.Ranges[1]=fb;this.cyh(lb)}cyh(fb){const ec=(lb,ac,Gb)=>mb(this.$.pa.va,fb,this.rBf?Ha.b(lb,this.rBf):lb,this.qBf?Ha.a(ac,this.qBf):ac,Gb,null);ta.EwaSettings.$b()?this.$.userOperationManager.Wb(new sa.a(265,0,ec,64),null):this.$.userOperationManager.Wb(new va.a(265,
0,ec,void 0),null)}Fqd(fb){return null!==this.lc&&(null===this.lc.jL||fb.left>=this.lc.jL.left)&&(null===this.lc.RE||fb.right<=this.lc.RE.right)&&(null===this.lc.RE||fb.top>=this.lc.RE.top)&&(null===this.lc.jL||fb.bottom<=this.lc.jL.bottom)}mmi(){return null!==this.lc&&null!==this.lc.jL&&this.lc.jL.top<=this.hb.top&&this.lc.jL.left<=this.hb.left&&this.lc.jL.right>=this.hb.left}ngi(){return null!==this.lc&&null!==this.lc.RE&&this.lc.RE.top===this.hb.top&&this.lc.RE.left<=this.hb.left&&this.lc.RE.right>=
this.hb.right}Wza(fb){this.nh=6;this.Ph=this.isRow?[11]:[12];this.Qw(this.RK,this.SK);this.Zz(fb.clientPoint,fb.Db,this.isRow?11:12,!0,!1)}bO(fb){this.nh=5;this.Qw(this.Jh,this.Mf);this.Zz(fb.clientPoint,fb.Db,this.Haa(),!1,!1)}D2h(fb){this.Bx(!1);this.Wza(fb);this.hb=this.K2(this.hb);this.VI()}C2h(fb){this.Cha(!1);this.bO(fb);this.Ky()}Qzj(){if(!this.qba(this.hb)){var fb=nb.a.Yc(1,0,908,907,0,2069074184,"PivotTableInvalidMove");fb.HelpTopicId=hb.a.ADj;fb.HelpDescription=ua.a.instance.ga(913);gc.a(this.$).Hr([fb])}}}
Object(b.a)(Va,"DragSelectionClickBehaviorPivotTableRange",ra,[]);var db=a(371);class oa extends Na{constructor(fb,ec){super(fb);this.Dg=()=>{this.domElement.classList.remove(Z.selecting);db.c(this.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};this.Fp=()=>{this.domElement.classList.add(Z.selecting)};this.onPointerDown=lb=>{2===lb.tb&&lb.ao===Sys.UI.MouseButton.leftButton&&(this.gridView.ha.selectionType=4,this.gridView.ha.sourceRange=this.gridView.ha.sa.Xc,db.c(this.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));
return!1};this.uca=()=>{this.gridView.$.fd(1983983164,2,30,null);return!0};this.dd=()=>{z.DOMElementExtensions.setVisible(this.qaa,this.gridView.$.isEditMode)};this.t6=()=>{z.DOMElementExtensions.setVisible(this.qaa,!1)};this.s6=()=>{z.DOMElementExtensions.setVisible(this.qaa,!0)};this.zzf=()=>{z.DOMElementExtensions.setVisible(this.qaa,!1)};this.yzf=()=>{z.DOMElementExtensions.setVisible(this.qaa,!0)};this.JEb=(lb,ac)=>{z.DOMElementExtensions.setVisible(this.qaa,!ac.Fle)};this.gridView=ec;ec=document.createElement("div");
ec.className=da.a.Cwh;this.qaa=ec;this.dd(null,null);fb.appendChild(ec);r.a.instance.ra(v.a.pointerDown,this.qaa,this.onPointerDown);Q.a.instance.ra(v.a.xk,this.qaa,this.uca);this.gridView.ha.s2(this.Fp);this.gridView.ha.cY(this.Dg);this.gridView.$.kl(this.dd);this.gridView.$.rb.o_b(this.t6);this.gridView.$.rb.n_b(this.s6);this.gridView.goe(this.JEb);this.gridView.hc.Vk(this.zzf);this.gridView.hc.lm(this.yzf)}dispose(){r.a.instance.Ba(v.a.pointerDown,this.qaa,this.onPointerDown);Q.a.instance.Ba(v.a.xk,
this.qaa,this.uca);this.gridView.$&&(this.gridView.ha.W6(this.Fp),this.gridView.ha.kW(this.Dg),this.gridView.$.Hl(this.dd),this.gridView.$.rb.Ftc(this.t6),this.gridView.$.rb.Etc(this.s6),this.gridView.uRf(this.JEb),this.gridView.hc.Ak(this.zzf),this.gridView.hc.Fl(this.yzf));super.dispose()}}Object(b.a)(oa,"FillHandleClickBehavior",Na,[]);class Oa extends G{constructor(fb,ec){super(fb);this.FRi=lb=>{const ac=H.HelperMethods.Yn(lb);var Gb=this.Xva.A0d(lb.clientPoint);if(!Gb)return!1;var wb=Gb.Ee,qc=
this.Xva.Ea.Svb(wb.hashCode).ova(Gb.WI);if(!qc)return!1;lb=wb.xj.domElement;Gb=H.HelperMethods.lne(H.HelperMethods.lwb(wb.domElement,lb),Gb.WI);wb=0;qc=this.Xva.Vb(qc.getRange());for(let xb=0,wc=Oa.wye.length;xb<wc;++xb){const Oc=Oa.wye[xb];if((128===Oc||64===Oc)&&this.Xva.$.isEditMode)continue;var Ya=qc.EKa(Oc);if(!Ya||!Ya.f6a||"none"===Ya.f6a.style.display)continue;Ya=Ya.f6a;const Cb=H.HelperMethods.lwb(Ya,lb);Ya=new Sys.UI.Bounds(Cb.x,Cb.y,Ya.offsetWidth,Ya.offsetHeight);if(X.a.lN(Ya,Gb)){wb=Oc;
break}}return 0!==wb?(qc.invoke(wb,ac),!0):!1};this.drg=ec;Q.a.instance.ra(v.a.click,fb,this.FRi)}get Xva(){return this.drg}}Oa.wye=[1,2,32,256,128,64];Object(b.a)(Oa,"IPadSelectionClickThroughBehavior",G,[]);var Wa=a(22);class Sa{constructor(fb){this.k$e=ec=>{this.jCc(ec.Db,1);return!0};this.l$e=ec=>{this.jCc(ec.Db,-1);return!0};this.Dg=()=>{this.opd=!1};this.Fp=()=>{this.opd=!0};this.gridView=fb;this.G5a=0;this.opd=this.Wgc=!1;this.w5=Number.NaN;this.gridView.ha.s2(this.Fp);this.gridView.ha.cY(this.Dg);
this.gridView.ha.g_b(this.Dg)}dispose(){this.gridView.ha.W6(this.Fp);this.gridView.ha.kW(this.Dg);this.gridView.ha.JKd(this.Dg)}iAa(){this.G5a=0;this.Wgc=!1;this.w5=Number.NaN}IKe(fb){this.Wgc=!0;this.jCc(fb,1)}JKe(fb){this.Wgc=!1;this.jCc(fb,-1)}jCc(fb,ec){if(fb)if(fb.parentNode)if(this.opd)isNaN(this.w5)||(this.xCc(this.w5,!1),this.w5=Number.NaN);else if(fb=parseInt(fb.parentNode.getAttribute(x.a.X5a),10),isNaN(fb))w.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");
else{if(!isNaN(this.w5)&&fb!==this.w5){if(this.Wgc)return;this.xCc(this.w5,!1)}if(isNaN(this.w5)||fb!==this.w5)this.w5=fb,this.G5a=0;!this.G5a&&0<ec&&this.xCc(fb,!0);this.G5a=Math.max(this.G5a+ec,0);!this.G5a&&0>ec&&(this.xCc(fb,!1),this.w5=Number.NaN)}else w.ULS.shipAssertTag(537159367,0,!!fb.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else w.ULS.shipAssertTag(537159368,0,!!fb,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")}xCc(fb,ec){for(let ac=
1;4>=ac;ac++){var lb=this.gridView.ob.nv(3,ac,fb).wf;z.DOMElementExtensions.toggleCssClass(lb,Z.Zvh,ec);for(lb=lb.firstChild;lb;lb=lb.nextSibling)Wa.a.contains(lb.className,"resizemarqueehandle",!0)&&z.DOMElementExtensions.toggleCssClass(lb,Z.cwh,ec)}}}Object(b.a)(Sa,"MarqueeHoveringManager",null,[]);var yb=a(189),Ma=a(82),Bb=a(820),Nb=a(1232);class Ia extends G{constructor(fb,ec){super(fb);this.Coc=()=>{if(!this.pv)return w.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),
!1;this.pv.LMf(this.HH,!1);this.pv.yMe(this.HH,!1);if(3===this.pv.model.state)return!0;this.pv.h$e(!0);return!0};this.A_=()=>{if(!this.pv)return!1;this.pv.x3i();this.pv.lMd(this.HH,!1);if(3===this.pv.model.state)return!0;this.pv.h$e(!1);return!0};this.onPointerDown=lb=>this.pv?2===lb.tb&&lb.ao===Sys.UI.MouseButton.leftButton?!0:!1:!1;this.gFb=()=>{if(!this.pv)return!1;this.pv.lMd(this.HH,!0);this.pv.LMf(this.HH,!0);this.pv.yMe(this.HH,!0);this.pv.KKb(!0);return!0};this.onDoubleClick=lb=>{if(lb.Ca)return lb.Ca.stopPropagation(),
!0;w.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};this.pv=Object(Ma.a)(Nb.a,ec.metadata);this.oK=document.createElement("div");this.oK.id=`${fb.id}-${x.a.nye}`;this.oK.className=Bb.a.DWg;this.HH=document.createElement("div");this.HH.id=`${fb.id}-${x.a.P_c}`;this.HH.className=Bb.a.P_c;this.oK.appendChild(this.HH);fb.appendChild(this.oK);w.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");
r.a.instance.ra(v.a.TV,this.oK,this.Coc);r.a.instance.ra(v.a.sy,this.oK,this.A_);r.a.instance.ra(v.a.pointerDown,this.oK,this.onPointerDown);yb.a.instance.ra(v.a.click,this.oK,this.gFb);yb.a.instance.ra(v.a.xk,this.oK,this.onDoubleClick)}dispose(){r.a.instance.Ba(v.a.TV,this.oK,this.Coc);r.a.instance.Ba(v.a.sy,this.oK,this.A_);r.a.instance.Ba(v.a.pointerDown,this.oK,this.onPointerDown);yb.a.instance.Ba(v.a.click,this.oK,this.gFb);yb.a.instance.Ba(v.a.xk,this.oK,this.onDoubleClick);z.DOMElementExtensions.sf(this.HH);
this.HH=null;z.DOMElementExtensions.sf(this.oK);this.pv=this.oK=null;super.dispose()}vZa(fb){this.pv=Object(Ma.a)(Nb.a,fb.metadata)}}Object(b.a)(Ia,"RangeCatchUpActivityHighlightBehavior",G,[]);class jb extends P{constructor(fb,ec,lb,ac){super(fb,ec,lb,ac)}get z4(){return 16}get Lcb(){return this.gridView.ha.rangePicker.pdd(!1)}KSa(){return(this.gridView.inRangePicker||this.gridView.Fi)&&super.KSa()}}Object(b.a)(jb,"RangePickerTouchGrippiesBehavior",P,[]);class Ob extends G{constructor(fb,ec){super(fb);
const lb=document.createElement("div"),ac=document.createElement("div");lb.className=ec?Z.Kwh:Z.Mwh;ac.className=ec?Z.Lwh:Z.Jwh;fb.appendChild(lb);fb.appendChild(ac)}}Object(b.a)(Ob,"RearrangeHighlightBehavior",G,[]);var Jb;(function(fb){fb[fb.topLeft=0]="topLeft";fb[fb.topRight=1]="topRight";fb[fb.bottomLeft=2]="bottomLeft";fb[fb.bottomRight=3]="bottomRight";fb[fb.error=4]="error"})(Jb||(Jb={}));Object(b.b)("Corner",Jb);class Kb extends G{constructor(fb,ec,lb,ac,Gb){super(fb);this.Ya=this.hG=null;
this.n3=0;this.hb=this.sourceRange=null;this.tTa=!1;this.onPointerDown=wb=>{wb=K.a(this.$).Vd(wb);if(this.m3f(wb)&&!this.tTa){this.gof();this.Ya=this.to.bac();this.hG=this.to.n3e(wb);if(!this.Ya||!this.hG||!this.hG.range)return w.ULS.shipAssertTag(537159361,0,!!this.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),w.ULS.shipAssertTag(537159360,0,!!this.hG,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),w.ULS.shipAssertTag(537159331,0,!!this.hG.range,
"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;this.hb=this.hG.range.clone();this.sourceRange=this.hb.clone();this.n3=this.h_e(wb);if(4===this.n3)return w.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;const qc=this.$0e(wb,!0);if(!qc)return w.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!this.xFe(qc))return w.ULS.shipAssertTag(537159328,
0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;this.gridView.ZLa=!0;this.Ya.BC(!1);this.NF.IKe(wb.Db);this.to.rMf(!0,this.dba.WT);this.Ya.textBox.removeSelection();this.Ya.QZb(this.V6e);this.CPf();this.tTa=!0;Ra.b(this.$,!0)}return!0};this.Jh=wb=>{wb=K.a(this.$).Vd(wb);wb=this.$0e(wb,!1);if(!wb)return!0;wb=this.xFe(wb);if(!wb)return w.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.Z9b(!0),!1;if(this.hb.equals(wb))return!0;
this.hb=wb;wb=this.Ky();wb||(w.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Z9b(!0));return wb};this.Mf=wb=>{K.a(this.$).Vd(wb);wb=this.kG();w.ULS.shipAssertTag(537159325,0,wb,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");this.Z9b(!wb);return wb};this.V6e=()=>{this.Z9b(!0)};this.gridView=ec;this.$=ec.$;this.hL=[];this.ha=this.gridView.ha;this.NF=lb;this.to=ac;this.dba=Gb;this.coloredReferencesManager=this.$.da.za(281);
w.ULS.shipAssertTag(537159362,0,!!this.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");if(this.zz=I.a.zz(this.$))ec=this.$.da.za(464),w.ULS.shipAssertTag(0,0,!!ec,"ResizeMarqueeBehaviorBase Ctor: formulaAssistanceManager is null. We already have marquee highlights so it shouldn't happen."),this.nz=ec.nz;for(const wb of this.MUf())ec=this.to.HEe(fb,wb,this.Rpe(),this.onPointerDown),this.hL.push(ec);
for(const wb of this.hL)r.a.instance.ra(v.a.TV,wb,this.NF.k$e),r.a.instance.ra(v.a.sy,wb,this.NF.l$e);this.vZa(Gb)}dispose(){this.hL.forEach(fb=>{r.a.instance.Ba(v.a.pointerDown,fb,this.onPointerDown)});this.hL.length=0;super.dispose()}vZa(fb){this.dba=fb;this.$pe(fb);this.to.HLb(fb,this.hL,this.CSd());this.NF.iAa()}$0e(fb,ec){const lb=fb.Db;fb=fb.clientPoint;if(!lb||!fb)return w.ULS.shipAssertTag(537159324,0,!!lb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),w.ULS.shipAssertTag(537159323,
0,!!fb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ec&&(fb=this.psf(fb));ec=this.ha.eo(fb,lb,0,!0,!1,!0);ec||(fb=this.psf(fb),ec=this.ha.eo(fb,lb,0,!0,!1,!0));return ec}psf(fb){fb.y+=0===this.n3||1===this.n3?2:-2;fb.x+=0===this.n3||2===this.n3?2:-2;return fb}xFe(fb){if(!fb||!this.sourceRange)return w.ULS.shipAssertTag(537159322,0,!!fb,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),w.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),
null;if(0===this.n3)return new ia.Range(fb.top,fb.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.n3)return new ia.Range(fb.top,this.sourceRange.left,this.sourceRange.bottom,fb.right,!0,!1);if(2===this.n3)return new ia.Range(this.sourceRange.top,fb.left,fb.bottom,this.sourceRange.right,!0,!1);if(3===this.n3)return new ia.Range(this.sourceRange.top,this.sourceRange.left,fb.bottom,fb.right,!0,!1);w.ULS.shipAssertTag(537159320,0,!1,`ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: ${Jb[this.n3]}`);
return null}kG(){return this.zz?this.nz.yDb(this.Ya,this.hG,this.hb):this.coloredReferencesManager.yDb(this.Ya,this.hG,this.hb)}Ky(){return this.kG()}Z9b(fb){fb&&w.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.NF.JKe(this.hL[0]);this.to.rMf(!1,this.dba.WT);this.Ya.textBox.setCaretPositionToEnd();this.Ya.ntc(this.V6e);this.fdg();this.tTa=this.gridView.ZLa=!1;Ra.b(this.$,!1);this.to.gOf()}}
Object(b.a)(Kb,"ResizeMarqueeBehaviorBase",G,[]);class Qa extends Kb{constructor(fb,ec,lb,ac,Gb){super(fb,ec,lb,ac,Gb)}MUf(){return[Z.Qwh,Z.Rwh,Z.Owh,Z.Pwh]}Rpe(){return[Z.Nwh]}h_e(fb){fb=fb.Db;if(fb===this.hL[0])return 0;if(fb===this.hL[1])return 1;if(fb===this.hL[2])return 2;if(fb===this.hL[3])return 3;w.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}CPf(){this.to.Qw(this.Jh,this.Mf,!0)}fdg(){this.to.pZd(this.Jh,this.Mf,
!0)}m3f(fb){return 2===(L.a.Gb=fb.tb)&&fb.ao===Sys.UI.MouseButton.leftButton}CSd(){return!0}gof(){w.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")}$pe(fb){for(const ec of this.hL)ec.style.backgroundColor=fb.wf.style.borderColor}}Object(b.a)(Qa,"ResizeMarqueeMouseBehavior",Kb,[]);class ha extends Kb{constructor(fb,ec,lb,ac,Gb){super(fb,ec,lb,ac,Gb);this.bFb=()=>{const wb=3===L.a.Gb;this.jtd&&!wb?this.to.HLb(this.dba,this.hL,
!1):!this.jtd&&wb&&this.to.HLb(this.dba,this.hL,!0);this.jtd=wb};this.KQi=(wb,qc)=>{qc.X5a===this.dba.WT&&this.to.HLb(this.dba,this.hL,!qc.start&&this.CSd())};L.a.Moe(this.bFb);this.jtd=3===L.a.Gb;this.to.fHg(this.KQi)}dispose(){L.a.VRf(this.bFb);super.dispose()}MUf(){return[da.a.Svh,da.a.Rvh]}Rpe(){const fb=!ta.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return[fb?da.a.CRe:da.a.BRe,da.a.Z8b,fb?da.a.Qvh:da.a.Y8b]}h_e(fb){fb=fb.Db;if(fb===this.hL[0])return 0;if(fb===this.hL[1])return 3;
w.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4}CPf(){u.a.tv?this.to.Qw(this.Jh,this.Mf,!1):this.to.z8i(this.Jh,this.Mf)}fdg(){u.a.tv?this.to.pZd(this.Jh,this.Mf,!1):this.to.uPj(this.Jh,this.Mf)}m3f(fb){return 3===(L.a.Gb=fb.tb)}CSd(){return 3===L.a.Gb}gof(){w.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")}$pe(){}}Object(b.a)(ha,"ResizeMarqueeTouchBehavior",
Kb,[]);class qa extends G{constructor(fb,ec){super(fb);qa.trb(fb,D.a.hwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.horizontal);qa.trb(fb,D.a.gwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.vertical);qa.trb(fb,D.a.dwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.horizontal);qa.trb(fb,D.a.fwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.vertical);qa.trb(fb,da.a.ewh)}static trb(fb,ec,lb){const ac=document.createElement("div");ac.className=ec;lb&&(ac.style.backgroundImage=`url("${lb}")`);fb.appendChild(ac)}}
Object(b.a)(qa,"SelectionCutCopyBehavior",G,[]);class pb extends G{constructor(fb){super(fb);appChrome.renderSpinner(fb)}}Object(b.a)(pb,"SelectionPasteBehavior",G,[]);class bb extends G{constructor(fb,ec){super(fb);bb.Krb(fb,D.a.Iwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.horizontal);bb.Krb(fb,D.a.Hwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.vertical);bb.Krb(fb,D.a.Ewh+" "+da.a.Gua,null===ec||void 0===ec?void 0:ec.horizontal);bb.Krb(fb,D.a.Gwh+" "+da.a.Gua,null===ec||void 0===ec?void 0:
ec.vertical);bb.Krb(fb,da.a.Fwh)}static Krb(fb,ec,lb){const ac=document.createElement("div");ac.className=ec;lb&&(ac.style.backgroundImage=`url("${lb}")`);fb.appendChild(ac)}}Object(b.a)(bb,"SelectionRangePickerBehavior",G,[]);class eb extends P{constructor(fb,ec,lb,ac){super(fb,ec,lb,ac)}get z4(){return 0}get Lcb(){return this.gridView.ha.sa.Xc}KSa(){const fb=this.gridView.Fi||this.gridView.eb;return this.gridView.ha.sa.Bg&&!fb&&super.KSa()}}Object(b.a)(eb,"SelectionTouchGrippiesBehavior",P,[]);
var Fa=a(53);class tb extends t.a{constructor(fb,ec){super();this.Gob=(lb,ac)=>{lb=ac.z4;const Gb=this.gridView;ac=ac.q7h;const wb=ac.wf,qc=ac.e$;u.a.Xg&&qc.push(new Oa(wb,Gb));switch(lb){case 24:ac.e$.push(new Ia(wb,ac));break;case 0:ac.e$.push(new oa(wb,Gb));u.a.Ap||(ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?(qc.push(new ma(wb,this.gridView.$,ac.paneType,this.tableManager,this.to)),ta.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ManualDragDropInPivotTables",
!1)&&qc.push(new Va(wb,this.gridView.$,ac.paneType,this.tableManager,this.to))):qc.push(new Xb(wb,this.gridView.$,ac.paneType,this.tableManager,this.to)));qc.push(new eb(ac,wb,Gb,ac.paneType));break;case 3:qc.push(new Na(wb));u.a.Ap||(qc.push(new ea(wb,this.gridView.$,ac.paneType,this.NF,this.to,ac)),qc.push(new Qa(wb,this.gridView,this.NF,this.to,ac)),qc.push(new ha(wb,this.gridView,this.NF,this.to,ac)));break;case 4:case 5:qc.push(new qa(wb,this.ire));break;case 30:qc.push(new pb(wb));break;case 16:qc.push(new bb(wb,
this.ire));qc.push(new jb(ac,wb,Gb,ac.paneType));break;case 11:case 12:qc.push(new Ob(wb,11===lb));break;case 17:qc.push(new Na(wb));break;case 19:qc.push(new Na(wb)),qc.push(new ka(ac,wb,Gb,ac.paneType))}ac.T0b=!0};this.$=fb;this.gridView=Da.g(fb);this.tableManager=ec;this.NF=new Sa(this.gridView);this.to=new F(this.gridView);this.gridView.ob&&(this.gridView.ob.CGg(this.Gob),this.gridView.ob.update(!1));fb.da.Ga(64,this)}get ire(){ta.EwaSettings.isChangeGateEnabled("OfficeVSO:6809974_DancingAnts1Cdn")&&
!this.hre&&(this.hre={vertical:Fa.a.current.Zn(106),horizontal:Fa.a.current.Zn(107)});return this.hre}dispose(){this.gridView.ob.Ibj(this.Gob);this.NF&&(this.NF.dispose(),this.NF=null);super.dispose()}}Object(b.a)(tb,"GridHighlightsBehaviorManager",t.a,[]);class dc extends d.a{constructor(fb){super();this.$=fb;this.Eb()}create(){m.TaskExtensions.Aa(l.GetServiceTaskFactory.create(this.$.da,134,this.la,this.fb),fb=>{this.pb(this.$.da.za(64)||new tb(this.$,fb.result))},this.la,3)}static ka(fb){fb.da.Ga(149,
new dc(fb))}}Object(b.a)(dc,"GridHighlightsBehaviorManagerFactory",d.a,[]);a.d(C,"a",function(){return jc});const jc=()=>{c.a.Fa(dc.ka);c.a.Fa(k.ka)}},1145:function(n,C,a){var c=a(9);n=a(0);var b=a(694),d=a(50),f=a(37),e=a(183),k=a(55);class l{constructor(Fa){this.ujh=Fa}Lc(){return!1}executeCommand(Fa,tb){Fa=tb.command;tb=null;switch(Fa){case 1243860697:this.ujh.NKj();break;default:tb=e.a(Fa)}return tb||k.Task.Ta(!0)}Ac(Fa,tb){return 1243860697===tb.command}Oc(){return!1}}Object(n.a)(l,"SheetDropdownMenuCommandHandler",
null,[164]);class m extends b.a{constructor(Fa){super(Fa)}vd(){this.$.Yx(Fa=>{Fa.Qec().then(()=>{f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,32,33,this.fb),tb=>{this.$c([new l(tb.result.Cvj)])},this.$.la)})})}static ka(Fa){b.a.Od(392,new m(Fa))}}Object(n.a)(m,"SheetDropdownMenuCommandHandlerFactory",b.a,[]);var u=a(222),t=a(5),w=a(72),r=a(33),v=a(1),y=a(15),x=a(27),B=a(189),z=a(13),A=a(86),I=a(44),F=a(237),U=a(154),X=a(108),T=a(39),G=a(414),D=a(82),J=a(14),L=a(35);class H{constructor(){this.pJe=
new L.a(!0);this.ZHc=0}get $6c(){return this.ZHc}get navigationButtonsDisabled(){return!!(this.$6c&1)}get operationButtonsDisabled(){return!!(this.$6c&2)}TLg(Fa,tb){this.pJe.add(Fa,tb);this.rS()}rS(){this.ZHc=0;L.a.forEach(this.pJe.qu,Fa=>{this.ZHc=this.$6c|Fa.value})}}Object(n.a)(H,"SheetTabBarDisabledStateManager",null,[]);var R=a(236),Q=a(31);class O{}O.bth="ewa-stb-uir";O.hPe="ewa-stb-drag";O.Msh="ewa-stb-navarea";O.Nsh="ewa-stb-navarea-dimensions";O.Psh="ewa-stb-navbutton";O.dU="cui-disabled";
O.Osh="ewa-stb-navareaextra";O.bia="cui-img-container";O.Gsh="ewa-stb-contentarea";O.iPe="ewa-stb-left-scrollable";O.tPe="ewa-stb-right-scrollable";O.$sh="ewa-stb-tabarea";O.Zsh="ewa-stb-sheettabmoveindicator";O.vPe="ewa-stb-tabs";O.yHj="tab-active";O.GHj="tab-inactive";O.FHj="tab-hover";O.ath="ewa-stb-tabs-ghost";O.AHj="tab-anchor-text";O.dark="dark";O.light="light";O.zHj="tab-active-text";O.DHj="tab-content-container";O.IHj="tab-text";O.Ssh="ewa-stb-nsv-inactive";O.Tsh="ewa-stb-nsv-inactive-svg";
O.Qsh="ewa-stb-nsv-active";O.Rsh="ewa-stb-nsv-active-svg";O.xrh="ewa_nsv_margin";O.Hsh="ewa-stb-disable-scrollbar";O.esi="leave-size-fixed-on-tab-hover-old";O.dsi="leave-size-fixed-on-tab-hover";O.mPe="ewa-stb-locked-sheet";O.nPe="ewa-stb-locked-sheet-svg-16px";O.Ish="ewa-stb-dropdown-menu-button";O.Bnh="ewa-active-sheet-menu-item";Object(n.a)(O,"CssClassNames",null,[]);var V=a(556),W=a(19),da=a(259),ta=a(102),K=a(515),na=a(171),P=a(246),ka=a(45),pa=a(286),Na=a(53),Z=a(12),Ra=a(71),Da=a(316),Ba=a(11),
ea=a(100),Y=a(345),ja=a(21),ca=a(190),ba=a(371),ua=a(368),wa=a(42),ia=a(223),xa=a(85);class gb extends R.a{constructor(Fa,tb,dc=!1){super(Fa);this.Aab=this.Esa=null;this.$=tb;this.sX=dc}get disabled(){return this.sX}dispose(){this.Aab=this.Esa=this.$=null;super.dispose()}WW(Fa){this.sX=Fa;this.domElement.setAttribute(t.a.lsa,Fa.toString());Z.DOMElementExtensions.toggleCssClass(this.domElement,V.a.dU,Fa)}}Object(n.a)(gb,"SheetBarButton",R.a,[]);var va=a(712);class sa extends gb{constructor(Fa,tb,dc,
jc=!1){super(document.createElement("a"),tb,jc);this.gd=fb=>{this.disabled||this.$.fd(-1935155518,fb.tb,30,null);return!0};this.iFb=fb=>{fb="mouseover"===fb.type||"focus"===fb.type;const ec=ba.a(this.$)?this.Aab:this.Esa;Ba.HelperMethods.uXd(ec,this.qha,this.qha+t.a.sec,fb&&!ja.g(this.$).inRangePicker)};this.qh=()=>{this.WW(!0)};this.Lf=()=>{this.WW(!1)};this.qha=v.EwaSettings.ma(500)?W.a.Y9c:W.a.cQe;this.Esa=dc.qb(this.domElement,J.a.instance.ga(514),0,this.qha,J.a.instance.ga(515),va.a.n2c,jc);
Fa.appendChild(this.domElement);this.Gc.ka("contextmenu",fb=>{Ra.g(fb)});v.EwaSettings.ma(500)||(this.Gc.ka("mouseover",this.iFb),this.Gc.ka("mouseout",this.iFb));ia.a.instance.ra(z.a.click,this.domElement,this.gd);this.zNa=X.KeyInputManager.instance.Ds(this.domElement,this.gd,xa.a.fi,xa.a.a1);ja.g(this.$).hc.Vk(this.qh);ja.g(this.$).hc.lm(this.Lf)}dispose(){ia.a.instance.Ba(z.a.click,this.domElement,this.gd);X.KeyInputManager.instance.Hv(this.domElement,this.zNa);ja.g(this.$)&&ja.g(this.$).hc&&(ja.g(this.$).hc.Ak(this.qh),
ja.g(this.$).hc.Fl(this.Lf));super.dispose()}WW(Fa){const tb=sa.k3f(this.$);super.WW(Fa||tb)}static k3f(Fa){return!Fa.isEditMode||!Fa.xa.count}}Object(n.a)(sa,"InsertSheetButton",gb,[]);class ab extends gb{constructor(Fa,tb,dc){super(document.createElement("a"),tb);this.gd=jc=>{this.$.fd(-684145703,jc.tb,0,null);return!0};this.iFb=jc=>{Ba.HelperMethods.uXd(this.owe,this.qha,this.qha+t.a.sec,("mouseover"===jc.type||"focus"===jc.type)&&!ja.g(this.$).inRangePicker)};this.$=tb;this.qha=v.EwaSettings.ma(500)?
W.a.Y9c:W.a.cQe;this.owe=dc.qb(this.domElement,J.a.instance.ga(516),0,this.qha,J.a.instance.ga(517),va.a.n2c);Fa.appendChild(this.domElement);this.Gc.ka("contextmenu",jc=>{Ra.g(jc)});this.Gc.ka("mouseover",this.iFb);this.Gc.ka("mouseout",this.iFb);ia.a.instance.ra(z.a.click,this.domElement,this.gd);this.zNa=X.KeyInputManager.instance.Ds(this.domElement,this.gd,xa.a.fi,xa.a.a1)}dispose(){ia.a.instance.Ba(z.a.click,this.domElement,this.gd);X.KeyInputManager.instance.Hv(this.domElement,this.zNa);this.owe=
null;super.dispose()}}Object(n.a)(ab,"InsertTemplateButton",gb,[]);class Ua{constructor(Fa,tb){this.sheetName=null;this.newSheetIndex=0;this.sheetName=Fa;this.newSheetIndex=tb}getSheetName(){return this.sheetName}}Object(n.a)(Ua,"MacroRecorderSheetReorderedPayload",null,[115]);var nb=a(90);class Ha extends R.a{constructor(Fa,tb){super(document.createElement("div"));this.sR=()=>{y.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");this.USf(!1,"OnSheetsChanged")};this.wJi=()=>{this.Ij()};
this.vJi=()=>{this.mk()};this.$=Fa;this.dIj=tb;this.EU=!1;this.uOb=0}dispose(){this.mk();super.dispose()}NKj(){this.USf(!0,"TogglerSheetDropdownMenu")}USf(Fa,tb){y.ULS.sendTraceTag(537153795,0,50,`SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: ${tb}, toggle: ${Fa}, toggleStateId: ${this.uOb}`);Fa&&(this.uOb+=1);const dc=this.$.Jb.Bc("UserAction",`SheetDropdownMenu.RenderSheetMenuInternal: caller: ${tb}, toggle: ${Fa}, toggleStateId: ${this.uOb}, sheetCount: ${this.$.xa.count}`);
Fa=this.jah();appChrome.renderSheetDropdownMenu(this.domElement,this.dIj,Fa,this.uOb,this.wJi,this.vJi,()=>{dc.stop()},ba.a(this.$))}jah(){const Fa=this.$.xa,tb=[];for(let jc=0;jc<Fa.count;jc++){var dc=Object(D.a)(ea.a,Fa.getItem(jc));0===dc.aA&&(dc=this.iah(dc),tb.push(dc))}return tb}iah(Fa){const tb={};tb.key=Fa.name;tb.text=Fa.name;tb.onClick=this.kah(Fa);Fa.active&&(tb.className=ba.a(this.$)?"ewa-active-sheet-menu-item-present-mode":O.Bnh);return tb}kah(Fa){return()=>{const tb=new nb.a(-1876836819,
0,this.$.Kc,30,null);this.$.Ka.Lb(tb,{[t.a.IRd]:Fa.name})}}Ij(){if(!this.EU){const Fa=this.$.xa;Fa.Qf(this.sR);Fa.rVc(this.sR);Fa.bY(this.sR);Fa.Oga(this.sR);Fa.YFa(this.sR);Fa.Joe(this.sR);Fa.iZa(this.sR);this.EU=!0}}mk(){if(this.EU){const Fa=this.$.xa;Fa.Eg(this.sR);Fa.fKd(this.sR);Fa.V6(this.sR);Fa.Vma(this.sR);Fa.VQa(this.sR);Fa.TRf(this.sR);Fa.XIb(this.sR);this.EU=!1}}}Object(n.a)(Ha,"SheetDropdownMenu",R.a,[473,10]);var sb=a(349);class Qb extends gb{constructor(Fa,tb,dc){super(document.createElement("a"),
Fa,!0);this.Cg=()=>{this.WW(!1);this.$.ea.fo(this.Cg)};this.gd=jc=>{this.oag(jc.tb);return!0};this.onKeyDown=jc=>13===jc.Ca.keyCode||32===jc.Ca.keyCode?(this.oag(jc.tb),!0):!1;this.Esa=tb.qb(this.domElement,J.a.instance.ga(518),0,W.a.Fsh,J.a.instance.ga(518),va.a.c2h,this.disabled);this.domElement.classList.add(O.Ish);dc.appendChild(this.domElement);this.$.ea.Ll(this.Cg);this.h8i()}dispose(){this.qPj();super.dispose()}WW(Fa){super.WW(Fa||!this.$.ea.Rwa)}oag(Fa){this.disabled||(y.ULS.sendTraceTag(537153793,
0,50,`SheetDropdownMenuAnchor.ToggleMenu: inputMethod: ${sb.a[Fa]}`),this.$.Ka.Lb(new nb.a(1243860697,Fa,this.$.Kc,30,null)))}h8i(){ia.a.instance.ra(z.a.click,this.domElement,this.gd);X.KeyInputManager.instance.ra(z.a.Qb,this.domElement,this.onKeyDown)}qPj(){ia.a.instance.Ba(z.a.click,this.domElement,this.gd);X.KeyInputManager.instance.Ba(z.a.Qb,this.domElement,this.onKeyDown)}}Object(n.a)(Qb,"SheetDropdownMenuAnchor",gb,[]);var mb=a(61);const Pb=(Fa,tb,dc,jc,fb,ec,lb,ac=null)=>{ac=Fa.Na(9,ac);ac.sheetName=
tb;ac.newSheetIndex=dc;return mb.g(Fa,"ReorderSheets",ac,jc,fb,ec,lb,0)};var gc=a(175),Xb=a(129),Ca=a(187),ra=a(132),ma=a(59),hb=a(209),vb=a(197),Va=a(167),db=a(133);class oa{constructor(Fa,tb,dc){this.vm=tb;this.xw=dc;this.sheet=Fa;this.altText=J.a.instance.ga(1992)}oN(){return this.sheet.active}ipd(){return this.sheet.isLockPausedInSession}Tsa(){return this.vm?W.a.lPe:this.oN()?W.a.kPe:W.a.jPe}ioa(){return this.sheet.wi?va.a.qLf:va.a.dPj}dWd(){return 16}Bha(){return null}Usa(){return this.vm?this.xw?
O.nPe:O.mPe:null}EXd(){return null}Is(){return null}qld(){return 0}VWc(){return!0}}Object(n.a)(oa,"LockPausedSheetIconDataSource",null,[485]);class Oa{constructor(Fa,tb,dc){this.vm=tb;this.xw=dc;this.sheet=Fa;this.altText=J.a.instance.ga(1991)}oN(){return this.sheet.active}ipd(){return this.sheet.wi}Tsa(){return this.vm?W.a.lPe:this.oN()?W.a.kPe:W.a.jPe}ioa(){return va.a.qLf}dWd(){return 16}Bha(){return null}Usa(){return this.vm?this.xw?O.nPe:O.mPe:null}EXd(){return null}Is(){return null}qld(){return 0}VWc(){return!0}}
Object(n.a)(Oa,"LockedSheetIconDataSource",null,[485]);class Wa{constructor(Fa,tb,dc,jc){this.sheet=Fa;this.altText=J.a.instance.ga(1906);this.aLj=tb;this.f4f=dc;this.xw=jc}oN(){return this.sheet.active}ipd(){return this.sheet.Dd.uv}Bha(){return this.xw?this.oN()?O.Rsh:O.Tsh:this.oN()?O.Qsh:O.Ssh}Tsa(){return!this.oN()&&this.f4f()?W.a.Huh:W.a.Guh}ioa(){return!this.oN()&&this.f4f()?va.a.Mvj:va.a.Lvj}dWd(){return 14}Usa(){return O.xrh}EXd(){return this.sheet.Dd.Omb}Is(){return this.aLj}qld(){return 8}VWc(){return!1}}
Object(n.a)(Wa,"NamedSeetViewSheetIconDataSource",null,[485]);var Sa=a(155),yb=a(128);class Ma{constructor(Fa,tb){this.Dqa=this.s1=this.pBa=this.Al=null;this.chf=!1;this.LRc=this.ioa=this.Usa=this.Bha=this.Tsa=null;this.MN=()=>{this.dataSource.oN()&&f.TaskExtensions.Aa(this.sCb,()=>{dialogControls.renderToolTip(this.dataSource.Is(),"SheetIconTooltip",this.dataSource.EXd(),this.KI,10,!1,!1,1)},this.$.la,3)};this.KN=()=>{this.dataSource.oN()&&this.clearToolTip()};this.$=Fa;this.dataSource=tb;this.xw=
r.a.Xqd()}get Gc(){return this.s1||(this.s1=yb.a.instance.$d(this.KI))}get sCb(){if(this.Dqa)return this.Dqa;const Fa=new Sa.a;this.$.Yx(tb=>{f.TaskExtensions.Aa(tb.qud(),()=>{Fa.setResult(!0)},this.$.la,3)});return this.Dqa=Fa.task}get KI(){return this.LRc}Ceg(){if(this.KI&&(this.Al||this.pBa)){if(this.xw){var Fa=this.dataSource.ioa();this.ioa!==Fa&&(this.pBa&&this.pBa.parentNode.removeChild(this.pBa),this.tbf(),this.ioa=Fa)}else Fa=this.dataSource.Tsa(),this.Tsa!==Fa&&(this.kLd(this.Al,this.Tsa,
Fa),this.Tsa=Fa);Fa=this.dataSource.Bha();this.Bha!==Fa&&(this.xw?this.eej(this.pBa,this.Bha,Fa):this.kLd(this.Al,this.Bha,Fa),this.Bha=Fa);Fa=this.dataSource.Usa();this.Usa!==Fa&&(this.kLd(this.KI,this.Usa,Fa),this.Usa=Fa);this.dataSource.Is()&&!this.dataSource.oN()&&this.clearToolTip()}}qAj(Fa,tb,dc){this.Bbi(Fa,tb,dc);Z.DOMElementExtensions.setVisible(this.KI,this.dataSource.ipd())}clearToolTip(){f.TaskExtensions.Aa(this.sCb,()=>{dialogControls.clearToolTip(this.dataSource.Is())},this.$.la,3)}Bbi(Fa,
tb,dc){this.KI&&this.chf!==Fa&&(this.KI.parentNode.removeChild(this.KI),this.Usa=this.Bha=this.ioa=this.Tsa=this.LRc=null,this.dataSource.Is()&&(this.Gc.detach("mouseover",!0),this.Gc.detach("mouseout",!0)));this.KI||(this.LRc=document.createElement("span"),Sys.UI.DomElement.addCssClass(this.KI,V.a.bia),Sys.UI.DomElement.addCssClass(this.KI,W.a.WA),v.EwaSettings.ma(500)?Fa===this.dataSource.VWc()?tb.appendChild(this.KI):tb.insertBefore(this.KI,dc):Fa?tb.insertBefore(this.KI,dc):tb.appendChild(this.KI),
this.xw?this.tbf():(this.Al=document.createElement("img"),this.Al.tabIndex=-1,this.Al.alt=this.dataSource.altText,this.KI.appendChild(this.Al),this.Al.src=Na.a.Ue(this.dataSource.qld())),this.dataSource.Is()&&(this.Gc.ka("mouseover",this.MN,!0),this.Gc.ka("mouseout",this.KN,!0)),this.chf=Fa)}eej(Fa,tb,dc){Fa&&(Sys.UI.DomElement.removeCssClass(Fa,tb),Sys.UI.DomElement.addCssClass(Fa,dc))}kLd(Fa,tb,dc){tb&&Sys.UI.DomElement.removeCssClass(Fa,tb);dc&&Sys.UI.DomElement.addCssClass(Fa,dc)}dispose(){A.a.Ia(this.s1)}tbf(){const Fa=
this.$.da.za(388);Fa?(this.pBa=Fa.Rva(this.dataSource.ioa(),this.dataSource.dWd()))?this.KI.appendChild(this.pBa):y.ULS.shipAssertTag(537153763,0,!1,`Sheeticon.InsertCurrentSvgIcon: Svg with id ${this.dataSource.ioa()} was not found.`):y.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")}}Object(n.a)(Ma,"SheetIcon",null,[10]);var Bb=a(350),Nb=a(93),Ia=a(152);class jb extends Nb.a{constructor(Fa,tb){super(Fa.domElement);this.onKeyDown=dc=>
{121===dc.keyCode&&dc.shiftKey&&!this.Lna.disabled&&(this.showContextMenu(new Sys.UI.Point(0,0),1,this.Lna.anchor),Ra.g(dc))};this.uca=dc=>{if(!this.$.isEditMode||this.Lna.disabled)return!0;this.rename(!1,dc.tb);return!0};this.Xl=dc=>this.Lna.disabled?!0:this.showContextMenu(dc.clientPoint,dc.tb,dc.Db);this.Uhe=Fa;this.$=tb;ia.a.instance.ra(z.a.xk,Fa.domElement,this.uca);Bb.a.instance.ra(Fa.domElement,this.Xl);this.Gc.ka("keydown",this.onKeyDown)}get Lna(){return this.Uhe}dispose(){this.Lna&&(ia.a.instance.Ba(z.a.xk,
this.Lna.domElement,this.uca),Bb.a.instance.Ba(this.Lna.domElement,this.Xl),this.Uhe=null);this.$=null;super.dispose()}showContextMenu(Fa,tb,dc){this.Lna.activate(tb,r.a.Krd());tb=new nb.a(-1075099431,tb,this.$.Kc,30,null);let jc;return!Ia.a(jc=this.$.Ka.Lb(tb,{[t.a.O2f]:Fa,[jb.Dvj]:this.Lna.sheet,[t.a.P2f]:dc}))&&(6!==jc.status||jc.result)}rename(Fa,tb){this.$.fd(817296323,tb,Fa?19:0,null)}}jb.Dvj="Sheet";Object(n.a)(jb,"SheetOpsSheetClickHelper",Nb.a,[]);var Ob=a(41);class Jb extends gb{constructor(Fa,
tb,dc,jc,fb,ec,lb){super(document.createElement("li"),Fa);this.N1c=this.M1c=this.M2f=this.L2f=0;this.h5c=.5;this.EU=this.GRd=!1;this.color=this.LHc=this.UE=this.IDb=this.HO=null;this.Ohc=this.Zff=!1;this.G5b="#BEBBB8";this.iFc=null;this.onKeyDown=ac=>13!==ac.Ca.keyCode||this.disabled?!1:(this.activateSheet(1),!0);this.Lz=ac=>32!==ac.Ca.charCode||this.disabled?!1:(this.activateSheet(1),!0);this.MN=()=>{this.disabled||(this.cS.fSi(this),this.cS.GF||this.Dna(!0,void 0,"OnMouseOver"))};this.KN=()=>{this.disabled||
this.Dna(!1,void 0,"OnMouseOut")};this.hFb=()=>{this.cS.GF||(this.OEj(),this.sheet.z0||ja.g(this.$).AJb(this.sheet.sheetName));return!1};this.j6=()=>{this.nMe(!1);return!1};this.gd=ac=>{if(this.disabled)return!0;const Gb=ja.g(this.$);this.sheet.active||3!==ac.tb?this.vm?this.activateSheet(ac.tb):r.a.Krd()&&Gb.focus():(!r.a.rNa(this.$)&&!this.$Ab||Gb.eb||Gb.Fi||Gb.Dsb(),this.activateSheet(ac.tb));return 3!==ac.tb};this.onPointerDown=ac=>{if(this.disabled)return!0;this.nMe(!0);ja.g(this.$).inRangePicker&&
y.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var Gb=3===ac.tb;if(2===ac.tb||Gb&&this.rxa)this.vm?(this.Dna(!0,!Gb,"OnPointerDown"),Gb=k.Task.delay(Gb?this.M2f:this.L2f).fp(()=>!0)):Gb=this.activateSheet(ac.tb),this.vAb&&(this.Ohc=!0,this.cS.Otc=f.TaskExtensions.Aa(Gb,()=>{this.Ohc&&this.cS.hSi(this,ac)},this.la,11));return!1};this.Mf=ac=>{if(this.disabled||!this.vAb&&v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))return!0;
const Gb=this.cS.GF&&!r.a.qgf();this.Ohc=!1;this.vm&&this.Dna(2===ac.tb,void 0,"OnPointerUp");this.cS.Otc&&(f.TaskExtensions.Aa(this.cS.Otc,()=>{this.cS.gSi(this)},this.la,11),this.cS.Otc=null);return Gb};this.QN=()=>{this.Ohc=!1;this.GRd||this.Dna(!1,void 0,"OnTouchMove");return!1};this.oAe=new jb(this,Fa);this.vm=ec;this.xw=lb;this.$Ab=r.a.$Ab(Fa);this.fod=v.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!this.xw;this.vm?(this.L2f=Fa.ya.SheetDragReorderDelayInMilliseconds,
this.M2f=Fa.ya.SheetDragReorderDelayInMillisecondsForTouch,this.M1c=18,this.N1c=20):(this.M1c=19,this.N1c=22);this.$=Fa;this.SWb=jc;this.cS=fb;this.vAb=fb.Dqe();this.uah();this.r5g();this.Rkd=Fa.Jb.Rg("UserAction",this.name);this.hpd=!1;Z.DOMElementExtensions.yu(this.domElement,t.a.Zs,null,null);this.domElement.appendChild(this.anchor);this.anchor.appendChild(this.UE);this.Jna=new Ca.a;Fa=new Oa(this.sheet,this.vm,this.xw);this.Jna.add(new Ma(this.$,Fa));this.$.ea.ZLb&&(Fa=new oa(this.sheet,this.vm,
this.xw),this.Jna.add(new Ma(this.$,Fa)));this.fod||(Fa=new Wa(this.sheet,this.cS.wxc,()=>this.color?Jb.OSd(this.color):!1,this.xw),this.IDb=new Ma(this.$,Fa),this.Jna.add(this.IDb));this.rxa=this.cS.rxa;this.Ofb();this.y9i();this.yve=new pa.a(this.domElement,1);tb.insertBefore(this.domElement,dc);ba.a(this.$)&&this.ufg(!0)}get Vdh(){return this.LHc||(this.LHc=vb.a.pp("#F5F5F5"))}get name(){return this.HO.innerText}set name(Fa){this.HO&&(this.HO.innerText=Fa,this.XBc(),this.vfg())}get sheet(){return this.SWb}get anchor(){return this.iFc}get tabIndex(){return this.anchor.tabIndex}set tabIndex(Fa){this.anchor.tabIndex=
Fa}uPh(){return Z.DOMElementExtensions.Jf(this.anchor)?this.anchor:null}dispose(){if(this.EU){F.a.instance.Ba(z.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.Ba(z.a.Qb,this.domElement,this.onKeyDown);X.KeyInputManager.instance.Ba(z.a.Bp,this.domElement,this.Lz);ia.a.instance.Ba(z.a.click,this.domElement,this.gd);F.a.instance.Ba(z.a.TV,this.domElement,this.hFb);F.a.instance.Ba(z.a.sy,this.domElement,this.j6);if(this.vAb||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))F.a.instance.Ba(z.a.Nf,
this.domElement,this.Mf),this.rxa&&(U.a.instance.Ba(z.a.ue,this.domElement,this.Mf),U.a.instance.Ba(z.a.Yf,this.domElement,this.QN));this.EU=!1;this.G5b="#BEBBB8"}A.a.qc([this.oAe,this.yve]);this.HO=this.UE=this.iFc=this.cS=this.yve=this.oAe=null;if(this.Jna){for(let Fa of this.Jna)Fa.dispose();this.Jna=null}this.color=this.SWb=null;super.dispose()}WW(Fa){Fa&&this.Dna(!1,!1);super.WW(Fa)}vTd(Fa){if(ma.a.wg.TQ){this.wJe();var tb=d.GetServiceTaskFactory.Sa(this.$.da,322,323,1);f.TaskExtensions.Aa(tb,
dc=>{gc.UISurfaces.BH().then(jc=>{const fb=dc.result;fb.Orj(jc);fb.show(Fa);return null},jc=>{y.ULS.sendTraceTag(537153688,0,15,`SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: ${jc}`);return null})},this.la,3)}}qne(){if(this.sheet.active&&this.$.qr){var Fa=this.$.qr,tb=ja.g(this.$),dc=tb.Wj;if(this.sheet.Dd.uv){if(!this.IDb){var jc=new Wa(this.sheet,this.cS.wxc,()=>this.color?Jb.OSd(this.color):!1,this.xw);this.IDb=new Ma(this.$,jc);this.Jna.add(this.IDb)}dc?(tb.Efb(1),
v.EwaSettings.Lef()&&Fa.classList.add(W.a.$8b)):Fa.classList.add(W.a.$8b);Fa=Jb.Ufd(t.a.Tsf);tb=Jb.Ufd(t.a.nyd);dc=Jb.Ufd(t.a.Ksf);jc=this.sheet.Dd.ASd;this.sheet.Dd.ASd=!1;"true"===dc&&jc&&this.$.ea.DSd?(Xb.a.Yw(t.a.Ksf,"false",Xb.a.zV),this.$.ea.DSd=!1,this.vTd(3)):"true"===Fa&&"true"===tb&&"true"===dc?this.$.ea.ESd&&this.$.ea.tMb&&(this.sheet.Dd.VH?(Fa=1,Xb.a.Yw(t.a.nyd,"false",Xb.a.zV),this.$.ea.tMb=!1):Fa=0,Xb.a.Yw(t.a.Tsf,"false",Xb.a.zV),this.$.ea.ESd=!1,this.vTd(Fa)):this.sheet.Dd.VH&&"true"===
tb&&"true"===dc&&this.$.ea.tMb&&(Xb.a.Yw(t.a.nyd,"false",Xb.a.zV),this.$.ea.tMb=!1,this.vTd(2))}else this.wJe(),dc?(tb.Efb(0),v.EwaSettings.Lef()&&Fa.classList.remove(W.a.$8b)):Fa.classList.remove(W.a.$8b)}}wJe(){const Fa=this.$.da.za(322);Fa&&Fa.dismiss()}Ofb(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.e7a()?O.yHj:O.GHj;v.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.HO.parentNode.classList.add(O.dsi):this.HO.parentNode.classList.add(O.esi);
this.vfg();this.fod&&this.qne();this.rAj();this.Bfg();this.XBc();this.fod||this.qne()}eSi(){this.GRd=!0;this.Dna(!0,!0,"OnSheetReorderStarted")}dSi(){this.GRd=!1;this.Dna(!1,void 0,"OnSheetReorderEnded")}activate(Fa=0,tb=!1){this.A2b()||(this.sheet.activate(),tb&&ja.g(this.$).focus(),Fa={["InputMethod"]:sb.a[Fa],["AppMode"]:this.$.Kc,["Location"]:"canvas"},db.b(this.$).Hd(ra.a.zvj,Fa))}ufg(Fa){this.G5b=Fa?"#797775":"#BEBBB8";this.h5c=Fa?-.5:.5;this.LHc=Fa?vb.a.pp("#3B3A39"):vb.a.pp("#F5F5F5");this.Bfg()}Foj(Fa){this.vAb=
Fa}NAd(Fa){Fa.C2c();this.Gye(Fa)}Gye(Fa){Fa.P0a();this.sheet.activate()}YAg(Fa){Fa=new nb.a(-1876836819,Fa,this.$.Kc,30,null);return this.$.Ka.Lb(Fa,{[t.a.IRd]:this.sheet.name})}vfg(){this.HO.parentNode.setAttribute("sheet-title",this.HO.innerText)}XBc(){const Fa=this.YIh();this.anchor.setAttribute(t.a.Xt,Fa);this.anchor.setAttribute(t.a.Zga,this.sheet.active.toString())}YIh(){const Fa=this.sheet.Dd.uv,tb=this.sheet.Dd.Omb,dc=this.sheet.wi,jc=this.sheet.isLockPausedInSession;return Fa&&dc?String.format(J.a.instance.mb(20),
this.name,tb):Fa&&jc?String.format(J.a.instance.mb(22),this.name,tb):Fa?String.format(J.a.instance.mb(19),this.name,tb):dc?String.format(J.a.instance.mb(18),this.name):jc?String.format(J.a.instance.mb(21),this.name):this.name}activateSheet(Fa=0){if(r.a.Krd()){if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&this.A2b())return k.Task.Ta(!1);Va.a.current.VR="ActivateSheet";this.sheet.activate();return k.Task.Ta(!0)}return this.YAg(Fa)}Bfg(){const Fa=this.sheet.tabColor;
this.color=Fa?vb.a.pp(Fa):this.Vdh;this.Zff=Jb.OSd(this.color);this.Dna(!1,void 0,"UpdateTabColor")}Dna(Fa,tb=!1,dc=null){if(this.sheet){dc=this.sheet.active;var jc=this.e7a(),fb=!!this.sheet.tabColor,ec=vb.a.sG(dc||jc?hb.a.white:this.color);this.UE.style.background="";dc||jc?(fb?v.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.HLa?this.Etj():this.vm?this.Dtj():this.Ctj():this.vm||(this.UE.style.backgroundColor=ec),this.UE.style.height=this.M1c.toString()+
"px"):(this.UE.style.filter="",this.UE.style.backgroundColor=ec,this.UE.style.height=this.N1c.toString()+"px");this.HO.className=dc?O.zHj:jc?O.dark:this.Zff?O.light:O.dark;for(let lb of this.Jna)lb.Ceg();this.vm&&(Fa&&!fb&&(this.UE.style.backgroundColor="#E1DFDD"),Z.DOMElementExtensions.toggleCssClass(this.domElement,O.FHj,Fa),tb?(fb||(this.UE.style.backgroundColor=this.G5b),this.domElement.style.backgroundColor=this.G5b):(fb||(this.UE.style.backgroundColor=""),this.domElement.style.backgroundColor=
""));this.HO.style.fontWeight=dc||jc||!this.vm&&Fa?this.vm?"600":"bold":""}else y.ULS.sendTraceTag(537153687,0,15,`SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: ${dc}`)}Dtj(){const Fa=this.UE.style,tb=vb.a.sG(Jb.b0c(this.color,this.h5c));Fa.background=tb}Ctj(){const Fa=this.UE.style,tb=vb.a.sG(Jb.b0c(this.color,1)),dc=vb.a.sG(Jb.b0c(this.color,this.h5c));Fa.background=`$linear-gradient(${tb}, ${dc})`}Etj(){this.UE.style.background=
"transparent"}r5g(){this.iFc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=O.AHj;Z.DOMElementExtensions.yu(this.anchor,t.a.tob,null,null);this.tabIndex=-1}uah(){this.UE=document.createElement("span");this.UE.className=O.DHj;this.HO=document.createElement("span");this.HO.className=O.IHj;this.HO.dir=this.sheet.rtlName?"rtl":"ltr";this.UE.appendChild(this.HO)}rAj(){const Fa=this.$.sJ;for(let tb of this.Jna)tb.qAj(Fa,this.UE,this.HO)}e7a(){return ja.g(this.$).e7a(this.sheet)}OEj(){this.Rkd.start();
this.hpd=!0}nMe(Fa){this.hpd&&(this.Rkd.stop(),y.ULS.sendTraceTag(537153686,0,50,Ob.c({["Sheet index"]:this.sheet.index,["Active Sheet"]:this.sheet.active,["Hovering time"]:this.Rkd.yc,["Has been clicked"]:Fa})),this.hpd=!1)}y9i(){F.a.instance.ra(z.a.pointerDown,this.domElement,this.onPointerDown);X.KeyInputManager.instance.ra(z.a.Qb,this.domElement,this.onKeyDown);X.KeyInputManager.instance.ra(z.a.Bp,this.domElement,this.Lz);this.Gc.ka("mouseover",this.MN);this.Gc.ka("mouseout",this.KN);F.a.instance.ra(z.a.TV,
this.domElement,this.hFb);F.a.instance.ra(z.a.sy,this.domElement,this.j6);if(this.vAb||v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport"))F.a.instance.ra(z.a.Nf,this.domElement,this.Mf),this.rxa&&(U.a.instance.ra(z.a.ue,this.domElement,this.Mf),U.a.instance.ra(z.a.Yf,this.domElement,this.QN));ia.a.instance.ra(z.a.click,this.domElement,this.gd);this.EU=!0}A2b(){const Fa=this.$.da.za(65);return Fa&&Fa.vka()?(Fa.evc(),this.Gye(Fa),!0):!1}static Ufd(Fa){let tb=Xb.a.get(Fa);
tb||(Xb.a.Yw(Fa,"true",Xb.a.zV),tb=Xb.a.get(Fa));return tb}static b0c(Fa,tb){if(1<tb||-1>tb)return Fa;let dc=Fa.r,jc=Fa.g;Fa=Fa.b;0<tb?(dc=dc*(1-tb)+255*tb,jc=jc*(1-tb)+255*tb,Fa=Fa*(1-tb)+255*tb):(dc*=1+tb,jc*=1+tb,Fa*=1+tb);return hb.a.Tub(Math.round(dc),Math.round(jc),Math.round(Fa))}static OSd(Fa){return 128>=(222*Fa.r+707*Fa.g+71*Fa.b)/1E3}}Object(n.a)(Jb,"SheetTabButton",gb,[]);class Kb extends gb{constructor(Fa,tb,dc){super(document.createElement("a"),tb);this.qha=v.EwaSettings.ma(500)?W.a.Y9c:
W.a.$th;dc.qb(this.domElement,J.a.instance.ga(718),0,this.qha,J.a.instance.ga(718),va.a.n2c,!0);Fa.appendChild(this.domElement);this.Gc.ka("contextmenu",jc=>{Ra.g(jc)})}}Object(n.a)(Kb,"WorkbookProtectionButton",gb,[]);var Qa=a(51),ha=a(46),qa=a(57);class pb extends R.a{constructor(Fa,tb,dc=null){super(tb);this.sheetTabActivatePreviousHidden=J.a.instance.ga(727);this.sheetTabActivateNextHidden=J.a.instance.ga(729);this.svgIconProvider=null;this.xh=[];this.LK=Array(6);this.xyd=Array(6);this.BSa=this.Gyb=
this.KH=this.zxc=this.Adb=this.Bxc=this.NRd=this.fl=null;this.isRtl=!1;this.AK=this.fv=0;this.t7b=this.Ntc=!1;this.sqc=this.mna=0;this.GM=this.C3=this.X$=this.B7b=null;this.Pcc=this.eD=0;this.GNb=null;this.wBb=-1;this.GY=null;this.zpc=0;this.mzc=-1;this.Hma=0;this.Xta=new H;this.OLc=!1;this.Otc=this.Cxc=this.aMb=this.Qhe=this.q_=null;this.cae=!1;this.Mld=null;this.Mxd=!1;this.Phe=null;this.yD=(jc,fb)=>{this.qEf(fb.item)};this.cza=(jc,fb)=>{jc=this.$.xa.oa.index;for(let ec=0,lb=this.xh.length;ec<lb;ec++){const ac=
this.AQ(ec);if(ac.name===fb.oldName){ac.name=fb.newName;this.Y_();ec===jc&&this.k0(6);break}}};this.uEf=(jc,fb)=>{(jc=this.j3a(fb.item))&&jc.Ofb()};this.vEf=(jc,fb)=>{fb.visible?(this.sSa(!1),this.rEf(fb.item)):this.qEf(fb.item)};this.EN=jc=>{this.GF?(this.GY=jc,this.iPb()):(this.GY&&(this.sqc+=this.GY.clientPoint.x-jc.clientPoint.x),this.GY=jc,Math.abs(this.sqc)>=this.gjh&&this.iPb());return!0};this.QN=jc=>{jc.Ca.preventDefault();return!1};this.dYf=jc=>{this.$Xf(jc,!0)};this.cYf=jc=>{this.$Xf(jc,
!1)};this.g6=jc=>{if(this.GF&&(this.Bz||this.pif(jc)))if(this.t7b=this.uef(jc),this.Bz){let fb;jc=(fb=this.AQ(this.eD+1))?fb.sheet:null;this.reorderSheets(jc,this.eD+1===this.LRd,!0)}else jc=this.Mxd?null:this.Mld,this.reorderSheets(jc,this.Mxd,!0);this.kQ();return!0};this.Ih=(jc,fb)=>{fb.ED&&this.z_d(fb.ED);this.Ewc(!1);this.Y_();fb.oa&&(this.z_d(fb.oa),this.k0(6),this.ea.mma())};this.dvf=(jc,fb)=>{this.NCc(fb.item)};this.evf=(jc,fb)=>{this.NCc(fb.item)};this.fvf=(jc,fb)=>{this.NCc(fb.item)};this.hPa=
(jc,fb)=>{this.NCc(fb.item)};this.Lya=()=>{this.b1c()};this.dd=()=>{this.isVisible=!this.ea.isNamedObjectViewMode;this.b1c();this.T4c();v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(qa.d(this.$)||qa.e(this.$))&&(ha.PageLoadTrackingInfo.instance.JR(t.a.RAa,["sheetTabBar"]),ha.PageLoadTrackingInfo.instance.nW(t.a.RAa,["sheetTabBar"]));this.B4c();this.Y_();this.sSa(!0);this.k0(6)};this.gj=()=>{this.isVisible&&(this.Y_(),this.k0(6))};this.Vf=()=>{Object(G.a)(sa,this.KH)===
ta.k(this.$.sg)&&this.B4c();for(const jc of this.xh)jc.Foj(!ta.k(this.$.sg))};this.tEf=(jc,fb)=>{this.Wdj(fb.item,fb.isUserOperation)};this.BFb=(jc,fb)=>{this.rEf(fb.item)};this.onKeyDown=jc=>{switch(jc.keyCode){case 9:var fb=this.domElement.querySelectorAll(Z.DOMElementExtensions.Cr);const ec=Z.DOMElementExtensions.rm(fb);fb=Z.DOMElementExtensions.lB(fb);Z.DOMElementExtensions.JAa(jc,ec,fb);break;case 39:case 37:Z.DOMElementExtensions.a0f(jc,this.domElement.querySelectorAll(Z.DOMElementExtensions.Cr),
39===jc.keyCode?!this.isRtl:this.isRtl)}y.ULS.sendTraceTag(537153691,0,50,`SheetTabBarControl.OnKeyDown: Press on ${jc.keyCode}`)};this.onScroll=()=>{this.fl.scrollLeft!==this.mna&&this.gJj()};this.ON=jc=>{if(jc.ctrlKey||jc.Z2)return!1;this.fl.scrollLeft+=Math.floor(30*jc.rCa);if(this.Bz&&this.GF){const fb=this.B_e("OnMouseWheel");fb&&this.gWd(0<jc.rCa,fb.x+fb.width/2)}return!0};this.TF=(jc,fb)=>{if(this.Xta)this.i7e("PartialInteractivity",fb.dM?3:0);else{this.kQ(!1);this.oQd(fb.dM);for(const ec of this.yue)ec&&
ec.WW(fb.dM);for(const ec of this.xh)ec&&ec.WW(fb.dM)}};this.JEb=(jc,fb)=>{jc=0;fb.Fle&&(jc=2|(fb.Evj?1:0));this.i7e("ComponentRangePicker",jc)};this.$=Fa;this.ea=this.$.ea;this.J7b=(this.Bz=r.a.qgf())&&!v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");this.vm=v.EwaSettings.ma(500);this.xw=r.a.Xqd();this.mif=this.vm&&!this.$.Az;this.Bz&&(this.cae=this.vm&&!x.a.tv);this.MCi=this.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;this.LCi=this.$.ya.SheetTabNavigateButtonIntervalPeriodMS;
this.gjh=this.$.ya.SheetTabDragStartPixelThreshold;this.SPa=this.TPa=-1;this.$2c=!1;this.xw&&(this.svgIconProvider=dc);this.xC=new pa.a(this.domElement,3);this.vm&&this.domElement.classList.add(O.bth);this.c9g();this.F6g();this.d9g();v.EwaSettings.mN()&&document.getElementById(t.a.$aa)||this.h$g();this.Ewc(!0);this.dd(null,null);Fa=this.$.xa;Fa.Qf(this.Ih);Fa.rVc(this.Lya);Fa.bY(this.yD);Fa.Oga(this.BFb);Fa.YFa(this.cza);Fa.Joe(this.tEf);Fa.iZa(this.vEf);Fa.OGg(this.uEf);Fa.DVc(this.dvf);Fa.Goe(this.evf);
Fa.Hoe(this.fvf);Fa.Ioe(this.hPa);this.$.kl(this.dd);this.$.LA(this.gj);da.a(this.$).di(this);this.$.da.Ga(32,this);v.EwaSettings.isChangeGateEnabled("OfficeVSO:6326641_CoauthWorkbookProtectionSupport")&&this.$.ea.Vu(this.Vf);this.Axc=this.ve.$d(this.domElement);this.Axc.ka("keydown",this.onKeyDown);wa.a(this.$).gq()&&this.TF(null,new ua.a(!0));wa.a(this.$).Wf.E9(this.TF);ja.g(this.$).goe(this.JEb);this.Axc.ka("mousedown",jc=>{jc.preventDefault()});B.a.instance.ra(z.a.rD,this.domElement,this.ON);
this.MRd=this.ve.$d(this.fl);this.MRd.ka("scroll",this.onScroll);this.gJj=Da.a(()=>{this.Y_()},200,this.$.la,ka.a.Jvj,!0);this.$.gD(t.a.tCj);this.mif&&(this.Phe=new Ha(this.$,this.BSa.domElement));v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ha.PageLoadTrackingInfo.instance.c0(t.a.RAa,["sheetTabBar"])}get nc(){return this.domElement}get Jf(){return this.isVisible}get ee(){return P.a.KRd}get GF(){return this.OLc}get LRd(){return this.xh.length}get wxc(){return this.Qhe}get rxa(){return this.cae}get navigationButtonsDisabled(){return!!this.Xta&&
this.Xta.navigationButtonsDisabled}get operationButtonsDisabled(){return!!this.Xta&&this.Xta.operationButtonsDisabled}get wyd(){return this.vm?this.$.sJ?[W.a.I8b,W.a.qPe,W.a.sPe,W.a.H8b,W.a.Dua,W.a.Dua]:[W.a.H8b,W.a.sPe,W.a.qPe,W.a.I8b,W.a.Dua,W.a.Dua]:this.$.sJ?[W.a.I8b,W.a.pPe,W.a.rPe,W.a.H8b,W.a.Dua,W.a.Dua]:[W.a.H8b,W.a.rPe,W.a.pPe,W.a.I8b,W.a.Dua,W.a.Dua]}get yyd(){return this.$.sJ?[null,va.a.bCe,va.a.$Be]:[null,va.a.$Be,va.a.bCe]}get SJf(){return this.$.sJ?[null,va.a.cCe,va.a.aCe]:[null,va.a.aCe,
va.a.cCe]}get cCb(){if(this.isRtl){if(x.a.JF)return 0;if(x.a.Uf)return-1*(this.fl.scrollWidth-this.fl.clientWidth);if(x.a.tv)return this.fl.scrollWidth-this.fl.clientWidth;y.ULS.sendTraceTag(537153762,0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}get UJb(){if(this.isRtl){if(x.a.JF)return this.fl.scrollWidth-this.fl.clientWidth;if(x.a.Uf||x.a.tv)return 0;y.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.fl.scrollWidth-
this.fl.clientWidth}get yue(){return this.Xta?[this.KH,this.Gyb]:[this.KH,this.Gyb,this.BSa]}get HHj(){return this.xh.concat(this.BSa)}get Cvj(){return this.Phe}qb(Fa,tb,dc,jc,fb,ec,lb=!1){Fa.removeAttribute("Href");Fa.setAttribute(t.a.Kd,t.a.Ys);Fa.className=O.Psh;Fa.title=tb;Fa.tabIndex=0;this.xw&&ec?dc=this.svgIconProvider.lba(ec,12,12,Fa,24,24):(tb=document.createElement("span"),tb.className=this.vm?W.a.a_g:W.a.WA,tb.classList.add(V.a.bia),tb.tabIndex=-1,Fa.appendChild(tb),ec=document.createElement("img"),
ec.src=Na.a.Ue(dc),ec.className=jc,ec.alt=fb,ec.tabIndex=-1,tb.appendChild(ec),dc=ec);lb&&Fa.classList.add(V.a.dU);return dc}dispose(){if(this.$){var Fa=this.$.xa;Fa.Eg(this.Ih);Fa.fKd(this.Lya);Fa.V6(this.yD);Fa.Vma(this.BFb);Fa.VQa(this.cza);Fa.TRf(this.tEf);Fa.XIb(this.vEf);Fa.Pbj(this.uEf);Fa.sKd(this.dvf);Fa.QRf(this.evf);Fa.RRf(this.fvf);Fa.SRf(this.hPa);this.$.Hl(this.dd);this.$.LD(this.gj);wa.a(this.$)&&wa.a(this.$).Wf.nda(this.TF);this.Xta&&ja.g(this.$).uRf(this.JEb);B.a.instance.Ba(z.a.rD,
this.domElement,this.ON)}A.a.qc(this.xyd);this.xyd=null;if(this.LK)for(Fa=0;Fa<this.LK.length;Fa++){const tb=Z.DOMElementExtensions.gK(this.LK[Fa],this.domElement,!1,"a");tb&&I.a.Pma(tb)}A.a.Ia(this.xC);A.a.Ia(this.Axc);A.a.Ia(this.MRd);this.MRd=this.Axc=this.Gyb=this.KH=this.xC=null;this.$&&this.Bz&&this.kQ(!1);this.X$=null;this.HPd(null,"Dispose");this.GNb=this.GM=this.B7b=null;this.b1c();this.Adb=this.Bxc=this.NRd=this.fl=this.LK=this.$=this.ea=null;super.dispose()}hg(Fa,tb){if(!tb){y.ULS.shipAssertTag(537153760,
0,0<this.xh.length,"There is no sheet tab button.");if(!this.xh.length)return!1;Fa=null;for(const dc of this.xh)if(Fa=dc.uPh())break;if(!Fa)return y.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Z.DOMElementExtensions.setFocus(Fa)}return!tb}mh(Fa){return Z.DOMElementExtensions.xf(this.nc,Fa)}sj(){}Vj(){}reorderSheets(Fa,tb,dc){if(this.q_&&this.q_!==Fa){const jc=this.q_.index;this.Vdj(this.q_,Fa,tb);Fa=Fa?Fa.index-1:tb?this.$.xa.count-1:0;jc!==Fa&&(this.swi(jc,Fa,dc),this.amh(this.q_.name,
Fa))}}k0h(Fa){Fa=this.Pia(Fa);return-1!==Fa&&this.fv<=Fa&&Fa<=this.AK?this.xh[Fa].domElement:null}ETj(Fa){if(this.xw){for(var tb=0;tb<this.LK.length;tb++){const dc=this.LK[tb];if(dc&&this.svgIconProvider){const jc=dc.parentNode;this.YQf(dc);jc&&(this.LK[tb]=this.svgIconProvider.lba(Fa?this.SJf[tb]:this.yyd[tb],12,12,jc,24,24))}}for(tb=0;tb<this.xh.length;tb++)this.xh[tb].ufg(Fa);this.BSa&&this.BSa.Esa&&this.tfg(va.a.d2h,this.BSa,Fa);this.KH&&this.KH.Esa&&this.tfg(va.a.h1g,this.KH,Fa)}}tfg(Fa,tb,dc){tb.Aab||
(tb.Aab=this.svgIconProvider.lba(Fa,12,12,tb.Esa.parentNode,24,24));tb.Aab&&(Z.DOMElementExtensions.setVisible(tb.Esa,!dc),Z.DOMElementExtensions.setVisible(tb.Aab,dc))}hSi(Fa,tb){var dc=ja.g(this.$);const jc=dc.inRangePicker,fb=Ba.HelperMethods.Yn(tb);if(dc.eb&&!jc){const ec=dc.tm?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed";let lb=void 0;v.EwaSettings.h7a&&(lb=[Object(ca.a)(dc.hc.textBox.vBa)]);ca.b(this.$).HBa(fb.rawEvent,ec,lb);dc.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}dc=
this.rxa&&3===tb.tb;!(2===tb.tb&&fb.button===Sys.UI.MouseButton.leftButton||dc)||jc||this.GF||wa.a(this.$).gq()||(dc&&Fa.eSi(),this.wBb=tb.clientPoint.x,this.GY=tb,this.mPg(Fa))}fSi(Fa){!this.Bz&&this.GF&&this.ETd(Fa.sheet,!1)}gSi(Fa){this.Bz||(this.GF&&this.reorderSheets(Fa.sheet,!1,!0),this.kQ());this.Y_()}Dqe(){return this.$.isEditMode&&!ta.k(this.$.sg)}Y_(){const Fa=Ba.HelperMethods.Q5(()=>{this.ERj();this.vm&&this.etj();this.oQd()});y.ULS.sendTraceTag(537153757,0,50,`SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = ${Fa}`)}etj(){const Fa=
this.AK===this.xh.length-1;Z.DOMElementExtensions.toggleCssClass(this.Adb,this.$.sJ?O.tPe:O.iPe,!!this.fv);Z.DOMElementExtensions.toggleCssClass(this.Adb,this.$.sJ?O.iPe:O.tPe,!Fa)}oQd(Fa=!1){const tb=!this.fv,dc=this.AK===this.xh.length-1;this.G0f(4,this.sheetTabActivatePreviousHidden,!tb);this.G0f(5,this.sheetTabActivateNextHidden,!dc);this.Swc(0,tb||Fa);this.Swc(1,tb||Fa);this.Swc(2,dc||Fa);this.Swc(3,dc||Fa)}G0f(Fa,tb,dc){if(Fa=this.LK[Fa]){Z.DOMElementExtensions.setVisible(Fa,dc);var jc=this.j1e(Fa);
jc.title="img"===Fa.nodeName?Fa.alt=0<this.xh.length&&dc?tb:"":Fa.title=0<this.xh.length&&dc?tb:"";jc.tabIndex=dc?0:-1}}j1e(Fa){return this.xw?Fa.parentNode:Fa.parentNode.parentNode}Swc(Fa,tb){if(Fa=this.LK[Fa])Fa=this.j1e(Fa),void 0!==Fa&&null!==Fa&&(!this.xh.length||tb?(Fa.classList.add(V.a.dU),Fa.setAttribute(t.a.lsa,"true")):(Fa.classList.remove(V.a.dU),Fa.setAttribute(t.a.lsa,"false")))}sSa(Fa){const tb=this.$.sJ?this.xh.length-1:0;let dc=this.F3e(this.$.sJ?0:this.xh.length-1);dc&&(dc.borderRightWidth=
Fa?"1px":"0");this.fv!==this.AK&&(dc=this.F3e(tb))&&(dc.borderRightWidth="0")}Dne(Fa,tb){this.xh||(this.xh=[]);-1===tb?this.xh.push(Fa):this.xh.splice(tb,0,Fa)}Z4b(Fa,tb){let dc=-1,jc=null;tb||(dc=this.tTh(Fa.index),-1!==dc&&(jc=this.UKa(dc)));Fa=new Jb(this.$,this.fl,jc,Fa,this,this.vm,this.xw);this.Dne(Fa,dc);Z.DOMElementExtensions.setVisible(Fa.domElement,!0)}ETd(Fa,tb){var dc=this.j3a(Fa);if(dc){this.Mld=Fa;this.Mxd=tb;Fa=dc.domElement;dc=this.isRtl?Fa.offsetLeft+(this.fl.scrollWidth-this.fl.clientWidth-
this.fl.scrollLeft):Fa.offsetLeft-this.fl.scrollLeft;if(!this.isRtl&&tb||this.isRtl&&!tb)dc+=Fa.offsetWidth;this.zxc.style.left=Ba.HelperMethods.pc(dc-4);Z.DOMElementExtensions.setVisible(this.zxc,!0)}}w9e(){Z.DOMElementExtensions.setVisible(this.zxc,!1)}k0(Fa){const tb=Ba.HelperMethods.Q5(()=>{switch(Fa){case 0:this.tvc(0);break;case 1:this.tvc(this.fv-1);break;case 2:this.tvc(this.fv+1);break;case 3:this.scrollIntoView(this.xh.length-1);break;case 4:this.fv&&1<=this.xh.length&&(this.rle(this.fv-
1),this.dOd());break;case 5:this.AK!==this.xh.length-1&&1<=this.xh.length&&(this.rle(this.AK+1),this.dOd());break;case 6:this.dOd()}});this.J7b&&this.GF&&this.iPb();y.ULS.sendTraceTag(537153755,0,50,`SheetTabBarControl.ScrollSheetTabs: operation = ${Fa}, duration = ${tb}`)}rle(Fa){(Fa=this.AQ(Fa))&&Fa.activate()}VBh(Fa){if(0===Fa.aA){const tb=this.$.xa;let dc=0;for(let jc=0,fb=tb.count;jc<fb;jc++){const ec=Object(D.a)(ea.a,tb.getItem(jc));if(ec===Fa)return dc;0===ec.aA&&dc++}}return-1}IBh(Fa){const tb=
this.$.xa;for(let dc=Fa.index+1,jc=tb.count;dc<jc;dc++)if(Fa=Object(D.a)(ea.a,tb.getItem(dc)),0===Fa.aA)return Fa;return null}Pia(Fa){for(let tb=0;tb<this.xh.length;tb++){const dc=this.AQ(tb);if(!dc)y.ULS.sendTraceTag(537153754,0,15,`SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[${tb}] is null even though index is not out of bounds!`);else if(dc.sheet===Fa)return tb}return-1}j3a(Fa){Fa=this.Pia(Fa);return this.AQ(Fa)}swi(Fa,tb,dc){const jc={};jc.a=this.$.ya.UserSessionId;jc.b=dc;jc.c=
this.t7b;jc.d=Fa;jc.e=tb;jc.f=this.$.xa.count;Qa.b().Ne(2,jc,dc)}Vdj(Fa,tb,dc){const jc=Object(D.a)(Y.a,this.$.xa);tb?(tb=tb.index,tb=Fa.index<tb?tb-1:tb):tb=dc?jc.count-1:0;jc.reorderSheet(Fa,tb,!0)}e0f(Fa){ja.g(this.$).Ff.dm(Fa)}mPg(Fa){if(!this.Ntc){const tb=this.domElement.ownerDocument.body;this.Bz?(F.a.instance.ra(z.a.Gj,document.documentElement,this.EN),this.rxa&&(U.a.instance.ra(z.a.Yf,document.documentElement,this.EN),U.a.instance.ra(z.a.Yf,this.domElement,this.QN))):(F.a.instance.ra(z.a.Gj,
tb,this.EN),U.a.instance.ra(z.a.Yf,tb,this.EN));F.a.instance.ra(z.a.Nf,document.documentElement,this.g6);U.a.instance.ra(z.a.ue,tb,this.g6);this.Ntc=!0}this.q_=Fa.sheet;this.t7b=!1;this.Bz?(this.GM=null,this.B7b=Fa,this.X$=Fa.domElement,this.HPd(Z.DOMElementExtensions.getBoundingClientRect(this.X$),"BeginSheetTabButtonDrag")):(y.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),this.domElement.classList.add(O.hPe),this.domElement.style.cursor=
"",this.e0f("pointer"))}kQ(Fa=!0){if(this.Ntc){this.e0f(t.a.BQ);const tb=this.domElement.ownerDocument.body;this.Bz?(F.a.instance.Ba(z.a.Gj,document.documentElement,this.EN),this.rxa&&(U.a.instance.Ba(z.a.Yf,document.documentElement,this.EN),U.a.instance.Ba(z.a.Yf,this.domElement,this.QN))):(F.a.instance.Ba(z.a.Gj,tb,this.EN),U.a.instance.Ba(z.a.Yf,tb,this.EN));F.a.instance.Ba(z.a.Nf,document.documentElement,this.g6);U.a.instance.Ba(z.a.ue,tb,this.g6);this.OLc=this.Ntc=!1}this.sqc=0;this.t7b=!1;this.Mld=
this.q_=null;this.Bz?(this.X$&&(this.X$.style.visibility="visible",this.X$=null),this.B7b=null,this.HPd(null,"EndSheetTabButtonDrag"),this.GM&&(this.GM.parentNode&&this.GM.parentNode.removeChild(this.GM),this.GM=null),this.egj(Fa)):(this.domElement.classList.remove(O.hPe),this.w9e())}egj(Fa){this.rVd(Fa);this.eD=this.wBb=-1}amh(Fa,tb){var dc=this.$.pa;const jc=dc?dc.va:null;dc=()=>new Ua(Fa,tb);const fb=(ec,lb,ac)=>Pb(jc,Fa,tb,ec,lb,ac,null);v.EwaSettings.$b()?this.$.userOperationManager.Wb(new na.a(557,
0,fb,64,dc),null):this.$.userOperationManager.Wb(new K.a(557,0,fb,void 0,dc),null)}AQ(Fa){return 0<=Fa&&Fa<this.xh.length?this.xh[Fa]:null}E3e(Fa){return(Fa=this.AQ(Fa))?Fa.sheet:null}UKa(Fa){return(Fa=this.AQ(Fa))?Fa.domElement:null}F3e(Fa){return(Fa=this.UKa(Fa))?Fa.style:null}tTh(Fa){const tb=this.$.xa;Fa+=1;let dc=-1;const jc=this.xh?this.xh.length:0;for(;Fa<tb.count;){const fb=Object(D.a)(ea.a,tb.getItem(Fa));if(0===fb.aA){for(dc=0;dc<jc&&this.E3e(dc)!==fb;dc++);break}Fa++}return-1===dc||dc===
jc?-1:dc}qEf(Fa){var tb=this.j3a(Fa);tb&&(this.Bz&&this.GF&&(y.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ()),this.fl.removeChild(tb.domElement),tb=Array.indexOf(this.xh,tb),this.xh.splice(tb,1),this.Y_(),(!this.isRtl&&tb===this.xh.length||this.isRtl&&!tb)&&this.sSa(!0),this.J7b&&this.GF?Fa===
this.q_?(this.kQ(),this.k0(6)):this.iPb():this.k0(6))}rEf(Fa){const tb=Object(D.a)(ea.a,Fa);this.Bz&&this.GF&&(y.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ());if(0===tb.aA){this.sSa(!1);var dc=this.Pia(Fa);-1===dc&&(y.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),
this.Z4b(tb,!1),dc=this.Pia(Fa));this.s7e(dc,!0)}}Wdj(Fa,tb){const dc=this.j3a(Fa);dc&&(this.Bz&&this.GF&&!tb&&(y.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),v.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.kQ()),Fa=this.uHj(Fa,dc),!v.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Bz&&Fa&&tb&&Fa.dSi())}uHj(Fa,
tb){var dc=Array.indexOf(this.xh,tb);const jc=this.VBh(Object(D.a)(ea.a,Fa));if(-1===jc||-1===dc)return null;dc!==jc||this.Bz?(this.sSa(!1),{uCh:this.fv,cri:this.AK}=pb.Sdj(dc,jc,this.fv,this.AK),tb&&tb.domElement.parentNode===this.fl&&(this.fl.removeChild(tb.domElement),this.xh.splice(dc,1)),tb=this.IBh(Fa),dc=this.Pia(tb),tb=new Jb(this.$,this.fl,this.UKa(dc),Object(D.a)(ea.a,Fa),this,this.vm,this.xw),this.Dne(tb,dc),dc=this.Pia(Fa),this.s7e(dc,!1,!this.vm)):tb=null;return tb}Mmh(){const Fa=this.xh?
this.xh.length:0,tb=this.fv,dc=this.AK;for(let jc=0;jc<Fa;jc++){const fb=this.AQ(jc),ec=jc>=tb;fb&&(fb.tabIndex=ec&&jc<=dc?0:-1)}}pQj(){const Fa=this.xh?this.xh.length:0;for(let tb=0;tb<Fa;tb++){const dc=this.AQ(tb);dc&&dc.Ofb()}}s7e(Fa,tb,dc=!0){tb&&Fa<=this.fv&&this.fv++;this.Mmh();this.sSa(!0);this.Y_();this.J7b&&this.GF?this.iPb():dc&&this.k0(6)}Ewc(Fa){const tb=this.$.sJ;if(Fa||this.isRtl!==tb)this.isRtl=tb,this.domElement.classList.remove(this.isRtl?W.a.oPe:W.a.uPe),this.domElement.classList.add(this.isRtl?
W.a.uPe:W.a.oPe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.pQj();Fa||this.sSa(!0);for(Fa=0;Fa<this.LK.length;Fa++)0!==Fa&&3!==Fa&&(!this.vm||4!==Fa&&5!==Fa)&&this.H0f(Fa)}c9g(){const Fa=this.NRd=document.createElement("div");Fa.className=O.Msh;this.vm&&Fa.classList.add(O.Nsh);this.domElement.appendChild(Fa);this.T4b(Fa,1,722,721);this.T4b(Fa,2,724,723);this.mif&&(this.BSa=new Qb(this.$,this,Fa));this.vm||this.T4b(Fa,4,728,727)}d9g(){const Fa=this.Bxc=document.createElement("div");Fa.className=
O.Osh;this.domElement.appendChild(Fa);this.vm||this.T4b(Fa,5,730,729);this.B4c()}h$g(){const Fa=document.getElementById(t.a.Avj),tb=document.getElementById(t.a.Bvj);Fa&&!tb&&y.ULS.sendTraceTag(537153746,0,50,`CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: ${Fa.parentNode.id}. progressBar div has child: ${!!Fa.firstChild}. ProgressBarMessage div exists: ${!!document.getElementById(t.a.DRd)}`);const dc=r.a.tif(this.$);if(dc&&Fa&&tb)this.domElement.appendChild(Fa),
this.aMb=Fa.firstChild,this.Cxc=document.getElementById(t.a.DRd),tb.style.visibility="visible";else{const jc=document.createElement("div"),fb=document.createElement("div");jc.className=W.a.Xsh;fb.className=W.a.Vsh;v.EwaSettings.isChangeGateEnabled("OfficeVSO:7103434_sheetTabProgressBarId")&&(fb.id=t.a.vdb);fb.style.display="none";const ec=document.createElement("div");ec.className=W.a.Ysh;const lb=document.createElement("div");lb.className=W.a.Wsh;const ac=document.createElement("div");ac.className=
W.a.Ush;fb.appendChild(ec);fb.appendChild(lb);fb.appendChild(ac);jc.appendChild(fb);this.domElement.appendChild(jc);this.aMb=fb;this.Cxc=lb;y.ULS.sendTraceTag(512275475,0,50,"SheetTabBarControl.createProgressBarArea: Create the progress bar in this function, because isSkeletonProgressBarEnabled = {0}, skeletonProgressBar={1}, skeletonProgressBarSeperator={2}.",dc,Fa,tb)}}H0f(Fa){var tb=this.LK[Fa];if(tb)if(this.xw){const dc=tb.parentNode;this.YQf(tb);tb=ba.a(this.$)?this.SJf[Fa]:this.yyd[Fa];this.LK[Fa]=
this.svgIconProvider.lba(tb,12,12,dc,24,24)}else tb.className=this.wyd[Fa]}YQf(Fa){(null===Fa||void 0===Fa?0:Fa.parentNode)&&Fa.parentNode.removeChild(Fa)}F6g(){const Fa=this.Adb=document.createElement("div");Fa.className=O.Gsh;this.domElement.appendChild(Fa);this.lah(Fa)}lah(Fa){const tb=document.createElement("div");tb.className=O.$sh;tb.classList.add(O.Hsh);this.$.printingEnabled||tb.classList.add(Q.a.ARe);Fa.appendChild(tb);this.fl=document.createElement("ul");Z.DOMElementExtensions.yu(this.fl,
t.a.zXc,null,null);this.fl.className=Q.a.vPe;tb.appendChild(this.fl);this.W8g();this.Qhe=document.createElement("div");this.wxc.id="SheetIconTooltipContainer";tb.appendChild(this.wxc)}W8g(){const Fa=document.createElement("div"),tb="<div class='"+W.a.e_g+"'>{0}</div>",dc=Na.a.Tdd(W.a.Zth,0,"55_16_N","");Fa.innerHTML=String.format(tb,dc);Fa.className=O.Zsh;Z.DOMElementExtensions.setVisible(Fa,!1);this.zxc=Fa;this.fl.appendChild(Fa)}T4c(){const Fa=this.$.xa;for(let tb=0,dc=Fa.count;tb<dc;tb++){const jc=
Object(D.a)(ea.a,Fa.getItem(tb));0===jc.aA&&(this.Z4b(jc,!0),jc.active&&jc.activate())}}b1c(){A.a.qc(this.xh);this.xh=[];this.AK=this.fv=0}T4b(Fa,tb,dc,jc){const fb=document.createElement("a");Fa.appendChild(fb);Fa=this.yyd[tb];this.LK[tb]=this.qb(fb,J.a.instance.ga(jc),0,this.wyd[tb],J.a.instance.ga(dc),Fa);if(5===tb||4===tb)Z.DOMElementExtensions.gK(this.LK[tb],fb,!1,"span").style.marginTop="10px";this.H0f(tb);dc=this.xyd[tb]=this.ve.$d(fb);F.a.instance.ra(z.a.pointerDown,fb,lb=>lb.ctrlKey&&this.OIi(tb)?
!0:this.yBf(tb));F.a.instance.ra(z.a.Nf,fb,()=>this.zBf());U.a.instance.ra(z.a.ue,fb,()=>this.zBf());F.a.instance.ra(z.a.pointerOut,fb,()=>this.U0c());X.KeyInputManager.instance.ra(z.a.Qb,fb,lb=>13!==lb.Ca.keyCode&&32!==lb.Ca.keyCode||this.$2c?!1:(this.$2c=!0,this.yBf(tb)));X.KeyInputManager.instance.ra(z.a.Ed,fb,lb=>13===lb.Ca.keyCode||32===lb.Ca.keyCode?(this.$2c=!1,this.U0c()):!1);const ec=this.Dqe();jc=lb=>{"mouseup"===lb.type&&this.Bz&&this.GF||Ra.g(lb);fb.classList.contains(V.a.dU)||(ec?this.SOi(lb,
tb):this.vm||this.ABf(lb,tb))};dc.ka("mouseover",jc);dc.ka("mouseout",jc);dc.ka("focus",jc);dc.ka("blur",jc);ec&&dc.ka("mouseup",jc)}uef(Fa){let tb=!1;const dc=this.$.Ef;dc&&(tb=T.a.lN(Z.DOMElementExtensions.getBoundingClientRect(dc),Fa.clientPoint));return tb}pif(Fa){return T.a.lN(Z.DOMElementExtensions.getBoundingClientRect(this.domElement),Fa.clientPoint)||this.uef(Fa)}RBh(Fa){let tb=null;const dc=Fa.clientPoint;let jc=this.fv;if(this.pif(Fa))for(jc=this.fv;jc<=this.AK;jc++)if(tb=this.AQ(jc))if(Fa=
Z.DOMElementExtensions.getBoundingClientRect(tb.domElement),!this.isRtl&&dc.x<Fa.x+Fa.width||this.isRtl&&dc.x>Fa.x)break;return{returnValue:tb,fzj:jc>this.AK}}iPb(){if(this.Bz){if(!this.GM){y.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.GM=this.X$.cloneNode(!0);if(!this.BWf(this.GM,this.X$,!0,"UpdateDragAndDropState"))return;this.X$.style.visibility="hidden";this.GM.classList.add(O.ath);this.GM.style.borderRightWidth="";
this.Pcc=this.GY.clientPoint.x-this.C3.width/2;this.GM.style.left=this.Pcc+"px";this.eD=this.Pia(this.q_);0>this.eD&&y.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.J7b&&(this.eD=this.Pia(this.q_));var Fa=Z.DOMElementExtensions.getBoundingClientRect(this.fl),tb=Fa.x;Fa=Fa.x+Fa.width;let dc=this.GY.clientPoint.x-this.C3.width/2;dc=Math.min(dc,Fa-this.C3.width);dc=Math.max(dc,tb);this.GM.style.transform="translateX("+Math.abs(dc-this.Pcc)*(this.Pcc<
dc?1:-1)+"px)";const jc=this.GY.clientPoint.x>this.wBb;let fb=this.GY.clientPoint.x;dc>=Fa-this.C3.width?(fb=Fa-this.C3.width/2,this.aOd()||this.Hma||(y.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.zpc=this.fl.scrollLeft,this.Hma=window.requestAnimationFrame(this.dYf))):dc<=tb?(fb=tb+this.C3.width/2,this.$Nd()||this.Hma||(y.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),
this.zpc=this.fl.scrollLeft,this.Hma=window.requestAnimationFrame(this.cYf))):this.Hma&&(y.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.rVd());this.GY.clientPoint.x!==this.wBb&&(this.gWd(jc,fb),this.wBb=this.GY.clientPoint.x)}else(Fa=({fzj:tb}=this.RBh(this.GY)).returnValue)?this.ETd(Fa.sheet,tb):this.w9e();this.OLc=!0}gWd(Fa,tb){let dc;for(;({a2b:dc}=this.hjh(tb,Fa)).returnValue;)this.GNb=dc,this.NKg(Fa)}NKg(Fa){if(this.GNb){var tb=
(Fa?1:-1)*this.C3.width;if(Fa&&!this.$.sJ||!Fa&&this.$.sJ){var dc=this.X$;var jc=this.eD+1;var fb=!0}else dc=(jc=this.AQ(this.eD+1))?jc.domElement:null,jc=this.eD-1,fb=!1;if(this.BWf(this.GNb,dc,fb,"AnimateSheetSwap")){y.ULS.sendTraceTag(537153738,0,50,`SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index ${this.eD} and other sheet-index ${jc}. amount of sheets in the bar: ${this.LRd} isMovingRight: ${Fa}`);0<=this.eD&&this.eD<this.xh.length&&0<=jc&&jc<this.xh.length?(Fa=this.xh[jc],
this.xh[jc]=this.xh[this.eD],this.xh[this.eD]=Fa):(y.ULS.sendTraceTag(537153737,0,15,`SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: ${this.xh.length}, ghostIndex: ${this.eD}, swappedSheetIndex: ${jc}`),this.kQ());this.eD=jc;var ec=this.GNb;ec.style.transform="translateX("+tb+"px)";window.requestAnimationFrame(()=>{ec.style.transform="translateX(0px)"})}}}BWf(Fa,tb,dc,jc){const fb=ec=>ec?`Node ID: ${ec.id} , Node class: ${ec.className}, Node name: ${ec.nodeName},`:null;try{return this.fl.insertBefore(Fa,
tb),!0}catch(ec){return Fa=this.j3a(this.q_),y.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",Fa?Fa!==this.B7b?"Changed":"NoChange":"Removed",jc,fb(tb),fb(tb.parentNode),fb(this.fl),dc,this.eD,
this.LRd,ec),this.kQ(),!1}}hjh(Fa,tb){var dc=this.$.sJ===tb?this.AQ(this.eD-1):this.AQ(this.eD+1);if(!dc)return{returnValue:!1,a2b:null};dc=dc.domElement;const jc=Z.DOMElementExtensions.getBoundingClientRect(dc);return this.C3?tb?{returnValue:Fa+this.C3.width/2>=jc.x+.5*jc.width,a2b:dc}:{returnValue:Fa-this.C3.width/2<=jc.x+.5*jc.width,a2b:dc}:(y.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.kQ(),{returnValue:!1,a2b:dc})}$Xf(Fa,tb){let dc;dc=tb?this.dYf:this.cYf;if(-1===this.mzc)this.mzc=Fa,this.Hma=window.requestAnimationFrame(dc);else{Fa=Math.floor((Fa-this.mzc)/1E3*300);var jc=this.UJb>this.cCb?1:-1;this.scrollLeft(Math.abs(this.fl.scrollLeft-(tb?this.zpc+Fa*jc:this.zpc-Fa*jc))*(tb?-1:1));if(Fa=this.B_e("ScrollStep"))this.gWd(tb,Fa.x+Fa.width/2),tb&&!this.aOd()||!tb&&!this.$Nd()?this.Hma=window.requestAnimationFrame(dc):(y.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.rVd())}}aOd(){const Fa=this.UJb>this.cCb;return Fa&&this.mna>=this.UJb||!Fa&&this.mna<=this.UJb}$Nd(){const Fa=this.UJb>this.cCb;return Fa&&this.mna<=this.cCb||!Fa&&this.mna>=this.cCb}rVd(Fa=!0){this.fl&&(this.mna=this.fl.scrollLeft);window.cancelAnimationFrame(this.Hma);this.Hma=0;this.mzc=-1;Fa&&this.Y_()}HPd(Fa,tb){Fa||y.ULS.sendTraceTag(537153733,0,50,`SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by ${tb}`);this.C3=Fa}OIi(Fa){return 2===Fa?(this.k0(3),
!0):1===Fa?(this.k0(0),!0):!1}yBf(Fa){y.ULS.shipAssertTag(537153732,0,-1===this.TPa&&-1===this.SPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.TPa&&(window.clearTimeout(this.TPa),this.TPa=-1);-1!==this.SPa&&(window.clearInterval(this.SPa),this.SPa=-1);this.k0(Fa);this.TPa=window.setTimeout(()=>{this.dFj(Fa)},this.MCi);return!0}dFj(Fa){this.SPa=window.setInterval(()=>{this.k0(Fa)},this.LCi)}zBf(){this.U0c();
return!this.Bz||!this.GF}U0c(){window.clearTimeout(this.TPa);window.clearInterval(this.SPa);this.SPa=this.TPa=-1;return!0}ABf(Fa,tb){const dc=this.wyd[tb];Ba.HelperMethods.uXd(this.LK[tb],dc,dc+t.a.sec,"mouseover"===Fa.type||"focus"===Fa.type)}SOi(Fa,tb){const dc=this.Ugc(tb),jc=5===tb;if("mouseup"===Fa.type){if(jc||4===tb)dc||this.reorderSheets(null,jc,!1),this.kQ()}else!this.Bz&&this.GF?(dc||this.ETd(this.E3e(jc?this.AK:this.fv),jc),this.k0(jc?2:1)):this.vm||this.ABf(Fa,tb)}Ugc(Fa){return!!Z.DOMElementExtensions.Sed(this.LK[Fa],
"a").title}NCc(Fa){this.z_d(Fa);this.Y_()}z_d(Fa){(Fa=this.j3a(Fa))&&Fa.Ofb()}dOd(){var Fa=this.$.xa;if(Fa.oa&&(!qa.e(this.$)||Fa.count))if(Fa=this.Pia(Fa.oa),-1===Fa)y.ULS.sendTraceTag(537153729,0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var tb=this.UKa(Fa);Fa<this.fv?this.tvc(Fa):Fa>this.fv&&!this.Lrd(tb)&&this.scrollIntoView(Fa)}}ERj(){this.fv=0;this.AK=this.xh.length-1;let Fa=!1;for(let tb=0;tb<this.xh.length;tb++){const dc=this.AQ(tb);if(!dc)break;
const jc=this.Lrd(dc.domElement);dc.tabIndex=jc?0:-1;if(!Fa&&jc)this.fv=tb,Fa=!0;else if(Fa&&!jc){this.AK=tb-1;break}}}tvc(Fa){this.$.xa.count&&(this.xh.length||this.T4c(),this.TZf(this.UKa(Math.max(0,Math.min(Fa,this.xh.length-1)))),this.Y_())}scrollIntoView(Fa){y.ULS.shipAssertTag(537153697,0,Fa>=this.fv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.xh.length||this.T4c();var tb=this.UKa(Math.max(0,Math.min(Fa,
this.xh.length-1))),dc=this.UKa(this.fv);if(!this.Lrd(tb)){tb=Z.DOMElementExtensions.getBoundingClientRect(tb);var jc=Z.DOMElementExtensions.getBoundingClientRect(this.Adb);tb=this.isRtl?jc.x-tb.x:tb.x+tb.width-(jc.x+jc.width);for(jc=0;dc&&jc<tb;){const fb=Z.DOMElementExtensions.getBoundingClientRect(dc);jc+=fb.width;dc=dc.nextSibling}dc?this.TZf(dc):y.ULS.sendTraceTag(537153696,0,15,`SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = ${this.fv}, lastVisibleSheetTabIndex = ${this.AK}, scroll to index: ${Fa}`)}this.Y_()}}TZf(Fa){const tb=
Z.DOMElementExtensions.getBoundingClientRect(this.fl);Fa=Z.DOMElementExtensions.getBoundingClientRect(Fa);this.isRtl?this.scrollLeft(Math.floor(tb.x+tb.width-(Fa.x+Fa.width+.5))):this.scrollLeft(Math.ceil(tb.x-Fa.x-.5))}scrollLeft(Fa){(0>Fa&&this.aOd()||0<Fa&&this.$Nd())&&y.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");const tb=this.fl.scrollLeft;if(this.isRtl){if(x.a.JF||x.a.Uf){this.fl.scrollLeft=this.mna=tb-Fa;return}if(x.a.PH){this.fl.scrollLeft=
this.mna=tb+Fa;return}y.ULS.sendTraceTag(537153694,0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.fl.scrollLeft=this.mna=tb-Fa}Lrd(Fa){Fa=Z.DOMElementExtensions.getBoundingClientRect(Fa);const tb=Z.DOMElementExtensions.getBoundingClientRect(this.Adb);return Fa&&tb?Fa.x>=tb.x-1&&Fa.x+Fa.width<=tb.x+tb.width+1:(y.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)}x9g(){const Fa=this.Bxc;if(sa.k3f(this.$))this.vm?
(A.a.Ia(this.KH),this.KH=new sa(Fa,this.$,this,!0)):(A.a.Ia(this.KH),this.KH=null);else if(!this.KH||this.vm)A.a.Ia(this.KH),ta.k(this.$.sg)?this.KH=new Kb(Fa,this.$,this):this.KH=new sa(Fa,this.$,this)}DFe(Fa,tb){var dc=this.$.xa;if(!this.$.isEditMode||!dc.count)A.a.Ia(tb),tb=null;else if(!tb)if(dc=this.vm?this.NRd:this.Bxc,ta.k(this.$.sg))tb=new Kb(dc,this.$,this);else switch(Fa){case 0:tb=new sa(dc,this.$,this);break;case 1:tb=new ab(dc,this.$,this);break;default:y.ULS.sendTraceTag(537153692,0,
10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return tb}B4c(){v.EwaSettings.ma(424)?(this.KH=this.DFe(0,this.KH),this.Gyb=this.DFe(1,this.Gyb)):this.x9g()}B_e(Fa){const tb=Z.DOMElementExtensions.getBoundingClientRect(this.GM);tb||(y.ULS.sendTraceTag(537153689,0,50,`SheetTabBarControl.${Fa}: GetBoundingClientRect returned null for the dragged sheet.`),this.kQ());
return tb}i7e(Fa,tb){this.Xta.TLg(Fa,tb);this.kQ(!1);this.oQd(this.navigationButtonsDisabled);for(const dc of this.HHj)dc&&dc.WW(this.navigationButtonsDisabled);for(const dc of this.yue)dc&&dc.WW(this.operationButtonsDisabled)}static Sdj(Fa,tb,dc,jc){Fa<dc?(tb>dc&&dc--,tb>jc&&jc--):Fa>jc?(tb<dc&&dc++,tb<jc&&jc++):tb<dc&&dc++;return{uCh:dc,cri:jc}}}Object(n.a)(pb,"SheetTabBarControl",R.a,[377,10,107]);class bb extends u.a{constructor(Fa){super();this.$=Fa;this.Eb()}create(){const Fa=this.$.Cb;if(w.a(this.$.ya,
1))ha.PageLoadTrackingInfo.instance.qda(t.a.RAa,["sheetTabBar"]);else{var tb=document.getElementById(Fa+t.a.$5c);tb?(v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&ha.PageLoadTrackingInfo.instance.DAa(t.a.RAa),r.a.Xqd()?f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,388,387,this.fb),dc=>{this.pb(this.$.da.za(32)||new pb(this.$,tb,dc.result))},this.$.la,3):this.pb(this.$.da.za(32)||new pb(this.$,tb))):ha.PageLoadTrackingInfo.instance.qda(t.a.RAa,["sheetTabBar"])}}static ka(Fa){Fa.da.Ga(33,
new bb(Fa))}}Object(n.a)(bb,"SheetTabBarFactory",u.a,[]);a.d(C,"a",function(){return eb});const eb=()=>{c.a.Fa(Fa=>{bb.ka(Fa);m.ka(Fa)})}},1152:function(n,C,a){var c=a(9),b=a(1);n=a(0);var d=a(222),f=a(15),e=a(31),k=a(5),l=a(12),m=a(22),u=a(14),t=a(253),w=a(21),r=a(30);class v{constructor(Y){this.$uc=Y||""}static get XLe(){return v.c7d||(v.c7d=new v(""))}static get Fvd(){return v.Xbe||(v.Xbe=v.Ccd(2).$uc)}static D3a(Y){Y=r.a.zg(Y||"");return new v(Y)}static N$b(Y){return v.D3a(u.a.instance.ga(Y))}static Ccd(Y){return new v(u.a.instance.Va(Y))}static UEh(Y,
...ja){return v.TEh(u.a.instance.mb(Y),...ja)}static TEh(Y,...ja){const ca=ja.length,ba=Array(ca);for(let ua=0;ua<ca;ua++)ba[ua]=(ja[ua]||v.XLe).$uc;return new v(String.format(Y,ba))}}v.c7d=null;v.Xbe=null;Object(n.a)(v,"SafeHtml",null,[296]);const y=(Y,ja)=>{ja&&(Y.append(ja),Y.append(v.Fvd))};class x{constructor(Y,ja,ca){this.Swf=(ba,ua)=>{this.ENf(ua.Jd.command)};this.$=Y;this.Uea=document.createElement("div");this.Uea.setAttribute(k.a.yP,k.a.tk);this.Uea.className=e.a.O9c;ja.insertBefore(this.Uea,
ca);this.fga=document.createElement("div");this.fga.setAttribute(k.a.yP,k.a.tk);this.fga.className=e.a.O9c;ja.insertBefore(this.fga,this.Uea);this.Mtg=u.a.instance.Va(2);this.eha=document.createElement("div");this.eha.setAttribute(k.a.Kd,k.a.ksa);this.eha.setAttribute(k.a.nsa,k.a.pob);this.eha.className=e.a.O9c;ja.insertBefore(this.eha,this.fga);this.register();this.$.da.Ga(211,this)}get Zxa(){return this.Mtg}get isActive(){return!0}get activeCell(){return w.g(this.$).Vb(null)}dispose(){this.$&&this.unregister();
l.DOMElementExtensions.sf(this.eha);l.DOMElementExtensions.sf(this.Uea);l.DOMElementExtensions.sf(this.fga);this.fga=this.Uea=this.eha=this.$=null}setEnabled(Y){this.F_f(this.fga,Y)}aqj(){this.F_f(this.Uea,!0)}readText(Y){this.NHb(v.D3a(Y),!0)}sQa(Y){this.NHb(v.D3a(Y),!1)}HNf(Y,ja){if(1>ja||!Y)f.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ca=new Sys.StringBuilder;Y=String.format(u.a.instance.mb(34),ja,Y);y(ca,Y);y(ca,u.a.instance.ga(861));this.NHb(v.D3a(ca.toString()),
!1)}}R5i(Y,ja,ca){if(1>ca||1>ja||ja>ca||!Y)f.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var ba=new Sys.StringBuilder;y(ba,Y);ba.append(String.format(u.a.instance.mb(55),ja,ca));this.NHb(v.D3a(ba.toString()),!1)}}ENf(Y){Y=this.JWh(Y);this.NHb(Y,!1)}NHb(Y,ja){if(Y=Y?Y.$uc:null)ja=ja?this.fga:this.Uea,m.a.equals(ja.innerHTML,Y,!1)&&(Y+=v.Fvd),ja.innerHTML=Y}kbb(Y,ja){this.eha.getAttribute(k.a.nsa)!==ja&&this.eha.setAttribute(k.a.nsa,ja);Y=Y?v.D3a(Y).$uc:"";this.eha.innerHTML=
Y}S5i(Y,ja,ca,ba){const ua=u.a.instance.mb(54);f.ULS.shipAssertTag(537153949,0,!(void 0===Y||null===Y));f.ULS.shipAssertTag(537153948,0,!(void 0===ja||null===ja));f.ULS.shipAssertTag(537153947,0,!(void 0===ca||null===ca));f.ULS.shipAssertTag(537153946,0,!(void 0===ba||null===ba));f.ULS.shipAssertTag(537153945,0,!(void 0===ua||null===ua));Y=String.format(ua,Y||"",ja||"",ca||"",ba||"");this.kbb(Y,k.a.XZa)}tQj(Y){var ja=this.fga.style;Y?(Y=t.a.s1b(Y.cell,ja),ja=Y.OB,ja.top=ja.left=ja.bottom=ja.right=
null,Y.u2()):ja.cssText=""}JWh(Y){switch(Y){case -1985798686:return v.N$b(12);case -911352779:return v.N$b(11);case 237279923:return v.N$b(13);case -1502853784:return v.Ccd(81);case -111689794:return v.Ccd(78);case -287251124:return this.Ogd(1336,ja=>ja.bold);case -1925065947:return this.Ogd(1337,ja=>ja.italic);case 1764140053:return this.Ogd(1338,ja=>ja.underline)}return null}register(){f.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(f.ULS.shipAssertTag(537153943,
0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.WFa(this.Swf))}unregister(){this.$&&this.$.Ka.aAa(this.Swf)}F_f(Y,ja){const ca=Y===this.Uea;ja?(Y.setAttribute(k.a.nsa,k.a.XZa),ca&&Y.setAttribute(k.a.Kd,k.a.ksa),Y.setAttribute(k.a.yP,k.a.rr),Y.removeAttribute(k.a.yP),Y.innerHTML+=" "):(Y.removeAttribute(k.a.nsa),ca&&Y.removeAttribute(k.a.Kd),Y.setAttribute(k.a.yP,k.a.tk))}Ogd(Y,ja){const ca=this.activeCell;if(!ca)return null;ja=ja(ca)?7:8;return v.UEh(ja,v.N$b(Y))}}
Object(n.a)(x,"AriaLiveNotifier",null,[354,327,10]);class B extends d.a{constructor(Y){super();this.$=Y;this.Eb()}create(){this.pb(this.$.da.za(211)||new x(this.$,this.$.$u,this.$.Ef))}static ka(Y){Y.da.Ga(212,new B(Y))}}Object(n.a)(B,"AriaLiveNotifierFactory",d.a,[]);var z=a(27),A=a(213),I=a(138),F=a(67);class U{constructor(Y,ja){this.X_=this.hW=this.$N=null;this.aja=ja;this.y$g(Y);this.O_i();b.EwaSettings.xb()&&Y.da.Ga(244,this)}get isActive(){return!!this.aja&&document.activeElement===this.aja}readText(Y){Y=
String.format(u.a.instance.mb(30),Y);this.$N.setAttribute(k.a.Xt,Y);this.hW.setAttribute(k.a.Xt,Y);this.rHj()}dispose(){this.X_&&this.X_.parentNode&&this.X_.parentNode.removeChild(this.X_);this.hW=this.$N=this.X_=this.aja=null}y$g(Y){var ja=Y.Cb+"readoutElementWrapper";const ca=Y.Cb+"readoutElement1",ba=Y.Cb+"readoutElement2";this.X_=document.getElementById(ja);this.X_||(this.X_=document.createElement(A.a.div),this.X_.id=ja,this.$N=document.createElement(A.a.label),this.$N.id=ca,this.$N.setAttribute(I.a.contentEditable,
F.a.YPb),this.$N.setAttribute(k.a.Kd,k.a.YZa),this.hW=document.createElement(A.a.label),this.hW.id=ba,this.hW.setAttribute(I.a.contentEditable,F.a.YPb),this.hW.setAttribute(k.a.Kd,k.a.YZa),this.$N.style.width="0px",this.$N.style.height="0px",this.hW.style.width="0px",this.hW.style.height="0px",this.$N.tabIndex=-1,this.hW.tabIndex=-1,this.X_.appendChild(this.$N),this.X_.appendChild(this.hW),Y=Y.Cb+k.a.Y3b,ja=document.getElementById(Y),f.ULS.shipAssertTag(537153942,3,!!ja,`FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: ${Y}`),
ja&&ja.appendChild(this.X_))}O_i(){this.aja&&this.$N&&this.hW&&(this.aja.setAttribute(k.a.x2,this.$N.id),this.aja.setAttribute(k.a.wXc,`${this.$N.id} ${this.hW.id}`))}rHj(){if(this.isActive){let Y="";l.DOMElementExtensions.hasAttribute(this.aja,k.a.x2)&&(Y=this.aja.getAttribute(k.a.x2).toString());this.aja.setAttribute(k.a.x2,Y===this.$N.id?this.hW.id:this.$N.id)}else f.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")}static J6a(){if(null==U.Eub)if(b.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1)&&!z.a.eNa)U.Eub=!0,f.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(U.Eub=!1,z.a.PH||z.a.Uf)U.Eub=!0,f.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return U.Eub}static ka(Y){U.J6a()&&Y.da.Ga(244,new U(Y,w.g(Y).hc.textBox.Se))}}U.Eub=null;Object(n.a)(U,"FocusBasedReadout",null,[327,10]);class X extends d.a{constructor(Y){super();this.$=
Y;this.Eb()}create(){U.J6a()?w.g(this.$).hc.textBox.OT(()=>{const Y=this.$.da.za(244)||new U(this.$,w.g(this.$).hc.textBox.Se);this.pb(Y)}):this.pb(null)}static ka(Y){Y.da.Ga(315,new X(Y))}}Object(n.a)(X,"FocusBasedReadoutFactory",d.a,[]);var T=a(50),G=a(37),D=a(7),J=a(86),L=a(82);const H=Y=>{switch(Y){case 1:return 1459;case 2:return 1460;case 3:return 1461;case 4:return 1462;case 5:return 1463;case 6:return 1464;case 7:return 1465;case 8:return 1466;case 9:return 1467;case 10:return 1468;case 11:return 1469;
case 12:return 1470;case 13:return 1471;case 14:return 1472;case 15:return 1473;case 16:return 1474;case 17:return 1475;case 18:return 1476;case 19:return 1477;case 20:return 1478;case 21:return 1479;case 22:return 1482;case 23:return 1480;case 24:return 1481;case 25:return 1483;case 26:return 1484;case 27:return 1485;case 28:return 1486;default:return 1487}};var R=a(24),Q=a(43),O=a(240),V=a(47),W=a(45),da=a(122);class ta{static get H4i(){return ta.Ffe||(ta.Ffe=RegExp("([A-Z]+)","g"))}static get G4i(){return ta.Efe||
(ta.Efe=RegExp("([A-Z])","g"))}static get hYg(){return ta.C4d||(ta.C4d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}static Dgd(Y){return ta.y2e(Y.toString())}static y2e(Y){return ta.hYg.test(Y)?Y.replace(ta.H4i,"$1 ").replace(ta.G4i,' "$1"').trim():Y}static oej(Y){const ja=Y.lastIndexOf("!");return Y.substring(0,-1<ja?ja+1:0)+ta.y2e(Y.substring(-1<ja?ja+1:0,Y.length))}}ta.Ffe=null;ta.Efe=null;ta.C4d=null;Object(n.a)(ta,
"RangeAriaExtensions",null,[]);class K{constructor(){this.activeItemName=null;this.Zhf=!1;this.tableName=null;this.F0a=0;this.aAc=!1}}Object(n.a)(K,"SelectionReadoutState",null,[]);a(65);var na=a(77);class P{constructor(Y,ja,ca,ba,ua){this.gridReadoutNotifier=null;this.ebb=!1;this.Gsa=this.Aob=null;this.Zca=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!this.$?f.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
w.g(this.$).eb||this.r0b.lq()};this.QFi=()=>{if(!w.g(this.$).ha.Qa.fqd){var wa,ia=({activeCell:wa}=this.$Hh()).returnValue;this.readText(ia,wa)}};this.Ep=()=>{const wa=this.activeCell;this.readText("Editing",wa);b.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||wa&&wa.Ddc&&!w.g(this.$).S7e||this.r0b.cancel()};this.Vc=()=>{b.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!this.$?f.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(this.Zca(),this.ebb&&w.g(this.$).inRangePicker&&1===na.a.Gb&&(null===this.Aob?this.Aob=V.a.instance.create(this.YHd,P.YTc,"readSelectedRanges"):this.Aob.lq()))};this.$=ja;this.ariaLiveNotifier=Y;this.sparklineManager=ba;this.tableManager=ca;this.GD=new K;this.J6a=U.J6a();this.ebb=b.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.J6a&&(b.EwaSettings.xb()?this.gridReadoutNotifier=ua:this.gridReadoutNotifier=ja.da.za(244),f.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),P.YTc=700);this.r0b=V.a.instance.create(this.QFi,P.YTc,W.a.Bmj,!1);this.Ij()}get activeCell(){return w.g(this.$).Vb(null)}dispose(){this.$&&this.mk();J.a.Ia(this.r0b);this.sparklineManager=this.$=this.r0b=null}jYe(Y,ja,ca=!0){if(!Y)return"";var ba=this.$.da;const ua=new Sys.StringBuilder;this.ILg(ua,Y,ja);if(b.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var wa=this.tableManager.Gja(Y.range);(null===
wa||void 0===wa?0:wa.aTd)&&this.Hre(ua,wa);wa=this.tableManager.qn(Y.range);(null===wa||void 0===wa?0:wa.aba)&&this.Hre(ua,wa)}wa=Y.Zaa?this.Z_e(Y):Y.text;y(ua,wa);wa=this.$.activeItemName;this.GD.activeItemName!==wa&&(y(ua,wa),this.GD.activeItemName=wa);wa=1===ja.length?Q.K(ja).isSingle?"":u.a.instance.ga(857):String.format(u.a.instance.mb(31),ja.length);y(ua,wa);for(var ia of ja)y(ua,ta.Dgd(ia)),1===ja.length&&P.ooi(ia)&&(wa=w.g(this.$).Ea.es(ia.bottomRight),void 0!==wa&&null!==wa&&wa.text&&(wa=
wa.Zaa?this.Y_e(wa,wa.text):wa.text,y(ua,wa)));ia=Y.cell;ia=this.iUh(ia.Tij,ia.h0g);y(ua,ia);this.rLg(ua,Y);ca&&(Y.l7a?y(ua,u.a.instance.ga(845)):Y.oxa&&y(ua,u.a.instance.ga(846)));if(Y.hasAutoFilter||Y.t4)this.JLg(ua,Y.hasAutoFilter?Y.cell.autoFilterType:Y.cell.qYi),ca&&y(ua,u.a.instance.ga(848));O.c(this.$,Y.range)&&y(ua,u.a.instance.ga(852));this.oLg(ua,Y);ca=(ca=ba.za(14))?ca.XIh():"";y(ua,ca);Y.tF&&(ca=w.g(this.$).Ea.es(Y.range),ca=!!ca&&ca.i8e,P.Zvj(Y)?P.pLg(ua,Y):b.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&
ca?y(ua,u.a.instance.ga(850)):y(ua,u.a.instance.ga(849)));Y.Yaa&&(y(ua,u.a.instance.ga(851)),Y.ixb&&y(ua,String.format(u.a.instance.mb(16),Y.Lch)),y(ua,Y.iconName));Y.hasRichValueIcon&&(ia=this.$.da.za(271),ca="",ia&&Y.cell.$lf&&(ia=ia.gQ(Y.cell.$lf))&&ia.DomainId.Id!==P.CXj&&(ca=ia.Name),Y.cell.Xei?(y(ua,String.format(u.a.instance.mb(187),ca)),y(ua,u.a.instance.ga(1810))):(y(ua,String.format(u.a.instance.mb(185),ca)),y(ua,u.a.instance.ga(1809))));this.s5h(Y)&&y(ua,P.OPh(Y));(ba=ba.za(231))&&y(ua,
ba.m0e(ja,!0));1===ja.length&&ja[0].isSingle&&P.Yvj(Y,ja[0],this.$)&&(ja=this.$.da.za(271))&&y(ua,ja.jJh());Y.xOb&&Y.yOb&&y(ua,Y.yOb);(ja=Y.cell.XWg)&&y(ua,ja);Y.TMa&&Y.IGb&&(Y=Y.AEd)&&(y(ua,u.a.instance.ga(1983)),y(ua,Y));return ua.toString()}Dwe(Y){this.Gsa=this.GD;this.GD=Object(D.a)(new K,{activeItemName:this.Gsa.activeItemName,aAc:Y?this.Gsa.aAc:!1,tableName:Y?this.Gsa.tableName:"",F0a:Y?this.Gsa.F0a:-1})}eVf(){this.Gsa&&(this.GD=this.Gsa,this.Gsa=null)}iUh(Y,ja){return 2===Y||2===ja?u.a.instance.ga(879):
1===Y||1===ja?u.a.instance.ga(880):""}Z_e(Y){return this.Y_e(Y.cell,Y.text)}ILg(Y,ja,ca){if(ca&&1===ca.length&&ca[0].isSingle){ca="";var ba=this.tableManager.Gja(ja.range);if(ba){ca=ba.pivotTableName;this.WWc(Y,ca);var ua=ba.ygc?u.a.instance.ga(840):"";b.EwaSettings.isChangeGateEnabled("OfficeVSO:6154754_NarratorReadoutForPivotTableAltText")&&(ua+=(ba.altText?ba.altText+" . ":"")+(ba.altTextSummary?ba.altTextSummary:""));this.Jre(Y,!0,ca,ua);y(Y,this.tableManager.kmi(ba,ja.range)?u.a.instance.ga(842):
"");y(Y,this.tableManager.mgi(ba,ja.range)?u.a.instance.ga(841):"")}else if(ba=this.tableManager.qn(ja.range)){ca=(ua=w.g(this.$).Fb.hk(ja.range))?ua.name:"";this.WWc(Y,ca);let wa="";ua&&(wa=(ua.GTa?ua.GTa+" . ":"")+(ua.HTa?ua.HTa:""));this.Jre(Y,!1,ca,wa);y(Y,this.tableManager.fff(ba,ja.range)?u.a.instance.ga(841):"")}else this.WWc(Y,ca),this.GD.tableName="",this.GD.F0a=-1}}WWc(Y,ja){ja!==this.GD.tableName&&this.GD.tableName&&(Y.append(u.a.instance.ga(this.GD.aAc?839:838)),y(Y," "+this.GD.tableName))}Jre(Y,
ja,ca,ba){ca!==this.GD.tableName&&(Y.append(u.a.instance.ga(ja?837:836)),y(Y," "+ca),y(Y,ba),this.GD.tableName=ca,this.GD.aAc=ja,this.GD.F0a=-1)}Hre(Y,ja){const ca=w.g(this.$).ha.sa.activeCell;if(ca.top!==ja.top&&ca.left!==this.GD.F0a){Y.append(u.a.instance.ga(841));ja=new R.Range(ja.top,ca.left,ja.top,ca.left,!0,!0);y(Y,ta.Dgd(ja));if(ja=w.g(this.$).Vb(ja))ja=ja.Zaa?this.Z_e(ja):ja.text,y(Y,ja);this.GD.F0a=ca.left}}Y_e(Y,ja){const ca=Y.I5a;return Y.kxb?String.format(u.a.instance.mb(14),ja,ca):String.format(u.a.instance.mb(13),
ja,ta.oej(ca))}Ij(){f.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var Y=w.g(this.$);f.ULS.shipAssertTag(537153929,0,!!Y,"Can't register to grid's events");Y&&(Y.Xb.Vk(this.Ep),Y.Ea.Wv(this.Zca),Y.rC(this.Zca),this.ebb&&Y.Xb.lm(this.Lf.bind(this)),Y=Y.ha,f.ULS.shipAssertTag(537153928,0,!!Y,"Can't register to selectionManager's events"),Y&&(Y.YG(this.Vc),Y.vJ(this.Zca),Y.Qa.q2(this.Zca),this.ebb&&(this.YHd=this.YHd.bind(this))))}}mk(){if(this.$){var Y=
w.g(this.$);Y&&(Y.Xb.Ak(this.Ep),Y.Ea.Rw(this.Zca),Y.MD(this.Zca),this.ebb&&Y.Xb.Fl(this.Lf),Y=Y.ha)&&(Y.cG(this.Zca),Y.bL(this.Zca),Y.Qa.Uma(this.Zca))}}readText(Y,ja){this.J6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(Y):(b.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(Y),this.ebb&&!ja||this.ariaLiveNotifier.tQj(ja))}Lf(){this.Aob&&this.Aob.cancel()}YHd(){this.readText(this.uXh())}uXh(){let Y=
"";w.g(this.$).ha.rangePicker.XK.forEach(()=>{Y+=void 0});return Y+=" selected"}$Hh(){let Y;Y=null;var ja=w.g(this.$).ha;if(1!==ja.Me&&!ja.Qa.dc)return f.ULS.sendTraceTag(537153927,0,15,`selectionManager.CommandSelectionMode=${ja.Me} and selectionManager.SelectedFloatingObjectControl is null`),{returnValue:"",activeCell:Y};switch(ja.Me){case 2:return{returnValue:this.XKh(ja),activeCell:Y};case 64:var ca=ja.Qa.dc.floatingObject,ba="";if(ja=ja.Qa.dc.Ls||ja.Qa.dc.Fd)ba=(ba=ja.firstChild)?l.DOMElementExtensions.getTextContent(ba):
"";return{returnValue:String.format(u.a.instance.mb(53),P.$$b(ca.altText,ca.altTextDescription,ca.name),ba,ca.altTextDescription),activeCell:Y};case 4:return{returnValue:P.AKg(ja.Qa.dc.floatingObject),activeCell:Y};case 512:return{returnValue:da.a.IZe(ja.Qa.dc.floatingObject.W7c),activeCell:Y};case 8:return ca=ja.Qa.dc.floatingObject,{returnValue:String.format(u.a.instance.mb(51),ca?ca.name:""),activeCell:Y};case 1:return Y=this.activeCell,{returnValue:this.jYe(Y,ja.sa.selectedRanges),activeCell:Y}}return{returnValue:"",
activeCell:Y}}XKh(Y){const ja=new Sys.StringBuilder;ja.append(P.AXg(Y));const ca=this.$.da.za(231);ca&&y(ja,ca.m0e(Y.Qa.dc.floatingObject,!1));return ja.toString()}s5h(Y){Y=Y.kdf();let ja=!1;this.GD.Zhf!==Y&&(this.GD.Zhf=Y,ja=!0);return ja}rLg(Y,ja){if(ja.txb)if(ja=this.sparklineManager.qYh(ja)){var ca=u.a.instance,ba=ca.ga;a:switch(ja.type){case 0:var ua=833;break a;case 1:ua=834;break a;default:ua=835}ca=ba.call(ca,ua);y(Y,String.format(u.a.instance.mb(25),ca));ja=String.format(u.a.instance.mb(24),
ta.Dgd(ja.RDj));y(Y,ja)}else f.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),y(Y,String.format(u.a.instance.mb(25),""))}JLg(Y,ja){switch(ja){case 1:case 11:y(Y,u.a.instance.ga(853));break;case 6:y(Y,u.a.instance.ga(853));y(Y,u.a.instance.ga(855));break;case 7:y(Y,u.a.instance.ga(853));y(Y,u.a.instance.ga(856));break;case 2:y(Y,u.a.instance.ga(854));y(Y,u.a.instance.ga(855));break;case 3:y(Y,u.a.instance.ga(854));y(Y,u.a.instance.ga(856));break;default:y(Y,
u.a.instance.ga(854))}}oLg(Y,ja){var ca;const ba=this.$.da.za(65);ja=ba?ba.oKa(ja.range):null;let ua="";const wa=Object(L.a)(352,ja);if(ja)ua=!ja.S6a&&wa&&wa.Qni?String.format(u.a.instance.mb(29),wa.fIj):String.format(u.a.instance.mb(23),ja.author);else if(null===(ca=null===ba||void 0===ba?void 0:ba.Sm)||void 0===ca?0:ca.uF)ua=String.format(u.a.instance.mb(28),ba.Sm.zN.author);y(Y,ua)}static AKg(Y){return String.format(u.a.instance.mb(52),P.$$b(Y.altText,Y.altTextDescription,Y.name),Y.altTextDescription)}static OPh(Y){return u.a.instance.ga(Y.kdf()?
843:844)}static $$b(Y,ja,ca){return Y||ja?Y:ca}static AXg(Y){var ja=Y.Qa.dc;Y=ja.floatingObject;const ca=Y.Tc,ba=ca.ChartTitle,ua=Y.altText,wa=Y.altTextDescription,ia=!!(ca.Attributes&4);return(ja=ja.getSelectionDescription())?ja:ca.DataRangeForDisplay?String.format(u.a.instance.mb(ia?49:47),P.$$b(ua,wa,Y.name),wa,ba,u.a.instance.ga(H(ca.ChartCategory)),ca.DataRangeForDisplay):String.format(u.a.instance.mb(ia?50:48),P.$$b(ua,wa,Y.name),wa,ba,u.a.instance.ga(H(ca.ChartCategory)))}static Zvj(Y){return b.EwaSettings.ma(102)&&
(Y.B6a||Y.wgc)}static pLg(Y,ja){ja.mTa?ja.B6a?y(Y,String.format(u.a.instance.mb(26),ja.mTa.topLeft.toString())):ja.wgc&&(ja=ja.mTa.nS(),y(Y,String.format(u.a.instance.mb(27),(ja.LastColumn-ja.FirstColumn+1).toString(),(ja.LastRow-ja.FirstRow+1).toString()))):f.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.")}static Yvj(Y,ja,ca){return Y.tF||!b.EwaSettings.ma(138)?!1:(Y=ca.da.za(271))?
Y.Wfc(ja):!1}static ooi(Y){return Y.top===Y.bottom&&Y.left+1===Y.right||Y.top+1===Y.bottom&&Y.left===Y.right}}P.CXj=268435712;P.YTc=500;Object(n.a)(P,"SelectionReadoutHandler",null,[353,10]);var ka=a(55),pa=a(699);class Na extends d.a{constructor(Y){super();this.$=Y;this.Eb()}create(){const Y=this.$.da,ja=T.GetServiceTaskFactory.Sa(Y,211,212,this.fb),ca=T.GetServiceTaskFactory.Sa(Y,66,134,this.fb),ba=T.GetServiceTaskFactory.Sa(Y,240,239,this.fb);let ua=ka.Task.Ta(null);b.EwaSettings.xb()&&(ua=T.GetServiceTaskFactory.Sa(Y,
244,315,this.fb));G.TaskExtensions.Aa(G.TaskExtensions.Td([ja,ca,ba,ua],this.la),()=>{const wa=Object(pa.a)(this.$.da,226,()=>new P(ja.result,this.$,ca.result,ba.result,ua.result));this.pb(wa)},this.$.la,3)}static ka(Y){Y.da.Ga(227,new Na(Y))}}Object(n.a)(Na,"SelectionReadoutHandlerFactory",d.a,[]);class Z{constructor(Y,ja){this.$=ja;this.ariaLiveNotifier=Y}LNf(){const Y=this.ZIh();this.ariaLiveNotifier.kbb(Y,k.a.pob)}ZIh(){const Y=new Sys.StringBuilder;this.$.workbookContext&&y(Y,this.$.workbookContext.WorkbookFileName);
y(Y,u.a.instance.ga(859));y(Y,this.aJh());y(Y,this.$Ih());y(Y,u.a.instance.ga(860));return Y.toString()}aJh(){return this.$.isEditMode?u.a.instance.ga(864):u.a.instance.ga(865)}$Ih(){var Y=this.OWj();const ja=this.$.xa.oa;Y=1!==Y?String.format(u.a.instance.mb(32),Y):u.a.instance.ga(858);Y=new Sys.StringBuilder(Y);ja&&ja.sheetName&&(Y.append(v.Fvd),Y.append(String.format(u.a.instance.mb(33),ja.sheetName)));return Y.toString()}OWj(){let Y=0;for(const ja of this.$.xa.items)ja.visible&&Y++;return Y}}
Object(n.a)(Z,"WorkbookReadout",null,[]);class Ra{constructor(Y,ja,ca){this.uAf=()=>{this.n1d.LNf();this.ariaLiveNotifier.setEnabled(!0)};this.$=ja;this.ariaLiveNotifier=Y;this.n1d=new Z(Y,ja);this.u$b=ca.jgd(this.$);this.u$b.VGg(this.uAf)}dispose(){this.u$b&&this.u$b.Wbj(this.uAf);this.u$b=this.ariaLiveNotifier=this.$=null}}Object(n.a)(Ra,"EmbeddedWorkbookReadoutHandler",null,[10]);class Da{constructor(Y,ja){this.IV=()=>{this.Ad||this.ere()};this.Ad=!1;this.IY=ja.EY;this.ariaLiveNotifier=Y;this.n1d=
new Z(Y,ja);this.IY&&this.IY.OQ?this.ere():this.Ij()}dispose(){this.mk();this.ariaLiveNotifier=this.IY=null;this.Ad=!0}Ij(){if(this.IY){this.IY.Uu(this.IV);this.IY.Ea.Wv(this.IV);this.IY.rC(this.IV);var Y=Object(L.a)(207,this.IY);Y&&(Y.Xb.Vk(this.IV),Y.ha.YG(this.IV),Y.ha.vJ(this.IV),Y.ha.Qa.q2(this.IV))}else f.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")}mk(){if(this.IY){this.IY.Ea.Rw(this.IV);this.IY.MD(this.IV);const Y=Object(L.a)(207,
this.IY);Y&&(Y.Xb.Ak(this.IV),Y.ha.cG(this.IV),Y.ha.bL(this.IV),Y.ha.Qa.Uma(this.IV))}}ere(){this.n1d.LNf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.aqj();this.dispose()}}Object(n.a)(Da,"WorkbookReadoutHandler",null,[10]);class Ba extends d.a{constructor(Y){super();this.$=Y;this.Eb()}create(){const Y=T.GetServiceTaskFactory.Sa(this.$.da,211,212,this.fb);if(this.$.vK){const ja=T.GetServiceTaskFactory.Sa(this.$.da,12,477,this.fb);G.TaskExtensions.Aa(G.TaskExtensions.Td([Y,ja],this.$.la),
()=>{const ca=Object(pa.b)(this.$.da,228,()=>new Ra(Y.result,this.$,ja.result));this.pb(ca)},this.$.la,3)}else G.TaskExtensions.Aa(Y,ja=>{const ca=Object(pa.b)(this.$.da,228,()=>new Da(ja.result,this.$));this.pb(ca)},this.$.la,3)}static ka(Y){Y.da.Ga(229,new Ba(Y))}}Object(n.a)(Ba,"WorkbookReadoutHandlerFactory",d.a,[]);a.d(C,"a",function(){return ea});const ea=()=>{c.a.Fa(Y=>{B.ka(Y);b.EwaSettings.xb()?X.ka(Y):U.ka(Y);Na.ka(Y);Ba.ka(Y)})}},1155:function(n,C,a){var c=a(9);n=a(0);var b=a(694),d=a(50),
f=a(37),e=a(15),k=a(4),l=a(31),m=a(5),u=a(24),t=a(77),w=a(58);class r{constructor(Ua,nb){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=Ua;this.sortType=nb}QU(){return this.autoFilterOptions}}Object(n.a)(r,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[115]);class v{constructor(Ua){this.autoFilterOptions=null;this.autoFilterOptions=Ua}QU(){return this.autoFilterOptions}}Object(n.a)(v,"MacroRecorderRangeItemFilteredPayload",null,[115]);var y=a(1126),x=a(43),B=a(370),z=
a(171),A=a(61),I=a(162),F=a(240),U=a(47),X=a(45),T=a(12),G=a(282),D=a(1),J=a(183),L=a(22),H=a(281),R=a(21);class Q{constructor(Ua,nb){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=Ua;this.tableRange=x.l(Ua.Ranges[0],Ua.SheetName);this.styleIndex=nb}}Object(n.a)(Q,"MacroRecorderTableStyleAppliedPayload",null,[115]);class O extends Q{constructor(Ua,nb,Ha,sb){super(Ua,Ha);this.isCreation=this.hasHeaders=!1;this.hasHeaders=nb;this.isCreation=sb}}Object(n.a)(O,"MacroRecorderRangeFormatedAsTablePayload",
Q,[]);class V{constructor(Ua,nb,Ha){this.description=this.title=this.tableRange=null;this.tableRange=Ua;this.title=nb;this.description=Ha}qn(){return this.tableRange}getTitle(){return this.title}getDescription(){return this.description}}Object(n.a)(V,"MacroRecorderTableAltTextEditedPayload",null,[115]);class W{constructor(Ua,nb){this.newName=this.oldName=null;this.oldName=Ua;this.newName=nb}}Object(n.a)(W,"MacroRecorderTableRenamedPayload",null,[115]);class da{constructor(Ua){this.originalRange=null;
this.originalRange=Ua}}Object(n.a)(da,"MacroRecorderTableResizedPayload",null,[115]);class ta{constructor(Ua,nb,Ha){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=Ua;this.optionType=nb;this.isPivotTable=Ha}}Object(n.a)(ta,"MacroRecorderTableStyleOptionToggledPayload",null,[115]);var K=a(29),na=a(42);class P{constructor(Ua){this.tableName=null;this.tableName=Ua}}Object(n.a)(P,"MacroRecorderTableConvertedToRangePayload",null,[115]);var ka=a(805);class pa{constructor(Ua,
nb,Ha){this.Aqd=!1;this.sharedSheetRange=nb;this.$=Ua;this.ei=this.$.Jb.Rg("UserAction","ConvertToRangeManager");this.tableName=Ha}kab(){this.ei.start();const Ua=this.$.pa.va.Tb();return ka.i(this.$.pa.va,this.sharedSheetRange,nb=>{this.showDialog(nb)},null,null,null,Ua)}showDialog(Ua){e.ULS.sendTraceTag(537151193,0,50,`ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is ${this.ei.yc} milliseconds`);Ua&&!G.a(Ua)&&((this.Aqd=Ua.Result)?(Ua=K.a.Yc(3,2,0,743,0,-66108047,"ConvertToRange"),
f.TaskExtensions.Aa(na.a(this.$).uj(Ua),nb=>{e.ULS.sendTraceTag(537151192,0,50,`ConvertToRangeManager.ShowDialog: Time taken for User Input is ${this.ei.yc} milliseconds`);0===nb.result&&this.v4g()},this.$.la,11)):this.w4g());this.ei.stop();e.ULS.sendTraceTag(537151191,0,50,`ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is ${this.ei.yc} milliseconds`)}Hve(){const Ua={};Ua.IsQueryTable=this.Aqd;Ua.Range=this.sharedSheetRange;return Ua}v4g(){const Ua=this.$.pa.va;e.ULS.sendTraceTag(537151190,
0,50,"Convert To Range initiated for Query Table");this.vcf(194,(nb,Ha,sb)=>ka.d(Ua,this.Hve(),nb,Ha,sb,null));e.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")}w4g(){const Ua=this.$.pa.va;e.ULS.sendTraceTag(537151188,0,50,"Convert To Range initiated for Normal Table");this.vcf(193,(nb,Ha,sb)=>ka.c(Ua,this.Hve(),nb,Ha,sb,null),()=>new P(this.tableName));e.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")}vcf(Ua,nb,Ha=null){B.a(this.$.userOperationManager,
nb,sb=>new z.a(Ua,0,sb,void 0,Ha),null)}}Object(n.a)(pa,"ConvertToRangeManager",null,[]);var Na=a(1125),Z=a(949),Ra=a(14);class Da extends Z.a{constructor(Ua,nb){super(Ua);this.MNb=nb}get uc(){return"FormatAsTableDialog"}get hA(){return 215}get Nl(){return Ra.a.instance.ga(737)}Qj(){const Ua=x.s(this.I$.TableRange);return()=>new O(Ua,this.hasHeaders,this.MNb,!0)}EE(){const Ua=x.s(this.I$.TableRange),nb=this.I$.HasTotalRow;return(Ha,sb,Qb)=>ka.h(this.$.pa.va,Ua,this.hasHeaders,!1,nb,this.MNb,Ha,sb,
Qb,null)}}Object(n.a)(Da,"FormatAsTableReactDialog",Z.a,[]);Z=a(284);var Ba=a(96);class ea extends Z.a{constructor(Ua){super(Ua);this.UHj=(nb,Ha)=>{1===nb&&this.AMj(x.D(this.BHf(Ha[ea.XMf])))};this.Zvb=nb=>{nb=this.Afd(nb);return this.Ucd(nb)};this.gridView=R.g(Ua);this.sa=this.gridView.ha.sa;this.Apc=this.gridView.Fb.hk(this.sa.activeCell).usedRange;Ua=this.WM(this.Apc.toString());this.initializeAndShow(Ra.a.instance.ga(738),this.UHj,Ua)}get uc(){return"ResizeTableDialog"}BHf(Ua){Ua=Ua.startsWith("=")?
Ua.substring(1,Ua.length):Ua;if(({sheetName:Ua,range:nb}=x.Z(Ua,this.$.xa)).returnValue&&nb){var nb=x.v(nb,this.$);nb.SheetName=L.a.equals(Ua,"",!0)?this.$.oa.name:Ua;return nb}return null}WM(Ua){return{[ea.D4]:"ResizeTableDialog",[ea.XMf]:Ua,["getInputErrorIfInvalid"]:this.Zvb}}Afd(Ua){Ua=this.BHf(Ua);if(!Ua)return 1;const nb=x.D(Ua);return L.a.equals(Ua.SheetName,this.$.oa.sheetName,!0)&&this.Apc.top===nb.top&&this.Apc.Bd(nb)?0:2}Ucd(Ua){let nb="";switch(Ua){case 1:nb=Ra.a.instance.ga(75);break;
case 2:nb=Ba.a.ki(Ra.a.instance.ga(74))}return nb}AMj(Ua){this.$.fd(-1400250766,t.a.Gb,8,{["ResizeTableRange"]:Ua,["OriginalTableRange"]:this.Apc})}}ea.D4="id";ea.XMf="range";Object(n.a)(ea,"ResizeTableDialog",Z.a,[]);class Y extends Z.a{constructor(Ua){super(Ua);Ua=R.g(this.$);Ua=Ua.Fb.hk(Ua.ha.sa.activeCell);L.a.Fh(Ua.GTa)?this.xDd="":this.xDd=Ua.GTa;L.a.Fh(Ua.HTa)?this.wDd="":this.wDd=Ua.HTa;Ua=this.WM(this.xDd,this.wDd);this.initializeAndShow(Ra.a.instance.ga(747),this.MHj,Ua)}get uc(){return"TableAltTextDialog"}MHj(Ua,
nb){1===Ua&&(Ua=nb[Y.mKj],nb=nb[Y.Ueh],Ua===this.xDd&&nb===this.wDd||this.$.fd(868579142,t.a.Gb,8,{["Title"]:Ua,["Description"]:nb}))}WM(Ua,nb){return{["id"]:"AltTextDialog",["title"]:Ua,["description"]:nb}}}Y.D4="id";Y.mKj="title";Y.Ueh="description";Object(n.a)(Y,"TableAltTextDialog",Z.a,[]);var ja=a(772),ca=a(773),ba=a(112),ua=a(68),wa=a(55),ia=a(33),xa=a(172),gb=a(97);class va{constructor(Ua,nb,Ha,sb){this.menuId=null;this.SRa=-1;this.JIi=Qb=>{if(!G.a(Qb)){const Pb=R.g(this.$);var mb=new u.Range(1,
1,1,1,!0,!1);mb=x.v(mb,this.$);null!=Qb.Result&&(xa.a("CreateSampleTable.NewSheet"),mb.SheetName=Qb.Result.toString());Pb.yg(mb,null,null,null,0,gb.a.createSampleTable)}};this.$Ef=()=>{this.fda()};this.yTi=Qb=>{if(!(this.sa.lMa()||(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||G.a(Qb)||this.EMa())&&G.a(Qb)&&this.EMa())){Qb=this.sa.activeCell;var mb=this.sa.activeRange;const Pb=this.tableManager.Mg.usedRange;2===this.SRa&&I.g(this.tableManager.Mg)&&
Qb.bottom===Pb.bottom&&(mb=mb.o5?new u.Range(mb.top-1,mb.left,mb.bottom-1,mb.right,!1,!0):new u.Range(mb.top,mb.left,mb.bottom-1,mb.right,!1,!0),Qb=mb.contains(Qb)?Qb:u.Range.Uc(mb.bottom,Qb.left),R.g(this.$).ha.updateSelection(mb,Qb,0,3))}};this.RSi=Qb=>{G.a(Qb)?(e.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),this.$.$e()):e.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};
this.QSi=()=>{e.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");this.$.$e()};this.SSi=(Qb,mb)=>{mb&&this.oS(mb);G.b(Qb,-569193796)&&(ua.a(this.$).kd.gM(-569193796),this.Sri(Qb.Errors[0]))};this.$=Ua;this.tableManager=nb;this.namedSheetViewPublic=Ha;this.frame=this.$.frame;this.ha=R.g(this.$).ha;this.sa=this.ha.sa;this.vz=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=sb;this.tableStyleManager.cIg(this.$Ef)}Lc(Ua,
nb){switch(nb){case -544558380:return!(this.tableManager&&this.sa.sK()&&!this.EMa()&&I.d(this.tableManager.Mg));case 1544516694:return!(this.tableManager&&(this.sa.sK()?!this.EMa():this.sa.lMa()));case -697806646:case 323142015:return!this.sa.sK();case 341449783:case 2128797448:return D.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.sa.sK()?!this.EMa():this.sa.lMa())):!(this.tableManager&&this.tableManager.Mrd(this.sa.activeCell));case -123538519:return!(this.sa.sK()&&
this.tableStyleManager&&this.tableStyleManager.Nrd());case 756677940:return!(D.EwaSettings.ma(407)&&this.sei());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&this.tei());case 844144422:return!this.sa.sK();case -723113214:return!this.sa.sK()}return!1}executeCommand(Ua,nb,Ha){var sb;Ua=f.TaskExtensions.ak();const Qb=this.$.pa.va;let mb=null,Pb=1;const gc=nb.command,Xb=this.$.pa.va.Tb();let Ca=null;switch(gc){case -2058042992:const ma=w.a.$h(Ha[t.a.kg]);D.EwaSettings.isChangeGateEnabled("OfficeVSO:7010744_RegressionFix_MacroRecording_ClearFilterInAFMenu")&&
!ma.CriteriaType&&(ma.CriteriaType=0);va.QZf(this.$,ma);mb=(Qa,ha,qa)=>ka.a(Qb,ma,null,null,!1,!1,!1,ja.a.Qva(ba.a.tsa,ca.a.clearAutoFilter,Qa),ha,qa,null);Pb=176;Ca=()=>new v(ma);break;case 504133448:case -798968736:case 477776686:const hb=w.a.$h(Ha[t.a.kg]),vb=Ha.TopCellAddress;va.QZf(this.$,hb);const Va=504133448===nb.command?1:-798968736===nb.command?2:3;if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&vb){Ha=this.tableManager.qn(vb);if(!Ha&&D.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var ra=
this.$.xa.oa;(null===(sb=x.D(ra.y0))||void 0===sb?0:sb.contains(vb))?Ha=x.D(ra.y0):e.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||Ha&&!this.$.pXc([Ha],!0,1))break}else if(Ha&&!this.$.Sp([Ha],!0,1))break}mb=(Qa,ha,qa)=>A.H(Qb,hb,Va,H.b(Qa,this.SSi),ha,qa,vb,Xb);Pb=177;Ca=()=>new r(hb,Va);break;case 341449783:case 2128797448:this.SRa=
341449783===gc?0:2;({nCa:mb,operationName:Pb,Qj:Ca}=this.toggleTableStyleOption(Qb,Xb));break;case -712419744:this.vz?this.fcf(Ha[m.a.event]):this.fcf(null);break;case -1618606498:case 2095618440:case 1890380184:case 1371713064:let db=x.r(this.sa.selectedRanges,this.$);if(!db)break;const oa=this.fXh(gc,Ha);mb=(Qa,ha,qa)=>ka.e(Qb,db,oa,H.b(Qa,this.JIi),ha,qa,null,Xb);sb="TestHost"===this.$.ya.DocumentHostInfo.HostTier;e.ULS.shipAssertTag(512275419,0,"OneDriveWOPI"===this.$.ya.HostName||sb,"TableCommandHandler.CreateSampleTable: command executed for non-consumer audience and missing macro recorder");
Pb=1025;break;case 1868184698:if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({fzb:sb,nCa:mb,Qj:Ca}=this.Cbg(null,Xb),sb)){Pb=206;break}new Na.a(this.$);break;case 844144422:new ea(this.$);break;case 1544516694:case -544558380:if(sb=Ha[t.a.Qc])this.SRa=this.oZh(sb),-1!==this.SRa&&({nCa:mb,operationName:Pb,Qj:Ca}=this.toggleTableStyleOption(Qb,Xb));break;case 756677940:if(this.EMa()&&this.dhf()){e.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");
break}const Oa=Ha.Text,Wa=this.GRh();if(Wa){mb=(ha,qa,pb)=>ka.j(Qb,Oa,Wa,H.b(ha,this.RSi),H.a(qa,this.QSi),pb,Xb);Pb=217;let Qa=null;this.tableManager.Mg?Qa=this.tableManager.Mg.name:this.tableManager.cGd?Qa=this.tableManager.cGd.name:e.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Qa&&(Ca=()=>new W(Qa,Oa))}else return e.ULS.sendTraceTag(537151175,
0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),wa.Task.Ta(!1);break;case 323142015:if(this.EMa())break;return(new pa(this.$,this.mdd(),this.tableManager.Mg.name)).kab();case -1400250766:Pb=211;mb=this.Ugj(Ha,Qb,Xb);const Sa=x.m(Ha.OriginalTableRange,this.$.xa.oa);Ca=()=>new da(Sa);break;case 1872288872:this.tableManager.p3i();break;case -123538519:const yb=this.nZh(Ha);sb=L.a.contains(Ha[t.a.Qc],m.a.gHb,!0)||L.a.contains(Ha[m.a.nG],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";
e.ULS.sendTraceTag(51181323,0,50,`TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from ${sb} with style index ${yb.toString()}`);let Ma=this.r3e();Ma&&(mb=(Qa,ha,qa)=>ka.b(Qb,Ma,yb,Qa,ha,qa,null,Xb),Ca=()=>new Q(Ma,yb),Pb=212);break;case 753331043:sb=Ha[t.a.Qc];if(!sb)break;const Bb=Number.parseInvariant(sb);if(this.sa.sK()){e.ULS.sendTraceTag(51181321,0,50,`TableCommandHandler.FormatAsTable invoked on existing table with style index: ${Bb}`);let Qa=this.r3e();Qa&&(mb=(ha,
qa,pb)=>ka.h(Qb,Qa,!1,!1,!1,Bb,ha,qa,pb,null,Xb),Ca=()=>new O(Qa,!1,Bb,!1),Pb=215);break}if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:6224451_CreateTableInEmptyCell")&&({fzb:Ha,nCa:mb,Qj:Ca}=this.Cbg(Bb,Xb),Ha)){Pb=215;break}e.ULS.sendTraceTag(51181322,0,50,`TableCommandHandler.FormatAsTable invoked on newly created table with style index: ${Bb}`);new Da(this.$,Number.parseInvariant(sb));break;case 71074531:const Nb=Ha.HasHeader,Ia=Ha.TableRange;mb=(Qa,ha,qa)=>ka.f(Qb,Ia,Nb,!1,!1,Qa,ha,qa,null);
Ca=()=>new y.a(Nb,Ia);Pb=206;break;case -723113214:new Y(this.$);break;case 868579142:e.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Pb=1022;const jb=Ha.Title,Ob=Ha.Description,Jb=this.mdd();mb=(Qa,ha,qa)=>ka.g(Qb,jb,Ob,Jb,Qa,ha,qa,null);let Kb;this.tableManager.Mg&&(ra=L.a.Fh(this.tableManager.Mg.GTa)?"":this.tableManager.Mg.GTa,Kb=L.a.Fh(this.tableManager.Mg.HTa)?"":this.tableManager.Mg.HTa);Ca=jb==ra?()=>new V(Jb,void 0,Ob):Ob==Kb?()=>new V(Jb,jb,void 0):()=>new V(Jb,jb,Ob);break;
default:return J.a(gc)}if(mb){const ma=hb=>new z.a(Pb,0,hb,void 0,Ca);Ua=!this.namedSheetViewPublic||-2058042992!==gc&&504133448!==gc&&-798968736!==gc&&477776686!==gc?B.a(this.$.userOperationManager,mb,ma,nb):this.namedSheetViewPublic.VSa().continueWith(hb=>{hb.result&&B.a(this.$.userOperationManager,mb,ma,nb)})}return Ua}toggleTableStyleOption(Ua,nb){const Ha=this.sa.lMa();e.ULS.sendTraceTag(41996800,0,50,`TableCommandHandler: The selected ${Ha?"PivotTable":"table"} style option ${this.SRa} was toggled.`);
const sb=this.mdd();return{nCa:(Qb,mb,Pb)=>ka.l(Ua,sb,this.SRa,H.b(Qb,this.yTi),mb,Pb,null,nb),operationName:196,Qj:()=>new ta(sb,this.SRa,Ha)}}Ugj(Ua,nb,Ha){const sb=Ua.OriginalTableRange,Qb=x.m(Ua.ResizeTableRange,this.$.xa.oa),mb=()=>{this.tableManager.E9f(sb)},Pb=gc=>{gc.Errors&&this.tableManager.E9f(sb)};return(gc,Xb,Ca)=>ka.k(nb,Qb,H.b(gc,Pb),H.a(Xb,mb),Ca,null,Ha)}nZh(Ua){var nb=-1;Ua[t.a.Qc]&&(nb=Ua[t.a.Qc],nb=L.a.contains(nb,m.a.gHb,!0)?this.tableStyleManager.Yvb(nb):Number.parseInvariant(Ua[t.a.Qc]));
return nb}fXh(Ua,nb){switch(Ua){case 2095618440:return 2;case 1890380184:return 1;case 1371713064:if(Ua=nb[t.a.Qc])return Number.parseInvariant(Ua)}return 0}Ac(Ua,nb){Ua=!1;switch(nb.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:case -723113214:case 868579142:Ua=!0;break;
case 756677940:Ua=D.EwaSettings.ma(407);break;case -1618606498:case 2095618440:case 875133075:case 1890380184:case 1371713064:Ua=ia.a.aod()}return Ua}Oc(Ua,nb,Ha){Ua=!1;switch(nb){case "PopulateTableMoreStylesMenu":this.menuId=Ha.MenuId;this.tableStyleManager.Nrd()||this.tableStyleManager.V4a("formatAsTableMenu");Ua=this.tableStyleManager.WIf(nb,Ha);break;case "PopulateTableAccessibleStylesMenu":this.menuId=Ha.MenuId,this.tableStyleManager.Nrd()||this.tableStyleManager.V4a("accessibilityTab"),Ua=
this.tableStyleManager.WIf(nb,Ha)}return Ua}dispose(){this.tableStyleManager.Ocj(this.$Ef)}fda(){(L.a.contains(this.menuId,"Format",!0)||L.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.ax(this.menuId)}mdd(){return x.v(this.sa.activeCell,this.$)}GRh(){const Ua=this.tableManager.ctd;return Ua?x.v(Ua,this.$):null}fcf(Ua){if(this.tableManager){var nb=R.g(this.$),Ha=this.sa.activeCell,sb=this.tableManager.qn(Ha),Qb=null;if(!sb||sb.hTa)for(let mb of nb.Lha)for(let Pb of mb)nb=Pb.$n,
Ha.left>=nb[0]&&Ha.left<=nb[nb.length-1]&&(Qb=(nb=Pb.fs(Ha).gK())?T.DOMElementExtensions.fk(nb,l.a.qqe):null);else{const mb=nb.Vb(u.Range.Uc(sb.top,Ha.left));if(this.vz){U.a.instance.create(()=>{mb.invoke(8,Ua)},0,X.a.v9f,!0,!0);return}Qb=mb.EKa(56).f6a}Qb&&U.a.instance.create(()=>{T.DOMElementExtensions.vfc(Qb,null)},0,X.a.v9f,!0,!0)}}oZh(Ua){Ua=Number.parseInvariant(Ua);return-1<Ua&&8>=Ua?Ua:-1}EMa(){return!this.tableManager.Mg}dhf(){return this.tableManager.cGd?!1:(e.ULS.sendTraceTag(537151173,
0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)}tei(){const Ua=this.sa.sK(),nb=this.sa.Bg&&!R.g(this.$).Fb.g5(this.sa.Xc);return Ua||nb}sei(){return this.sa.sK()||!this.dhf()}qZh(Ua){const nb=[];for(const Ha of Ua)if(Ua=F.b(this.$,Ha),null===Ua||void 0===Ua?0:Ua.length)for(const sb of Ua)sb.usedRange&&!nb.includes(sb.usedRange)&&nb.push(sb.usedRange);return nb}r3e(){const Ua=this.sa.selectedRanges;let nb=[];if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))nb=
this.qZh(Ua);else for(const Ha of Ua)R.g(this.$).Fb.g5(Ha)&&nb.push(Ha);return nb&&nb.length?x.r(nb,this.$):null}oS(Ua){ia.a.Mka(this.$)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,430,431,1),nb=>{nb.result.sea(Ua);e.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}Sri(Ua){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,446,447,0),nb=>{nb.result.tah(this.$,Ua)},this.$.la,3)}static QZf(Ua,nb){nb.SheetName=
Ua.oa.name;nb.NamedObjectView=Ua.ea.isNamedObjectViewMode}Cbg(Ua,nb){let Ha,sb;if(!this.sa.Bg||1!=this.sa.Xc.dH)return{fzb:!1,nCa:Ha,Qj:sb};let Qb=x.v(this.sa.Xc,this.$);Qb.LastColumn=Qb.FirstColumn+3-1;Qb.LastRow=Qb.FirstRow+4-1;const mb=x.D(Qb),Pb=R.g(this.$);if(!mb.Ez||!Pb.Fb.pxa(mb))return{fzb:!1,nCa:Ha,Qj:sb};k.AFrameworkApplication.cI("XLS-CreateTableInEmptyCell-Treatment;XLS-CreateTableInEmptyCell-Control");if(!D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CreateTableInEmptyCell",
!1))return{fzb:!1,nCa:Ha,Qj:sb};if(null==Ua)Ha=(gc,Xb,Ca)=>ka.f(this.$.pa.va,Qb,!1,!1,!1,gc,Xb,Ca,nb),sb=()=>new y.a(!1,Qb);else{const gc=x.s(Qb);Ha=(Xb,Ca,ra)=>ka.h(this.$.pa.va,gc,!1,!1,!1,Ua,Xb,Ca,ra,nb);sb=()=>new O(gc,!1,Ua,!0)}return{fzb:!0,nCa:Ha,Qj:sb}}}Object(n.a)(va,"TableCommandHandler",null,[164]);class sa extends b.a{constructor(Ua){super(Ua)}dispose(){super.dispose()}vd(){const Ua=d.GetServiceTaskFactory.create(this.$.da,134,this.la,this.fb),nb=d.GetServiceTaskFactory.create(this.$.da,
330,this.la,this.fb),Ha=d.GetServiceTaskFactory.Sa(this.$.da,309,310,this.fb);if(ia.a.aod()){const sb=d.GetServiceTaskFactory.create(this.$.da,128,this.la,this.fb);f.TaskExtensions.Aa(wa.Task.XI(Ua,Ha,nb,sb),()=>{this.$c([new va(this.$,Ua.result,Ha.result,nb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)}else f.TaskExtensions.Aa(wa.Task.XI(Ua,Ha,nb),()=>{this.$c([new va(this.$,Ua.result,Ha.result,nb.result)],[2128797448,341449783,1544516694,-544558380,
-123538519,753331043,756677940])},this.$.la,3)}static ka(Ua){b.a.Od(86,new sa(Ua))}}Object(n.a)(sa,"TableCommandHandlerFactory",b.a,[]);a.d(C,"a",function(){return ab});const ab=()=>{c.a.Fa(Ua=>{sa.ka(Ua)})}},1160:function(n,C,a){n=a(0);var c=a(84),b=a(553),d=a(15);class f{constructor(){this.KEc={}}PAg(Z){this.KEc[Z.id.toString()]=Z}iEi(Z){const Ra=this.KEc;for(let Da in Ra)Ra[Da].notify(Z,!1);this.KEc={}}E2i(Z,Ra){Ra&&this.PAg(Ra);return this.fDf(Z,Ra)}v8c(Z){this.iEi(Z)}SLe(Z,Ra){Z.notify(Ra,!0)}}
Object(n.a)(f,"AEventEmitter",null,[256]);var e;(function(Z){Z[Z.notStarted=0]="notStarted";Z[Z.waiting=1]="waiting";Z[Z.shouldRetry=2]="shouldRetry";Z[Z.complete=3]="complete"})(e||(e={}));Object(n.b)("EventResultState",e);class k{constructor(){this._state=0}get state(){return this._state}set state(Z){d.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{["OldState"]:e[this._state],["NewState"]:e[Z]},"ResultType",this.U2e());this._state=Z}}Object(n.a)(k,"AEventResult",null,[309]);
class l extends k{constructor(){super();this.XRc=this.Nkb=null;this.state=0;this.UKc=this.J9d=!1}get wR(){return this.Nkb}get eoa(){return this.XRc}get Pci(){return this.J9d}U2e(){return"GetMoreInfo Result"}}Object(n.a)(l,"GetMoreInfoResult",k,[310,309]);var m=a(4),u=a(80),t=a(39),w=a(687),r=a(372),v=a(164),y=a(644),x=a(578),B=a(106),z=a(25);class A{constructor(Z,Ra,Da,Ba,ea,Y,ja,ca){this.La=Z;this.zh=Ra;this.vmg=Da;this.g1=Ba;this.he=ea;this.yJc=Y;this.irg=ja;this.xXb=ca}W7i(){this.z9a.Nb(z.a.openUrlInNewTab,
B.a.frame,Object(c.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.z9a.Nb(z.a.APa,B.a.frame,Object(c.a)(this,this.APa,"openDocumentUrl"));m.AFrameworkApplication.EM?this.Gnf():this.z9a.Le(z.a.s7b,B.a.frame,Object(c.a)(this,this.s7b,"documentLoaded"),96)}openUrlInNewTab(Z,Ra,Da,Ba,ea){ea&&ea.MenuItemId&&(d.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:ea.SourceControlId,["AppType"]:x.a[this.lca]}),t.a.Ze(ea.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));
return 32}APa(Z,Ra,Da,Ba,ea){if(ea&&ea.MenuItemId){const Y=m.AFrameworkApplication.fa.qa("WacInTabOpenMRUIsEnabledForUiHost"),ja=m.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");d.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Y,ja);if(Y&&ja){d.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:ea.SourceControlId,["AppType"]:x.a[this.lca]});Z=ea.MenuItemId.toString();const ca={};ca[r.a.wQa]="1";ca[r.a.documentUrl]=
Z;ca[r.a.reason]=y.a.open;d.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");m.AFrameworkApplication.XU().execute(ba=>{ba.Mj(v.a.dua,ca)})}else this.openUrlInNewTab(Z,Ra,Da,Ba,ea)}return 32}s7b(){this.Gnf();return 32}$ba(Z,Ra,Da=""){if(Ra&&Ra.BF){const Ba=w.a[Ra.status];Ra=Ra.BF.getTime();const ea=this.mw()-Ra;d.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:Z,["RequestStatus"]:Ba,["ElapsedMs"]:ea,["StartTime"]:Ra,["Notes"]:Da})}else d.ULS.sendTraceTag(5849680,
202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:Z})}Gnf(){var Z=m.AFrameworkApplication.fa.qa("QPGVCI"),Ra=u.a.oz(document.URL,"wdNewAndOpenCt",Z);if(Ra){Ra=parseInt(Ra);var Da=u.a.oz(document.URL,"wdPreviousSession",Z);Z=u.a.oz(document.URL,"wdPreviousCorrelation",Z);var Ba=m.AFrameworkApplication.fa.qa("NAOPLP");if(m.AFrameworkApplication.EM){var ea=m.AFrameworkApplication.EM.getTime();!Ra||Ra>ea?d.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
{["ClickTimestamp"]:Ra,["DocumentLoadedTime"]:ea,["SessionId"]:Da,["Correlation"]:Z}):d.ULS.sendTraceTag(5849683,202,Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:ea-Ra,["ClickTimestamp"]:Ra,["SessionId"]:Da,["Correlation"]:Z})}else d.ULS.sendTraceTag(5849681,202,Ba?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{["ClickTimestamp"]:Ra,["SessionId"]:Da,["Correlation"]:Z})}}get z9a(){return this.La.value}get ODb(){return this.zh.value}get gtf(){return this.vmg.value}get lca(){return this.g1.value}get dmc(){return this.he.value}get mw(){return this.yJc}get AV(){return this.irg.value}get supportsGetMoreInfoForPersonalStorage(){return this.xXb.value}static get instance(){return A.Ma||
(A.Ma=A.QM())}static QM(){return new A(new b.a(()=>m.AFrameworkApplication.vb),new b.a(()=>m.AFrameworkApplication.yd),new b.a(()=>m.AFrameworkApplication.ta),new b.a(()=>m.AFrameworkApplication.ta.Oa.Dj),new b.a(()=>m.AFrameworkApplication.Hi),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.ta.Oa.AV),new b.a(()=>m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage))}}A.Ma=null;Object(n.a)(A,"NewAndOpenCommonHelpers",null,[255]);var I=a(107);class F{constructor(Z,Ra,Da){this.JWb=
this.Yi=null;this.jQc=0;this.Zwg=Z;this.he=Ra;this.h6d=Da}OJg(){this.jQc=this.rcb+1}pMd(Z){this.Yi&&(this.he.jp(this.Yi),this.Yi=null);Z&&(this.jQc=0)}YEj(Z){const Ra=this.bKj;0<=Ra?(this.OJg(),this.pMd(!1),this.Yi=new I.a(4,1,Ra,Z,107),this.he.Fg(this.Yi)):(this.pMd(!0),d.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.h6d}))}get rcb(){return this.jQc}get bKj(){return this.rcb>=this.tZf.length?-1:this.tZf[this.rcb]}get tZf(){if(!this.JWb){const Z=(this.Zwg.value||"0").split(",");
this.JWb=[];for(let Ra=0;Ra<Z.length;Ra++){const Da=parseInt(Z[Ra]);isNaN(Da)?d.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.h6d,["Entry"]:Z[Ra]}):Array.add(this.JWb,Da)}}return this.JWb}}Object(n.a)(F,"RetryHelper",null,[]);var U=a(41),X=a(30);class T extends f{constructor(Z,Ra){super();this.K1=Z;this.plb=new F(Ra,this.uDb.dmc,"GetMoreInfo");this.Wo=new l}syi(){this.zwd("Document opened")}M8g(Z){return()=>{this.zwd(Z,!0)}}fDf(Z,Ra=null){d.ULS.sendTraceTag(5849617,
202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:Z});3===this.Wo.state?(Ra&&this.SLe(Ra,this.Wo),d.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:Z})):this.zwd(Z);return this.Wo}zwd(Z,Ra=!1){this.plb.pMd(!Ra);1===this.Wo.state?d.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:Z,["RetryIndex"]:this.plb.rcb}):(d.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:Z,
["RetryIndex"]:this.plb.rcb}),this.Wo.state=1,Ra=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.uDb.AV,m.AFrameworkApplication.qj),this.uDb.ODb.z9(Ra,1,null,null,[T.Pee,T.Oie],!1,5,this.R7g(),this.Q7g(Z),null))}R7g(){return Z=>{var Ra=!1;let Da=!1;var Ba=!1,ea;m.AFrameworkApplication.fa.qa("GetMoreInfoDataFromResponseBody")&&(Z.data.Xd?({fu:ea}=U.d(Z.data.Xd)).returnValue?ea?(Ba=!0,this.Wo.XRc=ea.StorageServiceDisplayName,this.Wo.Nkb=T.wjf(ea.PersonalFileStorageUrl)?ea.PersonalFileStorageUrl:
"",""===this.Wo.wR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Xa("FileSource")&&(this.Wo.Nkb=u.a.hda(m.AFrameworkApplication.breadcrumbFolderUrl)),Ra=""===this.Wo.wR&&""!==this.Wo.eoa):d.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):d.ULS.sendTraceTag(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));Ba||((ea=Z.data.responseHeaders)?(this.Wo.XRc=(ea[T.Oie]||"").toString(),Ra=(ea[T.Pee]||"").toString(),this.Wo.Nkb=T.wjf(Ra)?Ra:"",""===this.Wo.wR&&"SharePointOnlineConsumer"===m.AFrameworkApplication.fa.Xa("FileSource")?(this.Wo.Nkb=u.a.hda(m.AFrameworkApplication.breadcrumbFolderUrl),Ra=""===this.Wo.wR&&""!==this.Wo.eoa):Ra=""===Ra&&""!==this.Wo.eoa):(d.ULS.sendTraceTag(5849622,202,
50,"Null response headers received."),Da=!0));Ba=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.plb.rcb,Da,Ra,Ba);this.uDb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Z.data,Ba);this.KZf(3,Ra,Da)}}Q7g(Z){return Ra=>{this.uDb.$ba("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",Ra.data,"Failure");this.KZf(2);this.plb.YEj(this.M8g(Z))}}KZf(Z,Ra=!1,Da=!1){this.Wo.state=Z;this.Wo.J9d=
Ra;this.Wo.UKc=Da;this.v8c(this.Wo)}get uDb(){return this.K1.value}static get instance(){return T.Ma||(T.Ma=T.QM())}static QM(){return new T(new b.a(()=>A.instance),new b.a(()=>m.AFrameworkApplication.QSh))}static wjf(Z){if(!Z)return d.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(X.a.sl(Z).startsWith("https://"))return!0;d.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}T.Pee="PersonalFileStorageUrl";T.Oie="StorageServiceDisplayName";
T.Ma=null;Object(n.a)(T,"GetMoreInfoActor",f,[]);var G=a(103),D=a(95);class J{constructor(Z,Ra,Da,Ba,ea){this.Org=6E4;this.aaf="inactive";this.vle="active";this.QS=!0;this.he=Z;this.Qqg=Ra;this.yJc=Da;this.KXb=Ba;this.$a=new D.a;ea&&this.QEj();this.Hae=this.x0e()}zUc(Z){this.$a.addHandler(this.vle,Z)}mDg(Z){this.$a.addHandler(this.aaf,Z)}QEj(){const Z=new I.a(5,2,this.Org,Object(c.a)(this,this.W8h,"inactiveLoop"),108);this.X8h.Fg(Z)}W8h(){const Z=this.x0e(),Ra=this.mw()-Z;Ra>this.IAc&&this.QS&&(d.ULS.sendTraceTag(5849626,
202,50,"User went inactive {0}",{["TimeSinceLastActive"]:Ra}),this.QS=!1,this.$a.raiseEvent(this.aaf));Z-this.Hae>this.IAc&&(this.QS=!0,this.$a.raiseEvent(this.vle));this.Hae=Z}get X8h(){return this.he.value}get x0e(){return this.Qqg}get mw(){return this.yJc}get IAc(){return this.KXb.value}static get instance(){return J.Ma||(J.Ma=J.QM())}static QM(){return new J(new b.a(()=>G.a.instance),()=>m.AFrameworkApplication.Dtd.getTime(),()=>(new Date).getTime(),new b.a(()=>m.AFrameworkApplication.IAc),!0)}}
J.Ma=null;Object(n.a)(J,"InactivityManager",null,[]);var L=a(82),H=a(907);class R extends k{constructor(){super();this.Oce=this.Qce=this.Pce=null;this.state=this.Gje=0;this.UKc=!1}get Wxd(){return this.Pce}get tsf(){return this.Qce}get Vxd(){return this.Oce}get hKj(){return this.Gje}U2e(){return"MruActor Result"}}Object(n.a)(R,"MruResult",k,[308,309]);var Q=a(238);class O{constructor(Z,Ra,Da){this.task=null;this.Wec=Z;this.Xzi=Ra;this.taskManager=Da;this.retryCount=this.Jyb=0;this.tPc=this.EBb=null}Rki(Z,
Ra){return Z===Q.a.ccd||20===Ra||18===Ra||3===Ra}cmi(Z){return 3===Z||5===Z||6===Z||7===Z||9===Z||10===Z||11===Z||12===Z||13===Z||14===Z||15===Z||16===Z||23===Z||26===Z||27===Z||28===Z}get crc(){return this.tPc}reset(){this.Jyb=this.retryCount=0;this.tPc=this.EBb=null;this.task&&(this.taskManager.jp(this.task),this.task=null)}Vbi(Z,Ra,Da,Ba){this.tPc=String.format("{0}_{1}",Da,Ba);if(this.retryCount>=this.Xzi)return d.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Rki(Da,Ba))return d.ULS.sendTraceTag(562656908,
202,50,"Encountered permanent error. Not retrying"),!1;if(this.cmi(Ba)&&1<=this.Jyb)return this.EBb=Da,!1;Ra=Math.max(Ra,this.Wec*Math.pow(2,this.Jyb));if(26===Ba)Ra=Math.max(Ra,3E4);else if(27===Ba||28===Ba)Ra=Math.max(Ra,6E4);9===Ba||412===Da&&(null==this.EBb||412!==this.EBb)?Ra=500:this.Jyb+=1;this.EBb=Da;this.retryCount+=1;this.task&&this.taskManager.jp(this.task);d.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Ra);this.task=new I.a(2,1,Ra,Z,107);this.taskManager.Fg(this.task);
return!0}}Object(n.a)(O,"RetryManager",null,[]);var V=a(98),W=a(135),da=a(159);class ta{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(n.a)(ta,"WriteOptions",null,[]);var K=a(558),na=a(188);class P extends f{constructor(Z,Ra,Da,Ba,ea,Y,ja){super();this.K1=Z;this.Dtg=Ra;this.fra=new O(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",
3),this.Iw.dmc);this.Hra=new O(m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.Iw.dmc);this.Wvg=Da;this.Ske=Ba;this.gAg={};this.WS=new R;this.Mqg=ea;this.XUb="";this.Mv=Y;this.f7d=ja;this.Xvg=m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25)}get YDc(){return this.gAg}N9i(){this.Iw.z9a.Nb(z.a.renameMostRecentlyUsedFileEntry,
B.a.frame,Object(c.a)(this,this.Gdj,"renameMruEntry"))}Gdj(){return this.v1d("Rename")}Cyi(){this.rqf("File Opened")}Dyi(){this.rqf("IntervalUpdate")}rqf(Z){d.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:Z});this.v1d(Z)}e4(Z){(Z=X.a.e4(Z))&&Z.startsWith(".")&&(Z=Z.substring(1,Z.length));return Z}EXe(){switch(this.Iw.lca){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}U_h(Z){var Ra=
this.Mqg();if(!Ra)return null;const Da=new ta;Da.documentUrl=this.f7d.value?encodeURI(Ra):Ra;Da.mruItemId=this.XUb;Da.app=this.EXe();if(Ra=this.Mv())Da.folderName=Ra.breadcrumbFolderName,Ra=Ra.jn,Da.documentName=X.a.Fq(Ra),Da.documentExt=this.e4(Ra);Z&&(Da.documentName?Da.documentName.length?255<=Da.documentName.length?Z.set("DocumentNameLength","Long"):2084<=Da.documentName.length&&Z.set("DocumentNameLength","VeryLong"):Z.set("DocumentNameLength","0"):Z.set("DocumentNameLength","Null"));return JSON.stringify(Da)}v1d(Z,
Ra=!1){if(4===this.Iw.lca&&!m.AFrameworkApplication.cua)return 2;var Da=W.a.Ur();Da&&(Da.set("Trigger",Z),Da.set("IsRetry",Ra?"true":"false"),Da.set("MruIdSent",this.XUb?"true":"false"),Da.set("URLEncoded",this.f7d.value?"true":"false"));V.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",Da);Z=this.U_h(Da);if(!Z)return Ra=!m.AFrameworkApplication.webEditingEnabled,Da&&(Da.set("WebEditingIsEnabled",m.AFrameworkApplication.webEditingEnabled?"true":"false"),Da.set("ProtectedFile",m.AFrameworkApplication.rrc?
"true":"false")),V.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Ra,!1,Object.assign(new na.a,{extendedProperties:Da})),2;this.Hra&&!Ra&&this.Hra.reset();Da=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.Iw.AV,this.localeName);this.Ske?this.YDc["X-FileId"]=m.AFrameworkApplication.qj:Da+=String.format("&{0}",m.AFrameworkApplication.qj);m.AFrameworkApplication.Mb&&(this.YDc["X-Office-AudienceGroup"]=Object(L.a)(String,m.AFrameworkApplication.Mb.AudienceGroup)||"");this.YDc["X-Timeout"]=
15E3;return this.Iw.ODb.Jm(Da,2,Z,this.YDc,!0,5,Object(c.a)(this,this.iYj,"writeMruV2EntryOnServerSuccessCallback"),Object(c.a)(this,this.vbh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}iYj(Z){this.$6e(Z.data)}$6e(Z){const Ra=W.a.Ur();this.Hra&&(Ra&&this.Hra.crc&&(Ra.set("LastError",this.Hra.crc),Ra.set("NumRetries",this.Hra.retryCount.toString())),this.Hra.reset());const Da=H.c(Z.Xd);Da&&Da.diagnostics_data&&(this.XUb=Da.diagnostics_data.mru_id);Z=+Z.c3-
+Z.BF;Ra&&Ra.set("RequestDuration",Z.toString());V.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new na.a,{extendedProperties:Ra}))}vbh(Z){if(Z.data.httpStatus===Q.a.Prb)this.$6e(Z.data);else{var Ra=Z.data.httpStatus===Q.a.ZGb,Da=W.a.Ur();this.l7e(this.Hra,Z,this.jbh(),Da);Da&&(Da.set("StatusCode",Z.data.httpStatus.toString()),Ra||this.HUc(Z.data,Da));V.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",Z.data.httpStatus),Ra,!1,Object.assign(new na.a,{extendedProperties:Da}))}}jbh(){return()=>
{this.v1d("Retry",!0)}}XSh(){this.$8a("Polling")}WSh(){this.$8a("Retry",!0)}wyi(){this.$8a("Open")}vyi(){this.$8a("Activity")}uyi(){this.$8a("OpenRecentLinks",!1,!0)}tyi(){this.$8a("ActivityRecentLinks",!1,!0)}$8a(Z,Ra=!1,Da=!1){d.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:Z});const Ba=W.a.Ur();Ba&&(Ba.set("Trigger",Z),Ba.set("IsRetry",Ra?"true":"false"),Da&&Ba.set("RecentLinks","true"));V.Health.instance.recordKpiUsage("GetMru",0,"smartfio",Ba);this.fra&&!Ra&&this.fra.reset();
Da?this.aFe(Object(c.a)(this,this.YSh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(c.a)(this,this.USh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.aFe(Object(c.a)(this,this.ZSh,"getMruV2FromServerSuccessCallback"),Object(c.a)(this,this.VSh,"getMruFromServerFailureCallback"))}HUc(Z,Ra){Z&&Z.responseHeaders&&(Z=Z.responseHeaders["X-CorrelationId"])&&Ra.set("ServerCorrelationId",Z)}lvi(Z,Ra){Z&&(Ra&&Ra.set("RequestDuration",(+Z.c3-+Z.BF).toString()),V.Health.instance.recordKpiSuccess("GetMru",
Object.assign(new na.a,{extendedProperties:Ra})))}ZSh(Z){this.b1e(Z)}b1e(Z,Ra=!1){var Da="";let Ba=null,ea=null,Y=null;const ja=H.c(Z.data.Xd);ja&&(Ba=ja.places?ja.places.items:[],ea=ja.documents?ja.documents.items:[],(Y=H.a(ja,Ra))&&(Da=U.c(Y)));m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Oa.TZ&&da.c()&&!Ra&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(Da,!0));Da=W.a.Ur();this.fra&&(Da&&this.fra.crc&&(Da.set("LastError",this.fra.crc),Da.set("NumRetries",this.fra.retryCount.toString())),
this.fra.reset());Ra&&Da&&Da.set("RecentLinks","true");Y||Ba||ea?(Ra?this.Iw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Z.data,"Success"):this.Iw.$ba("MruActor.GetMruV2FromServerSuccessCallback",Z.data,"Success"),this.DCc(3,Y,Ba,ea),this.lvi(Z.data,Da)):(Ra?this.Iw.$ba("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",Z.data,"Failure: Invalid JSON"):this.Iw.$ba("MruActor.GetMruV2FromServerSuccessCallback",Z.data,"Failure: Invalid JSON"),Da&&this.HUc(Z.data,Da),V.Health.instance.recordKpiFailure("GetMru",
"JsonParseFailed",!1,!1,Object.assign(new na.a,{extendedProperties:Da})),this.DCc(3,null,null,null,!0));this.v8c(this.WS)}YSh(Z){this.b1e(Z,!0)}l7e(Z,Ra,Da,Ba){let ea=0,Y=0;const ja=H.c(Ra.data.Xd);ja&&(null!=ja.response_code&&(ea=ja.response_code,Ba&&Ba.set("MruResponseCode",ea.toString()),9===ea&&(this.XUb="")),ja.error_data&&null!=ja.error_data.retry_after_ms&&(Y=ja.error_data.retry_after_ms,Ba&&Ba.set("ExpectedRetryAfter",Y.toString())));Z&&(Ra=Z.Vbi(Da,Y,Ra.data.httpStatus,ea),Ba&&(Ba.set("CurrentRetryCount",
Z.retryCount.toString()),Ba.set("RetryScheduled",Ra?"true":"false")))}VSh(Z){this.a1e(Z)}a1e(Z,Ra=!1){const Da=Z.data.httpStatus===Q.a.ZGb,Ba=W.a.Ur();Ba&&(Ba.set("StatusCode",Z.data.httpStatus.toString()),Ra&&Ba.set("RecentLinks","true"),Da||this.HUc(Z.data,Ba));Ra?this.Iw.$ba("MruActor.GetMruForRecentLinksFromServerFailureCallback",Z.data,"Failure"):this.Iw.$ba("MruActor.GetMruFromServerFailureCallback",Z.data,"Failure");this.DCc(2);this.l7e(this.fra,Z,Object(c.a)(this,this.WSh,"getMruFromServerRetryTask"),
Ba);V.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",Z.data.httpStatus),Da,!1,Object.assign(new na.a,{extendedProperties:Ba}));this.v8c(this.WS);m.AFrameworkApplication.ta&&m.AFrameworkApplication.ta.Oa.TZ&&da.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Ra||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))}USh(Z){this.a1e(Z,!0)}DCc(Z,Ra=null,Da=null,Ba=null,ea=!1){if(3!==this.WS.state||3===Z)this.WS.Pce=Ra,this.WS.Qce=Da,
this.WS.Oce=Ba,this.WS.state=Z,this.WS.UKc=ea,this.WS.Gje=this.Iw.mw()}fDf(Z,Ra){d.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:Z,["ResultState"]:this.WS.state});Ra&&3===this.WS.state&&this.SLe(Ra,this.WS);return this.WS}aFe(Z,Ra,Da=!1){this.DCc(1);let Ba;const ea={};Ba=Da?String.format(this.Iw.AV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.Xvg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.Iw.AV+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",
10,this.EXe(),this.localeName);this.Wvg.value||(Ba+="&entity=docs");m.AFrameworkApplication.Mb&&(ea["X-Office-AudienceGroup"]=Object(L.a)(String,m.AFrameworkApplication.Mb.AudienceGroup)||"");Da&&(ea["X-Office-Application"]="147");this.Ske?ea["X-FileId"]=m.AFrameworkApplication.qj:Ba+=String.format("&{0}",m.AFrameworkApplication.qj);this.Iw.ODb.Jm(Ba,1,null,ea,!0,5,Z,Ra,null)}get Iw(){return this.K1.value}get localeName(){return this.Dtg.value}static get instance(){return P.Ma||(P.Ma=P.QM())}static QM(){return new P(new b.a(()=>
A.instance),new b.a(()=>K.a.fK(m.AFrameworkApplication.lcid).name),new b.a(()=>m.AFrameworkApplication.ta.Oa.vv),m.AFrameworkApplication.fa.qa("MruWriteFileIdInHeader"),()=>m.AFrameworkApplication.ta.Oa.Dx,()=>m.AFrameworkApplication.nm,new b.a(()=>m.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")))}}P.Ma=null;Object(n.a)(P,"MruActor",f,[]);class ka{constructor(){this.nmb=this.Ofe=this.gb=null;this.Fm=!1}get name(){return"Common.App.NewAndOpen.Core"}Wh(Z){this.gb=Z;Z.register(255,"Common.INewAndOpenCommonHelpers").wc().Fc(()=>
A.instance);Z.register(256,"Common.IEventEmitter<Common.IGetMoreInfoResult>").wc().Fc(()=>T.instance);Z.register(256,"Common.IEventEmitter<Common.IMruResult>").wc().Fc(()=>P.instance)}init(){m.AFrameworkApplication.fa.qv(()=>{this.uyb()})}uyb(){this.gb.resolve("Common.INewAndOpenCommonHelpers");this.gb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.gb.resolve("Common.IEventEmitter<Common.IMruResult>");var Z=!1;A.instance.W7i();m.AFrameworkApplication.Ela&&(Z=!0);m.AFrameworkApplication.GNf&&
(P.instance.wyi(),m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&P.instance.uyi(),0<m.AFrameworkApplication.usf&&this.Ome(),this.Tuj(),Z=!0);m.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&Z&&T.instance.syi();m.AFrameworkApplication.DSj&&(Z=P.instance,Z.N9i(),Z.Cyi(),G.a.instance.Fg(this.ESj))}Tuj(){J.instance.zUc(Object(c.a)(P.instance,P.instance.vyi,"makeGetMruRequestActivityTrigger"));m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)&&J.instance.zUc(Object(c.a)(P.instance,P.instance.tyi,"makeGetMruForRecentLinksRequestActivityTrigger"));J.instance.zUc(Object(c.a)(this,this.Ome,"addGetMruFromServerTask"));J.instance.mDg(Object(c.a)(this,this.yeh,"deleteGetMruFromServerTask"))}yeh(){G.a.instance.jp(this.vsf)}Ome(){G.a.instance.Fg(this.vsf)}get vsf(){return this.Ofe||(this.Ofe=new I.a(5,2,m.AFrameworkApplication.usf,Object(c.a)(P.instance,P.instance.XSh,"getMruFromServerTask"),109))}get ESj(){return this.nmb||(this.nmb=new I.a(2,
2,6E4*m.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(c.a)(P.instance,P.instance.Dyi,"makeUpdateMruTask"),197))}dispose(){this.Fm||(this.Fm=!0,this.nmb&&(G.a.instance.jp(this.nmb),this.nmb=null))}}Object(n.a)(ka,"CorePackageManager",null,[3,4,10]);var pa=a(247);a.d(C,"a",function(){return Na});const Na=()=>{Type.registerNamespace("Common.App.NewAndOpen.Core");pa.a.instance.Gi(new ka)}},1164:function(n,C,a){n=a(0);var c=a(4),b=a(222),
d=a(15),f=a(84),e=a(54),k=a(194);class l{constructor(){this.Ehe=this.aRc=!1;const nb=c.AFrameworkApplication.qk;0>=nb||(this.qk=nb,d.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.qk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.kha}),k.a.instance.WVc(Object(f.a)(this,this.qPa,"onSessionExpiredDetected")),k.a.instance.UVc(Object(f.a)(this,this.bEf,"onSessionExpiringDetected")))}qPa(){k.a.instance.NKd(Object(f.a)(this,
this.qPa,"onSessionExpiredDetected"));d.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.w4h()}bEf(){k.a.instance.MKd(Object(f.a)(this,this.bEf,"onSessionExpiringDetected"));this.Ehe||this.aRc||(d.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Ehe=!0,this.GBj())}w4h(){this.aRc||(c.AFrameworkApplication.eG(e.a.gwc),this.aRc=!0,this.FBj())}}Object(n.a)(l,"ASessionExpirationManager",null,[]);var m=a(86),u=a(38),t=a(29),w=a(14),r=a(42),v=a(249),
y=a(6),x=a(81),B=a(252),z=a(68);class A extends l{constructor(nb){super();this.Ra=new u.a;this.pH=this.jmb=!1;this.$=nb}fpe(nb){this.Ra.addHandler("SessionExpired",nb)}XZb(nb){this.Ra.addHandler("TokenRefreshed",nb)}AKd(nb){this.Ra.removeHandler("TokenRefreshed",nb)}get accessTokenExpiringMessage(){const nb=(new Date(this.qk)).format(this.$.ya.ShortTimeFormat);return String.format(w.a.instance.mb(78),nb)}get tokenExpired(){return this.jmb}get Edb(){return!1}get Kba(){return!1}get MId(){return!1}get u5(){return!1}Edc(){return k.a.instance.VQ(c.AFrameworkApplication.qk)}dispose(){m.a.Ia(this.Ra);
this.$=null}GBj(){this.$.isEditMode&&this.edc(!1)}FBj(){this.jmb=!0;this.edc(!0);this.Ra.raiseEvent("SessionExpired")}edc(nb){d.ULS.sendTraceTag(537170715,0,15,`EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired ${nb}, GotDeploymentOrTimedOutError ${this.$.ea.n4}`);const Ha=this.$.rb.gp;nb&&Ha&&Ha.isVisible&&1299163859===Ha.error.MessageId&&this.$.rb.gp.Zu();const sb=this.Yc(nb);r.a(this.$).Bs(new v.a(y.a.Ux,5,()=>{const Qb=z.a(this.$),mb=Qb.kd.activityState;mb[x.a.h2]=this.$.qpb(this.$.isEditMode);
mb[x.a.fM]=x.a.x9a;mb[B.a.Aq]=y.a.accessTokenExpiringWarning;Qb.kd.kr([sb])}))}Yc(nb){return nb?t.a.fGe():this.fah()}fah(){const nb=t.a.Yc(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");nb.Description=this.accessTokenExpiringMessage;return nb}}Object(n.a)(A,"EwaAccessTokenExpirationManager",l,[456,457,10]);var I=a(7),F=a(173),U=a(80),X=a(642),T=a(28);class G{constructor(nb,Ha){this.iIb=!1;this.correlationID=nb;this.c5c=Ha;this.TAc=!1;this.creationTime=T.a.Pa.zb}}Object(n.a)(G,"RefreshAccessTokenContext",
null,[]);var D=a(58),J=a(61),L=a(174),H=a(45),R=a(110),Q=a(118),O=a(1),V=a(22),W=a(141),da=a(36),ta=a(115);class K{}Object(n.a)(K,"Error",null,[]);class na{}Object(n.a)(na,"NamedResult",null,[]);class P extends na{}Object(n.a)(P,"ErrorInfo",na,[]);class ka{constructor(nb,Ha){this.NXb=nb;this.JG=Ha}get tokens(){return this.NXb}get errors(){return this.JG}}Object(n.a)(ka,"TokenRefreshArgs",null,[454]);class pa{constructor(nb,Ha){this.documentVisibilityObserver=null;this.Ra=new u.a;this.zx=null;this.peb=
this.hlb=!1;this.qsc=null;this.pIb=!1;this.Bvd=!0;this.Sae=this.rae=this.pH=this.jmb=!1;this.GS=null;this.a7e=()=>{if(this.$.ea.fc)this.B7e(!1);else if(this.Bvd){this.Bvd=!1;const sb=z.a(this.$);d.ULS.sendTraceTag(537170709,0,50,`EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [${sb.hi?sb.hi.activityName:"None"}] TimeUntilTokenExpirationInMin [${this.T$f()}]`)}};this.Wc=(sb,Qb)=>{this.context&&(sb=this.$.ea,Qb.LH&&this.context.iIb&&
!this.context.TAc?(this.context.TAc=!0,Qb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Qb.IsUserActive=sb.pf.rs,Qb.RefreshAccessTokenCorrelationID=this.context.correlationID,Qb=D.a.kc(Qb),d.ULS.sendTraceTag(537170708,0,50,Qb)):!this.hlb||sb.fc||this.context.c5c||(Qb={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},this.zx&&(this.zx.cancel(),Qb.Aborted=!0,Qb.ResetStopRefreshRetriesUntilTokenExpired=!0,
this.peb=!1),Qb.TimeUntilTokenExpirationInMin=this.T$f(),Qb.RefreshAccessTokenCorrelationID=this.context.correlationID,Qb=D.a.kc(Qb),d.ULS.sendTraceTag(572019856,0,50,Qb)))};this.Xya=()=>{if(this.context&&this.context.iIb&&!this.context.TAc){var sb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};sb.CreatedForExpired=this.context.c5c;sb.RefreshAccessTokenCorrelationID=this.context.correlationID;sb.OpenWorkbookErrors=t.a.xc(this.$.ea.VF);sb.ExecutionContextErrors=t.a.xc(z.a(this.$).kd.errors);
sb.accesstokenTTL=c.AFrameworkApplication.qk;sb=D.a.kc(sb);d.ULS.sendTraceTag(537170707,0,15,sb)}};this.A7e=()=>{this.peb=!1;this.B7e(!0)};this.$Cd=()=>{this.pIb&&(this.$.ea.pf.YQa(this.$Cd),this.pIb=!1);this.s7f()};this.$=nb;this.yXd=Ha;this.KId=nb.Jb.Rg("WebServiceCall","refreshToken");k.a.instance.WVc(this.A7e);k.a.instance.UVc(this.a7e);Ha=this.$.ea;Ha.rk(this.Wc);Ha.ZZb(this.Xya);this.$Ai=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.S2f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;
this.QOf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.Efg(nb.ea.bHf,c.AFrameworkApplication.qk);nb=JSON.stringify({["AccessTokenTtl"]:c.AFrameworkApplication.qk,["NowGetTime"]:(new Date).getTime(),["BootTime"]:c.AFrameworkApplication.kha,["WopiTokenExpiresAfterMinutes"]:c.AFrameworkApplication.i1d,["WopiTokenTaskItemPriority"]:c.AFrameworkApplication.k1d});d.ULS.sendTraceTag(537170714,217,50,`Initializing EwaAccessTokenExpirationRefreshManager. ${nb}`);this.$.da.Za(291,sb=>{this.documentVisibilityObserver=
sb})}fpe(nb){this.Ra.addHandler("SessionExpired",nb)}XZb(nb){this.Ra.addHandler("TokenRefreshed",nb)}AKd(nb){this.Ra.removeHandler("TokenRefreshed",nb)}get tokenExpired(){return this.jmb}get Kba(){return this.rae}get u5(){return this.Sae}get context(){return this.GS}get Edb(){return this.u5?!1:this.$.ea.pf.rs?1>ta.a.X5:6>ta.a.Y5}get MId(){return this.hlb}Edc(){return k.a.instance.VQ(c.AFrameworkApplication.qk)}dispose(){k.a.instance.NKd(this.A7e);k.a.instance.MKd(this.a7e);const nb=this.$.ea;nb&&
(nb.Pk(this.Wc),nb.vtc(this.Xya));m.a.Ia(this.Ra);this.documentVisibilityObserver=this.$=null}T$f(){return this.Edc()?0:(c.AFrameworkApplication.qk-(new Date).getTime())/6E4}Efg(nb,Ha){if(0<Ha&&!this.Edc()){const sb=c.AFrameworkApplication.fa.qd("AccessTokenExpirationPromptSeconds",c.AFrameworkApplication.TX),Qb=(Ha-nb.getTime())/6E4;d.ULS.shipAssertTag(537170713,0,0<=Qb,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [${Ha}] creationTime [${nb.getTime()}] tokenLifetimeInMin [${Qb}]`);
Qb<this.$Ai?(d.ULS.sendTraceTag(537170712,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${this.S2f}] tokenLifetimeInMin [${Qb}]`),c.AFrameworkApplication.TX=this.S2f):c.AFrameworkApplication.TX!==sb&&(d.ULS.sendTraceTag(537170711,0,15,`TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [${sb}] tokenLifetimeInMin [${Qb}]`),c.AFrameworkApplication.TX=sb)}}A5g(nb){return!this.context||
this.context.iIb||this.context.c5c!==nb?(nb=new G(F.a.create().toString(),nb),this.context&&!this.context.TAc&&d.ULS.sendTraceTag(537170710,0,15,`TokenManager.InitContext: creating new context [${nb.correlationID}] although previeous one [${this.context.correlationID}] not used successfully, isPreviousOneRefreshedSuccessfully [${this.context.iIb}] `),this.GS=nb,!0):!1}fgj(nb){nb&&this.pH&&!this.Kba&&this.$.ea.pf.rs&&!this.u5&&(this.pH=!1)}B7e(nb){this.fgj(nb);if(!(this.hlb||this.peb&&!nb||this.pH)&&
this.Edb){this.hlb=!0;var Ha=this.context?this.context.creationTime:null,sb=this.A5g(nb);this.Bvd=!0;var Qb=this.$.ea,mb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh"};mb.newContextCreated=sb;mb.IsUserActive=Qb.pf.rs;mb.IsSessionActive=Qb.fc;mb.ContainsChangesWorkbookOperations=this.$.userOperationManager.fta();mb.isSessionExpired=nb;mb.stopRefreshRetriesUntilTokenExpired=this.peb;mb.FailedToRefreshExpiredToken=this.pH;mb.numOfFailuresWhileUserIsActive=ta.a.X5;mb.numOfFailuresWhileUserIsInActive=
ta.a.Y5;mb.numOfFailuresWhileOffline=ta.a.Cya;mb.RefreshAccessTokenCorrelationID=this.context.correlationID;sb&&Ha&&(mb.TimeInMinFromPreviosContextCreation=Math.round(Q.b(T.a.Pa,Ha)/60));Ha=D.a.kc(mb);d.ULS.sendTraceTag(40416199,0,50,Ha);this.KId.start();this.rae=Qb.pf.rs;this.zx=new X.a;this.Gsi(nb);var Pb=this.yXd.E7i(!nb,this.zx?this.zx.token:null);Pb.continueWith(()=>{this.fZg();const gc=this.yXd.O1i(Pb);this.KId.stop();const Xb=this.Edc();if(!gc||O.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&
Xb){const Ca=Pb.result.errors;gc&&Xb&&this.tCg(Ca);this.e4h(Ca,nb)}else this.peb=!1,this.f4h(Pb.result.tokens,nb);this.hlb=!1},8)}}tCg(nb){const Ha=[Object(I.a)(new K,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];nb.add(Object(I.a)(new P,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Ha}))}Gsi(nb){nb&&(this.$.ea.pf.rs?this.s7f():(this.$.ea.pf.Wra(this.$Cd),this.pIb=!0))}s7f(){this.qsc=L.AsyncMethodContext.yr(()=>{this.D7i()},1E3*this.QOf,H.a.l7i,this.qsc)}fZg(){this.qsc&&
this.qsc.cancel();this.pIb&&(this.$.ea.pf.YQa(this.$Cd),this.pIb=!1);this.zx=null}D7i(){d.ULS.sendTraceTag(537170706,0,15,`EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [${this.QOf}]`);this.zx.cancel()}e4h(nb,Ha){this.peb=!0;Ha&&(this.pH||(this.jmb=this.pH=!0),this.yXd.lAb(nb)&&(this.Sae=!0));const sb=!Ha||this.Edb&&!ta.a.Uxc?40380379:39982555;Ha=this.FEe(Ha);Ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Ha.FailedToRefreshExpiredToken=
this.pH;Ha.LastErrorIsPermanent=this.u5;if(0<nb.count){var Qb=nb.na(0);Ha.errorName=Qb.Name;0<Qb.Errors.length&&(Ha.ErrorId=Qb.Errors[0].Id,Qb=Qb.Errors[0].Details,Ha.ErrorDetails=this.Hih(Qb.toString())?"PiiScrubbed":Qb)}Ha=D.a.kc(Ha);d.ULS.sendTraceTag(sb,0,15,Ha);this.Ra.raiseEvent("TokenRefreshed",new ka(null,nb))}Hih(nb){return V.a.contains(nb,"makes the internet safe for businesses",!0)}FEe(nb){const Ha={},sb=this.$.ea;Ha.Name="";Ha.IsUserActive=sb.pf.rs;Ha.IsSessionActive=sb.fc;Ha.GotDeploymentOrTimedOutError=
sb.n4;Ha.TimeInSecFromLastStatefulSuccessfulRequest=sb.O0;Ha.TimeFromLastUserActivityInMs=sb.pf.jOb;Ha.calledFromSessionExpiredFlow=nb;Ha.RefreshTokenDurationInMS=this.KId.yc;Ha.numOfFailuresWhileUserIsActive=ta.a.X5;Ha.numOfFailuresWhileUserIsInActive=ta.a.Y5;Ha.numOfFailuresWhileOffline=ta.a.Cya;Ha.RefreshAccessTokenCorrelationID=this.context.correlationID;Ha.accessTokenTTL=c.AFrameworkApplication.qk;Ha.ContainsChangesWorkbookOperations=this.$.userOperationManager.fta();Ha.IsDocumentHidden=this.documentVisibilityObserver?
this.documentVisibilityObserver.vi.toString():"Unknown";Ha.TimeFromFirstOpenInHr=Math.floor(Q.b(T.a.Pa,R.toUtc(sb.bHf))/3600);return Ha}f4h(nb,Ha){this.pH=!1;this.gUj();this.Efg(new Date,c.AFrameworkApplication.qk);const sb=this.$.ea,Qb=!Ha&&sb.pf.rs,mb=!this.$.isEditMode&&sb.lbb;Ha=this.FEe(Ha);Ha.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Ha.shouldTriggerSilentReloadAfterExpiring=Qb;Ha.WopiTokenTaskItemPriority=c.AFrameworkApplication.k1d;Ha.isDirtyViewSession=mb;Ha=D.a.kc(Ha);
d.ULS.sendTraceTag(39982556,0,15,Ha);this.Ra.raiseEvent("TokenRefreshed",new ka(nb,null));mb?sb.pf.rs&&(d.ULS.sendTraceTag(537170705,0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),sb.hcd()):sb.pf.rs?Qb&&(nb=z.a(this.$).kd.activityState,nb[ta.a.hfb]=!0,nb[W.a.XX]=!0,nb[da.a.Qr]=this.$.isEditMode,r.a(this.$).Bs(new v.a(y.a.wna,2,null))):sb.fc&&J.j(this.$.pa.va,!0,!1,!1,null,null,null,null,
null)}gUj(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=U.a.pT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.pP,c.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=U.a.pT(this.$.ea.workbookContext.WorkbookUri,c.AFrameworkApplication.UX,c.AFrameworkApplication.qk.toString()),this.$.ea.opc()):d.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");
this.$.ya.AccessToken=c.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=c.AFrameworkApplication.qk;void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=U.a.pT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,c.AFrameworkApplication.pP,c.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=U.a.pT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,
c.AFrameworkApplication.UX,c.AFrameworkApplication.qk.toString()));void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=U.a.pT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.pP,c.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=U.a.pT(this.$.ya.EmbedConfiguratorUrl,c.AFrameworkApplication.UX,c.AFrameworkApplication.qk.toString()));this.context.iIb=!0}}Object(n.a)(pa,"EwaAccessTokenExpirationRefreshManager",null,[456,
457,10]);var Na=a(187),Z=a(155),Ra=a(82),Da=a(414);class Ba{}Ba.SYb="ActivityDuration";Ba.error="Error";Ba.t9c="Errors";Ba.failed="Failed";Ba.hCh="FirstActivity";Ba.initialized="Initialized";Ba.Oqi="LastActivity";Ba.oVf="RetryOverride";Ba.Gfj="RequestGroups";Ba.requests="Requests";Ba.bVf="Responses";Ba.hwc="SessionDuration";Ba.status="Status";Ba.success="Success";Ba.goa="Successful";Ba.tokens="Tokens";Object(n.a)(Ba,"SessionExpirationStrings",null,[]);var ea=a(107);class Y{constructor(nb){this.Vo=
{};this.mX={};this.rvg={};this.Anf=15;this.mae=!1;this.cxg=new Date;this.vUb=new Date;this.he=nb;this.DXb=new ea.a(2,2,6E4*this.Anf,Object(f.a)(this,this.vig,"writeMeasures"),135,"SL",!1);this.he.Fg(this.DXb);this.Xai()}vig(){d.ULS.sendTraceTag(41964821,217,50,d.ULS.kc({["Aggregate"]:this.mX,["Current"]:this.Vo}))}Xai(){this.mX[Ba.Gfj]=0;this.mX[Ba.requests]=0;this.mX[Ba.bVf]=0;this.mX[Ba.status]=Ba.initialized;this.mX[Ba.hCh]=new Date;this.mX[Ba.hwc]=0;this.mX[Ba.SYb]=0;this.mX[Ba.hwc]=0;this.Vo[Ba.hwc]=
0;this.mX[Ba.SYb]=0;this.Vo[Ba.SYb]=0}Hld(nb,Ha){var sb=nb[Ha];sb=sb?sb:0;sb++;nb[Ha]=sb;this.dQd(nb)}dQd(nb){const Ha=new Date;nb[Ba.SYb]=+Ha-+this.vUb;this.vUb=Ha;nb[Ba.hwc]=+this.vUb-+this.cxg;nb[Ba.Oqi]=this.vUb}v0(nb,Ha){this.Vo[nb]=Ha;this.dQd(this.Vo)}CPd(nb,Ha){this.Vo[nb]=Ha;this.dQd(this.Vo)}incrementCounter(nb){this.Hld(this.Vo,nb);this.Hld(this.mX,nb);this.Hld(this.rvg,nb)}flush(){this.mae||(this.mX[Ba.status]=this.Vo[Ba.status],this.vig(this.DXb),this.he.bna(this.DXb,6E4*this.Anf))}stop(){d.ULS.sendTraceTag(41964822,
217,100,"Stopping logger. Flushing one last time");this.flush();this.mae=!0;this.he.jp(this.DXb)}}Object(n.a)(Y,"SessionLogger",null,[474]);var ja=a(98),ca=a(643),ba=a(372),ua=a(164),wa=a(939),ia=a(188),xa=a(166);class gb{constructor(nb,Ha,sb,Qb=null,mb=!1,Pb=null,gc=!1,Xb=!1){this.jra=0;this.k9=this.Yi=null;this.NXb=new Na.a;this.JG=new Na.a;this.pk=null;this.pUb=!1;this.LSc=this.MSc=null;this.he=nb;this.dfe=Ha;this.dfe.execute(Ca=>{Ca.$l(ua.a.Okd,Object(f.a)(this,this.WMi,"onHostResponseReceived"))});
this.SG=sb;this.Hje=new wa.a("WebServiceCall","TokenRefresh");this.jh=Qb||new Y(nb);this.Ywg=mb;this.fT=Pb?Pb:ca.SessionStatusManager.instance;this.e7d=gc;this.QSb=Xb}WMi(nb){if(nb.MessageId!==ua.a.Okd)xa.a(39408099,306,15,"Unexpected message.");else{var Ha=new Na.a,sb=new Na.a;this.jh.incrementCounter(Ba.bVf);var Qb=nb.Values[ba.a.zZf];if(!Qb||0>=Qb.length)xa.a(40122317,306,15,"Found no tokens in the dictionary"),Qb=nb.Values;xa.a(40122318,306,100,"The Tokens array contains {0} tokens",Qb.length);
this.jh.v0("Correlation",nb.CorrelationId);var mb="";for(let Xb=0;Xb<Qb.length;Xb++){this.jh.CPd(Ba.tokens,Qb.length);var Pb=Qb[Xb],gc=Pb;if(!gc||!gc.Name)continue;this.jh.incrementCounter(gc.Name);const Ca=Pb;if(Ca&&Ca.Value)xa.a(39408128,306,100,"Received token with name: {0}",Ca.Name),Ha.add(Ca),this.NXb.add(Ca),this.QSb||this.jh.v0(Ba.status,Ba.success),this.e7d&&this.fT&&this.fT.Ggj();else if(Pb=this.nXh(Pb),xa.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
gc.Name,JSON.stringify(Pb),this.k9),sb.add(Pb),this.QSb||(this.JG.add(Pb),mb=JSON.stringify(Pb),this.jh.v0(Ba.error,JSON.stringify(Pb)),this.jh.v0(Ba.status,Ba.failed)),this.e7d)for(const ra of Pb.Errors)gc=this.pOh(ra),this.fT&&this.fT.OEg(gc)}this.QSb?(0<sb.count?this.LSc&&this.LSc(new ka(Ha,sb)):this.MSc&&this.MSc(new ka(Ha,sb)),xa.a(512344162,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ha.count,sb.count,nb.CorrelationId,this.k9)):(0<sb.count&&
""!==mb?(Qb=Object.assign(new ia.a,{extendedProperties:new Map}),Qb.extendedProperties.set("Errors",mb),ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Qb)):ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null),xa.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Ha.count,sb.count,nb.CorrelationId,this.k9),0<sb.count&&!this.lAb(sb)?(nb=this.SG.V2e(sb),nb!==this.SG.scb&&(this.jh.CPd(Ba.oVf,nb),this.he.bna(this.Yi,
nb))):(this.jh.flush(),this.Yi&&(xa.a(39408131,306,100,"Deleting task {0} from task manager",this.Yi.name),this.he.jp(this.Yi)),this.pk&&!this.pk.task.isCompleted&&this.pk.setResult(new ka(Ha,sb))))}}nXh(nb){if(!nb)return null;const Ha=Object.assign(new P,{Name:nb.Name,Errors:[]});for(const sb of nb.Errors)nb=new K,nb.Id=sb.Id,nb.Details=this.mXh(sb.Details),Ha.Errors.push(nb);return Ha}mXh(nb){if(!nb)return"";const Ha=nb.toString().toLowerCase();return 0<Ha.indexOf("<!doctype")?this.Jgd("Seems to contain HTML - Contains <!DOCTYPE"):
0<Ha.indexOf("<html")?this.Jgd("Seems to contain HTML - Contains <html>"):500<Ha.length?this.Jgd(String.format("Error details content too long: Length: {0}",Ha.length)):nb}Jgd(nb){return String.format("{0} - Reason: [{1}]","### REDACTED ###",nb)}requestTokensOnce(){this.jUf()}jUf(){c.AFrameworkApplication.zkc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.jra>=this.SG.$qf?(xa.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.k9),this.LEe(this.pk,
"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(ja.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.LYf())}LYf(){const nb={};nb[ba.a.zZf]=this.SG.tokens;const Ha=F.a.create().toString();xa.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.SG.tokens),this.jra+1,Ha,this.k9);this.dfe.execute(sb=>{sb.Mj(ua.a.wre,nb,Ha)});this.jra++;this.jh.incrementCounter(Ba.requests)}LEe(nb,
Ha,sb){const Qb=new Na.a;for(let mb=0;mb<this.SG.tokens.length;mb++){const Pb=Object.assign(new P,{Name:this.SG.tokens[mb],Errors:[Object.assign(new K,{Id:Ha,Details:sb})]});Qb.add(Pb);this.JG.add(Pb)}this.he.jp(this.Yi);this.jh.v0(Ba.t9c,JSON.stringify(this.JG));this.jh.v0(Ba.status,Ba.failed);nb&&!nb.task.isCompleted&&nb.setResult(new ka(new Na.a,this.JG))}E7i(nb,Ha=null){this.Hje.start();this.pUb=nb;this.k9=F.a.create().toString();xa.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",
this.k9,this.pUb);this.jra=0;this.JG.clear();this.NXb.clear();const sb=new Z.a;this.pk=sb;Ha&&Ha.R(()=>{const Qb=!!sb&&!sb.task.isCompleted;xa.a(588096223,306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",this.k9,this.pUb,Qb);Qb&&this.LEe(sb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.QSb?this.kUf(this.SG.$qf).then(Qb=>{this.pk&&!this.pk.task.isCompleted&&this.pk.setResult(Qb);this.jh.v0(Ba.t9c,JSON.stringify(this.JG));this.jh.v0(Ba.status,
Ba.success);this.jh.flush()}).catch(Qb=>{this.pk&&!this.pk.task.isCompleted&&this.pk.setResult(Object(Ra.a)(454,Qb));this.jh.v0(Ba.t9c,JSON.stringify(this.JG));this.jh.v0(Ba.status,Ba.failed);this.jh.flush()}):(this.Yi=new ea.a(this.SG.priority,2,this.SG.scb,Object(f.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,ua.a.wre,!0),this.Ywg&&this.jUf(),this.he.Fg(this.Yi));return this.pk.task}kUf(nb){const Ha=this,sb=new Promise((Xb,Ca)=>{Ha.MSc=Xb;Ha.LSc=Ca;ja.Health.instance.recordKpiUsage("WACTokenRefresh",
1,"wwrelfc",null);Ha.LYf()}),Qb=this,mb=new Promise((Xb,Ca)=>{window.setTimeout(()=>{Ca(Qb.QEe("TIMEOUT","We did not receive a new token from the host after the maximum allowed time"))},Qb.SG.scb)});let Pb=nb;const gc=this;return new Promise((Xb,Ca)=>{Pb--;Promise.race([sb,mb]).then(ra=>{ja.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Xb(ra)}).catch(ra=>{var ma=gc.SG.scb;if(Object(Da.a)(454,ra)&&(ra=Object(Ra.a)(454,ra),0<ra.errors.count)){gc.onf(ra.errors);gc.kr(ra.errors);if(gc.lAb(ra.errors)){Ca(ra);
return}const hb=gc.SG.V2e(ra.errors);hb!==gc.SG.scb?(gc.jh.CPd(Ba.oVf,hb),ma=hb):gc.ioi(ra.errors)&&(ma=0)}Pb?window.setTimeout(()=>{gc.kUf(Pb).then(Xb).catch(Ca)},ma):(ma=gc.QEe("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),gc.onf(ma.errors),gc.kr(ma.errors),Ca(ma))})})}kr(nb){for(let Ha of nb)this.JG.add(Ha)}ioi(nb){if(!nb.count)return!1;nb=nb.na(nb.count-1);return nb.Errors.length?"TIMEOUT"==nb.Errors[0].Id:!1}QEe(nb,Ha){const sb=
new Na.a;for(let Qb=0;Qb<this.SG.tokens.length;Qb++){const mb=this.o7g(this.SG.tokens[Qb],nb,Ha);sb.add(mb)}return new ka(new Na.a,sb)}o7g(nb,Ha,sb){return Object.assign(new P,{Name:nb,Errors:[Object.assign(new K,{Id:Ha,Details:sb})]})}onf(nb){if(nb.count){nb=nb.na(nb.count-1);nb=JSON.stringify(nb);var Ha=Object.assign(new ia.a,{extendedProperties:new Map});Ha.extendedProperties.set("Errors",nb);ja.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ha);this.jh.v0(Ba.error,
nb);this.jh.v0(Ba.status,Ba.failed)}}O1i(nb){this.Hje.stop();const Ha=this.o5h(nb.result.errors);d.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!Ha,this.k9,this.pUb,this.jra,this.JG.count,0<nb.result.errors.count?nb.result.errors.na(0).Name:"",0<nb.result.errors.count&&0<nb.result.errors.na(0).Errors.length?nb.result.errors.na(0).Errors[0].Id:
"",0<nb.result.errors.count&&0<nb.result.errors.na(0).Errors.length?nb.result.errors.na(0).Errors[0].Details:"");return Ha?!1:this.N1i(nb.result.tokens)}lAb(nb){return this.SG.lAb(nb)}N1i(nb){for(let Ha=0;Ha<nb.count;Ha++){const sb=nb.na(Ha);if(sb.Name===ba.a.accessToken){const Qb=(new Date).getTime();sb.Expiry>c.AFrameworkApplication.qk?(d.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:sb.Expiry,["NowGetTime"]:Qb,["BootTime"]:c.AFrameworkApplication.kha},"PreviousAccessTokenTtl",
c.AFrameworkApplication.qk),c.AFrameworkApplication.accessToken=sb.Value,c.AFrameworkApplication.qk=Math.floor(sb.Expiry),c.AFrameworkApplication.j1d=Qb,c.AFrameworkApplication.BYa=Math.floor(sb.Expiry)):d.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:sb.Expiry,["NowGetTime"]:Qb,["BootTime"]:c.AFrameworkApplication.kha},"PreviousAccessTokenTtl",c.AFrameworkApplication.qk)}}return!0}o5h(nb){let Ha=!1;for(let sb=0;sb<
nb.count;sb++){Ha=!0;const Qb=nb.na(sb);d.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Qb.Name,JSON.stringify(Qb.Errors),this.k9)}return Ha}pOh(nb){let Ha=e.a.gwc;nb=parseInt(nb.Id);if(isNaN(nb))Ha=e.a.GXj;else{switch(nb){case 401:Ha=e.a.JXj;break;case 403:Ha=e.a.EXj;break;case 500:Ha=e.a.FXj;break;case 503:Ha=e.a.IXj}Ha===e.a.gwc&&(Ha=500<nb?e.a.HXj:e.a.DXj)}return Ha}}Object(n.a)(gb,"TokenRefreshManager",null,[455]);class va{constructor(){this.scb=c.AFrameworkApplication.MXj;
this.$qf=c.AFrameworkApplication.KXj;this.tokens=c.AFrameworkApplication.a1h();this.priority=c.AFrameworkApplication.k1d;this.pge=this.Csj();this.xTc=c.AFrameworkApplication.$0h()}lAb(nb){nb=JSON.stringify(nb);if(this.xTc&&0<this.xTc.length)for(const Ha of this.xTc)if(0<Ha.length&&0<=nb.indexOf(Ha))return!0;return!1}V2e(nb){try{if(nb)for(let Ha of nb)if(Ha.Errors)for(const sb of Ha.Errors)if(sb.Id in this.pge)return Number.parseInvariant(this.pge[sb.Id].toString())}catch(Ha){d.ULS.sendTraceTag(41501720,
217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Ha.toString())}return this.scb}Csj(){const nb={};try{if(!c.AFrameworkApplication.Occ()||0>=c.AFrameworkApplication.Occ().length||""===c.AFrameworkApplication.Occ()[0])return nb;for(const Ha of c.AFrameworkApplication.Occ())0<Ha.length&&(nb[Ha]=c.AFrameworkApplication.LXj)}catch(Ha){d.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Ha.toString())}return nb}}Object(n.a)(va,"TokenRefreshPolicy",
null,[409]);class sa extends b.a{constructor(nb){super();this.$=nb;this.Eb()}create(){c.AFrameworkApplication.uN("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");c.AFrameworkApplication.fa.qa("RefreshAccessTokenSilently")?this.pb(this.t7g()):this.pb(this.$.da.za(38)||this.$.da.Ga(38,new A(this.$)))}t7g(){var nb=this.$.da.za(38);if(nb)return nb;nb=new gb(c.AFrameworkApplication.Hi,c.AFrameworkApplication.XU(),new va);return this.$.da.Ga(38,new pa(this.$,
nb))}static ka(nb){nb.da.Ga(39,new sa(nb))}}Object(n.a)(sa,"AccessTokenExpirationManagerFactory",b.a,[]);var ab=a(9);a.d(C,"a",function(){return Ua});const Ua=()=>{ab.a.Fa(sa.ka)}},1196:function(n,C,a){n=a(0);var c=a(84),b=a(144);class d extends b.a{constructor(z){super(!1,!1,!0);this.LQb=z}start(){const z={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.LQb.Skd}};this.initializeAndShow("",Object(c.a)(this,this.Fhj,"resultHandler"),z)}Fhj(z,A){1===z&&(this.LQb.Skd=
A.tooltipPersistenceEnabled)}}Object(n.a)(d,"AccessibilitySettingsDialog",b.a,[]);var f=a(106),e=a(25);class k{constructor(z,A){this.La=z;this.LQb=A}Ig(){this.La.Nb(e.a.bzj,f.a.frame,Object(c.a)(this,this.czj,"showAccessibilitySettingsDialogHandler"))}czj(){(new d(this.LQb)).start();return 32}}Object(n.a)(k,"AccessibilitySettingsDialogActor",null,[316]);var l=a(155),m=a(4);const u=z=>{const A=new l.a;m.AFrameworkApplication.yd.Jm(t(z),1,null,null,!0,2,I=>{200===I.data.httpStatus?A.setResult("true"===
I.data.Xd.toLowerCase()):A.setResult(!1)},()=>{A.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return A.task},t=z=>String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",m.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"",z,m.AFrameworkApplication.qj);var w=a(159);class r{constructor(){this.yWa=null}get Skd(){return!!this.yWa}set Skd(z){z!==this.yWa&&(this.yWa=z,w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(z),this.Lhf()&&
m.AFrameworkApplication.yd.Jm(t("saveHoverableRibbonTooltipIsEnabled"),2,z.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}kti(){const z=new l.a;if(this.yWa)z.setResult(this.yWa);else if(this.Lhf()){const A=u("getHoverableRibbonTooltipIsEnabled");A.continueWith(()=>{this.yWa=A.result;w.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(A.result);z.setResult(A.result)},8)}else z.setResult(!1)}Lhf(){const z=m.AFrameworkApplication.fa.qa("IsRoamingServiceEnabled"),
A=m.AFrameworkApplication.fa.qa("IsAnonymousUser");return z&&!A}}Object(n.a)(r,"AccessibilitySettingsInfo",null,[268]);var v=a(247),y=a(166);class x{constructor(){this.gb=null}get name(){return"Common.App.AccessibilitySettings"}Wh(z){this.gb=z;this.gb.register(r,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Fc(()=>new r).wc();this.gb.register(k,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Fc(()=>
new k(m.AFrameworkApplication.vb,this.gb.yh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).wc()}init(){const z=this.gb.yh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),A=this.gb.yh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");z&&A?(A.Ig(),z.kti()):y.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){v.a.instance.Gi(new x)}}Object(n.a)(x,
"AccessibilitySettingsPackage",null,[3,4]);a.d(C,"a",function(){return B});const B=()=>{Type.registerNamespace("Common.App.AccessibilitySettings");x.main()}},1197:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(15),f=a(86),e=a(27),k=a(414),l=a(1123),m=a(521),u=a(186),t=a(224),w=a(24),r=a(65),v=a(43),y=a(162),x=a(240),B=a(47),z=a(45),A=a(12),I=a(71),F=a(128),U=a(1),X=a(11),T=a(21),G=a(341),D=a(237),J=a(13),L=a(154),H=a(93),R=a(5),Q=a(248),O=a(77),V=a(97),W=a(42),da=a(34);class ta extends H.a{constructor(ua,
wa,ia,xa){super(ua);this.F9f=[6];this.x9f=[26];this.Sr=null;this.$zb=this.Hic=!1;this.ms=this.Xaa=null;this.a5=!1;this.onPointerDown=gb=>{if(1!==this.$.Ka.yH())return!0;gb=da.a(this.$).Vd(gb);if(this.qB)return!0;var va=W.a(this.$).lpd||W.a(this.$).gq();if(this.mrd||va)return this.fcb(),!0;this.ms=this.em;this.CJd();this.zkd();va=2===gb.tb&&gb.ao===Sys.UI.MouseButton.leftButton;const sa=3===gb.tb;if(va||sa)gb=this.ha.eo(gb.clientPoint,gb.Db,5,void 0,void 0,!0),gb||(gb=this.ms),this.$zb=va,this.Hic=
sa,this.ms=this.P4e(gb),this.zkd(),va?this.P8i():sa&&this.G9i(),Q.b(this.$,!0);return!0};this.Jh=gb=>{gb=da.a(this.$).Vd(gb);if(!this.qB)return!1;let va=this.$zb?this.ha.eo(gb.clientPoint,gb.Db,5,void 0,void 0,!0):this.ha.eo(gb.clientPoint,gb.Db,5,!0,!1,!0);this.a5&&!va&&(va=this.ha.hob(gb.clientPoint,gb.Db,5));va&&(gb=this.P4e(this.wZa(va)),this.l1b(gb.bottomRight),this.ms.equals(gb)||(this.ms=gb,this.DIb(!1),this.CJd(!1),this.zkd(!1),this.j7h(),this.ob.update(!1)),this.lRj(this.ms));return!0};this.Mf=
gb=>{da.a(this.$).Vd(gb);if(!this.qB)return!1;this.resizeTable();this.fcb();return!0};this.LFb=gb=>{da.a(this.$).Vd(gb);if(!this.qB)return d.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;this.resizeTable();this.fcb();return!0};this.A_=gb=>{da.a(this.$).Vd(gb);this.fcb();return!0};this.hwf=()=>{this.qB&&this.fcb()};this.gridView=wa;this.$=wa.$;this.tableManager=xa;this.ha=wa.ha;this.ob=wa.ob;this.parentElement=ua;this.cTg();e.a.Ap||
e.a.Y4||D.a.instance.ra(J.a.pointerDown,this.Xaa,this.onPointerDown);this.em=ia;this.aMc=this.mrd=!1;this.tableManager.wFg(this.hwf);this.a5=U.EwaSettings.isChangeGateEnabled("OfficeVSO:7030316_NewTableResizeExperience")}get qB(){return this.$zb||this.Hic}get Kif(){return this.aMc}dispose(){this.fcb();this.tableManager.Laj(this.hwf);this.Kif||e.a.Ap||e.a.Y4||D.a.instance.Ba(J.a.pointerDown,this.Xaa,this.onPointerDown);if(this.qB){Q.b(this.$,!1);try{this.Iv()}catch(ua){d.ULS.sendTraceTag(537151236,
0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ua}`)}}this.parentElement&&this.parentElement.contains(this.Xaa)&&this.parentElement.removeChild(this.Xaa);this.Xaa=this.parentElement=null;super.dispose()}P4e(ua){const wa=ua.bottom-this.em.topLeft.bottom-1;return 0<=ua.right-this.em.topLeft.right+1&&0<=wa&&ua.bottom>=this.em.top&&ua.right>=this.em.left?new w.Range(this.em.top,this.em.left,ua.bottom,ua.right,!1,!1):this.ms}zkd(ua=!0){this.Lwc([this.ms],6,ua);this.ob.Jn(this.F9f)}DIb(ua=
!0){this.ob.Pg(this.F9f);this.Lwc([null],6,ua)}CJd(ua=!0){this.ob.Pg(this.x9f);this.Lwc([null],26,ua)}j7h(){const ua=this.THj();0<ua.length&&(this.Lwc(ua,26,!1),this.ob.Jn(this.x9f))}THj(){const ua=[];this.em.contains(this.ms)&&(this.em.right!==this.ms.right&&ua.push(new w.Range(this.em.top,this.ms.right+1,this.ms.bottom,this.em.right,!1,!1)),this.em.bottom!==this.ms.bottom&&ua.push(new w.Range(this.ms.bottom+1,this.em.left,this.em.bottom,this.em.right,!1,!1)));return ua}resizeTable(){if(!this.ms.equals(this.em)){const ua=
new w.Range(this.em.top,this.em.left,this.ms.bottom,this.ms.right,!1,!1);this.GMj(ua);this.mrd=!0}}onKeyDown(ua){da.a(this.$).Vd(ua);return!0}d$a(){this.Kif&&(e.a.Ap||e.a.Y4||(D.a.instance.ra(J.a.pointerDown,this.Xaa,this.onPointerDown),this.Xaa.classList.remove("ewr-table-resize-default-cursor"),this.aMc=this.Xaa.disabled=!1),this.aMc=!1)}cTg(){const ua=document.createElement("div");ua.className="ewr-table-resize-handle";const wa=document.createElement("div");wa.className="ewr-table-resize-fillhandle-higher";
const ia=document.createElement("div");ia.className="ewr-table-resize-fillhandle-broader";ua.appendChild(wa);ua.appendChild(ia);this.Xaa=ua;this.parentElement.appendChild(this.Xaa)}l1b(ua){const wa=this.a5?2:5;let ia=60;const xa=this.ms.contains(ua);let gb=ua.top,va=ua.bottom,sa=ua.left,ab=ua.right,Ua=null;if(xa){if(this.gridView.wK(this.em.topLeft)&&!this.em.hTa)return;this.a5?ua.bottom<this.ms.bottom?(gb=Math.max(1,va-wa,this.em.top),ia=16):(sa=Math.max(1,ab-wa,this.em.left),ia=4):(gb=Math.max(1,
va-wa,this.em.top),sa=Math.max(1,ab-wa,this.em.left));va=gb;ab=sa;Ua=new w.Range(gb,sa,gb,sa,!1,!1)}else this.a5?ua.right>=this.em.right?(ab+=wa,ia=8):ua.bottom>=this.em.bottom&&(va+=wa,ia=32):(va+=wa,ab+=wa),gb=va,sa=ab,Ua=new w.Range(va,ab,va,ab,!1,!1),ia=16;this.gridView.wK(Ua)||(this.Sr?this.Sr.Lq||(this.Sr=B.a.instance.create(()=>{this.gridView.tt(Ua,ia,V.a.C9f)},40,z.a.D9f)):this.Sr=B.a.instance.create(()=>{this.gridView.tt(Ua,ia,V.a.C9f)},40,z.a.D9f))}wZa(ua){let wa=ua;if(this.gridView.ib.s4){if(!this.gridView.Vb(ua.topLeft)){const ia=
this.gridView.uk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.vH,this.ms.top!==ua.top?1:2);try{ia.Mk=this.ms.top<ua.top||this.ms.left<ua.left,ia.vs(ua.topLeft),wa=ia.$$cu().range}finally{ia&&ia.dispose()}}wa.right=wa.left+ua.width-1;wa.bottom=wa.top+ua.height-1}return wa}Lwc(ua,wa,ia=!0){const xa=[];for(const gb of ua)xa.push(new G.a(gb,r.d(this.$.oa)));this.ob.Ww(xa,[wa],!0,void 0,ia)}P8i(){this.a5&&D.a.instance.ra(J.a.Gj,document.documentElement,this.Jh);for(const ua of this.gridView.Cn)D.a.instance.ra(J.a.Gj,
ua.domElement,this.Jh);D.a.instance.ra(J.a.Nf,document.documentElement,this.Mf);this.iJe()}G9i(){this.a5&&L.a.instance.ra(J.a.Yf,document.documentElement,this.Jh);for(const ua of this.gridView.Cn)L.a.instance.ra(J.a.Yf,ua.domElement,this.Jh);L.a.instance.ra(J.a.ue,document.documentElement,this.LFb);this.iJe()}Iv(){this.$zb&&this.yPj();this.Hic&&this.JPj()}yPj(){this.a5&&D.a.instance.Ba(J.a.Gj,document.documentElement,this.Jh);for(const ua of this.gridView.Cn)D.a.instance.Ba(J.a.Gj,ua.domElement,this.Jh);
D.a.instance.Ba(J.a.Nf,document.documentElement,this.Mf);this.OOf()}JPj(){this.a5&&L.a.instance.Ba(J.a.Yf,document.documentElement,this.Jh);for(const ua of this.gridView.Cn)L.a.instance.Ba(J.a.Yf,ua.domElement,this.Jh);L.a.instance.Ba(J.a.ue,document.documentElement,this.LFb);this.OOf()}iJe(){this.a5||D.a.instance.ra(J.a.sy,document.documentElement,this.A_);this.gridView.hc.X7b(!0)}OOf(){this.a5||D.a.instance.Ba(J.a.sy,document.documentElement,this.A_);this.gridView.hc.X7b(!1)}GMj(ua){this.$.fd(-1400250766,
O.a.Gb,30,{["ResizeTableRange"]:ua,["OriginalTableRange"]:this.em})}lRj(ua){if(!this.em.contains(ua)){ua=this.SHj();for(const wa of ua)if(this.tableManager.Mrd(wa)){this.gridView.Ff.dm(R.a.YDi);return}}this.gridView.rtl?this.gridView.Ff.dm(R.a.eDi):this.gridView.Ff.dm(R.a.gFi)}fcb(){if(this.qB){Q.b(this.$,!1);try{this.Iv()}catch(ua){d.ULS.sendTraceTag(537151232,0,10,`TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception ${ua}`)}}this.Sr&&(this.Sr.cancel(),this.Sr.dispose());
this.Hic=this.$zb=!1;this.DIb();this.CJd();Q.b(this.$,!1);this.gridView.Ff.dm(R.a.BQ)}SHj(){const ua=[];this.em.right!==this.ms.right&&ua.push(new w.Range(this.em.top,this.em.right+1,this.ms.bottom,this.ms.right,!1,!1));this.em.bottom!==this.ms.bottom&&ua.push(new w.Range(this.em.bottom+1,this.em.left,this.ms.bottom,this.em.right,!1,!1));return ua}static createInstance(ua,wa,ia,xa){if(!wa)return null;const gb=ua.ob;gb.Ww(ia,[27],!0);gb.Jn(ta.OHj);ia=gb.nv(27,ua.ib.Oi(wa.bottomRight),ta.HNh(wa,ia)).wf;
return new ta(ia,ua,wa,xa)}static HNh(ua,wa){var ia;for(let xa=0;xa<wa.length;xa++)if((null===(ia=wa[xa])||void 0===ia?0:ia.range)&&wa[xa].range.equals(ua))return xa;return 0}}ta.OHj=[27];Object(n.a)(ta,"TableResizeBehavior",H.a,[]);var K=a(7);H=a(236);class na{}na.mth="ewa-ttrd-buttonarea";Object(n.a)(na,"CssClassNames",null,[]);var P=a(49),ka=a(132),pa=a(90),Na=a(22),Z=a(14),Ra=a(253),Da=a(133),Ba=a(262);class ea extends H.a{constructor(ua){super(document.createElement("div"));this.aUc=this.rod=
this.wHf=this.DQ=!1;this.NKb=null;this.Hh=()=>{x.c(this.$,this.gridView.ha.sa.activeCell)?(this.mMa=!0,this.prb(!1)):(this.JZ=this.mMa=!1,this.rdg())};this.At=()=>{this.mMa?this.prb(!0):this.JZ=!1};this.lwf=()=>{this.aUc=!0;this.mMa&&(this.JZ=!1)};this.onContentReady=()=>{this.$.isEditMode?x.c(this.$,this.gridView.ha.sa.activeCell)&&(this.mMa=!0,this.prb(!1)):this.JZ=!1};this.Kya=()=>{this.aUc=!1;this.mMa?this.prb(!1):this.JZ=!1};this.rf=(wa,ia)=>{this.mMa&&(wa=this.gridView.Jpc(ia.hd.block.qe.BlockCachePosition.PaneType).AG(ia.hd.hash))&&
(wa.SKd(this.zLa),wa.cWc(this.zLa))};this.zLa=()=>{this.PSf()};this.$=ua;this.gridView=T.g(this.$);this.parentElement=this.domElement;this.parentElement.className=na.mth;this.cLa=this.gridView.zj;this.mMa=!0;this.Eai();this.xNg();this.prb(!1);d.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ")}get JZ(){return this.rod}set JZ(ua){this.rod!==ua&&(this.rod=this.isVisible=ua)}get SAb(){return!!(this.$.Cd&16)}get Aji(){const ua=this.gridView.ha.sa.activeCell;return ua.right===
ua.maxColumns}get Imb(){const ua=this.gridView.Vb(null);return ua&&this.gridView.f5(ua.range)?this.Hva(ua):(ua&&d.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}dispose(){this.$&&this.ofh();this.$=this.gridView=this.parentElement=this.cLa=null;super.dispose()}ALh(ua){const wa=this.g_h(this.gridView.Vb(null).range);return wa?`=SUBTOTAL(${ua},${wa})`:null}g_h(ua){var wa=T.g(this.$).Fb.hk(ua);if(!wa)return null;wa=y.a(wa,!1);wa.right=
wa.left=ua.left;return wa.toString()}Eai(){ea.mM={};ea.mM["100"]=Z.a.instance.ga(1104);ea.mM["101"]=Z.a.instance.ga(1107);ea.mM["102"]=Z.a.instance.ga(1106);ea.mM["103"]=Z.a.instance.ga(1111);ea.mM["104"]=Z.a.instance.ga(1108);ea.mM["105"]=Z.a.instance.ga(1109);ea.mM["109"]=Z.a.instance.ga(1105);ea.mM["107"]=Z.a.instance.ga(1112);ea.mM["110"]=Z.a.instance.ga(1114);ea.mM["111"]=Z.a.instance.ga(1165)}HWi(){var ua=this.gridView.Vb(null);if(ua&&(ua=ua.tF?ua.formulaBarText:null))if("=SUBTOTAL("===ua.substring(0,
10)){if(ua=ua.substring(10,13),ua in ea.mM)return ua}else return"111";return"100"}xNg(){this.gridView.Ea.Ws(this.rf);this.gridView.ha.vJ(this.Hh);this.gridView.Uu(this.onContentReady);this.gridView.hc.Vk(this.lwf);this.gridView.hc.lm(this.Kya)}ofh(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.bL(this.Hh),this.gridView.Ea.Xq(this.rf)),this.gridView.xy(this.onContentReady),this.gridView.hc&&(this.gridView.hc.Ak(this.lwf),this.gridView.hc.Fl(this.Kya)),this.rdg())}prb(ua){this.wRj(ua);this.SAb&&
(this.tGj(),this.Imb?(this.wHf||this.HNg(),this.aUc?this.JZ=!1:(this.JZ=!0,this.PSf())):(d.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),this.JZ=!1))}PSf(){appChrome.renderTableTotalRowOptions(this.parentElement,ea.mM,ea.mM[this.HWi()].toString(),Math.round(da.a(this.$).Ci(17)),ua=>{d.ULS.sendTraceTag(537151198,0,50,`TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : ${ua}`);let wa={["SelectedOption"]:ea.mM[ua],
["FunctionKeyCode"]:ua,["Location"]:"canvas"};Da.b(this.$).Hd(ka.a.XHj,wa,null,!0);if("111"===ua)return this.Ydi(),!0;if("100"!==ua){this.NKb=this.ALh(ua);if(!this.NKb)return d.ULS.sendTraceTag(537151197,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;this.dSa(this.NKb)}else this.dSa("");A.DOMElementExtensions.setFocus(this.gridView.Xb.textBox.domElement);return!0})}Ydi(){d.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");
const ua=new pa.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Lb(ua)}Hva(ua){if(!ua)return null;var wa=this.gridView.hc.textBox.domElement;var ia=0<A.DOMElementExtensions.getHeight(wa)&&0<A.DOMElementExtensions.getWidth(wa)&&0<=wa.offsetTop&&0<=wa.offsetLeft;if(ia)wa=A.DOMElementExtensions.Hva(wa,this.gridView.zj);else{wa=this.gridView.getCellBounds(ua.cell);var xa=A.DOMElementExtensions.getBoundingClientRect(this.gridView.zj);wa=new Sys.UI.Bounds(wa.x-xa.x,wa.y-xa.y,wa.width,wa.height)}if(wa)if(ia)2<
wa.height&&2<wa.height&&(wa.x+=1,wa.y+=1,wa.height-=2,wa.width-=2);else if(ia=T.g(this.$).dK(ua.cell))ia=ia.width,xa=Na.a.equals(Ra.a.Bvb(ua.cell,this.gridView.rtl),"right",!0),this.gridView.rtl&&xa&&(wa.x=wa.x+wa.width-ia),ua.Ska&&this.gridView.rtl===xa&&(wa.width=ia);else return null;return wa}wRj(ua){var wa=this.Imb;if(wa){var ia=17>=wa.height?wa.y:wa.y+wa.height-17-2;wa=this.Aji?this.gridView.rtl?wa.x:wa.x+wa.width-(17<wa.height?17:wa.height):this.gridView.rtl?wa.x-(17<wa.height?17:wa.height):
wa.x+wa.width;var xa=da.a(this.$).Ija(new Sys.UI.Point(wa,ia));this.parentElement.style.top=X.HelperMethods.pc(xa.y);this.parentElement.style.left=X.HelperMethods.pc(xa.x);da.a(this.$).Wrj(this.parentElement);ua&&(this.JZ=this.gridView.Pic(new P.a(wa,ia)))}else this.JZ=!1}HNg(){this.cLa.insertBefore(this.parentElement,this.cLa.firstChild);this.wHf=!0}tGj(){this.DQ||(this.gridView.view.Xs(this.At),this.DQ=!0)}rdg(){this.DQ&&this.gridView.view&&(this.gridView.view.Zq(this.At),this.DQ=!1)}dSa(ua){const wa=
this.gridView.Xb,ia=this.gridView.Vb(null);ia&&(ua=Object(K.a)(new Ba.a,{Text:ua}),this.gridView.setCell(ua,ia.range,0,127,null),wa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))}}ea.WHj="TableTotalRowDropDownIconButtonId";ea.mM=null;Object(n.a)(ea,"TableTotalRowOptions",H.a,[10]);class Y extends l.a{constructor(ua){super(T.g(ua));this.Lpb=this.L0=this.dAc=this.Jpb=null;this.nre=!1;this.Gae=null;this.hSb=0;this.I5b=null;this.D0b=()=>{const wa={},ia=this.Hgd();for(let gb in ia){const va=ia[gb];
if(!va)continue;const sa=this.lZh(va);if(sa){if(sa in this.JFa){var xa=this.JFa[sa];if(xa.qB){xa.em.equals(va)||(xa.em=va);delete this.JFa[sa];wa[sa]=xa;continue}}(xa=ta.createInstance(T.g(this.$),va,this.wIh(),this))?wa[sa]=xa:d.ULS.sendTraceTag(537151239,0,15,`TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range ${va.pz(!1)}`)}}this.G2b(null,null);this.PQb=wa};this.G2b=()=>{const wa=this.JFa;for(let gb in wa){var ia=gb,xa=wa[gb];xa&&(xa.dispose(),delete this.JFa[ia])}this.PQb=
{}};this.bNf=()=>{this.G2b(null,null);this.D0b(null,null)};this.onFocus=()=>{this.Gae=T.g(this.$).ha.sa.activeCell};this.mR=()=>{this.$.isEditMode&&this.Hh(null,null)};this.Hh=()=>{!this.nre&&x.c(this.$,this.gridView.ha.sa.activeCell)&&this.vti()};this.EV=()=>{this.Ayb(1);this.$.ea.fo(this.EV)};this.UGb=()=>{this.nre=!0;this.dAc=new ea(this.$)};this.$=ua;this.gridView=T.g(this.$);this.$.da.Ga(66,this);this.PQb={};this.D0b(null,null);this.$.xa&&this.$.xa.Qf(this.bNf);this.ipe(this.D0b);this.$.ea.aY(this.mR);
this.gridView.ha.vJ(this.Hh);this.$.isEditMode&&this.Hh(null,null)}ipe(ua){this.addHandler(l.a.xHd,ua)}fSf(ua){this.removeHandler(l.a.xHd,ua)}wFg(ua){this.addHandler("tce",ua)}Laj(ua){this.removeHandler("tce",ua)}get JFa(){return this.PQb}get ctd(){return this.Gae}get rIa(){return this.hSb}get Mg(){const ua=T.g(this.$);return ua.Fb.hk(ua.ha.sa.activeCell,!1)}get cGd(){return this.ctd?T.g(this.$).Fb.hk(this.ctd,!1):null}Mrd(ua){return!!this.U1e(ua)}qn(ua){return this.PVh(this.B2e(ua))}jvb(ua){return this.B2e(ua)}D9i(ua){ua?
(this.Lpb?this.Lpb!==ua&&(f.a.Ia(this.L0),this.L0=null,this.Lpb=ua):this.Lpb=ua,this.L0||(this.L0=F.a.instance.$d(this.Lpb)),this.L0.tn("focusin")||this.L0.ka("focusin",this.onFocus)):d.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")}fff(ua,wa){return ua?ua.aba&&ua.top===wa.top:(d.ULS.shipAssertTag(537151244,0,!!ua,"autofilterRange can't be null"),!1)}Gja(ua){ua=this.Jpb?v.I(ua,this.Jpb):this.view.getRangeInformation(ua);return 0<ua.length&&
Object(k.a)(t.PivotTableRange,ua[0])?ua[0]:null}mgi(ua,wa){return ua?!ua.ygc&&!!ua.RE&&ua.RE.Bd(wa):(d.ULS.shipAssertTag(537151243,0,!!ua,"Pivot table can't be null"),!1)}kmi(ua,wa){return ua?!ua.ygc&&!!ua.jL&&ua.jL.Bd(wa):(d.ULS.shipAssertTag(537151242,0,!!ua,"Pivot table can't be null"),!1)}vZb(ua){super.vZb(ua);if((ua=X.HelperMethods.e2e(ua))&&0<ua.length){this.Jpb=Array(ua.length);for(let wa=0;wa<ua.length;wa++)this.Jpb[wa]=u.a.tQ(ua[wa])}}wIb(){super.wIb();this.Jpb=null}X4g(ua,wa){return this.PDe(ua,
wa).returnValue}PDe(ua,wa){var ia=!1;if(!ua||!wa)return{returnValue:!1,jY:ia};ua=ua.clone();ua.right+=1;ua.left=ua.right;return!ua.Ez||ua.top<wa.ib.dj&&(ia=ua.clone(),ia.bottom>=wa.ib.dj&&(ia.bottom=wa.ib.dj-1),!({jY:ia}=this.ODe(ia,wa)).returnValue)||ua.bottom>=wa.ib.dj&&(ia=ua.clone(),ia.top<=wa.ib.dj&&(ia.top=wa.ib.dj),!({jY:ia}=this.ODe(ia,wa)).returnValue)?{returnValue:!1,jY:ia}:{returnValue:!0,jY:ia}}E9f(ua){(ua=this.qn(ua.topLeft))&&ua.toString()in this.JFa&&(this.JFa[ua.toString()].mrd=!1)}p3i(){this.raiseEvent("tce")}Yh(ua,
wa){if(!this.dAc)return!1;switch(wa){case -569786022:case 541421805:if(this.dAc.JZ){const ia=document.getElementById(ea.WHj);ia&&B.a.instance.create(()=>{A.DOMElementExtensions.vfc(ia,null)},0,z.a.QHj,!0,!0)}return!0;default:return!1}}dispose(){this.G2b(null,null);this.fSf(this.D0b);this.$.xa.Eg(this.bNf);this.$.Gl(this.G2b);this.PQb=null;this.$.ea&&this.$.ea.b0(this.mR);this.gridView.ha.bL(this.Hh);this.dAc=null;U.EwaSettings.ma(407)&&this.L0&&(f.a.Ia(this.L0),this.L0=null);super.dispose()}K4h(ua,
wa,ia,xa){const gb=this.gridView.Fb.hk(new w.Range(wa,ia,wa,ia,!1,!1));if(this.I5b=gb){var va=gb.usedRange,sa=ua.ctrlKey||e.a.isMac&&I.b(ua),ab=!ua.shiftKey&&sa;ua=ua.shiftKey&&!sa;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(T.g(this.$).ha.selectionType=3);switch(xa){case 0:this.hSb=0;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(wa=this.Z4c(ua,va.top,ia,va.bottom,ia),this.FQd(wa,ab,ua)):this.GQd(va.top,ia,va.bottom,
ia,y.d(gb),y.g(gb),ab);break;case 1:this.hSb=1;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(wa=this.Z4c(ua,wa,va.left,wa,va.right),this.FQd(wa,ab,ua)):this.GQd(wa,va.left,wa,va.right,!1,!1,ab);break;case 2:this.hSb=2;U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(wa=this.Z4c(ua,va.top,va.left,va.bottom,va.right),this.FQd(wa,ab,ua)):this.GQd(va.top,va.left,va.bottom,va.right,y.d(gb),y.g(gb),ab);break;default:d.ULS.shipAssertTag(537151240,
0,!1,`TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: ${xa.toString()}`);return}U.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(T.g(this.$).ha.selectionType=3);d.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else d.ULS.shipAssertTag(537151241,0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")}wwj(ua){const wa=
this.I5b.usedRange;return this.jhf(ua)||1!==this.rIa&&this.jhf(new w.Range(wa.top,ua.left,wa.bottom,ua.right,!1,!1))?!0:!1}wHd(ua){return ua.Autofilters}ODe(ua,wa){let ia;ia=!1;const xa=wa.ib.Oi(ua),gb=wa.Hf(xa).mi;if(!gb)return d.ULS.sendTraceTag(537151238,0,15,`TableManager.CouldExpandImpl - loadedRange is null. PaneType=${xa}`),{returnValue:!1,jY:ia};if(!gb.Ie(ua))return{returnValue:!0,jY:ia};ua=wa.uk("TableManager.CouldExpandImpl",ua,2);try{for(;ua.$$mn();){if(ua.$$cu().text||ua.Sn.j8e)return ia=
!0,{returnValue:!1,jY:ia};if(ua.$$cu().QH)return{returnValue:!1,jY:ia}}}finally{ua&&ua.dispose()}return{returnValue:!0,jY:ia}}PVh(ua){if(!ua)return null;const wa=new m.AutofilterRange(ua.top,ua.left,ua.bottom,ua.right,null,null,null,ua.id,ua.aba);wa.hTa=ua.hTa;const ia=this.gridView.Fb.hk(ua,!0);if(!ia)return null;for(let xa=0,gb=this.rangeList.length;xa<gb;xa++){const va=this.rangeList[xa],sa=this.gridView.Fb.hk(va,!0);sa&&sa.name===ia.name&&va!==ua&&this.rli(va)&&(wa.union(va),va.hTa&&(wa.hTa=!0))}return wa}rli(ua){return!!T.g(this.$).Fb.hk(ua)}wIh(){const ua=
[];for(const wa of this.rangeList){const ia=new G.a(this.qn(wa.topLeft),r.d(this.$.oa));ua.push(ia)}return ua}Hgd(){const ua={};for(const wa of this.rangeList){if(!wa)continue;const ia=this.qn(wa.topLeft);ia&&(ua[ia.toString()]=this.qn(wa.topLeft))}return ua}vti(){this.$.ea.Hg?this.Ayb(0):this.$.ea.Ll(this.EV)}Ayb(ua){this.$.Yx(wa=>{wa.Baa(ua).then(this.UGb)})}lZh(ua){const wa=this.gridView.Fb.hk(ua);return wa?wa.name:ua.toString()}GQd(ua,wa,ia,xa,gb,va,sa){const ab=ua+(gb?1:0),Ua=ia-(va?1:0),nb=
this.gridView.inRangePicker||this.gridView.Fi;let Ha=!1;const sb=new w.Range(ab,wa,Ua,xa,!1,!1);if(gb||va){gb=nb?G.a.Jrb(this.gridView.ha.rangePicker.XK):this.gridView.ha.sa.selectedRanges;for(const Qb of gb){Ha=this.Oqb(Qb,ab,wa,Ua,xa);gb=this.Oqb(Qb,ua,wa,ia,xa);if(nb&&Ha)break;if(!nb&&(Ha||gb)){this.gridView.ha.updateSelection(Qb,Qb.topLeft,0,1);if(sa&&gb)return;break}}}Ha&&(sb.top=ua,sb.bottom=ia);ua=sb.topLeft;sa?this.gridView.ha.updateSelection(sb,ua,0,1):nb?this.gridView.ha.Xw([sb],0,ua,0):
this.gridView.ha.updateSelection(sb,ua,0,3)}FQd(ua,wa,ia){ua&&(ia=ia?T.g(this.$).ha.sa.activeCell:ua.topLeft,wa?this.gridView.ha.updateSelection(ua,ia,0,1):this.gridView.ha.Xw([ua],0,ia,0))}Z4c(ua,wa,ia,xa,gb){const va=y.d(this.I5b),sa=y.g(this.I5b),ab=wa+(1!==this.rIa&&va?1:0),Ua=xa-(1!==this.rIa&&sa?1:0),nb=this.gridView.inRangePicker||this.gridView.Fi;if(ua){var Ha=U.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&nb&&!G.a.Jrb(this.gridView.ha.rangePicker.XK).length?
new w.Range(ab,ia,Ua,gb,!1,!1):nb?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.sa.activeCell;Ha=new w.Range(Ha.top<ab?Ha.top:ab,Ha.left<ia?Ha.left:ia,Ha.bottom>Ua?Ha.bottom:Ua,Ha.right>gb?Ha.right:gb,!1,!1)}else Ha=new w.Range(ab,ia,Ua,gb,!1,!1);if(1!==this.rIa&&(va||sa)&&(!ua||ua&&this.Oqb(Ha,ab,ia,Ua,gb))){ua=nb?G.a.Jrb(this.gridView.ha.rangePicker.XK):this.gridView.ha.sa.selectedRanges;for(const sb of ua)if(this.Oqb(sb,ab,ia,Ua,gb)){Ha.top=wa;Ha.bottom=xa;break}}return Ha}jhf(ua){const wa=
this.gridView.inRangePicker||this.gridView.Fi?G.a.Jrb(this.gridView.ha.rangePicker.XK):this.gridView.ha.sa.selectedRanges;for(const ia of wa)if(this.Oqb(ia,ua.top,ua.left,ua.bottom,ua.right))return!0;return!1}Oqb(ua,wa,ia,xa,gb){return!!ua&&ua.top===wa&&ua.bottom===xa&&ua.left===ia&&ua.right===gb}}Object(n.a)(Y,"TableManager",l.a,[258,10]);class ja extends b.a{constructor(ua){super();this.tableManager=null;this.$=ua;this.Eb()}create(){this.pb(this.tableManager||(this.tableManager=new Y(this.$)))}}
Object(n.a)(ja,"TableManagerFactory",b.a,[]);var ca=a(1212);a.d(C,"a",function(){return ba});const ba=()=>{c.a.Fa(ua=>{ua.da.Ga(134,new ja(ua));ua.da.Ga(330,new ca.a(ua))})}},1212:function(n,C,a){n=a(0);var c=a(222),b=a(50),d=a(37),f=a(7),e=a(15),k=a(111),l=a(814),m=a(1455),u=a(725),t=a(1385),w=a(38),r=a(5),v=a(160),y=a(77),x=a(61),B=a(162),z=a(47),A=a(45),I=a(110);a(28);var F=a(192),U=a(29),X=a(282),T=a(1),G=a(22),D=a(14);a(30);class J{}Object(n.a)(J,"TableStyleElement",null,[]);var L=a(750),H=a(209),
R=a(87),Q=a(526);class O{static Hof(na,P){return O.H9f[na.Type]-O.H9f[P.Type]}static t4a(na,P){try{return appChrome.buildTableStyleGalleryIconNew(O.qBa,O.koa,na,P)}catch(ka){return null}}static Mif(na){return na&&y.a.Qc in na&&(na=na[y.a.Qc])?G.a.uL(na,r.a.gHb):!1}static jta(na){const P=[];let ka=0;for(const pa of na){P[ka]={};P[ka].backgroundColor="white";P[ka].color="black";for(let Na in pa)switch(na=pa[Na],Na){case "background-color":P[ka].backgroundColor=na;break;case "color":P[ka].color=na;break;
case "font-size":P[ka].fontSize=na;break;case "border-bottom":P[ka].borderBottom=na;break;case "border-right":P[ka].borderRight=na;break;case "border-left":P[ka].borderLeft=na;break;case "border-top":P[ka].borderTop=na}ka++}return P}static l4b(na,P){const ka=[];if(null===na||void 0===na?0:na.TableStyleElementsList){var pa=0===na.Category;for(let Na=0;Na<O.koa;Na++)ka.push(...O.wMh(na,P,pa,Na))}else{if(O.x6c)return O.x6c;na={color:"black","background-color":"white"};for(P=0;P<O.koa;P++)for(pa=0;pa<
O.qBa;pa++)ka.push(na);O.x6c=ka}return ka}static mZh(na,P){if(!na.TableStyleElementsList)return"";let ka="";for(const pa of na.TableStyleElementsList)if(pa.BackgroundColor&&"#000000"!==pa.BackgroundColor)switch(pa.Type){case 0:ka=pa.BackgroundColor;break;case 5:case 7:if(P.Kha||P.QR)ka=pa.BackgroundColor;break;case 3:case 4:if(P.firstCol||P.lastCol)ka=pa.BackgroundColor;break;case 2:P.totalRow&&(ka=pa.BackgroundColor);break;case 1:P.headerRow&&(ka=pa.BackgroundColor)}return ka}static m3b(na){na=new H.a(parseInt(String("0x"+
na.substr(1,2)),16),parseInt(String("0x"+na.substr(3,2)),16),parseInt(String("0x"+na.substr(5,2)),16));return L.a.HKa(na)}static l4e(na,P){if(!na||!P)return"";P=(P=O.mZh(na,P))?O.m3b(P)+", ":D.a.instance.ga(2068)+", ";switch(na.Index){case 0:return P+D.a.instance.ga(2002);case 1:return P+D.a.instance.ga(2003);case 2:return P+D.a.instance.ga(2004);case 3:return P+D.a.instance.ga(2005);case 4:return P+D.a.instance.ga(2006);case 5:return P+D.a.instance.ga(2007);case 6:return P+D.a.instance.ga(2008);
case 7:return P+D.a.instance.ga(2009);case 8:return P+D.a.instance.ga(2010);case 9:return P+D.a.instance.ga(2011);case 10:return P+D.a.instance.ga(2012);case 11:return P+D.a.instance.ga(2013);case 12:return P+D.a.instance.ga(2014);case 13:return P+D.a.instance.ga(2015);case 14:return P+D.a.instance.ga(2016);case 15:return P+D.a.instance.ga(2017);case 16:return P+D.a.instance.ga(2018);case 17:return P+D.a.instance.ga(2019);case 18:return P+D.a.instance.ga(2020);case 19:return P+D.a.instance.ga(2021);
case 20:return P+D.a.instance.ga(2022);case 21:return P+D.a.instance.ga(2023);case 22:return P+D.a.instance.ga(2024);case 23:return P+D.a.instance.ga(2025);case 24:return P+D.a.instance.ga(2026);case 25:return P+D.a.instance.ga(2027);case 26:return P+D.a.instance.ga(2028);case 27:return P+D.a.instance.ga(2029);case 28:return P+D.a.instance.ga(2030);case 29:return P+D.a.instance.ga(2031);case 30:return P+D.a.instance.ga(2032);case 31:return P+D.a.instance.ga(2033);case 32:return P+D.a.instance.ga(2034);
case 33:return P+D.a.instance.ga(2035);case 34:return P+D.a.instance.ga(2036);case 35:return P+D.a.instance.ga(2037);case 36:return P+D.a.instance.ga(2038);case 37:return P+D.a.instance.ga(2039);case 38:return P+D.a.instance.ga(2040);case 39:return P+D.a.instance.ga(2041);case 40:return P+D.a.instance.ga(2042);case 41:return P+D.a.instance.ga(2043);case 42:return P+D.a.instance.ga(2044);case 43:return P+D.a.instance.ga(2045);case 44:return P+D.a.instance.ga(2046);case 45:return P+D.a.instance.ga(2047);
case 46:return P+D.a.instance.ga(2048);case 47:return P+D.a.instance.ga(2049);case 48:return P+D.a.instance.ga(2050);case 49:return P+D.a.instance.ga(2051);case 50:return P+D.a.instance.ga(2052);case 51:return P+D.a.instance.ga(2053);case 52:return P+D.a.instance.ga(2054);case 53:return P+D.a.instance.ga(2055);case 54:return P+D.a.instance.ga(2056);case 55:return P+D.a.instance.ga(2057);case 56:return P+D.a.instance.ga(2058);case 57:return P+D.a.instance.ga(2059);case 58:return P+D.a.instance.ga(2060);
case 59:return P+D.a.instance.ga(2061);default:return na.Name?na.Name:""}}static uTh(na){return(na+1)%O.e8h}static Iwb(na,P,ka=""){return na||!ka?`${O.y$e}, ${na.Index.toString()}, -version, ${P.toString()}`:`${O.y$e}, ${ka}, -version, ${P.toString()}`}static wMh(na,P,ka,pa){const Na=[];for(let Z=0;Z<O.qBa;Z++)Na.push(O.jed(na,P,ka,pa,Z));return Na}static jed(na,P,ka,pa,Na){na=na.TableStyleElementsList;let Z=new J;const Ra={};if(!na)return Ra;for(var Da of na)if(0===Da.Type){Z=Da;break}Da=!!Z.BackgroundColor;
let Ba="";!ka&&Z.TableStyleBorderFromatList&&0<Z.TableStyleBorderFromatList.length&&(Ba=Z.TableStyleBorderFromatList[0].Color);Ra["background-color"]=Da?Z.BackgroundColor:"#FFFFFF";Z.FontColor||(Z.FontColor="#000000");Ra.color=Z.FontColor;O.Xye(pa,Na,Ra,Z,Ba,ka,Da);for(const ea of na)ea&&0!==ea.Type&&(2!==ea.Type||Da||(ea.BackgroundColor=Z.BackgroundColor),O.Drd(ea,pa,Na,P)&&(ea.BackgroundColor&&(Ra["background-color"]=ea.BackgroundColor),Ra.color=ea.FontColor||Z.FontColor,O.Xye(pa,Na,Ra,ea,Ba,ka,
Da)));return Ra}static TU(na,P,ka,pa,Na,Z){ka&&(ka.Color&&!ka.Style&&(ka.Style=1),ka.Style&&!ka.Color&&(ka.Color=Na?"#000000":pa?pa:Z?"#FFFFFF":"#000000"),P[O.borders[na]]="1px "+O.vV[ka.Style]+" "+ka.Color)}static Drd(na,P,ka,pa){return-1===na.Type?!1:O.Frd(na,P,ka,pa)||O.wni(na,P,ka,pa)||O.Grd(na,P,ka,pa)}static wni(na,P,ka,pa){return!P&&pa.headerRow||P===O.koa-1&&pa.totalRow?!1:1===P%2&&5===na.Type&&pa.QR&&pa.headerRow||1<P&&!!((P-1)%(na.BandSize+1))&&6===na.Type&&pa.QR&&pa.headerRow||!(P%2)&&
5===na.Type&&pa.QR&&!pa.headerRow||!!(P%(na.BandSize+1))&&6===na.Type&&pa.QR&&!pa.headerRow||!(ka%2)&&7===na.Type&&pa.Kha||!!(ka%(na.BandSize+1))&&8===na.Type&&pa.Kha}static Grd(na,P,ka,pa){return P===O.koa-1&&2===na.Type&&pa.totalRow||ka===O.qBa-1&&P===O.koa-1&&12===na.Type&&pa.totalRow&&pa.lastCol||!ka&&P===O.koa-1&&11===na.Type&&pa.totalRow&&pa.firstCol||ka===O.qBa-1&&4===na.Type&&pa.lastCol}static Frd(na,P,ka,pa){return!P&&1===na.Type&&pa.headerRow||!ka&&3===na.Type&&pa.firstCol||!ka&&!P&&9===
na.Type&&pa.headerRow&&pa.firstCol||ka===O.qBa-1&&!P&&10===na.Type&&pa.headerRow&&pa.lastCol}static Xye(na,P,ka,pa,Na,Z,Ra){if(pa.TableStyleBorderFromatList)for(const Da of pa.TableStyleBorderFromatList)if(Da.Style)switch(Da.Position){case 0:na&&12!==pa.Type&&11!==pa.Type&&2!==pa.Type&&5!==pa.Type&&6!==pa.Type||O.TU(0,ka,Da,Na,Z,Ra);break;case 1:na!==O.koa-1&&1!==pa.Type&&10!==pa.Type&&9!==pa.Type&&5!==pa.Type&&6!==pa.Type||O.TU(1,ka,Da,Na,Z,Ra);break;case 2:P&&12!==pa.Type&&10!==pa.Type&&7!==pa.Type&&
8!==pa.Type&&4!==pa.Type||O.TU(2,ka,Da,Na,Z,Ra);break;case 3:P!==O.qBa-1&&9!==pa.Type&&11!==pa.Type&&3!==pa.Type&&7!==pa.Type&&8!==pa.Type||O.TU(3,ka,Da,Na,Z,Ra);break;case 5:P!==O.qBa-1&&3!==pa.Type&&4!==pa.Type&&7!==pa.Type&&8!==pa.Type&&O.TU(3,ka,Da,Na,Z,Ra);break;case 6:na!==O.koa-1&&2!==pa.Type&&1!==pa.Type&&5!==pa.Type&&6!==pa.Type&&O.TU(1,ka,Da,Na,Z,Ra)}}static pZh(){const na=Array(12);na[0]=0;na[7]=1;na[8]=2;na[5]=3;na[6]=4;na[4]=5;na[3]=6;na[1]=7;na[2]=8;na[9]=9;na[10]=10;na[11]=11;na[12]=
13;return na}}O.koa=5;O.qBa=5;O.e8h=5;O.y$e="TableStyleIcon";O.vV=[null,R.a.solid,R.a.dashed,R.a.dotted,R.a.dashed,R.a.dotted,R.a.dashed,R.a.double];O.borders=[Q.a.borderTop,Q.a.borderBottom,Q.a.borderLeft,Q.a.borderRight];O.H9f=O.pZh();O.x6c=null;Object(n.a)(O,"TableStyleHelper",null,[]);class V{constructor(na,P,ka,pa,Na,Z){this.headerRow=na;this.totalRow=P;this.firstCol=ka;this.lastCol=pa;this.QR=Na;this.Kha=Z}equals(na){return na?this.headerRow===na.headerRow&&this.totalRow===na.totalRow&&this.firstCol===
na.firstCol&&this.lastCol===na.lastCol&&this.Kha===na.Kha&&this.QR===na.QR:!1}}Object(n.a)(V,"TableStyleOptions",null,[]);var W=a(790);class da extends w.a{constructor(na,P,ka){super();this.A0i={["height"]:"100%"};this.nIb={};this.iIa=this.Ahd=0;this.lastSyncTime=new Date;this.Hda=-1;this.XN=null;this.Dma={};this.wL=null;this.MI={};this.ITa={};this.osc=null;this.NAb=this.N6a=this.isInitialized=this.bhf=!1;this.ovc=null;this.Dzc=this.tNb=this.GVe=!1;this.xMi=(pa,Na,Z)=>{let Ra=!1;if(X.a(pa))-315732528!==
pa.Errors[0].MessageId&&(e.ULS.sendTraceTag(42821707,0,10,`TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : ${U.a.xc(pa.Errors)}`),this.szf(null,Na,Z));else if(e.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(pa=pa.Result)&&pa.TableStyleItems.length){Z=60<pa.TableStyleItems.length;var Da=!1,Ba=!1;if(this.wL)for(var ea=0;60>ea;++ea){const Y=pa.TableStyleItems[ea],ja=this.wL.TableStyleItems[ea];if(Y.HasStyleViolations!==
ja.HasStyleViolations){Ra=Ba=!0;break}for(let ca=0;9>ca&&!(ca>=Y.TableStyleElementsList.length);ca++)if(!G.a.equals(Y.TableStyleElementsList[ca].BackgroundColor,ja.TableStyleElementsList[ca].BackgroundColor,!1)){Ra=Da=!0;break}}else{this.iIa=0;for(ea of pa.TableStyleItems)ea.TableStyleElementsList&&ea.TableStyleElementsList.sort(O.Hof),this.MI[ea.Name]=ea}if(Da||Ba)for(Da=0;60>Da;++Da)Ba=pa.TableStyleItems[Da],this.MI[Ba.Name]=Ba;if(Z&&this.wL)for(e.ULS.sendTraceTag(42821700,0,50,`TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - ${pa.TableStyleItems.length-
60}`),Ra=!0,Z=60;Z<pa.TableStyleItems.length;++Z)Da=pa.TableStyleItems[Z],Da.Name in this.MI||Da.TableStyleElementsList&&Da.TableStyleElementsList.sort(O.Hof),this.MI[Da.Name]=Da;if(W.a(this.MI).length!==pa.TableStyleItems.length)for(Ra=!0,Da=Z=60;Da<this.wL.TableStyleItems.length;)Z>=pa.TableStyleItems.length?delete this.MI[this.wL.TableStyleItems[Da].Name]:Z>=pa.TableStyleItems.length||!G.a.equals(pa.TableStyleItems[Z].Name,this.wL.TableStyleItems[Da].Name,!1)?delete this.MI[this.wL.TableStyleItems[Da].Name]:
++Z,++Da;this.wL=pa;this.fPf(Ra);Ra&&this.uZc();Na&&("accessibility"===Na?(this.tNb=!1,this.Dzc=!0):this.Dzc=!1);this.bhf||(this.Mni()&&this.$.$e(),this.bhf=!0);this.Ahd=0;this.NAb||this.GVe?this.Dzc&&this.raiseEvent("RefreshTableStyleGallery"):(this.raiseEvent("RefreshTableStyleGallery"),this.GVe=!0)}};this.szf=()=>{e.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");this.Ahd++;5>this.Ahd&&z.a.instance.create(()=>{this.V4a("getTableStylesFailed")},
1E3,A.a.G9f,!0,!0)};this.ZEf=()=>{this.NAb&&(this.NAb=!1,this.ovc&&this.ovc(),z.a.instance.create(()=>{this.V4a("galleryMenuClosed")},1E3,A.a.G9f,!0,!0))};this.$=na;this.Ua=P;this.tableManager=ka;this.$.da.Ga(329,this);this.QZc=this.Evb();this.$.Ka.jZa(this.ZEf)}x7e(na){const P=this.tableManager.Mg;if(!P)return!1;na=na[y.a.Qc];if(!na)return!1;switch(Number.parseInvariant(na)){case 0:return B.d(P);case 1:return B.c(P);case 2:return B.g(P);case 3:return B.e(P);case 4:return B.f(P);case 5:return B.b(P);
case 6:return P.hasAutoFilter}return!1}WIf(na,P){if(k.a.isEmpty(this.MI))return!0;if("PopulateTableMoreStylesMenu"!==na&&"PopulateTableAccessibleStylesMenu"!==na)return!1;if("PopulateTableAccessibleStylesMenu"===na&&!this.Dzc)return this.tNb||(this.tNb=!0,this.V4a("accessibilityTab")),!0;this.NAb=!0;const ka=this.Ua.Up("TableStylesMenu"),pa=this.Ua.ZA("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Na=this.Ua.ZA("Ribbon.TableTools.TableStyles.Gallery.Dark",7,"Size48by48"),Z=this.Ua.ZA("Ribbon.TableTools.TableStyles.Gallery.Medium",
7,"Size48by48"),Ra=this.Ua.ZA("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48");let Da=-123538519,Ba;if(P.MenuId)if(G.a.contains(P.MenuId,"FormatAsTable",!0))Da=753331043,this.N6a=!0;else{Ba=D.a.instance.ga(2001);var ea=O.Iwb(null,1,"-1");T.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Ra.Vt("-1",Da,"QueryTableStyle",0,"-1",ea,void 0,void 0,Ba):Ra.Vt("-1",Da,"QueryTableStyle",0,"-1",void 0,void 0,void 0,Ba);this.N6a=!1}ea=0;const Y=this.MI;for(let ja in Y){const ca=
Y[ja];if("PopulateTableAccessibleStylesMenu"===na&&ca.HasStyleViolations)continue;let ba;Ba=O.l4e(ca,this.Evb());ba=O.Iwb(ca,this.iIa);if(ca)switch(ca.Category){case 0:pa.Vt(ca.Index.toString(),Da,"QueryTableStyle",0,ca.Index.toString(),ba,void 0,void 0,Ba);ea++;break;case 3:Na.Vt(ca.Index.toString(),Da,"QueryTableStyle",0,ca.Index.toString(),ba,void 0,void 0,Ba);break;case 2:Z.Vt(ca.Index.toString(),Da,"QueryTableStyle",0,ca.Index.toString(),ba,void 0,void 0,Ba);break;case 1:Ra.Vt(ca.Index.toString(),
Da,"QueryTableStyle",0,ca.Index.toString(),ba,void 0,void 0,Ba)}}0<ea&&this.o2(ka,pa,1969);this.o2(ka,Ra,1970);this.o2(ka,Z,1971);this.o2(ka,Na,1972);P.MenuItems=ka.yC();this.isInitialized||(this.isInitialized=!0);return!0}rjd(na){na[l.a.On]=!1;let P=na[y.a.Qc];if(P&&!k.a.isEmpty(this.MI)){G.a.contains(na.ParentMenuId,"FormatAsTable",!0)?this.N6a=!0:this.N6a=!1;this.N6a||this.deg();O.Mif(na)&&(P=this.Yvb(P).toString());var ka=this.Evb();na[l.a.Alt]="-1"===P?D.a.instance.ga(2001):O.l4e(this.zhd(P),
ka);if(P in this.ITa&&ka.equals(this.QZc))this.YIf(na,P,ka,!0);else{if(!this.osc||this.osc&&!this.osc.Lq)this.Dma={},this.osc=z.a.instance.create(()=>{this.fPf();this.QZc=this.Evb()},0,A.a.VHj,!0,!0);this.XEd(ka,na,P)}}}getTableStyleIndexFromName(na){if(!na||k.a.isEmpty(this.MI))return-1;if(na in this.MI)return this.MI[na].Index;this.V4a("getTableStyleIndexFromName");return-1}Nrd(){return!!this.wL}Yvb(na){this.XN||this.uZc();return na in this.XN?this.XN[na]:-1}V4a(na){if(this.$.isEditMode){var P=
new Date;if(30<I.getElapsedSeconds(this.lastSyncTime,P)||k.a.isEmpty(this.MI)||this.tNb){let ka=this.$.pa.va.Tb();this.lastSyncTime=P;na=this.tNb&&"accessibilityTab"===na||"galleryMenuClosed"===na;x.m(this.$.pa.va,na,this.xMi,this.szf,null,na?"accessibility":"normal",ka)}}}dispose(){this.XN=this.ITa=this.wL=this.MI=null;this.$.Ka.$Ib(this.ZEf);super.dispose()}cIg(na){this.addHandler("RefreshTableStyleGallery",na)}Ocj(na){this.removeHandler("RefreshTableStyleGallery",na)}uZc(){const na={};this.tableManager.Mg&&
(this.Hda=this.getTableStyleIndexFromName(this.tableManager.Mg.cAc));for(let P=1;7>=P;P++)na["preview"+P]=this.ySh(P);this.XN=na}ySh(na){var P=this.wL.TableStyleItems.length;P=4>=this.Hda?this.Hda+na-1:4<this.Hda&&this.Hda<P-4?4===na?this.Hda:Math.floor(this.Hda+na-4):this.Hda+na-1;-1===P||P.toString()in this.ITa||(P=na-3);return P}deg(){if(this.tableManager.Mg){let na=!1;const P=this.getTableStyleIndexFromName(this.tableManager.Mg.cAc);if(P!==this.Hda){if(this.XN){const ka=this.XN;for(let pa in ka)ka[pa]===
P&&(na=!0)}this.Hda=P;na||k.a.isEmpty(this.ITa)||this.uZc()}}}o2(na,P,ka){const pa=this.Ua.Dc();pa.Vp="Thin";pa.title=D.a.instance.ga(ka);pa.buttons.push(P);na.sc.push(pa)}Evb(){const na=this.tableManager.Mg;return this.N6a||!na?new V(!0,!1,!1,!1,!0,!1):new V(B.d(na),B.g(na),B.c(na),B.e(na),B.f(na),B.b(na))}fPf(na=!1){const P={},ka={},pa=this.Evb();if(!k.a.isEmpty(this.MI)&&(this.tableManager.Mg&&this.deg(),!pa.equals(this.QZc)||na||k.a.isEmpty(this.ITa))){this.iIa=O.uTh(this.iIa);na=this.MI;for(var Na in na){const Z=
na[Na],Ra=O.Iwb(Z,this.iIa);P[Z.Index.toString()]=O.t4a(O.jta(O.l4b(Z,pa)),Ra);ka[Ra]=P[Z.Index.toString()];this.mIb(ka)}Na=O.Iwb(null,this.iIa,"-1");P["-1"]=O.t4a(O.jta(O.l4b(null,pa)),Na);ka[Na]=P["-1"];this.mIb(ka);F.c(this.ITa,P,!1)}}Mni(){const na=v.a(this.$);return na?na.cm.Yz===r.a.jbb:!1}XEd(na,P,ka){Number.parseInvariant(ka);"-1"===ka&&G.a.contains(P.ParentMenuId,"FormatAsTable",!0)||this.YIf(P,ka,na,!1)}YIf(na,P,ka,pa){const Na=O.Iwb(null,this.iIa,P);O.Mif(na)?(Na in this.Dma?ka=this.Dma[Na]:
(ka=O.jta(O.l4b(this.zhd(P),ka)),this.Dma[Na]=ka),na[l.a.GalleryButtonProps]=Object(f.a)(new m.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Na,Alt:na[l.a.Alt],MenuItemId:P,TableCellStyles:ka,TableStyles:this.A0i})):(na[u.a.Icon]=Na,na[l.a.GalleryButtonProps]=Object(f.a)(new t.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Na,Alt:na[l.a.Alt],MenuItemId:P}),pa||(pa=[],this.zhd(P),"-1"===P||G.a.contains(na.ParentMenuId,"FormatAsTable",!0)||(pa=O.l4b(this.wL.TableStyleItems[Number.parseInvariant(P)],
ka)),this.ITa[P]=O.t4a(O.jta(pa),Na)))}mIb(na){if(this.NAb)this.ovc=()=>{this.mIb(na)};else{this.ovc=null;var P=[];for(let pa in na){var ka=pa;ka in this.nIb?P.push(ka):this.nIb[ka]=!0}try{0<P.length&&appChrome.api.unregisterIcons(P),k.a.isEmpty(na)||appChrome.api.registerIconProvider(()=>na)}catch(pa){}}}zhd(na){na=Number.parseInvariant(na);if(-1===na||!this.wL)return null;if(60<na)for(let P=60;P<this.wL.TableStyleItems.length;++P){const ka=this.wL.TableStyleItems[P];if(ka.Index===na)return ka}return this.wL.TableStyleItems[na]}}
Object(n.a)(da,"TableStyleManager",w.a,[257,10]);var ta=a(55);a.d(C,"a",function(){return K});class K extends c.a{constructor(na){super();this.tableStyleManager=null;this.$=na;this.Eb()}create(){const na=b.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb),P=b.GetServiceTaskFactory.Sa(this.$.da,66,134,this.fb);d.TaskExtensions.Aa(ta.Task.XI(na,P),()=>{this.pb(this.tableStyleManager||(this.tableStyleManager=new da(this.$,na.result,P.result)))},this.$.la,8)}}Object(n.a)(K,"TableStyleManagerFactory",
c.a,[])},1227:function(n,C,a){n=a(0);var c=a(222),b=a(15),d=a(164),f=a(246),e=a(372),k=a(4),l=a(645),m=a(88),u=a(93),t=a(259),w=a(160),r=a(72),v=a(418),y=a(50),x=a(37),B=a(90),z=a(71),A=a(1),I=a(575),F=a(21);class U extends u.a{constructor(R,Q){super(R);this.VS=[];this.Bae=null;this.LJb=O=>{let V="forward";O.Values[e.a.direction]?V=O.Values[e.a.direction].toLowerCase():b.ULS.sendTraceTag(537166664,0,15,"Didn't find direction in message values");O=0;let W=!0;"backward"===V?(O=this.$sd.length-1,W=!1):
"forward"===V?(O=0,W=!0):b.ULS.sendTraceTag(537166663,0,15,`Received unknown direction to resume focus: ${V}`);this.nsf(W,O,!1)};this.tAf=()=>{this.VS=[]};this.iPa=O=>{-411645385===this.$.shortcutKeyManager.ot(O,!0)&&this.Nff()&&(this.$.Ka.Lb(new B.a(-411645385,1,this.$.Kc,6,null),{["event"]:O},O),O.stopPropagation())};this.TNi=O=>{this.fma(O)};this.jb=Q;this.rq=F.g(this.jb);this.Gc.ka("keydown",this.TNi);this.Gc.ka("keyup",this.iPa);t.a(Q).oIg(this.tAf);r.a(Q.ya,27)&&x.TaskExtensions.Aa(y.GetServiceTaskFactory.Sa(Q.da,
21,137,1),O=>{O=O.result;O.qo(d.a.Q9e);O.$l(d.a.Q9e,this.LJb)},Q.la)}get $(){return this.jb}get $sd(){this.VS.length||(this.VS=this.t0e());return this.VS}get ala(){return this.Bae}set ala(R){this.Bae=R;this.VS=this.t0e()}dispose(){this.$&&t.a(this.$).bdj(this.tAf);this.jb=null;this.VS.length=0;super.dispose()}p1i(R){this.fma(R)}nsf(R,Q,O=!0,V=null){var W=this.mHj(R,Q,O,V);if(!W){O=Q;var da=R?1:-1,ta=this.$sd;do{W=!1;if(r.a(this.$.ya,27)){if(O+=da,O>=ta.length||0>O)W=!0}else O=(O+da+ta.length)%ta.length;
if(W){this.sxi(R,Q,V);break}else if(W=this.k9f(R,Q,O,!1,V))break}while(O!==Q)}}mHj(R,Q,O=!0,V=null){let W=null;0<=Q&&(W=this.VS[Q]);return(null===W||void 0===W?0:W.Jf)&&W.hg(R,O)?(V&&z.g(V),b.ULS.sendTraceTag(537166669,0,50,`Switched focus inside current section ${W.ee} into a sub region`),W.sj(),!0):!1}k9f(R,Q,O,V,W=null){O=this.VS[O];if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){const da=t.a(this.jb).nB(f.a.PJa),ta=t.a(this.jb).nB(f.a.Rwb),K=this.rq.ha.Qa.LZ;
if(O===ta&&K||O===da&&!V&&!K)return!1}if((null===O||void 0===O?0:O.Jf)&&O.hg(R,!1)){W&&z.g(W);O.sj();if(R=this.VS[Q])R.Vj(),b.ULS.sendTraceTag(537166668,0,50,`Switched focus from section ${R.ee} to ${O.ee}`);return!0}return!1}sxi(R,Q,O=null){O&&z.g(O);if(Q=this.VS[Q])Q.Vj(),b.ULS.sendTraceTag(537166666,0,50,`Lost focus from section ${Q.ee}`);x.TaskExtensions.Aa(y.GetServiceTaskFactory.Sa(this.$.da,21,137,0),V=>{V.result.Mj(d.a.wmb,{[e.a.direction]:R?"forward":"backward"})},this.$.la)}fma(R){var Q=
this.$.isEditMode?w.a(this.$):null;if(!this.$.rb.kxa||U.cji(Q))if(117===R.keyCode&&(R.ctrlKey||z.b(R))){Q=this.j3e(R.target);var O=!R.shiftKey;b.ULS.sendTraceTag(537166662,0,50,`AccessibilityManager.OnKeyDownHandler: Ctrl+F6 loop. The root index section is: ${Q}`);if(A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",!1)){var V=t.a(this.jb).nB(f.a.QJb);V=this.VS.indexOf(V);k.AFrameworkApplication.ta.Oa.ww&&this.$.UZ&&-1!==V&&Q===V&&1===this.$.aeb&&l.ShyRibbon.EJ(1,0)}else k.AFrameworkApplication.ta.Oa.ww&&
this.$.UZ&&1===Q&&1===this.$.aeb&&l.ShyRibbon.EJ(1,0);this.nsf(O,Q,!0,R)}else 117!==R.keyCode||U.WSe?-411645385===this.$.shortcutKeyManager.ot(R)?this.Nff()&&(this.$.Ka.Lb(new B.a(-411645385,1,this.$.Kc,6,null),{["event"]:R},R),R.stopPropagation()):1588554917===this.$.shortcutKeyManager.ot(R)?0===this.mode?(I.a(this.$)||this.$.Ka.Lb(new B.a(1588554917,1,this.$.Kc,6,null),{["event"]:R},R),R.preventDefault(),R.stopPropagation()):3===this.mode&&(R.preventDefault(),R.stopPropagation()):A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ObjectLayerFixes",
!1)&&1058684758===this.$.shortcutKeyManager.ot(R)?(Q=this.j3e(R.target),V=t.a(this.jb).nB(f.a.QJb),O=t.a(this.jb).nB(f.a.PJa),V=this.VS.indexOf(V),O=this.VS.indexOf(O),k.AFrameworkApplication.ta.Oa.ww&&this.$.UZ&&-1!==V&&Q===V&&1===this.$.aeb&&l.ShyRibbon.EJ(1,0),-1!==O&&Q!==O&&this.k9f(!0,Q,O,!0,R)):this.T2h(R):(R=v.a.pC.notificationBar.k3(m.a.BOh(),!1),R.image=0,v.a.pC.notificationBar.qC(R),U.WSe=!0)}j3e(R){const Q=this.$sd;for(let O=0,V=Q.length;O<V;++O){const W=Q[O];if(W&&W.mh(R))return O}return-1}t0e(){const R=
[];for(let Q=0,O=this.ala.length;Q<O;Q++){const V=t.a(this.$).nB(this.ala[Q]);V&&R.push(V)}return R}Nff(){return 0===this.mode||4===this.mode}static cji(R){return R?R.inKeytipMode:!1}}U.WSe=!1;Object(n.a)(U,"AccessibilityManager",u.a,[284,10]);var X=a(148),T=a(22),G=a(14);class D extends U{constructor(R){super(document.documentElement,R);this.eC=0;this.WOg=[f.a.DDe,f.a.nzd,f.a.Mdc,f.a.CXd,f.a.QJb,f.a.wZc,f.a.pcd,f.a.Q5e,f.a.DYc,f.a.iAc,f.a.CCj,f.a.Rwb,f.a.L_c,f.a.PJa,f.a.KRd,f.a.S_c,f.a.E7f,f.a.imf,
f.a.ZYc];this.pWj=[f.a.Mdc,f.a.fhg,f.a.ehg,f.a.ghg];this.Q0i=[f.a.Mdc,f.a.tKf,f.a.uKf,f.a.xKf];this.RWg=[f.a.RVe,f.a.P5e,f.a.ncd,f.a.lcd];this.r0i=[f.a.DDe,f.a.nzd,f.a.wZc,f.a.pcd,f.a.DYc,f.a.iAc,f.a.Rwb,f.a.L_c,f.a.PJa,f.a.KRd,f.a.UJf,f.a.S_c,f.a.ZYc];this.B0i=[f.a.Rwb,f.a.XVe];const Q=G.a.instance.Va(253);this.Gqj=this.$.shortcutKeyManager.CKa(Q);this.mode=0;R.da.Ga(15,this);x.TaskExtensions.Aa(y.GetServiceTaskFactory.Sa(R.da,21,137,1),O=>{O=O.result;O.qo(d.a.wmb);O.$l(d.a.wmb,this.LJb)},R.la)}get mode(){return this.eC}set mode(R){this.eC=
R;switch(R){case 0:this.ala=this.WOg;break;case 2:this.ala=this.pWj;break;case 3:this.ala=this.Q0i;break;case 4:this.ala=this.RWg;break;case 5:this.ala=this.r0i;break;case 6:this.ala=this.B0i;break;default:b.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}fma(R){this.$.Cd&65536&&super.fma(R)}T2h(R){if(T.a.equals(this.Gqj,this.$.shortcutKeyManager.kfd(R),!1)){const Q=X.b(this.$);if(null===Q||void 0===Q?0:Q.Jf)z.g(R),Q.hg(!0,!1)}}}Object(n.a)(D,"EwaAccessibilityManager",
U,[]);class J extends c.a{constructor(R){super();this.$=R;this.Eb()}create(){this.pb(this.$.da.za(15)||new D(this.$))}static ka(R){R.da.Ga(157,new J(R))}}Object(n.a)(J,"AccessibilityManagerFactory",c.a,[]);var L=a(9);a.d(C,"a",function(){return H});const H=()=>{L.a.Fa(J.ka)}},1228:function(n,C,a){var c=a(9);n=a(0);var b=a(15),d=a(222),f=a(37),e=a(53),k=a(289),l=a(213);class m{}m.wPe="ewa-svg-icon";Object(n.a)(m,"CssClassNames",null,[]);var u=a(50),t=a(12),w=a(313),r=a(184);class v{constructor(B){this.Cg=
()=>{this.nmf();this.$.ea.fo(this.Cg)};this.$=B;this.j9f={};this.eWd={};const z=this.a0e("excelInitialAppSprite");z?(this.Hne(z),this.$.ea.Hg?this.nmf():B.ea.Ll(this.Cg),this.$.da.Ga(388,this)):b.ULS.sendTraceTag(537151263,0,15,"window[excelInitialAppSprite].icons returned null.")}dispose(){this.eWd=null;this.$.ea.fo(this.Cg)}Rva(B,z,A=null,I=null){let F;(F=this.eWd[B])||(this.eWd[B]=F=this.hXi(this.j9f[B]));if(!F)return b.ULS.shipAssertTag(537151262,0,!1,`SvgIconProvider.GetSvgElement: id ${B} was not found in loaded SVG sprites.`),
null;const U=F.cloneNode(!0);if(!U.style){const X=w.b(F),T=w.b(U),G={};G.iconId=B;G.isOriginalNodeStyleNull=void 0===F.style||null===F.style;G.isOriginalNodeCurrentStyleNull=void 0===F.currentStyle||null===F.currentStyle;G.isClonedNodeCurrentStyleNull=void 0===U.currentStyle||null===U.currentStyle;G.originalNode=X.substring(0,X.indexOf(">")+1);G.clonedNode=T.substring(0,T.indexOf(">")+1);b.ULS.sendTraceTag(537151261,0,10,`SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: ${JSON.stringify(G)}`)}U.setAttribute("style",
`height: ${z}px; width: ${z}px;`);I&&(B=document.createElement("title"),B.innerHTML=I,U.insertBefore(B,U.childNodes[0]));if(A)for(const X of A)Sys.UI.DomElement.addCssClass(U,X);return U}lba(B,z,A,I,F=0,U=0,X=null,T=null){F&&U||(U=t.DOMElementExtensions.getBoundingClientRect(I),F=U.height,U=U.width);if(X=this.Rva(B,z,X,T))I.appendChild(X),(I=t.DOMElementExtensions.cZ(X,"style",null))?X.setAttribute("style",I+` margin: ${(F-z)/2}px ${(U-A)/2}px;`):b.ULS.sendTraceTag(537151260,0,10,`SvgIconProvider.InsertAndCenterSvgElement: svgElement's GetAttribte("styl") returned null. Icon ID: ${B}`);
return X}nmf(){f.TaskExtensions.Aa(u.GetServiceTaskFactory.Sa(this.$.da,283,284,0),B=>{B=r.c(B.result.ko.loadScript("excel-uiSlice20-sprite"));f.TaskExtensions.Aa(B,()=>{const z=this.a0e("excelUiSlice20Sprite");z?this.Hne(z):b.ULS.sendTraceTag(537151259,0,15,"window[excelUiSlice20Sprite].icons returned null.")},this.$.la,3)},this.$.da.la,3)}Hne(B){for(const z of B)z.type===l.a.cWd&&(this.j9f[z.id]=z)}hXi(B){if(!B)return null;const z=B.viewBox;B=B.children;const A=document.createElementNS(k.a.fWd,
l.a.cWd);Sys.UI.DomElement.addCssClass(A,m.wPe);A.setAttribute("focusable","false");A.setAttribute("viewBox",z);this.vEg(A,B);return A}vEg(B,z){for(const I of z){const F=document.createElementNS(k.a.fWd,I.type);for(let U in I){z=U;var A=I[U];"className"===z?F.setAttribute("class",A):F.setAttribute(z,A)}B.appendChild(F)}}a0e(B){return(B=window[B])?B.icons:null}}Object(n.a)(v,"SvgIconProvider",null,[380,10]);class y extends d.a{constructor(B){super();this.$=B;this.Eb()}create(){f.TaskExtensions.Aa(e.a.bR([131],
4,this.fb,void 0,void 0,void 0,387),()=>{window.excelInitialAppSprite?this.pb(this.$.da.za(388)||new v(this.$)):b.ULS.sendTraceTag(537151258,0,50,"window.[excelInitialAppSprite] returned null.")},this.la,3)}static ka(B){B.da.Ga(387,new y(B))}}Object(n.a)(y,"SvgIconProviderFactory",d.a,[]);a.d(C,"a",function(){return x});const x=()=>{c.a.Fa(y.ka)}},1252:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(21),f=a(1123);class e extends f.a{constructor(m,u){super(m);u.Ga(240,this)}qYh(m){for(const u of this.rangeList)if(m.range.contains(u))return u;
return null}wHd(m){return m.GridBlockModel&&(m=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(m.GridBlockModel))?m.getSparklineRanges():null}}Object(n.a)(e,"SparklineManager",f.a,[260]);class k extends b.a{constructor(m){super();this.sparklineManager=null;this.$=m;this.Eb()}create(){this.pb(this.sparklineManager||(this.sparklineManager=new e(d.g(this.$),this.$.da)))}static ka(m){m.da.Ga(239,new k(m))}}Object(n.a)(k,"SparklineManagerFactory",b.a,[]);a.d(C,"a",function(){return l});const l=
()=>{c.a.Fa(k.ka)}},1272:function(n,C,a){n=a(0);var c=a(143),b=a(600);class d extends b.a{constructor(){super()}dispose(){c.WacAirSpace.knd()&&c.WacAirSpace.NAc()}animate(k,l,m,u,t){l&&c.WacAirSpace.nL(k.element,l);c.WacAirSpace.animate(k,u,t);m&&c.WacAirSpace.h$i(k.element,m)}}Object(n.a)(d,"AnimationManager",b.a,[10]);var f=a(101);a.d(C,"a",function(){return e});const e=()=>{f.a.Sl.Ga(141,new d)}},1446:function(n,C,a){a.r(C);n=a(1196);C=a(1160);var c=a(1119),b=a(1120),d=a(1121),f=a(1124);a(1122);
var e=a(1227),k=a(1272),l=a(9),m=a(0),u=a(222),t=a(187),w=a(553),r=a(15),v=a(810),y=a(518),x=a(83),B=a(4),z=a(78),A=a(907);class I extends z.a{constructor(D){super();this.Wtd=null;this.$=D;r.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created")}Phj(){const D=new t.a,J=y.a.er(x.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>")),L=new w.a(()=>J.result);this.Wtd=new w.a(()=>new v.a(L.value,null));if(!this.Wtd)return D;var H=this.Wtd.value.oZ("NewAndOpenCoreManager",!1);if(!H||3!==H.state||
!H.Vxd)return H?r.ULS.sendTraceTag(544289226,0,50,`NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: ${H.state}, mruResult MruDocuments is null: ${!H.Vxd}`):r.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;H=H.Vxd;const R=["xlsx","xlsb","xlsm"];for(let O=0;O<H.length;O++){var Q=H[O];if(0>Array.indexOf(R,Q.extension))continue;const V=`${Q.title}.${Q.extension}`,W=A.b(Q,B.AFrameworkApplication.isRtl);Q=Q.url;V&&W&&Q?D.add({[I.fileName]:V,
[I.friendlyPath]:W,[I.section]:"mru",[I.absoluteUrl]:Q}):Q||r.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}return D}dispose(){super.dispose()}}I.fileName="FileName";I.friendlyPath="FriendlyPath";I.section="Section";I.absoluteUrl="AbsoluteUrl";Object(m.a)(I,"NewAndOpenCoreManager",z.a,[579,10]);class F extends u.a{constructor(D){super();this.$=D;this.Eb()}create(){this.pb(this.$.da.za(451)||this.$.da.Ga(451,new I(this.$)))}static ka(D){D.da.Ga(164,
new F(D))}}Object(m.a)(F,"NewAndOpenCoreFactory",u.a,[]);m=a(1152);u=a(1252);z=a(1228);var U=a(1197),X=a(1155),T=a(1145),G=a(1164);a=a(1138);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");Type.registerNamespace("_Ewa");Object(n.a)();Type.registerNamespace("Common.App.AltTextDialog");
Object(C.a)();Object(c.a)();Object(b.a)();Object(d.a)();Object(e.a)();l.a.Fa(F.ka);Object(k.a)();Object(m.a)();Object(u.a)();Object(z.a)();Object(f.a)();Object(U.a)();Object(X.a)();Object(T.a)();Type.registerNamespace("Common.App.SessionExpiration");Object(G.a)();Object(a.a)()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.acc.js.map/87a8eb51fbf5b59500f86684fe57fd93/EwaDSEsNext.acc.js.map