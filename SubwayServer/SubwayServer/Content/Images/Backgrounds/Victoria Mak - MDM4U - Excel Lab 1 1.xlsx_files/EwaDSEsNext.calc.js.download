'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[14],{1157:function(n,C,a){n=a(0);var c=a(15),b=a(222),d=a(8),f=a(111);a(199);var e=a(187),k=a(82),l=a(165),m=a(184),u=a(65);class t{}t.local="Local";t.$Ij="Thread";Object(n.a)(t,"RecalcServiceCreateMode",null,[]);var w=a(162);class r{constructor(ca){this.V4d=null;this.init(ca)}get x$(){return this.V4d}init(ca){this.V4d=new l.a;if(void 0!==ca&&null!==ca&&void 0!==ca.HeadersList&&null!==ca.HeadersList&&0<ca.HeadersList.length)for(const ba of ca.HeadersList)this.x$.ia(ba.Index,
ba.Name)}}Object(n.a)(r,"ColHeadersListData",null,[]);var v=a(1),y=a(33),x=a(100),B=a(22),z=a(21),A=a(200);class I{constructor(ca,ba){this.Iwe=ca;this.sheetName=ba;this.$vc=!1}}Object(n.a)(I,"CalcBlockInformation",null,[]);class F{constructor(ca,ba,ua,wa,ia){this.type=ca;this.fullName=ba;this.range=ua;this.sheetId=wa;this.attributes=ia;this.QE=null}}Object(n.a)(F,"CalcNamedObject",null,[]);class U{constructor(ca){this.dgg=ca;this.Whe=[];this.ydg=[];this.V_a={};this.FRd=new Map}get Nj(){return this.Whe}s1f(ca,
ba){this.Whe[ca]=ba;this.dgg&&ba.r7&&this.FRd.set(ba.r7.sheetName,ca)}getSheetIndex(ca){if(this.dgg){if(this.FRd.has(ca))return this.FRd.get(ca)}else for(let ba=1;ba<this.Nj.length;ba++)if(B.a.equals(this.Nj[ba].r7.sheetName,ca,!1))return ba;return-1}}Object(n.a)(U,"GridCache",null,[]);var X=a(684),T=a(554);class G{constructor(ca){this.r7=ca;this.U5=new X.a(T.a.Zk());this.Zlc=!1}}Object(n.a)(G,"SheetInformation",null,[]);var D=a(938),J;(function(ca){ca[ca.initialization=0]="initialization";ca[ca.contentReady=
1]="contentReady";ca[ca.cellEdit=2]="cellEdit"})(J||(J={}));Object(n.b)("UpdateDataTrigger",J);class L{constructor(ca){this.hId=null;this.Dud=this.gId=this.rCd=!1;this.YFd=0;this.PFd=this.RFd=this.SFd=this.QFd=-1;this.trueName="TRUE";this.falseName="FALSE";this.instantaneousSupportInformationManager=this.ar=this.errorTypeNames=null;this.yt=this.currentStateId=-1;this.xta="";this.N$=null;this.getNameLoc=(ba,ua)=>this.phc()?this.Ve.na(this.currentStateId).Nj[0].U5.lb(ua)?(ba=excelOnlineCalc.location.nameLoc(ba,
ua),excelOnlineCalc.util.success(ba)):excelOnlineCalc.util.success(null):(ba=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ba));this.getContainingTable=ba=>{if(!this.phc())return ba=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ba);const ua=ba.range.col,wa=ba.range.row;var ia=this.Ve.na(this.currentStateId).Nj[0].U5,xa=null;for(let gb of ia)if(ia=gb.value,2===ia.type&&B.a.equals(ba.sheet.index.toString(),ia.sheetId,!0)){const va=ia.range;ua>=va.left-1&&ua<=
va.right-1&&wa<=va.bottom-1&&wa>=va.top-1&&(xa=excelOnlineCalc.location.nameScope(this.documentLoc,ia.sheetId),xa=excelOnlineCalc.location.nameLoc(xa,ia.fullName))}return xa?excelOnlineCalc.util.success(xa):excelOnlineCalc.util.success(null)};this.getStructRefColumn=(ba,ua)=>{if(!this.phc()){var wa=excelOnlineCalc.util.unavailable([2]);return excelOnlineCalc.util.failure(wa)}wa=ba.name;var ia=this.Ve.na(this.currentStateId).Nj[0].U5;if(ia.lb(wa)){ia=ia.na(wa);const gb=ia.range;if(2!==ia.type)return excelOnlineCalc.util.failure(this.p4c(5));
const va=ia.QE?ia.QE.x$:null;if(!va)return excelOnlineCalc.util.success(null);for(var xa of va)if(B.a.equals(xa.value,ua,!0))return ba=excelOnlineCalc.location.documentLoc(ba.scope.document.path,ba.scope.document.name),ba=excelOnlineCalc.location.sheetIndex(ba,ia.sheetId),xa=excelOnlineCalc.location.gridRange(gb.top-1,xa.key,gb.bottom-gb.top+1,1),xa=excelOnlineCalc.location.sheetGridRange(ba,xa),wa=excelOnlineCalc.location.structRefColumnLoc(wa,xa,!!(ia.attributes&16),!!(ia.attributes&8)),excelOnlineCalc.util.success(wa);
return gb.right-gb.left+1!==va.count?(wa=excelOnlineCalc.util.unavailable([17,ba,ua]),excelOnlineCalc.util.failure(wa)):excelOnlineCalc.util.failure(this.p4c(0))}return excelOnlineCalc.util.success(null)};this.getStructRefSpecialRef=(ba,ua)=>{if(!this.phc())return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);var wa=this.Ve.na(this.currentStateId).Nj[0].U5;if(wa.lb(ba.name)){var ia=wa.na(ba.name);if(2!==ia.type)return excelOnlineCalc.util.failure(this.p4c(5));wa=!!(ia.attributes&
16);const xa=!!(ia.attributes&8),gb=wa?1:0,va=xa?1:0;ba=excelOnlineCalc.location.documentLoc(ba.scope.document.path,ba.scope.document.name);ba=excelOnlineCalc.location.sheetIndex(ba,ia.sheetId);ia=ia.range;let sa={};if(1===ua)sa=excelOnlineCalc.location.gridRange(ia.top-gb-1,ia.left-1,ia.bottom+va-ia.top+gb+1,ia.right-ia.left+1);else if(2===ua)sa=excelOnlineCalc.location.gridRange(ia.top-1,ia.left-1,ia.bottom-ia.top+1,ia.right-ia.left+1);else if(3===ua)if(wa)sa=excelOnlineCalc.location.gridRange(ia.top-
2,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);else if(4===ua)if(xa)sa=excelOnlineCalc.location.gridRange(ia.bottom,ia.left-1,1,ia.right-ia.left+1);else return excelOnlineCalc.util.success(null);ua=excelOnlineCalc.location.sheetGridRange(ba,sa);return excelOnlineCalc.util.success(ua)}return excelOnlineCalc.util.success(null)};this.getDocumentLoc=(ba,ua)=>{if((B.a.equals(ba,this.documentLoc.path,!0)||!ba)&&B.a.equals(ua,this.documentLoc.name,!0))return excelOnlineCalc.util.success(this.documentLoc);
ba=excelOnlineCalc.util.unavailable([0,excelOnlineCalc.location.documentLoc(ba,ua)]);return excelOnlineCalc.util.failure(ba)};this.getSheetIndex=(ba,ua)=>{if(!this.Ve.lb(this.currentStateId)||!this.Ve.na(this.currentStateId).Nj)return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);ba=this.Ve.na(this.currentStateId).Nj;for(let wa=1;wa<ba.length;wa++)if(B.a.equals(ba[wa].r7.sheetName,ua,!0))return excelOnlineCalc.util.success(ba[wa].r7.sheetId);return excelOnlineCalc.util.success(null)};
this.getSheetName=(ba,ua)=>{if(!this.Ve.lb(this.currentStateId)||!this.Ve.na(this.currentStateId).Nj)return ua=excelOnlineCalc.util.unavailable([2]),excelOnlineCalc.util.failure(ua);ba=this.Ve.na(this.currentStateId).Nj;for(let wa=1;wa<ba.length;wa++)if(B.a.equals(ba[wa].r7.sheetId,ua,!0))return excelOnlineCalc.util.success(ba[wa].r7.sheetName);return excelOnlineCalc.util.success(null)};this.getUserDefinedFuncLoc=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetUserDefinedFuncLoc not implemented in main thread"]);
this.getSheetRangeIndexes=()=>excelOnlineCalc.util.notImplemented(["ParseGlobals.GetSheetRangeIndexes not implemented in main thread"]);this.LBf=()=>{this.setNumberFormats()};this.dd=()=>{c.ULS.sendTraceTag(537170081,0,50,"CalcAsyncEngine.OnWorkbookOpened() called");this.Ve=new l.a;this.currentStateId=this.yt=-1;this.xta="";this.$rb=null;this.gId=!1;this.ar&&this.clearCache()};this.B6f=(this.Jc=ca)?ca.ya.CalcWebWorkerSmokeTestPingIntervalMS:this.B6f;this.Ve=new l.a;this.$rb=null;this.documentLoc=
excelOnlineCalc.location.documentLoc("",this.Jc.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Coa();this.$od=y.a.$od()}dispose(){this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.xKd(this.LBf);this.Jc&&this.Jc.Hl(this.dd);this.close()}hPb(ca){if(!this.ar)return!1;if(!this.instantaneousSupportInformationManager&&(this.instantaneousSupportInformationManager=this.Jc.da.za(268),!this.instantaneousSupportInformationManager))return c.ULS.sendTraceTag(537170198,
0,50,"CalcAsyncEngine.UpdateData Failed to get instantaneousSupportInformationManager"),!1;2!==ca&&(this.currentStateId=this.Jc.ea.y8a,this.currentStateId===d.a.Be&&(this.currentStateId=this.Jc.ea.Je));if(1===ca&&this.currentStateId<this.yt)return c.ULS.sendTraceTag(537170197,0,50,`CalcAsyncEngine::UpdateData() currentStateId:${this.currentStateId} < lastUpdatedStateId:${this.yt} - ignoring update`),!1;this.Kpj();0!==ca&&this.gId||(this.buj(),this.jrj(),this.Vrj(),this.setNumberFormats(),this.instantaneousSupportInformationManager.Voe(this.LBf),
this.Jc.kl(this.dd),this.gId=!0);this.s6i();let ba=!1;0===ca&&(ba=this.Bai());if(0!==ca||ba)this.otj()?(this.Rtj(ca),this.Qtj(),this.yt=this.currentStateId,this.RYg()):c.ULS.sendTraceTag(537170196,0,15,`CalcAsyncEngine::UpdateData() for StateId:${this.currentStateId} failed - no Sheets information`);2!==ca&&this.resumeRecalc();return!0}evalFormula(ca,ba,ua,wa){if(!this.ar)return c.ULS.sendTraceTag(537170195,0,15,"CalcAsyncEngine.EvalFormula: recalc engine is null"),Promise.resolve({});ba=excelOnlineCalc.calc.sheetCellLocation(null!==
ua&&void 0!==ua?ua:u.d(this.Jc.xa.oa),ba.top-1,ba.left-1);ca=this.ar.evalFormula(this.Jc.ea.Je,ca,ba,wa);this.resumeRecalc();return ca}MUg(ca,ba,ua,wa=null){const ia=u.d(this.Jc.xa.oa);let xa=ca.cell.JQ-1,gb=ca.cell.IQ-1;var va=xa,sa=gb;let ab=null;wa&&(ab=excelOnlineCalc.calc.cellLocation(xa,gb),xa=wa.top-1,gb=wa.left-1,va=wa.bottom-1,sa=wa.right-1);ua=this.e0d(ca,ua,"SetCell");if(0>ua)return!1;sa=L.K$("CalculateFormula.cell",ia,xa,gb,va,sa);va=[];wa=this.aid(ia);ba=excelOnlineCalc.calc.inferredRangeFormulaEdit(sa,
ba,ab,wa);va.push(ba);ca=(ba=this.a5e())?String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,xa,gb,B.a.Xqe(ca.cell.text),ua,ba.top-1,ba.left-1,ba.bottom-1,ba.right-1):String.format("CalcAsyncEngine::CalculateFormula() for sheet:{0} pos:({1},{2}) text:{3} stateId:{4} viewport:(({5},{6})-({7},{8}))",ia,xa,gb,B.a.Xqe(ca.cell.text),ua,"","","","");c.ULS.sendTraceTag(537170180,0,50,ca);this.ar.editRangeFormulas(ua,va);this.resumeRecalc();
return!0}Ctb(ca,ba,ua,wa){if(!this.ar)return c.ULS.sendTraceTag(537170179,0,15,"CalcAsyncEngine::EvalFormulaRangeOnClone recalc engine is null"),Promise.reject("RecalcService is null");if(!ua||!ba)return c.ULS.sendTraceTag(524120779,0,15,`CalcAsyncEngine::EvalFormulaRangeOnClone inputs are null. originCell null: ${!ua}, outputColumnRange null: ${!ba}`),Promise.reject("CalcAsyncEngine::EvalFormulaRangeOnClone: null inputs");c.ULS.shipAssertTag(537170178,0,ua.isSingle,"CalcAsyncEngine::EvalFormulaRangeOnClone originCell must be a single cell.");
const ia=u.d(this.Jc.xa.oa),xa=this.aid(ia);var gb=null;if(ca){gb=[];for(const sa of ca)if(sa.column!==ua.left){ca=sa.row-1;var va=sa.column-1;ca=L.K$("EvalFormulaRangeOnClone.cell",ia,ca,va,ca,va);va=sa.text;gb.push(excelOnlineCalc.calc.rangeWrite(ca,excelOnlineCalc.calc.valueCellData(va,va,sa.Nk,null)))}}ua=excelOnlineCalc.calc.cellLocation(ua.top-1,ua.left-1);ba=L.K$("EvalFormulaRangeOnClone.outputColumnRange",ia,ba.top-1,ba.left-1,ba.bottom-1,ba.right-1);wa=[excelOnlineCalc.calc.cellFormulaRangeFormulaEdit(ba,
wa,ua,xa)];gb=this.ar.evalOnClonedModel(gb,wa);this.resumeRecalc();return gb}yGe(ca){let ba=null;try{if(ca)if(this.xta=z.g(this.Jc).Ea.jva(ca),this.currentStateId=ca.BTa,this.currentStateId<this.yt||this.currentStateId===d.a.Be)c.ULS.sendTraceTag(537170176,0,50,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() hash:${this.xta} blockRevision:${this.currentStateId} < lastUpdatedStateId:${this.yt}`);else{if(this.Hai(),!this.QPg())if(ba=this.Jc.Jb.Bc("ModelUpdate",`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() Block Hash:${this.xta} StateId:${this.currentStateId}`),
this.$rb=this.Ewb(ca.oa.sheetName),!this.$rb){const xa=!!(this.Jc.Cd&32),gb=this.Ve.lb(this.currentStateId)&&this.Ve.na(this.currentStateId).Nj?this.Ve.na(this.currentStateId).Nj.length:0;c.ULS.sendTraceTag(537170147,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel SheetName not found. Number of existing sheets ${gb}, scratchPad:${xa}, sheetNameLength:${ca.oa.sheetName?ca.oa.sheetName.length:-1} Hash:${ca.oa.hash}`)}else if(z.g(this.Jc).Ea.ym.e2a(ca.Pd)){var ua=ca.vf;if(ua){var wa=ua.getCalcBlockModel();
if(!wa)c.ULS.sendTraceTag(537170145,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model for block");else if(this.IPg(wa)){this.Ve.na(this.currentStateId).V_a[this.xta]=new I(wa,ca.oa.sheetName);var ia=ca.je;ia?this.hDg(ia.NamedObjects):c.ULS.sendTraceTag(537170144,0,15,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel GetGridBlockContentResponse is null")}}else c.ULS.sendTraceTag(537170146,0,15,`CalcAsyncEngine::CreateUpdatedRangesFromBlockModel no model accessor for block:${this.xta}`)}}else c.ULS.shipAssertTag(537170177,
0,!1,"CalcAsyncEngine::CreateUpdatedRangesFromBlockModel() blockCacheItem is null")}finally{ba&&ba.stop()}}T4a(ca){if(!this.Ve.na(this.currentStateId).Nj||!this.Ve.na(this.currentStateId).Nj[0])return null;var ba=this.Ve.na(this.currentStateId).Nj[0].U5;if(!ba||!ba.lb(ca.name))return null;ca=ba.na(ca.name);if(!ca||!ca.QE)return null;ba=new e.a;for(let ua of ca.QE.x$)ba.add(ua.value);return ba}NUg(ca,ba,ua){var wa=z.g(this.Jc),ia=wa.Vb(ba);ia=this.e0d(ia,null,"CopyPaste");ua=this.e0d(wa.Vb(ca),ua,
"CopyPaste");if(0>ia||0>ua||ia!==ua)c.ULS.sendTraceTag(537170143,0,15,`CalcAsyncEngine::CalculateFormulaForCopyPaste(). Revision not valid. sourceRevision:${ua}, targetRevision:${ia}.`);else{ua=[];wa=u.d(this.Jc.xa.oa);var xa=this.aid(wa);ca=L.K$("CalculateFormulaForCopyPaste.srcRange",wa,ca.top-1,ca.left-1,ca.bottom-1,ca.right-1);ba=L.K$("CalculateFormulaForCopyPaste.targetRange",wa,ba.top-1,ba.left-1,ba.bottom-1,ba.right-1);ba=excelOnlineCalc.calc.copyPasteRangePasteEdit(ba,ca,xa);ua.push(ba);ba=
xa?String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",wa,ia,xa.row,xa.column,xa.lastRow,xa.lastColumn):String.format("CalcAsyncEngine::CalculateFormulaForCopyPaste() for sheet:{0}, stateId:{1} viewport:(({2},{3})-({4},{5}))",wa,ia,"","","","");c.ULS.sendTraceTag(537170142,0,50,ba);this.ar.editRangePaste(ia,ua);this.resumeRecalc()}}aid(ca){const ba=this.a5e();let ua=null;ba?ua=L.K$("GetViewport.viewport",ca,ba.top-1,ba.left-1,ba.bottom-
1,ba.right-1):c.ULS.sendTraceTag(537170141,0,50,"CalcAsyncEngine::GetViewport() viewportRange is null, calc will use entire sheet...");return ua}a5e(){const ca=z.g(this.Jc);let ba=ca.mi;if(z.g(this.Jc).ib.tj){ba=ca.Hf(1).mi;if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5497152_JSCrash_At_CalcAsyncEngine_GetViewportRange")&&!ba)return c.ULS.sendTraceTag(537170140,0,15,"CalcAsyncEngine::GetViewportRange viewportRange is null."),null;ba.edb(1,1);ba.edb(3,1)}return ba}e0d(ca,ba,ua){let wa;if(!this.ar||
!ca)return c.ULS.sendTraceTag(537170139,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() recalc engine is null:${!this.ar}, modifiedCell is null:${!ca}, operation:${ua}`),-1;const ia=ca.cell.JQ-1,xa=ca.cell.IQ-1;if(ca.cell.$x){if(wa=ca.cell.$x.Wue,wa===d.a.Be)return c.ULS.sendTraceTag(537170138,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() BlockRevision unknown for block:${ca.cell.$x.Pd}, operation:${ua}`),-1}else return c.ULS.sendTraceTag(537170137,0,15,`CalcAsyncEngine::ValidateCalculateFormulaInit() GridBlockModelProxy is null cell:(${ca.cell.JQ},${ca.cell.IQ}), operation:${ua}`),
-1;if(wa<this.yt)return c.ULS.sendTraceTag(537170136,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${xa}) - blockRevision:${wa} < lastUpdatedStateId:${this.yt}, operation:${ua}`),-1;if(wa<this.currentStateId)return c.ULS.sendTraceTag(537170135,0,50,`CalcAsyncEngine::ValidateCalculateFormulaInit() Can't calc edit in cell:(${ia},${xa}) - blockRevision:${wa} < currentStateId:${this.currentStateId}, operation:${ua}`),-1;ba&&!this.rCd&&(this.ar.setOnRecalcResults(ba),
this.rCd=!0);return this.RPj()&&!this.hPb(2)?(c.ULS.sendTraceTag(537170134,0,15,`CalcAsyncEngine.ValidateCalculateFormulaInit: UpdateData failed. operation:${ua}`),-1):wa}getFormulaBarText(ca,ba,ua){return ba&&ba.startsWith("'")?ba:ca.cell.formulaBarText||ua.toString()}o$g(ca,ba,ua){let wa=null;if(this.txe()&&this.Ve.na(this.yt).V_a){const ia=this.Ve.na(this.yt).V_a[ca];if(null===ia||void 0===ia?0:ia.$vc)wa=ia.Iwe}ua=this.ofi(wa,ba,ua);ba=this.p1g(wa,ba,ua);c.ULS.sendTraceTag(50671754,0,50,`CalcAsyncEngine::CreateRangeUpdateCommands() completed for Block Hash:${ca} StateId:${this.currentStateId} number of formulas ${ba}`)}ofi(ca,
ba,ua){let wa=!1;const ia=L.dYe(ba);if(ca){const xa=L.dYe(ca);B.a.equals(xa,ia,!1)&&(wa=!0)}wa?this.MDg(ca,this.yt,ua):this.ODg(ba,ua);return wa}txe(){let ca=!1;this.ar&&-1!==this.yt&&(ca=this.ar.stateIdAvailable(this.yt));return ca&&this.Ve.lb(this.yt)&&this.yt<this.currentStateId}p1g(ca,ba,ua){let wa;wa=0;let ia,xa;for(ba.reset();ia=ba.getNextCell();)A.f(ia.formula)&&wa++,(xa=ua?ca.getCell(ia.row,ia.col):null)?this.l1g(ba,ia,xa):this.NDg(ba,ia);if(ua)for(ca.reset();xa=ca.getNextCell();)(ia=ba.getCell(xa.row,
xa.col))||this.nne(ca,xa);return wa}Vrj(){this.ar.setOnUpdateRequest(()=>{})}Urj(){this.ar.setOnUnresponsive((ca,ba,ua,wa)=>{this.HTi(ca,ba,ua,wa)})}HTi(ca,ba,ua,wa){c.ULS.sendTraceTag(537170126,0,15,`CalcAsyncEngine.onUnresponsive: worker thread was unresponsive. timeout:${ca}, waitTime:${ba}, timeoutCount:${ua}, hasBeenClosed:${wa}.`);wa&&(this.Igj(),this.Coa())}Igj(){this.dd(null,null);this.Dud=this.rCd=!1;this.YFd=0;this.PFd=this.RFd=this.SFd=this.QFd=-1}close(){this.ar.close()}clearCache(){this.ar.clearCache()}resumeRecalc(){this.ar.resumeRecalc()}jrj(){this.ar.setA1ReferenceStyle(!0)}s6i(){if(this.instantaneousSupportInformationManager){var ca=
this.instantaneousSupportInformationManager.Ici;const ua=this.instantaneousSupportInformationManager.Lci,wa=this.instantaneousSupportInformationManager.Kci,ia=this.instantaneousSupportInformationManager.Jci;var ba=!1;ca!==this.QFd&&(ba=!0,this.QFd=ca);ua!==this.SFd&&(ba=!0,this.SFd=ua);wa!==this.RFd&&(ba=!0,this.RFd=wa);ia!==this.PFd&&(ba=!0,this.PFd=ia);const xa=[];v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled",!1)&&(ba=excelOnlineCalc.calc.runExperiment("ExceLintExperiment",
null),xa.push(ba),ba=!0);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitExperiment",!1)&&(ba=excelOnlineCalc.calc.runExperiment("UnitExperiment",null),xa.push(ba),ba=!0);v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1)&&(ba=excelOnlineCalc.calc.runExperiment("AutocompleteExperiment",null),xa.push(ba),ba=!0);ba&&(ca=excelOnlineCalc.calc.recalcServiceConfig(null,ca,null,ua,null,null,null,wa,xa,ia),this.ar.reconfigure(ca))}}Rtj(ca){let ba=
null;if(this.Ve.lb(this.currentStateId))try{this.N$=[],ba=this.Jc.Jb.Bc("ModelUpdate",`CalcAsyncEngine::SetUpdatedRanges() StateId:${this.currentStateId} UpdateTriggerData:${J[ca]}`),f.a.forEach(this.Ve.na(this.currentStateId).V_a,(ua,wa)=>{wa.$vc||(this.o$g(ua,wa.Iwe,wa.sheetName),wa.$vc=!0)},null),this.ar.updateRanges(this.currentStateId,this.N$)}finally{ba&&ba.stop()}else c.ULS.sendTraceTag(537170122,0,15,`CalcAsyncEngine::SetUpdatedRanges StateId:${this.currentStateId} does not exist in GridCache`)}Qtj(){const ca=
[],ba=this.txe();var ua=ba&&this.Ve.na(this.yt).Nj&&this.Ve.na(this.yt).Nj[0]&&this.Ve.na(this.yt).Nj[0].Zlc?this.Ve.na(this.yt).Nj[0].U5:null;this.fCe(ua,this.Ve.na(this.currentStateId).Nj[0].U5,null,this.yt,ca);this.Ve.na(this.currentStateId).Nj[0].Zlc=!0;for(let wa=1;wa<this.Ve.na(this.currentStateId).Nj.length;wa++)ua=-1,ba&&this.Ve.na(this.yt).Nj&&(ua=this.ghd(this.Ve.na(this.currentStateId).Nj[wa].r7.sheetName,this.yt)),ua=-1!==ua&&this.Ve.na(this.yt).Nj[ua].Zlc?this.Ve.na(this.yt).Nj[ua].U5:
null,this.fCe(ua,this.Ve.na(this.currentStateId).Nj[wa].U5,this.Ve.na(this.currentStateId).Nj[wa].r7.sheetId,this.yt,ca),this.Ve.na(this.currentStateId).Nj[wa].Zlc=!0;this.ar.updateNamedObjects(this.currentStateId,ca)}fCe(ca,ba,ua,wa,ia){if(void 0!==ua&&null!==ua){var xa=excelOnlineCalc.calc.undefinedNamesWrite(ua);ia.push(xa)}if(ca){var gb=!1;xa=[];var va=[];if(ba)for(let ab of ba){const Ua=ab.value;if(ca.lb(ab.key)){var sa=ca.na(ab.key);L.IDi(sa,Ua)?gb=!0:(sa=excelOnlineCalc.calc.namedObject(ab.key,
null),xa.push(sa),L.SUc(ab.key,Ua,va))}else L.SUc(ab.key,Ua,va)}for(let ab of ca)ba&&ba.lb(ab.key)||(ca=excelOnlineCalc.calc.namedObject(ab.key,null),xa.push(ca));gb&&(ba=excelOnlineCalc.calc.namedObjectsPromote(ua,wa),ia.push(ba));0<xa.length&&(ba=excelOnlineCalc.calc.namedObjectsWrite(ua,xa),ia.push(ba));0<va.length&&(ua=excelOnlineCalc.calc.namedObjectsWrite(ua,va),ia.push(ua))}else if(ba){wa=[];for(va of ba)L.SUc(va.key,va.value,wa);0<wa.length&&(ua=excelOnlineCalc.calc.namedObjectsWrite(ua,wa),
ia.push(ua))}}QPg(){return this.Ve.na(this.currentStateId).V_a[this.xta]?(c.ULS.sendTraceTag(537170121,0,50,`CalcAsyncEngine::BlockPreviouslyHandled Block Hash:${this.xta} StateId:${this.currentStateId} previously handled`),!0):!1}IPg(ca){return 1===ca.getColumnNumbers().length&&ca.getColumnNumbers()[0]===L.Zwd+1?!1:!0}Bai(){let ca=!1;z.g(this.Jc).Ea.acd(ba=>{ba.state&1&&this.Jc.ea.Je===ba.qe.Revision&&(this.yGe(ba),ca=!0)});return ca}qEe(ca,ba){var ua=ca.getRowNumbers(),wa=ca.getColumnNumbers();
ca=ua[0]-1;ua=ua[ua.length-1]-1;const ia=wa[0]-1;wa=wa[wa.length-1]-1;ba=this.Ewb(ba);if(!ba){const xa=this.Ve.lb(this.currentStateId)&&this.Ve.na(this.currentStateId).Nj?this.Ve.na(this.currentStateId).Nj.length:0;c.ULS.sendTraceTag(537170120,0,15,`CalcAsyncEngine::CreateBlockRangeLocation SheetName not found. Number of existing sheets ${xa}`)}return L.K$("CreateBlockRangeLocation",ba,ca,ia,ua,wa)}MDg(ca,ba,ua){if(ua=this.qEe(ca,ua)){var wa=L.N4b(ca.getRowNumbers());ca=L.N4b(ca.getColumnNumbers());
ba=excelOnlineCalc.calc.rangePromote(ua,ba,wa,ca);this.N$[this.N$.length]=ba}}ODg(ca,ba){if(ba=this.qEe(ca,ba)){var ua=L.N4b(ca.getRowNumbers());ca=L.N4b(ca.getColumnNumbers());ca=excelOnlineCalc.calc.rangeWrite(ba,null,ua,ca);this.N$[this.N$.length]=ca}}l1g(ca,ba,ua){let wa=null,ia=0,xa=0;switch(ba.valueType){case 2:wa=this.Yhd(ba);var gb=this.Yhd(ua);gb=B.a.equals(gb,wa,!1);break;case 1:null===ba.value&&null===ua.value?gb=!0:(ia=parseFloat(ba.value),gb=parseFloat(ua.value)===ia);break;default:null===
ba.value&&null===ua.value?gb=!0:(xa=parseFloat(ba.value),gb=xa===parseFloat(ua.value))}gb&&ba.valueType===ua.valueType&&ba.ifmt===ua.ifmt&&ba.formulaType===ua.formulaType&&B.a.equals(ua.formula,ba.formula,!1)||(void 0!==ba.formula&&null!==ba.formula||void 0!==ba.value&&null!==ba.value||void 0!==ba.text&&null!==ba.text?this.uZb(ca,ba,wa,ia,xa):this.nne(ca,ba))}hDg(ca){if(this.Jc.Ab&&this.Jc.Ab.items)for(let xa=0;xa<this.Jc.Ab.count;xa++){var ba=this.Jc.Ab.items[xa];if(2!==ba.type&&3!==ba.type)continue;
var ua=0,wa=ba.name,ia=wa.lastIndexOf("!");if(0<ia){ua=wa.substr(0,ia);"'"===ua.charAt(0)&&(ua=ua.substr(1,ua.length-2));ua=this.ghd(ua,this.currentStateId);if(-1===ua){ba=this.Ve.lb(this.currentStateId)&&this.Ve.na(this.currentStateId).Nj?this.Ve.na(this.currentStateId).Nj.length:0;c.ULS.sendTraceTag(595096334,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ba}`);continue}wa=wa.substr(ia+1)}ua=this.Ve.na(this.currentStateId).Nj[ua].U5;let gb=ba.usedRange;
2===ba.type&&(gb=w.a(ba));if(ua.lb(wa)){if(ia=ua.na(wa),ia.range=gb,ia.attributes=ba.attributes,2===ia.type&&(wa=L.hUe(ba.name,ca),ba=(ua=v.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc"))?ba.AO:null===wa||void 0===wa?void 0:wa.ColHeadersList,wa||ua))if(!ia.QE)ia.QE=new r(ba);else if(ba)for(const va of ba.HeadersList)ia.QE.x$.ia(va.Index,va.Name)}else if(ia=this.Ewb(ba.sheetName)){ia=new F(ba.type,ba.name,gb,ia,ba.attributes);if(2===ia.type)if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6053425_loadHeadersForAllTablesCalc")&&
ba.AO)ia.QE=new r(ba.AO);else if(ba=L.hUe(ba.name,ca))ia.QE=new r(ba.ColHeadersList);ua.ia(wa,ia)}else ba=this.Ve.lb(this.currentStateId)&&this.Ve.na(this.currentStateId).Nj?this.Ve.na(this.currentStateId).Nj.length:0,c.ULS.sendTraceTag(537170117,0,50,`CalcAsyncEngine::AddNamedObjectsInBlock SheetName not found. Number of existing sheets ${ba}`)}}uZb(ca,ba,ua,wa,ia){var xa=ca.getRowNumbers()[ba.row]-1;ca=ca.getColumnNumbers()[ba.col]-1;xa=L.K$("AddRangeUpdateCommand",this.$rb,xa,ca,xa,ca);ca=null;
let gb=ba.formula||ba.text;const va=excelOnlineCalc.calc.blankValue;let sa=null;void 0!==ba.text&&null!==ba.text||void 0!==ba.value&&null!==ba.value||(ua="",sa="This cell contains blanks only",0===ba.formulaType&&(gb=""));switch(ba.valueType){case 2:null!==ua&&(0===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(gb,ua,ba.ifmt,sa)),1===ba.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(gb,ua,ba.ifmt,sa)),2===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",va,0,"This cell is a part of an array")));
break;case 1:isNaN(wa)?c.ULS.sendTraceTag(537170116,0,50,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ba.row},${ba.col}) invalid numeric value`):(0===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(gb,wa,ba.ifmt,null)),1===ba.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(gb,wa,ba.ifmt,null)),2===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",va,0,"This cell is a part of an array")));break;case 3:isNaN(ia)?c.ULS.sendTraceTag(537170115,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ba.row},${ba.col}) invalid boolean value`):
(ua=1===ia?!0:!1,0===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(gb,ua,ba.ifmt,null)),1===ba.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(gb,ua,ba.ifmt,null)),2===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",va,0,"This cell is a part of an array")));break;case 4:isNaN(ia)?c.ULS.sendTraceTag(537170114,0,15,`CalcAsyncEngine::AddRangeUpdateCommand Cell(${ba.row},${ba.col}) invalid error value`):(ua=excelOnlineCalc.calc.errorValue(ia),0===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData(gb,
ua,ba.ifmt,null)),1===ba.formulaType&&(ca=excelOnlineCalc.calc.cellFormulaCellData(gb,ua,ba.ifmt,null)),2===ba.formulaType&&(ca=excelOnlineCalc.calc.valueCellData("",va,0,"This cell is a part of an array")));break;default:ca=excelOnlineCalc.calc.valueCellData("",va,ba.ifmt,null)}ca&&(ba=excelOnlineCalc.calc.rangeWrite(xa,ca,null,null),this.N$[this.N$.length]=ba)}NDg(ca,ba){switch(ba.valueType){case 2:this.uZb(ca,ba,this.Yhd(ba),null,0);break;case 1:this.uZb(ca,ba,null,parseFloat(ba.value),0);break;
default:this.uZb(ca,ba,null,null,parseFloat(ba.value))}}nne(ca,ba){var ua=ca.getRowNumbers()[ba.row]-1;ca=ca.getColumnNumbers()[ba.col]-1;ua=L.K$("AddRangeUpdateCommandEmptyCell",this.$rb,ua,ca,ua,ca);ba=excelOnlineCalc.calc.valueCellData("",excelOnlineCalc.calc.blankValue,ba.ifmt,null);ba=excelOnlineCalc.calc.rangeWrite(ua,ba,null,null);this.N$[this.N$.length]=ba}Ewb(ca){ca=this.ghd(ca,this.currentStateId);return 0<ca?this.Ve.na(this.currentStateId).Nj[ca].r7.sheetId:null}ghd(ca,ba){if(!this.Ve.lb(ba))return c.ULS.sendTraceTag(537170113,
0,15,`CalcAsyncEngine.GetSheetInternalIndex StateId:${ba} does not exist in GridCache`),-1;const ua=this.Ve.na(ba);return ua.Nj?ua.getSheetIndex(ca):(c.ULS.sendTraceTag(537170112,0,15,`CalcAsyncEngine.GetSheetInternalIndex sheetsInformation == null for StateId:${ba}`),-1)}otj(){if(!this.Ve.lb(this.currentStateId)||!this.Ve.na(this.currentStateId).Nj.length)return c.ULS.sendTraceTag(537170083,0,15,`CalcAsyncEngine::SetSheetNamesAndUsedRanges() No sheets information for StateId:${this.currentStateId} or StateId does not exist in GridCache`),
!1;const ca=[];for(let ba=1;ba<this.Ve.na(this.currentStateId).Nj.length;ba++){const ua=this.Ve.na(this.currentStateId).Nj[ba];ua&&ca.push(ua.r7)}this.ar.updateSheetNames(this.currentStateId,ca);this.ar.updateUnusedCells(this.currentStateId,this.Ve.na(this.currentStateId).ydg);return!0}setNumberFormats(){if(this.instantaneousSupportInformationManager){var ca=[];for(const ba of this.instantaneousSupportInformationManager.Dya){const ua=excelOnlineCalc.calc.numberFormat(ba.IfmtIndex,ba.FormatString,
ba.Builtin);ca.push(ua)}this.ar.setNumberFormats(ca,!0)}}Kpj(){if(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Ge){var ca=this.Fai();if(!this.Dud||ca)this.M4b(),this.instantaneousSupportInformationManager.Ge.TrueValueString&&(this.trueName=this.instantaneousSupportInformationManager.Ge.TrueValueString),this.instantaneousSupportInformationManager.Ge.FalseValueString&&(this.falseName=this.instantaneousSupportInformationManager.Ge.FalseValueString),ca=D.CalcHelper.oFe(this.instantaneousSupportInformationManager,
ca),this.ar.setLocale(ca),this.Dud=!0}}buj(){var ca=null;if(void 0!==this.Jc.workbookContext.TimeZoneInformation&&null!==this.Jc.workbookContext.TimeZoneInformation){ca=null;this.Jc.workbookContext.TimeZoneInformation.StandardDate.Month&&(ca=excelOnlineCalc.date.dateTime(this.Jc.workbookContext.TimeZoneInformation.StandardDate.Year,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Month,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Day,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Hour,
this.Jc.workbookContext.TimeZoneInformation.StandardDate.Minute,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Second,this.Jc.workbookContext.TimeZoneInformation.StandardDate.DayOfWeek+1,this.Jc.workbookContext.TimeZoneInformation.StandardDate.Milliseconds,3));let ba=null;this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Month&&(ba=excelOnlineCalc.date.dateTime(this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Year,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Month,
this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Day,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Hour,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Minute,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Second,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.DayOfWeek+1,this.Jc.workbookContext.TimeZoneInformation.DaylightDate.Milliseconds,3));ca=excelOnlineCalc.date.tzData(this.Jc.workbookContext.TimeZoneInformation.Bias,ca,this.Jc.workbookContext.TimeZoneInformation.StandardBias,
ba,this.Jc.workbookContext.TimeZoneInformation.DaylightBias)}else c.ULS.sendTraceTag(537170082,0,15,"CalcAsyncEngine.SetWorkbookProperties: TimeZoneInformation is null");ca=excelOnlineCalc.calc.workbookProps(this.Jc.workbookContext.F1904,this.Jc.workbookContext.FDateCompatibility,ca);this.ar.setWorkbookProps(ca)}Coa(){v.EwaSettings.ma(305)&&m.c(excelOnlineCalc.worker.runSmokeTest(1/0,this.B6f,!0)).continueWith(wa=>{wa.exception?c.ULS.sendTraceTag(537170079,0,15,`CalcAsyncEngine.TryInitialize: calc smoke test failed: ${wa.exception.toString()}`):
c.ULS.sendTraceTag(537170080,0,50,"CalcAsyncEngine.TryInitialize: calc smoke test ended - a new one should start")});const ca=v.EwaSettings.ma(650)?t.local:t.$Ij,[ba,ua]=y.a.jV()?[excelOnlineCalc.x10.PluginSchedulerSingleton.instance(),excelOnlineCalc.x10.GridImportManagerSingleton.instance()]:[void 0,void 0];this.hId=m.c(excelOnlineCalc.calc.createRecalcService(ca,ba,ua));this.hId.continueWith(wa=>{wa.exception?c.ULS.sendTraceTag(537170075,0,50,`CalcAsyncEngine.TryInitialize: Calc web worker failed: ${wa.exception.toString()}`):
(c.ULS.sendTraceTag(537170078,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker is working as expected"),(this.ar=this.hId.result)?this.hPb(0)?this.Urj():c.ULS.sendTraceTag(537170077,0,15,"CalcAsyncEngine.TryInitialize: UpdateData failed to initialize"):c.ULS.sendTraceTag(537170076,0,50,"CalcAsyncEngine.TryInitialize: Calc web worker result is null"))})}Fai(){const ca=this.instantaneousSupportInformationManager.kja;if(!ca||this.YFd===ca.length)return null;this.YFd=ca.length;return D.CalcHelper.ZEe(ca)}M4b(){this.errorTypeNames=
D.CalcHelper.M4b()}Hai(){if(!(this.Ve.lb(this.currentStateId)&&0<this.Ve.na(this.currentStateId).Nj.length)){this.Ve.ia(this.currentStateId,new U(this.$od));this.Ve.na(this.currentStateId).s1f(0,new G(null));var ca=this.Jc.xa;for(let wa=0;wa<ca.count;wa++){var ba=Object(k.a)(x.a,ca.getItem(wa));if(ba){void 0!==ba.sheetId&&null!==ba.sheetId&&void 0!==ba.name&&null!==ba.name&&ba.sheetId.length&&ba.sheetName.length||c.ULS.sendTraceTag(537170074,0,15,`CalcAsyncEngine::InitializeGridForStateId() invalid sheet - index:${wa} Id:${ba.sheetId} Hash:${ba.hash} NameLength:${ba.name?
ba.name.length:-1}`);var ua=void 0;ua=excelOnlineCalc.calc.sheetName(ba.sheetId,ba.name);this.Ve.na(this.currentStateId).s1f(wa+1,new G(ua));ua=ba.usedRange.nS();ua=excelOnlineCalc.calc.rangeLocation(0,0,ua.LastRow,ua.LastColumn);ba=excelOnlineCalc.calc.unusedCellsUpdate(ba.sheetId,ua);this.Ve.na(this.currentStateId).ydg.push(ba)}else c.ULS.sendTraceTag(537170073,0,15,`CalcAsyncEngine.InitializeGridForStateId(): not sheet item for StateId:${this.currentStateId} sheet-index:${wa}`)}}}RYg(){for(let ca of this.Ve)ca.key<
this.yt&&this.Ve.remove(ca.key)}Yhd(ca){ca=ca.value||ca.text;if(void 0===ca||null===ca)ca="";return ca}RPj(){if(!this.Ve.lb(this.currentStateId))return!1;let ca=!1;f.a.forEach(this.Ve.na(this.currentStateId).V_a,(ba,ua)=>{ua.$vc||(ca=!0)},null);return ca}p4c(ca){const ba={};ba.reason=ca;ba.kind=1;return ba}phc(){return this.Ve.lb(this.currentStateId)&&this.Ve.na(this.currentStateId).Nj&&this.Ve.na(this.currentStateId).Nj[0]&&this.Ve.na(this.currentStateId).Nj[0].U5?!0:!1}static s6g(ca){const ba=[];
if(null===ca||void 0===ca?0:ca.x$)for(let ua of ca.x$)ca=excelOnlineCalc.calc.columnData(ua.key,ua.value),ba.push(ca);return ba}static IDi(ca,ba){if(ca.type!==ba.type||ca.attributes!==ba.attributes||!B.a.equals(ca.fullName,ba.fullName,!1)||!ca.range.equals(ba.range))return!1;if(!ca.QE&&!ba.QE)return!0;if(!ca.QE||!ba.QE||ca.QE.x$.count!==ba.QE.x$.count)return!1;for(let ua of ca.QE.x$){let wa;if(!(ua.value&&({value:wa}=ba.QE.x$.Cc(ua.key)).returnValue&&wa&&B.a.equals(ua.value,wa,!1)))return!1}return!0}static SUc(ca,
ba,ua){var wa=L.K$("NamedObject",ba.sheetId,ba.range.top-1,ba.range.left-1,ba.range.bottom-1,ba.range.right-1);if(2===ba.type){const ia=!!(ba.attributes&16),xa=!!(ba.attributes&8);ba=L.s6g(ba.QE);wa=excelOnlineCalc.calc.namedTableData(wa,ia,xa,ba);ca=excelOnlineCalc.calc.namedObject(ca,wa)}else wa=excelOnlineCalc.calc.namedRangeData(wa),ca=excelOnlineCalc.calc.namedObject(ca,wa);ua.push(ca)}static dYe(ca){const ba=Sys.Serialization.JavaScriptSerializer.serialize(ca.getRowNumbers());ca=Sys.Serialization.JavaScriptSerializer.serialize(ca.getColumnNumbers());
return ba+ca}static N4b(ca){let ba=null;if(1<ca.length)for(let ua=1;ua<ca.length;ua++){let wa=0;for(;ca[ua-1]+1+wa<ca[ua];)ba=ba||[],ba.push(ca[ua-1]+wa),wa++}return ba}static hUe(ca,ba){if(!ba)return null;for(let ua=0,wa=ba.length;ua<wa;++ua)if(B.a.equals(ca,ba[ua].Name,!1))return ba[ua];return null}static K$(ca,ba,ua,wa,ia,xa){const gb=(va,sa,ab,Ua)=>{(0>ab||ab>=Ua)&&c.ULS.sendTraceTag(537170072,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${va} invalid ${sa}:${ab}`)};void 0!==ba&&
null!==ba||c.ULS.sendTraceTag(537170071,0,15,`CalcAsyncEngine::CreateSheetRangeLocation() callerId:${ca} sheetId is null`);gb(ca,"top",ua,L.erf);gb(ca,"left",wa,L.Zwd);gb(ca,"bottom",ia,L.erf);gb(ca,"right",xa,L.Zwd);return excelOnlineCalc.calc.sheetRangeLocation(ba,ua,wa,ia,xa)}}L.erf=1048576;L.Zwd=16384;Object(n.a)(L,"CalcAsyncEngine",null,[10]);class H{constructor(){this.qK=this.rK=this.CF=this.DF=this.SZ=!1}}Object(n.a)(H,"AbsoluteRelativeReferenceInfo",null,[]);var R=a(980),Q=a(24);class O{}
O.mJf="#";Object(n.a)(O,"Operators",null,[]);var V=a(981);class W{}W.sheet="Sheet";W.sheetRange="SheetRange";W.document="Document";W.o8h="Ident";Object(n.a)(W,"TraverseFormulaQualifierTypes",null,[]);var da=a(982),ta=a(873),K=a(789),na=a(43),P=a(55),ka=a(64),pa=a(458),Na=a(38);class Z extends Sys.EventArgs{constructor(ca){super();this.Jk=ca}}Object(n.a)(Z,"EditedCellRecalcCompleteEventArgs",Sys.EventArgs,[]);class Ra extends Na.a{constructor(ca){super();this.$t=null;this.Nhg=!1;this.CMd=this.instantaneousSupportInformationManager=
this.sGb=null;this.Izd=new Map;this.qde=null;this.foc=ba=>{c.ULS.sendTraceTag(537170005,0,50,"CalcManager.OnLocaleInformationAvailable() called");ba.xKd(this.foc);ba.kja.length?this.Mnc(ba,Sys.EventArgs.Empty):(c.ULS.sendTraceTag(537170004,0,50,"CalcManager.OnLocaleInformationAvailable() - waiting for functions information"),ba.Aoe(this.Mnc))};this.Mnc=ba=>{c.ULS.sendTraceTag(537170003,0,50,"CalcManager.OnFunctionsInfoReady called");ba.oKd(this.Mnc);this.CNj(ba)};this.onContentReady=()=>{this.$t&&
(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Kmd||P.Task.delay(0).continueWith(()=>{this.$t.hPb(1)},0,null,ka.a.current))};this.Wvf=(ba,ua)=>{this.$t&&(this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Kmd||this.$t.yGe(ua.hd.block))};c.ULS.sendTraceTag(537170067,0,50,"Creating CalcManager");this.Ufc=!1;this.jb=ca;this.rq=z.g(ca);this.nGc=null;this.gridView.Uu(this.onContentReady);this.gridView.Ea.qVc(this.Wvf);this.$.da.Za(268,
ba=>{ba.Ge?(c.ULS.sendTraceTag(537170066,0,50,"CalcManager.ctor: LocaleInformation already available..."),this.foc(ba,Sys.EventArgs.Empty)):(c.ULS.sendTraceTag(537170065,0,50,"CalcManager.ctor: waiting for LocaleInformation..."),ba.Voe(this.foc))})}bGg(ca){this.addHandler(Ra.o8c,ca)}obj(ca){this.removeHandler(Ra.o8c,ca)}Rtf(ca){this.raiseEvent(Ra.o8c,new Z(ca))}get Tr(){return this.nGc}get gridView(){return this.rq}get $(){return this.jb}get tD(){return this.qde}get localeInfo(){return this.Tr?this.Tr.config.localeInfo:
null}get config(){return this.Tr.config}dispose(){c.ULS.sendTraceTag(537170064,0,50,"CalcManager.Dispose called");this.$.da.Za(268,ca=>{ca.xKd(this.foc);ca.oKd(this.Mnc)});this.gridView&&(this.gridView.xy(this.onContentReady),this.gridView.Ea&&this.gridView.Ea.mRf(this.Wvf),this.rq=null);this.nGc=null;v.EwaSettings.isChangeGateEnabled("OfficeVSO:7108565_CalcNotInitializedAfterDisposed")&&(this.Ufc=!1)}OUg(ca,ba,ua,wa=null){return this.$t?this.$t.MUg(ca,ba,ua,wa):!1}evalFormula(ca,ba,ua,wa){return this.$t?
this.$t.evalFormula(ca,ba,ua,wa):Promise.reject("calc engine not initialized")}Ctb(ca,ba,ua,wa){return this.$t?this.$t.Ctb(ca,ba,ua,wa):Promise.reject("CalcEngine is null")}T4a(ca){return this.$t?(c.ULS.shipAssertTag(537170059,0,2===ca.type,"CalcManager.GetTableHeaders() - ActiveItem is not a table"),this.$t.T4a(ca)):null}mKg(ca,ba){if(!ba||2!==ca.type)return!1;ca=w.a(ca);return ca.right-ca.left+1===ba.count}TSe(ca){if(!this.sGb)return this.Nhg||c.ULS.sendTraceTag(537170057,0,15,"CalcManager.ExtractReferenceWrappers - parser not initialized"),
null;var ba=this.lta(Q.Range.Uc(1,1));ba=this.sGb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ba.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ba))return c.ULS.sendTraceTag(537170056,0,10,"CalcManager.ExtractReferenceWrappers - ParseFormula failed"),null;try{let ua;if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:6518739_FlightRemovalStructuredReferencesHighlighting")){const wa=this.gridView.ha.sa.activeCell,ia=excelOnlineCalc.location.gridCell(wa.top-1,wa.left-1),xa=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),gb=excelOnlineCalc.location.sheetIndex(xa,this.$.xa.oa.sheetId),va=this.K$g(ia,gb);this.CMd||(this.CMd=excelOnlineCalc.util.createResolver(this.J$g()));ua=excelOnlineCalc.parse.parseResultHelper.extractReferences(ba,this.Tr.config.localeInfo,v.EwaSettings.ma(587),va,this.CMd)}else ua=excelOnlineCalc.parse.parseResultHelper.extractReferences(ba,this.Tr.config.localeInfo,v.EwaSettings.ma(587));v.EwaSettings.ma(102)&&this.gTj(ua,ca);return ua}catch(ua){return c.ULS.sendTraceTag(537170055,
0,10,`CalcManager.ExtractReferenceWrappers - exception: ${ua.message}`),null}}extractLetVariables(ca,ba){if(!this.sGb)return this.Nhg||c.ULS.sendTraceTag(537170054,0,15,"CalcManager.ExtractLetVariables - parser not initialized"),null;const ua=this.lta(Q.Range.Uc(1,1));ca=this.sGb.parseFormula(excelOnlineCalc.parse.parseLocals(1,ua.range),ca);if(!excelOnlineCalc.parse.parseResultHelper.isSuccess(ca))return c.ULS.sendTraceTag(537170053,0,10,"CalcManager.ExtractLetVariables - ParseFormula failed"),null;
try{return excelOnlineCalc.parse.parseResultHelper.extractLetVariables(ca,ba,this.Tr.config.localeInfo)}catch(wa){return c.ULS.sendTraceTag(537170052,0,10,`CalcManager.ExtractLetVariables - exception: ${wa.message}`),null}}extractReferences(ca,ba,ua,wa){if(!ba)return c.ULS.sendTraceTag(537170051,0,10,"CalcManager.ExtractReferences - sheetName is null"),null;if(!ua)return c.ULS.sendTraceTag(537170050,0,10,"CalcManager.ExtractReferences - documentName is null"),null;const ia=this.TSe(ca);if(!ia)return c.ULS.sendTraceTag(537170049,
0,15,"CalcManager.ExtractReferences - ExtractReferenceWrappers returned null"),null;try{return this.H9g(ia,ba,ua,ca,wa)}catch(xa){return c.ULS.sendTraceTag(537170048,0,10,`CalcManager.ExtractReferences - exception: ${xa.message}`),null}}NYh(ca,ba,ua,wa){if(!ca)return c.ULS.sendTraceTag(537170019,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - range is null"),null;if(!ba||0>=ba.length)return c.ULS.sendTraceTag(537170018,0,10,"CalcManager.GetSubExpressionSpanForContextualFormulaPreview - formula is null/empty"),
null;ca=this.lta(ca);if(!this.Tr||!ca)return null;const ia=this.pvb(ca).returnValue;if(!ia||ia.B6a)return null;ua=excelOnline.utils.getCharIndexInTextFromPoint(ua,wa,v.EwaSettings.ma(587));return 0>ua?null:excelOnlineCalc.runtime.getSubExpressionFromFormulaCharacterIndex(this.Tr.config,ua,ba,ca)}CUg(ca,ba,ua,wa){if(!ca)return c.ULS.sendTraceTag(537170017,0,10,"CalcManager.CalcPartialResultsForFormula - range is null"),null;let ia=null;return this.evalFormula(ba,ca,void 0,excelOnlineCalc.calc.evalFormulaFormatOrigin()).then(xa=>
{let gb;const va=({kind:gb}=this.Tr.pnh(xa,ua)).returnValue;8!==gb||va.length&&va!==D.CalcHelper.unknownError?xa=0:(c.ULS.sendTraceTag(537170016,0,50,"EvalSession.GetPartialResultValueForFormula - EvalResultToString error"),xa=excelOnlineCalc.calc.getEvalFailureReason(xa),void 0!==xa&&null!==xa||c.ULS.shipAssertTag(537170015,0,!1,"CalcHelper.GetEvalFailureReason() - result is not a failure, function should not be called"),xa=1);return ia=wa?new R.a(va,wa.start,wa.end,xa):new R.a(va,-1,-1,xa)},xa=>
{c.ULS.sendTraceTag(537170014,0,10,`EvalSession.GetPartialResultValueForFormula - exception: ${xa}`);return Promise.resolve(ia)})}getSubExpressionSpan(ca){return this.Tr&&ca?excelOnlineCalc.runtime.getSubExpressionSpan(ca):null}getFormulaSubExpressionObject(ca,ba,ua){return this.Tr&&ca&&ba&&ua?excelOnlineCalc.runtime.getFormulaSubExpressionObject(this.Tr.config,ba,ua,this.lta(ca)):null}QYh(ca,ba,ua){return this.Tr&&ca&&ba?excelOnlineCalc.runtime.getSubstitutedSubExpressionString(this.Tr.config,ba,
ua,this.lta(ca)):null}OYh(ca,ba,ua){return this.Tr&&ca&&ba?excelOnlineCalc.runtime.getSubExpressionSubspans(this.Tr.config.localeInfo,ba,ua):null}cSh(){return this.Tr?this.Tr.config.localeInfo.listSeparator:null}isFormulaSubExpressionVolatile(ca){return this.Tr?excelOnlineCalc.runtime.isFormulaSubExpressionVolatile(this.Tr.config.localeInfo,ca):!1}lta(ca,ba=!0){return ca&&this.Tr?this.Tr.hah(this.Tr.Ybh(),ca.top-1,ca.left-1,ba):null}qii(ca,ba){ca=this.Lbc(ca);if(void 0===ca||null===ca)return null;
ca=this.tD.createFormat(ca.FormatString,ca.Builtin);if(!excelOnlineCalc.util.isSuccess(ca))return null;ba=this.tD.parseEdit(ba,ca.value);return excelOnlineCalc.util.isSuccess(ba)?ba.value.kind===ta.a.formula:null}Jbc(ca){if(null==this.tD)return Object(pa.a)("Number formatter is null");if(null==this.instantaneousSupportInformationManager)return Object(pa.a)("Instantaneous manager is null");if(this.Izd.has(ca))return Object(pa.d)(this.Izd.get(ca));if("number"===typeof ca){var ba=this.Lbc(ca);if(null==
ba)return Object(pa.a)(`Invalid ifmt=${ca}`);var ua=ba.FormatString;ba=ba.Builtin}else ua=ca,ba=!1;ua=this.tD.createFormat(ua,ba);return excelOnlineCalc.util.isSuccess(ua)?(this.Izd.set(ca,ua.value),Object(pa.d)(ua.value)):Object(pa.a)("Could not create number format")}getWorksheetFuncId(ca){return this.localeInfo.getWorksheetFuncId(ca)}H9g(ca,ba,ua,wa,ia){const xa={Items:[]};for(let ab=0;ab<ca.length;ab++){var gb=ca[ab];const Ua={};Ua.Start=gb.span.start;Ua.End=gb.span.end;if(ia||gb.kind!==V.a.func)if(ia||
gb.kind!==V.a.Vsi){if(!this.Jih(gb,ba,ua))continue;var va=new H;const nb=this.OVh(gb,ba,va,wa);if(v.EwaSettings.ma(587)){var sa=this.URh(gb);const Ha=this.TRh(gb);if(nb||Ha&&0<=sa){let sb={};sb.Span=Ua;sb.LetNumber=sa;sb.LetName=Ha;sb.Range=nb;sb.IsRangeRef=va.SZ;sb.IsAbsoluteFirstRow=va.DF;sb.IsAbsoluteFirstColumn=va.CF;sb.IsAbsoluteSecondRow=va.rK;sb.IsAbsoluteSecondColumn=va.qK;sb.IsStructRef=gb.kind===V.a.EVd;xa.Items.push(sb)}}else nb&&(sa={},sa.Span=Ua,sa.Range=nb,sa.IsRangeRef=va.SZ,sa.IsAbsoluteFirstRow=
va.DF,sa.IsAbsoluteFirstColumn=va.CF,sa.IsAbsoluteSecondRow=va.rK,sa.IsAbsoluteSecondColumn=va.qK,sa.IsStructRef=gb.kind===V.a.EVd,xa.Items.push(sa))}else gb=gb.ref.value.oper.kind,va={},va.Span=Ua,va.IsString=2===gb,va.IsBoolean=4===gb,va.IsNumber=1===gb,xa.Items.push(va);else Ua.End=gb.span.start+gb.ref.name.length,gb={},gb.Span=Ua,gb.IsFunction=!0,gb.FunctionId=this.getWorksheetFuncId(wa.substring(Ua.Start,Ua.End)),xa.Items.push(gb)}xa.Items.sort((ab,Ua)=>ab.Span.Start-Ua.Span.Start);return xa}URh(ca){return ca.kind===
V.a.Plf?ca.ref.number:-1}TRh(ca){return ca.kind===V.a.Plf?ca.ref.name:null}OVh(ca,ba,ua,wa){if(ca.kind===V.a.range)return ua.SZ=!0,this.oDe(ca,ba,ua,wa);if(ca.kind===V.a.namedRange){ua=ca.ref;(ca=this.$.Ab.getItemByName(ua.name))||(ca=this.$.Ab.getItemByName(ba+"!"+ua.name));if(!(ca&&ca.sheetName&&ca.usedRange&&B.a.equals(ca.sheetName,ba,!0)))return null;ba=2===ca.type?w.a(ca):ca.usedRange;return na.m(ba,ca)}if(ca.kind===V.a.EVd){let ia=ca.ref,xa;ia.name?(xa=this.$.Ab.getItemByName(ia.name))||(xa=
this.$.Ab.getItemByName(ba+"!"+ia.name)):xa=this.gridView.Fb.hk(this.gridView.ha.sa.activeCell);if(!(xa&&xa.sheetName&&xa.usedRange&&B.a.equals(xa.sheetName,ba,!0)))return null;ua.SZ=!1;return this.oDe(ca,ba,ua,wa)}return null}oDe(ca,ba,ua,wa){ca=ca.ref;if(ca.type){if(ca.type===da.a.column){var ia=ca.startIndex;ca=ca.endIndex;ua.CF=ia.kind===K.a.abs;ua.qK=ca.kind===K.a.abs;return this.createRange(0,ia.index,d.a.eh,ca.index,ba)}if(ca.type===da.a.row)return ia=ca.endIndex,ua.DF=ca.startIndex.kind===
K.a.abs,ua.rK=ia.kind===K.a.abs,this.createRange(ca.startIndex.index,0,ca.endIndex.index,d.a.ph,ba);if(ca.type===da.a.cell){ia=ca.row;var xa=ca.col;ua.DF=ua.rK=ia.kind===K.a.abs;ua.CF=ua.qK=xa.kind===K.a.abs;return this.m2b(ca.span.end,wa)&&(ua=Q.Range.Uc(ia.index+1,xa.index+1),ua=this.gridView.Fb.R3e(ua))?na.n(ua,ba):this.createRange(ia.index,xa.index,ia.index,xa.index,ba)}if(ca.type===da.a.range){ia=ca.top;xa=ca.left;wa=ca.bottom;ca=ca.right;const gb=Math.min(ia.index,wa.index),va=Math.min(xa.index,
ca.index),sa=Math.max(ia.index,wa.index),ab=Math.max(xa.index,ca.index);ua.DF=ia.kind===K.a.abs;ua.rK=wa.kind===K.a.abs;ua.CF=xa.kind===K.a.abs;ua.qK=ca.kind===K.a.abs;return this.createRange(gb,va,sa,ab,ba)}c.ULS.sendTraceTag(537170010,0,10,`CalcManager.CovertFormulaRefToRange: Unsupported formula ref type '${ca.type}'`);return null}c.ULS.sendTraceTag(537170011,0,15,"CalcManager.CovertFormulaRefToRange: traverseFormulaRef.Type is null");return null}m2b(ca,ba){return ba.length>=ca&&0<ca&&ba.charAt(ca-
1)===O.mJf}JUg(ca,ba,ua){this.$t&&this.$t.NUg(ca,ba,ua)}Lbc(ca){return this.instantaneousSupportInformationManager&&this.instantaneousSupportInformationManager.Dya&&this.instantaneousSupportInformationManager.Dya[ca]&&this.tD?this.instantaneousSupportInformationManager.Dya[ca]:null}toXLNumber(ca){if(!this.tD)return null;ca=excelOnlineCalc.numfmt.toXLNumber(this.config.mathpack,this.tD,ca);return excelOnlineCalc.util.isSuccess(ca)?ca.value:null}gTj(ca,ba){if(ca)for(const ua of ca)ua.ref.type&&ua.ref.type===
da.a.cell&&(ca=ua.ref,Ra.l_i(ca,ba)&&(ca.span.end+=1,ua.span.end+=1))}createRange(ca,ba,ua,wa,ia){const xa={};xa.FirstRow=ca;xa.FirstColumn=ba;xa.LastRow=ua;xa.LastColumn=wa;xa.SheetName=ia;return xa}Jih(ca,ba,ua){var wa=ca.ref.qualifier;if(!wa)return!0;switch(ca.ref.qualifier.type){case W.sheet:return ca=wa.document,B.a.equals(wa.sheet,ba,!0)&&(!ca||B.a.equals(ca.document,ua,!0));case W.sheetRange:return ba=this.$.xa.getItemByName(ba),ua=this.$.xa.getItemByName(wa.sheet1),wa=this.$.xa.getItemByName(wa.sheet2),
!!ba&&!!ua&&!!wa&&(ua.index<=ba.index&&ba.index<=wa.index||wa.index<=ba.index&&ba.index<=ua.index);case W.document:return B.a.equals(wa.document,ua,!0);case W.o8h:return wa=wa.name,B.a.equals(wa,ba,!0)||B.a.equals(wa,ua,!0);default:return c.ULS.sendTraceTag(537170009,0,10,`CalcManager.GetQualifierData: Unsupported formula qualifier type '${wa.type}'`),!1}}CNj(ca){this.instantaneousSupportInformationManager=ca;ca.Dya.length&&ca.kja.length?(this.nGc=new D.CalcHelper(this.gridView.$),this.sGb=this.Tr.createParser(),
this.qde=this.Tr.createNumberFormatter(),this.Ufc=!0,c.ULS.sendTraceTag(537170007,0,50,"CalcManager.TryInitializeInternal: calc initialized"),this.$t||(c.ULS.sendTraceTag(537170006,0,50,"CalcManager creating calc engine"),this.$t=new L(this.$))):c.ULS.sendTraceTag(537170008,0,15,`CalcManager.TryInitializeInternal: IInstantaneousSupportInformationManager locale information missing, cannot initialize calc. number formats count = ${ca.Dya.length}, functions info count = ${ca.kja.length}`)}pvb(ca){if(!ca)return{returnValue:null,
emptyCell:!1};var ba=this.getSheetName(ca.sheet.index);if(!ba)return c.ULS.sendTraceTag(537169998,0,50,`CalcManager.GetCellFromBlockCache: No sheet index ${ca.sheet.index}`),{returnValue:null,emptyCell:!1};const ua=Ra.convertToRange(ca);ba=this.gridView.pvb(ba,ua.top,ua.left);return ba?ba.Dih?{returnValue:ba,emptyCell:!1}:(c.ULS.sendTraceTag(537169996,0,50,`CalcManager.GetCellFromBlockCache: cell ${ca.range.row} ${ca.range.col} is empty`),{returnValue:null,emptyCell:!0}):(c.ULS.sendTraceTag(537169997,
0,50,`CalcManager.GetCellFromBlockCache: cellProxy is null for cell ${ca.range.row} ${ca.range.col}`),{returnValue:null,emptyCell:!1})}getSheetName(ca){const ba=this.gridView.$.xa.getItem(ca);return ba?ba.sheetName:(c.ULS.sendTraceTag(537169995,0,50,`CalcManager.GetSheetName - no sheet in index ${ca}`),null)}K$g(ca,ba){const ua={allowUnqualifiedCell:!0,wrapCellReferences:!0};ua.config=this.Tr.config;ua.originGridCell=excelOnlineCalc.util.success(ca);ua.originSheet=excelOnlineCalc.util.success(ba);
return ua}J$g(){const ca={};ca.config=this.Tr.config;ca.getNameLoc=this.$t.getNameLoc;ca.getContainingTable=this.$t.getContainingTable;ca.getStructRefColumn=this.$t.getStructRefColumn;ca.getStructRefSpecialRef=this.$t.getStructRefSpecialRef;ca.getDocumentLoc=this.$t.getDocumentLoc;ca.getSheetIndex=this.$t.getSheetIndex;ca.getSheetName=this.$t.getSheetName;ca.getUserDefinedFuncLoc=this.$t.getUserDefinedFuncLoc;ca.getSheetRangeIndexes=this.$t.getSheetRangeIndexes;return ca}static l_i(ca,ba){return ba.length>
ca.span.end&&ba.charAt(ca.span.end)===O.mJf}static convertToRange(ca){return Q.Range.Uc(ca.range.row+1,ca.range.col+1)}}Ra.o8c="ECRC";Object(n.a)(Ra,"CalcManager",Na.a,[525,10]);var Da=a(37),Ba=a(53);class ea extends b.a{constructor(ca){super();this.$=ca;this.Eb()}create(){if(this.$){c.ULS.sendTraceTag(537169993,0,50,"CalcManagerFactory.Create: Start loading script");if(v.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")){var ca=77;var ba="Current"}else ca=80,ba="Stable";
c.ULS.sendTraceTag(537169992,0,50,`CalcManagerFactory.Create: Calc ${ba} JS was loaded`);Da.TaskExtensions.Aa(Ba.a.loadScript(ca,4,this.fb,void 0,void 0,265),()=>{c.ULS.sendTraceTag(537169991,0,50,"CalcManagerFactory.Create: Raised create service event");let ua=this.$.da.za(266,!1);ua||(c.ULS.sendTraceTag(537169990,0,50,"CalcManagerFactory.Create: CalcManager is not registered, creating new CalcManager"),ua=new Ra(this.$),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")&&
this.$.da.Ga(266,ua));this.pb(ua)},this.la,3)}else c.ULS.sendTraceTag(537169994,0,50,"CalcManagerFactory.Create: ewaControl is null, cann't create the service")}static ka(ca){ca&&ca.da&&ca.da.Ga(265,new ea(ca))}}Object(n.a)(ea,"CalcManagerFactory",b.a,[]);var Y=a(9);a.d(C,"a",function(){return ja});const ja=()=>{Y.a.Fa(ea.ka)}},1203:function(n,C,a){var c=a(9);n=a(0);var b=a(15),d=a(222),f=a(86),e=a(4),k=a(187),l=a(8),m=a(38),u=a(872),t=a(225),w=a(61),r=a(871);class v extends Sys.EventArgs{constructor(){super()}}
Object(n.a)(v,"NumberFormatsUpdatedEventArgs",Sys.EventArgs,[]);var y=a(47),x=a(45);a(35);var B=a(29),z=a(1),A=a(614);a(22);var I=a(281),F=a(21);a(200);class U{constructor(L){this.data=L}}Object(n.a)(U,"NumberFormatDataHolder",null,[]);var X=a(165);class T extends m.a{constructor(L,H){super();this.Fjc=l.a.Be;this.SZc=null;this.hgb=this.qjc=!1;this.avf=(R,Q)=>{var O;(R=F.g(this.$))&&(Q=null!==(O=null===Q||void 0===Q?void 0:Q.cell)&&void 0!==O?O:R.Vb(null))&&this.MBa(Q.cell.Nk,!0)};this.VKi=R=>{this.isActive()&&
(B.a.Dq(R.Errors)||!R.Result?(R=R.Errors?R.Errors.map(Q=>JSON.stringify(Q)).join(","):"None",b.ULS.sendTraceTag(537155726,0,50,`GetCategoryFromServer failed, ignoring - server errors: ${R}`)):(R=R.Result,b.ULS.sendTraceTag(537155725,0,50,`Updating number format category cache, format index = ${R.Index}, category = ${R.Category}`),this.Qrj(R.Index,R.Category),this.raiseEvent(T.T_c,new u.a(R.Index,R.Category),this)))};this.refresh=()=>{b.ULS.sendTraceTag(537155722,0,50,"InstantaneousSupportInformationManager.Refresh: start refresh");
this.Z1b();this.isActive()&&this.ea.jc.allowEdits&&(this.hgb||this.xn&&!(this.ea.y8a>this.Fjc)?this.JDc():(b.ULS.sendTraceTag(537155721,0,50,"InstantaneousSupportInformationManager.Refresh: getting instantaneous support information."),this.Cfd=r.a(this.$.pa.va,this.xn?this.xn.Digest:"",this.DLi,this.CLi,null,null)),b.ULS.sendTraceTag(537155720,0,50,"InstantaneousSupportInformationManager.Refresh: getting functions info."),this.z_e())};this.kzf=R=>{b.ULS.sendTraceTag(537155716,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListFailed failed, status = ${R.data.status}, HTTP status = ${R.data.httpStatus}.`);
this.AKa=null};this.z_=()=>{this.hgb=!1;this.ea.ND(this.z_);this.JRa(this.qjc?T.PRd:T.dzd)};this.Wc=(R,Q)=>{b.ULS.sendTraceTag(537155715,0,50,"InstantaneousSupportInformationManager.OnSessionIdChanged called");t.a(Q)&&this.JRa(T.PRd)};this.Vf=()=>{b.ULS.sendTraceTag(537155714,0,50,"InstantaneousSupportInformationManager.OnWorkbookMetadataChanged called");3!==this.$.workbookContext.CalcMode&&this.pzd(0===this.$.workbookContext.CalcMode)};this.dd=()=>{b.ULS.sendTraceTag(537155713,0,50,"InstantaneousSupportInformationManager.OnWorkbookOpened called");
this.JRa(T.PRd);z.EwaSettings.ma(301)&&3!==this.$.workbookContext.CalcMode&&this.pzd(0===this.$.workbookContext.CalcMode)};this.vLi=(R,Q,O)=>{b.ULS.sendTraceTag(537155712,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess called.");this.AKa=null;this.isActive()?R.StateId===l.a.Be?(b.ULS.sendTraceTag(537155682,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: no session, waiting for session."),this.JDc()):!R.Result||this.xX&&this.xX.length?this.JRa(T.dzd):this.QCf(R,
Q,O):b.ULS.sendTraceTag(537155683,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess: manager is inactive, skipping.")};this.QCf=R=>{this.xX=R.Result;b.ULS.sendTraceTag(537155681,0,50,`InstantaneousSupportInformationManager.OnGetFunctionListSuccess refreshing functions info list, returned ${this.xX?this.xX.length:-1} functions.`);R=!1;if(this.xX){for(const Q of this.xX)Q&&(this.lWe[Q.NameUI.toLocaleUpperCase()]=Q.FunctionIndex.toString(),Q.NameUI!==Q.NameDataStrings&&(this.lWe[Q.NameDataStrings.toLocaleUpperCase()]=
Q.FunctionIndex.toString(),R=!0),this.kFh.ia(Q.FunctionIndex,Q.NameUI));this.raiseEvent(T.Jcd,Sys.EventArgs.Empty,this)}R&&b.ULS.sendTraceTag(537155680,0,50,"InstantaneousSupportInformationManager.OnGetFunctionListSuccess NameDataStrings functions names were used.")};this.DLi=R=>{if(this.isActive())if(b.ULS.shipAssertTag(537155679,0,!!this.$,"null ewaControl"),this.qjc=!1,this.Fjc=R.StateId,this.Fjc===l.a.Be)this.qjc=!0,this.JDc();else{if(R.Result){var Q=this.xn;this.xn=R.Result;b.ULS.sendTraceTag(537155678,
0,50,`InstantaneousSupportInformation updated, new result digest: ${this.xn.Digest}.`);R=[];if(Q)R=T.JSh(Q.NumberFormats,this.xn.NumberFormats);else for(Q=0;Q<this.xn.NumberFormats.length;Q++)this.zmc.ia(Q,this.xn.NumberFormats[Q].NumberFormatCategory);for(const O of R)this.zmc.ia(O,this.xn.NumberFormats[O].NumberFormatCategory);this.raiseEvent(T.Nzd,new v(R),this);z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.StructuredReferencesInRangePicker",!1)&&this.raiseEvent(T.Nmf)}this.JRa(T.dzd)}};
this.CLi=R=>{this.isActive()&&(10===R.data.status?b.ULS.sendTraceTag(537155677,0,50,"Instantaneous support information request cancelled."):(b.ULS.sendTraceTag(21311555,0,10,`Failed to update instantaneous support information, status = ${R.data.status}, HTTP status = ${R.data.httpStatus}.`),this.qjc=!0,this.JDc()))};b.ULS.sendTraceTag(537155737,0,50,"InstantaneousSupportInformationManager ctor start");this.ea=L;this.$=H;this.xn=this.AKa=this.Cfd=this.hIb=null;this.zmc=new X.a;this.ovb=new X.a;this.xX=
[];this.kFh=new X.a;this.lWe={};this.ea.rk(this.Wc);this.$.kl(this.dd);F.g(this.$).ha.Lga(this.avf);z.EwaSettings.ma(301)&&this.ea.Vu(this.Vf);this.JRa(T.U$e);b.ULS.sendTraceTag(537155736,0,50,"InstantaneousSupportInformationManager ctor end")}Voe(L){this.addHandler(T.Nzd,L)}xKd(L){this.removeHandler(T.Nzd,L)}zFg(L){this.addHandler(T.T_c,L)}Oaj(L){this.removeHandler(T.T_c,L)}Aoe(L){this.addHandler(T.Jcd,L)}oKd(L){this.removeHandler(T.Jcd,L)}bHg(L){this.addHandler(T.Nmf,L)}get Ge(){return this.xn?
this.xn.LocaleInformation:null}get Dya(){return this.xn?this.xn.NumberFormats:[]}get kja(){this.xX&&this.xX.length||this.z_e();return this.xX}get Ici(){return this.xn&&void 0!==this.xn.InstantaneousCalcWebWorkerPrecisionSamplingRate&&null!==this.xn.InstantaneousCalcWebWorkerPrecisionSamplingRate?this.xn.InstantaneousCalcWebWorkerPrecisionSamplingRate:T.Fdh}get Lci(){return this.xn&&void 0!==this.xn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate&&null!==this.xn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate?
this.xn.InstantaneousCalcWebWorkerSampleWorkbookStatisticsRate:T.Jdh}get Kci(){return this.xn&&void 0!==this.xn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate&&null!==this.xn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate?this.xn.InstantaneousCalcWebWorkerSampleRecalcStatisticsRate:T.Idh}get Jci(){return this.xn&&void 0!==this.xn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate&&null!==this.xn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate?this.xn.InstantaneousCalcWebWorkerSamplePrecisionPrintFormulaRate:
T.Hdh}get Kbf(){return this.xn?this.xn.InstantaneousCalcWebWorkerRenderingTimeLimitInMs:T.Gdh}get Kmd(){return null!==this.SZc?this.SZc:this.xn?this.xn.InstantaneousCalcManualMode:!1}tNj(L){let H;if(!L)return{returnValue:!0,category:"General"};H="";if(!({category:L}=this.MBa(L,!1)).returnValue)return{returnValue:!1,category:H};H=this.a4g(L);return{returnValue:!0,category:H}}a4g(L){let H="";switch(L){case 0:H="General";break;case 1:H="Number";break;case 2:H="Currency";break;case 3:H="Accounting";break;
case 4:H="Date";break;case 5:H="Time";break;case 6:H="Percentage";break;case 7:H="Fraction";break;case 8:H="Scientific";break;case 9:H="Text";break;case 10:H="Special";break;case 11:H="Custom"}return H}MBa(L,H){let R,Q=({value:R}=this.zmc.Cc(L,0)).returnValue;!Q&&0<L&&this.$&&(b.ULS.sendTraceTag(537155735,0,50,`InstantaneousSupportInformationManager.TryGetNumberFormatCategory: failed to get category from numberFormatIndexToCategoryCache ${L}`),this.HKh(L),H&&(R=this.GKh(L),Q=!0),A.a(L,this.$.xG)&&
(R=6));return{returnValue:Q,category:R}}mii(L){let H=0;if(({category:H}=this.MBa(L,!0)).returnValue)return 6===H;b.ULS.sendTraceTag(537155733,0,50,`InstantaneousSupportInformationManager.IsFormatInPercentageCategory: failed to get category from format index ${L}`);return!1}LDh(L){b.ULS.sendTraceTag(537155730,0,50,"InstantaneousSupportInformationManager.ForceRefreshFunctionInfo: Forcing refresh of functions");this.AKa=w.o(this.$.pa.va,{FilterType:0},I.b(this.QCf,L),this.kzf,null,null,null)}CVe(){this.JRa(T.U$e)}pzd(L){this.SZc=
L}HKh(L){if(this.ovb&&this.$){var H;if(!({value:H}=this.ovb.Cc(L)).returnValue||H.isCompleted)b.ULS.sendTraceTag(537155728,0,50,`Getting number format category for format index: ${L}`),(H=r.b(this.$.pa.va,L,this.VKi,null,null,null))&&this.ovb.ia(L,H)}else b.ULS.sendTraceTag(537155729,0,15,"GetCategoryFromServerAsync called on disposed InstantaneousSupportInformationManager instance, skipping")}GKh(L){return 1<=L&&8>=L?1:9<=L&&12>=L?2:13===L||14===L?6:15===L?8:17===L|18===L?7:19===L?4:16===L||20<=
L&&29>=L||31===L?11:30===L?9:32<=L&&35>=L?3:0}isActive(){const L=void 0===this.ea||null===this.ea,H=!L&&this.ea.fc;b.ULS.sendTraceTag(537155727,0,50,`InstantaneousSupportInformationManager.IsActive: instantaneous support information manager active:${H} - sessionStateManager IsNullOrUndefined: ${L}`);return H}Qrj(L,H){this.zmc.ia(L,H)}dispose(){f.a.Ia(this.hIb);this.hIb=null;this.Z1b();for(let L of this.ovb){const H=L.value;H&&!H.isCompleted&&e.AFrameworkApplication.yd.Du(H.Yt)}this.ovb=null;this.ea&&
(this.ea.Pk(this.Wc),this.hgb&&this.ea.ND(this.z_),this.hgb=!1,this.ea.Sw(this.Vf));this.ea=null;this.$&&F.g(this.$)&&F.g(this.$).ha&&(F.g(this.$).ha.Sma(this.avf),this.$.Hl(this.dd));this.$=null;super.dispose()}isFeatureEnabled(L){try{switch(L){case "LocaleLongDateFormat":return z.EwaSettings.ma(196);case "GetLocaleDayNames":return z.EwaSettings.ma(197);case "CalculateTextWidthIgnoreLetterSpacing":return z.EwaSettings.ma(283);case "OfficeVSO:3657744_CalcFixForDateFormat":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3657744_CalcFixForDateFormat");
case "OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero":return z.EwaSettings.isChangeGateEnabled("OfficeVSO:3858161_ClientSideEstimationForDateWithTheYearZero");case "CalcAutocompleteExperiment":return z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled",!1);case "CalcNewFunctions":return z.EwaSettings.ma(246);case "CalcContractChecks":return z.EwaSettings.ma(247);case "CalcSupportDynamicArrays":return z.EwaSettings.ma(248);case "CalcFormatCalculations":return z.EwaSettings.ma(249);
case "CalcFormulaCacheAPIChanges":return z.EwaSettings.ma(250);case "CalcStrictFormulaChecking":return z.EwaSettings.ma(251);case "CalcSupportRowReference":return z.EwaSettings.ma(262);case "CalcParserUsesPledges":return z.EwaSettings.ma(306);case "CalcWebWorker":return!0;case "CalcWebWorkerTest":return z.EwaSettings.ma(305);case "CalcLookupFunctions":return z.EwaSettings.ma(307);case "CalcLogStopWatch":return z.EwaSettings.ma(370);case "CalcPreventSpillingHack":return z.EwaSettings.ma(252);case "CalcDynamicArrayOperators":return z.EwaSettings.ma(102);
case "CalcDotOperator":return z.EwaSettings.ma(576);case "CalcLetFunction":return z.EwaSettings.ma(694);default:return L.startsWith("OfficeVSO:")?z.EwaSettings.isChangeGateEnabled(L):!1}}catch(H){return b.ULS.sendTraceTag(537155724,0,15,`InstantaneousSupportInformation.IsFeatureEnabled(${L}): feature parsing failed, returning false. Exception: ${H.toString()}.`),!1}}JRa(L){this.isActive()&&this.ea.jc.allowEdits?(f.a.Ia(this.hIb),this.hIb=null,this.hIb=y.a.instance.create(this.refresh,L,x.a.Mci)):
b.ULS.sendTraceTag(537155723,0,50,`InstantaneousSupportInformationManager.ScheduleRefresh: won't schedule refresh. Edit permission: AllowEdits ${void 0!==this.ea&&null!==this.ea&&void 0!==this.ea.jc&&null!==this.ea.jc?this.ea.jc.allowEdits:!1}, IsEditMode ${void 0===this.ea||null===this.ea?!1:this.$.ea.isEditMode}`)}z_e(){b.ULS.sendTraceTag(537155719,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync called.");this.AKa?b.ULS.sendTraceTag(537155718,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync already running, skipping."):
this.isActive()?this.xX&&this.xX.length||(this.AKa=w.o(this.$.pa.va,{FilterType:0},this.vLi,this.kzf,null,null,null)):b.ULS.sendTraceTag(537155717,0,50,"InstantaneousSupportInformationManager.GetFunctionsInfoAsync session is not yet active, skipping.")}JDc(){this.hgb||(this.hgb=!0,this.ea.xE(this.z_))}Z1b(){this.Du(this.Cfd);this.Du(this.AKa);this.AKa=this.Cfd=null}Du(L){L&&!L.isCompleted&&this.$.pa.va.lfb(L.Yt)}static JSh(L,H){if(!L||!L.length)return[];if(!H||!H.length){H=Array(L.length);for(var R=
0;R<L.length;++R)H[R]=L[R].IfmtIndex;return H}R=new X.a;for(const Q of L)R.ia(Q.IfmtIndex,new U(Q));L=new k.a;for(const Q of H){let O;({value:O}=R.Cc(Q.IfmtIndex)).returnValue&&O.data.FormatString===Q.FormatString||L.add(Q.IfmtIndex)}return L.toArray()}}T.Nzd="isim0";T.T_c="isim1";T.Jcd="isim2";T.Nmf="isim3";T.U$e=100;T.PRd=1E3;T.dzd=3E5;T.Fdh=.001;T.Jdh=.1;T.Idh=.2;T.Hdh=.001;T.Gdh=50;Object(n.a)(T,"InstantaneousSupportInformationManager",m.a,[522,10]);var G=a(699);class D extends d.a{constructor(L){super();
this.$=L;this.Eb()}create(){if(this.$){b.ULS.sendTraceTag(537155672,0,50,"InstantaneousSupportInformationManagerFactory.Create: Start loading script");var L=Object(G.a)(this.$.da,268,()=>new T(this.$.ea,this.$));this.pb(L)}}static ka(L){if(!L)throw Error.argumentNull("ewaControl");L.da.Ga(246,new D(L))}}Object(n.a)(D,"InstantaneousSupportInformationManagerFactory",d.a,[]);a.d(C,"a",function(){return J});const J=()=>{c.a.Fa(D.ka)}},1218:function(n,C,a){function c(H){if(H){var R=new u(H.IsRangeRef);
R.DF=H.IsAbsoluteFirstRow;R.CF=H.IsAbsoluteFirstColumn;R.rK=H.IsAbsoluteSecondRow;R.qK=H.IsAbsoluteSecondColumn;return R}}function b(H){var R;if(H){var Q=new u(0===H.kind);H=null===(R=null===H||void 0===H?void 0:H.rangeInfo)||void 0===R?void 0:R.positionKindInfo;if(!H)return Q;Q.DF=0===H.firstRow;Q.CF=0===H.firstColumn;Q.rK=0===H.secondRow;Q.qK=0===H.secondColumn;return Q}}n=a(0);var d=a(222),f=a(7),e=a(15),k=a(82),l=a(5),m=a(320);class u{constructor(H){this.qK=this.rK=this.CF=this.DF=!1;this.SZ=
H}}Object(n.a)(u,"MarqueeRangeData",null,[]);class t{constructor(H,R,Q,O=!1){this.QWd=H;this.bOb=R;this.n7a=O;Q?(this.SZ=Q.SZ,this.DF=Q.DF,this.CF=Q.CF,this.rK=Q.rK,this.qK=Q.qK):e.ULS.shipAssertTag(524039642,0,!1,"MarqueeMetadata.Ctor: rangeData is null")}}Object(n.a)(t,"MarqueeMetadata",null,[]);var w=a(43),r=a(139),v=a(35),y=a(1),x=a(22),B=a(581),z=a(21),A=a(200),I=a(341),F=a(33),U=a(753),X=a(874);const T="rgba(95, 140, 237, {0});rgba(235, 94, 96, {0});rgba(141, 97, 194, {0});rgba(45, 150, 57, {0});rgba(191, 76, 145, {0});rgba(227, 130, 34, {0});rgba(55, 127, 158, {0})".split(";");
class G{constructor(H,R){this.pK=this.zeb=this.xof=!1;this.C8=null;this.Kya=()=>{this.pK=!1};this.Jc=H;this.gridView=z.g(H);this.calcManager=R;this.Dcf=y.EwaSettings.ma(683);this.iV=F.a.iV(H);this.sba=y.EwaSettings.isChangeGateEnabled("OfficeVSO:6592066_FixAutoCompleteCardFocusBug");this.gridView.Xb.lm(this.Kya)}get formulaAssistanceManager(){this.C8||(this.C8=this.Jc.da.za(464));return this.C8}get formulaAssistanceTelemetryManager(){this.HDa||(this.HDa=this.Jc.da.za(491));return this.HDa}SB(H,R){H.textBox.addEventLogRecord("ColoredReferencesManager.TryUpdateColoredReferences");
if(this.zeb||H.EF)return!1;const Q=void 0===R||null===R?H.text:R;if(this.calcManager&&1<Q.length&&A.f(Q)){var O=this.Fja(),V=this.P1e(),W=this.Jc.workbookContext.WorkbookFileName;let ta=!1;const K=.01>Math.random()?Object(k.a)(r.a,this.Jc.Jb.Bc("LoadingUIShown","ColoredReferencesManager")):null;try{var da=this.calcManager.extractReferences(Q,V,W,!this.Dcf);if(!da)return e.ULS.sendTraceTag(524039689,0,50,"ColoredReferencesManager.UpdateColoredReferences: extractReferences is null (might be an invalid formula)"),
!1;V=[];W=[];const na=[],P=[];let ka=0,pa=0;const Na=new v.a(!1);let Z="";for(const Da of da.Items)if(ta=Da.IsStructRef||ta,Da.IsBoolean||Da.IsNumber||Da.IsString){const Ba=Da.IsBoolean?"rgba(0, 0, 255, 1)":Da.IsNumber?"rgba(9, 134, 88, 1)":"rgba(163, 21, 21, 1)";this.vE(W,Q,ka,Da.Span.Start,null);this.vE(W,Q,Da.Span.Start,Da.Span.End,Ba);ka=Da.Span.End}else if(y.EwaSettings.ma(587)){if(Da.Range||Da.LetName&&0<=Da.LetNumber){da=null;if(Da.Range){let ea=w.D(Da.Range);da=this.eZ(ea,Na,1);V.push(new I.a(ea,
O))}else Da.LetName&&0<=Da.LetNumber&&(da=Z=this.sLh(Da.LetName,Da.LetNumber,Na,Z),pa!==Na.count&&H.colors.add(Da.Span.Start+"-"+Da.Span.End,T[(Na.count-1)%T.length]));this.vE(W,Q,ka,Da.Span.Start,null);this.vE(W,Q,Da.Span.Start,Da.Span.End,da);ka=Da.Span.End;na.push(Da.Span);let Ba=W.length-1;P.push(new t(Ba,W[Ba].text,c(Da)));pa=Na.count}}else if(Da.Range){let Ba=w.D(Da.Range),ea=this.eZ(Ba,Na,1);this.vE(W,Q,ka,Da.Span.Start,null);this.vE(W,Q,Da.Span.Start,Da.Span.End,ea);V.push(new I.a(Ba,O));
ka=Da.Span.End;na.push(Da.Span);let Y=W.length-1;P.push(new t(Y,W[Y].text,c(Da)))}this.vE(W,Q,ka,Q.length,null);this.gxc(H,W,!!R);const Ra=H.textBox.text;if(!x.a.equals(Ra,Q,!1)){e.ULS.shipAssertTag(38114182,0,!1,`ColoredReferencesManager.UpdateColoredReferences: The text we created is different from the original text. Setting the original text back. currentTextLength [${Ra.length}], originalTextLength [${Q.length}]`);let Da=H.textBox.caretPosition;H.textBox.text=Q;H.textBox.caretPosition=Da;return!0}this.uz(V,
Na,P);y.EwaSettings.ma(587)&&0<V.length&&e.ULS.sendTraceTag(524039688,0,50,"ColoredReferencesManager.UpdateColoredReferences: Cell reference(s) colored");y.EwaSettings.ma(587)&&0<H.colors.count&&e.ULS.sendTraceTag(524039687,0,50,"ColoredReferencesManager.UpdateColoredReferences: Let name(s) colored");return this.pK=!0}finally{K&&K.jBa(()=>{ta&&e.ULS.sendTraceTag(524039686,0,50,`ColoredReferencesManager.UpdateColoredReferences: Formula with structured reference is highlighted in ${K.yc} ms`)})}}else return this.uz(null,
null),this.pK&&(this.pK=!1,O=H.textBox.caretPosition,H.textBox.setPlainText(Q),H.textBox.caretPosition=Math.min(O,Q.length),R)?!0:!1}ofb(H,R,Q){if(this.zeb||H.EF)return!1;const O=isNullOrUndefined(R)?H.text:R;var V=[];const W=new v.a(!1);if(1<O.length&&Object(U.b)(Q)){const ta=[],K=[],na=[];var da=0;const P=this.Fja();for(const ka of Q.formulaHighlights){this.vE(ta,O,da,ka.span.start,null);switch(ka.kind){case 0:case 1:case 2:Q=w.B(ka.rangeInfo.sharedRange);if(isNullOrUndefined(Q)){e.ULS.sendTraceTag(521211937,
0,10,`ColoredReferencesManager.tryUpdateFormulaHighlights: Received formula highlight with undefined range, HighlightKind:${ka.kind.toString()},`);this.vE(ta,O,ka.span.start,ka.span.end,null);break}da=this.eZ(Q,W,1);this.vE(ta,O,ka.span.start,ka.span.end,da);V.push(new I.a(Q,P));K.push({Start:ka.span.start,End:ka.span.end});Q=ta.length-1;na.push(new t(Q,ta[Q].text,b(ka)));break;case 3:this.vE(ta,O,ka.span.start,ka.span.end,null,"rgba(229, 229, 229, 1)")}da=ka.span.end}this.vE(ta,O,da,O.length);this.gxc(H,
ta,!!R);R=H.textBox.text;if(!x.a.equals(R,O,!1))return e.ULS.shipAssertTag(521211936,0,!1,`ColoredReferencesManager.UpdateFormulaHighlights: The text we created is different from the original text. Setting the original text back. currentTextLength [${R.length}], originalTextLength [${O.length}]`),R=H.textBox.caretPosition,H.textBox.text=O,H.textBox.caretPosition=R,!0;this.uz(V,W,na);return this.pK=!0}this.uz(null,null);return this.pK&&(this.pK=!1,V=H.textBox.caretPosition,H.textBox.setPlainText(O),
H.textBox.caretPosition=Math.min(V,O.length),R)?!0:!1}yDb(H,R,Q){if(!H||!R||!Q)return e.ULS.shipAssertTag(524039685,0,!!H,"ColoredReferencesManager.MoveMarqueeRange: cellContentEditor is null"),e.ULS.shipAssertTag(524039684,0,!!R,"ColoredReferencesManager.MoveMarqueeRange: highlightState is null"),e.ULS.shipAssertTag(524039683,0,!!Q,"ColoredReferencesManager.MoveMarqueeRange: newRange is null"),!1;const O=Object(k.a)(t,R.metadata);if(!O)return e.ULS.shipAssertTag(524039682,0,!1,"ColoredReferencesManager.MoveMarqueeRange: marqueeMetadata is null"),
!1;var V=O.QWd,W=O.bOb,da=this.gridView.Fb.wod(Q)?Q.Hvb(O.CF,O.DF):Q.MKa(O.CF,O.DF,O.qK,O.rK);if(!da)return e.ULS.shipAssertTag(524039681,0,!1,"ColoredReferencesManager.MoveMarqueeRange: newText is null"),!1;const ta=W.indexOf("!");-1!==ta&&(da=W.substring(0,ta+1)+da);if(!H.textBox.changeTextInExistingTextPart(V,W,da))return e.ULS.shipAssertTag(38926105,0,!1,"ColoredReferencesManager.MoveMarqueeRange: failed to change the text part"),!1;O.bOb=da;V=!0;for(W=1;4>=W;W++)(da=z.g(this.Jc).ob.nv(3,W,R.WT))?
(da.range=Q,da.metadata=O):(e.ULS.shipAssertTag(524039680,0,!1,"ColoredReferencesManager.MoveMarqueeRange: highlightStateInPane is null"),V=!1);this.gridView.ob.update(!1,!1);this.gridView.tm&&(this.gridView.hc.textBox.text=H.text);this.gridView.hc.mQa(new m.a({tzb:!0}));return V}Lji(H){if(3!==H.Hq)return e.ULS.shipAssertTag(524039651,0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: not HighlightDivIndex.Marquee."),!1;H=Object(k.a)(t,H.metadata);return H?H.SZ&&!H.n7a:(e.ULS.shipAssertTag(524039650,
0,!1,"ColoredReferencesManager.IsMarqueeHighlightDragable: marqueeMetadata is null."),!1)}oBa(H,R){e.ULS.sendTraceTag(524039649,0,50,"ColoredReferencesManager.SuspendResumeColoredReferences: "+(R?"suspending":"resuming")+" colored references");R&&this.pK&&(this.pK=!1,this.uz(null,null),H.textBox.Wze());this.zeb=R}dispose(){this.gridView&&this.gridView.Xb&&this.gridView.Xb.Fl(this.Kya)}ILa(H){const R=this.formulaAssistanceTelemetryManager;R||this.xof||(this.xof=!0,e.ULS.sendTraceTag(521211935,0,50,
"ColoredReferencesManager.highlightPreviewRanges: Failed to log highlightPreviewRanges measurement, FormulaAssistanceTelemetryManager unavailable"));null===R||void 0===R?void 0:R.WD(["highlightPreviewRanges"]);this.iV?this.m7h(H):this.l7h(H);null===R||void 0===R?void 0:R.aD(["highlightPreviewRanges"],!0)}m7h(H){var R=this.formulaAssistanceManager.r4a(H,X.a);if(isNullOrUndefined(R))this.sba&&this.uz(null,null);else{var Q=this.Fja(),O=[],V=new v.a(!1),W=[];R=R.formulaHighlights;for(const da of R)if(R=
da.kind,0===R||2===R||1===R)R=w.B(da.rangeInfo.sharedRange),Object(U.b)(R)&&(O.push(new I.a(R,Q)),this.eZ(R,V,1),W.push(new t(da.span.start,H.substring(da.span.start,da.span.end),b(da),!0)));this.uz(O,V,W)}}l7h(H){const R=this.Fja();var Q=this.P1e();const O=this.Jc.workbookContext.WorkbookFileName,V=[],W=new v.a(!1),da=[];if(Q=this.calcManager.extractReferences(H,Q,O,!this.Dcf)){for(const ta of Q.Items)ta.Range&&(Q=w.D(ta.Range),V.push(new I.a(Q,R)),this.eZ(Q,W,1),da.push(new t(ta.Span.Start,H.substring(ta.Span.Start,
ta.Span.End),c(ta),!0)));this.uz(V,W,da)}else this.sba&&this.uz(null,null)}eZ(H,R,Q){let O=R.getItem(H.toString());O||(O=T[R.count%T.length],R.add(H.toString(),O));return String.format(O,Q)}sLh(H,R,Q,O){H="["+H+", "+R+"]";R=Q.getItem(H);R||(R=Q.count%T.length,R=T[R],O===String.format(R,1)&&(Q.add("skip-"+H,R),R=Q.count%T.length,R=T[R]),Q.add(H,R));return String.format(R,1)}vE(H,R,Q,O,V=null,W=null){e.ULS.shipAssertTag(524039648,0,Q<=O,"ColoredReferencesManager.AddTextPart: startIndex cannot be larger than endIndex");
Q<O&&(R=R.substring(Q,O),H.push(Object(f.a)(new B.a,{text:R,color:V,backgroundColor:W})))}uz(H,R,Q=null){H&&H.length?(e.ULS.sendTraceTag(524039647,0,50,"ColoredReferencesManager.HighlightRanges: number of ranges to highlight: "+H.length),H.reverse(),Q.reverse(),this.gridView.ob.Ww(H,[3],!0,(O,V)=>{if(O&&O.range&&V){e.ULS.shipAssertTag(524039643,0,R.lb(O.range.toString()),`ColoredReferencesManager.HighlightRanges: The range '${O.range.toString()}' doesn't exist in the range to color dictionary`);var W=
this.eZ(O.range,R,.1),da=this.eZ(O.range,R,1);this.Jc.frame&&this.Jc.frame.hD&&this.Jc.frame.hD.Aba||(V.style.background=W);V.style.borderColor=da;Q&&(V.setAttribute(l.a.X5a,O.WT.toString()),O.metadata=Q[O.WT])}else e.ULS.shipAssertTag(524039646,0,!!O,"ColoredReferencesManager.HighlightRanges: state is null"),e.ULS.shipAssertTag(524039645,0,!!O.range,"ColoredReferencesManager.HighlightRanges: state.Range is null"),e.ULS.shipAssertTag(524039644,0,!!V,"ColoredReferencesManager.HighlightRanges: div is null")})):
(H=this.Jc.Jb.Bc("UserAction","HideRangesHighlightsStopwatch"),this.gridView.ob.Pg([3]),this.gridView.ob.mSa(new I.a(null,this.Fja()),[3]),H.stop())}gxc(H,R,Q){const O=H.textBox;O.xF=!0;var V=O.selection;const W=V.index;V=W+V.length;O.setTextFromTextParts(R);R=O.text.length;O.selectRange(Math.min(W,R),Math.min(V,R));Q&&H.mQa(new m.a);O.xF=!1}Fja(){return this.Qbc().sheetId}P1e(){return this.Qbc().sheetName}Qbc(){return this.gridView.Wq&&this.gridView.Wq.XF?this.gridView.Wq.XF:this.Jc.oa}}Object(n.a)(G,
"ColoredReferencesManager",null,[713,10]);class D extends d.a{constructor(H){super();this.$=H;this.Eb()}create(){this.$.da.Za(266,H=>{H=y.EwaSettings.ll()||y.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(281)||this.$.da.Ga(281,new G(this.$,H)):new G(this.$,H);this.pb(H)})}static ka(H){H.da.Ga(282,new D(H))}}Object(n.a)(D,"ColoredReferencesManagerFactory",d.a,[]);var J=a(9);a.d(C,"a",function(){return L});const L=()=>{J.a.Fa(D.ka)}},1265:function(n,
C,a){n=a(0);var c=a(222),b=a(807),d=a(1);class f extends c.a{constructor(l){super();this.$=l;this.Eb()}create(){this.$.da.Za(266,l=>{l=d.EwaSettings.ll()||d.EwaSettings.isChangeGateEnabled("OfficeVSO:6143820_MoveServiceRegistrationFromFAM_V2")?this.$.da.za(294)||this.$.da.Ga(294,new b.RelativeAndAbsoluteReferencesManager(l)):new b.RelativeAndAbsoluteReferencesManager(l);this.pb(l)})}static ka(l){l.da.Ga(295,new f(l))}}Object(n.a)(f,"RelativeAndAbsoluteReferencesManagerFactory",c.a,[]);var e=a(9);
a.d(C,"a",function(){return k});const k=()=>{e.a.Fa(f.ka)}},1388:function(n,C,a){a.r(C);n=a(1203);C=a(1157);var c=a(1218);a=a(1265);Type.registerNamespace("_Ewa");Object(n.a)();Object(C.a)();Object(c.a)();Object(a.a)()},789:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.abs="Abs";c.rel="Rel";Object(n.a)(c,"PositionBaseType",null,[])},807:function(n,C,a){a.r(C);n=a(0);var c=a(7),b=a(15);class d{}Object(n.a)(d,"Reference",null,[]);class f extends d{constructor(){super();this.column=
this.row=null}}Object(n.a)(f,"CellReference",d,[]);class e{constructor(){this.end=this.start=0;this.zv=null}RLg(I,F){for(let U=0;U<this.zv.length;U++){const X=this.Z_b(I,this.zv[U]);F+=X;U<this.zv.length-1&&(F+=":")}return F}}Object(n.a)(e,"IReferenceSequence",null,[]);var k=a(24),l=a(789);class m extends e{constructor(){super();this.Qhc=!1}Hbc(){const {RelativeAndAbsoluteReferencesManager:I}=a(807),F=this.zv[0];return I.utf(F.row.kind===l.a.abs,F.column.kind===l.a.abs)}Z_b(I,F){F=k.Range.Uc(F.row.index+
1,F.column.index+1);return this.Qhc?F.Hvb(1===I||3===I,1===I||2===I):F.MKa(1===I||3===I,1===I||2===I,!0,!0)}}Object(n.a)(m,"CellReferenceSequence",e,[]);class u extends d{constructor(){super();this.secondColumn=this.firstColumn=null}}Object(n.a)(u,"ColumnReference",d,[]);class t extends e{constructor(){super()}Hbc(){const I=this.zv[0];return a(807).RelativeAndAbsoluteReferencesManager.Prf(I.firstColumn,I.secondColumn).kind===l.a.abs?2:3}Z_b(I,F){return k.Range.Sub(F.firstColumn.index+1,F.secondColumn.index+
1).MKa(1===I||3===I,!0,1===I||3===I,!0)}}Object(n.a)(t,"ColumnReferenceSequence",e,[]);class w extends d{constructor(){super();this.right=this.left=this.bottom=this.top=null}}Object(n.a)(w,"RangeReference",d,[]);class r extends e{constructor(){super()}Hbc(){const {RelativeAndAbsoluteReferencesManager:I}=a(807),F=this.zv[0];return I.utf(F.top.kind===l.a.abs,F.left.kind===l.a.abs)}Z_b(I,F){F=new k.Range(F.top.index+1,F.left.index+1,F.bottom.index+1,F.right.index+1,!1,!1);const U=1===I||3===I;I=1===
I||2===I;return F.MKa(U,I,U,I)}}Object(n.a)(r,"RangeReferenceSequence",e,[]);class v extends d{constructor(){super();this.secondRow=this.firstRow=null}}Object(n.a)(v,"RowReference",d,[]);class y extends e{constructor(){super()}Hbc(){const I=this.zv[0];return a(807).RelativeAndAbsoluteReferencesManager.Prf(I.firstRow,I.secondRow).kind===l.a.abs?0:1}Z_b(I,F){return k.Range.M$b(F.firstRow.index+1,F.secondRow.index+1).MKa(!0,1===I||2===I,!0,1===I||2===I)}}Object(n.a)(y,"RowReferenceSequence",e,[]);var x=
a(981),B=a(982),z=a(200);a.d(C,"RelativeAndAbsoluteReferencesManager",function(){return A});class A{constructor(I){this.calcManager=I}G1a(I,F,U){let X,T;X=F;T=U;if(!I||!z.f(I))return{returnValue:I,Pyd:X,Oyd:T};var G=this.calcManager.TSe(I);if(!G)return b.ULS.sendTraceTag(524039641,0,15,"RelativeAndAbsoluteReferencesManager.CycleThroughRelativeAndAbsoluteReferences: Couldn't extract references (might be invalid formula)"),{returnValue:null,Pyd:X,Oyd:T};G=this.AXh(G,I,F,U);let D=0,J="",L=0,H=0;for(;H<
G.length;H++)if(this.kKe(G[H],F,U)){D=G[H].Hbc();X=G[H].start;break}for(;H<G.length&&this.kKe(G[H],F,U);H++)J+=I.substring(L,G[H].start),J=G[H].RLg(D,J),L=G[H].end;L&&(T=J.length);J+=I.substring(L,I.length);return{returnValue:J,Pyd:X,Oyd:T}}AXh(I,F,U,X){const T=[];for(let L=0;L<I.length;L++){var G=I[L];if(G.kind===x.a.range)if(G=G.ref,G.type===B.a.cell){var D=G;G=Object(c.a)(new m,{start:G.span.start,end:G.span.end,zv:[Object(c.a)(new f,{column:D.col,row:D.row})],Qhc:this.calcManager.m2b(G.span.end,
F)});T.push(G)}else if(G.type===B.a.range)this.lKe(G.topLeftSpan,U,X)&&this.lKe(G.bottomRightSpan,U,X)?(D=new w,G.top.index<=G.bottom.index?(D.top=G.top,D.bottom=G.bottom):(D.bottom=G.top,D.top=G.bottom),G.left.index<=G.right.index?(D.left=G.left,D.right=G.right):(D.right=G.left,D.left=G.right),G=Object(c.a)(new r,{start:G.topLeftSpan.start,end:G.bottomRightSpan.end,zv:[D]}),T.push(G)):(D=Object(c.a)(new m,{start:G.topLeftSpan.start,end:G.topLeftSpan.end,zv:[Object(c.a)(new f,{column:G.left,row:G.top})],
Qhc:this.calcManager.m2b(G.topLeftSpan.end,F)}),G=Object(c.a)(new m,{start:G.bottomRightSpan.start,end:G.bottomRightSpan.end,zv:[Object(c.a)(new f,{column:G.right,row:G.bottom})],Qhc:this.calcManager.m2b(G.topLeftSpan.end,F)}),T.push(D),T.push(G));else if(G.type===B.a.column){D=G;for(G=Object(c.a)(new t,{start:G.span.start,end:G.span.end,zv:[Object(c.a)(new u,{firstColumn:D.startIndex,secondColumn:D.endIndex})]});G.end<F.length-1&&":"===F.charAt(G.end)&&L<I.length-1;)if(D=I[L+1].ref,D.type===B.a.column&&
D.span.start===G.end+1){var J=D;G.zv.push(Object(c.a)(new u,{firstColumn:J.startIndex,secondColumn:J.endIndex}));G.end=D.span.end;L++}else break;T.push(G)}else if(G.type===B.a.row){D=G;for(G=Object(c.a)(new y,{start:G.span.start,end:G.span.end,zv:[Object(c.a)(new v,{firstRow:D.startIndex,secondRow:D.endIndex})]});G.end<F.length-1&&":"===F.charAt(G.end)&&L<I.length-1;)if(D=I[L+1].ref,D.type===B.a.row&&D.span.start===G.end+1)J=D,G.zv.push(Object(c.a)(new v,{firstRow:J.startIndex,secondRow:J.endIndex})),
G.end=D.span.end,L++;else break;T.push(G)}}return T}kKe(I,F,U){return!(I.start>U||F>I.end)}lKe(I,F,U){return!(I.start>U||F>I.end)}static Prf(I,F){return I.index<=F.index?I:F}static utf(I,F){return F||I?F&&I?2:!F&&I?3:0:1}}Object(n.a)(A,"RelativeAndAbsoluteReferencesManager",null,[712])},938:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(263),d;(function(y){y[y.paren=0]="paren";y[y.lead=1]="lead";y[y.intern=2]="intern";y[y.trail=3]="trail";y[y.undefined=4]="undefined"})(d||(d={}));Object(n.b)("CurrencyFormatOption",
d);var f;(function(y){y[y.none=-1]="none";y[y.mdy=0]="mdy";y[y.dmy=1]="dmy";y[y.ymd=2]="ymd";y[y.myd=3]="myd";y[y.dym=4]="dym";y[y.ydm=5]="ydm"})(f||(f={}));Object(n.b)("DateOrderOption",f);var e=a(8);class k{constructor(y,x){({CalcHelper:y}=a(938));x&&(x.Ge||c.ULS.shipAssertTag(537169942,0,!1,"LocaleHolder constructor - locale information is not available"));this.Btg=y.oFe(x,y.ZEe(x.kja));this.Ctg=excelOnlineCalc.calc.localeInfoFromData(this.localeData)}get localeInfo(){return this.Ctg}get localeData(){return this.Btg}formatNumber(y){return this.localeInfo.formatNumber(y)}}
Object(n.a)(k,"LocaleHolder",null,[]);var l=a(979),m=a(53),u=a(1),t=a(22),w=a(14),r=a(199);a.d(C,"CalcHelper",function(){return v});class v{constructor(y){this.$=y;(this.dy=this.$.da.za(268))||c.ULS.shipAssertTag(537170070,0,!1,"CalcHelper constructor - IInstantaneousSupportInformationManager is not available");let x;x=u.EwaSettings.isChangeGateEnabled("OfficeVSO:5543503_loadCalcCurrentVersion")?m.a.current.Zn(77):m.a.current.Zn(80);this.logger=new l.a;this.documentLoc=excelOnlineCalc.location.documentLoc("",
this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName);this.Yba=new k(y,this.dy);excelOnlineCalc.config.initCalc(this.logger,this.dy?B=>this.dy.isFeatureEnabled(B):()=>!1,x);this.rog=excelOnlineCalc.config.calcConfig(this.Yba.localeInfo)}get config(){return this.rog}Ybh(){if(u.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")){if(!this.$.xa)return c.ULS.shipAssertTag(537170069,0,!1,"CalcHelper.CurrentSheetIndex() - this.ewaControl.Sheets is null"),0;const y=this.$.xa.oa;
return y?y.index:(c.ULS.shipAssertTag(537170068,0,!1,"CalcHelper.CurrentSheetIndex() - sheet is null"),0)}return this.$.xa.oa.index}createParser(){const y={};y.config=this.config;return excelOnlineCalc.parse.createParser(y)}createNumberFormatter(){const y=excelOnlineCalc.numfmt.createFormatGlobals(this.config,(x,B)=>excelOnlineCalc.calc.getTime(this.config,x,B,"Estimation"));return excelOnlineCalc.numfmt.createNumberFormatter(y)}hah(y,x,B,z){if(!z)return{range:{row:x,col:B},sheet:{document:this.documentLoc,
index:y}};x=excelOnlineCalc.location.gridCell(x,B);y=excelOnlineCalc.location.sheetIndex(this.documentLoc,y);return excelOnlineCalc.location.sheetGridCell(y,x)}pnh(y,x){let B;B=excelOnlineCalc.calc.getEvalResultKind(y);switch(B){case 4:return{returnValue:y?this.Yba.localeInfo.trueName:this.Yba.localeInfo.falseName,kind:B};case 1:return{returnValue:u.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.dBc(this.Yba.formatNumber(y),x):this.Yba.formatNumber(y),
kind:B};case 2:return{returnValue:u.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?this.dBc(y.toString(),x):y.toString(),kind:B};case 128:return{returnValue:"",kind:B};case 8:switch(y.type){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:return{returnValue:this.Yba.localeInfo.errorNames[y.type],kind:B};default:return{returnValue:v.unknownError,kind:B}}case 32:return{returnValue:u.EwaSettings.isChangeGateEnabled("OfficeVSO:3594728_SupportEvaluatingArrayOpersToString")?
this.dBc(this.yah(y,x),x):"##UNSUPPORTED: ARRAY",kind:B};default:return{returnValue:w.a.instance.ga(2216),kind:B}}}dBc(y,x){return y.length<=x?y:y.substring(0,x-3)+"..."}yah(y,x){let B=this.Yba.localeInfo.leftBrace;for(let z=0;z<y.rows;++z){for(let A=0;A<y.cols;++A)B+=y.opers[z][A],A<y.cols-1&&(B+=this.Yba.localeInfo.columnSeparator);z<y.rows-1&&(B+=this.Yba.localeInfo.rowSeparator)}return this.dBc(B,x-1)+this.Yba.localeInfo.rightBrace}static oFe(y,x=null){const B=v.M4b(),z=y.Ge.TrueValueString,A=
y.Ge.FalseValueString,I=y.Ge.DecimalSeparator.toString(),F=y.Ge.ListSeparator.toString(),U=y.Ge.ColumnSeparator.toString(),X=y.Ge.RowSeparator.toString(),T=y.Ge.ThousandsDataArray,G=y.Ge.ThousandSeparator.toString(),D=y.Ge.Lcid,J=y.Ge.Country,L=y.Ge.DigitsNumber,H=y.Ge.ExpSeparatedBySpace,R=y.Ge.FractionSeparator.toString(),Q=y.Ge.PercentSeparatedBySpace,O=t.a.oWg(Enum.toString(d,y.Ge.CurrencyFormat)),V=y.Ge.CurrencySymbolLead,W=y.Ge.CurrencySeparatedBySpace,da=y.Ge.CurrencySymbolString,ta=y.Ge.DigitsCurrency,
K=-1===y.Ge.DateOrder?"MDY":r.e(Enum.toString(f,y.Ge.DateOrder)),na=y.Ge.DateSeparator.toString(),P=y.Ge.DateAlternativeSeparator.toString(),ka=y.Ge.Year4Digits,pa=y.Ge.Month2Digits,Na=y.Ge.Day2Digits,Z=y.Ge.LongDateFormat,Ra=y.Ge.TimeSeparator.toString(),Da=y.Ge.TimeAltSeparator,Ba=y.Ge.Hour2Digits,ea=y.Ge.Use24HourClock,Y=y.Ge.AmPmSeparatedBySpace,ja=[y.Ge.AmString,y.Ge.PmString],ca=y.Ge.DayNameShortArray,ba=y.Ge.DayNameLongArray,ua=y.Ge.MonthNameShortArray,wa=y.Ge.MonthNameLongArray,ia=y.Ge.PictureSpecialArray,
xa=b.a.map(("\x00"+y.Ge.PictureSingleString).split(""),mb=>"\x00"===mb?null:mb),gb=y.Ge.PictureColorArray,va=y.Ge.PictureDbnumArray,sa=y.Ge.RowLetter.toString(),ab=y.Ge.ColumnLetter.toString(),Ua=y.Ge.LeftBrace.toString(),nb=y.Ge.RightBrace.toString(),Ha=y.Ge.LeftBracket.toString(),sb=y.Ge.RightBracket.toString(),Qb=v.sYh(y.Ge);return excelOnlineCalc.calc.localeData(x,B,z,A,sa,ab,Ua,nb,Ha,sb,I,F,U,X,T,G,D,J,L,H,R,Q,O,V,W,da,ta,K,na,P,ka,pa,Na,Z,Ra,Da,Ba,ea,Y,ja,ca,ba,ua,wa,ia,xa,gb,va,Qb,y.Ge.SysDateFormatString,
y.Ge.SysTimeFormatString)}static ZEe(y){const x=[];if(!y)return x;for(const B of y)y=null,B.IsDynamicUdf||(y=excelOnlineCalc.calc.worksheetFunctionName(B.FunctionIndexInServer,B.NameUI)),y&&x.push(y);return x}static M4b(){const y=[],x=Object.keys(e.a.errorNames);for(let B=0;B<x.length;B++){const z=excelOnlineCalc.calc.errorTypeName(B+1,x[B]);z&&y.push(z)}return y}static sYh(y){const x=Array(6);x[1]="#"+y.AllStructRefString;x[3]="#"+y.HeadersStructRefString;x[2]="#"+y.DataStructRefString;x[4]="#"+
y.TotalsStructRefString;x[5]="#"+y.ThisRowStructRefString;return x}}v.unknownError="##ERR##";Object(n.a)(v,"CalcHelper",null,[])},981:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.Vsi="literal";c.operator="operator";c.func="function";c.namedRange="namedRange";c.range="range";c.Plf="letName";c.all="*";c.EVd="structRefRange";Object(n.a)(c,"TraverseFormulaInterestTypes",null,[])},982:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.cell="cell";c.range="range";c.row=
"row";c.column="col";Object(n.a)(c,"TraverseFormulaRefTypes",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.calc.js.map/93dddb64ca99cce9f4a8f3fdc50d970e/EwaDSEsNext.calc.js.map