'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1049:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb.ewa-bb-react{background-color:#f5f5f5}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}")}},
1050:function(n,C,a){a.d(C,"a",function(){return k});n=a(0);var c=a(15),b=a(84);C=a(144);var d=a(4),f=a(44),e=a(30);class k extends C.a{constructor(l,m,u,t,w,r,v=null){super();this.fJ=null;this.La=m;this.lX=t;this.wga=r;this.nb=l;this.Ps=w;this.af=u;this.pib=this.nb.qa("SaveToHostWithExtraCharsInFileName");this.Mh=v;this.rc(1,CommonUIStrings.l_SaveButtonLabel)}get ta(){return this.af}mJe(l,m){this.oL(1,!!l&&l!==m);this.fJ=document.getElementById(k.ATe);f.a.addHandler(this.fJ,"change",Object(b.a)(this,
this.Inc,"onFileNameChange"));f.a.addHandler(this.fJ,"input",Object(b.a)(this,this.Inc,"onFileNameChange"));this.fJ.focus()}H9b(l){return this.pib?(new RegExp("["+this.s8b('\\/:*?"<>|')+"]")).test(l):(new RegExp("["+this.s8b('\\/:*?"<>|#{}%~&')+"]")).test(l)}s8b(l){return l.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}Tid(){const l=e.a.Fq(d.AFrameworkApplication.nm.jn);this.oL(1,!!this.fJ&&""!==this.fJ.value&&this.fJ.value!==l)}Inc(){this.fJ&&window.setTimeout(()=>{this.Tid()},0)}G9b(l,m){if(1!==
l)c.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{l=m[k.ATe];m=k.VGf in m?m[k.VGf]:!1;c.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",e.a.hsc(l),m);const u=e.a.e4(d.AFrameworkApplication.fileName);(l=l?l.trim():null)&&""!==l&&""!==u||1===this.ta.state?this.H9b(l)?this.Ps.create().displayError(1,l,m):this.wga.aoa(l+u,m,this.Mh):this.Ps.create().displayError(2,l,m)}}dispose(){this.fJ&&
(f.a.removeHandler(this.fJ,"change",Object(b.a)(this,this.Inc,"onFileNameChange")),f.a.removeHandler(this.fJ,"input",Object(b.a)(this,this.Inc,"onFileNameChange")),this.fJ=null);super.dispose()}}k.ATe="txtFileName";k.VGf="chkOverwrite";Object(n.a)(k,"FileNameDialogBase",C.a,[])},1051:function(n,C,a){a.d(C,"a",function(){return t});n=a(0);var c=a(15),b=a(155),d=a(84),f=a(4),e=a(643),k=a(834),l=a(373),m=a(106),u=a(25);class t{constructor(w,r,v,y){this.pWb=null;this.Qwg=w;this.nb=v;this.Vde=r;this.Ebe=
new b.a;this.Ch=y}O7a(){return this.nb.qa("SaveToCloudStorageUIIsEnabled")}gXe(){return u.a.saveToCloudStorage}N1b(){l.a.UId(Object(d.a)(this,this.iXf,"saveToCloudActionDispatcher"));l.a.P8c([new k.a(u.a.saveToCloudStorage,m.a.frame,0)],this.Vde.B4a())}Ig(){const w=this.Vde.B4a();w?(w.D9(()=>{this.Ebe.setResult(!0)}),this.N1b()):c.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}AOf(){c.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}iXf(w,
r,v,y,x){return r.contextId!==m.a.frame||w!==this.gXe()?2:this.O7a()?1===v?e.SessionStatusManager.instance.s5a||f.AFrameworkApplication.X4?8:32:2===v?(this.AOf(),x&&x.FileDownloadUrl&&c.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ch&&(this.pWb=this.Ch.Bc("DialogShown","SaveToOneDriveReponseTime")),this.Ebe.task.continueWith(()=>{this.pWb&&(this.pWb.stop(),this.pWb=null);this.Qwg.start(x)}),32):8:8}}Object(n.a)(t,"SaveToCloudStorageActor",null,[247])},
1052:function(n,C,a){a.d(C,"a",function(){return w});n=a(0);var c=a(15),b=a(84),d=a(1053),f=a(4),e=a(41),k=a(39),l=a(238),m=a(372),u=a(164),t=a(767);class w{constructor(r,v,y,x,B){this.B8=this.Hm=this.UCa=null;this.CDa=!1;this.Mh=this.vga=null;this.ZSc=r;this.Wkb=v;this.Ps=y;this.af=x;this.Ch=B}QMb(){this.af&&1===this.af.state||(this.Hm=this.Wkb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Rb=5,this.Hm.ut=!1,this.Hm.aBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}KIa(){this.Hm&&
(this.Hm.close(),this.Hm=null)}eS(){1!==f.AFrameworkApplication.ta.state&&this.Ps().displayError(d.a.default)}CQa(){c.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");k.a.Ze(this.B8,k.a.cX(3),void 0,"UploadToCloudManager.RedirectToFolder")}BQa(r){let v=!1,y=!1;f.AFrameworkApplication.fa&&(v=f.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),y=f.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));c.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
r,v);if(v&&y){c.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const x={};x[m.a.wQa]="1";x[m.a.documentUrl]=r;f.AFrameworkApplication.XU().execute(B=>{B.Mj(u.a.dua,x)})}else k.a.Ze(r,k.a.cX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}aoa(r,v,y=null,x=null){c.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ch&&(this.vga=this.Ch.Bc("DialogShown","SaveToOneDriveUploadTime"));this.QMb();this.B8=v;this.UCa=this.ZSc.create(r,
y,x);this.Mh=x;this.mQ()}mQ(){c.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.UCa.execute(Object(b.a)(this,this.kRi,"onSaveToCloudUploadFinished"),Object(b.a)(this,this.jRi,"onSaveToCloudUploadFailed"))}kRi(r){this.KIa();this.CDa=!1;if(r&&r.data&&r.data.Xd){var v;if(({fu:v}=e.d(r.data.Xd)).returnValue)if(r=v,r.StatusCode!==l.a.VO&&r.StatusCode!==l.a.Prb)c.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.eS();else{c.ULS.sendTraceTag(6590603,
216,50,"UploadToCloudManager upload success.");try{r.NewDocumentUrl&&""!==r.NewDocumentUrl?this.BQa(r.NewDocumentUrl):this.CQa()}catch(y){c.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",y.toString())}this.FGb()}else c.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:t.a.kfb(r.data.Xd)}),this.eS()}else c.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.eS()}jRi(r){5!==r.data.status&&12!==r.data.status||
this.CDa?(c.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",r.data.status),this.KIa(),this.eS(),this.FGb()):(c.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.CDa=!0,this.mQ())}FGb(){this.vga&&(this.vga.stop(),this.vga=null)}}Object(n.a)(w,"UploadToCloudManager",null,[242])},1053:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.default=0;Object(n.a)(c,"SaveToCloudErrorCodes",null,[])},1054:function(n,C,a){a.d(C,"a",
function(){return e});n=a(0);var c=a(15),b=a(84),d=a(1053),f=a(83);class e{constructor(k,l,m,u,t,w){this.Mh=null;this.Ixg=k;this.T1=l;this.omb=m;this.nb=u;this.cRb=t;this.Ps=w}start(k){this.Mh=k;if("SharePointOnlineConsumer"===this.nb.Xa("FileSource")){const l=f.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(l){l.start(null,k);return}}this.T1.rMa?(c.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.iVg()):(c.ULS.sendTraceTag(6590560,
216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())}showSignInDialog(){this.Ixg.create().fQ()}uj(){this.Ps().displayError(d.a.default)}iVg(){try{c.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.cRb||2===this.cRb)k={["client_id"]:this.nb.appSettings.UploadToSkyDriveClientId};WL.init(k);c.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(b.a)(this,this.onSuccess,"onSuccess"),Object(b.a)(this,this.h6,"onFailure"))}catch(k){c.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",k,k.stack),this.uj()}}onSuccess(k){c.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");k&&k.data&&k.data.folders&&this.omb.aoa(k.data.folders[0].id,k.data.folders[0].urls.viewInBrowser,null,this.Mh)}h6(k){if(k&&
k.error){if("user_canceled"===k.error.code){c.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}c.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",k.error.code,k.error.message)}else c.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.uj()}}Object(n.a)(e,"SaveToCloudManager",null,[246])},1055:function(n,C,a){a.d(C,"a",function(){return f});n=a(0);var c=a(15),b=a(39),d=a(80);a=a(707);class f extends a.a{constructor(e,
k){super(e,k);c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");this.title="";this.message=f.cya;this.gwa=!0}get linkText(){return f.Lpf}gma(e){super.gma(e);b.a.openWindow(4,d.a.AH(f.Kpf))}vD(e){super.vD(e);f.Yvd&&f.Yvd(null)}static initialize(e,k,l,m){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");f.cya=e;f.Lpf=k;f.Kpf=l;f.Yvd=m}}f.cya=null;f.Lpf=null;f.Kpf=null;f.Yvd=null;Object(n.a)(f,"WacGdprNoticeBusinessBarEntry",
a.a,[])},1056:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.Hnh="ewa-bb";c.Jnh="ewa-bb-entry";c.Rnh="ewa-bb-react";c.Knh="ewa-bb-entry-body";c.Qnh="ewa-bb-icon";c.Mnh="ewa-bb-entry-icon";c.Pnh="ewa-bb-entry-title";c.Onh="ewa-bb-entry-message";c.LNe="ewa-bb-entry-button";c.Nnh="ewa-bb-entry-link";c.Lnh="ewa-bb-entry-close";c.MNe="ewa-bb-entry-button-holder";c.Inh="ewa-bb-content";Object(n.a)(c,"CssClassNames",null,[])},1057:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);
a=a(707);class c extends a.a{constructor(b,d){super(b,d);this.ov=!0;this.title=c.gpa;this.message=c.epa}get actionButton(){return c.dpa}Io(b){super.Io(b);(b=c.fpa)&&b(null)}static initialize(b,d,f,e){c.gpa=b;c.epa=d;c.dpa=f;c.fpa=e}}c.gpa=null;c.epa=null;c.dpa=null;c.fpa=null;Object(n.a)(c,"AutomaticSensitivityLabelBusinessBarEntry",a.a,[])},1058:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);a=a(707);class c extends a.a{constructor(b,d){super(b,d);this.ov=!0;this.title=c.gpa;this.message=
c.epa}get actionButton(){return c.dpa}Io(b){super.Io(b);(b=c.fpa)&&b(null)}static initialize(b,d,f,e){c.gpa=b;c.epa=d;c.dpa=f;c.fpa=e}}c.gpa=null;c.epa=null;c.dpa=null;c.fpa=null;Object(n.a)(c,"RecommendedSensitivityLabelBusinessBarEntry",a.a,[])},1059:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);a=a(707);class c extends a.a{constructor(b,d){super(b,d);this.ov=!0;this.title=c.gpa;this.message=c.epa}get actionButton(){return c.dpa}Io(b){super.Io(b);(b=c.fpa)&&b(null)}static initialize(b,
d,f,e){c.gpa=b;c.epa=d;c.dpa=f;c.fpa=e}}c.gpa=null;c.epa=null;c.dpa=null;c.fpa=null;Object(n.a)(c,"MandatorySensitivityLabelBusinessBarEntry",a.a,[])},1060:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);a=a(707);class c extends a.a{constructor(b,d){super(b,d);this.ov=!0;this.title=c.YCb;this.message=c.cya}get actionButton(){return c.S8a}Io(b){super.Io(b);c.eya&&c.eya(null)}static initialize(b,d,f,e){c.YCb=b;c.cya=d;c.S8a=f;c.eya=e}}c.YCb=null;c.cya=null;c.S8a=null;c.eya=null;Object(n.a)(c,
"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",a.a,[])},1061:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);a=a(707);class c extends a.a{constructor(b,d){super(b,d);c.S8a&&c.eya&&(this.ov=!0);this.title=c.YCb;this.message=c.cya}get actionButton(){return c.S8a}Io(b){super.Io(b);c.eya&&c.eya(null)}static initialize(b,d,f,e){c.YCb=b;c.cya=d;c.S8a=f;c.eya=e}}c.YCb=null;c.cya=null;c.S8a=null;c.eya=null;Object(n.a)(c,"SensitivityApplicationSetLabelErrorBusinessBarEntry",a.a,[])},1062:function(n,
C,a){a.d(C,"a",function(){return c});var c;"undefined"==typeof c&&(c={});window.MSOJS=c;c.qgb=function(){function b(){return m()&&(B()||3<=(v()?z("version/"):0))}function d(){return 0<=window.navigator.userAgent.indexOf("Windows")}function f(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function e(){ma||(ma=!0,hb=k("Windows Phone"))}function k(Wa){Wa=(new RegExp(Wa+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Sa=-1;return null!=Wa&&2<=Wa.length&&(Sa=parseFloat(Wa[1]),
isNaN(Sa)&&(Sa=-1)),Sa}function l(){return"function"==typeof navigator.msLaunchUri&&!f()&&!x()&&!u()}function m(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function u(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function t(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function w(){return t()?8==window.document.documentMode:!1}function r(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function v(){return 0<=
window.navigator.userAgent.indexOf(" AppleWebKit/")}function y(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function x(){var Wa=window.navigator.userAgent.toLowerCase();return 0<=Wa.indexOf("android")&&0<=Wa.indexOf("chrome")}function B(){return 3<=(r()?z("firefox/"):0)}function z(Wa){var Sa=window.navigator.userAgent.toLowerCase(),yb=Sa.indexOf(Wa),Ma,Bb;return 0<=yb?(Ma=yb+Wa.length,Bb=Sa.length,parseInt(Sa.substring(Ma,Bb))):0}function A(Wa,Sa,yb,Ma,Bb){if(Ma&&null!=Sa)Sa();
else if(l())navigator.msLaunchUri(Wa,Sa,yb);else if(!(y()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&m())||u())F(Wa,Sa,yb);else if(y()&&Bb)a:{try{window.open(Wa,"_self")}catch(Nb){null!=yb&&yb();break a}null!=Sa&&Sa()}else I(Wa,Sa,yb)}function I(Wa,Sa,yb){var Ma=document.getElementById("OICLinkTag"),Bb;null==Ma&&(Ma=document.createElement("a"),Ma.id="OICLinkTag",Ma.style.visibility="hidden",Ma.href="",Ma.target=0==(Xb.Options&
Va.SupportsTopTargetNavigation)||Xb.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Ma),null!=Ma.addEventListener&&Ma.addEventListener("click",function(Nb){null!=Nb.stopPropagation&&Nb.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Bb=function(Nb){var Ia=document.createEvent("MouseEvent");return Ia.initMouseEvent(Nb,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ia},Bb.prototype=Event.prototype,window.MouseEvent=Bb),Ma.href=Wa,Ma.dispatchEvent(new MouseEvent("click"))}catch(Nb){null!=
yb&&yb();return}null!=Sa&&Sa()}function F(Wa,Sa,yb){var Ma=document.getElementById("OICFrame");null==Ma&&(Ma=document.createElement("iframe"),Ma.className="ObjectInDialog",Ma.style.visibility="hidden",Ma.src="about:blank",document.body.appendChild(Ma),Ma.id="OICFrame");try{Ma.contentWindow.location.href=Wa}catch(Bb){null!=yb&&yb();return}null!=Sa&&Sa()}function U(Wa){return 0!=(Wa.Options&Va.SkipProtocolHandler)||w()}function X(Wa){return Wa===vb.ReadOnly||Wa===vb.ReadWrite}function T(Wa,Sa,yb,Ma){var Bb,
Nb;try{if(Bb=new ActiveXObject(Ra),Bb)return Nb=Bb.ViewDocument3(window.self,Wa,Sa,Ma),Nb?(P(oa.O14ActiveX),db.None):db.Failed}catch(Ia){}if(Va.O14Only===(yb&Va.O14Only))return Xb.DescriptiveUnattemptedEnums?db.O14AttemptFailure:db.Unattempted;try{if(Bb=new ActiveXObject(Da),Bb)return Nb=Bb.ViewDocument3(window.self,Wa,Sa,Ma),Nb?(P(oa.O12ActiveX),db.None):db.Failed}catch(Ia){}if(Va.O12UpOnly===(yb&Va.O12UpOnly))return Xb.DescriptiveUnattemptedEnums?db.O12UpOnlyFail:db.Unattempted;try{if(Bb=new ActiveXObject(Ba),
Bb)return Nb=X(Sa)?Bb.ViewDocument2(window.self,Wa,Ma):Bb.EditDocument2(window.self,Wa,Ma),Nb?(P(oa.O11ActiveX),db.None):db.Failed}catch(Ia){}return Xb.DescriptiveUnattemptedEnums?db.ActiveXUnattempted:db.Unattempted}function G(Wa,Sa,yb,Ma,Bb){var Nb,Ia,jb;Wa==Oa.Visio&&yb==vb.ReadWrite&&(yb=vb.WriteOnly);Wa=Bb;(Ma=Ma||f()&&!(e(),8<=hb))||(Nb="",Nb+=X(yb)?xa+gb:va,Nb+=sa,Wa+=J(Nb));Wa+=J(Sa);Xb.NewTelemetryDataIsEnabled&&(Ia=Xb.SessionOrigin?"|or|"+Xb.SessionOrigin:"",Ia+=Xb.ClickTime?"|ct|"+Xb.ClickTime:
"",Ia+=Xb.CorrelationId?"|cid|"+Xb.CorrelationId:"",Wa+=J(Ia),Xb.CorrelationIdForWinClient&&(Wa+=J(Xb.CorrelationIdForWinClient)));Sa=window.location.href;yb=Ua;Ma=Sa.toLowerCase().indexOf("&"+yb+"=");var Ob;yb=-1==Ma?void 0:(jb=Ma+(yb.length+2),Ob=Sa.indexOf("&",jb),-1==Ob)?Sa.substr(jb):Sa.substring(jb,Ob);if(null!=yb&&"undefined"!=typeof yb){jb="";try{jb=decodeURIComponent(yb)}catch(Jb){}0<jb.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(jb)&&(Wa+=ab,Wa+=jb)}return Wa}
function D(Wa,Sa,yb,Ma,Bb,Nb){var Ia=ta(Wa),jb;return null==Ia?(ka(Xb.DescriptiveUnattemptedEnums?db.ProtocolHandlerIsNull:db.Unattempted,Xb.Application),!1):(jb=G(Wa,Sa,yb,Ma,Ia),A(jb,L,H,Bb,Nb),!0)}function J(Wa){if(m()&&y()){var Sa="";try{Sa=decodeURI(Wa)}catch(yb){}if(Sa==Wa)return encodeURI(Wa)}return Wa}function L(){P(oa.ProtocolHandler)}function H(){Xb.Options|=Va.SkipProtocolHandler;na(Xb,Qb,mb)}function R(){null!=Pb&&Pb(oa.RoamingProtocolHandler)}function Q(){null!=gc&&gc(db.ControlNeeded)}
function O(){var Wa=document.getElementById(ua),Sa;if(null==Wa){if(Sa=ea,m()&&3<=(v()?z("version/"):0)&&V(Y,!0)&&(Sa=Y),!V(Sa,!0))if(m()&&V(ba,!0))Sa=ba;else return null;Wa=document.createElement("object");Wa.id=ua;Wa.type=Sa;Wa.style.width="0px";Wa.style.height="0px";Wa.style.setProperty("visibility","hidden","");document.body.appendChild(Wa);Wa=document.getElementById(ua)}return Wa}function V(Wa,Sa){var yb=window.navigator.mimeTypes,Ma;return null==yb?!1:(Ma=yb[Wa],Ma)?Sa&&!Ma.enabledPlugin?!1:
!0:!1}function W(Wa){try{if(null!=new ActiveXObject(Wa))return!0}catch(Sa){}return!1}function da(Wa){switch(Wa){case Oa.OneNote:return ia;default:return""}}function ta(Wa){if(Wa!=Oa.OneNote&&f()&&!(e(),8<=hb))return"office:";switch(Wa){case Oa.Excel:return"ms-excel:";case Oa.OneNote:return"onenote:";case Oa.PowerPoint:return"ms-powerpoint:";case Oa.Visio:return"ms-visio:";case Oa.Word:return"ms-word:";case Oa.Project:return"ms-project:";case Oa.Publisher:return"ms-publisher:";case Oa.Infopath:return"ms-infopath:";
case Oa.Access:return"ms-access:";default:return""}}function K(Wa){switch(Wa){case Oa.Excel:return"root\\office15\\excel.exe";case Oa.PowerPoint:return"root\\office15\\powerpnt.exe";case Oa.Visio:return"root\\office15\\visio.exe";case Oa.Word:return"root\\office15\\winword.exe";case Oa.Project:return"root\\office15\\winproj.exe";case Oa.Publisher:return"root\\office15\\mspub.exe";case Oa.Infopath:return"root\\office15\\infopath.exe";case Oa.Access:return"root\\office15\\msaccess.exe";default:return null}}
function na(Wa,Sa,yb){if(Xb=Wa,Qb=Sa,mb=yb,Wa.DocumentUrl){var Ma=yb=Sa=Wa.DocumentUrl;try{Ma=decodeURIComponent(Wa.DocumentUrl)}catch(Jb){}try{yb=encodeURI(Wa.DocumentUrl)}catch(Jb){}Xb.NewTelemetryDataIsEnabled||(Sa=Sa+""+Wa.CorrelationIdForWinClient,Ma+=Wa.CorrelationIdForWinClient,yb+=Wa.CorrelationIdForWinClient);Wa.Mode===vb.ReadWrite&&Va.CheckoutRequired===(Wa.Options&Va.CheckoutRequired)&&(Wa.Mode=vb.ForceCheckout);Va.HostIsEditOnly===(Wa.Options&Va.HostIsEditOnly)&&(Wa.Mode=vb.WriteOnly);
if(U(Wa)?0:m()&&(Wa.Application==Oa.OneNote||V(ja,!1)||V(ca,!1))||l()||x()||!(b()||B()||"ActiveXObject"in window&&!f()||y())||15<=pa())D(Wa.Application,Wa.EncodeUrl?yb:Sa,Wa.Mode,Wa.Application==Oa.OneNote,Wa.SilentExternalHandler,Wa.NavigateUsingWindowOpen);else{var Bb;if(Bb=w())a:{var Nb=Wa.EncodeUrl?Sa:Ma,Ia=Wa.Mode,jb=da(Wa.Application);try{Bb=(new ActiveXObject(Z)).ViewDocument3(window.self,Nb,Ia,jb);break a}catch(Jb){}Bb=!1}if(Bb)P(oa.O15ActiveX);else{if(b()||B()){var Ob=Wa.EncodeUrl?Sa:Ma;
Ma=Wa.Mode;Bb=da(Wa.Application);Nb=O();if(null==Nb)Ob=Xb.DescriptiveUnattemptedEnums?db.PluginIsNull:db.Unattempted;else{Ia=!1;try{Ia=Nb.ViewDocument3(window.self,Ob,Ma,Bb)}catch(Jb){}if(!Ia)try{Ia=X(Ma)?Nb.ViewDocument2(window.self,Ob,Bb):Nb.EditDocument2(window.self,Ob,Bb)}catch(Jb){}Ob=Ia?(P(oa.NpapiPlugin),db.None):db.Failed}}else{try{Ob=new ActiveXObject(wa),null!=Ob&&Ob.SaveSSOCreds()}catch(Jb){}Ob=T(Wa.EncodeUrl?Sa:Ma,Wa.Mode,Wa.Options,da(Wa.Application))}if(Ob!=db.None){if(Ma=Wa.CouldUseRoamingApps)Ca||
(Ca=!0,ra=k("Windows NT")),Ma=6.1<=ra&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(t()||B()||y());if(Ma&&Wa.Application!=Oa.OneNote){if(!c.qgb.RYj()){ka(db.ControlNeeded,Xb.Application);return}if(Wa.RoamingAppsLauncher){"undefined"==typeof Wa.RoamingAppsLauncher||null==Wa.RoamingAppsLauncher?ka(Xb.DescriptiveUnattemptedEnums?db.RoamingLauncherIsNull:db.Unattempted,Xb.Application):"undefined"==typeof Wa.RoamingBitsUrl||null==Wa.RoamingBitsUrl?c.qgb.bZj(Wa.DocumentUrl,Wa.RoamingAppsLauncher,
Wa.Application,Wa.ApplicationParameters,Qb,mb):c.qgb.ykg(Wa.DocumentUrl,Wa.RoamingAppsLauncher,Wa.RoamingApplicationExe,Wa.ApplicationParameters,Wa.RoamingPlatform,Wa.RoamingBitsUrl,Qb,mb);return}if(!Wa.ContinueIfLauncherIsNull){ka(db.LauncherNeeded,Xb.Application);return}}Va.NoProtocolHandlerFallback==(Wa.Options&Va.NoProtocolHandlerFallback)||U(Wa)||t()||m()&&!(Xb.DescriptiveUnattemptedEnums?Ob>=db.O14Unattempted&&Ob<=db.DocumentUrlIsNull:Ob==db.Unattempted)?ka(Ob,Xb.Application):D(Wa.Application,
Wa.EncodeUrl?yb:Sa,Wa.Mode,Wa.Application==Oa.OneNote,Wa.SilentExternalHandler,Wa.NavigateUsingWindowOpen)}}}}else ka(Xb.DescriptiveUnattemptedEnums?db.DocumentUrlIsNull:db.Unattempted,Xb.Application)}function P(Wa){null!=Qb&&Qb(Wa)}function ka(Wa,Sa){"undefined"==typeof Sa&&(Sa=null);null!=mb&&mb(Wa,Sa)}function pa(){var Wa=0;if(b()||B()||y()){var Sa=O();try{null!=Sa&&(Wa=Sa.GetOfficeVersion())}catch(yb){}}else W(Z)?Wa=15:W(Ra)?Wa=14:W(Da)?Wa=12:W(Ba)&&(Wa=11);return Wa}function Na(){return m()&&
(V(ea,!0)||V(Y,!0))}var Z="SharePoint.OpenDocuments.5",Ra="SharePoint.OpenDocuments.4",Da="SharePoint.OpenDocuments.3",Ba="SharePoint.OpenDocuments.2",ea="application/x-sharepoint",Y="application/x-sharepoint-webkit",ja="application/x-sharepoint-protocolhandler",ca="application/x-sharepoint-webkit-protocolhandler",ba="application/officelive",ua="npSharePointPlugin",wa="IDBHO.IDBHOCtrl",ia="OneNote.Notebook",xa="ofv|",gb="ofc|",va="ofe|",sa="u|",ab="|f|",Ua="wdlor",nb="",Ha="",sb="",Qb,mb,Pb,gc,Xb,
Ca,ra,ma,hb,vb={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Va={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},db={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
oa={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Oa={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:vb,OpenDocumentOptions:Va,OpenDocumentFailureType:db,OpenDocumentControl:oa,OfficeApplication:Oa,EditDocumentInClient:na,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=Oa.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:pa,
IsO14MacPluginInstalled:Na,OfferOfficeInDialog:function(){return d()&&11>=pa()},OfferOfficeNoIntrusive:function(){return d()&&15>pa()},OfferMacOffice:function(){return m()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Na()},InstallRoamingControl:function(){r()?window.InstallTrigger.install({Office:{URL:Ha}}):F(sb,null,null)},CanUseRoamingControl:function(){var Wa,Sa,yb;if(l())return!0;if(y())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(r())return Wa=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Wa),Sa=document.createEvent("Events"),Sa.initEvent("RoamingOfficeInstalled",!0,!1),Wa.dispatchEvent(Sa),!!Wa.getAttribute("installed");if(t())try{return yb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),yb.HrExists()}catch(Ma){}return!1},InitUrls:function(Wa,Sa,yb){nb=Wa;Ha=yb;sb=Sa},LaunchRoamingApps:function(Wa,Sa,yb,Ma,Bb,Nb){c.qgb.ykg(Wa,Sa,K(yb),Ma,"x86",nb,Bb,Nb)},LaunchRoamingApps2:function(Wa,
Sa,yb,Ma,Bb,Nb,Ia,jb){var Ob="",Jb;if(null!=Ma&&(Ob+=" "+Ma),null!=Wa&&(Ob+=' "'+Wa+'"'),l()||y())Pb=Ia,gc=jb,Ia='office: "'+(Nb+'" "')+(yb+'" "ROAMING"'),Ia+=' "'+Sa+'"',Ia+=' "'+Bb+'"',Ia+=" "+Ob,A(Ia,R,Q,!1,!1);else if(r())Wa=document.createElement("RoamingExtensionElement"),Wa.setAttribute("cabUrl",Nb),Wa.setAttribute("app",yb),Wa.setAttribute("licensingEntitlements",Sa),Wa.setAttribute("platform",Bb),Wa.setAttribute("args",Ob),document.documentElement.appendChild(Wa),Sa=document.createEvent("Events"),
Sa.initEvent("RoamingOfficeLaunch",!0,!1),Wa.dispatchEvent(Sa),null!=Ia&&Ia(oa.RoamingFFExtension);else if(t()){if(Jb=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Jb)try{Jb.HrConfigureSingle(Nb,yb,Sa,Bb,Ob),null!=Ia&&Ia(oa.RoamingActiveX)}catch(Kb){}}else null!=jb&&jb(db.Failed)},ShouldShowDialog:function(){return!f()},NavigateToUrlUsingClickingOnATag:I,OpenDocumentWithProtocolHandler:D,OpenDocumentWithProtocolHandlerNoCallBack:function(Wa,Sa,yb,Ma){var Bb=ta(Wa),Nb;return null==
Bb?(ka(Xb.DescriptiveUnattemptedEnums?db.ProtocolHandlerNoCallbackIsNull:db.Unattempted,Xb.Application),!1):(Nb=G(Wa,Sa,yb,Ma,Bb),A(Nb,null,null,!1,!1),!0)}}}();c.ClientUtils=c.qgb},1063:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(39);class b{constructor(d,f){this._url=d;this.Lug=f}Jte(){}s7c(){this.Lug?c.a.downloadFile(this._url):c.a.Ze(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(n.a)(b,"OpenUrlInTabDialogDownloadBehavior",null,
[292,10])},1064:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi('.HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type="text"]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type="radio"]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type="radio"]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}')}},
1065:function(n,C,a){a.d(C,"a",function(){return e});n=a(0);var c=a(1191),b=a(4),d=a(54),f=a(83);class e{constructor(k,l,m,u,t,w){this.FX=k;this.GX=l;this.oKc=m;this.eE=u;this.uSb=t;this.oVa=w}get R4f(){return!this.GX&&!this.oKc}get zuf(){return 2===this.oVa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get lNe(){return CommonUIStrings.l_OICErrorMessageNoOffice}get t$e(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get lwa(){return CommonUIStrings.l_OICErrorHelpLink}get X8e(){return"OICFailure"}get icon(){return 3}get uYb(){return 2===
this.oVa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get Nl(){return CommonUIStrings.l_DefaultDialogTitle}s5i(k){this.Uuf(k)}qsi(k){this.Uuf(k)}Uuf(k){let l=10;1===k?(f.a.instance.resolve("Common.IOfficeTrialExperience").Qjc(this.oVa),l=3):2===k&&((!this.oKc||this.oKc(this.eE))&&this.GX&&c.a.instance.r9g(this.GX,this.FX,this.eE),l=5);(0===k||1===k)&&this.FX&&this.FX(this.eE);b.AFrameworkApplication.Utc(d.a.wGf,this.uSb,l);this.dispose()}dispose(){this.eE=
this.GX=this.FX=null}}Object(n.a)(e,"AOICErrorDialogWithTrial",null,[10])},1066:function(n,C,a){a.d(C,"a",function(){return e});n=a(0);var c=a(1350),b=a(4),d=a(41),f=a(80);class e{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}XOd(){return d.c([this.Daa(),this])}execute(k,l,m){let u="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(u=f.a.Kl(u,"wdEnableRoaming","1"));b.AFrameworkApplication.yd.Jm(u,2,this.XOd(),
{"Content-Type":"application/json; charset=utf-8"},!1,this.uwb(),k,l,m,void 0,void 0,void 0,void 0,"6")}}Object(n.a)(e,"ARoamingAppsRequest",null,[])},1067:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}")}},
1068:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}')}},
1069:function(n,C,a){a.d(C,"a",function(){return b});var c=a(510);const b=()=>{c.a.Qi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}")}},1075:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(15);class b{constructor(d){this.isEnabled=Boolean.parse(d.DirectPrintIsEnabled||"false");Boolean.parse(d.DirectPrintProbeIsEnabled||"false");this.lji=Boolean.parse(d.DirectPrintEnabledForInternetExplorer||"false");this.ETa=(d.DirectPrintSupportedMimeTypes||
"").split(b.X6c);this.FTa=(d.DirectPrintSupportedPlugins||"").split(b.X6c);this.L8h=(d.DirectPrintImmersivePreviewPlugins||"").split(b.X6c);this.ief=Boolean.parse(d.DirectPrintEnabledForEdge||"false");this.$fi=Boolean.parse(d.ChromePrintLayoutFixIsEnabled||"false");this.FYg=parseInt(d.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Axd=14;this.Qrf=14394;if(d=d.DirectPrintMinimalSupportedEdgeVersion){const f=d.split(".");2===f.length?(this.Axd=parseInt(f[0]),this.Qrf=parseInt(f[1])):c.ULS.sendTraceTag(20734112,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",d)}else c.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}b.X6c=",";Object(n.a)(b,"DirectPrintBrsSettings",null,[])},1076:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.isExportPdfMode=this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=
this.logger=this.printPreviewPaneCallbacks=this.backActionButtonText=null}}Object(n.a)(c,"PrintPreviewPaneProps",null,[])},1077:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.J0i="PrintDialogBody";c.printDialogTitle="PrintDialogTitle";c.B8b="ewa-dlg-elements-container-rtl";c.K0i="PrintDialogLeftContainer";c.L0i="PrintDialogRightContainer";c.Kab="PrintDialogRadioButtonContainer";c.wKf="PrintRadioButtonElementInnerDiv";c.R0i="PrintRadioButtonElementOuterDiv";c.Lab="PrintDialogTitleSection";
c.hGd="PrintDialogComboBoxContainer";c.S0i="PrintRadioButtonIcon";c.I0i="PrintButtonArea";c.Mw="PrintPreviewerContainer";Object(n.a)(c,"CssClassNames",null,[])},1139:function(n,C,a){var c=a(9),b=a(0),d=a(15),f=a(4),e=a(1333),k=a(694),l=a(50),m=a(37),u=a(1),t=a(902),w=a(65),r=a(43),v=a(183),y=a(14),x=a(21),B=a(371),z=a(575),A=a(27),I=a(869),F=a(12);class U extends I.a{constructor(Ub,Fc,$b,zc,Wc,yc=!1){super(Ub,Fc,$b,yc);this.gw=null;this.Um=zc;this.NRb=Wc}get Jd(){return this.NRb}setFocus(){this.gw.checked?
F.DOMElementExtensions.setFocus(this.gw):F.DOMElementExtensions.setFocus(this.getButton(0).get_element())}}U.D5b="printCurrentSelection";Object(b.a)(U,"BasePrintDialog",I.a,[]);var X=a(119),T=a(5),G=a(208),D=a(116),J=a(11),L=a(232),H=a(61);const R=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(1,pd);pd.printOptions=Fc;return H.g(Ub,"ValidatePrint",pd,$b,zc,Wc,yc,0)},Q=(Ub,Fc,$b,zc,Wc,yc,pd,xd=null)=>{xd=Ub.Na(9,xd);xd.sheetName=Fc;xd.printSettings=$b;return H.g(Ub,"SetSheetPrintSettings",xd,zc,Wc,yc,pd,0)},
O=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(1,pd);pd.ConvertInParameters=Fc;return H.g(Ub,"ConvertWorkbookToPrintPdf",pd,$b,zc,Wc,yc,4)},V=(Ub,Fc,$b,zc,Wc,yc,pd,xd=null)=>{xd=Ub.Na(1,xd);xd.sheetName=Fc;xd.printOptions=$b;return H.g(Ub,"SetPrintOptions",xd,zc,Wc,yc,pd,0)},W=(Ub,Fc,$b,zc,Wc,yc,pd,xd=null)=>{xd=Ub.Na(1,xd);xd.sheetName=Fc;xd.locale=$b;return H.g(Ub,"GetPrintSettings",xd,zc,Wc,yc,pd,4)},da=(Ub,Fc,$b,zc,Wc,yc,pd,xd=null)=>{xd=Ub.Na(1,xd);xd.selectedRanges=Fc;xd.addToPrintArea=$b;return H.g(Ub,
"SetPrintArea",xd,zc,Wc,yc,pd,0)},ta=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(1,pd);pd.sheetName=Fc;return H.g(Ub,"ClearPrintArea",pd,$b,zc,Wc,yc,0)},K=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(9,pd);pd.sheetCell=Fc;return H.g(Ub,"InsertPageBreak",pd,$b,zc,Wc,yc,0)},na=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(9,pd);pd.sheetCell=Fc;return H.g(Ub,"RemovePageBreak",pd,$b,zc,Wc,yc,0)},P=(Ub,Fc,$b,zc,Wc,yc,pd=null)=>{pd=Ub.Na(9,pd);pd.sheetName=Fc;return H.g(Ub,"ResetAllPageBreaks",pd,$b,zc,Wc,yc,0)};class ka extends U{constructor(Ub,
Fc,$b,zc,Wc){super(Ub,Fc,$b,zc,Wc);this.vtb=null}get uc(){return"HtmlPrintDialog"}initialize(){d.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.yai();this.jnb(1221);this.addButton(1);super.initialize()}Bsa(){return(Ub,Fc,$b)=>R(this.$.pa.va,this.Um,this.pva(Ub),this.pja(Fc),$b,this.Jd)}commit(){this.c1g();return!0}QK(Ub,Fc,$b){var zc;const Wc=Ub.Result;if(Wc&&Fc){let yc=0,pd=0;(null===(zc=Wc.SelectedRanges)||void 0===zc?0:zc.Ranges)&&0<
Wc.SelectedRanges.Ranges.length&&Wc.SelectedRanges.Ranges[0]&&(yc=Math.min(ka.J2f(Wc.SelectedRanges.Ranges[0]),65535));Wc.UsedRange&&(pd=Math.min(ka.J2f(r.j(r.D(Wc.UsedRange))),65535));L.h(Fc,yc);L.i(Fc,pd)}this.Um=Wc;super.QK(Ub,Fc,$b)}setFocus(){this.vtb.checked?F.DOMElementExtensions.setFocus(this.vtb):super.setFocus()}yai(){this.Pb.innerHTML=ka.N_i(this.$.ea.isNamedObjectViewMode);this.gw=F.DOMElementExtensions.getElementById(this.Pb,U.D5b);this.vtb=F.DOMElementExtensions.getElementById(this.Pb,
"printEntireItem");0!==this.Um.Type&&this.Um.UseSelection?(this.gw.checked=!0,this.vtb.disabled=!this.Um.SheetName):(this.vtb.checked=!0,this.gw.disabled=0===this.Um.Type||!x.g(this.$).ha.sa.Bg)}c1g(){d.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");const Ub=new Sys.StringBuilder;this.dHh(Ub);J.HelperMethods.Ze(Ub.toString(),"",`location=0,scrollbars=1,resizable=1,menubar=1,toolbar=${A.a.Uf?0:1},status=0`,"PrintDialog.PrintViewUrl")||d.ULS.sendTraceTag(51499291,
0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")}dHh(Ub){const Fc=this.$.ya;Ub.append(this.$.Mda+Fc.LayoutsRelativeUri+"/xlprintview.aspx?");G.a.Kg(Ub,T.a.o2i,this.Um.SessionId);G.a.Kg(Ub,T.a.q2i,this.gw.checked?"1":"0");if(0===this.Um.Type)G.a.Kg(Ub,T.a.l2i,this.Um.ObjectId);else{if(!this.Um.UsedRangeTooBig){var $b=r.D(this.Um.UsedRange);($b=r.x($b,this.Um.SheetName))&&G.a.Kg(Ub,T.a.r2i,$b)}1===this.Um.Type?G.a.Kg(Ub,T.a.m2i,this.Um.ObjectId):($b=r.B(this.Um.SelectedRanges.Ranges[0]),
$b=r.x($b,this.Um.SheetName),G.a.Kg(Ub,T.a.n2i,$b))}D.a.NZa(Ub,Fc);G.a.Kg(Ub,T.a.p2i,this.Um.Title)}static N_i(Ub){return String.format("<div class='"+X.a.yo+"'>{0}</div>\r\n\t<div class='"+X.a.A8b+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",y.a.instance.ga(1222),U.D5b,y.a.instance.ga(1225),"printEntireItem",Ub?y.a.instance.ga(1224):y.a.instance.ga(1223))}static J2f(Ub){return(Ub.LastColumn-
Ub.FirstColumn+1)*(Ub.LastRow-Ub.FirstRow+1)}}Object(b.a)(ka,"HtmlPrintDialog",U,[]);var pa=a(173),Na=a(555),Z=a(13),Ra=a(8),Da=a(67),Ba=a(1077),ea=a(769),Y=a(58),ja=a(171),ca=a(292),ba=a(866),ua=a(210),wa=a(727),ia=a(29),xa=a(22),gb=a(281);class va{constructor(Ub,Fc){this.printSettings=this.sheetName=null;this.sheetName=Ub;this.printSettings=Fc}getSheetName(){return this.sheetName}getPrintSettings(){return this.printSettings}}Object(b.a)(va,"MacroRecorderSheetPrintSettingsSavedPayload",null,[115]);
var sa=a(151),ab=a(55);class Ua extends U{constructor(Ub,Fc,$b,zc,Wc,yc,pd,xd){super(Ub,Fc,$b,zc,Wc,u.EwaSettings.ma(395));this.Aec=this.faa=this.Uca=null;this.oUd=!1;this.P5a=this.sAa=this.mza=this.uab=this.Ixa=null;this.Fma=this.Eza=1;this.O_=0;this.G6=1;this.oHb=!1;this.As=null;this.tKb=this.uKb=0;this.selectedRange=this.tAa=this.nza=null;this.P_=0;this.W9a=()=>{this.P_++;this.G6=this.UZc();this.y8c(this.faa.checked?!0:!1);this.w7&&(this.Aec.disabled=this.gw.checked);this.GPd(this.faa.checked?
!0:!1);d.ULS.sendTraceTag(595194762,0,50,`PdfPrintDialog:OnChangeWhatToPrint What to print option changed to ${this.G6.toString()}`);return!0};this.owf=()=>{this.P_++;this.oHb=this.P5a.checked;d.ULS.sendTraceTag(537154311,0,50,`PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to ${this.oHb.toString()}`)};this.hnc=()=>{this.P_++;this.Eza=this.Uwe();d.ULS.sendTraceTag(595079450,0,50,`PdfPrintDialog:OnChangeOrienation orientation option changed to ${this.Eza.toString()}`);return!0};
this.pwf=()=>{this.P_++;const Vb=this.Fma;this.Fma=Ua.paperSizeOptions[this.mza.selectedIndex];d.ULS.sendTraceTag(595079449,0,50,`PdfPrintDialog:OnChangePaperSize paperSize option changed from ${Vb.toString()} to ${this.Fma.toString()}`);return!0};this.qwf=()=>{this.P_++;const Vb=this.O_;this.O_=Ua.scalingOptions[this.sAa.selectedIndex];2===this.O_?(this.uKb=1,this.tKb=0):3===this.O_?(this.uKb=0,this.tKb=1):1===this.O_&&(this.tKb=this.uKb=1);d.ULS.sendTraceTag(595079448,0,50,`PdfPrintDialog:OnChangeScaling scaling option changed from ${Vb.toString()} to ${this.O_.toString()}`);
return!0};this.hBd=Vb=>{let Uc;Vb&&Vb.data&&Vb.data.Xd&&Vb.data.responseHeaders&&Vb.data.Xd.length?(Vb.data.responseHeaders["Content-Type"]&&xa.a.contains(Vb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)?(d.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully"),Uc={},this.LEb(Uc,null,null)):(Uc=Y.a.$h(Vb.data.Xd),d.ULS.sendTraceTag(51676165,0,15,`PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${Uc.Errors[0].MessageId}`)),
Vb=Vb.data.state,Vb.X9c(Uc,Vb.userContext,Vb.methodName)):d.ULS.sendTraceTag(51676163,0,10,`PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : ${Vb?Vb.data?Vb.data.Xd?Vb.data.responseHeaders?Vb.data.Xd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs"}`)};this.gBd=Vb=>{var Uc=D.a.ff(Vb.data);d.ULS.sendTraceTag(51676166,
0,15,`PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [${ia.a.xc(Uc)}]`);Uc=Vb.data.state;Uc.maa(Vb,Uc.userContext,Uc.methodName)};this.LEb=Vb=>{Vb.Errors&&0<Vb.Errors.length?d.ULS.sendTraceTag(51499295,0,50,`PdfPrintDialog: Failed to convert workbook. Error message Id: ${Vb.Errors[0].MessageId}`):(6===this.Jd.Re&&f.AFrameworkApplication.ta.He.Zj(x.g(this.$).LXf),d.ULS.shipAssertTag(537154309,0,!!this.$.xa.oa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),
this.$.xa.oa&&this.Uta.r5f(this.WHa()))};this.Uta=yc;this.activeCell=this.$.oa.activeCell.toString();this.Um.SelectedRanges&&this.Um.SelectedRanges.Ranges&&0<this.Um.SelectedRanges.Ranges.length&&this.Um.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.Um.SelectedRanges.Ranges[0]).toString());this.sheetName=pd;this.vR=xd;this.SDd={};for(let Vb=0,Uc=Ua.paperSizeOptions.length;Vb<Uc;++Vb)this.SDd[Ua.paperSizeOptions[Vb].toString()]=Vb;this.locale=window.navigator.browserLanguage||window.navigator.language||
this.$.ya.UICultureTag;this.w7=u.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog")}get uc(){return"PdfPrintDialog"}initialize(){this.w7&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&Ua.q8g(this.Pb);this.hf?this.BCe(1021,null):(this.Co(),this.jnb(1021));super.initialize()}dispose(){this.DOj();super.dispose()}close(Ub){d.ULS.sendTraceTag(591196544,0,50,`PdfPrintDialog.Close: User changed printSettings ${this.P_} times before exiting dialog ${0===
Ub?"with":"without"} printing done`);this.hkj();if(this.As){const Fc=this.CMh();!this.oUd&&!this.faa.checked&&this.$.isEditMode&&this.Rjd(Fc)&&this.Xjj(Fc)}super.close(Ub)}Bsa(){return(Ub,Fc,$b)=>W(this.$.pa.va,this.$.xa.oa.name,this.locale,this.pva(Ub),this.pja(Fc),$b,null)}QK(Ub,Fc,$b){this.As=Ub.Result;this.uKb=this.As.ScalingWidth;this.tKb=this.As.ScalingHeight;this.Abd();this.fai();super.QK(Ub,Fc,$b)}Co(){d.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");
this.zai();super.Co()}commit(){this.b1g();return!0}setFocus(){this.hf?ua.a.sBc(this.Uca):this.Uca.checked?F.DOMElementExtensions.setFocus(this.Uca):super.setFocus()}Rbi(){switch(this.vR.Ju){case 1:this.Uca.checked=!0;break;case 0:this.gw.disabled?this.Uca.checked=!0:this.gw.checked=!0;break;case 2:this.faa.checked=!0;break;default:d.ULS.sendTraceTag(537154314,0,10,`Invalid what to print state ${this.vR.Ju}. Resetting to defaults.`),this.vR.Ju=1,this.Uca.checked=!0}}hkj(){this.vR.Ju=this.UZc();this.w7&&
(this.vR.ignorePrintArea=this.P5a.checked)}Abd(){if(100!==this.As.ScalingPercent||this.As.FitToPage&&(1<this.As.ScalingWidth||1<this.As.ScalingHeight))this.oUd=!0,this.As.ScalingWidth=Ua.v6c,this.As.ScalingHeight=Ua.u6c,this.As.ScalingPercent=Ua.k6b,this.As.FitToPage=Ua.o6c;this.As.PaperSize.toString()in this.SDd||(this.oUd=!0,this.As.PaperSize=this.As.PaperSize===Ua.OOg?34:Ua.qsb)}fai(){this.Eza=this.As.IsLandscape?2:1;this.O_=this.As.FitToPage?1===this.As.ScalingWidth&&1===this.As.ScalingHeight?
1:this.As.ScalingWidth||1!==this.As.ScalingHeight?2:3:0;this.Fma=this.As.PaperSize;this.y8c(this.faa.checked?!0:!1);this.GPd(this.faa.checked?!0:!1)}Nai(){this.Aec.disabled=this.gw.checked;this.oHb=this.P5a.checked=this.vR.ignorePrintArea}X$g(Ub){this.tAa=document.createElement("select");this.tAa.style.width=224+Da.a.kf;this.tAa.style.height=32+Da.a.kf;this.tAa.setAttribute(T.a.CE,"scalingElementId");this.sAa=new wa.a(this.tAa,!0);for(let Fc=0,$b=Ua.scalingOptions.length;Fc<$b;++Fc){const zc=y.a.instance.ga(Ua.Gkj[Fc]);
this.sAa.hM(zc,Ua.scalingOptions[Fc].toString(),!1)}Ub.appendChild(this.tAa)}OFe(Ub){this.nza=document.createElement("select");this.nza.style.width=224+Da.a.kf;this.nza.style.height=32+Da.a.kf;this.nza.setAttribute(T.a.CE,"paperSizeElementId");this.mza=new wa.a(this.nza,!0);for(let Fc=0,$b=Ua.paperSizeOptions.length;Fc<$b;++Fc){const zc=y.a.instance.ga(Ua.uWi[Fc]);this.mza.hM(zc,Ua.paperSizeOptions[Fc].toString(),!1)}Ub.appendChild(this.nza)}CMh(){const Ub={};Ub.IsLandscape=2===this.Eza;Ub.PaperSize=
this.Fma;Ub.ScalingWidth=this.uKb;Ub.ScalingHeight=this.tKb;Ub.ScalingPercent=100;Ub.FitToPage=0===this.O_?!1:!0;return Ub}WHa(){const Ub=new Sys.StringBuilder;Ub.append(ba.a(this.$,"Pdf",!0));this.Uta.fyc()&&G.a.Kg(Ub,Ra.a.$fg,"1");G.a.Kg(Ub,Ra.a.$Gd,""+this.G6);G.a.Kg(Ub,Ra.a.OLf,this.$.xa.oa.name);0===this.G6&&(G.a.Kg(Ub,Ra.a.NLf,this.selectedRange),G.a.Kg(Ub,Ra.a.HLf,this.activeCell));G.a.Kg(Ub,Ra.a.ILf,""+this.Eza);G.a.Kg(Ub,Ra.a.JLf,""+this.Fma);G.a.Kg(Ub,Ra.a.MLf,""+this.O_);G.a.Kg(Ub,Ra.a.LLf,
"1");G.a.Kg(Ub,Ra.a.GLf,this.oHb?"1":"0");G.a.Kg(Ub,Ra.a.KLf,"1");d.ULS.sendTraceTag(51499296,0,50,`PdfPrintDialog: Print Pdf Url ${Ub.toString()}`);return Ub.toString()}Pyb(){let Ub=null;d.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.Wb(new ja.a(223,0,(Fc,$b,zc)=>{Fc=new ca.a(Fc,null,$b,zc,null,!0,!1,"GetFileCopyFileHandler","");Fc.correlationID=pa.a.create().toString();Ub=Fc;f.AFrameworkApplication.yd.z9(this.WHa(),
1,null,null,Ua.Oad,!1,2,this.hBd,this.gBd,Ub,void 0,void 0,void 0,12E4);return ab.Task.Ta(!0)},16),null)}zai(){d.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.M_i(this.Pb);this.y8c(!0);this.GPd(!0);this.gw=F.DOMElementExtensions.getElementById(this.Pb,U.D5b);this.Uca=F.DOMElementExtensions.getElementById(this.Pb,"printActiveSheet");this.faa=F.DOMElementExtensions.getElementById(this.Pb,"printEntireWorkbook");this.w7&&(this.Aec=F.DOMElementExtensions.getElementById(this.Pb,
"ignorePrintAreaCheckboxButtonId"),this.P5a=new ea.a(this.Aec));this.Kxc()&&(this.gw.disabled=!0,this.Um.SheetName=this.sheetName);this.Rbi();this.w7&&this.Nai();this.H8i()}Kxc(){return!!this.Um.ObjectId||!x.g(this.$).ha.sa.Bg}H8i(){Na.a.instance.ra(Z.a.change,this.Uca,this.W9a);Na.a.instance.ra(Z.a.change,this.faa,this.W9a);Na.a.instance.ra(Z.a.change,this.gw,this.W9a);Na.a.instance.ra(Z.a.change,this.Ixa,this.hnc);Na.a.instance.ra(Z.a.change,this.uab,this.hnc);Na.a.instance.ra(Z.a.change,this.nza,
this.pwf);Na.a.instance.ra(Z.a.change,this.tAa,this.qwf);this.w7&&this.P5a.snb(this.owf)}DOj(){Na.a.instance.Ba(Z.a.change,this.Uca,this.W9a);Na.a.instance.Ba(Z.a.change,this.faa,this.W9a);Na.a.instance.Ba(Z.a.change,this.gw,this.W9a);Na.a.instance.Ba(Z.a.change,this.Ixa,this.hnc);Na.a.instance.Ba(Z.a.change,this.uab,this.hnc);Na.a.instance.Ba(Z.a.change,this.nza,this.pwf);Na.a.instance.Ba(Z.a.change,this.tAa,this.qwf);this.w7&&this.P5a.kda(this.owf)}M_i(Ub){Ub.classList.add(Ba.a.J0i);if(!this.hf){document.getElementById("ewaDialogTitle").classList.add(Ba.a.printDialogTitle);
var Fc=document.getElementById("ewaDialogCloseButtonLink");Fc.style.top=32+Da.a.kf;this.rtl?Fc.style.left=32+Da.a.kf:Fc.style.right=32+Da.a.kf}Fc=Ua.kz(Ba.a.K0i);Ub.appendChild(Fc);var $b=Ua.kz(Ba.a.Lab,1229);$b.style.marginBottom=12+Da.a.kf;$b.id="whatToPrintTitleElementId";Fc.appendChild($b);$b=Ua.kz(Ba.a.Kab);Fc.appendChild($b);Ua.Irb($b,this.rtl,"printActiveSheet",1233,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
Fc.appendChild(document.createElement("BR"));$b=Ua.kz(Ba.a.Kab);Fc.appendChild($b);Ua.Irb($b,this.rtl,"printEntireWorkbook",1226,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");Fc.appendChild(document.createElement("BR"));$b=Ua.kz(Ba.a.Kab);Fc.appendChild($b);Ua.Irb($b,this.rtl,U.D5b,1225,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");
this.w7?($b=Ua.kz(Ba.a.Lab,1258),$b.style.marginTop=24+Da.a.kf,$b.id="printAreaElementId",Fc.appendChild($b),u.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?($b.style.marginBottom=12+Da.a.kf,$b=Ua.kz(X.a.cOe),$b.id="ignorePrintAreaCheckboxWarpperId",F.DOMElementExtensions.setVisible($b,!0),Fc.appendChild($b),Fc=this.getElementById("ignorePrintAreaCheckboxButtonId"),F.DOMElementExtensions.setVisible(Fc,!0),$b.appendChild(Fc),Fc=this.getElementById("ignorePrintAreaCheckboxLabelId"),
F.DOMElementExtensions.setVisible(Fc,!0),$b.appendChild(Fc)):($b=Ua.kz(Ba.a.Kab),Fc.appendChild($b),Ua.k6g($b,this.rtl))):($b=Ua.kz(Ba.a.Lab,1231),$b.style.marginTop=24+Da.a.kf,$b.id="paperSizeElementId",Fc.appendChild($b),$b=Ua.kz(Ba.a.hGd),this.OFe($b),Fc.appendChild($b));Fc=Ua.kz(Ba.a.L0i);Ub.appendChild(Fc);Ub=Ua.kz(Ba.a.Lab,1230);Ub.style.marginBottom=12+Da.a.kf;Ub.id="orientationTitleElementId";Fc.appendChild(Ub);Ub=Ua.kz(Ba.a.Kab);Fc.appendChild(Ub);Ua.Irb(Ub,this.rtl,"portraitRadioButtonId",
1236,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId","orientationTitleElementId");Fc.appendChild(document.createElement("BR"));Ub=Ua.kz(Ba.a.Kab);Fc.appendChild(Ub);Ua.Irb(Ub,this.rtl,"landscapeRadioButtonId",1235,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.w7&&(Ub=Ua.kz(Ba.a.Lab,1231),Ub.style.marginTop=12+Da.a.kf,Ub.id="paperSizeElementId",Fc.appendChild(Ub),Ub=Ua.kz(Ba.a.hGd),this.OFe(Ub),
Fc.appendChild(Ub));Ub=Ua.kz(Ba.a.Lab,1232);Ub.style.marginTop=(this.w7?10:74)+Da.a.kf;Ub.id="scalingElementId";Fc.appendChild(Ub);Ub=Ua.kz(Ba.a.hGd);this.X$g(Ub);Fc.appendChild(Ub);this.hf||document.getElementById("buttonarea").classList.add(Ba.a.I0i);this.Ixa=F.DOMElementExtensions.getElementById(this.Pb,"landscapeRadioButtonId");this.uab=F.DOMElementExtensions.getElementById(this.Pb,"portraitRadioButtonId")}b1g(){d.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");
this.G6=this.UZc();2!==this.G6&&(this.Eza=this.Uwe(),this.mza&&(this.Fma=Ua.paperSizeOptions[this.mza.selectedIndex]),this.sAa&&(this.O_=Ua.scalingOptions[this.sAa.selectedIndex]));if(this.$.DMa&&u.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){const Ub=this.$.pa.va.Tb();this.$.userOperationManager.Wb(new ja.a(133,0,(Fc,$b,zc)=>{const Wc={};Wc.WhatToPrint=this.G6;Wc.UseNamedAction=this.Uta.fyc();Wc.SelectedSheetName=this.$.xa.oa.name;Wc.ActiveCell=
this.activeCell;Wc.SelectedRanges=[this.selectedRange];Wc.IsPdfDocumentRequired=!1;Wc.Orientation=this.Eza;Wc.PaperSize=this.Fma;Wc.Scaling=this.O_;Wc.RichValuesEnabled=!0;this.w7&&(Wc.IgnorePrintArea=this.oHb);return O(this.$.pa.va,Wc,gb.b(this.LEb,Fc),$b,zc,Ub)},16),null)}else this.Pyb()}y8c(Ub){this.uab.disabled=Ub;this.Ixa.disabled=Ub;this.mza.mq.disabled=Ub;this.sAa.mq.disabled=Ub}GPd(Ub){Ub?(this.Ixa.checked=!1,this.uab.checked=!1,this.mza.selectedIndex=-1,this.sAa.selectedIndex=-1):(2===this.Eza?
this.Ixa.checked=!0:this.uab.checked=!0,this.mza.selectedIndex=this.SDd[this.Fma.toString()],this.sAa.selectedIndex=this.O_)}Xjj(Ub){d.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");const Fc=this.$.xa.oa.name,$b=this.$.pa.va.Tb();this.$.userOperationManager.Wb(new ja.a(226,0,(zc,Wc,yc)=>Q(this.$.pa.va,Fc,Ub,zc,Wc,yc,$b),void 0,()=>new va(Fc,Ub)),null)}Rjd(Ub){return this.As.IsLandscape!==Ub.IsLandscape||
this.As.PaperSize!==Ub.PaperSize||this.As.FitToPage!==Ub.FitToPage||this.As.ScalingHeight!==Ub.ScalingHeight||this.As.ScalingWidth!==Ub.ScalingWidth?!0:!1}Uwe(){return this.Ixa&&this.Ixa.checked?2:1}UZc(){return this.gw.checked?0:this.Uca.checked?1:this.faa.checked?2:1}static kz(Ub=null,Fc=0){const $b=document.createElement("div");Ub&&($b.className=Ub);0!==Fc&&($b.innerHTML=y.a.instance.ga(Fc));return $b}static q8g(Ub){var Fc=document.createElement("input");Fc.setAttribute("type","checkbox");Fc.className=
X.a.bOe;Fc.id="ignorePrintAreaCheckboxButtonId";Fc.setAttribute("name","ignorePrintAreaCbName");Fc.style.height=16+Da.a.kf;Fc.style.width=16+Da.a.kf;F.DOMElementExtensions.setVisible(Fc,!1);const $b=y.a.instance.ga(1258),zc=y.a.instance.ga(1259);Fc.setAttribute(T.a.Xt,$b+Da.a.space+zc);Ub.appendChild(Fc);Fc=document.createElement("label");Fc.setAttribute("for","ignorePrintAreaCheckboxButtonId");Fc.id="ignorePrintAreaCheckboxLabelId";Fc.innerHTML=zc;Fc.setAttribute(T.a.yP,"true");Fc.style.position=
"relative";Fc.style.marginLeft=15+Da.a.kf;F.DOMElementExtensions.setVisible(Fc,!1);Ub.appendChild(Fc)}static k6g(Ub,Fc){const $b=document.createElement("input");$b.setAttribute("type","checkbox");$b.id="ignorePrintAreaCheckboxButtonId";$b.setAttribute("name","ignorePrintAreaCbName");$b.setAttribute(T.a.CE,"printAreaElementId"+Da.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");$b.style.height=16+Da.a.kf;$b.style.width=16+Da.a.kf;Fc?$b.style.marginRight=0+Da.a.kf:$b.style.marginLeft=0+Da.a.kf;
Ub.appendChild($b);Fc=document.createElement("label");Fc.setAttribute("for","ignorePrintAreaCheckboxButtonId");Fc.setAttribute(T.a.yP,"true");Fc.style.position="relative";Fc.style.marginLeft=15+Da.a.kf;Ub.appendChild(Fc);Ub=Ua.kz(Ba.a.wKf,1259);Ub.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";Fc.appendChild(Ub)}static Irb(Ub,Fc,$b,zc,Wc,yc,pd,xd){const Vb=document.createElement("input");Vb.setAttribute("type","radio");Vb.id=$b;Vb.setAttribute("name",Wc);Vb.setAttribute(T.a.CE,xd+Da.a.space+
pd);Vb.style.height=16+Da.a.kf;Vb.style.width=16+Da.a.kf;Fc?Vb.style.marginRight=0+Da.a.kf:Vb.style.marginLeft=0+Da.a.kf;Ub.appendChild(Vb);Fc=document.createElement("label");Fc.setAttribute("for",$b);Fc.style.position="relative";Ub.appendChild(Fc);Ub=sa.createClusteredImage(32,32,yc,Ba.a.S0i,!0,y.a.instance.ga(zc));zc=Ua.kz(Ba.a.wKf,zc);zc.id=pd;zc.setAttribute(T.a.yP,"true");pd=Ua.kz(Ba.a.R0i);pd.appendChild(zc);Fc.appendChild(pd);Fc.appendChild(Ub)}}Ua.v6c=1;Ua.u6c=0;Ua.k6b=100;Ua.qsb=9;Ua.o6c=
!0;Ua.OOg=13;Ua.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];Ua.uWi=[1238,1239,1246,1240,1241,1242,1243,1244,1237,1247,1248,1249,1250,1251,1252,1253];Ua.scalingOptions=[0,1,2,3];Ua.Gkj=[1254,1255,1256,1257];Ua.Oad=["Content-Type"];Object(b.a)(Ua,"PdfPrintDialog",U,[]);class nb{constructor(Ub,Fc){this.G6=0;this.o9d=!1;this.Ju=Ub;this.ignorePrintArea=Fc}get Ju(){return this.G6}set Ju(Ub){0<=Ub&&2>=Ub?this.G6=Ub:(d.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),
this.G6=1)}get ignorePrintArea(){return this.o9d}set ignorePrintArea(Ub){Ub||!Ub?this.o9d=Ub:d.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}Object(b.a)(nb,"PdfPrintDialogBrowserSessionState",null,[]);var Ha=a(7),sb=a(134),Qb=a(98),mb=a(1389);class Pb{constructor(Ub,Fc){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=Ub;this.addToPrintArea=Fc}}Object(b.a)(Pb,"MacroRecorderPrintAreaSetPayload",null,[115]);var gc=a(515),Xb=a(370),Ca=a(75);class ra{constructor(Ub){this.sharedSheetCell=
null;this.sharedSheetCell=Ub}}Object(b.a)(ra,"MacroRecorderPageBreakInsertedPayload",null,[115]);class ma{constructor(Ub){this.sharedSheetCell=null;this.sharedSheetCell=Ub}}Object(b.a)(ma,"MacroRecorderPageBreakRemovedPayload",null,[115]);class hb{constructor(Ub){this.sheetName=null;this.sheetName=Ub}getSheetName(){return this.sheetName}}Object(b.a)(hb,"MacroRecorderPageBreaksAllResetPayload",null,[115]);class vb{constructor(Ub){this.sheetName=null;this.sheetName=Ub}getSheetName(){return this.sheetName}}
Object(b.a)(vb,"MacroRecorderPrintAreaClearedPayload",null,[115]);var Va=a(125),db=a(112),oa=a(51),Oa=a(188);class Wa{constructor(){this.Col=this.Row=null}}Object(b.a)(Wa,"PageBreaksInformation",null,[]);class Sa{constructor(){this.Max=this.Min=this.Index=0}}Object(b.a)(Sa,"RowColBreak",null,[]);class yb{constructor(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}}Object(b.a)(yb,"SharedRange",null,[]);var Ma=a(165);class Bb{constructor(Ub){this.ribbonCommandInfo=this.XFb=null;this.lMj=
(Fc,$b,zc)=>{$b=!!Fc&&!!Fc.RequestTelemetryData;x.g(this.$).Pi&&x.g(this.$).Pi.vla(this.dLa.na(this.ribbonCommandInfo.command),Fc.StateId,$b?Fc.RequestTelemetryData.EcsOperationDuration:0,$b?Fc.RequestTelemetryData.EcsRequestDuration:0,$b?Fc.RequestTelemetryData.WfeRequestDuration:0);J.HelperMethods.OZ&&this.KXg(zc)};this.$=Ub;this.dLa=new Ma.a;this.Yva=new Ma.a;this.Yva.add(78661008,12);this.Yva.add(275604654,13);this.Yva.add(-13332329,14);this.Yva.add(-837651977,9);this.Yva.add(-1778266776,10);
this.Yva.add(845325699,11);this.vqd=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}executeCommand(Ub,Fc,$b,zc,Wc=null,yc=null,pd=null){this.rYd();this.ribbonCommandInfo=Fc;this.wEj(Fc.command);Ub=gb.b(Wc,this.lMj);d.ULS.sendTraceTag(543794888,0,50,`PrintCommandHandler.ExecuteCommand: ${Fc.command} command execution started`);switch(Fc.command){case 78661008:return this.o7e(Fc,Ub,yc,pd,!1);case 275604654:return this.o7e(Fc,Ub,yc,pd,!0);case -13332329:return this.o6e(Fc,
Ub,yc,pd);case -837651977:return this.m3h(Fc,Ub,yc,pd);case -1778266776:return this.i4h(Fc,Ub,yc,pd);case 845325699:return this.j7e(Fc,Ub,yc,pd)}return v.a(Fc.command)}Ac(Ub,Fc){switch(Fc.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===Ub;case 845325699:case -13332329:return!0}return!1}f1f(Ub,Fc,$b){const zc=x.g(this.$);var Wc=zc.Ea;const yc=r.r(zc.ha.sa.selectedRanges,this.$);if((Wc=Wc.oF())&&Wc.length){for(const pd of Wc){Wc=pd;const xd=Wc.vf;if(!xd)continue;const Vb=
r.j(Wc.tf),Uc=[];for(const ud of yc.Ranges){if(ud.FirstRow>Vb.LastRow+1||ud.LastRow<Vb.FirstRow||ud.FirstColumn>Vb.LastColumn+1||ud.LastColumn<Vb.FirstColumn)continue;const Vc=this.iVh(Vb,ud,xd),yd=this.hVh(Vb,ud,xd);Uc.push(Object(Ha.a)(new yb,{FirstRow:Vc.FirstRow,FirstColumn:yd.FirstColumn,LastRow:Vc.LastRow,LastColumn:yd.LastColumn}))}0<Uc.length&&!$b?xd.setPrintArea(Uc):0<Uc.length&&$b?xd.addToPrintArea(Uc):!$b&&xd.hasPrintArea()&&xd.clearPrintArea();!xd.isDirty()&&xd.hasPageLayout()&&xd.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+
Wc.Pd,4)}this.JOb(zc,Ub,Fc)}}zZg(Ub,Fc){const $b=x.g(this.$);var zc=x.g(this.$).Ea.oF();if(zc&&zc.length){for(const Wc of zc){zc=Wc;const yc=zc.vf;yc&&(yc.clearPrintArea(),!yc.isDirty()&&yc.hasPageLayout()&&yc.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+zc.Pd,4))}this.JOb($b,Ub,Fc)}}uci(Ub,Fc){const $b=x.g(this.$);var zc=$b.Ea;const Wc=r.o($b.ha.sa.activeCell,this.$);if(Wc){var yc=zc.oF();if(yc&&yc.length){zc=null;for(var pd of yc){let xd=pd,Vb=xd.vf;if(!Vb)continue;let Uc=
r.j(xd.tf);if(!(Wc.FirstRow>Uc.LastRow||Wc.FirstRow<Uc.FirstRow||Wc.FirstColumn>Uc.LastColumn||Wc.FirstColumn<Uc.FirstColumn)&&(zc=this.D9g(Vb,Uc,Wc),Vb.insertPageBreak(zc),!Vb.isDirty()&&Vb.hasPageLayout()&&Vb.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+xd.Pd,4),zc))break}if(!zc)for(const xd of yc)if(zc=xd,pd=zc.vf)zc=r.j(zc.tf),zc=this.NFe(pd,zc,Wc),pd.insertPageBreak(zc);this.JOb($b,Ub,Fc)}}}daj(Ub,Fc){const $b=x.g(this.$);var zc=$b.Ea;const Wc=r.o($b.ha.sa.activeCell,
this.$);if(Wc&&(zc=zc.oF())&&zc.length){for(const pd of zc){zc=pd;const xd=zc.vf;if(xd){var yc=r.j(zc.tf);(yc=this.NFe(xd,yc,Wc))&&xd.removePageBreak(yc);!xd.isDirty()&&xd.hasPageLayout()&&xd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+zc.Pd,4)}}this.JOb($b,Ub,Fc)}}Ufj(Ub,Fc){const $b=x.g(this.$);var zc=$b.Ea.oF();if(zc&&zc.length){for(const Wc of zc){zc=Wc;const yc=zc.vf;yc&&(yc.resetAllPageBreak(),!yc.isDirty()&&yc.hasPageLayout()&&yc.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+
zc.Pd,4))}this.JOb($b,Ub,Fc)}}o7e(Ub,Fc,$b,zc,Wc){if(!Wc){var yc=this.$.Ab.getItemByName("PRINT_AREA");if(yc&&(d.ULS.sendTraceTag(537154306,0,15,`PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : ${yc.type}`),2===yc.type))return this.Zdi(),ab.Task.Ta(!0)}yc=x.g(this.$).ha.sa;const pd=r.r(yc.selectedRanges,this.$);if(1===pd.Ranges.length&&!Wc){if(yc.Hba())return this.y4h(Ub,pd,Fc,$b,zc,Wc),ab.Task.Ta(!0);if(r.R(pd.Ranges[0]))return this.$.xa.oa.hasPrintArea?
this.o6e(Ub,Fc,$b,zc):ab.Task.Ta(!0)}this.f1f(Ub.command,zc,Wc);return this.tcf(Ub,Fc,$b,pd,Wc)}o6e(Ub,Fc,$b,zc){this.zZg(Ub.command,zc);return this.Ldi(Ub,Fc,$b)}m3h(Ub,Fc,$b,zc){this.uci(Ub.command,zc);return this.Wdi(Ub,Fc,$b)}i4h(Ub,Fc,$b,zc){const Wc=r.r(x.g(this.$).ha.sa.selectedRanges,this.$);if(r.R(Wc.Ranges[0]))return this.j7e(Ub,Fc,$b,zc);this.daj(Ub.command,zc);return this.$di(Ub,Fc,$b)}j7e(Ub,Fc,$b,zc){this.Ufj(Ub.command,zc);return this.cei(Ub,Fc,$b)}tcf(Ub,Fc,$b,zc,Wc){const yc=this.$.pa.va,
pd=(Vb,Uc,ud)=>da(yc,zc,Wc,gb.b(Vb,Fc),gb.a(Uc,$b),ud,null),xd=()=>new Pb(zc,Wc);return u.EwaSettings.$b()?Xb.a(this.$.userOperationManager,pd,Vb=>new ja.a(241,0,Vb,64,xd),Ub):Xb.a(this.$.userOperationManager,pd,Vb=>new gc.a(241,0,Vb,void 0,xd),Ub)}Ldi(Ub,Fc,$b){const zc=this.$.xa.oa.name,Wc=this.$.pa.va,yc=(xd,Vb,Uc)=>ta(Wc,zc,gb.b(xd,Fc),gb.a(Vb,$b),Uc,null),pd=()=>new vb(zc);return u.EwaSettings.$b()?Xb.a(this.$.userOperationManager,yc,xd=>new ja.a(243,0,xd,64,pd),Ub):Xb.a(this.$.userOperationManager,
yc,xd=>new gc.a(243,0,xd,void 0,pd),Ub)}Wdi(Ub,Fc,$b){var zc=x.g(this.$);const Wc=r.o(zc.ha.sa.activeCell,this.$);zc=(pd,xd,Vb)=>K(this.$.pa.va,Wc,gb.b(pd,Fc),gb.a(xd,$b),Vb,null);const yc=()=>new ra(Wc);return u.EwaSettings.$b()?Xb.a(this.$.userOperationManager,zc,pd=>new ja.a(244,0,pd,64,yc),Ub):Xb.a(this.$.userOperationManager,zc,pd=>new gc.a(244,0,pd,void 0,yc),Ub)}$di(Ub,Fc,$b){var zc=x.g(this.$);const Wc=r.o(zc.ha.sa.activeCell,this.$);zc=(pd,xd,Vb)=>na(this.$.pa.va,Wc,gb.b(pd,Fc),gb.a(xd,$b),
Vb,null);const yc=()=>new ma(Wc);return u.EwaSettings.$b()?Xb.a(this.$.userOperationManager,zc,pd=>new ja.a(245,0,pd,64,yc),Ub):Xb.a(this.$.userOperationManager,zc,pd=>new gc.a(245,0,pd,void 0,yc),Ub)}cei(Ub,Fc,$b){const zc=this.$.xa.oa.name,Wc=(pd,xd,Vb)=>P(this.$.pa.va,zc,gb.b(pd,Fc),gb.a(xd,$b),Vb,null),yc=()=>new hb(zc);return u.EwaSettings.$b()?Xb.a(this.$.userOperationManager,Wc,pd=>new ja.a(246,0,pd,64,yc),Ub):Xb.a(this.$.userOperationManager,Wc,pd=>new gc.a(246,0,pd,void 0,yc),Ub)}iVh(Ub,
Fc,$b){if(!Ub||!Fc||!$b)return null;const zc=new yb;zc.FirstRow=Fc.FirstRow===Ub.LastRow+1?$b.getRowIndex(Ub.LastRow+1)+1:Fc.FirstRow<Ub.FirstRow?0:$b.getRowIndex(Fc.FirstRow+1);zc.LastRow=Fc.FirstRow===Ub.LastRow+1||Fc.LastRow>Ub.LastRow?$b.getRowIndex(Ub.LastRow+1)+1:$b.getRowIndex(Fc.LastRow+1);return zc}hVh(Ub,Fc,$b){if(!Ub||!Fc||!$b)return null;const zc=new yb;zc.FirstColumn=Fc.FirstColumn===Ub.LastColumn+1?$b.getColumnIndex(Ub.LastColumn+1)+1:Fc.FirstColumn<Ub.FirstColumn?0:$b.getColumnIndex(Fc.FirstColumn+
1);zc.LastColumn=Fc.FirstColumn===Ub.LastColumn+1||Fc.LastColumn>Ub.LastColumn?$b.getColumnIndex(Ub.LastColumn+1)+1:$b.getColumnIndex(Fc.LastColumn+1);return zc}D9g(Ub,Fc,$b){if(!Fc||!$b||!Ub)return null;const zc=Ub.getPrintArea();if(!zc||!zc.length)return null;const Wc=Ub.getRowIndex($b.FirstRow+1),yc=Ub.getColumnIndex($b.FirstColumn+1);let pd=null,xd=null;for(const Vb of zc)if(Wc>=Vb.FirstRow&&Wc<=Vb.LastRow&&yc>=Vb.FirstColumn&&yc<=Vb.LastColumn){if($b.FirstRow===Vb.FirstRow&&$b.FirstColumn===
Vb.FirstColumn)return new Wa;Wc>Vb.FirstRow&&(pd=Object(Ha.a)(new Sa,{Index:Wc-1,Min:Vb.FirstColumn-1,Max:Math.min(Vb.LastColumn,Ub.getColumnIndex(Fc.LastColumn+1))}));yc>Vb.FirstColumn&&(xd=Object(Ha.a)(new Sa,{Index:yc-1,Min:Vb.FirstRow-1,Max:Math.min(Vb.LastRow,Ub.getRowIndex(Fc.LastRow+1))}));break}return pd||xd?Object(Ha.a)(new Wa,{Row:pd?[pd]:null,Col:xd?[xd]:null}):null}T$g(Ub,Fc,$b){if(!Fc||!$b||!Ub)return null;let zc=null;$b.FirstRow>Fc.FirstRow&&$b.FirstRow<=Fc.LastRow?zc=Object(Ha.a)(new Sa,
{Index:Ub.getRowIndex($b.FirstRow+1)-1,Min:-1,Max:-1}):$b.FirstRow===Fc.LastRow+1&&(zc=Object(Ha.a)(new Sa,{Index:Ub.getRowIndex(Fc.LastRow+1),Min:-1,Max:-1}));return zc}q6g(Ub,Fc,$b){if(!Fc||!$b||!Ub)return null;let zc=null;$b.FirstColumn>Fc.FirstColumn&&$b.FirstColumn<=Fc.LastColumn?zc=Object(Ha.a)(new Sa,{Index:Ub.getColumnIndex($b.FirstColumn+1)-1,Min:-1,Max:-1}):$b.FirstColumn===Fc.LastColumn+1&&(zc=Object(Ha.a)(new Sa,{Index:Ub.getColumnIndex(Fc.LastColumn+1),Min:-1,Max:-1}));return zc}NFe(Ub,
Fc,$b){if(!$b||!Ub||!Fc)return null;const zc=this.T$g(Ub,Fc,$b);Ub=this.q6g(Ub,Fc,$b);return zc||Ub?Object(Ha.a)(new Wa,{Row:zc?[zc]:null,Col:Ub?[Ub]:null}):null}Zdi(){const Ub=new sb.StandardDialog;Ub.Rb=0;Ub.rc(1,y.a.instance.ga(4));Ub.Dl(y.a.instance.ga(574),y.a.instance.ga(575),1,null)}wEj(Ub){if(this.Yva.lb(Ub)&&(J.HelperMethods.OZ&&(this.XFb=this.$.Jb.Bc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.dLa.lb(Ub)&&this.dLa.remove(Ub),this.dLa.add(Ub,pa.a.create().toString()),x.g(this.$).Pi)){const Fc=
oa.b()?oa.b().ij(Ub):"";x.g(this.$).Pi.A7(this.Yva.na(Ub),this.dLa.na(Ub),Fc)}}KXg(Ub){if(this.XFb&&Ub){const Fc=this.XFb.yc;this.XFb.stop();this.XFb=null;switch(Ub){case "SetPrintArea":this.gqb(Fc,1700,Ub);break;case "ClearPrintArea":this.gqb(Fc,1500,Ub);break;case "InsertPageBreak":this.gqb(Fc,1500,Ub);break;case "RemovePageBreak":this.gqb(Fc,1600,Ub);break;case "ResetAllPageBreaks":this.gqb(Fc,1700,Ub)}}}gqb(Ub,Fc,$b){Ub>Fc&&(Fc=Object(Ha.a)(new Oa.a,{extendedProperties:new Map}),Fc.extendedProperties.set("OperationName",
$b),Fc.extendedProperties.set("OperationExecutionTime",Ub.toString()),Qb.Health.instance.recordQosError(Va.a.iDj,[db.a.eDj],!1,!0,!0,!1,Fc))}y4h(Ub,Fc,$b,zc,Wc,yc){const pd=new sb.StandardDialog,xd=new mb.a(y.a.instance.ga(572),y.a.instance.ga(573),y.a.instance.ga(6),y.a.instance.ga(5));pd.Rb=1;pd.rc(1,xd.confirmButton);pd.rc(0,xd.cancelButton);pd.Dl(xd.title,xd.body,3,Vb=>{1===Vb&&(this.f1f(Ub.command,Wc,yc),this.tcf(Ub,$b,zc,Fc,yc))})}JOb(Ub,Fc,$b){$b();this.dLa.lb(Fc)&&Ub.Pi.D0(this.dLa.na(Fc),
Ca.BasicTelemetryCalculator.NQ)}rYd(){this.vqd&&this.$.fd(-1753588160,-1,0,null)}}Object(b.a)(Bb,"PrintAreaBreakManager",null,[343]);var Nb=a(382),Ia=a(86);class jb{constructor(){this.margin=this.g0=this.Fca=this.orientation=this.Ju=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.i2a=!1;this.NoColor=null}equals(Ub){return Ub?this.orientation===Ub.orientation&&this.Fca===Ub.Fca&&this.g0===Ub.g0&&this.margin===Ub.margin&&this.sheetPrintOptions===Ub.sheetPrintOptions&&this.i2a===Ub.i2a&&this.NoColor===
Ub.NoColor:!1}static HDe(Ub,Fc){Ub&&Fc&&(Fc.Ju=Ub.Ju,Fc.orientation=Ub.orientation,Fc.Fca=Ub.Fca,Fc.g0=Ub.g0,Fc.margin=Ub.margin,Fc.ignorePrintArea=Ub.ignorePrintArea,Fc.sheetPrintOptions=Ub.sheetPrintOptions,Fc.i2a=Ub.i2a,Fc.NoColor=Ub.NoColor)}}Object(b.a)(jb,"PrintSettingsContainer",null,[]);var Ob=a(153),Jb=a(343),Kb=a(38),Qa=a(765),ha=a(782),qa=a(187),pb=a(641),bb=a(554);class eb{constructor(){this.marginValue=this.printSettingOption=null}}Object(b.a)(eb,"PrintSettingMarginOption",null,[]);class Fa{constructor(){this.footer=
this.header=this.bottom=this.top=this.right=this.left=0}}Object(b.a)(Fa,"PrintSettingMarginValue",null,[]);class tb{constructor(){this.printSettingOptionKey=0;this.printSettingOptionText=null}}Object(b.a)(tb,"PrintSettingOption",null,[]);class dc{constructor(Ub){this.UDi=[.75,.75,.7,.7,.3,.3];this.JCi=[.75,.75,.25,.25,.3,.3];this.yXj=[1,1,1,1,.5,.5];this.ece=this.ahe=this.vee=this.dee=this.Jke=this.E6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Xm=Ub;this.ebi();this.kbi()}get whatToPrintOptions(){return this.Jke}get orientationOptions(){return this.dee}get paperSizeOptions(){return this.vee}get scalingOptions(){return this.ahe}get marginDetailedOptions(){return this.ece}dispose(){}twb(Ub){if(!Ub)return null;
const Fc=new Fa;Fc.left=Ub.Left;Fc.right=Ub.Right;Fc.top=Ub.Top;Fc.bottom=Ub.Bottom;Fc.header=Ub.Header;Fc.footer=Ub.Footer;return Fc}D4c(Ub){d.ULS.shipAssertTag(537154186,0,6===Ub.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");const Fc={};Fc.Top=Ub[0];Fc.Bottom=Ub[1];Fc.Left=Ub[2];Fc.Right=Ub[3];Fc.Header=Ub[4];Fc.Footer=Ub[5];return Fc}kbi(){this.Jke=[Object(Ha.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Xm.ga(1233)}),
Object(Ha.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Xm.ga(1226)}),Object(Ha.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Xm.ga(1225)})];this.dee=[Object(Ha.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Xm.ga(1236)}),Object(Ha.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Xm.ga(1235)})];this.vee=[Object(Ha.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Xm.ga(1238)}),Object(Ha.a)(new tb,{printSettingOptionKey:5,
printSettingOptionText:this.Xm.ga(1239)}),Object(Ha.a)(new tb,{printSettingOptionKey:6,printSettingOptionText:this.Xm.ga(1246)}),Object(Ha.a)(new tb,{printSettingOptionKey:7,printSettingOptionText:this.Xm.ga(1240)}),Object(Ha.a)(new tb,{printSettingOptionKey:8,printSettingOptionText:this.Xm.ga(1241)}),Object(Ha.a)(new tb,{printSettingOptionKey:9,printSettingOptionText:this.Xm.ga(1242)}),Object(Ha.a)(new tb,{printSettingOptionKey:11,printSettingOptionText:this.Xm.ga(1243)}),Object(Ha.a)(new tb,{printSettingOptionKey:12,
printSettingOptionText:this.Xm.ga(1244)}),Object(Ha.a)(new tb,{printSettingOptionKey:13,printSettingOptionText:this.Xm.ga(1245)}),Object(Ha.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.Xm.ga(1237)})];this.ahe=[Object(Ha.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Xm.ga(1254)}),Object(Ha.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Xm.ga(1255)}),Object(Ha.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Xm.ga(1256)}),Object(Ha.a)(new tb,
{printSettingOptionKey:3,printSettingOptionText:this.Xm.ga(1257)})];this.ece=[Object(Ha.a)(new eb,{printSettingOption:Object(Ha.a)(new tb,{printSettingOptionKey:0,printSettingOptionText:this.Xm.ga(1260)}),marginValue:this.twb(this.normal)}),Object(Ha.a)(new eb,{printSettingOption:Object(Ha.a)(new tb,{printSettingOptionKey:1,printSettingOptionText:this.Xm.ga(1261)}),marginValue:this.twb(this.wide)}),Object(Ha.a)(new eb,{printSettingOption:Object(Ha.a)(new tb,{printSettingOptionKey:2,printSettingOptionText:this.Xm.ga(1262)}),
marginValue:this.twb(this.narrow)}),Object(Ha.a)(new eb,{printSettingOption:Object(Ha.a)(new tb,{printSettingOptionKey:3,printSettingOptionText:this.Xm.ga(1263)}),marginValue:this.twb(this.E6)})]}ebi(){this.normal=this.D4c(this.UDi);this.narrow=this.D4c(this.JCi);this.wide=this.D4c(this.yXj)}}dc.$dh=1;dc.Ndh=1;dc.qsb=9;dc.Sdh=2;dc.Ldh=0;dc.Edh=!1;dc.Bdh=!1;dc.wIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(b.a)(dc,"PrintSettingsManagerBase",null,[10]);var jc=a(121),
fb=a(282);class ec{constructor(Ub,Fc){this.sheetPrintOptions=this.sheetName=null;this.sheetName=Ub;this.sheetPrintOptions=Fc}getSheetName(){return this.sheetName}}Object(b.a)(ec,"MacroRecorderSheetPrintOptionsSavedPayload",null,[115]);class lb extends dc{constructor(Ub,Fc,$b,zc,Wc,yc){super(Wc);this.t6f=this.Ad=!1;this.oCd=pd=>{this.HD.oCd(pd)};this.zCd=pd=>{this.HD.zCd(pd)};this.iRi=()=>{d.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
this.hRi=pd=>{pd=D.a.ff(pd.data);d.ULS.sendTraceTag(537154189,0,10,`PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: ${ia.a.xc(pd)}.`)};this.Nz=(pd,xd)=>{2===xd.Vq?this.xv.clear():1===xd.Vq&&this.xv&&this.xv.contains(xd.zf)&&(d.ULS.sendTraceTag(537154188,0,50,`PrintSettingsManager.OnQueueChanged: web method ${jc.a(xd.zf.operation.operationName)} returned, it took ${xd.zf.dequeueUtcTime.getTime()-xd.zf.enqueueUtcTime.getTime()} milliseconds to complete.`),
this.xv.remove(xd.zf))};this.HD=Ub;this.vR=$b;this.$=Fc;this.sheetName=zc;this.locale=window.navigator.browserLanguage||window.navigator.language||this.$.ya.UICultureTag;this.tWi=this.b4g();this.$.userOperationManager.nr(this.Nz);this.xv=new qa.a;this.isUniversalPrintEnabled=yc}Qdi(Ub){this.Rdi(Fc=>{Ub&&(Fc=this.nVh(Fc),Ub(Fc))})}INd(Ub,Fc){if(Ub){var $b=new nb(Ub.Ju,Ub.ignorePrintArea);this.Wjj($b);!Fc||this.t6f?d.ULS.sendTraceTag(593294034,0,50,`PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because ${Fc?
"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"}`):(Fc=this.pVh(Ub.g0),Fc.IsLandscape=2===Ub.orientation,Fc.PaperSize=Ub.Fca,this.isUniversalPrintEnabled&&(Fc.NoColor=Ub.NoColor),Fc.PageMargin=this.ygd(Ub.margin),Fc.SheetPrintOptions=dc.wIa,Fc.SheetPrintOptions.PrintGrid=Ub.sheetPrintOptions.PrintGrid,Fc.SheetPrintOptions.HorizontalCenter=Ub.sheetPrintOptions.HorizontalCenter,Fc.SheetPrintOptions.VerticalCenter=Ub.sheetPrintOptions.VerticalCenter,Fc.SheetPrintOptions.PrintHeaders=
Ub.sheetPrintOptions.PrintHeaders,this.Vjj(Fc))}else d.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")}ygd(Ub){let Fc={};0===Ub?Fc=this.normal:1===Ub?Fc=this.wide:2===Ub?Fc=this.narrow:3===Ub&&(Fc=this.E6);return Fc}gei(Ub){if(Ub){d.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Fc=()=>new ec(this.$.xa.oa.name,Ub),$b=this.$.pa.va,
zc=this.$.pa.va.Tb(),Wc=(yc,pd,xd)=>V($b,this.$.xa.oa.name,Ub,gb.b(this.oCd,yc),gb.a(this.zCd,pd),xd,zc);Fc=u.EwaSettings.$b()?new ja.a(598,0,Wc,64,Fc):new gc.a(598,0,Wc,void 0,Fc);this.$.userOperationManager.Wb(Fc,null)}else d.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")}dispose(){this.Ad||(this.Ad=!0,this.$.userOperationManager.ho(this.Nz),this.RX())}Wjj(Ub){this.vR.Ju=Ub.Ju;this.vR.ignorePrintArea=Ub.ignorePrintArea}Rdi(Ub){const Fc=
yc=>{fb.a(yc)?d.ULS.sendTraceTag(537154196,0,15,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ia.a.xc(yc.Errors)}.`):(d.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),Ub(yc.Result))},$b=yc=>{yc=D.a.ff(yc.data);d.ULS.sendTraceTag(537154194,0,10,`PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: ${ia.a.xc(yc)}.`);Ub(null)},zc=this.$.pa.va.Tb();
var Wc=(yc,pd,xd)=>W(this.$.pa.va,this.sheetName,this.locale,gb.b(yc,Fc),gb.a(pd,$b),xd,zc);Wc=u.EwaSettings.$b()?new ja.a(247,0,Wc,80):new gc.a(247,0,Wc,16);Wc=this.$.userOperationManager.Wb(Wc,null);this.xv.add(Wc)}Vjj(Ub){d.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");const Fc=this.$.pa.va.Tb();this.$.userOperationManager.Wb(new ja.a(226,0,($b,zc,Wc)=>Q(this.$.pa.va,this.sheetName,Ub,gb.b($b,this.iRi),
gb.a(zc,this.hRi),Wc,Fc),void 0,()=>new va(this.sheetName,Ub)),null)}gli(Ub){return this.Odf(Ub)||!this.Tgf(Ub.PaperSize)}Abd(Ub){this.Odf(Ub)&&(d.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),Ub.ScalingWidth=lb.v6c,Ub.ScalingHeight=lb.u6c,Ub.ScalingPercent=lb.k6b,Ub.FitToPage=lb.o6c);this.Tgf(Ub.PaperSize)||(d.ULS.sendTraceTag(537154191,0,15,`PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size ${Ub.PaperSize.toString()} present in file which is unsupported by XLO.`),
Ub.PaperSize=lb.qsb);return Ub}lVh(Ub){if(Ub.FitToPage){if(1===Ub.ScalingWidth&&1===Ub.ScalingHeight)return 1;if(!Ub.ScalingWidth&&1===Ub.ScalingHeight)return 3}else return 0;return 2}kVh(Ub){return this.cqd(Ub,this.normal)?0:this.cqd(Ub,this.wide)?1:this.cqd(Ub,this.narrow)?2:3}cqd(Ub,Fc){return Ub.Left===Fc.Left&&Ub.Right===Fc.Right&&Ub.Top===Fc.Top&&Ub.Bottom===Fc.Bottom&&Ub.Header===Fc.Header&&Ub.Footer===Fc.Footer}pVh(Ub){const Fc={};Fc.ScalingPercent=lb.k6b;Fc.FitToPage=0!==Ub;2===Ub?(Fc.ScalingWidth=
1,Fc.ScalingHeight=0):3===Ub?(Fc.ScalingWidth=0,Fc.ScalingHeight=1):1===Ub&&(Fc.ScalingWidth=1,Fc.ScalingHeight=1);return Fc}Tgf(Ub){return this.tWi.contains(Ub.toString())}Odf(Ub){return 100!==Ub.ScalingPercent||Ub.FitToPage&&(1<Ub.ScalingWidth||1<Ub.ScalingHeight)}b4g(){const Ub=new pb.a(bb.a.Zk());for(let Fc=0;Fc<this.paperSizeOptions.length;Fc++)Ub.add(this.paperSizeOptions[Fc].printSettingOptionKey.toString());return Ub}nVh(Ub){let Fc=null;if(Ub){const $b=this.vR.Ju,zc=this.vR.ignorePrintArea;
this.gli(Ub)&&(this.t6f=!0,Ub=this.Abd(Ub));Fc=new jb;Fc.Ju=$b;Fc.ignorePrintArea=zc;Fc.orientation=Ub.IsLandscape?2:1;Fc.Fca=Ub.PaperSize;Fc.g0=this.lVh(Ub);Fc.sheetPrintOptions=dc.wIa;Fc.sheetPrintOptions.PrintGrid=Ub.SheetPrintOptions.PrintGrid;Fc.i2a=Ub.Draft;this.isUniversalPrintEnabled&&(Fc.NoColor=Ub.NoColor);Fc.sheetPrintOptions.HorizontalCenter=Ub.SheetPrintOptions.HorizontalCenter;Fc.sheetPrintOptions.VerticalCenter=Ub.SheetPrintOptions.VerticalCenter;Fc.sheetPrintOptions.PrintHeaders=Ub.SheetPrintOptions.PrintHeaders;
Fc.margin=this.kVh(Ub.PageMargin);d.ULS.sendTraceTag(553965398,0,50,`PageMargin received : ${Fc.margin}`);3===Fc.margin&&(this.E6={},this.E6.Left=Ub.PageMargin.Left,this.E6.Right=Ub.PageMargin.Right,this.E6.Top=Ub.PageMargin.Top,this.E6.Bottom=Ub.PageMargin.Bottom,this.E6.Header=Ub.PageMargin.Header,this.E6.Footer=Ub.PageMargin.Footer)}return Fc}RX(){if(this.xv){for(let Ub of this.xv)this.$&&this.$.userOperationManager&&(Ub.operation&&d.ULS.sendTraceTag(537154187,0,50,`PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation ${jc.a(Ub.operation.operationName)}.`),
this.$.userOperationManager.Rta(Ub)),this.xv.remove(Ub);this.xv=null}}}lb.v6c=1;lb.u6c=0;lb.k6b=100;lb.qsb=9;lb.o6c=!0;Object(b.a)(lb,"PrintSettingsManager",dc,[]);var ac=a(68);class Gb{constructor(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}}Object(b.a)(Gb,"PrintSettingsTaskPaneCallbacks",null,[]);class wb{constructor(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}}Object(b.a)(wb,"SelectedPrintSettings",null,[]);class qc{constructor(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}}Object(b.a)(qc,"PrintOperationCallbacks",null,[]);class Ya{constructor(){this.onBackToSheet=null}}Object(b.a)(Ya,"PrintPreviewPaneCallbacks",
null,[]);var xb=a(1076);class wc{constructor(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}}Object(b.a)(wc,"UniversalPrintAppSettings",null,[]);var Oc=a(418);class Cb{constructor(Ub,Fc,$b,zc){this.activeCell=this.selectedRange=this.og=this.graphServiceEndpoint=null;this.P_=0;this.Um=this.yv=null;this.IH=new jb;this.Ik=new jb;this.Sba=0;this.j8a=null;this.ENb=!1;this.E3a=this.mGb=null;this.wqd=!1;this.i7a=this.jAb=
!0;this.sma=this.kza=this.KNa=null;this.jzb=!1;this.g8a=null;this.z6a=this.LLc=!1;this.hBd=Wc=>{if(!(Wc&&Wc.data&&Wc.data.Xd&&Wc.data.responseHeaders&&Wc.data.Xd.length)){var yc=Wc?Wc.data?Wc.data.Xd?Wc.data.responseHeaders?Wc.data.Xd.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";this.og&&(Wc=this.ERa(y.a.instance.ga(1214)),
this.$Aa(Wc,0));d.ULS.sendTraceTag(593266765,0,10,`PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : ${yc}`);this.zLd&&(Wc=Object(Ha.a)(new Oa.a,{extendedProperties:new Map}),Wc.extendedProperties.set("InvalidParameterName",yc),Qb.Health.instance.recordQosError(Va.a.qKf,[db.a.rKf],!1,!0,!0,!1,Wc))}else if(0<this.Sba&&Wc.data.id===this.Sba){if(Wc.data.responseHeaders["Content-Type"]&&(xa.a.contains(Wc.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||xa.a.contains(Wc.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){d.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var pd=null;xa.a.contains(Wc.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(pd=this.e6g(Wc));yc={};this.LEb(yc,null,null,pd);Wc.data.responseHeaders["Total-Pdf-PageCount"]?(pd=parseInt(Wc.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),this.jzb||(this.kGd>=pd?this.sma=pd:this.jzb=!0),this.i7a&&this.og&&this.og.setPageRangeSettings(pd,
this.kGd,this.jzb,this.kza,this.sma)):d.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else yc=Y.a.$h(Wc.data.Xd),ia.a.W9(yc.Errors)||ac.a(this.$).kd.gM(yc.Errors[0].MessageId),this.T6i(yc.Errors),this.og&&(pd=this.ERa(yc.Errors[0].Description),-1831476778===yc.Errors[0].MessageId?(d.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),this.$Aa(pd,
0,y.a.instance.ga(1217))):this.$Aa(pd,0)),297284985===yc.Errors[0].MessageId?d.ULS.sendTraceTag(570716892,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: ${yc.Errors[0].MessageId}`):d.ULS.sendTraceTag(593266763,0,15,`PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: ${yc.Errors[0].MessageId}`);Wc=Wc.data.state;Wc.X9c(yc,Wc.userContext,Wc.methodName)}};this.gBd=Wc=>{if(0<this.Sba&&Wc.data.id===this.Sba){var yc=D.a.ff(Wc.data);
this.og&&this.$Aa(this.ERa(yc[0].Description),1);d.ULS.sendTraceTag(593266762,0,15,`PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [${ia.a.xc(yc)}]`);yc=Wc.data.state;yc.maa(Wc,yc.userContext,yc.methodName);this.$.userOperationManager.bla.operation.Cna(()=>this.ENb)}};this.FIi=(Wc,yc,pd)=>{Wc.Errors&&0<Wc.Errors.length&&this.og?(ia.a.W9(Wc.Errors)||ac.a(this.$).kd.gM(Wc.Errors[0].MessageId),this.$Aa(this.ERa(Wc.Errors[0].Description),0),d.ULS.sendTraceTag(537154254,0,50,`PrintPreviewManager: Failed to convert workbook. Error message Id: ${Wc.Errors[0].MessageId}`)):
(d.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),this.LEb(Wc,yc,pd,null))};this.EIi=Wc=>{Wc=D.a.ff(Wc.data);this.og&&this.$Aa(this.ERa(Wc[0].Description),1);d.ULS.sendTraceTag(537154252,0,15,`PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [${ia.a.xc(Wc)}]`);this.$.userOperationManager.bla.operation.Cna(()=>this.ENb)};this.IBf=(Wc,yc)=>{if(yc)switch(yc.O0i){case 1:if(this.Ik&&this.E3a)switch(Wc=this.E3a.yc,
this.E3a.stop(),this.E3a=null,this.Ik.Ju){case 1:this.s0c(Wc,4800,"ActiveSheet");break;case 0:this.s0c(Wc,6100,"CurrentSelection");break;case 2:this.s0c(Wc,7500,"EntireWorkbook")}break;case 0:this.mGb&&(Wc=this.mGb.yc,this.mGb.stop(),2400<Wc&&(yc=Object(Ha.a)(new Oa.a,{extendedProperties:new Map}),yc.extendedProperties.set("PaneLoadTime",Wc.toString()),Qb.Health.instance.recordQosError(Va.a.hDj,[db.a.z6f],!1,!0,!0,!1,yc)),this.yv.Qdi(pd=>{this.lBj(pd)}))}};this.Nz=(Wc,yc)=>{(1===yc.Vq&&this.KNa===
yc.zf||2===yc.Vq)&&this.nMd()};this.$=Ub;this.Uta=Fc;this.W2=$b;this.iEb=zc;this.zLd=J.HelperMethods.OZ;this.Ra=new Kb.a;this.kGd=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.Wyj();this.Oai();this.kfi=this.PXg();this.vqd=u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!zc&&zc.qMa()&&u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.pe.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint;this.isExportPdfMode=!1}get fli(){return this.LLc}WHg(Ub){this.Ra.addHandler("ppocek",Ub)}Kcj(Ub){this.Ra.removeHandler("ppocek",Ub)}kBj(Ub,Fc,$b){this.rgj();this.$.userOperationManager.nr(this.Nz);this.Um=Ub;this.Ra.raiseEvent("ppocek");this.isExportPdfMode=$b;this.Um.SelectedRanges&&this.Um.SelectedRanges.Ranges&&0<this.Um.SelectedRanges.Ranges.length&&this.Um.SelectedRanges.Ranges[0]&&(this.selectedRange=r.B(this.Um.SelectedRanges.Ranges[0]).toString());d.ULS.shipAssertTag(537154268,
0,!this.yv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.yv=new lb(this,this.$,Fc,this.$.xa.oa.name,y.a.instance,this.isUniversalPrintEnabled);d.ULS.shipAssertTag(537154267,0,!this.og,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.og=new ha.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.og.Hhh();this.og.mBj(this.isExportPdfMode);this.og.oHg(this.IBf)}tSh(){this.yv.E6&&4<=this.yv.marginDetailedOptions.length&&
(this.yv.marginDetailedOptions[3].marginValue=this.yv.twb(this.yv.E6));return this.yv.marginDetailedOptions}Kxc(){return!!this.Um&&!!this.Um.ObjectId||!x.g(this.$).ha.sa.Bg}qVh(){const Ub=Object(Ha.a)(new wb,{selectedWhatToPrint:dc.$dh,selectedOrientation:dc.Ndh,selectedPaperSize:dc.qsb,selectedScaling:dc.Sdh,selectedMargin:dc.Ldh,selectedIgnorePrintArea:dc.Edh,selectedPrintGridlines:dc.wIa.PrintGrid,selectedDraft:dc.Bdh,selectedHorizontalCenter:dc.wIa.HorizontalCenter,selectedVerticalCenter:dc.wIa.VerticalCenter,
selectedRowAndColumnHeadings:dc.wIa.PrintHeaders});this.IH?(Ub.selectedWhatToPrint=this.IH.Ju,Ub.selectedOrientation=this.IH.orientation,Ub.selectedPaperSize=this.IH.Fca,Ub.selectedScaling=this.IH.g0,Ub.selectedMargin=this.IH.margin,Ub.selectedIgnorePrintArea=this.IH.ignorePrintArea,Ub.selectedPrintGridlines=this.IH.sheetPrintOptions.PrintGrid,Ub.selectedDraft=this.IH.i2a,this.isUniversalPrintEnabled&&(Ub.selectedColor=this.IH.NoColor?0:1),Ub.selectedHorizontalCenter=this.IH.sheetPrintOptions.HorizontalCenter,
Ub.selectedVerticalCenter=this.IH.sheetPrintOptions.VerticalCenter,Ub.selectedRowAndColumnHeadings=this.IH.sheetPrintOptions.PrintHeaders):d.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return Ub}q2e(){return Object(Ha.a)(new Ya,{onBackToSheet:()=>{this.Vla()}})}mVh(){return Object(Ha.a)(new xb.a,{backActionButtonText:y.a.instance.ga(1213),printPreviewPaneCallbacks:this.q2e(),logger:new Nb.a,disableTellMeControl:!0,isExportPdfMode:this.isExportPdfMode,
printOperationCallbacks:Object(Ha.a)(new qc,{onClosePreviewer:()=>{this.Vla()},getGraphServiceAuthorizationToken:this.kac(),onLocalPrint:()=>{this.tCf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object(Ha.a)(new wc,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.rfi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})}oVh(){return Object(Ha.a)(new Gb,{onSettingChange:Ub=>{this.$Pi(Ub)},
onPrint:()=>{this.tCf()}})}$Pi(Ub){this.P_++;Ub?(this.og&&this.og.bCj(),this.Ik.Ju=Ub.selectedWhatToPrint,this.Ik.g0=Ub.selectedScaling,this.Ik.orientation=Ub.selectedOrientation,this.Ik.Fca=Ub.selectedPaperSize,this.Ik.margin=Ub.selectedMargin,this.isUniversalPrintEnabled&&(this.Ik.NoColor=!Ub.selectedColor),this.Ik.ignorePrintArea=Ub.selectedIgnorePrintArea,this.$rj(Ub.selectedPageStart,Ub.selectedPageEnd),this.yv&&this.H5h(this.Ik,Ub)?(this.Ik.sheetPrintOptions=dc.wIa,this.Ik.sheetPrintOptions.PrintGrid=
Ub.selectedPrintGridlines,this.Ik.sheetPrintOptions.HorizontalCenter=Ub.selectedHorizontalCenter,this.Ik.sheetPrintOptions.VerticalCenter=Ub.selectedVerticalCenter,this.Ik.sheetPrintOptions.PrintHeaders=Ub.selectedRowAndColumnHeadings,this.yv.gei(this.Ik.sheetPrintOptions)):this.Pyb()):d.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")}Vla(){this.z6a&&(this.ENb=!0);d.ULS.sendTraceTag(591196513,0,50,`PrintPreviewManager.OnCloseButtonClick: User changed printSettings ${this.P_} times before clicking on backToWorkbook icon`);
this.sCf();this.Gze()}tCf(){d.ULS.sendTraceTag(591196512,0,50,`PrintPreviewManager.OnPrintButtonClick: User changed printSettings ${this.P_} times before clicking on print button.`);d.ULS.sendTraceTag(543024129,0,50,`PrintPreviewManager.OnPrintButtonClick: Current margin value : ${this.Ik.margin}, Initial margin value : ${this.IH.margin}`);if(this.useMSPdfViewer)this.sKf();else if(this.i7a)try{this.og.printPdf(),this.A1c()}catch(Ub){d.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),
this.sKf()}else this.Uta.r5f(this.WHa(!0)),this.A1c()}sKf(){const Ub=this.WHa(!0);this.A1c();J.HelperMethods.Ze(Ub,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")}dispose(){Ia.a.Ia(this.Ra)}Pyb(){if(this.$.DMa)this.Ndi();else{this.RX();this.vVf();var Ub=null;this.Dai();d.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Fc=($b,zc,Wc)=>{$b=new ca.a($b,null,zc,Wc,null,!0,!1,"GetFileCopyFileHandler","");$b.correlationID=
pa.a.create().toString();Ub=$b;this.Sba=this.W2.z9(this.WHa(this.i7a?!1:!0,this.kfi?"Base64":"Pdf"),1,null,null,Cb.Oad,!1,2,this.hBd,this.gBd,Ub,void 0,void 0,void 0,12E4);$b.requestId=this.Sba;d.ULS.sendTraceTag(537154264,0,50,`PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: ${this.Sba}.`);return ab.Task.Ta(!0)};this.KNa=u.EwaSettings.$b()?this.$.userOperationManager.Wb(new ja.a(223,0,Fc,80),null):this.$.userOperationManager.Wb(new gc.a(223,0,Fc,16),null)}}A1c(){this.sCf();
this.Gze()}oCd(Ub){ia.a.Dq(Ub.Errors)?this.og.showErrorMessageForPrintOptions(y.a.instance.ga(1264)):(d.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Pyb(),this.og&&this.og.hideErrorMessageForPrintOptions())}zCd(Ub){this.og&&this.og.showErrorMessageForPrintOptions(y.a.instance.ga(1264));Ub=D.a.ff(Ub.data);d.ULS.sendTraceTag(537154262,0,10,`PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: ${ia.a.xc(Ub)}.`)}Ndi(){d.ULS.sendTraceTag(553649883,
0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.RX();const Ub=this.$.pa.va.Tb(),Fc=($b,zc,Wc)=>{const yc={};yc.WhatToPrint=this.Ik.Ju;yc.UseNamedAction=this.Uta.fyc();yc.SelectedSheetName=this.$.xa.oa.name;yc.ActiveCell=this.activeCell;yc.SelectedRanges=[this.selectedRange];yc.IsPdfDocumentRequired=!1;yc.Orientation=this.Ik.orientation;yc.PaperSize=this.Ik.Fca;yc.Scaling=this.Ik.g0;yc.RichValuesEnabled=!0;yc.IgnorePrintArea=this.Ik.ignorePrintArea;
yc.Preview=!0;this.isUniversalPrintEnabled&&(yc.NoColor=this.Ik.NoColor);this.Z2f()&&(yc.PaginationStartPage=this.kza,yc.PaginationEndPage=this.sma,yc.OutputTotalPdfPageCount=!0);const pd=this.yv.ygd(this.Ik.margin);pd&&(yc.PageMargin={},yc.PageMargin.Top=pd.Top,yc.PageMargin.Bottom=pd.Bottom,yc.PageMargin.Left=pd.Left,yc.PageMargin.Right=pd.Right,yc.PageMargin.Header=pd.Header,yc.PageMargin.Footer=pd.Footer);return this.j8a=O(this.$.pa.va,yc,gb.b(this.FIi,$b),gb.a(this.EIi,zc),Wc,Ub)};u.EwaSettings.$b()?
this.KNa=this.$.userOperationManager.Wb(new ja.a(133,0,Fc,80),null):this.KNa=this.$.userOperationManager.Wb(new gc.a(133,0,Fc,16),null)}Gze(){this.$.userOperationManager.ho(this.Nz);this.RX();this.vVf();d.ULS.shipAssertTag(537154261,0,!!this.og,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.isExportPdfMode=!1;this.og&&(this.og.ncj(this.IBf),this.og.Qhh(),this.og=null);this.Um=null;this.yv&&(this.yv.dispose(),this.yv=null);this.E3a=this.mGb=null;this.LLc=
!1;this.Ra&&this.Ra.raiseEvent("ppocek")}Uwj(){return this.$.isEditMode&&!!this.IH&&!!this.Ik&&2!==this.Ik.Ju&&this.Rjd()}INd(){d.ULS.shipAssertTag(537154260,0,!!this.yv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.yv&&this.yv.INd(this.Ik,this.Uwj())}WHa(Ub,Fc="Pdf"){const $b=new Sys.StringBuilder;$b.append(ba.a(this.$,Fc,!0));G.a.Kg($b,Ra.a.$Gd,""+this.Ik.Ju);Ub&&this.Uta.fyc()&&G.a.Kg($b,Ra.a.$fg,"1");G.a.Kg($b,Ra.a.OLf,this.$.xa.oa.name);0===this.Ik.Ju&&
(G.a.Kg($b,Ra.a.NLf,this.selectedRange),G.a.Kg($b,Ra.a.HLf,this.activeCell));G.a.Kg($b,Ra.a.ILf,""+this.Ik.orientation);G.a.Kg($b,Ra.a.JLf,""+this.Ik.Fca);G.a.Kg($b,Ra.a.MLf,""+this.Ik.g0);G.a.Kg($b,Ra.a.LLf,"1");G.a.Kg($b,Ra.a.GLf,this.Ik.ignorePrintArea?"1":"0");G.a.Kg($b,Ra.a.KLf,"1");this.DLg($b);this.isUniversalPrintEnabled&&G.a.Kg($b,Ra.a.P2i,this.Ik.NoColor?"1":"0");this.CLg($b);xa.a.equals(Fc,"Pdf",!0)&&($b.append("&#toolbar=0"),$b.append("&zoom=100"));Ub=$b.toString().replace("GetFileCopyFileHandler.aspx?",
"GetFileCopyFileHandler.aspx/?");d.ULS.sendTraceTag(537154259,0,50,`PrintPreviewManager: Print Pdf Url ${Ub}`);return Ub}$rj(Ub,Fc){Ub||Fc?(this.jzb=!0,this.kza=Ub,this.sma=Fc):this.HUf()}DLg(Ub){this.Z2f()&&(G.a.Kg(Ub,Ra.a.R2i,""+this.kza),G.a.Kg(Ub,Ra.a.Q2i,""+this.sma),G.a.Kg(Ub,Ra.a.S2i,"1"),d.ULS.sendTraceTag(537154258,0,50,`PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from ${this.kza} to ${this.sma}`))}Z2f(){return null!=this.kza&&0<this.kza&&null!=this.sma&&0<this.sma}CLg(Ub){if(this.yv&&
this.Ik){const Fc=this.yv.ygd(this.Ik.margin);Fc&&G.a.Kg(Ub,Ra.a.O2i,""+Fc.Top+" "+Fc.Bottom+" "+Fc.Left+" "+Fc.Right+" "+Fc.Header+" "+Fc.Footer)}}LEb(Ub,Fc,$b,zc){this.og&&(d.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.oa&&(this.i7a?(zc||(zc=this.WHa(!1)),this.og.tti(zc)):this.fBj()))}Rjd(){return!this.IH.equals(this.Ik)}sCf(){!this.ENb&&0<this.P_&&(this.wqd?this.INd():d.ULS.sendTraceTag(537154251,
0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));d.ULS.shipAssertTag(537154250,0,!!this.og,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.og&&this.og.S6h();this.rYd()}uj(){d.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.og){var Ub=this.ERa(y.a.instance.ga(1));this.$Aa(Ub,1)}else Ub=ia.a.Yc(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),u.EwaSettings.Dz()?
new Jb.a(this.$,Ub):(new Ob.ErrorDialog(this.$,Ub)).ig()}lBj(Ub){Ub?(0===Ub.Ju&&this.Kxc()&&(d.ULS.sendTraceTag(537154249,0,50,`PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a $${this.Um.ObjectId?"floatingObject":"discontinuousRange"}.`),Ub.Ju=1),jb.HDe(Ub,this.IH),jb.HDe(Ub,this.Ik),d.ULS.shipAssertTag(537154248,0,!!this.og,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.og&&(this.wqd=!0,this.og.nBj(),this.Pyb())):
(d.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.uj())}s0c(Ub,Fc,$b){Ub>Fc&&(Fc=Object(Ha.a)(new Oa.a,{extendedProperties:new Map}),Fc.extendedProperties.set("WtpSelectedValue",$b),Fc.extendedProperties.set("FullyRenderedPdfLoadTime",Ub.toString()),Qb.Health.instance.recordQosError(Va.a.gDj,[db.a.z6f],!1,!0,!0,!1,Fc))}RX(){this.KNa&&(0<this.Sba||this.j8a)&&(d.ULS.sendTraceTag(537154246,0,50,`PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: ${this.Sba}.`),
this.$.userOperationManager.Rta(this.KNa),this.j8a?D.a.Du(this.j8a.Yt):this.W2.Du(this.Sba),this.nMd())}nMd(){this.j8a=this.KNa=null}Dai(){this.zLd&&this.Ik&&(this.E3a=this.$.Jb.Bc("UserAction",(1===this.Ik.Ju?"ActiveSheet":0===this.Ik.Ju?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))}HUf(){this.jzb=!1;this.kza=1;this.sma=this.kGd}ERa(Ub){if(Ub)return Ub.replace("&#39;","'");d.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");
return Ub}fBj(){d.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.jAb)d.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{let Ub=this.ERa(y.a.instance.ga(1219));this.$Aa(Ub,3)}}$Aa(Ub,Fc,$b=null){this.og.bA(Ub,Fc,$b)}Oai(){this.i7a=this.jAb=!0;d.ULS.sendTraceTag(557061534,0,50,`PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentHost: ${this.jAb}, isPdfPreviewSupportedInPreviewer: ${this.i7a}`)}rgj(){this.g8a=
null;this.nMd();this.HUf();this.mGb=this.$.Jb.Bc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.P_=0;this.wqd=this.z6a=this.ENb=!1;this.LLc=!0}Wyj(){const Ub=this.Tni()||this.foi();d.ULS.sendTraceTag(537154242,0,50,`PrintPreviewManager.ShouldUseMSPdfViewer : ${Ub}`);return Ub}PXg(){let Ub=15;A.a.PH&&A.a.dtb&&(Ub=parseFloat(A.a.dtb));return 14<Ub&&this.jAb}Tni(){var Ub;if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ModifyTeamsHostCheck",!1)){const Fc=
"teams"===(null===(Ub=f.AFrameworkApplication.fa.appSettings[f.AFrameworkApplication.R7])||void 0===Ub?void 0:Ub.toLowerCase());d.ULS.sendTraceTag(512350017,0,50,`PrintPreviewManager:isTeamsHost - isElectron: ${A.a.xz} isTeamsUIHost: ${Fc} isUnifiedHostMode: ${f.AFrameworkApplication.isUnifiedHostMode}`);return A.a.xz||Fc}return A.a.xz||f.AFrameworkApplication.isUnifiedHostMode}foi(){return!this.$.pe.get(111)}vVf(){this.g8a&&(URL.revokeObjectURL(this.g8a),this.g8a=null)}e6g(Ub){var Fc=Ub.data.Xd;
Ub=this.$.Jb.Bc("UserAction","PrintPreviewBlobFileCreation");var $b=window.self.atob(Fc);Fc=new Uint8Array(Fc.length);for(let zc=0;zc<$b.length;zc++)Fc[zc]=$b.charCodeAt(zc)&255;$b=new Blob([Fc],{type:"application/pdf"});this.g8a=URL.createObjectURL($b);d.ULS.sendTraceTag(537154241,0,50,`PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : ${Ub.yc} ms. Blob size: ${$b.size}`);Ub.stop();return this.g8a+"#toolbar=0&zoom=100"}T6i(Ub){if(this.zLd&&ia.a.lh(Ub,Cb.HXi)){const Fc=
Object(Ha.a)(new Oa.a,{extendedProperties:new Map});Fc.extendedProperties.set("ErrorMessageIdName",Ub[0].MessageIdName);Qb.Health.instance.recordQosError(Va.a.qKf,[db.a.rKf],!1,!0,!0,!1,Fc)}}H5h(Ub,Fc){return Ub.sheetPrintOptions.PrintGrid!==Fc.selectedPrintGridlines||Ub.sheetPrintOptions.HorizontalCenter!==Fc.selectedHorizontalCenter||Ub.sheetPrintOptions.VerticalCenter!==Fc.selectedVerticalCenter||Ub.sheetPrintOptions.PrintHeaders!==Fc.selectedRowAndColumnHeadings}rYd(){this.vqd&&this.$.fd(-1753588160,
-1,0,null)}rfi(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier}getToken(){d.ULS.sendTraceTag(522314589,0,50,"PrintPreviewManager:GetToken: Token requested for universal print graph service");return this.iEb.CL("Print",this.graphServiceEndpoint).then(Ub=>Ub?(Ub.IsSuccess?d.ULS.sendTraceTag(522314588,0,50,"PrintPreviewManager:GetToken: successfully acquired token for universal print graph service"):d.ULS.sendTraceTag(537154240,0,15,`PrintPreviewManager:GetToken: failed to get token. Error code: ${Ub.ErrorCode}, Error message : ${Ub.ErrorMessage}`),
Ub):Object(Ha.a)(new Qa.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})).catch(Ub=>{let Fc=new Qa.a;Object.getType(Ub)===Object.getType(Fc)?Fc=Ub:(Fc.ErrorMessage=Ub.toString(),Fc.ErrorCode="exception");return Promise.resolve(Fc)})}kac(){return()=>{const Ub=Promise.resolve("");try{if(this.iEb&&this.iEb.qMa())return this.getToken().then(Fc=>Fc.IsSuccess?Promise.resolve(Fc.Token):Ub,()=>Ub)}catch(Fc){d.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token")}return Ub}}onNotifyPrintJobStatus(Ub,
Fc){Ub=Oc.a.pC.notificationBar.k3(Ub,!1);"pending"==Fc&&(Ub.displayTimeoutSeconds=3);if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactToast",!1))switch(Fc){case "failure":Ub.image=1;break;case "success":Ub.image=3;break;default:Ub.image=0}else Ub.image=0;Oc.a.pC.notificationBar.qC(Ub)}}Cb.HXi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];Cb.Oad=["Content-Type","Total-Pdf-PageCount"];
Object(b.a)(Cb,"PrintPreviewManager",null,[340,10,341]);class Ib{constructor(Ub,Fc,$b){this.ignorePrintArea=!1;this.fMj=()=>{const zc=x.g(this.$).Ea;this.oRc=!0;zc.xzd()};this.EPi=()=>{this.fjd()};this.DPi=(zc,Wc,yc)=>{d.ULS.sendTraceTag(537154272,0,10,`PrintCommandHandler:OnPageLayoutCommandFailure Method : ${yc} failed to execute`);this.fjd()};this.$=Ub;this.ea=Ub.ea;this.Uta=Fc;this.vR=new nb(1,this.ignorePrintArea);this.HD=Fc=new Cb(Ub,Fc,f.AFrameworkApplication.yd,$b);this.$.da.Ga(418,Fc);this.oKf=
new Bb(Ub);this.$.da.Ga(384,this);this.oRc=!1}get f3f(){return this.oRc}Lc(){return!1}executeCommand(Ub,Fc,$b,zc){const Wc=Fc.command;return 1588554917===Wc||1531172830===Wc||-2050819419===Wc?(Fc.uzb=!0,B.a(this.$)&&this.$.da.za(423).wyc(!1),this.qih(Fc)?ab.Task.Ta(!0):v.a(Wc)):this.oKf.executeCommand(Ub,Fc,$b,zc,this.EPi,this.DPi,this.fMj)}Ac(Ub,Fc){switch(Fc.command){case 1588554917:return d.ULS.shipAssertTag(537154305,0,this.$.wka,"Command execute requested for Print operation when data duplication is disallowed."),
!0;case 1531172830:return u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExportToPdf",!1)&&u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);case -2050819419:return u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SaveAsPDF",!1)&&u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1);default:return this.oKf.Ac(Ub,Fc)}}Oc(){return!1}qih(Ub){return this.$.ea.fc?this.rih(Ub):!1}rih(Ub){d.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");
const Fc=this.$.Jb.Bc("UserAction","DoPrintHtml");var $b=this.$,zc=this.ea.isNamedObjectViewMode;const Wc=!zc;$b=this.jVh($b,this.ea.isNamedObjectViewMode?$b.Ab.oa.sheetName:$b.xa.oa.name,Wc);Wc?z.a(this.$)?d.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(zc=1531172830===Ub.command||-2050819419===Ub.command,this.HD.kBj($b,this.vR,zc),d.ULS.sendTraceTag(591196515,0,50,`PrintCommandHandler:DoPrintHtml Print previewer opened. isExportPdfMode: ${zc} Command: ${t.a[Ub.command]}`)):
((new ka(this.$,y.a.instance.ga(1227),3,$b,Ub)).ig(),d.ULS.sendTraceTag(591196514,0,15,`PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in ${Fc.yc} ms. isNamedObjectViewMode: ${zc}.`));Fc.stop();this.fjd();return!0}jVh(Ub,Fc,$b){const zc={};zc.SessionId=this.ea.sessionId;zc.UsedRangeTooBig=!1;var Wc=x.g(Ub);const yc=Wc.ha,pd=yc.Me;if(w.e(Ub.oa))zc.Type=0,zc.ObjectId=Ub.oa.name,zc.UseSelection=!1;else if(w.g(Ub.oa))zc.Type=1,zc.ObjectId=Ub.oa.WLa,zc.UseSelection=!0;else if(2===pd||
4===pd||64===pd)Wc=yc.Qa.dc.floatingObject,zc.Type=1,zc.SheetName=Fc,zc.ObjectId=Wc.id,zc.UseSelection=!0;else if($b&&pd&470)zc.ObjectId=yc.Qa.dc.floatingObject.id,zc.SheetName=Fc;else if(w.i(Ub.oa)){zc.Type=2;zc.SheetName=Fc;if(yc.sa.Bg)if($b=yc.sa.Xc,zc.SelectedRanges=r.q($b,Ub),20<$b.dH)zc.UseSelection=!0;else{Fc=0;Wc=Wc.uk("PrintCommandHandler.DoPrintHtml",$b);try{for(Wc.$$rst();Wc.$$mn()&&2>Fc;)Wc.$$cu().text&&Fc++;zc.UseSelection=2<=Fc}finally{Wc&&Wc.dispose()}}else zc.UseSelection=!1,zc.SelectedRanges=
r.q(yc.sa.activeRange,Ub);this.ea.isNamedObjectViewMode&&(zc.UsedRange=r.v(Ub.oa.usedRange,Ub))}zc.Title=Ub.workbookContext.WorkbookFileName;return zc}fjd(){x.g(this.$);if(!this.f3f){this.oRc=!0;const Ub=this.$.Jb.Bc("UserAction","HandlePageLayoutRendering");this.tMj();d.ULS.sendTraceTag(537154274,0,50,`PrintCommandHandler:HandlePageLayoutRendering rendering is done in ${Ub.yc} ms.`);Ub.stop()}}tMj(){const Ub=x.g(this.$).Ea,Fc=Ub.oF();let $b=!1,zc=0;for(let Wc=0;Wc<Fc.length;Wc++){const yc=Fc[Wc],
pd=yc.vf;pd&&pd.hasPageLayout()&&($b=!0,pd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+yc.Pd,4),zc++)}$b&&(d.ULS.sendTraceTag(537154273,0,50,`PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is ${Fc.length}, number of blocks that require re-rendering is ${zc}`),Ub.xzd())}}Object(b.a)(Ib,"PrintCommandHandler",null,[164,322]);var fc=a(1075),vc=a(1281),Cc=a(1282);class fd extends k.a{constructor(Ub){super(Ub)}vd(){var Ub=f.AFrameworkApplication.fa.appSettings,
Fc=this.$.ya.DirectPrintSetting;Ub.DirectPrintIsEnabled=Fc.DirectPrintIsEnabled.toString();Ub.DirectPrintProbeIsEnabled=Fc.DirectPrintProbeIsEnabled.toString();Ub.DirectPrintEnabledForInternetExplorer=Fc.DirectPrintEnabledForInternetExplorer.toString();Ub.DirectPrintSupportedMimeTypes=Fc.DirectPrintSupportedMimeTypes;Ub.DirectPrintSupportedPlugins=Fc.DirectPrintSupportedPlugins;Ub.DirectPrintImmersivePreviewPlugins=Fc.DirectPrintImmersivePreviewPlugins;Ub.DirectPrintMinimalSupportedEdgeVersion=Fc.DirectPrintMinimalSupportedEdgeVersion;
Ub.DirectPrintEnabledForEdge=Fc.DirectPrintEnabledForEdge.toString();Ub=new fc.a(Ub);let $b=null;Fc=null;try{Fc=window.navigator.mimeTypes}catch(Wc){d.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}let zc=null;try{zc=window.navigator.plugins}catch(Wc){d.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}$b=new Cc.a(Ub,Fc,zc,Cc.a.kef,Cc.a.Dif,new vc.a(f.AFrameworkApplication.ta.QW),f.AFrameworkApplication.ta.ZD,Cc.a.Eif,(Wc,yc)=>new e.a(Wc,!1,yc),
!1);if(u.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.pe.get(116)){const Wc=l.GetServiceTaskFactory.Sa(this.$.da,349,350,this.fb);m.TaskExtensions.Aa(Wc,()=>{const yc=new Ib(this.$,$b,Wc.result);this.$c([yc])},this.$.la)}else this.$c([new Ib(this.$,$b,null)])}static ka(Ub){k.a.Od(73,new fd(Ub))}}Object(b.a)(fd,"PrintCommandHandlerFactory",k.a,[]);a.d(C,"a",function(){return od});const od=()=>{c.a.Fa(fd.ka)}},1144:function(n,C,a){var c=a(9),b=a(0),d=a(222),
f=a(50),e=a(37),k=a(15),l=a(86),m=a(82),u=a(241),t=a(622),w=a(208),r=a(116),v=a(35),y=a(39),x=a(236),B=a(42),z=a(6),A=a(36),I=a(68),F=a(590);class U extends x.a{constructor(fb,ec){super(fb);this.CUj=["id","sessionId","workbookType","workbookFileType","dataloss"];this.command=0;this.WEb=()=>{const lb=this.vOh();if(lb){this.$.qI(!0);if(-2028960985!==this.command&&1461300262!==this.command){const ac=I.a(this.$).kd.activityState;ac[A.a.QYa]=z.a.download;ac[F.a.lUc]=this.command}B.a(this.$).Hr(lb.Errors)}};
this.iframe=fb;this.$=ec;this.Gc.ka("load",this.WEb)}get r8h(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}downloadFile(fb,ec){const lb={};(fb=this.Yyh(fb,lb))&&y.a.Eqc("dlfr",fb,lb);this.command=ec}Yyh(fb,ec){var lb=fb.split("?");if(2!==lb.length)return fb=null,k.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),fb;lb=lb[1].split("&");for(const Gb of lb){var ac=
Gb.split("=",2);if(2!==ac.length){fb=null;k.ULS.sendTraceTag(537154787,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}lb=ac[0];this.CUj.includes(lb)&&(ac=decodeURIComponent(ac[1]),ec[lb]=ac,fb=w.a.MIb(fb,lb))}return fb}reset(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262}vOh(){try{return this.iframe.contentWindow.ewaResult}catch(fb){if(!this.$.ea.jc.isDivSyndicated){const ec=window.document.referrer.match(RegExp("://(.[^/]+)/"));
k.ULS.sendTraceTag(537154785,0,50,`FileLoader.OnFrameLoad: parent domain: ${1<ec.length?ec[1]:""}, current domain: ${escape(window.location.host)}, iframe domain: ${escape(this.iframe.contentWindow.location.host)}. ewaControl IsCrossDomain: ${this.$.DMa}`);throw fb;}return null}}static Mte(fb){let ec=document.createElement("iframe");ec.id="ewaFileLoader";ec.style.cssText="height:0;width:0;display:none";ec.src="about:blank";ec.setAttribute("name","dlfr");ec=fb.domElement.appendChild(ec);return new U(ec,
fb)}}Object(b.a)(U,"FileLoader",x.a,[]);var X=a(141),T=a(55);class G{constructor(fb,ec){this.Wc=()=>{v.a.rg(I.a(this.$).kd.activityState,X.a.Zzd)||this.Nua.reset()};this.$=ec;this.Okc=fb;this.ea=ec.ea;this.ea.rk(this.Wc);this.Nua=U.Mte(this.$)}Wih(){const fb=this.vTg(this.$),ec=this.$.userOperationManager.operationCount;0<ec&&k.ULS.sendTraceTag(537154822,0,15,`flushing queue in downloadcopy. Queue is ${ec}`);this.$.userOperationManager.Y3("DownloadACopyOperation.DownloadForkedFile");this.Okc&&k.ULS.sendTraceTag(537154821,
0,50,"DownloadACopyOperation - Dataloss scenario");this.Nua.downloadFile(fb,-21742208);e.TaskExtensions.Aa(T.Task.delay(1),()=>{this.F$e()},this.Nua.la,3)}dispose(){this.ea&&this.ea.Pk(this.Wc);this.$=this.ea=null}F$e(fb=null){fb||(fb=this.$.Jb.Bc("LoadResource","DownloadACopyOperation"));!this.Nua.r8h&&fb.yc<G.Kqf?window.setTimeout(()=>{this.F$e(fb)},G.Xih):(fb.yc>=G.Kqf&&k.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),I.a(this.$).kd.yM())}vTg(fb){const ec=new Sys.StringBuilder,
lb=fb.workbookContext,ac=fb.ya;ec.append(fb.Mda);ec.append(ac.FileHandlerRelativeUri);ec.append("?id=");ec.append(encodeURIComponent(w.a.MIb(lb.WorkbookUri,"sc")));fb.ea.fc&&(ec.append("&sessionId="),ec.append(encodeURIComponent(fb.ea.sessionId)));ec.append("&workbookType=FullForkedWorkbook");ec.append("&dataloss=");ec.append(this.Okc?"true":"false");r.a.NZa(ec,ac);return ec.toString()}}G.Kqf=1E5;G.Xih=100;Object(b.a)(G,"DownloadACopyOperation",null,[10]);class D extends u.a{constructor(fb,ec,lb=
!1){super(fb,ec);this.PCb=null;this.pCd=ac=>{this.unsubscribe(Gb=>{ac.remove_disposing(Gb)});this.gh(z.a.Rj);this.Dp()};this.Okc=lb}execute(fb){const ec=Object(m.a)(6,fb.De);if(!ec.wka)return k.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.$md(fb),this.gh(z.a.idle),1;this.PCb||(this.PCb=new G(this.Okc,ec));this.PCb.Wih();k.ULS.shipAssertTag(537154817,0,3!==I.a(ec).hi.ju,"The current activity should not be closed.");
return 1}$md(fb){const ec=Object(m.a)(6,fb.De),lb=new t.a(ec);this.subscribe(fb,this.pCd,ac=>{lb.add_disposing(ac)});k.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");lb.initialize();lb.ig()}dispose(){l.a.Ia(this.PCb);this.PCb=null;super.dispose()}}Object(b.a)(D,"DownloadAForkedCopyActivity",u.a,[]);class J extends d.a{constructor(fb){super();this.$=fb;this.Eb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.fb),()=>{this.pb(new D(z.a.h2a,z.a.Rj,!0))},this.la)}}Object(b.a)(J,"DownloadACopyPreDatalossActivityFactory",d.a,[]);class L extends d.a{constructor(fb){super();this.$=fb;this.Eb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),()=>{this.pb(new D(z.a.unmergeableDownloadCopy,z.a.Goa))},this.la)}}Object(b.a)(L,"DownloadAForkedCopyActivityFactory",d.a,[]);var H=a(84),R=a(4),Q=a(80),O=a(27),V=a(106),W=a(25);class da{constructor(fb,ec,lb){this.La=
fb;this.Csg=ec;this.E1=lb}Ig(){this.La.Nb(W.a.tryMacOffice,V.a.frame,Object(H.a)(this,this.DTi,"onTryMacOffice"));this.La.Nb(W.a.Wbg,V.a.frame,Object(H.a)(this,this.yFf,"onTryMacOfficeFromViewer"));this.La.Nb(W.a.Vbg,V.a.frame,Object(H.a)(this,this.yFf,"onTryMacOfficeFromViewer"))}DTi(fb,ec,lb,ac,Gb){if(1===lb)return 32;Gb?(fb=Gb.SourceControlId,"btnjTryMacOfficeForWordEditor"===fb?y.a.Ze(Q.a.iZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===fb&&y.a.Ze(Q.a.iZ(22),
"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.Flf();return 32}yFf(fb,ec,lb){if(1===lb)return 32;switch(fb){case W.a.Wbg:y.a.Ze(Q.a.iZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case W.a.Vbg:y.a.Ze(Q.a.iZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}Flf(){y.a.Ze(da.eyi,"_blank",void 0,"LaunchMacTrialWindow")}get Sxc(){return this.Csg&&O.a.isMac&&!O.a.Zki&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get sxj(){return this.Sxc}static get eyi(){return Q.a.AH("522401")}}
Object(b.a)(da,"MacOfficeOffer",null,[507]);var ta=a(83);class K{constructor(fb,ec,lb){this.La=fb;this.Gsg=ec;this.vFc=null;(this.XXb=R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&ta.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ac=>{this.vFc=ac});this.E1=lb}Ig(){this.La.Nb(W.a.tryOffice,V.a.frame,Object(H.a)(this,this.ETi,"onTryOffice"));this.La.Nb(W.a.tryOfficeThroughTellMe,
V.a.frame,Object(H.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.Nb(W.a.Zbg,V.a.frame,Object(H.a)(this,this.$bg,"tryOfficeThroughViewer"));this.La.Nb(W.a.Ybg,V.a.frame,Object(H.a)(this,this.$bg,"tryOfficeThroughViewer"))}ETi(fb,ec,lb,ac,Gb){if(this.XXb&&1===lb)return this.isFreemiumUpsellEnabled&&this.nMb?32:8;2===lb&&(Gb?(fb=Gb.SourceControlId,"btnjTryOfficeForWordEditor"===fb?y.a.Ze(Q.a.iZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===
fb?y.a.Ze(Q.a.iZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Qjc()):this.Qjc());return 32}tryOfficeThroughTellMe(fb,ec,lb,ac,Gb){if(this.XXb&&1===lb)return this.isFreemiumUpsellEnabled&&this.nMb?32:8;2===lb&&(Gb?(fb=Gb.SourceControlId,y.a.Ze(Q.a.AH("862405")+this.oUh(fb),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):y.a.Ze(Q.a.AH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}$bg(fb,ec,lb){if(this.XXb&&1===lb)return this.isFreemiumUpsellEnabled&&
this.nMb?32:8;if(2===lb)switch(fb){case W.a.Zbg:y.a.Ze(Q.a.iZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case W.a.Ybg:y.a.Ze(Q.a.iZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get yuf(){return this.nMb}get rFi(){return this.nMb&&MSOJS.ClientUtils.OfferOfficeInDialog()}get nMb(){return this.Gsg&&!O.a.isMac}get isFreemiumUpsellEnabled(){let fb=!1;this.vFc&&(fb=this.vFc.isFreemiumUpsellEnabled());return fb}Qjc(fb=null){let ec=0;fb&&(ec=fb);y.a.Ze(K.$Rh(ec),"_blank",void 0,
"LaunchOfficeOffer")}oUh(fb){let ec=0;switch(fb){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":ec=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":ec=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":ec=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":ec=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":ec=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":ec=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":ec=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":ec=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":ec=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":ec=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":ec=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":ec=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":ec=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":ec=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":ec=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":ec=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":ec=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":ec=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":ec=29}return 0===ec?"":String.format("&pc={0:D}",ec)}static $Rh(fb){if(O.a.Xg)switch(fb){case 1:return Q.a.AH("393806");case 2:return Q.a.AH("393810");case 3:return Q.a.AH("393809");case 5:return Q.a.AH("393805")}else if(O.a.xp)switch(fb){case 1:return Q.a.AH("521979");case 3:return Q.a.AH("521980");case 5:return Q.a.AH("521978");
case 2:return Q.a.AH("522490")}else{if(2===fb)return Q.a.AH("517778");if(1===fb)return Q.a.iZ(30)}return Q.a.AH("522402")}}Object(b.a)(K,"OfficeTrialExperience",null,[505]);class na{Wh(fb){fb.register(K,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").wc().Fc(()=>new K(R.AFrameworkApplication.vb,R.AFrameworkApplication.fAb,R.AFrameworkApplication.lcid));fb.register(da,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").wc().Fc(()=>new da(R.AFrameworkApplication.vb,
R.AFrameworkApplication.hhc,R.AFrameworkApplication.lcid))}}Object(b.a)(na,"OpenInClientConfiguration",null,[4]);var P=a(553),ka=a(1350),pa=a(38),Na=a(1191),Z=a(144),Ra=a(151),Da=a(223),Ba=a(13),ea=a(85),Y=a(108),ja=a(88);const ca=fb=>{for(let ec=0;ec<fb.children.length;ec++){const lb=fb.children[ec];lb.style.position="relative";lb.style.top=(lb.parentNode.offsetHeight-lb.offsetHeight)/2+"px"}},ba=fb=>fb.Ca.keyCode===ea.a.fi||fb.Ca.keyCode===ea.a.Toa?(fb.Db.click(),!0):!1,ua=(fb,ec,lb,ac,Gb,wb,qc)=>
{const Ya=document.createElement("a");Ya.className="ProtocolLaunchingDialogButtonAnchor";Ya.className+=" OICDialog";Ya.id=fb;Ya.setAttribute(ja.a.Kd,ja.a.Ys);Ya.style.padding="0";Ya.style.margin="0";ac&&wa(Gb,ec,lb,ac,Ya);fb=document.createElement("span");fb.className="ProtocolLaunchingDialogButtonLabel";fb.innerText=Gb;Ya.appendChild(fb);Ya.tabIndex=0;wb&&Da.a.instance.ra(Ba.a.click,Ya,wb);qc&&Y.KeyInputManager.instance.ra(Ba.a.Ed,Ya,qc);return Ya},wa=(fb,ec,lb,ac,Gb)=>{var wb=document.createElement("img");
wb.alt=fb;wb.className=Ra.getImageClassWithCluster(lb,ac);wb.src=ec;wb.setAttribute(ja.a.Kd,ja.a.Zs);fb=document.createElement("span");fb.className="ProtocolLaunchingDialogImg32Container";fb.appendChild(wb);wb=document.createElement("span");wb.className="ProtocolLaunchingDialogIconContainer";wb.appendChild(fb);Gb.appendChild(wb)};class ia{static get mg(){return Z.a.Yp(ia.ml,CommonUIStrings.l_OICLaunchDialogTitle)}}ia.ml="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(ia,"OICLaunchDialogHtml",null,[]);class xa extends Z.a{constructor(fb){super();this.tVa=this.QCa=null;this.Rpa=!1;this.wq=fb;this.mg=ia.mg;this.Rb=5;this.Ce="OICLaunchDialog";this.showDialog("",Object(H.a)(this,this.EFi,"oicLaunchDialogResultHandler"));this.z0f();this.DW("ProtocolLaunchingDialogTitle");4!==R.AFrameworkApplication.ta.Oa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.EI(this.QCa);k.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}h$a(){this.QCa=ua("BtnRichClient",this.wq.Ksb,this.wq.iyb,this.wq.tld,CommonUIStrings.l_OICLaunchRichClient,Object(H.a)(this,this.mDf,"onRichClientButtonClick"),ba);document.getElementById("OICLaunchRichClient").appendChild(this.QCa);ca(this.QCa);this.tVa=ua("BtnReturn",this.wq.Ksb,this.wq.iyb,this.wq.S$e,CommonUIStrings.l_OICReturnToOnlineClient,Object(H.a)(this,this.jDf,"onReturnButtonClick"),
ba);document.getElementById("OICReturnToApp").appendChild(this.tVa);ca(this.tVa)}jDf(){this.hide();this.wq.pcb();return!0}mDf(){k.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();R.AFrameworkApplication.vb.processAction(W.a.qRa,2);return!0}EFi(){this.wq.pcb()}dispose(){this.Rpa||(this.QCa&&(Da.a.instance.Ba(Ba.a.click,this.QCa,Object(H.a)(this,this.mDf,"onRichClientButtonClick")),Y.KeyInputManager.instance.Ba(Ba.a.Ed,this.QCa,ba)),this.tVa&&(Da.a.instance.Ba(Ba.a.click,
this.tVa,Object(H.a)(this,this.jDf,"onReturnButtonClick")),Y.KeyInputManager.instance.Ba(Ba.a.Ed,this.tVa,ba)),super.dispose(),this.Rpa=!0)}}Object(b.a)(xa,"OICLaunchDialog",Z.a,[]);class gb{static get mg(){return Z.a.Yp(gb.ml,CommonUIStrings.l_OICDialogTitle)}}gb.ml="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(b.a)(gb,"ProtocolLaunchingDialogV2Html",null,[]);a(416);var va=a(107);class sa extends Z.a{constructor(fb){super();this.sVa=this.Xea=null;this.Rpa=!1;this.upa=null;this.wq=fb;this.mg=gb.mg;this.Rb=5;this.Ce="ProtocolLaunchingDialog";this.AHc="OICRetryDialog";R.AFrameworkApplication.Hi.w5a&&R.AFrameworkApplication.Hi.suc();R.AFrameworkApplication.Hi.Fg(new va.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(H.a)(this,this.PGd,"protocolLaunchingDialogResultHandler"));
this.z0f();this.DW("Issues");this.oVe();k.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}h$a(){const fb=document.getElementById("Issues");if(fb){wa("",this.wq.Ksb,this.wq.iyb,this.wq.tld,fb);const ec=document.createElement("span");ec.className="WACDialogSectionTitle";ec.innerText=5===this.wq.qGf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;fb.appendChild(ec);ca(fb);fb.style.display="none"}R.AFrameworkApplication.ta.Oa.qid?
(this.sVa=ua("GiveFeedback",this.wq.Ksb,this.wq.iyb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(H.a)(this,this.Onc,"onGiveFeedbackClick"),Object(H.a)(this,this.uzf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.sVa),ca(this.sVa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===R.AFrameworkApplication.ta.Oa.editMode||R.AFrameworkApplication.Hgh?document.getElementById("ButtonEdit").style.display="none":
(this.Xea=ua("Edit",this.wq.Ksb,this.wq.iyb,"",2===R.AFrameworkApplication.ta.Oa.Dj?4===R.AFrameworkApplication.ta.Oa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===R.AFrameworkApplication.ta.Oa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(H.a)(this,this.byf,"onEditClick"),Object(H.a)(this,this.fyf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Xea),ca(this.Xea));0===
R.AFrameworkApplication.ta.Oa.editMode&&!R.AFrameworkApplication.fAb&&fb&&(fb.style.display="none")}qVe(){return this.upa?(this.EI(this.upa),!0):!1}oVe(){return this.Xea?(this.EI(this.Xea),!0):!1}fyf(fb){return this.vAd(fb,0)}uzf(fb){return this.vAd(fb,2)}hDf(fb){return this.vAd(fb,1)}vAd(fb,ec){let lb=!1;if(fb.Ca.keyCode===ea.a.fi||fb.Ca.keyCode===ea.a.Toa)fb.Db.click(),lb=!0;else if(fb.Ca.keyCode===Sys.UI.Key.down||fb.Ca.keyCode===Sys.UI.Key.up)switch(ec){case 1:lb=this.oVe();break;case 0:lb=this.qVe()}return lb}byf(){this.hide();
4===R.AFrameworkApplication.ta.Oa.editMode?(k.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.wq.pcb()):(k.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.wq.Rid());return!0}Onc(){k.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.wq.O6e();return!0}Noc(){k.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";R.AFrameworkApplication.vb.processAction(W.a.qRa,2);return!0}PGd(){this.wq.pcb()}switchToBackupMode(){var fb=
document.getElementById("ProtocolLaunchingDialogTitle");if(fb){fb.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(fb=document.getElementById("Issues"))fb.style.display="block";(fb=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!fb.children.length&&(this.upa=ua("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(H.a)(this,this.Noc,"onRetryOICClick"),Object(H.a)(this,this.hDf,"onRetryOICKeyUp")),fb.appendChild(this.upa),ca(this.upa),this.Xea||this.qVe())}}dispose(){this.Rpa||(this.Xea&&
(Da.a.instance.Ba(Ba.a.click,this.Xea,Object(H.a)(this,this.byf,"onEditClick")),Y.KeyInputManager.instance.Ba(Ba.a.Ed,this.Xea,Object(H.a)(this,this.fyf,"onEditKeyUp"))),this.sVa&&(Da.a.instance.Ba(Ba.a.click,this.sVa,Object(H.a)(this,this.Onc,"onGiveFeedbackClick")),Y.KeyInputManager.instance.Ba(Ba.a.Ed,this.sVa,Object(H.a)(this,this.uzf,"onGiveFeedbackKeyUp"))),this.upa&&(Da.a.instance.Ba(Ba.a.click,this.upa,Object(H.a)(this,this.Noc,"onRetryOICClick")),Y.KeyInputManager.instance.Ba(Ba.a.Ed,this.upa,
Object(H.a)(this,this.hDf,"onRetryOICKeyUp"))),super.dispose(),this.Rpa=!0)}}Object(b.a)(sa,"ProtocolLaunchingDialog",Z.a,[]);var ab=a(134),Ua=a(422);class nb extends ab.StandardDialog{constructor(fb){super();this.wq=fb;this.Ce="ProtocolLaunchingDialog";R.AFrameworkApplication.Hi.w5a&&R.AFrameworkApplication.Hi.suc();R.AFrameworkApplication.ta.Oa.qid&&this.Jme(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(H.a)(this,this.Onc,"onGiveFeedbackClick"));nb.Q7e?(this.Rb=12,this.rc(1,CommonUIStrings.l_CloseFile),
this.rc(2,CommonUIStrings.l_OICDialogContinueHere),this.rc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(this.Rb=4,this.rc(1,CommonUIStrings.l_OICDialogContinueHere),this.rc(2,CommonUIStrings.l_OICDialogLaunchAgain));this.nDb(CommonUIStrings.l_OICDialog2ndTitle,5===this.wq.qGf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(H.a)(this,this.PGd,"protocolLaunchingDialogResultHandler"),null)}Onc(fb){k.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");
this.wyf(fb)}Noc(){k.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");R.AFrameworkApplication.vb.processAction(W.a.qRa,2)}PGd(fb){nb.Q7e?3===fb?this.nVf():2===fb||0===fb?this.continueEditing():1===fb&&this.s_g():2===fb?this.nVf():(1===fb||0===fb)&&this.continueEditing()}s_g(){k.ULS.sendTraceTag(577783557,211,50,"Closing the document");R.AFrameworkApplication.vb.de(W.a.close,2,Ua.a)}nVf(){k.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(H.a)(this,this.Noc,"onRetryOICClick"),
0)}continueEditing(){4===R.AFrameworkApplication.ta.Oa.editMode||R.AFrameworkApplication.fa.qa("WordConsumptionViewToEditRedirectIsEnabled")&&1===R.AFrameworkApplication.ta.mode?(k.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.wq.pcb()):(k.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.wq.Rid())}static get Q7e(){return R.AFrameworkApplication.fa.qa("OICDialogThreeActions")&&32===R.AFrameworkApplication.vb.processAction(W.a.close,1)}}Object(b.a)(nb,
"StandardProtocolLaunchingDialog",ab.StandardDialog,[]);var Ha=a(1235);class sb{}Object(b.a)(sb,"EditDocumentInClientParams",null,[]);class Qb{static f8c(fb,ec,lb,ac,Gb,wb,qc=!1,Ya=!1,xb="",wc=!1,Oc=!1,Cb=!1,Ib="",fc="",vc="",Cc=!1){const fd=new sb;fd.DocumentUrl=fb;fd.Mode=ec;fd.Options=lb;fd.Application=ac;fd.SilentExternalHandler=qc;fd.EncodeUrl=Ya;fd.CorrelationIdForWinClient=xb;fd.NavigateUsingWindowOpen=wc;fd.DescriptiveUnattemptedEnums=Oc;fd.NoBrowserModalDialogs=Cb;fd.SessionOrigin=Ib;fd.CorrelationId=
fc;fd.ClickTime=vc;fd.NewTelemetryDataIsEnabled=Cc;MSOJS.ClientUtils.EditDocumentInClient(fd,Gb,wb)}}Object(b.a)(Qb,"ClientUtils",null,[]);var mb=a(98),Pb=a(172),gc=a(470),Xb=a(173),Ca=a(819),ra=a(372),ma=a(164),hb=a(69),vb=a(188);class Va{constructor(fb){this.Rfa=this.J6d=this.zVa=null;this.Eib=!1;this.tNc=this.Fde=null;this.HRb=this.gE=this.PWb="";this.application=this.eC=0;this.fHj=this.ZVd=!1;this.GUj=fb&&R.AFrameworkApplication.fa.qa("OICLaunchDialogIsEnabled");R.AFrameworkApplication.vb.d4(W.a.qRa)||
R.AFrameworkApplication.vb.Nb(W.a.qRa,V.a.frame,Object(H.a)(this,this.Uhj,"retryOpenInClientAction"));this.d6f=!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.qa("SilentExternalHandler")}get qGf(){return this.eC}exc(fb,ec="",lb=""){this.gE=lb||Xb.a.create().toString();this.PWb=ec||gc.a.w1e();this.HRb=fb}Uhj(fb,ec,lb){return ec.contextId!==V.a.frame?2:1===lb?32:this.qRa()}get options(){let fb=0;R.AFrameworkApplication.Rfj&&(fb|=1);R.AFrameworkApplication.openInClientEditOnly&&(fb|=4);this.cHj()&&
(fb|=64);return fb}cHj(){return!(2===this.application&&R.AFrameworkApplication.fa.qa("IsEmbeddedScenario"))}get Ksb(){return R.AFrameworkApplication.pB}get iyb(){return R.AFrameworkApplication.S5a}get S$e(){return""}get tld(){return""}get e9f(){return R.AFrameworkApplication.fa.qa("OneNoteMobileViewerIsEnabled")}get yAc(){return this.Fde||(this.Fde=ta.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.ZVd||this.Sxh()}pcb(){this.fHj||this.hyh()}dOf(fb){this.GUj&&O.a.Xg?new xa(this):
this.B3b(fb)}B3b(fb){const ec=({IBa:fb}=this.nri(fb)).returnValue;k.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===ec,fb);return ec}JGa(fb,ec,lb,ac,Gb,wb){this.zVa=fb;this.J6d=ec;this.Rfa=wb;this.application=lb;this.eC=ac;R.AFrameworkApplication.downloadCopyOnOpenInClient?this.Clf():R.AFrameworkApplication.limitedEdit&&!R.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?R.AFrameworkApplication.x5f():this.cPg(Gb)}get DFi(){return!!R.AFrameworkApplication.fa&&R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}qRa(){this.DFi&&this.lui();return this.B3b(this.Eib)}aZf(){const fb=new Ca.a(ma.a.openInClient);fb.Values["ui-language"]=R.AFrameworkApplication.lcid.toString();fb.Values[Ha.a.o5c]=R.AFrameworkApplication.userSessionId;return this.Rfa.value.send(fb)?32:8}lui(){mb.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new vb.a,{inStaging:!0}))}rnj(fb){const ec=new Ca.a(ma.a.RWj);ec.Values["ui-language"]=R.AFrameworkApplication.lcid.toString();
ec.Values[Ha.a.o5c]=R.AFrameworkApplication.userSessionId;ec.Values[ra.a.QWj]=fb;this.Rfa.value.send(ec)}nri(fb){this.Eib=fb;this.rnj(5===this.eC?Va.bVi:Va.dVi);return 5===this.eC?this.mri():this.rri()}mri(){this.Ilf();return{returnValue:32,IBa:"HostEditUrl,"}}rri(){let fb;var ec=fb="";R.AFrameworkApplication.Ane&&(ec="|f|"+R.AFrameworkApplication.userSessionId);const lb=R.AFrameworkApplication.fa.qa("IsAssignmentMode")&&R.AFrameworkApplication.fa.qa("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
R.AFrameworkApplication.isUnifiedHostMode||O.a.zxa,ac=R.AFrameworkApplication.fa.qa("UnattemptedEnumIsEnabled"),Gb=R.AFrameworkApplication.fa.qa("NoBrowserModalDialogs");if(R.AFrameworkApplication.vb.hmc){var wb=R.AFrameworkApplication.vb.pZ(3588168074);wb&&this.exc(wb.epochClickTime,wb.sessionOrigin,wb.correlationId);this.Lnf()}if(R.AFrameworkApplication.sJf){fb+="NewOrder,";wb=8;this.Rfa&&this.Rfa.value&&this.Rfa.value.isEnabled()&&R.AFrameworkApplication.L_d&&(fb+="Post,",wb=this.aZf());if(32===
wb)return{returnValue:wb,IBa:fb};k.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return R.AFrameworkApplication.nm.L$a?(k.ULS.shipAssertTag(5566816,211,!!R.AFrameworkApplication.nm.L$a),fb+="HostUrl,",{returnValue:R.AFrameworkApplication.ta.w9a(R.AFrameworkApplication.nm.L$a),IBa:fb}):this.zVa?(k.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",R.AFrameworkApplication.userSessionId),fb+="DocUrl,",Qb.f8c(this.zVa,this.eC,
this.options,this.application,Object(H.a)(this,this.eyf,"onEditInClientSuccess"),Object(H.a)(this,this.dyf,"onEditInClientFailure"),this.d6f,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),ec,lb,ac,Gb,this.PWb,this.gE,this.HRb,R.AFrameworkApplication.vb.hmc),{returnValue:32,IBa:fb}):{returnValue:8,IBa:fb}}fb+="OldOrder,";if(!this.zVa&&R.AFrameworkApplication.nm.L$a)return this.Rfa&&this.Rfa.value&&this.Rfa.value.isEnabled()&&R.AFrameworkApplication.L_d?(fb+="Post,",ec=this.aZf()):(k.ULS.sendTraceTag(22595483,
211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),ec=8),32!==ec?(k.ULS.shipAssertTag(22595484,211,!!R.AFrameworkApplication.nm.L$a),fb+="HostUrl,",{returnValue:R.AFrameworkApplication.ta.w9a(R.AFrameworkApplication.nm.L$a),IBa:fb}):{returnValue:ec,IBa:fb};k.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",R.AFrameworkApplication.userSessionId);fb+="DocUrl,";Qb.f8c(this.zVa,this.eC,this.options,this.application,Object(H.a)(this,this.eyf,"onEditInClientSuccess"),
Object(H.a)(this,this.dyf,"onEditInClientFailure"),this.d6f,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled"),ec,lb,ac,Gb,this.PWb,this.gE,this.HRb,R.AFrameworkApplication.vb.hmc);return{returnValue:32,IBa:fb}}jTf(fb){R.AFrameworkApplication.Ln.setDw(8981,fb)}eyf(fb){this.jTf(fb);k.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===fb&&MSOJS.ClientUtils.ShouldShowDialog()?(this.e9f||this.Ilf(),this.Lnf()):this.ZVd||this.closeApplication()}dyf(fb,ec=0){k.ULS.sendTraceTag(18715407,
211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",fb,ec);if(5===fb)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const lb=!!this.J6d&&!this.Eib;let ac=0;1===fb&&(ac=2);6<=fb&&13>=fb&&(ac=1,1===ec&&(this.ZVd=!0));this.yAc.rFi?(k.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",ac),Na.a.instance.s9g(this.Eib?Object(H.a)(this,this.Suf,"oicErrorDialogHandlerCloseForced"):Object(H.a)(this,this.Tuf,"oicErrorDialogHandlerNoCloseForced"),
lb?Object(H.a)(this,this.BAf,"onLaunchDownload"):null,this.aJe(!1)?Object(H.a)(this,this.X7h,"iHaveOfficeButtonHandler"):null,ac,ec)):(k.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",ac),Na.a.instance.q9g(this.Eib?Object(H.a)(this,this.Suf,"oicErrorDialogHandlerCloseForced"):Object(H.a)(this,this.Tuf,"oicErrorDialogHandlerNoCloseForced"),lb?Object(H.a)(this,this.BAf,"onLaunchDownload"):null,ac))}}Lnf(){try{const fb=[Object.assign(new hb.a,{name:"CorrelationId",string:this.gE}),
Object.assign(new hb.a,{name:"SessionOrigin",string:this.PWb}),Object.assign(new hb.a,{name:"ClickTime",string:this.HRb}),Object.assign(new hb.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Pb.a("OpenInClientCompleted",!0,0,fb)}catch(fb){k.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+fb.toString())}}Ilf(){R.AFrameworkApplication.ta&&R.AFrameworkApplication.ta.Oa.vv&&R.AFrameworkApplication.fa.qa("StandardProtocolDialogIsEnabled")?new nb(this):new sa(this)}Suf(){this.closeApplication()}Tuf(){this.pcb()}BAf(){this.Clf()}X7h(){return this.aJe(!0)}aJe(fb){const ec=
(O.a.Kff||O.a.PH)&&!!R.AFrameworkApplication.N6b;ec&&fb&&(y.a.Ze(R.AFrameworkApplication.N6b,"_blank",void 0,"OpenInClient"),this.closeApplication());return ec}}Va.dVi="OpenInDesktop";Va.bVi="OpenInBrowser";Object(b.a)(Va,"AOpenInClientOperation",null,[]);var db=a(5),oa=a(203),Oa=a(77),Wa=a(59),Sa=a(324),yb=a(47),Ma=a(45),Bb=a(191),Nb=a(90),Ia=a(29),jb=a(11),Ob=a(21),Jb=a(474),Kb=a(249),Qa=a(252),ha=a(149),qa=a(589);class pb extends Va{constructor(fb,ec,lb){super(!0);this.Ra=new pa.a;this.D7c=this.AVe=
!1;this.C3b=this.Lm=this.WAe=null;this.Wc=()=>{v.a.rg(I.a(this.$).kd.activityState,X.a.Zzd)||this.Nua.reset()};this.EJi=ac=>{this.jTf(ac)};this.DJi=()=>{this.Uzj()};this.$=fb;this.ea=fb.ea;this.hK=ec;this.businessBar=lb;this.ea.rk(this.Wc);this.Nua=U.Mte(this.$);this.j2g();fb.da.Ga(55,this);this.jga=ta.a.instance.Ub("Common.ISystemInitiatedFeedback")}get S$e(){return"EditInExcelWebApp_32x32x32"}get la(){this.Lm=this.Lm||new Bb.a;return this.Lm.token}get tld(){return"excel32"}get e9f(){return this.ea.jc.inWebPart}A1g(){this.dOf(this.AVe)}D3g(){const fb=
this.$;e.TaskExtensions.Aa(this.hK.value,ec=>{this.JGa(fb.workbookContext.ClientUrl,R.AFrameworkApplication.OY,1,fb.isEditMode?2:0,!0,new P.a(()=>ec.result))},this.la,3)}Rid(){0!==Wa.a.wg.editMode&&(this.$.rb.iy=!1)}O6e(){const fb={};fb[db.a.B9b]=!1;fb[db.a.oQ]="OpenInExcel";this.$.fd(802602464,Oa.a.Gb,8,fb)}Y2c(){if(this.ea.fc){var fb=this.$;fb.isEditMode&&e.TaskExtensions.Aa(this.hK.value,ec=>{this.JGa(fb.workbookContext.ClientUrl,R.AFrameworkApplication.OY,1,2,!1,new P.a(()=>ec.result))},this.la,
3)}}dDe(){this.ea.fc&&e.TaskExtensions.Aa(this.hK.value,fb=>{this.JGa(this.$.workbookContext.ClientUrl,R.AFrameworkApplication.OY,1,this.$.isEditMode?2:0,!1,new P.a(()=>fb.result))},this.la,3)}exc(fb){super.exc(fb)}openInExcelClient(){this.ea.fc&&(this.$.isEditMode||e.TaskExtensions.Aa(this.hK.value,fb=>{this.JGa(this.$.workbookContext.ClientUrl,R.AFrameworkApplication.OY,1,0,!1,new P.a(()=>fb.result))},this.la,3))}openInBrowser(){this.ea.fc&&e.TaskExtensions.Aa(this.hK.value,fb=>{this.JGa(this.$.workbookContext.ClientUrl,
R.AFrameworkApplication.OY,1,5,!1,new P.a(()=>fb.result))},this.la,3)}downloadFile(fb){const ec=this.awe(fb);this.Nua.downloadFile(ec,fb);this.Nui()}Nui(){R.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",!1)&&null!=this.jga&&this.jga.execute(fb=>fb.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled"))}mGf(fb,ec=0){if(this.ea.fc){var lb=this.$;I.a(lb).sMa?this.nGf(fb,lb):0<ec?this.$Ej(fb,
lb,ec):this.l4f(lb)}}JGa(fb,ec,lb,ac,Gb,wb){this.$.rb.iy=!this.$.jc.inWebPart;this.AVe=Gb;this.C3b=null;this.D7c=!1;this.hPg(fb,ec,ac,Gb,wb)}B3b(fb){const ec=this.$.jc;k.ULS.sendTraceTag(537154775,0,50,`OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:${ec.inEmbedView}, InWebPart:${ec.inWebPart}, DivSyndicated:${ec.isDivSyndicated}, Mode:${this.$.isEditMode?oa.a.edit:oa.a.view}`);return pb.vgf()?(this.c3b(),Qb.f8c(this.zVa,this.eC,this.options,1,this.EJi,this.DJi,!1,R.AFrameworkApplication.fa.qa("OICEncodeUrlIsEnabled")),
32):super.B3b(fb)}Sxh(){this.pUf();const fb=this.$;if(!this.ea.jc.inWebPart&&this.ea.fc&&!fb.isEditMode){const ec=new Nb.a(2145659238,Oa.a.Gb,this.$.Kc,0,null);this.WAe=yb.a.instance.create(()=>{fb.Ka.Lb(ec)},0,Ma.a.eVi)}}dispose(){this.ea&&this.ea.Pk(this.Wc);l.a.qc([this.Ra,this.WAe,this.Lm]);this.$=this.ea=null}hyh(){this.pUf()}Clf(){yb.a.instance.create(()=>{this.$.Ka.Lb(new Nb.a(-2028960985,Oa.a.Gb,0,30,null))},0,Ma.a.fVi,!0,!0)}cPg(fb){const ec=this.$,lb=I.a(this.$).kd.activityState;lb[Jb.a.Ole]=
!0;ec.isEditMode&&this.ea.fc?(this.c3b(),B.a(ec).Bs(new Kb.a(z.a.Ux,5,()=>{ec.qI(!1);lb[Qa.a.Aq]=z.a.e3b;lb[Jb.a.iBg]=fb;lb[X.a.xbd]=!0;ec.isEditMode&&(lb[X.a.nT]=1,lb[X.a.XX]=!0,lb[ha.a.bZb]=!0,lb[ha.a.rUc]=!0);lb[Jb.a.Rle]=1455037301}))):this.dOf(fb)}Z6f(){const fb=R.AFrameworkApplication.OY;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.w9a(fb,!0)){const ec=this.$.ea.jc;k.ULS.sendTraceTag(537154773,0,50,`Url:[${fb}] IsEmbedded:[${ec.inEmbedView}] InWebPart:[${ec.inWebPart}] DivSyndicated:[${ec.isDivSyndicated}], Mode:[${this.$.isEditMode?
oa.a.edit:oa.a.view}]`)}}else this.Nua.downloadFile(fb,-2028960985);this.D7c=!0;this.c3b()}Mri(){this.yAc.yuf&&this.yAc.Qjc(1)}Nri(){this.yAc.yuf&&jb.HelperMethods.Ze(Q.a.iZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")}Wri(){jb.HelperMethods.Ze(Q.a.iZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")}Xri(){jb.HelperMethods.Ze(Q.a.iZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")}awe(fb){const ec=new Sys.StringBuilder,lb=this.$.workbookContext,
ac=this.$.ya;ec.append(this.$.Mda);ec.append(ac.FileHandlerRelativeUri);ec.append("?id=");ec.append(encodeURIComponent(w.a.MIb(lb.WorkbookUri,"sc")));this.$.ea.fc&&(ec.append("&sessionId="),ec.append(encodeURIComponent(this.$.ea.sessionId)));switch(fb){case -974518828:ec.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:ec.append("&workbookType=FullWorkbook");break;case -1059172980:ec.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:ec.clear()}r.a.NZa(ec,
ac);return ec.toString()}j2g(){ka.a.instance.sYg();const fb=this.$.ya;MSOJS.ClientUtils.InitUrls(fb.RoamingAppsX86RootUrl,fb.RoamingAppsControlInstallerUrl,fb.RoamingAppsFirefoxExtensionUrl)}pUf(){const fb=this.$;this.ea.fc||Sa.a.TGd(fb,I.a(fb).kd);this.c3b();this.C3b&&this.C3b(this,this.D7c);fb.frame.Jt.mm(this.$.frame.Gaa());fb.frame.QW.mm(this.$.frame.Gaa());fb.rb.iy=!1;Ob.g(fb).focus()}hPg(fb,ec,lb,ac,Gb){const wb=this.$;R.AFrameworkApplication.ta&&!pb.vgf()&&(wb.frame.Jt.rn(wb.frame.Gaa()),wb.frame.QW.rn(wb.frame.Gaa()));
super.JGa(fb,ec,1,lb,ac,Gb)}c3b(){const fb=this.$;I.a(fb).hi.activityName===z.a.openInExcelClient&&I.a(fb).kd.yM()}Uzj(){const fb=Ia.a.Yc(1,0,686,687,0,1341525452,"OpenInExcelActiveXError");B.a(this.$).Hr([fb])}$Ej(fb,ec,lb){let ac=null;const Gb=window.setTimeout(()=>{I.a(ec).dtc(ac);this.l4f(ec)},lb);ac=()=>{I.a(ec).sMa&&(I.a(ec).dtc(ac),window.clearTimeout(Gb),this.nGf(fb,ec))};I.a(ec).vVc(ac)}l4f(fb){const ec=Ia.a.Yc(1,1,0,701,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");B.a(fb).Hr([ec])}nGf(fb,
ec){B.a(ec).Bs(new Kb.a(z.a.Ux,5,()=>{ec.qI(!1);const lb=I.a(ec).kd,ac=lb.activityState;ac[Qa.a.Aq]=z.a.wKe;ac[qa.a.dZb]=ec.ea.jc.hasUnsupportedFeaturesForEdit;ac[F.a.lUc]=fb;lb.kr(Ia.a.T3(this.businessBar.s8c,[1437034227]))}))}static vgf(){return 1<Wa.a.getRegisteredEwaInstances().length}}Object(b.a)(pb,"OpenInExcelOperation",Va,[475,10]);class bb extends d.a{constructor(fb){super();this.$=fb;this.Eb();bb.i2g()}create(){if(this.$.da.za(55))this.pb(this.$.da.za(55));else{var fb=f.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.fb),ec=f.GetServiceTaskFactory.Sa(this.$.da,5,4,this.fb);e.TaskExtensions.Aa(T.Task.XI(fb,ec),()=>{this.pb(new pb(this.$,new P.a(()=>f.GetServiceTaskFactory.create(this.$.da,137,this.la,this.fb)),ec.result))},this.la,3)}}static i2g(){bb.Vuf||(bb.Vuf=!0,(new na).Wh(ta.a.instance),ta.a.instance.resolve("Common.IOfficeTrialExperience").Ig(),ta.a.instance.resolve("Common.IMacOfficeOffer").Ig())}}bb.Vuf=!1;Object(b.a)(bb,"OpenInClientFactory",d.a,[]);var eb=a(114),Fa=a(386);class tb extends eb.a{constructor(fb,
ec){super(fb,ec)}execute(fb){const ec=Object(m.a)(6,fb.De);e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(ec.da,56,ec.la,0),lb=>{ec.downloadCopyOnOpenInClient?(fb.activityState[Fa.a.Ple]=!0,lb.result.Z6f()):lb.result.D3g()},ec.la,3);return 1}}Object(b.a)(tb,"OpenInExcelClientActivity",eb.a,[]);class dc extends d.a{constructor(fb){super();this.$=fb;fb.da.Ga(56,new bb(fb));this.Eb()}create(){e.TaskExtensions.Aa(f.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),()=>{this.pb(new tb(z.a.openInExcelClient,
z.a.idle))},this.la)}}Object(b.a)(dc,"OpenInExcelClientActivityFactory",d.a,[]);a.d(C,"a",function(){return jc});const jc=()=>{c.a.Fa(fb=>{fb.da.Ga(57,new dc(fb));fb.da.Ga(60,new L(fb));fb.da.Ga(63,new J(fb))})}},1146:function(n,C,a){a.r(C);n=a(0);var c=a(15),b=a(85),d=a(108),f=a(13),e=a(86),k=a(54),l=a(30),m=a(27),u=a(12),t=a(236),w=a(1056),r=a(5),v=a(259),y=a(1057),x=a(707),B=a(1257),z=a(90);class A extends x.a{constructor(Pb,gc,Xb){super(Pb,gc);this.ov=!0;this.command=Xb}Io(Pb){super.Io(Pb);this.businessBar.$.Ka.Lb(new z.a(this.command,
Pb,this.businessBar.$.Kc,10,null))}}Object(n.a)(A,"CommandActionBusinessBarEntry",x.a,[]);class I extends A{constructor(Pb,gc,Xb){super(Pb,gc,Xb)}vD(Pb){super.vD(Pb)}}Object(n.a)(I,"EditAttemptReadOnlyBusinessBarEntry",A,[]);var F=a(42);class U extends x.a{constructor(Pb,gc,Xb,Ca){super(Pb,gc);this.error=Xb;this.options=Ca;this.error&&this.options&2&&(this.message=this.error.Description);this.error&&this.options&1&&(this.title=this.error.Caption);this.ov=!(Ca&4)}Io(Pb){super.Io(Pb);this.error.Appearance&=
-33;F.a(this.businessBar.$).Hr([this.error])}}Object(n.a)(U,"ErrorBusinessBarEntry",x.a,[]);class X extends U{constructor(Pb,gc,Xb,Ca,ra){super(Pb,gc,Xb,Ca);this.command=ra;this.tZ=!0}v_(Pb){super.v_(Pb);this.businessBar.$.Ka.Lb(new z.a(this.command,Pb,this.businessBar.$.Kc,10,null))}}Object(n.a)(X,"ErrorAndCommandBusinessBarEntry",U,[]);var T=a(14);class G{constructor(Pb,gc,Xb,Ca,ra,ma,hb,vb,Va){this.jJ=this.f8=this.XO=0;this.sng=Pb;this.lKj=gc;this.hP=Xb;this.Erg=hb;this.Rib=l.a.Zv(Va);this.Jpg=
Va;this.xng=vb;0!==Ca&&(this.XO=Ca);0!==ra&&(this.f8=ra);0!==ma&&(this.jJ=ma)}get title(){return G.ga(this.lKj)}get message(){return G.ga(this.hP)}get messageId(){return this.hP}get RGa(){return this.sng}get actionButton(){return G.ga(this.XO)}get uGa(){return G.ga(this.f8)}get link(){return G.ga(this.jJ)}get $k(){return this.Erg}get DTg(){return this.xng}get hash(){return this.Rib}get alt(){const {BusinessBarControl:Pb}=a(1146);switch(this.$k){case Pb.Aia:return G.ga(26);case Pb.lA:return G.ga(25);
case Pb.ui:return G.ga(24);default:return G.ga(0)}}get j9c(){return this.Jpg}static ga(Pb){return T.a.instance.ga(Pb)}}Object(n.a)(G,"EwaBusinessBarEntry",null,[]);class D extends G{constructor(Pb,gc,Xb,Ca,ra,ma,hb,vb){super(Pb,0,gc,Xb,Ca,ra,ma,hb,vb)}get title(){return""}}Object(n.a)(D,"EwaNoTitleBusinessBarEntry",G,[]);var J=a(71);class L extends x.a{constructor(Pb,gc){super(Pb,gc);this.tZ=this.ov=!0}Io(Pb){super.Io(Pb);this.set_visible(!1);this.businessBar.$.uI();this.businessBar.$.Ka.Lb(new z.a(1038998010,
Pb,this.businessBar.$.Kc,10,null))}v_(Pb){super.v_(Pb);this.businessBar.$.Ka.Lb(new z.a(-722953877,Pb,this.businessBar.$.Kc,10,null))}vD(Pb){this.businessBar.removeEntry(55);J.g(Pb)}}Object(n.a)(L,"ExternalLinksEnableContentBusinessBarEntry",x.a,[]);class H extends x.a{constructor(Pb,gc){super(Pb,gc);this.ov=!0;this.tZ=!1}Io(Pb){super.Io(Pb);this.businessBar.$.Ka.Lb(new z.a(-722953877,Pb,this.businessBar.$.Kc,10,null))}vD(Pb){this.businessBar.removeEntry(5);J.g(Pb)}}Object(n.a)(H,"ExternalLinksShowErrorBusinessBarEntry",
x.a,[]);var R=a(11);class Q extends x.a{constructor(Pb,gc,Xb){super(Pb,gc);this.Hxb=Xb;this.ov=!0}Io(Pb){super.Io(Pb);R.HelperMethods.KV(this.businessBar.$.xG,this.Hxb,this.businessBar.$.sS)}}Object(n.a)(Q,"HelpButtonBusinessBarEntry",x.a,[]);class O extends x.a{constructor(Pb,gc,Xb){super(Pb,gc);this.Hxb=Xb;this.gwa=!0}gma(Pb){super.gma(Pb);R.HelperMethods.KV(this.businessBar.$.xG,this.Hxb,this.businessBar.$.sS)}}Object(n.a)(O,"HelpTextBusinessBarEntry",x.a,[]);var V=a(77);class W extends x.a{constructor(Pb,
gc,Xb,Ca){super(Pb,gc);this.Hxb=Xb;this.command=Ca;this.gwa=!0;this.ov=1461300262!==Ca}Io(Pb){super.Io(Pb);this.businessBar.$.Ka.Lb(new z.a(this.command,Pb,this.businessBar.$.Kc,10,null))}gma(Pb){super.gma(Pb);const gc=new z.a(-859308420,Pb,this.businessBar.$.Kc,12,null);this.businessBar.$.Ka.Lb(gc,{[V.a.kg]:"HelpID="+this.Hxb,["InputMethod"]:Pb,[V.a.Qc]:r.a.aV,[r.a.moa]:!0})}}Object(n.a)(W,"HelpTextTaskPaneAndCommandBusinessBarEntry",x.a,[]);class da extends x.a{constructor(Pb,gc){super(Pb,gc);this.tZ=
this.ov=!0}Io(Pb){super.Io(Pb);this.set_visible(!1);this.businessBar.$.uI();this.businessBar.$.Ka.Lb(new z.a(-1081442996,Pb,this.businessBar.$.Kc,10,null))}v_(Pb){super.v_(Pb);this.businessBar.$.Ka.Lb(new z.a(1702917262,Pb,this.businessBar.$.Kc,10,null))}vD(Pb){this.businessBar.removeEntry(59);J.g(Pb)}}Object(n.a)(da,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",x.a,[]);var ta=a(1059);class K extends x.a{constructor(Pb,gc){super(Pb,gc);(this.policyManager=Pb.$.da.za(274))?(this.message=this.policyManager.uqc,
this.title=this.policyManager.title,this.gwa=!0):c.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered.")}get linkText(){return this.policyManager.linkText}gma(Pb){super.gma(Pb);(Pb=this.policyManager.kOi)&&Pb(null)}}Object(n.a)(K,"PolicyBusinessBarEntry",x.a,[]);var na=a(1058),P=a(1061),ka=a(1060);a(416);var pa=a(172),Na=a(25);class Z extends x.a{constructor(Pb,gc){super(Pb,gc);this.ov=!0;this.title=""}Io(Pb){super.Io(Pb);pa.c(Na.a.nDi);
window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")}}Object(n.a)(Z,"UnsupportedBrowserBusinessBarEntry",x.a,[]);var Ra=a(1055),Da=a(1280);class Ba extends x.a{constructor(Pb,gc){super(Pb,gc);this.sCa=Da.a.d5b();this.ov=!0;this.tZ=this.sCa.MUj;this.title=this.sCa.title;this.message=this.sCa.message}get actionButton(){return this.sCa.qwe}get uGa(){return this.sCa.swe}Io(Pb){super.Io(Pb);this.sCa.bwf(null)}v_(Pb){super.v_(Pb);this.sCa.ewf(null)}vD(Pb){super.vD(Pb);this.sCa.uJe(null)}}
Object(n.a)(Ba,"WildFireMobileAppBusinessBarEntry",x.a,[]);var ea=a(246),Y=a(22),ja=a(216),ca=a(157),ba=a(46),ua=a(7),wa=a(173),ia=a(963),xa=a(69),gb=a(132);class va extends x.a{constructor(Pb,gc,Xb,Ca){super(Pb,gc);this.automateCommandManager=Xb.da.za(352);c.ULS.shipAssertTag(526787654,0,!!this.automateCommandManager);this.id=wa.a.create();this.$=Xb;this.title=T.a.instance.ga(2278);this.message="";this.mVd=T.a.instance.ga(2274);this.EWj=T.a.instance.ga(2275);this.nhg=T.a.instance.ga(2276);this.P2g=
T.a.instance.ga(2277);this.update(Ca)}update(Pb){this.scriptLink=Pb.scriptLink;this.runStatus=Pb.runStatus;this.buttonText=Pb.buttonText||"";this.nui(Pb.clickId);this.Zfj();"preparing"===this.runStatus?(this.message=String.format(T.a.instance.mb(208),this.buttonText),this.ov=!0,this.DYa=this.mVd,this.yqb=this.FFa=this.C$a):"running"===this.runStatus?(this.message=String.format(T.a.instance.mb(207),this.buttonText),this.ov=!0,this.DYa=this.mVd,this.yqb=this.FFa=this.C$a):"succeeded"===this.runStatus?
(this.message=String.format(T.a.instance.mb(210),this.buttonText),this.ov=!0,this.DYa=this.nhg,this.FFa=this.MFf,this.tZ=!0,this.EWc=this.EWj,this.FWc=this.fUi):"runFailed"===this.runStatus?(this.message=String.format(T.a.instance.mb(209),this.buttonText),this.K5a=mb.Aia,this.ov=!0,this.DYa=this.nhg,this.FFa=this.MFf,"false"===Pb.isOwner&&(this.tZ=!0,this.EWc=this.P2g,this.FWc=this.oIi)):"fetchFailed"===this.runStatus?(this.K5a=mb.Aia,this.message=String.format(T.a.instance.mb(211),this.buttonText)):
"canceled"===this.runStatus?(this.K5a=mb.lA,this.message=String.format(T.a.instance.mb(213),this.buttonText)):"alreadyRunning"===this.runStatus?(this.K5a=mb.lA,this.message=String.format(T.a.instance.mb(212),this.buttonText),this.ov=!0,this.DYa=this.mVd,this.yqb=this.FFa=this.C$a):"initializing"===this.runStatus&&(this.K5a=mb.ui,this.message=T.a.instance.ga(2279))}get $k(){return this.K5a}get actionButton(){return this.DYa}get uGa(){return this.EWc}Io(Pb){super.Io(Pb);this.FFa&&this.FFa()}v_(Pb){super.v_(Pb);
this.uGa&&this.FWc()}vD(Pb){super.vD(Pb);this.yqb&&this.yqb()}Zfj(){this.message="";this.K5a=mb.ui;this.ov=!1;this.DYa="";this.FFa=void 0;this.tZ=!1;this.EWc="";this.FWc=void 0;this.hideCloseButton=!1;this.yqb=void 0}C$a(){const Pb=wa.a.create().toString();this.automateCommandManager.g6e(Pb);this.okc(-2186799,Pb)}MFf(){const Pb=wa.a.create().toString();this.automateCommandManager.f6e(Pb);this.okc(1036446140,Pb)}fUi(){const Pb=wa.a.create();if(this.scriptLink){const gc=new ia.b(this.scriptLink);this.automateCommandManager.kjd(this.id.toString(),
JSON.stringify(gc),Pb)}this.okc(-585097204,Pb.toString())}oIi(){const Pb=wa.a.create().toString();this.automateCommandManager.e6e(Pb);this.okc(-639858579,Pb)}nui(Pb){const gc=[];gc.push(Object(ua.a)(new xa.a,{name:"id",string:this.id.toString()}));gc.push(Object(ua.a)(new xa.a,{name:"hasScriptLink",bool:!!this.scriptLink}));gc.push(Object(ua.a)(new xa.a,{name:"runStatus",string:this.runStatus}));gc.push(Object(ua.a)(new xa.a,{name:"clickId",string:Pb}));gc.push(Object(ua.a)(new xa.a,{name:"hasButtonText",
bool:!!this.buttonText&&""!==this.buttonText}));pa.a(gb.a.wFi,void 0,void 0,gc)}okc(Pb,gc){const Xb=[];Xb.push(Object(ua.a)(new xa.a,{name:"id",string:this.id.toString()}));Xb.push(Object(ua.a)(new xa.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Xb.push(Object(ua.a)(new xa.a,{name:"runStatus",string:this.runStatus}));Xb.push(Object(ua.a)(new xa.a,{name:"clickId",string:gc}));pa.d(Pb,void 0,void 0,void 0,void 0,void 0,Xb)}}Object(n.a)(va,"OfficeScriptsRunStatusBusinessBarEntry",x.a,[]);var sa=
a(47),ab=a(1);class Ua extends A{constructor(Pb,gc,Xb,Ca,ra,ma){super(Pb,gc,Xb);sa.a.instance.create(()=>{this.showCallout(gc,Ca)},ra,ma,!0,!0)}showCallout(Pb,gc){if(this.xqe()&&this.businessBar&&this.businessBar.Aka(Pb.RGa)){Pb=new z.a(-847286761,0,this.businessBar.$.Kc,0,null);const Xb={};Xb.CalloutName=gc;ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6947554_RetrieveBusinessBarButtonElementChange")?Xb.Target=this.cK():Xb.Target=ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",
!1)?this.domElement.getElementsByTagName("button")[0]:this.XO.domElement;this.businessBar.$.Ka.Lb(Pb,Xb)}}xqe(){return!0}}Object(n.a)(Ua,"CalloutBusinessBarEntry",A,[]);class nb extends Ua{constructor(Pb,gc,Xb,Ca,ra,ma){super(Pb,gc,Xb,Ca,ra,ma)}xqe(){if(!ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1))return!0;const Pb=this.businessBar.$.da.za(465);return Pb&&Pb.kvc?!1:!0}}Object(n.a)(nb,"OptimizeWorkbookCalloutBusinessBarEntry",
Ua,[]);var Ha=a(19),sb=a(176);class Qb extends x.a{constructor(Pb,gc,Xb){super(Pb,gc);this.update(Xb)}update(Pb){this.title=Pb.title?Pb.title:"";this.message=Pb.message?Pb.message:"";this.hideCloseButton=!!Pb.hideCloseButton}}Object(n.a)(Qb,"MsFormsDataSyncStatusBusinessBarEntry",x.a,[]);a.d(C,"BusinessBarControl",function(){return mb});class mb extends t.a{constructor(Pb,gc){super(gc);this.EDh=u.DOMElementExtensions.Cr+",div";this.aQ=Array(71);this.Fm=!1;this.HV=Xb=>{if(Xb.Ca.keyCode===b.a.jA){var Ca=
this.nc.querySelectorAll(this.EDh);const ra=u.DOMElementExtensions.rm(Ca);Ca=u.DOMElementExtensions.lB(Ca);return u.DOMElementExtensions.JAa(Xb.Ca,ra,Ca)}return!1};this.jb=Pb;this.set_visible(!1);this.addCssClass(w.a.Hnh);ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)&&this.addCssClass(w.a.Rnh);d.KeyInputManager.instance.ra(f.a.Qb,this.nc,this.HV);v.a(Pb).di(this)}get ee(){return ea.a.wZc}get nc(){return this.domElement}get Jf(){return this.get_visible()}get $(){return this.jb}hg(Pb,
gc){gc||u.DOMElementExtensions.setFocus(this.domElement.firstChild);return!gc}mh(Pb){return u.DOMElementExtensions.xf(this.nc,Pb)}sj(){}Vj(){}dispose(){this.Fm||(d.KeyInputManager.instance.Ba(f.a.Qb,this.nc,this.HV),e.a.qc(this.aQ),this.aQ=Array(71),this.jb=null,super.dispose(),this.Fm=!0)}Aka(Pb){if(!this.get_visible())return!1;Pb=this.aQ[Pb];return!!Pb&&Pb.isVisible}Gdd(Pb){return this.Aka(Pb)?this.aQ[Pb].cK():null}OE(Pb){return!!this.aQ[Pb]}jPb(Pb,gc){if(Pb=this.aQ[Pb])Pb.update(gc),Pb.HQj()}qC(Pb,
gc,Xb=null,Ca=null){let ra=!1;if(this.OE(Pb))Xb=this.aQ[Pb].get_visible();else{this.set_visible(!0);const hb=mb.n5e()[Pb];this.aQ[Pb]=this.k3(Pb,gc,Xb,Ca);Xb=!1;ra=!0;Ca="";let vb=0;gc&&(Ca=gc.MessageIdName,vb=gc.MessageId);const Va=hb.j9c;var ma=ba.PageLoadTrackingInfo.instance.Mva(new Date);c.ULS.sendTraceTag(537170258,0,50,`BusinessBarControl.AddEntry of type: ${Pb}, time from app interactive: ${ma}`);ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")&&(ma=this.aQ.filter(db=>
null!=db).length,1<ma&&c.ULS.sendTraceTag(525349006,0,50,`Total BizBars: ${ma.toString()}`));sb.a.Ygc&&"BB_RefreshPageAfterEnablingTheExtension"===Va||ca.a(this.$).rLd(hb.hash,Ca,vb,k.a.ABc,!0,1,gc,Va)}Xb||!B.a.Icc().includes(Pb)&&!ra||(this.aQ[Pb].set_visible(!0),this.$.uI())}removeEntry(Pb){return this.C$i(Pb)}vJd(){e.a.qc(this.aQ);this.aQ=Array(71);this.set_visible(!1)}C$i(Pb){if(!this.OE(Pb))return!1;e.a.Ia(this.aQ[Pb]);this.aQ[Pb]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.uI();
return!0}k3(Pb,gc,Xb=null,Ca=null){const ra=mb.n5e()[Pb],ma=!!(this.$.Cd&64);switch(Pb){case 2:case 4:case 23:case 25:case 26:case 36:case 35:Pb=new x.a(this,ra);break;case 12:case 29:case 30:case 31:case 32:case 34:case 57:Pb=ma?new A(this,ra,-8805455):new x.a(this,ra);break;case 22:Pb=new I(this,ra,-8805455);break;case 46:case 45:Pb=ma?new X(this,ra,gc,0,-8805455):new U(this,ra,gc,0);break;case 11:case 43:case 7:case 0:case 1:case 3:case 33:Pb=new U(this,ra,gc,0);break;case 19:Pb=new x.a(this,ra);
break;case 47:Pb=new U(this,ra,gc,0);break;case 6:case 14:Pb=new Q(this,ra,gc.HelpTopicId);break;case 68:case 66:Pb=new O(this,ra,gc.HelpTopicId);break;case 37:Pb=new O(this,ra,r.a.Gch);break;case 38:Pb=new x.a(this,ra);break;case 69:Pb=new I(this,ra,924877417);break;case 16:Pb=new x.a(this,ra);Pb.title=l.a.zg(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);Pb.message=l.a.zg(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:Pb=new A(this,ra,-1762562205);Pb.hideCloseButton=
!0;break;case 20:Pb=new Ba(this,ra);break;case 21:case 56:Pb=new x.a(this,ra);break;case 28:Pb=new x.a(this,ra);break;case 24:Pb=new Z(this,ra);break;case 27:Pb=new K(this,ra);break;case 39:Pb=new Ra.a(this,ra);break;case 40:Pb=new y.a(this,ra);break;case 41:Pb=new na.a(this,ra);break;case 42:Pb=new ta.a(this,ra);break;case 48:Pb=new x.a(this,ra);break;case 49:Pb=new x.a(this,ra);break;case 50:Pb=new x.a(this,ra);break;case 51:Pb=new x.a(this,ra);break;case 52:Pb=new x.a(this,ra);break;case 53:Pb=
new ka.a(this,ra);break;case 54:Pb=new P.a(this,ra);break;case 55:Pb=new L(this,ra);break;case 5:Pb=new H(this,ra);break;case 58:Pb=new A(this,ra,-1753056834);gc?(gc=gc.Directive,Y.a.Kq(gc)||"&nbsp;"===gc||(Pb.message=gc)):Xb&&(Pb.message=Xb);break;case 59:Pb=new da(this,ra);break;case 60:Pb=new x.a(this,ra);break;case 61:case 64:Pb=new O(this,ra,r.a.HEi);break;case 62:Pb=new W(this,ra,r.a.UOg,-8805455);break;case 67:Pb=new W(this,ra,r.a.W5i,1461300262);break;case 63:Pb=ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",
!1)?new nb(this,ra,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new A(this,ra,515196233);Pb.message=Xb;break;case 65:Pb=new va(this,ra,this.$,Ca);break;case 70:Pb=new Qb(this,ra,Ca);break;default:Pb=new U(this,ra,gc,7)}Pb.N3c();return Pb}static n5e(){let Pb;Pb=ja.a.MMa()?263:262;return mb.fwe||(mb.fwe=[new G(0,278,279,280,0,0,mb.Aia,1,"BB_UnableToRefreshLock"),new G(1,278,279,280,0,0,mb.Aia,1,"BB_UnableToRefreshLockExpected"),new G(2,270,271,0,0,0,mb.lA,5,"BB_WorkbookAlmostTooLarge"),
new G(3,272,273,274,0,0,mb.Aia,1,"BB_WorkbookTooLarge"),new G(4,261,Pb,0,0,0,mb.lA,5,"BB_ExternalWorkbookLinksDisabled"),new G(5,265,264,266,0,0,mb.Aia,1,"BB_ExternalWorkbookLinksShowError"),new G(6,267,268,269,0,0,mb.ui,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new G(7,253,254,255,0,0,mb.ui,5,"BB_UnsupportedFeatures"),new G(8,0,0,0,0,0,mb.ui,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new G(9,0,0,0,0,0,mb.ui,0,"BB_CollabDataStringsLocaleMismatch"),new G(10,0,0,0,0,0,mb.ui,0,"BB_CollabDataLocaleMismatch"),
new G(11,281,282,283,0,0,mb.Aia,1,"BB_LastGenericStatusError"),new G(12,284,285,286,0,0,mb.lA,5,"BB_ScratchPadWarning"),new G(13,287,288,289,0,0,mb.Aia,1,"BB_AuthenticationLost"),new G(14,290,291,292,0,0,mb.lA,5,"BB_OdfCompatibilityIssues"),new G(15,0,580,0,0,0,mb.lA,5,"BB_PivotChartInteractivityMissingWarning"),new G(16,0,0,0,0,0,mb.ui,2,"BB_WorkbookIsIrmProtected"),new G(17,0,0,0,0,0,mb.ui,0,"BB_BIFeatureNotAvailable"),new G(18,293,294,289,0,0,mb.lA,5,"BB_AnonymousCreateMode"),new G(19,256,257,
0,0,0,mb.lA,5,"BB_UnsupportedInteractiveReportEditing"),new G(20,0,0,0,0,0,mb.ui,0,"BB_MobileAppCampaignBizBar"),new G(21,299,300,0,0,0,mb.ui,0,"BB_TransientServerCommunicationFailures"),new G(22,1645,1656,1657,0,0,mb.ui,5,"BB_EditAttemptInReadOnly"),new G(23,1645,1656,0,0,0,mb.ui,5,"BB_EditAttemptInReadOnlyNoEditPermissions"),new G(24,0,R.HelperMethods.bQj(),1634,0,0,mb.ui,3,"BB_UnsupportedBrowser"),new G(25,302,303,0,0,0,mb.ui,2,"BB_ReadOnlyPermissions"),new G(26,304,305,0,0,0,mb.ui,2,"BB_DocumentIsIrmProtectedWarning"),
new G(27,0,0,0,0,0,mb.lA,5,"BB_PolicyWarningMessage"),new G(28,1288,301,0,0,0,mb.ui,0,"BB_WorkingOnIt"),new G(29,1645,1643,1644,0,0,mb.ui,2,"BB_PasswordProtectedWorkbookLockedForEdit"),new G(30,1658,1659,1660,0,0,mb.ui,5,"BB_WorkbookIsReadOnlyRecommended"),new G(31,1645,1661,1662,0,0,mb.ui,5,"BB_WorkbookHasPasswordToModify"),new G(32,1645,1663,1666,0,0,mb.ui,3,"BB_LegacySharedWorkbookEditWarning"),new G(33,1653,1664,255,0,0,mb.ui,5,"BB_LegacyConnectionsWarning"),new G(34,1645,1960,1657,0,0,mb.ui,
0,"BB_TooManyLoadBlockingFloatingObjects"),new G(35,1654,1655,0,0,0,mb.ui,2,"BB_GroupedSlicers"),new G(36,315,316,0,0,0,mb.lA,5,"BB_ThirdPartyAddinDisabled"),new G(37,1787,1788,0,0,1789,mb.ui,5,"BB_FinanceLinkedEntityDisclaimerBar"),new G(38,1816,1817,0,0,0,mb.lA,5,"BB_WolframDeprecationAlertBar"),new G(39,0,0,0,0,0,mb.ui,0,"BB_WacGdprNotice"),new G(40,0,0,0,0,0,mb.ui,0,"BB_AutomaticSensitivityLabel"),new G(41,0,0,0,0,0,mb.ui,0,"BB_RecommendedSensitivityLabel"),new G(42,0,0,0,0,0,mb.ui,0,"BB_MandatorySensitivityLabel"),
new G(43,317,318,319,0,0,mb.ui,0,"BB_LocalStorageDisabled"),new G(44,637,638,0,0,0,mb.ui,0,"BB_AutoRefreshDisabled"),new G(45,1014,1012,1016,1317,0,mb.ui,4,"BB_CorruptedFileRepaired"),new G(46,1015,1013,1016,1317,0,mb.ui,5,"CorruptedOdsFileRepaired"),new G(47,275,276,277,0,0,mb.lA,5,"BB_MinorVersionLimitReached"),new G(48,306,307,0,0,0,mb.lA,5,"BB_SensitivityApplicationGenericError"),new G(49,308,310,0,0,0,mb.lA,5,"BB_SensitivityApplicationTooLargeFileError"),new G(50,309,310,0,0,0,mb.lA,5,"BB_SensitivityApplicationLabelNotSupportedError"),
new G(51,311,312,0,0,0,mb.lA,5,"BB_SensitivityApplicationLabelDisabledError"),new G(52,313,314,0,0,0,mb.lA,5,"BB_SensitivityApplicationMandatoryConflictError"),new G(53,0,0,0,0,0,mb.lA,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new G(54,0,0,0,0,0,mb.lA,5,"BB_SensitivityApplicationSetLabelError"),new G(55,2117,2118,2119,2122,0,mb.ui,5,"BB_ExternalWorkbookLinksPromptEnableContent"),new G(56,299,300,0,0,0,mb.ui,0,"BB_NetworkDown"),new G(57,320,321,322,0,0,mb.ui,2,"BB_DefaultToViewDueToCogs"),
new G(58,1813,1814,1815,0,0,mb.ui,1,"BB_RefreshLinkedEntityErrorBar"),new G(59,1790,1791,1792,1793,0,mb.ui,1,"BB_LinkedEntitiesUntrustedImagesDisabled"),new D(60,252,0,0,0,mb.ui,5,"BB_CanvasHealth"),new G(61,323,324,0,0,325,mb.ui,0,"BB_NovModeDepreciation"),new G(62,1017,1018,1317,0,1019,mb.ui,5,"BB_MismatchedFileFormatConverted"),new G(63,2234,0,2236,0,0,mb.ui,5,"BB_OptimizeWorkbook"),new G(64,326,327,0,0,328,mb.ui,0,"BB_NovModePostDepreciation"),new G(65,0,0,0,0,0,mb.ui,0,"BB_OfficeScriptsRunning"),
new G(66,2210,2211,0,0,2213,mb.ui,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new G(67,329,330,0,0,331,mb.ui,5,"BB_ReadOnlyPivotTable"),new G(68,2210,2212,0,0,2213,mb.ui,0,"BB_PowerQueryRefreshHostNotSupported"),new G(69,1056,m.a.Ahc?1058:1057,1055,0,0,mb.ui,4,"BB_RefreshPageAfterEnablingTheExtension"),new G(70,0,0,0,0,0,mb.ui,0,"BB_MsFormsDataSyncStatus")])}}mb.Aia=Ha.a.Zqh;mb.lA=Ha.a.arh;mb.ui=Ha.a.$qh;mb.fwe=null;Object(n.a)(mb,"BusinessBarControl",t.a,[107])},1149:function(n,C,a){var c=a(9);
n=a(0);var b=a(694),d=a(50),f=a(37),e=a(15),k=a(1070),l=a(147),m=a(24),u=a(77),t=a(58);class w{constructor(oa){this.options=null;this.options=oa}}Object(n.a)(w,"MacroRecorderRangeCustomSortedPayload",null,[115]);var r=a(958),v=a(959),y=a(43),x=a(515),B=a(370),z=a(171),A=a(283),I=a(145),F=a(29),U=a(282),X=a(1),T=a(183),G=a(22),D=a(281),J=a(21),L=a(798),H=a(750),R=a(261),Q=a(209),O=a(14),V=a(134);class W{constructor(oa){this.iw=Oa=>{switch(Oa){case 0:this.iOa("Cancel");break;case 1:this.iOa("Expand and sort");
this.wSe(!0);break;case 2:this.iOa("Just sort"),this.wSe(!1)}};this.wSe=oa}show(){const oa=new V.StandardDialog;oa.Rb=11;oa.rc(1,O.a.instance.ga(2124));oa.rc(2,O.a.instance.ga(2125));oa.t5f(O.a.instance.ga(2123),O.a.instance.Va(651),this.iw)}iOa(oa){e.ULS.sendTraceTag(594125219,0,50,`ExpandSortSelectionDialog: user operation: ${oa}`)}}Object(n.a)(W,"ExpandSortSelectionDialog",null,[]);const da=(oa,Oa)=>{oa=oa.ColumnInfo;switch(Oa){case 1:return oa.CellColors&&oa.CellColors.length?!0:(e.ULS.sendTraceTag(537151631,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return oa.TextColors&&oa.TextColors.length?!0:(e.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return oa.Icons&&oa.Icons.length?!0:(e.ULS.sendTraceTag(537151629,0,10,
"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return e.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}},ta=(oa,Oa,Wa,Sa)=>{oa=oa.HeaderColumnInfo;return Sa||oa?2===Oa&&Wa?oa.CellColors&&1!==oa.CellColors.length?(e.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),
!1):oa.TextColors&&1!==oa.TextColors.length?(e.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):oa.Icons&&1!==oa.Icons.length?(e.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:oa?(e.ULS.sendTraceTag(537151627,0,10,`SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize${Wa} == 0.`),
!1):!0:!0};var K=a(187);class na{static isValid(oa){return na.yyh.includes(oa.Position)?!0:(e.ULS.shipAssertTag(537159826,0,!1,`FillGradientStopExtension.IsValid: unexpected position value [${oa.Position}]`),!1)}}na.yyh=[0,.5,1];Object(n.a)(na,"FillGradientStopExtension",null,[]);class P{constructor(oa,Oa,Wa,Sa){new Sys.UI.Point(oa,Oa);new Sys.UI.Point(Wa,Sa)}}Object(n.a)(P,"GradientLine",null,[]);class ka{static isValid(oa){if(!(oa.Degree.toString()in ka.wyh))return e.ULS.shipAssertTag(537159829,
0,!1,`FillGradientExtension.IsValid: unexpected degree value [${oa.Degree}]`),!1;if(!oa.GradientStops)return e.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(oa.GradientStops.length<ka.UAi||oa.GradientStops.length>ka.Dzi)return e.ULS.shipAssertTag(537159827,0,!1,`FillGradientExtension.IsValid: unexpected number of gradient stops [${oa.GradientStops.length}]`),!1;for(const Oa of oa.GradientStops)if(!na.isValid(Oa))return!1;return!0}}ka.UAi=2;ka.Dzi=3;ka.wyh=
{["0"]:new P(0,0,1,0),["180"]:new P(1,0,0,0),["90"]:new P(0,0,0,1),["270"]:new P(0,1,0,0),["45"]:new P(0,0,1,1),["225"]:new P(1,1,0,0),["135"]:new P(1,0,0,1),["315"]:new P(0,1,1,0)};Object(n.a)(ka,"FillGradientExtension",null,[]);const pa=oa=>oa.SortRange?4===oa.SortRangeType?(e.ULS.sendTraceTag(537151622,0,10,`SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: ${oa.SortRangeType}`),!1):2===oa.SortRangeType&&oa.SortTopToBottom&&(null==oa.HeaderRowSize||0>oa.HeaderRowSize)?
(e.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(e.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1),Na=oa=>{if(!oa.SortConditions)return!0;for(const Oa of oa.SortConditions){if(!Ra(oa,Oa.RowColOffset))return e.ULS.sendTraceTag(537151620,0,10,`SharedSortInfoResultExtension.VerifySortConditions: offset [${Oa.RowColOffset}] is out of bounds. sort range: ${oa.SortRange}`),
!1;if(1===Oa.SortConditionType&&Oa.FillGradient&&!ka.isValid(Oa.FillGradient))return e.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0},Z=oa=>{if(!oa.SortColumnInfoItems)return e.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;var Oa=new K.a;for(var Wa of oa.SortColumnInfoItems){if(!Ra(oa,Wa.ColumnOffset))return e.ULS.sendTraceTag(537151617,
0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: offset [${Wa.ColumnOffset}] is out of bounds. sort range: ${oa.SortRange}`),!1;if(!Wa.Name)return e.ULS.sendTraceTag(537151616,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [${Wa.ColumnOffset}]`),!1;if(Wa.CellColors&&!Wa.CellColors.length)return e.ULS.sendTraceTag(537151587,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [${Wa.CellColors.length}]`),!1;if(Wa.TextColors&&
!Wa.TextColors.length)return e.ULS.sendTraceTag(537151586,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [${Wa.TextColors.length}]`),!1;if(Wa.Icons&&!Wa.Icons.length)return e.ULS.sendTraceTag(537151585,0,10,`SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [${Wa.Icons.length}]`),!1;Oa.add(Wa.ColumnOffset)}if(oa.SortConditions)for(const Sa of oa.SortConditions)if(!Oa.contains(Sa.RowColOffset))return e.ULS.shipAssertTag(537151584,
0,!1,`SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [${Sa.RowColOffset}]`),!1;if(oa.HeaderColumnInfoItems){if(oa.HeaderColumnInfoItems.length!==oa.SortColumnInfoItems.length)return e.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Oa=0;Oa<oa.HeaderColumnInfoItems.length;++Oa){Wa=oa.HeaderColumnInfoItems[Oa];if(Wa.ColumnOffset!==oa.SortColumnInfoItems[Oa].ColumnOffset)return e.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Wa.CellColors&&1<Wa.CellColors.length)return e.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Wa.TextColors&&1<Wa.TextColors.length)return e.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(Wa.Icons&&1<Wa.Icons.length)return e.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0},Ra=(oa,Oa)=>{const Wa=oa.SortRange;oa=oa.SortTopToBottom?Wa.LastColumn-Wa.FirstColumn:Wa.LastRow-Wa.FirstRow;return 0<=Oa&&Oa<=oa};var Da=a(379),Ba=a(132),ea=a(96),Y=a(97),ja=a(133);class ca extends Da.a{constructor(oa,Oa){super(oa,Oa);this.mDb=this.Zcd();this.Ir()}get uc(){return"SortMergedCellsErrorDialog"}vO(oa,
Oa){if(1===oa){var Wa=y.v(this.mDb,this.$);J.g(this.$).yg(Wa,null,null,null,0,Y.a.BDj)}Wa={["DialogButton"]:oa,["Location"]:"dialog"};ja.b(this.$).Hd(Ba.a.DDj,Wa,null,!0);super.vO(oa,Oa)}Ir(){super.Ir();const oa=this.zDj();this.Rb=1;this.rc(1,O.a.instance.ga(2241));this.Dl(O.a.instance.ga(2242),ea.a.ki(oa),1,this.E0)}zDj(){return String.format(O.a.instance.mb(174),this.mDb.toString())}Zcd(){const oa=this.error.Description.split("_");return new m.Range(Number.parseInvariant(oa[1])+1,Number.parseInvariant(oa[2])+
1,Number.parseInvariant(oa[3])+1,Number.parseInvariant(oa[4])+1,!0,!1)}}Object(n.a)(ca,"SortMergedCellsErrorDialog",Da.a,[]);var ba=a(68),ua=a(577),wa=a(610);class ia extends L.a{constructor(oa,Oa,Wa,Sa){super(oa);this.ogc=this.wSd=!1;this.z6=[];this.Tdi=(yb,Ma)=>{const Bb=this.S7g(yb);this.gMa(214,(Nb,Ia,jb)=>A.n(this.$.pa.va,Bb,this.j0a(Nb,this.gGh(Ma)),this.QT(Ia),jb,null),16,!0)};this.Sdi=(yb,Ma,Bb)=>{yb=A.m(this.$.pa.va,Ma,this.TGh(Ma,Bb),this.pMi,null,yb);this.z6.push(yb)};this.pMi=()=>{e.ULS.sendTraceTag(529105632,
0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");this.X6b(ia.wrb())};this.R6c=(yb,Ma)=>{if(1===yb){yb=Ma.sortRangeType;const Bb={};Bb.SortOptions=Ma.sortOptions;Bb.ShouldRestoreSelection=this.wSd;Bb.SelectedRange=this.selectedRange;Bb.OriginalActiveCell=this.xpc;Bb.TopCellAddress=this.bUa;Bb.ShouldPromptNamedSheetViewTeachingDialog=0===yb||3===yb;ia.e4i(this.$,Bb)}else this.wSd&&this.Noa(this.selectedRange,this.xpc)};this.p7h=(yb,
Ma)=>{this.wSd=!0;this.Noa(yb,Ma)};this.getColorName=yb=>H.a.HKa(Q.a.tH(yb));e.ULS.shipAssertTag(529105669,0,!!Oa.ActiveCell);e.ULS.shipAssertTag(529105668,0,!!Oa.SelectedRange);e.ULS.shipAssertTag(529105667,0,y.D(Oa.SelectedRange).contains(y.C(Oa.ActiveCell)));e.ULS.shipAssertTag(529105666,0,G.a.equals(Oa.SelectedRange.SheetName,Oa.ActiveCell.SheetName,!0));this.Ccb=new wa.a(oa,ua.a.gch,()=>this.ogc,1);this.selectedRange=Oa.SelectedRange;this.xpc=Oa.ActiveCell;this.rVg=Oa.ExpandSelection;this.namedSheetViewPublic=
Wa;this.bUa=Sa;this.initializeAndShow(O.a.instance.ga(183),this.R6c,this.rta(Oa))}dispose(){this.ogc||(this.ogc=!0,this.Z1b(),this.z6=null,this.Ccb.dispose(),this.Ccb=null);super.dispose()}get uc(){return"CustomSortDialog"}get ha(){return J.g(this.$).ha}gGh(oa){return Oa=>{U.b(Oa,-901005882)?(ba.a(this.$).kd.gM(-901005882),this.MGd()):U.b(Oa,-569193796)?(ba.a(this.$).kd.gM(-569193796),this.hide(),new ca(this.$,Oa.Errors[0])):U.a(Oa)?(e.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),
this.hide()):(Oa=Oa.Result,this.$.gk(Oa.SortRange),Oa&&pa(Oa)&&Na(Oa)&&Z(Oa)?oa(Oa):this.X6b(ia.wrb()))}}TGh(oa,Oa){return(Wa,Sa)=>{if(this.ogc)e.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Wa||U.a(Wa))e.ULS.sendTraceTag(529105634,0,10,`CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: ${F.a.xc(Wa.Errors)}`),this.$.ea.Gp(Wa.Errors),this.hide();
else{Wa=Wa.Result;var yb=oa.RangeType,Ma=oa.HeaderRowSize,Bb=oa.SortTopToBottom;Wa&&da(Wa,oa.ConditionType)&&ta(Wa,yb,Ma,Bb)?(Wa.ColumnInfo.ColumnOffset=Sa,void 0!==Wa.HeaderColumnInfo&&null!==Wa.HeaderColumnInfo&&(Wa.HeaderColumnInfo.ColumnOffset=Sa),Oa(Wa,oa.ConditionType,oa.SortTopToBottom)):(e.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),this.X6b(ia.wrb()))}}}S7g(oa){const Oa={};Oa.SelectedRange=
this.selectedRange;Oa.ActiveCell=this.xpc;Oa.SortInfoMode=oa;Oa.ExpandSortSelection=this.rVg;Oa.ExpandSortSelectionSupported=!0;return Oa}rta(oa){const Oa={};Oa[R.a.dv]=this.uc;Oa.fromAutoFilter=oa.FromAutoFilter;Oa.gridRTL=J.g(this.$).rtl;Oa.activeCell=oa.ActiveCell;Oa.selectedRange=oa.SelectedRange;Oa.invokeGetSortInfo=this.Tdi;Oa.invokeGetSortConditionColorsOrIcons=this.Sdi;Oa.highlightSortRange=this.p7h;Oa.getColorName=this.getColorName;return Oa}Noa(oa,Oa){oa=y.D(oa);this.ha.sa.Xc.equals(oa)||
this.ha.updateSelection(oa,y.C(Oa),0,void 0,void 0,void 0,!0)}MGd(){(new W(oa=>{const Oa={};Oa.ActiveCell=this.xpc;Oa.SelectedRange=this.selectedRange;Oa.ExpandSelection=oa;Oa.FromAutoFilter=!1;this.$.fd(-207540907,u.a.Gb,8,{["SortCommandData"]:Oa})})).show()}Z1b(){if(void 0!==this.z6&&null!==this.z6)for(const oa of this.z6)this.$.pa.va.lfb(oa.Yt)}static e4i(oa,Oa){oa.fd(1659552324,u.a.Gb,8,{["CustomSortCommandData"]:Oa})}static wrb(){return F.a.Yc(1,0,26,0,1,-1517197771,"CustomSortValidationError")}}
Object(n.a)(ia,"CustomSortDialog",L.a,[]);var xa=a(1071);class gb{constructor(oa){this.selection=null;this.selection=oa}getSelection(){return this.selection}}Object(n.a)(gb,"MacroRecorderRangeAutoFilterClearedPayload",null,[115]);class va{constructor(oa){this.filterRange=null;this.filterRange=oa}}Object(n.a)(va,"MacroRecorderRangeFilterReappliedPayload",null,[115]);var sa=a(61);const ab=(oa,Oa,Wa,Sa,yb,Ma,Bb=null)=>{Bb=oa.Na(41,Bb);Bb.options=Oa;return sa.g(oa,"Sort",Bb,Wa,Sa,yb,Ma,0)},Ua=(oa,Oa,
Wa,Sa,yb,Ma,Bb=null)=>{Bb=oa.Na(41,Bb);Bb.selectedRange=Oa;return sa.g(oa,"ClearAutoFilter",Bb,Wa,Sa,yb,Ma,0)},nb=(oa,Oa,Wa,Sa,yb,Ma,Bb=null)=>{Bb=oa.Na(41,Bb);Bb.filterRange=Oa;return sa.g(oa,"ReapplyAutoFilter",Bb,Wa,Sa,yb,Ma,0)};var Ha=a(772),sb=a(773),Qb=a(112),mb=a(55),Pb=a(1072),gc=a(197),Xb=a(33),Ca=a(341),ra=a(65);class ma{constructor(oa,Oa){this.sortOptions=this.iTa=this.selectedRange=null;this.Fdf=!1;this.activeCell=this.ye=this.ub=this.lc=null;this.onContentReady=()=>{this.oPf(!1);const Wa=
this.ha();Wa.sa.Bg&&Wa.sa.Xc.equals(this.iTa)&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")?Wa.updateSelection(this.selectedRange,y.C(this.activeCell),0,void 0,void 0,void 0,!0):Wa.updateSelection(this.selectedRange,Wa.sa.activeCell,0,void 0,void 0,void 0,!0))};this.YLi=(Wa,Sa)=>{Wa&&!F.a.ug(Wa.Errors)&&this.lc&&(this.lc.$o=Wa.Result,this.pLb(),this.applyPivotSort(Sa))};this.XLi=()=>{};this.xTi=(Wa,Sa)=>{Sa&&Sa.FKj&&Sa.selection&&Xb.a.Gff()&&
(Wa=ra.d(this.$.xa.oa),this.GKj(new Ca.a(y.D(Sa.selection),Wa)))};this.$=oa;this.qlf="";this.namedSheetViewPublic=Oa;this.gridView=J.g(this.$);this.$.Jb.Rg("LoadResource","LoadDialogControlsStopwatch")}R0(oa){if(X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",!1)){var Oa=this.$.da.za(465);Oa&&Oa.R0(5,oa)}}Lc(oa,Oa){return!this.Uqd(oa,Oa)}executeCommand(oa,Oa,Wa){let Sa=null;oa=Oa.command;switch(oa){case -864298118:Sa=this.hih(Oa,
Wa);break;case -1010737776:Sa=this.x7c(!0,Oa,Wa);break;case 2123420468:Sa=this.x7c(!1,Oa,Wa);break;case -1089513346:Wa=this.oZe(Wa);if(!this.KAb([y.D(Wa.SortOptions.SelectedRange)]))return f.TaskExtensions.ak();Sa=this.YJe(Oa,Wa);break;case -1032691499:case -764711886:case -2016161444:Sa=this.k2i(Oa,Wa);break;case -207540907:case -1677817820:Sa=this.gridView.Fb.e5(this.ha().sa.activeCell)?this.a2i():this.Y1i(Oa,Wa);break;case 1659552324:Sa=this.YJe(Oa,this.oZe(Wa));break;case 368460465:Sa=this.xih(Oa,
Wa);break;case 529856798:Sa=this.cih(Oa);break;case 644342024:Sa=this.sih(Oa)}return Sa||T.a(oa)}Ac(oa,Oa){if(oa=1===oa)switch(Oa.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;case -1032691499:case -764711886:case -2016161444:oa=X.EwaSettings.isChangeGateEnabled("OfficeVSO:7080994_PutSelectedItemOnTop");break;default:oa=!1}return oa}Oc(){return!1}ha(){return this.$&&this.gridView?
this.gridView.ha:null}oPf(oa){oa?this.gridView.Uu(this.onContentReady):this.gridView.xy(this.onContentReady);this.Fdf=oa}get sa(){return this.ha().sa}Gyj(oa){return!!this.sortOptions&&G.a.equals(this.qlf,oa.eia,!0)}Uqd(oa,Oa){const Wa=J.g(this.$).ha.sa.selectedRanges;return(new I.a(this.$.xa)).um(oa,Oa,Wa,this.gridView)}x7c(oa,Oa,Wa){const Sa=new k.a;X.EwaSettings.isChangeGateEnabled("OfficeVSO:6496842_createDefaultSortOptions")?this.Saf(Sa,Wa,oa):(Sa.OperationType=0,Sa.IsAscending=oa,Sa.HasHeader=
!0,Sa.GuessHeader=!0,Sa.SortTopToBottom=!0,Sa.ExpandSortSelectionSupported=!0,Wa&&void 0!==Wa[ma.Yna]&&null!==Wa[ma.Yna]?(Wa=Wa[ma.Yna],Sa.ActiveCell=Wa.ActiveCell,Sa.SelectedRange=Wa.SelectedRange,Sa.ExpandSortSelection=Wa.ExpandSelection):(Sa.ActiveCell=y.o(this.sa.activeCell,this.$),Sa.SelectedRange=y.v(this.sa.Xc,this.$),Sa.ExpandSortSelection=null));return this.KAb([y.D(Sa.SelectedRange)])?this.gridView.Fb.e5(y.D(Sa.SelectedRange))?this.pih(oa):this.bnd(Sa,Oa):f.TaskExtensions.ak()}hih(oa,Oa){e.ULS.shipAssertTag(520901652,
0,!1,"SortCommandHandler.doDefaultSort: using default sort");let Wa=null;const Sa=this.ha();Sa&&(this.Gyj(Sa)?this.KAb(Sa.sa.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Wa=this.bnd(this.sortOptions,oa)):Wa=this.x7c(!0,oa,Oa));return Wa}KAb(oa){return X.EwaSettings.isChangeGateEnabled("OfficeVSO:6516289_SheetProtectionSettings")&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.Sp(oa,
!0,1):this.$.pXc(oa,!0,1):!0}pih(oa){this.EUh(oa);return mb.Task.Ta(!0)}eSg(oa){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){const Oa=this.gridView.Fb.hk(this.sa.Xc,!1);if(Oa)return new v.a(Oa.name,this.sa.activeCell.left-Oa.usedRange.left,oa.IsAscending)}return new r.a(oa)}bnd(oa,Oa){this.gridView.Ff.eH(!1);const Wa=()=>this.eSg(oa);return this.Q8c((Sa,yb,Ma)=>ab(this.$.pa.va,oa,D.b(Sa,this.UGh(Oa)),yb,Ma,oa),Sa=>new z.a(141,0,Sa,void 0,Wa),Oa,this.Axj(oa))}Axj(oa){if(!this.namedSheetViewPublic)return!1;
const Oa=this.sa.Xc,Wa=y.v(this.sa.Xc,this.$),Sa=this.gridView.Fb.YMa(Oa,!0),yb=this.sa.Hba()&&this.gridView.Fb.lhf(Wa),Ma=this.gridView.Fb.sli(Wa);oa=(Oa.o5||Oa.VZ)&&!Oa.isSingle&&(null==oa.ExpandSortSelection?!1:oa.ExpandSortSelection)&&this.gridView.Fb.lhf(Wa);return Sa||yb||Ma||oa}a2i(){return this.$.fd(-1556797033,u.a.Gb,8,null)}Y1i(oa,Oa){oa=8===oa.Re&&Oa&&void 0!==Oa[ma.Yna]&&null!==Oa[ma.Yna]?Oa[ma.Yna]:19===oa.Re&&Oa&&void 0!==Oa[u.a.kg]&&null!==Oa[u.a.kg]?t.a.$h(Oa[u.a.kg]):this.X6g();if(!this.KAb([y.D(oa.SelectedRange)]))return f.TaskExtensions.ak();
J.g(this.$).Ff.eH(!1);let Wa=null;(Oa=Oa.TopCellAddress)&&(Wa=y.o(Oa,this.$));new ia(this.$,oa,this.namedSheetViewPublic,Wa);return mb.Task.Ta(!0)}oZe(oa){return oa[ma.fch]}YJe(oa,Oa){const Wa=Ma=>{this.n8e(Ma)?this.Y6e(Ma.Errors[0]):(Oa.ShouldRestoreSelection&&this.Noa(Oa.SelectedRange,Oa.OriginalActiveCell),e.ULS.sendTraceTag(537151576,0,50,`SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: ${oa.Re}`),this.wMj(Oa),this.R0(Ma))},Sa=()=>{Oa.ShouldRestoreSelection&&
this.Noa(Oa.SelectedRange,Oa.OriginalActiveCell);e.ULS.sendTraceTag(537151575,0,10,`SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: ${oa.Re}`)},yb=()=>new w(Oa.SortOptions);return this.Q8c((Ma,Bb,Nb)=>ab(this.$.pa.va,Oa.SortOptions,D.b(Ma,Wa),D.a(Bb,Sa),Nb,this.sortOptions),Ma=>new z.a(187,0,Ma,void 0,yb),null,Oa.ShouldPromptNamedSheetViewTeachingDialog)}Noa(oa,Oa){oa=y.D(oa);J.g(this.$).ha.sa.Xc.equals(oa)||J.g(this.$).ha.updateSelection(oa,y.C(Oa),0,void 0,
void 0,void 0,!0)}X6g(){const oa={};oa.ActiveCell=y.o(this.sa.activeCell,this.$);oa.SelectedRange=y.v(this.sa.Xc,this.$);oa.FromAutoFilter=!1;oa.ExpandSelection=null;return oa}xih(oa,Oa){const Wa=this.Faa();if(!Wa)return mb.Task.Ta(!1);const Sa=this.$.pa.va.Tb(),yb=()=>new xa.a(Wa);return X.EwaSettings.$b()?B.a(this.$.userOperationManager,(Ma,Bb,Nb)=>A.z(this.$.pa.va,Wa,D.b(Ha.a.Qva(Qb.a.m_a,sb.a.toggleAutoFilter,Ma),this.xTi),Bb,Nb,{selection:Wa,FKj:Oa.On},Sa),Ma=>new z.a(516,0,Ma,64,yb),oa):B.a(this.$.userOperationManager,
(Ma,Bb,Nb)=>A.z(this.$.pa.va,Wa,Ha.a.Qva(Qb.a.m_a,sb.a.toggleAutoFilter,Ma),Bb,Nb,null,Sa),Ma=>new x.a(516,0,Ma,void 0,yb),oa)}cih(oa){const Oa=this.Faa();if(!Oa)return mb.Task.Ta(!1);var Wa=this.gridView.Fb.hk(this.sa.Xc,!0);Wa&&e.ULS.sendTraceTag(537151574,0,50,`DoClearAutoFilter for namedObject: Type : ${Wa.type.toString()}`);const Sa=this.$.pa.va.Tb(),yb=()=>new gb(Oa);Wa=X.EwaSettings.$b()?Ma=>new z.a(517,0,Ma,64,yb):Ma=>new x.a(517,0,Ma,void 0,yb);return this.Q8c((Ma,Bb,Nb)=>Ua(this.$.pa.va,
Oa,Ha.a.Qva(Qb.a.tsa,sb.a.clearAutoFilter,Ma),Bb,Nb,null,Sa),Wa,oa)}Q8c(oa,Oa,Wa,Sa=!0){return this.namedSheetViewPublic&&Sa?this.namedSheetViewPublic.VSa().continueWith(yb=>{yb.result&&B.a(this.$.userOperationManager,oa,Oa,Wa)}):B.a(this.$.userOperationManager,oa,Oa,Wa)}sih(oa){const Oa=this.Faa();if(!Oa)return mb.Task.Ta(!1);const Wa=this.$.pa.va.Tb(),Sa=()=>new va(Oa);return X.EwaSettings.$b()?B.a(this.$.userOperationManager,(yb,Ma,Bb)=>nb(this.$.pa.va,Oa,Ha.a.Qva(Qb.a.tsa,sb.a.aNf,yb),Ma,Bb,null,
Wa),yb=>new z.a(518,0,yb,64,Sa),oa):B.a(this.$.userOperationManager,(yb,Ma,Bb)=>nb(this.$.pa.va,Oa,Ha.a.Qva(Qb.a.tsa,sb.a.aNf,yb),Ma,Bb,null,Wa),yb=>new x.a(518,0,yb,void 0,Sa),oa)}UGh(oa){return(Oa,Wa)=>{var Sa;U.b(Oa,-901005882)?(ba.a(this.$).kd.gM(-901005882),this.MGd(Wa,oa.command)):this.n8e(Oa)?this.Y6e(Oa.Errors[0]):!U.a(Oa)&&Oa.Result&&(this.sortOptions=Wa,this.iTa=y.D(Oa.Result.ActualSortRange),this.qlf=this.ha().eia,this.Fdf||(this.selectedRange=this.sa.Xc,this.selectedRange.equals(this.iTa)||
(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")&&(this.activeCell=y.o(this.sa.activeCell,this.$)),this.MBj())),(null===(Sa=this.sortOptions)||void 0===Sa?0:Sa.ActiveCell)&&(!X.EwaSettings.isChangeGateEnabled("OfficeVSO:6611537_shouldTriggerPivotTableHandRaise")||this.d4f(this.sortOptions))&&(Wa=this.sortOptions.ActiveCell,Wa=new m.Range(Wa.FirstRow+1,Wa.FirstColumn+1,Wa.FirstRow+1,Wa.FirstColumn+1,!0,!1),this.oS(Wa),this.sYd(Wa)),this.R0(Oa))}}n8e(oa){return U.b(oa,
-569193796)}Y6e(oa){ba.a(this.$).kd.gM(-569193796);new ca(this.$,oa)}MGd(oa,Oa){(new W(Wa=>{const Sa={};Sa.ActiveCell=oa.ActiveCell;Sa.SelectedRange=oa.SelectedRange;Sa.ExpandSelection=Wa;this.$.fd(Oa,u.a.Gb,8,{[ma.Yna]:Sa})})).show()}MBj(){const oa=this.ha();if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:6378426_setActiveCellWithinRangeDuringSortAnimation")){let Oa=y.C(this.activeCell);this.iTa.Ie(Oa)||(Oa=this.iTa.topLeft);oa.updateSelection(this.iTa,Oa,0,void 0,void 0,void 0,!0)}else oa.updateSelection(this.iTa,
oa.sa.activeCell,0,void 0,void 0,void 0,!0);this.oPf(!0)}Faa(){const oa=this.ha();if(!oa)return e.ULS.shipAssertTag(537151573,0,!!oa,"SelectionManger is null"),null;this.gridView.Ff.eH(!1);return y.v(oa.sa.Xc,this.$)}pLb(){this.lc&&this.lc.$o&&(this.ye=this.lc.$o,this.ub=this.lc.Oac())}EUh(oa){if(this.$.isEditMode&&(this.lc=this.gridView.Fb.rp(this.sa.activeCell))){this.activeCell=y.o(this.sa.activeCell,this.$);if(this.lc&&this.lc.$o){var Oa=this.lc.$o.CurrentCol;if(this.lc.$o.CurrentRow===this.activeCell.FirstRow&&
Oa===this.activeCell.FirstColumn){this.pLb();this.applyPivotSort(oa);return}}this.$.pa.va.Tb();Oa=new z.a(228,0,(Wa,Sa,yb)=>A.j(this.$.pa.va,this.activeCell,D.b(Wa,this.YLi),D.a(Sa,this.XLi),yb,oa),16);this.$.userOperationManager.Wb(Oa,null)}}applyPivotSort(oa){if(this.lc&&this.ub&&this.activeCell&&this.ye){var Oa=8===this.ye.CellArea,Wa=1===this.ye.CellArea||2===this.ye.CellArea;(Oa||Wa)&&8!==this.ye.CellType&&4!==this.ye.CellType&&(Oa?B.a(this.$.userOperationManager,(Sa,yb,Ma)=>A.b(this.$.pa.va,
this.activeCell,oa?1:2,this.ub.Caption,Sa,yb,Ma,null),Sa=>new z.a(1015,0,Sa,void 0,null),null):(Oa=1===this.ye.CellArea?1:2,this.$.ma(688)?l.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.lc.externalSourceIndex,this.ub.Index.toString(),this.ub.Caption,this.lc.isOlap?"":this.ub.Caption,Oa,oa):l.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.lc.externalSourceIndex,this.ub.Index.toString(),oa)))}}wMj(oa){this.d4f(oa.SortOptions)&&
(oa.TopCellAddress?oa=y.C(oa.TopCellAddress):(oa=oa.OriginalActiveCell,oa=new m.Range(oa.FirstRow+1,oa.FirstColumn+1,oa.FirstRow+1,oa.FirstColumn+1,!0,!1)),this.oS(oa))}oS(oa){Xb.a.Mka(this.$)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,430,431,1),Oa=>{Oa.result.sea(oa);e.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)}sYd(oa){X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,476,475,0),Oa=>{Oa.result.sYd(oa,0);e.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)}k2i(oa,Oa){if(!this.KAb(this.sa.selectedRanges))return f.TaskExtensions.ak();const Wa=new k.a;this.Saf(Wa,Oa);Wa.SortConditions=[this.k$g(oa)];Wa.OperationType=2;return this.bnd(Wa,oa)}k$g(oa){const Oa=this.gridView.Vb(this.sa.activeCell);let Wa=new Pb.a;Wa.IsAscending=
!0;switch(oa.command){case -1032691499:Oa.fxb?(oa=gc.a.pp(Oa.backgroundColor),Wa.SortColor=oa.mS(!0)):Wa.SortColor=ma.NoColor;Wa.SortConditionType=1;break;case -764711886:Wa.SortColor=Oa.L1c===ma.NoColor?ma.NoColor:gc.a.Mue(Oa.L1c);Wa.SortConditionType=2;break;case -2016161444:Oa.mxb?(Wa.SortIcon=Oa.cell.fjc,Wa.SortIconSet=Oa.gjc):(Wa.SortIcon=ma.g2d,Wa.SortIconSet=ma.g2d);Wa.SortConditionType=3;break;default:e.ULS.debugAssertTag(522723787,0,!1,"SortCommandHandler.createSortConditionsFromSelectedCell: ribbon command didn't match any of the case statements")}return Wa}GKj(oa){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,
426,427,1),Oa=>{void Oa.result.oYd(oa,"Filter")},this.$.la,3)}Saf(oa,Oa,Wa=!0){oa.OperationType=0;oa.IsAscending=Wa;oa.HasHeader=!0;oa.GuessHeader=!0;oa.SortTopToBottom=!0;oa.ExpandSortSelectionSupported=!0;Oa&&Oa[ma.Yna]?(Oa=Oa[ma.Yna],oa.ActiveCell=Oa.ActiveCell,oa.SelectedRange=Oa.SelectedRange,oa.ExpandSortSelection=Oa.ExpandSelection):(oa.ActiveCell=y.o(this.sa.activeCell,this.$),oa.SelectedRange=y.v(this.sa.Xc,this.$),oa.ExpandSortSelection=null)}d4f(oa){return!oa.SortConditions||oa.SortConditions.some(Oa=>
0===Oa.SortConditionType)}}ma.fch="CustomSortCommandData";ma.Yna="SortCommandData";ma.g2d=-1;ma.NoColor=0;Object(n.a)(ma,"SortCommandHandler",null,[164]);class hb extends b.a{constructor(oa){super(oa)}vd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,309,310,this.fb),oa=>{this.$c([new ma(this.$,oa.result)])},this.$.la,3)}static ka(oa){b.a.Od(160,new hb(oa))}}Object(n.a)(hb,"SortCommandHandlerFactory",b.a,[]);L=a(222);class vb{constructor(oa){oa.da.Ga(446,this)}tah(oa,Oa){new ca(oa,Oa)}}
Object(n.a)(vb,"SortUtil",null,[711]);class Va extends L.a{constructor(oa){super();this.$=oa;this.Eb()}create(){let oa=this.$.da.za(446);oa||(oa=new vb(this.$),this.$.da.Ga(446,oa));this.pb(oa)}static ka(oa){oa.da.Ga(447,new Va(oa))}}Object(n.a)(Va,"SortUtilFactory",L.a,[]);a.d(C,"a",function(){return db});const db=()=>{c.a.Fa(oa=>{hb.ka(oa);Va.ka(oa)})}},1153:function(n,C,a){n=a(0);var c=a(553),b=a(15),d=a(134),f=a(54);class e extends d.StandardDialog{constructor(){super();this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(va,
sa){this.EJe(va,sa,f.a.Ljj)}EJe(va,sa,ab){b.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",ab);this.bA(ab,va,sa,null)}l7c(va,sa){b.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.bA(f.a.Njj,va,sa,null,!0)}}Object(n.a)(e,"ErrorDialog",d.StandardDialog,[319]);var k=a(84);d=a(1050);var l=a(144);class m{static get mg(){return l.a.Yp(m.ml,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,
"")}}m.ml="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(n.a)(m,"FileNameDialogHtml",null,[]);var u=a(4),t=a(13),w=a(44),r=a(85),v=a(88),y=a(30);class x extends d.a{constructor(va,sa,ab,Ua,nb,Ha,sb,Qb){super(va,sa,ab,Ua,nb,Ha,Qb);this.lqa=this.LQc=this.Ry=null;this.OTg=CommonUIStrings.l_SaveToAnotherFolder;this.mg=m.mg;this.Ce="FileNameDialog-SaveToSharePoint";this.ylb=sb;this.Nug=Qb}fQ(va){const sa=y.a.Fq(u.AFrameworkApplication.nm.jn),ab=u.AFrameworkApplication.breadcrumbFolderName,Ua=u.AFrameworkApplication.breadcrumbBrandName,nb={["txtFileName"]:va||
sa};let Ha=CommonUIStrings.L_SaveAs;2===u.AFrameworkApplication.ta.Oa.Dj&&(Ha=CommonUIStrings.L_SaveACopy);this.initializeAndShow(Ha,Object(k.a)(this,this.G9b,"fileNameDialogHandler"),nb);this.mJe(va,sa);this.DIa.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");u.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost")||(this.Ry=document.getElementById("anotherFolder"),va=document.getElementById("folderLocation"),this.LQc=
v.a.Lre(va,this.Ry,"anotherFolderDescribedBy"),this.Ry.className="WACButton WACDialogButtonNormal",va=!1,ab&&ab.length?(this.nme(this.Ry,this.LQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ua,ab)),va=this.KBg(Ua,ab)):this.nme(this.Ry,this.LQc,CommonUIStrings.l_CurrentOnlineFolder),this.KCg(this.Ry),this.NBg(this.Ry),va?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Ry,"SaveToAnotherLocationTwo"),b.ULS.sendTraceTag(24459297,216,
50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Ry,"SaveToAnotherLocationOne"),w.a.addHandler(this.Ry,t.a.click,Object(k.a)(this,this.ACd,"onSaveToAnotherLocationClick")),w.a.addHandler(this.Ry,t.a.Qb,Object(k.a)(this,this.uDf,"onSaveToAnotherLocationKeyDown")))}KBg(va,sa){let ab;ab=!1;const Ua=document.getElementById("currentLocation");Ua.innerText="";const nb=this.d1e(Ua,va),Ha=this.d1e(Ua,sa);let sb=255,Qb=255;255<nb+Ha&&(sb=Math.max(238,408-nb),Qb=
Math.max(170,408-Ha),ab=!0);this.kEg(Ua,va,Qb,sa,sb);return ab}d1e(va,sa){const ab=document.createElement("div");ab.innerText=sa;ab.style.visibility="hidden";va.appendChild(ab);sa=ab.clientWidth;va.removeChild(ab);return sa}kEg(va,sa,ab,Ua,nb){sa&&(this.lme(va,sa,ab),this.bEg(va));Ua&&this.lme(va,Ua,nb)}lme(va,sa,ab){const Ua=document.createElement("div");Ua.innerText=sa;Ua.title=sa;Ua.className="SaveToAnotherFolderBreadcrumb";Ua.style.maxWidth=ab.toString()+"px";va.appendChild(Ua)}bEg(va){const sa=
document.createElement("span");sa.id="FolderSeparator";const ab=document.createElementNS("http://www.w3.org/2000/svg","svg");ab.setAttribute("class","SeparatorCaret");const Ua=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ua.setAttribute("points","1 4 1 11 5 7.5");ab.appendChild(Ua);sa.appendChild(ab);va.appendChild(sa)}nme(va,sa,ab){ab=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ab);sa&&(sa.innerText=ab);va.tabIndex=0;va.setAttribute(v.a.Kd,v.a.Ys)}NBg(va){const sa=
document.createElement("span");sa.id="anotherFolderText";sa.innerText=this.OTg;sa.className="AnotherFolderTextSpan";va.appendChild(sa)}KCg(va){const sa=document.createElement("span");sa.className="cui-img-cont-float cui-img-16by16 ";this.lqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.lqa.setAttribute("class","FolderIconSVG");const ab=document.createElementNS("http://www.w3.org/2000/svg","path");ab.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.lqa.appendChild(ab);sa.appendChild(this.lqa);va.appendChild(sa)}uDf(va){!va||va.keyCode!==r.a.fi&&va.keyCode!==r.a.a1||this.ACd(va)}ACd(){if(this.fJ){const va=y.a.e4(u.AFrameworkApplication.fileName);let sa=this.fJ.value;this.hide();sa&&""!==sa&&""!==va||1===this.ta.state?(""!==va&&(sa+=va),this.H9b(sa)?this.Ps.create().displayError(1,sa,!1):this.ylb.start(sa,this.Nug)):this.Ps.create().displayError(2,sa,!1)}}sXg(va){this.Ry&&this.lqa&&(va?(this.Ry.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Ry,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.lqa,"DisabledFolderIconSVG")):(this.Ry.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Ry,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.lqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Ry,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.lqa,"DisabledFolderIconSVG"))))}Tid(){super.Tid();this.sXg(!!this.fJ&&""!==this.fJ.value)}dispose(){this.Ry&&(w.a.removeHandler(this.Ry,t.a.click,Object(k.a)(this,
this.ACd,"onSaveToAnotherLocationClick")),w.a.removeHandler(this.Ry,t.a.Qb,Object(k.a)(this,this.uDf,"onSaveToAnotherLocationKeyDown")),this.Ry=null);super.dispose()}}Object(n.a)(x,"FileNameDialog",d.a,[333]);var B=a(684),z=a(554),A=a(187),I=a(810),F=a(907),U=a(98),X=a(135);class T{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(n.a)(T,"SaveAsDialogInput",null,[]);class G{constructor(){this.properties=this.friendlyPath=this.folderName=
null}}Object(n.a)(G,"SaveLocation",null,[]);var D=a(372),J=a(188);class L{constructor(va,sa,ab,Ua,nb,Ha,sb,Qb,mb){this.VMc=null;this.xA="";this.ylb=va;this.Ps=sa;this.Mh=mb;this.wga=ab;this.af=nb;this.Mv=Ua;this.tFa=sb;this.$Xa=Qb;Ha&&(this.VMc=new c.a(()=>new I.a(Ha.value,null)))}BMh(){const va=new B.a(z.a.Zk());va.ia("type","currentHost");return Object.assign(new G,{folderName:this.Mv.breadcrumbFolderName,friendlyPath:this.Mv.breadcrumbBrandName,properties:va})}Ymi(va){return!!va&&"ClassicMru"===
va.type&&!!va.service_info&&!!va.service_info.service_id&&-1!==va.service_info.service_id.indexOf("SHAREPOINT")}RXh(){if(!this.VMc||!this.tFa)return null;var va=this.VMc.value.oZ("SaveAsToSharePointDialog",!1);if(!va||3!==va.state||!va.tsf)return null;va=va.tsf;const sa=new A.a;let ab=0,Ua=0;for(var nb=0;nb<va.length;nb++){var Ha=va[nb];if(!this.Ymi(Ha))continue;ab++;if(!Ha.sharepoint_info)continue;const sb=Ha.url,Qb=Ha.sharepoint_info.site_url,mb=Ha.title;Ha=F.b(Ha,u.AFrameworkApplication.isRtl);
if(!(sb&&Qb&&mb&&Ha))continue;Ua++;const Pb=new B.a(z.a.Zk());Pb.ia("type","SharePoint");Pb.ia("siteUrl",Qb);Pb.ia("folderUrl",sb);Ua++;sa.add(Object.assign(new G,{folderName:mb,friendlyPath:Ha,properties:Pb}))}nb=new Map;nb.set("NumPlaces",va.length.toString());nb.set("NumSharepointPlaces",ab.toString());nb.set("placesWithMetadata",Ua.toString());U.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",nb);0<ab&&(Ua?.5>1*Ua/ab&&U.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru",
"PartialPlacesMetadataMissing",!1,!1,null):U.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return sa}rNh(){const va=new A.a;va.add(this.BMh());const sa=this.RXh();sa&&va.addRange(sa);return Object.assign(new T,{enableMoreLocations:!u.AFrameworkApplication.fa.qa("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.xA,extension:y.a.e4(this.Mv.jn),saveLocations:va.toArray(),scenario:"SaveToSharePoint"})}Rac(){const va=Object(k.a)(this,this.rNh,
"getDialogInput"),sa={};sa.inputPropsCallback=va;return sa}fQ(va){this.xA=va;this.xA||(this.xA=String.format(CommonUIStrings.l_SaveACopy_Filename,y.a.Fq(this.Mv.jn)));va={["id"]:"SaveAsDialog",["bodyControls"]:this.Rac()};let sa=CommonUIStrings.L_SaveAs;2===this.af.Oa.Dj&&(sa=CommonUIStrings.L_SaveACopy);const ab=new l.a(!1,!1,!0);ab.Rb=1;ab.Ce="SaveAsDialog";ab.rc(1,CommonUIStrings.l_SaveButtonLabel);ab.initializeAndShow(sa,Object(k.a)(this,this.Hjj,"saveAsDialogHandler"),va)}NAj(va,sa){va&&""!==
va&&""!==sa||1===this.af.state?this.Xmi()?this.Cti(va,sa):(""!==sa&&(va+=sa),this.ylb.start(va,this.Mh)):(b.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Ps.create().displayError(2,va,!1))}Cti(va,sa){U.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);const ab=this.$Xa.XEe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.$Xa.Ped(ab).then(Ua=>{if(Ua&&0<Ua.length){const nb=
Ua[0][D.a.jYi];Ua=Ua[0][D.a.lIf];if(""!==nb&&""!==Ua)this.tFa.aoa(Ua,va+sa,nb,this.Mh),U.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.Ps.create().displayError(0,va,!1);const Ha=X.a.Ur();Ha&&(Ha.set("SiteUrlAvailable",""===nb?"false":"true"),Ha.set("FolderUrlAvailable",""===Ua?"false":"true"));U.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new J.a,{extendedProperties:Ha}))}}else this.Ps.create().displayError(0,va,
!1),U.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(Ua=>{"Canceled"===Ua?((Ua=X.a.Ur())&&Ua.set("IsCanceled","true"),U.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new J.a,{extendedProperties:Ua}))):U.Health.instance.recordKpiFailure("SaveACopySFP",Ua,!1,!1,null)})}Xmi(){return this.$Xa?this.$Xa.prd():(b.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}Hjj(va,sa){if(sa&&1===va){va=sa.fileName;var ab=y.a.e4(this.Mv.jn);
sa.moreLocationsSelected&&this.NAj(va,ab);if(sa.locationCallback){var Ua=sa.locationCallback();Ua?Ua.properties&&"currentHost"===Ua.properties.na("type")?this.wga.aoa(va+ab,!1,this.Mh):Ua.properties&&"SharePoint"===Ua.properties.na("type")?(sa=Ua.properties.na("siteUrl"),Ua=Ua.properties.na("folderUrl"),this.tFa.aoa(Ua,va+ab,sa,this.Mh)):b.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):b.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else b.ULS.sendTraceTag(579179797,
216,10,"locationCallback is empty")}}}Object(n.a)(L,"ReactSaveAsDialog",null,[333]);class H{constructor(va,sa,ab,Ua,nb,Ha,sb,Qb=null,mb=null,Pb=null){this.La=sa;this.nb=va;this.lX=Ua;this.wga=Ha;this.Ps=nb;this.af=ab;this.Yge=sb;this.ttg=Qb;this.tFa=mb;this.$Xa=Pb}create(va){return this.af&&this.af.Oa.vv?new L(this.Yge,this.Ps,this.wga,u.AFrameworkApplication.nm,this.af,this.ttg,this.tFa,this.$Xa,va):new x(this.nb,this.La,this.af,this.lX,this.Ps,this.wga,this.Yge,va)}}Object(n.a)(H,"FileNameDialogFactory",
null,[318]);class R{constructor(va,sa,ab,Ua){this.Uo=this.vkb=null;this.vib=va;this.af=ab;this.jvg=Ua;this.LDa=new c.a(()=>new I.a(sa.value,Object(k.a)(this,this.fwb,"getMoreInfoEventReceived")))}get dGf(){this.vkb||(this.LDa.value.oZ("Save As",!0),this.Uo&&this.Uo.wR&&this.Uo.wR.length&&(this.vkb=this.QTh(this.Uo.wR)));return this.vkb}start(va){if(!this.dGf)if(u.AFrameworkApplication.breadcrumbFolderUrl&&u.AFrameworkApplication.breadcrumbFolderUrl.length)this.vkb=u.AFrameworkApplication.breadcrumbFolderUrl;
else return b.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Uo),!1;const sa=this.jvg();sa.hBj();const ab=sa.yUh();if(!ab)return b.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.vib.start((Ua,nb)=>{sa.hide();va(Ua,nb)},()=>{this.YOa(sa)},ab,this.vkb);return!0}YOa(va){va.hide();b.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}QTh(va){va=
va.toLowerCase();va.endsWith("/")||(va+="/");const sa=va.indexOf("/documents/");return-1!==sa?va.substring(0,sa+1)+"_layouts/15/onedrive.aspx":""}fwb(va){this.Uo||3!==va.state||(this.Uo=va)}}Object(n.a)(R,"OneDriveFilePickerHelper",null,[315]);class Q extends l.a{constructor(){super()}hBj(){this.AHc="FilePickerDialog";this.mg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ce="PickerDialog-MsoSp";this.showDialog("",null)}yUh(){return document.getElementById("FilePickerDiv")}HI(){}Mza(){}}
Object(n.a)(Q,"PickerDialog",l.a,[314]);var O=a(643),V=a(834),W=a(373),da=a(27),ta=a(106),K=a(25);class na{constructor(va,sa,ab,Ua,nb,Ha,sb){this.nb=va;this.NIc=ab;this.La=sa;this.ylb=Ua;this.vib=nb;this.DOc=Ha;this.Jng=sb}Ig(){const va=this.vib.B4a();va?da.a.Dka||this.nb.qa("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.Le(K.a.saveToSharePoint,ta.a.frame,Object(k.a)(this,this.jXf,"saveToSharePointActionDispatcher"),64):(va.F8a.continueWith(sa=>{sa.Tf&&this.vib.MBd(sa)}),this.N1b()):b.ULS.sendTraceTag(25180162,
216,15,"Failure with OneDrive API download as the js url is empty.")}N1b(){W.a.UId(Object(k.a)(this,this.jXf,"saveToSharePointActionDispatcher"));W.a.P8c([new V.a(K.a.saveToSharePoint,ta.a.frame,0)],this.vib.B4a())}get O7a(){return this.nb.qa("SaveToAnotherFolderBrsIsEnabled")}get Cxe(){return this.nb.qa("UserCanWriteRelative")}jXf(va,sa,ab,Ua,nb){return sa.contextId!==ta.a.frame||va!==K.a.saveToSharePoint?2:this.O7a&&(this.DOc.dGf||this.Cxe)?1===ab?O.SessionStatusManager.instance.s5a||u.AFrameworkApplication.X4?
8:this.Jng()?32:8:2===ab?(b.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(nb&&nb.SaveEntryPoint&&"VersionHistory"===nb.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Cxe?(b.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.NIc.create(nb).fQ(null)):(b.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.ylb.start(null,nb)),32):8:8}}Object(n.a)(na,"SaveToSharePointActor",
null,[]);class P{constructor(va,sa,ab,Ua){this.Mh=this.bde=null;this.tFa=va;this.Ps=sa;this.DOc=ab;this.af=Ua}start(va,sa){b.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.bde=va;this.Mh=sa;this.DOc.start((ab,Ua)=>{this.G1i(ab,Ua)})||this.xTd()}G1i(va,sa){if(va)this.onSuccess(sa);else this.h6(sa)}xTd(){1!==this.af.state&&this.Ps().l7c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(va){b.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(va&&va.data&&va.data.value&&va.data.value.length&&va.data.value[0].sharePoint){const sa=va.data.value[0].sharePoint.url;va=va.data.value[0].sharePoint.listUrl;let ab=null;if(sa&&(ab=va?this.kYh(va):this.jYh(sa))){this.tFa.aoa(sa,this.bde,ab,this.Mh);return}b.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!sa,!ab)}b.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.xTd()}jYh(va){va.endsWith("/")||
(va+="/");let sa=0;for(let ab=0;ab<va.length;ab++)if("/"===va.charAt(ab)&&5===++sa)return va.substr(0,ab);return null}kYh(va){va.endsWith("/")&&(va=va.substring(0,va.length-1));const sa=va.lastIndexOf("/");return-1!==sa?va.substring(0,sa):null}h6(va){b.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");va&&va.error?b.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",va.error.errorCode,va.error.message):b.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.xTd()}}Object(n.a)(P,"SaveToSharePointManager",null,[267]);var ka=a(80);class pa{constructor(va,sa,ab,Ua,nb,Ha,sb,Qb){this.AFa=va;this.xA=sa;this.hWa=Ua;this.EPc=Ha;this.B8=ab;this.Pxg=nb;this.xfa=sb;this.Mh=Qb}execute(va,sa){if(!u.AFrameworkApplication.Qg&&u.AFrameworkApplication.yd){var ab=this.AFa+this.xfa;ab=ka.a.Kl(ab,"fu",y.a.mf(this.B8));ab=ka.a.Kl(ab,"su",y.a.mf(this.Pxg));ab=ka.a.Kl(ab,"fn",y.a.mf(this.xA));ab=ka.a.Kl(ab,"n",y.a.mf((new Date).getTime().toString()));
this.Mh&&this.Mh.FileDownloadUrl&&(ab=ka.a.Kl(ab,"furl",y.a.mf(this.Mh.FileDownloadUrl)));ab=ab+"&"+this.EPc;this.hWa&&this.hWa.length?ab=ka.a.Kl(ab,"fnn",y.a.mf(this.hWa)):b.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");b.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");u.AFrameworkApplication.yd.Jm(ab,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,va,sa,null,void 0,void 0,void 0,void 0,"9")}}}Object(n.a)(pa,"SharePointSaveAsCaller",
null,[287]);class Na{constructor(va){this.BFa=va.appSettings.SaveAsToHostWebServiceBase;this.xA=va.appSettings.FileName;this.xfa=va.Xa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(va,sa,ab,Ua){return new pa(this.BFa,this.xA,va,sa,ab,u.AFrameworkApplication.qj,this.xfa,Ua)}}Object(n.a)(Na,"SharePointUploadCallerFactory",null,[266]);var Z=a(41),Ra=a(39),Da=a(238),Ba=a(687),ea=a(164),Y=a(644),ja=a(767);class ca{constructor(va,sa,ab,Ua,nb){this.Hm=this.UCa=null;this.fFc=!1;this.HQc=
this.B8=null;this.ZSc=sa;this.Wkb=ab;this.Ps=Ua;this.af=nb;this.La=va}aoa(va,sa,ab,Ua){this.fFc=!1;b.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.QMb();this.B8=va;Ua&&Ua.SaveEntryPoint&&(this.HQc=Ua.SaveEntryPoint);this.UCa=this.ZSc.create(va,sa,ab,Ua);Ua&&"true"===Ua.SkipSaveToHost?this.mQ():this.NDh()}NDh(){const va=()=>{b.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");
this.mQ()};32!==this.La.de(K.a.HRa,2,[()=>{b.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");this.mQ()},va])&&va()}mQ(){b.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.UCa.execute(Object(k.a)(this,this.mRi,"onSaveToSharePointUploadFinished"),Object(k.a)(this,this.lRi,"onSaveToSharePointUploadFailed"))}mRi(va){if(va&&va.data&&va.data.Xd){var sa;if(({fu:sa}=Z.d(va.data.Xd)).returnValue)if(sa.StatusCode!==Da.a.VO&&sa.StatusCode!==
Da.a.Prb)b.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",va.data.status,sa.StatusCode),sa.StatusCode!==Da.a.aUf&&this.bKe(va.data.status)||(this.rda(sa.StatusCode.toString()),this.Szj(sa.StatusCode));else{b.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.HLd();try{sa.NewDocumentUrl?this.BQa(sa.NewDocumentUrl):this.CQa()}catch(ab){b.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",
ab.toString())}}else b.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:ja.a.kfb(va.data.Xd)}),this.n7b()||(this.rda("Failed to deserialize response"),this.OMb())}else b.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.n7b()||(this.rda("Unknown"),this.OMb())}lRi(va){va&&va.data?this.bKe(va.data.status)||(b.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.rda(Ba.a[va.data.status]),this.OMb()):(b.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),
this.n7b()||(this.rda("Unknown"),this.OMb()))}n7b(){if(!this.fFc)return b.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.fFc=!0,this.mQ(),!0;b.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}bKe(va){b.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",va);return this.n7b()}CQa(){b.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Ra.a.Ze(this.B8,Ra.a.cX(3),void 0,"UploadToSharePointManager.RedirectToFolder")}BQa(va){let sa=
!1,ab=!1;u.AFrameworkApplication.fa&&(sa=u.AFrameworkApplication.fa.qa("SaveACopyIsEnabledForUiHost"),ab=u.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",va,sa);if(sa&&ab){b.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const Ua={};Ua[D.a.wQa]="1";Ua[D.a.documentUrl]=va;Ua[D.a.reason]=Y.a.saveAs;u.AFrameworkApplication.XU().execute(nb=>
{nb.Mj(ea.a.dua,Ua)})}else Ra.a.Ze(va,Ra.a.cX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}QMb(){this.af&&1===this.af.state||(this.Hm=this.Wkb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Rb=5,this.Hm.ut=!1,this.Hm.aBa(CommonUIStrings.l_DefaultDialogTitle,null,null))}KIa(){this.Hm&&(this.Hm.close(),this.Hm=null)}OMb(){this.uj(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}SAj(){this.uj(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Zzj(){const va=
String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.uj(CommonUIStrings.l_SaveAsFileTooLargeTitle,va,f.a.Ijj)}uj(va,sa,ab=f.a.Mjj){b.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",va,sa);this.KIa();1!==this.af.state&&this.Ps().EJe(va,sa,ab)}Szj(va){b.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",va);switch(va){case Da.a.Bcg:this.SAj();break;case Da.a.aUf:this.Zzj();break;default:this.OMb()}}HLd(){"VersionHistory"===this.HQc&&
this.La.processAction(K.a.buc,2)}rda(va){"VersionHistory"===this.HQc&&this.La.de(K.a.KLd,2,{["FailureReason"]:va})}}Object(n.a)(ca,"UploadToSharePointManager",null,[264]);var ba=a(247),ua=a(783),wa=a(518),ia=a(55);class xa{constructor(){this.tra=this.WNc=this.RNc=this.gb=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Wh(va){this.gb=va;this.RNc=wa.a.er(va.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.WNc=wa.a.er(va.Ub("Common.IEventEmitter<Common.IMruResult>"));
this.tra=wa.a.er(va.Ub("Common.App.SharedFilePicker.ISharedFilePicker"));ia.Task.WAA.call(null,this.RNc,this.WNc,this.tra).continueWith(()=>{this.H7i()})}H7i(){this.gb.register(Na,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Fc(()=>new Na(u.AFrameworkApplication.fa)).wc();this.gb.register(ca,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Fc(()=>new ca(u.AFrameworkApplication.vb,
this.gb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new ua.a).create(),()=>new e,u.AFrameworkApplication.ta)).wc();this.gb.register(P,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Fc(()=>new P(this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new e,this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),u.AFrameworkApplication.ta)).wc();this.gb.register(R,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Fc(()=>
new R(this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new c.a(()=>this.RNc.result),u.AFrameworkApplication.ta,()=>new Q)).wc();this.gb.register(H,"Common.App.SaveToSharePoint.FileNameDialogFactory").Fc(()=>new H(u.AFrameworkApplication.fa,u.AFrameworkApplication.vb,u.AFrameworkApplication.ta,u.AFrameworkApplication.ta.Oa,this.gb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.gb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new c.a(()=>this.WNc.result),this.gb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.tra?this.tra.result:null)).wc();this.gb.register(na,"Common.App.SaveToSharePoint.SaveToSharePointActor").Fc(()=>new na(u.AFrameworkApplication.fa,u.AFrameworkApplication.vb,this.gb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.gb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.gb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.gb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>u.AFrameworkApplication.ta.MVg)).wc();u.AFrameworkApplication.fa.qa("SaveToAnotherFolderBrsIsEnabled")&&this.gb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Ig()}static main(){ba.a.instance.Gi(new xa)}}Object(n.a)(xa,"PackageManager",null,[3,4]);a.d(C,"a",function(){return gb});const gb=()=>{Type.registerNamespace("Common.App.SaveToSharePoint");xa.main()}},1162:function(n,C,a){var c=a(9);n=a(0);var b=a(694),
d=a(50),f=a(37),e=a(1),k=a(183);class l{constructor(xa,gb){this.$=xa;this.presentModeManager=gb}Lc(){return!1}Ac(xa,gb){if(!e.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(gb.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Cz;default:return!1}}executeCommand(xa,gb){xa=f.TaskExtensions.ak();gb=gb.command;switch(gb){case 642419866:this.presentModeManager.wyc(!this.presentModeManager.Cz);this.presentModeManager.Yg("TogglePresentMode");
break;case 588342182:this.presentModeManager.B7a=!this.presentModeManager.B7a;this.presentModeManager.k5f(this.presentModeManager.B7a,"TogglePresentModeOverlay");this.presentModeManager.Yg("TogglePresentModeOverlay");break;default:xa=k.a(gb)}return xa}Oc(){return!1}}Object(n.a)(l,"PresentModeCommandHandler",null,[164]);class m extends b.a{constructor(xa){super(xa)}vd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.Sa(this.$.da,423,424,this.fb),xa=>{this.$c([new l(this.$,xa.result)])},this.la,3)}static ka(xa){b.a.Od(420,
new m(xa))}}Object(n.a)(m,"PresentModeCommandHandlerFactory",b.a,[]);var u=a(222),t=a(15),w=a(129),r=a(4),v=a(111),y=a(82);class x{}x.Jrh="ewa-presentMode-overlay";x.Krh="ewa-presentMode-panel-container";x.Lrh="ewa-presentMode-rowHdrParent-container";Object(n.a)(x,"CssClassNames",null,[]);var B=a(19),z=a(5),A=a(148),I=a(291),F=a(132),U=a(370),X=a(171);a(59);var T=a(113),G=a(434),D=a(12),J=a(11),L=a(100),H=a(345),R=a(21),Q=a(133),O=a(419),V=a(108),W=a(13),da=a(259),ta=a(246),K=a(174),na=a(45);class P{constructor(xa){this.Ete=
this.aQa=this.CFd=this.DFd=this.Qca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.yqc={};this.xqc={};this.XPa=null;this.GIf=0;this.onKeyDown=gb=>{gb=gb.Ca;if(9===gb.keyCode){var va=this.Qca.querySelectorAll(D.DOMElementExtensions.Cr);const sa=D.DOMElementExtensions.rm(va);va=D.DOMElementExtensions.lB(va);D.DOMElementExtensions.JAa(gb,sa,va);return!0}return!1};this.Yl=()=>{this.$.da.Za(337,gb=>{this.aQa.getPresentModeFloatieControlsMap().then(va=>{const sa={};for(let ab=0;ab<va.length;ab++)sa[va[ab].controlId]=
va[ab].modelType;va=gb.Q6.W4a(sa);0<va.length&&appChrome.api.dispatch(va);this.gkj()})})};this.$=xa}dispose(){this.$=this.CFd=this.DFd=this.Qca=this.aQa=null}rai(){window.requestAnimationFrame(()=>{this.Qca=document.createElement("div");this.$.$u.insertBefore(this.Qca,this.$.$u.lastChild);this.Qca.id=this.$.Cb+z.a.m$b;this.Qca.classList.add(x.Krh);this.DFd=document.getElementById(this.$.Cb+z.a.$5c);this.CFd=[this.$.PE];this.isInitialized=!0});this.aQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();
this.aQa.initializePresentModeFloatie()}rZh(){const xa={};xa.PollingCountPerCaller=v.a.toJSON(this.xqc);xa.PollingDurationPerCaller=v.a.toJSON(this.yqc);return xa}wTd(xa){this.isInitialized?xa?(this.aQa.showPresentModeFloatie(this.Qca,this.DFd,this.CFd),this.Yg("ShowOrHideFloatiePanel"),this.K8i()):(this.aQa.hidePresentModeFloatie(),this.wPj()):t.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")}Yg(xa){this.GIf=J.HelperMethods.Sb();
this.XPa=xa;this.Ete=K.AsyncMethodContext.yr(this.Yl,100,na.a.n0i+xa,this.Ete)}get nc(){return this.Qca}get Jf(){this.aQa.updatePresentModeFloatieShyState(2);return!!this.Qca}get ee(){return ta.a.UJf}hg(xa,gb){if(gb)return!1;xa=D.DOMElementExtensions.rm(this.Qca.querySelectorAll(D.DOMElementExtensions.Cr));if(!xa)return t.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;xa.focus();return!0}mh(xa){return D.DOMElementExtensions.xf(this.nc,
xa)}sj(){}Vj(){}K8i(){da.a(this.$).di(this);this.$.da.Za(15,xa=>{this.ewaAccessibilityManager=xa;this.ewaAccessibilityManager.mode=5});V.KeyInputManager.instance.ra(W.a.Qb,this.nc,this.onKeyDown)}wPj(){da.a(this.$).Tz(this);R.g(this.$).t0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);V.KeyInputManager.instance.Ba(W.a.Qb,this.nc,this.onKeyDown)}gkj(){const xa=J.HelperMethods.Sb()-this.GIf,gb=this.yqc[this.XPa]?this.yqc[this.XPa]:0;this.yqc[this.XPa]=gb>xa?gb:xa;this.xqc[this.XPa]=
this.xqc[this.XPa]?this.xqc[this.XPa]+1:1}}Object(n.a)(P,"PresentModeFloatieManager",null,[503,107,10]);var ka=a(7),pa=a(60);class Na{constructor(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}}Object(n.a)(Na,"OverlayCavityInfo",null,[]);class Z{constructor(){this.height=this.width=0}}Object(n.a)(Z,"OverlayContainerInfo",null,[]);class Ra{constructor(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}}Object(n.a)(Ra,"PresentModeOverlayProps",
null,[]);class Da{constructor(xa){this.S_a=this.EFd=null;this.$=xa;this.gridView=R.g(this.$)}dbi(){this.EFd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(()=>{this.S_a=Array(5);let xa,gb;for(let va=1;4>=va;va++)xa=document.createElement("div"),D.DOMElementExtensions.setVisible(xa,!1),xa.id=`${"PresentModeOverlay"}-${va}`,D.DOMElementExtensions.toggleCssClass(xa,x.Jrh,!0),gb=this.gridView.Hf(va).domElement,gb.insertBefore(xa,gb.firstChild),
this.S_a[va]=xa})}j5f(xa){xa&&this.TSj();for(let gb=1;4>=gb;gb++)this.Sgf(gb)&&D.DOMElementExtensions.setVisible(this.S_a[gb],xa);D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-overlay",xa)}TSj(){const xa=this.XUg();let gb;for(let va=1;4>=va;va++)gb=va,xa[gb]&&this.EFd.showOverlayWithCavity(this.S_a[gb],xa[gb])}dispose(){this.EFd=this.S_a=this.gridView=this.$=null}XUg(){let xa;const gb=R.g(this.$).rtl;let va;const sa=Array(5);for(let Ua=1;4>=Ua;Ua++)if(xa=Ua,this.Sgf(Ua)){var ab=
this.gridView.Hf(Ua);va=this.gridView.ha.Qa.LZ?this.oPh(Ua,ab,gb):this.hQh(Ua,ab,gb);ab=this.C9g(ab);sa[xa]=this.X9g(this.S_a[xa].id,ab,va)}return sa}Sgf(xa){return this.gridView.ib.GQ(xa)}C9g(xa){return Object(ka.a)(new Z,{width:xa.wm.width,height:xa.wm.height})}X9g(xa,gb,va){return Object(ka.a)(new Ra,{containerId:xa,overlayContainerInfo:gb,overlayCavityInfos:va?[va]:null})}oPh(xa,gb,va){var sa=R.g(this.$).ha.Qa.dc;if(!sa)return t.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),
null;let ab,Ua;if(({kCa:xa,rotation:sa,translateX:ab,translateY:Ua}=sa.extension.rPh(xa)).returnValue){const nb=xa.x-gb.wm.x;return Object(ka.a)(new Na,{left:(va?gb.wm.width-(nb+xa.width):nb)-3+1,top:xa.y-gb.wm.y-3+1,width:xa.width+5,height:xa.height+5,angle:sa,translateX:ab,translateY:Ua})}return null}hQh(xa,gb,va){xa=this.gridView.ob.nvb(this.gridView.ha.sa.activeRange,xa)||pa.a.K3;if(!xa.Ie(gb.wm))return null;const sa=xa.x-gb.wm.x;return Object(ka.a)(new Na,{left:va?gb.wm.width-(sa+xa.width)-2:
sa-3,top:xa.y-gb.wm.y-3,width:xa.width+5,height:xa.height+5})}}Object(n.a)(Da,"PresentModeOverlayRenderer",null,[502,10]);var Ba=a(61);const ea=(xa,gb,va,sa,ab,Ua,nb=null)=>{nb=xa.Na(41,nb);nb.shouldEnablePresentMode=gb;return Ba.g(xa,"SetPresentMode",nb,va,sa,ab,Ua,0)};var Y=a(284);class ja extends Y.a{constructor(xa,gb){super(xa);this.o0i=()=>{this.Rca.wTd(!0)};this.Rca=gb;this.domElement.classList.add("ewr-presentMode-on");xa={[ja.dv]:this.uc};this.Rb=0;this.initializeAndShow("",this.o0i,xa)}get uc(){return"PresentModeWelcomeDialog"}hide(){super.hide();
w.a.Yw(z.a.p5f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)}}Object(n.a)(ja,"PresentModeWelcomeDialog",Y.a,[]);class ca{static get ZEh(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static get $Eh(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?
"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}static requestFullscreen(xa){xa.webkitRequestFullscreen?xa.webkitRequestFullscreen():xa.msRequestFullscreen?xa.msRequestFullscreen():xa.mozRequestFullScreen?xa.mozRequestFullScreen():xa.requestFullscreen?xa.requestFullscreen():t.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?
document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():t.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get xii(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(n.a)(ca,"FullscreenUtils",null,[]);class ba{constructor(xa){this.yoa=
this.gWe=this.cHb=this.O2a=this.Rqc=this.Rca=this.cQa=null;this.ird=this.lPb=this.VMd=!1;this.uMb=!0;this.ugc=!1;this.BTd=!0;this.kPb=this.y1a=this.UCe=0;this.Kvc={};this.Hpc={};this.Gpc={};this.TJf=0;this.B7a=this.X$d=!1;this.qaj=()=>{D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-transition",!1);$removeHandler(this.O2a,"transitionend",this.yoa)};this.gj=()=>{parseInt(this.$.$u.style.right,10)!==this.UCe&&window.requestAnimationFrame(()=>{this.hCc(0);this.$.Jza(I.a.jZ("PresentModeManager.OnContentAreaResized"))})};
this.p6=()=>{var gb=Object(y.a)(L.a,this.$.oa);if(gb&&this.Cz){this.gridView.Tgc=!1;gb=gb.headersVisible;var va=R.g(this.$).rtl;D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on-headers-off",!gb);D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on-rtl",va);(12!==this.y1a&&!gb||32!==this.y1a&&gb&&!va||0!==this.y1a&&gb&&va)&&window.requestAnimationFrame(()=>{this.hCc(2)})}};this.dd=()=>{this.rcf();this.Yg("OnWorkbookOpened");t.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Fp=()=>{this.ird=!0;this.Aea("OnSelectionStarted")};this.Dg=()=>{this.ird=!1;this.Aea("OnSelectionEnded");this.eXf()};this.qh=()=>{this.Aea("OnEditStarted")};this.Lf=()=>{this.Aea("OnEditEnded")};this.Hw=()=>{if(!this.ugc){const gb=e.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");this.Aea("OnVisibleAreaChanged",!0,gb)}};this.xEb=()=>{this.ugc=!0};this.Bn=()=>{this.Aea("OnCurrentSelectionModeChanged");this.eXf();this.Yg("OnCurrentSelectionModeChanged")};this.Tm=
()=>{this.Aea("OnBlockCacheItemEvicted")};this.rf=()=>{this.Aea("OnBlockCacheItemChanged")};this.RF=()=>{this.ugc||this.Aea("OnActiveItemPanesChanged")};this.Ih=()=>{this.ugc=!1;this.Rca.Yg("ActiveSheetChanged");this.p6()};this.BFb=(gb,va)=>{if(gb=Object(y.a)(L.a,va.item))gb.cqb(16,!0),gb.lZa(this.p6)};this.IKi=()=>{ca.xii||(this.Rqc&&this.Rqc.wn&&this.Rqc.hide(),R.g(this.$).eb&&R.g(this.$).Qo(!0),this.wyc(!1),t.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.JKi=()=>{t.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=xa;this.gridView=R.g(this.$);this.Rkj=xa.ya.PresentModeRenderUpdateTimeout;this.initialize(xa)}get Cz(){return this.X$d}wyc(xa){this.Cz!==xa&&(this.X$d=xa,this.B7a=this.Cz,this.rcf(),this.uMb=this.X3f(),window.requestAnimationFrame(()=>{D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-transition",!0);$addHandler(this.O2a,"transitionend",this.yoa);
this.YAj(!xa);this.cWi();D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on",xa);this.XAj(xa);A.b(this.$).h5f(this.Cz);A.c(this.$).h5f(this.Cz);this.$.hAa();this.cQa.j5f(this.uMb);if(this.Cz){this.e_a();w.a.get(z.a.p5f)?this.Rca.wTd(this.Cz):this.Rqc=new ja(this.$,this.Rca);var gb=O.b(this.$);gb&&(this.VMd=gb.z8c(!1));this.TJf=J.HelperMethods.Sb()}else this.Rca.wTd(xa),this.VMd&&(gb=O.b(this.$))&&(gb.z8c(!0),this.VMd=!1),this.z6b(),this.fwi()}))}k5f(xa,gb){this.BTd=xa;this.Aea(gb)}Yg(xa){this.Rca.Yg(xa)}dispose(){this.z6b();
this.cQa&&(this.cQa.dispose(),this.cQa=null);this.gridView=this.$=null}YAj(xa){const gb=this.$.da.za(25);void 0===gb||null===gb?t.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):xa?gb.ryc():gb.Wdc()}cWi(){D.DOMElementExtensions.toggleCssClass(document.getElementById(r.AFrameworkApplication.Y2a),B.a.Xp,this.Cz);D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on",this.Cz);this.aBj(this.Cz);this.gridView.Tgc=!this.Cz;this.iTj();this.$.da.Za(32,
xa=>{xa.ETj(this.Cz)});T.b(this.$,xa=>{xa.xeg(this.Cz)})}aBj(xa){if(this.cHb)if(xa){if(xa=Object(y.a)(L.a,this.$.oa))D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on-headers-off",!xa.headersVisible),D.DOMElementExtensions.toggleCssClass(this.$.qr,"ewr-presentMode-on-rtl",R.g(this.$).rtl);this.hCc(0)}else this.$.qr.classList.remove("ewr-presentMode-on-headers-off"),this.$.qr.classList.remove("ewr-presentMode-on-rtl"),this.hCc(1)}hCc(xa){var gb=Object(y.a)(L.a,this.$.oa);if(gb){var va=
parseInt(this.$.$u.style.right,10);if(1===xa||2===xa){if(isNaN(va)||va<this.y1a)return;va-=this.y1a}if(0===xa||2===xa)xa=gb.headersVisible,gb=R.g(this.$).rtl,xa=xa?gb?0:32:12,va=isNaN(va)?xa:va+xa,this.y1a=xa;this.$.$u.style.right=J.HelperMethods.pc(va);this.UCe=va}}iTj(){const xa=document.getElementById(this.$.Cb+z.a.$5b).parentNode;D.DOMElementExtensions.toggleCssClass(xa,x.Lrh,this.Cz)}initialize(xa){this.cQa=new Da(xa);this.cQa.dbi();this.Rca=new P(xa);this.Rca.rai();this.O2a=document.getElementById("MainApp");
this.gWe=this.IKi;$addHandler(this.O2a,ca.ZEh,this.gWe);$addHandler(this.O2a,ca.$Eh,this.JKi);this.cHb||(this.cHb=document.createElement("div"),this.cHb.className="ewa-presentMode-right-frame",this.$.PE.appendChild(this.cHb));this.yoa=this.qaj}e_a(){this.gridView.ha.s2(this.Fp);this.gridView.ha.cY(this.Dg);this.gridView.hc.Vk(this.qh);this.gridView.hc.lm(this.Lf);this.gridView.rC(this.Bn);this.gridView.view.Xs(this.Hw);this.gridView.nVc(this.xEb);this.gridView.Ea.XG(this.Tm);this.gridView.Ea.Ws(this.rf);
this.$.xa.Qf(this.Ih);this.$.xa.Tra(this.RF);this.$.xa.Oga(this.BFb);this.$.LA(this.gj);this.$.kl(this.dd);const xa=Object(y.a)(H.a,this.$.xa);for(const gb of xa.items)gb.lZa(this.p6)}z6b(){this.gridView&&(this.gridView.ha.W6(this.Fp),this.gridView.ha.kW(this.Dg),this.gridView.hc.Ak(this.qh),this.gridView.hc.Fl(this.Lf),this.gridView.MD(this.Bn),this.gridView.view.Zq(this.Hw),this.gridView.cKd(this.xEb),this.gridView.Ea.sI(this.Tm),this.gridView.Ea.Xq(this.rf));if(this.$){this.$.xa.Eg(this.Ih);this.$.xa.Zza(this.RF);
this.$.xa.Vma(this.BFb);this.$.LD(this.gj);this.$.Hl(this.dd);const xa=Object(y.a)(H.a,this.$.xa);for(const gb of xa.items)gb.Atc(this.p6)}}X3f(){if(!this.Cz||!this.B7a)return!1;if(1===this.gridView.ha.Me){const xa=this.$.oa.activeRange.isSingle,gb=1===this.$.oa.selectedRanges.length&&!xa,va=this.gridView.eb,sa=this.ird;gb||t.ULS.sendTraceTag(537154322,0,50,`PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : ${xa}`);return this.BTd&&gb&&!va&&
!sa}return this.BTd}XAj(xa){xa?ca.requestFullscreen(this.O2a):ca.exitFullscreen()}Aea(xa,gb=!1,va=!1){gb||(this.uMb=this.X3f());t.ULS.sendTraceTag(555356484,0,100,`PresentModeManager.UpdateLayout: UpdateLayout triggered by ${xa}, visibility: ${this.uMb}, immediateUpdate: ${va}`);if(this.lPb&&va)t.ULS.sendTraceTag(543023559,0,50,`PresentModeManager.UpdateLayout: Cancel update layout for ${this.kPb}`),window.cancelAnimationFrame(this.kPb),this.kPb=0;else if(this.lPb){t.ULS.sendTraceTag(543023558,0,
50,`PresentModeManager.UpdateLayout: Skipping update layout for ${xa}`);return}va?this.$Zd(J.HelperMethods.Sb(),xa):(this.kPb=window.requestAnimationFrame(sa=>{this.$Zd(sa,xa)}),this.lPb=!0)}$Zd(xa,gb){var va=J.HelperMethods.Sb();if(va-xa>this.Rkj)this.kPb=window.requestAnimationFrame(ab=>{this.$Zd(ab,gb)}),this.lPb=!1,t.ULS.sendTraceTag(537154319,0,50,`PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = ${va-xa}ms.`);else{this.cQa.j5f(this.uMb);this.lPb=!1;var sa=
J.HelperMethods.Sb();xa=J.HelperMethods.Sb()-xa;va=sa-va;this.Sjj(xa,gb);t.ULS.sendTraceTag(537154318,0,50,`PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = ${va}ms. rafTotalDuration = ${xa}ms`)}}rcf(){U.a(this.$.userOperationManager,(xa,gb,va)=>ea(this.$.pa.va,this.Cz,xa,gb,va,null),xa=>new X.a(252,0,xa),null)}eXf(){let xa=G.a(this.gridView.Me);1!==this.gridView.Me||this.$.oa.activeRange.isSingle||(xa="Range");this.Kvc[xa]=this.Kvc[xa]?this.Kvc[xa]+1:1}Sjj(xa,gb){const va=this.Hpc[gb]?
this.Hpc[gb]:0;this.Hpc[gb]=va>xa?va:xa;this.Gpc[gb]=this.Gpc[gb]?this.Gpc[gb]+1:1}fwi(){const xa={};var gb=J.HelperMethods.Sb()-this.TJf;xa.PresentModeDuration=gb;xa.SelectionCountPerObject=v.a.toJSON(this.Kvc);xa.OverlayCountPerCaller=v.a.toJSON(this.Gpc);xa.OverlayDurationPerCaller=v.a.toJSON(this.Hpc);gb=this.Rca.rZh();for(let va in gb)xa[va]=gb[va];Q.b(this.$).Hd(F.a.m0i,xa,void 0,!0)}}Object(n.a)(ba,"PresentModeManager",null,[371,10]);var ua=a(184);class wa extends u.a{constructor(xa){super();
this.$=xa;this.Eb()}create(){const xa=d.GetServiceTaskFactory.Sa(this.$.da,283,284,1);f.TaskExtensions.Aa(xa,()=>{f.TaskExtensions.Aa(ua.c(xa.result.ko.loadScript("presentMode")),()=>{let gb=this.$.da.za(423);gb||(gb=new ba(this.$),this.$.da.Ga(423,gb));this.pb(gb)},this.$.la,3)},this.$.la,3)}static ka(xa){xa.da.Ga(424,new wa(xa))}}Object(n.a)(wa,"PresentModeManagerFactory",u.a,[]);a.d(C,"a",function(){return ia});const ia=()=>{c.a.Fa(xa=>{wa.ka(xa);m.ka(xa)})}},1166:function(n,C,a){var c=a(9);n=
a(0);var b=a(553),d=a(694),f=a(50),e=a(37),k=a(15),l=a(1235),m=a(4),u=a(164),t=a(754),w=a(98),r=a(263),v=a(644),y=a(27),x=a(155),B=a(178),z=a(289),A=a(5),I=a(147),F=a(102),U=a(77),X=a(72),T=a(370),G=a(171),D=a(59),J=a(61),L=a(324),H=a(588),R=a(1328),Q=a(416),O=a(317),V=a(14);class W extends R.a{constructor(Bb,Nb){super(Bb,void 0,void 0,Nb)}get COa(){return V.a.instance.Va(413)}get $jc(){return V.a.instance.Va(414)}get Zjc(){return"DownloadOdsLink"}get aCb(){return"#"}get A8a(){return V.a.instance.Va(415)}get Grf(){return!0}jnf(){k.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")}lnf(){k.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")}Tjc(){Q.Redirect.showHelp(O.a.pFi);return!0}}Object(n.a)(W,"DownloadACopyAsOdsDialog",R.a,[]);class da{constructor(Bb,Nb){this.dialog=null;this.Lxf=()=>{this.dialog&&this.dialog.hide()};this.FFi=Bb;this.rb=Nb;this.rb.unb(this.Lxf)}Jte(Bb){this.dialog=Bb}s7c(){this.FFi.mGf(-1059172980)}dispose(){this.rb.TIb(this.Lxf)}}
Object(n.a)(da,"DownloadACopyAsOdsDialogDownloadBehavior",null,[292,10]);const ta=(Bb,Nb,Ia,jb,Ob,Jb,Kb=null)=>{Kb=Bb.Na(9,Kb);Kb.isReadOnlyRecommended=Nb;return J.g(Bb,"SetReadOnlyRecommended",Kb,Ia,jb,Ob,Jb,0)},K=(Bb,Nb,Ia,jb,Ob,Jb,Kb=null)=>{Kb=Bb.Na(9,Kb);Kb.calc_type=Nb;return J.g(Bb,"SetCalculationOptions",Kb,Ia,jb,Ob,Jb,0)};class na{constructor(Bb){this.calculationMode=0;this.calculationMode=Bb}}Object(n.a)(na,"MacroRecorderWorkbookCalculationModeSetPayload",null,[115]);class P{constructor(Bb){this.calculateType=
0;this.calculateType=Bb}}Object(n.a)(P,"MacroRecorderWorkbookRecalculatedPayload",null,[115]);var ka=a(85),pa=a(144),Na=a(189),Z=a(13),Ra=a(108),Da=a(1);R=a(261);class Ba{static get YUi(){return Ba.XUi}}Ba.XUi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(n.a)(Ba,"OpenInAppDialogCopyHtml",null,[]);var ea=a(151);class Y extends R.a{constructor(Bb){super(Bb);this.bI=null;this.FEb=()=>{k.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(this.$.ya.IsMeetingLiveSession)return this.oEc(),!0;y.a.xp?(k.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),this.Dx&&this.Dx.length||k.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),this.openUrl("intent:"+this.Dx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+
this.zm+";end","_top")):9<=y.a.bld?(k.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),this.openUrl(this.Qla,"_top"),window.setTimeout(()=>{this.openUrl(this.zm,"_blank")},9E3)):(k.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),this.openUrl(this.Qla,"_top"),window.setTimeout(()=>{this.openUrl(this.zm,"_blank")},500));
return!0};this.iPa=Nb=>Nb.Ca.keyCode===ka.a.fi||Nb.Ca.keyCode===ka.a.Toa?(k.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Nb.Db.click(),!0):!1;1===m.AFrameworkApplication.ta.Oa.Dj&&(this.Dx=this.$.workbookContext.ClientUrl,this.Qla="ms-excel:ofe|u|"+this.Dx,this.zm=m.AFrameworkApplication.fa.Xa("AppUrl"),y.a.yba?this.zm="itms-apps://"+m.AFrameworkApplication.fa.Xa("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":y.a.xp&&(Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",
!1)&&this.$.ya.IsMeetingLiveSession?(k.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),this.zm=m.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):y.a.Szb?this.zm=m.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<y.a.KWc.wOa&&(this.zm=m.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac")))}get uc(){return"OpenInAppDialogCopy"}openUrl(Bb,Nb){let Ia=document.getElementById("link");
Ia||(Ia=document.createElement("a"),Ia.id="link",Ia.style.visibility="hidden",Ia.href="",document.body.appendChild(Ia));Ia.target=Nb;Ia.href=Bb;Ia.click()}oEc(){k.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");e.TaskExtensions.Aa(f.GetServiceTaskFactory.Sa(this.$.da,21,137,1),Bb=>{let Nb={};Nb.OpenInAppUrl=this.Qla;Nb.StoreUrl=this.zm;Bb.result.Mj("UI_OpenInMobileApp",Nb)},this.$.la)}ZUi(){k.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")}Ag(){this.mg=
pa.a.Yp(Ba.YUi,V.a.instance.ga(667),V.a.instance.ga(668),m.AFrameworkApplication.pB,ea.getImageClass(m.AFrameworkApplication.fa.Xa("AppIcon")),V.a.instance.ga(669));this.Ce="OpenInAppDialog";this.Rb=5;this.initializeAndShow("",this.ZUi.bind(this),null);this.EI(this.bI)}Cv(Bb){super.Cv(Bb);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.bI=document.getElementById("LinkToInstall");Na.a.instance.ra(Z.a.click,this.bI,this.FEb);Ra.KeyInputManager.instance.ra(Z.a.Ed,this.bI,
this.iPa)}dispose(){this.bI&&(Na.a.instance.Ba(Z.a.click,this.bI,this.FEb),Ra.KeyInputManager.instance.Ba(Z.a.Ed,this.bI,this.iPa),this.bI=null);super.dispose()}}Object(n.a)(Y,"OpenInAppDialogCopy",R.a,[]);var ja=a(134),ca=a(372);class ba{constructor(Bb){this.Y7h="itms-apps://";this.Z7h="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.Mkg=Nb=>{1==Nb&&this.oEc()};this.$=Bb;this.Dx=m.AFrameworkApplication.ta.Oa.Dx;this.Qla="ms-excel:ofe|u|"+this.Dx;this.zm=m.AFrameworkApplication.fa.Xa("AppUrl");
y.a.yba||y.a.Xg?this.zm=this.Y7h+this.Z7h:y.a.xp&&(m.AFrameworkApplication.fa.qa("UseAppAndroidMarketURL")?(k.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.zm=m.AFrameworkApplication.fa.Xa("WildFireMarketUrlExcelAndroid")):y.a.Szb?this.zm=m.AFrameworkApplication.fa.Xa("WildFireUrlChinaStoreAndroid"):4<y.a.KWc.wOa&&(this.zm=m.AFrameworkApplication.fa.Xa("WildFireUrlExcelAndroid")))}oEc(){k.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");
e.TaskExtensions.Aa(f.GetServiceTaskFactory.Sa(this.$.da,21,137,1),Bb=>{let Nb={};Nb[ca.a.sGf]=this.Qla;Nb[ca.a.zm]=this.zm;Bb.result.Mj("UI_OpenInMobileApp",Nb)},this.$.la)}Ag(){k.ULS.sendTraceTag(523534412,0,50,"initializeAndShowDialog: React Edit in app dialog opened.");const Bb=new ja.StandardDialog;Bb.Rb=0;Bb.rc(1,V.a.instance.ga(673));Bb.Dl(V.a.instance.ga(671),V.a.instance.ga(672),0,this.Mkg)}}Object(n.a)(ba,"OpenInAppDialogReact",null,[]);R=a(284);class ua extends R.a{constructor(Bb){super(Bb);
this.sessionId=Bb.ya.UserSessionId;this.pSg=Bb.ya.BuildVersion}get uc(){return"WACSessionIdDialog"}WM(){return{[ua.noj]:V.a.instance.ga(674),[ua.ooj]:this.sessionId,[ua.id]:"WACSessionIdDialog",[ua.qZc]:V.a.instance.ga(675),[ua.buildVersion]:this.pSg}}Ag(){const Bb=this.WM();this.Rb=5;this.initializeAndShow(V.a.instance.ga(1026),this.aXj.bind(this),Bb)}aXj(){k.ULS.sendTraceTag(521434688,306,100,"Show WACSessionIdDialogHandler invoked")}}ua.id="id";ua.noj="sessionIdLabel";ua.ooj="sessionIdValue";ua.qZc=
"buildLabel";ua.buildVersion="buildVersion";Object(n.a)(ua,"WACSessionIdDialog",R.a,[]);var wa=a(28),ia=a(29),xa=a(354),gb=a(11),va=a(183),sa=a(281),ab=a(21),Ua=a(42),nb=a(249),Ha=a(459),sb=a(376),Qb=a(51),mb=a(6),Pb=a(141),gc=a(970),Xb=a(81),Ca=a(36),ra=a(300),ma=a(252);class hb{xQ(Bb,Nb){Bb=ia.a.Yc(12,1,676,0,0,0,"Blank");Bb.Description=String.format(V.a.instance.ga(677),Nb);return Bb}aac(Bb){switch(Bb){case 1:case 2:return 0;default:return 2}}}Object(n.a)(hb,"ReloadCloseConfirmation",null,[110]);
var vb=a(149),Va=a(589),db=a(68),oa=a(55),Oa=a(176);class Wa extends B.a{constructor(Bb,Nb,Ia,jb){super();this.$=Bb;this.businessBar=jb;this.openInExcelOperation=Nb;this.hK=Ia}get fc(){return this.$.ea.fc}get workbookContext(){return this.$.workbookContext}get p7b(){return this.$.workbookContext.FullDocumentInfo}get clientWorkflow(){return db.a(this.$)}get jc(){return this.$.jc}Lc(){return!1}executeCommand(Bb,Nb,Ia,jb){const Ob=this.p7b,Jb=this.$,Kb=Nb.command,Qa=this.openInExcelOperation,ha=this.$.Cb,
qa=Ia.SourceControlId;Jb.el.pne(Kb);Qa.exc(Nb.startTime.getTime().toString());Bb=null;switch(Kb){case 1455037301:this.$.h5?Qa.dDe():Qa.Y2c();break;case -2044628748:case 2004484710:this.$.h5?Qa.dDe():Qa.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===qa?(this.DCb("CellLongPress"),k.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.DCb("PencilIcon"),k.ULS.sendTraceTag(576495704,
0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case 924877417:k.ULS.sendTraceTag(520372316,0,50,"User clicked the reload button");const pb=db.a(this.$).kd.activityState;Ua.a(Jb).Bs(new nb.a(mb.a.Ux,5,()=>{pb[ma.a.Aq]=mb.a.hj}));break;case 480922297:Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowWacSessionIdDialogOnMobile",!1)&&(new ua(this.$)).Ag();break;case -2028960985:Qa.Z6f();break;
case -1059172980:new W(Qa.awe(Kb),new da(Qa,Jb.rb));break;case -1285148982:this.clientWorkflow.kd.activityState[Ca.a.nUc]=!0;this.iBc(!1);break;case -75280711:this.iBc(!1);break;case -455164169:this.iBc(!0);break;case -1388494670:this.$.da.Za(400,jc=>{jc.fzi();this.iBc(!1)});break;case 810888577:m.AFrameworkApplication.qk=(new Date).getTime();k.ULS.sendTraceTag(537162656,0,50,`FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to ${m.AFrameworkApplication.qk}`);break;case -1804063550:case -974518828:Nb=
0;A.a.hDd in Ia&&(Nb=Ia[A.a.hDd]);Qa.mGf(Kb,Nb);break;case -1339961039:Nb=!1;Ia&&A.a.RJb in Ia&&(Nb=Ia[A.a.RJb]);this.reloadWorkbook(!1,Nb);break;case -8805455:const bb=this.workbookContext;Jb.isEditMode||(Wa.GAe(Jb),Bb=e.TaskExtensions.Aa(this.hK.value,jc=>{jc=jc.result;var fb=jc.isEnabled();fb&&H.a(jc,u.a.copyAndEdit,D.a.wg.$Ye(),this.$.ea.Wg.get(2))?k.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
fb&&m.AFrameworkApplication.Vfg?(fb={},fb[l.a.dGd]=m.AFrameworkApplication.userSessionId,fb[m.AFrameworkApplication.qBi]=wa.a.Pa.zb.getTime().toString(),k.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),jc.Mj(u.a.editMode,fb)):Ob.CopyAndEditUrl?this.F4g():(this.jc.supportsEditing||bb.EditUrl)&&this.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Jb.isEditMode&&(Wa.GAe(Jb),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:const eb=Jb.pa.va.Tb(),Fa=-1355155015===Kb?1:0,tb=()=>new P(Fa);Bb=T.a(this.$.userOperationManager,(jc,fb,ec)=>J.y(Jb.pa.va,Fa,null,jc,fb,ec,null,eb),jc=>new G.a(128,0,jc,void 0,tb),Nb);ab.g(Jb).Ff.eH(!1);break;case -1158102843:Bb=ab.g(Jb).Ff.recalcSheet(Nb);ab.g(Jb).Ff.eH(!1);break;case -988468372:if(Da.EwaSettings.ma(301))if(jb=parseInt(Ia[U.a.Qc],10),0<=jb&&3>jb)this.setCalculationMode(Nb,jb);else return k.ULS.sendTraceTag(537162652,
0,10,`SetCalculationMode , unexpected menuItemId: ${Ia[U.a.Qc]}`),va.a(Kb);break;case 257398710:I.a.ntw(Ob.ReportAbuseUrl,Jb);break;case 1800405051:this.Ojj();break;case -48469327:this.saveACopy();break;case 214430355:Nb=!1;Ia&&A.a.$7c in Ia&&(Nb=Ia[A.a.$7c]);if(!this.zxj(Nb,Ia))break;m.AFrameworkApplication.X4?this.businessBar.Zf(42,null):this.businessBar.Zf(Nb?22:23,null);break;case 1389557314:Bb=e.TaskExtensions.Aa(this.hK.value,jc=>{H.a(jc.result,u.a.qAh,null,this.$.ea.Wg.get(6))||I.a.ntw(Ob.FileVersionUrl,
Jb)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:qa===ha+A.a.hkf?Qa.Nri():Qa.Mri();break;case 512141517:qa===ha+A.a.gkf?Qa.Xri():Qa.Wri();break;case -1224038235:const dc=t.a.On in Ia?!Ia[t.a.On]:F.j(Jb.ea.workbookContext.Options);Ia[t.a.Description]=dc?V.a.instance.ga(576):V.a.instance.ga(577);Bb=T.a(this.$.userOperationManager,(jc,fb,ec)=>ta(this.$.pa.va,!dc,jc,fb,ec,null),jc=>new G.a(129,0,jc),Nb);break;case 1118926154:if(this.$.isEditMode){const jc=new x.a;this.$.da.Za(53,
fb=>{fb?(fb.cm.Fri(this.$.Cb+A.a.Lsd),jc.setResult(!0)):k.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});Bb=jc.task}break;case -1698025133:Qa.openInBrowser();break;case 520859864:Bb=e.TaskExtensions.Aa(f.GetServiceTaskFactory.Sa(this.$.da,393,394,jb.Raa()),jc=>{jc.result||k.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:Bb=va.a(Kb)}return Bb||oa.Task.Ta(!0)}DCb(Bb){if(gb.HelperMethods.OZ){const Nb=
new Map;Nb.set("EntryPoint",Bb);w.Health.instance.recordKpiUsage(sb.a.WUi,0,Ha.a.cBi,Nb)}else k.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")}showOpenInAppDialog(){m.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(k.ULS.sendTraceTag(522859990,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app React dialog used"),
(new ba(this.$)).Ag()):Da.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(k.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new Y(this.$)).Ag()):(k.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),m.AFrameworkApplication.showOpenInAppDialog()))}zxj(Bb,Nb){return m.AFrameworkApplication.isMobileMode&&!X.a(this.$.ya,30)?
(this.showOpenInAppDialog(),k.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.DCb("CellDoubleTap"),k.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):m.AFrameworkApplication.thc&&(Bb&&xa.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(k.ULS.sendTraceTag(537162645,
0,50,`FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .${xa.d(this.workbookContext.WorkbookFileName)?"xls":"csv"}, HostEditUrl ${this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""}empty. Skipped prompt to edit`),!1):r.a.any([25,26,30,31,57,32,34],Ia=>this.businessBar.Aka(Ia))?(k.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),
!1):Nb&&A.a.Z1i in Nb&&!Bb?!1:!0}Ac(Bb,Nb){Bb=!1;switch(Nb.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:Bb=!0;break;case 480922297:case 520859864:Bb=Da.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?
!0:!1;break;case 924877417:Bb=Oa.a.Ygc?!0:!1;break;case -1285148982:case -75280711:case -455164169:Bb=Da.EwaSettings.ma(108);break;case -1388494670:Bb=Da.EwaSettings.ma(108);break;case 810888577:Bb=Da.EwaSettings.ma(270);break;case -1224038235:Bb=this.$.ea.amIAlone;break;case -988468372:Bb=Da.EwaSettings.ma(301);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:Bb=!0,k.ULS.shipAssertTag(537162642,0,this.$.wka,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return Bb}Oc(){return!1}Ojj(){if(this.fc){var Bb=
this.$;Ua.a(Bb).Bs(new nb.a(mb.a.Ux,5,()=>{Bb.qI(!1,!0);const Nb=this.clientWorkflow.kd.activityState;Nb[ma.a.Aq]=mb.a.Bda;Nb[Pb.a.nT]=2;Nb[Ca.a.Qr]=Bb.isEditMode;Nb[Pb.a.Cga]=!1}))}}saveACopy(){if(this.fc){var Bb=this.$;Ua.a(Bb).Bs(new nb.a(mb.a.Ux,5,()=>{Bb.qI(!1,!1);const Nb=this.clientWorkflow.kd,Ia=Nb.activityState;Ia[ma.a.Aq]=mb.a.IWf;Ia[Va.a.dZb]=this.jc.hasUnsupportedFeaturesForEdit;Ia[Pb.a.Cga]=!1;Nb.kr(ia.a.T3(this.businessBar.s8c,[-502303485]))}))}}iBc(Bb){Ua.a(this.$).Bs(new nb.a(mb.a.wna,
2,()=>{this.$.qI(!0,!0);var Nb=db.a(this.$).kd,Ia=this.$.isEditMode;Ia=ia.a.Yc(1,1,0,0,0,Ia?-315732528:-2087635043,Ia?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ia.ForceVersionUpgrade=Bb;Nb.kr([Ia]);Nb=db.a(this.$).kd.activityState;Nb[ma.a.Aq]=mb.a.wna;Nb[Ca.a.Qr]=this.$.isEditMode;Nb[Pb.a.Cga]=!1}))}closeWorkbook(){if(this.fc){var Bb=this.$;D.a.wg.Hxc("2145659238")?e.TaskExtensions.Aa(this.hK.value,Nb=>{Nb.result.Mj(u.a.vTe,{})},this.la,3):Ua.a(Bb).Bs(new nb.a(mb.a.Ux,5,()=>{Bb.qI(!0,
!1);const Nb=this.clientWorkflow.kd.activityState;Nb[Pb.a.XX]=!1;Nb[Pb.a.Cga]=!1;this.jc.inViewerFromWebPart?(L.a.TGd(Bb,this.clientWorkflow.kd),Bb.el.Ty("InViewerFromWebPart"),Nb[ma.a.Aq]=mb.a.r_):(Nb[ma.a.Aq]=mb.a.Rj,Bb.Cd&32?Nb[Pb.a.nT]=0:(Nb[Pb.a.nT]=1,Nb[Pb.a.TYb]=new gc.a),Nb[vb.a.Nle]=!0)}))}}F4g(){const Bb=this.jc.vbaRemovedDuringConversion;k.ULS.sendTraceTag(537162636,0,50,`FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = ${Bb}`);const Nb=this.$;Bb?Ua.a(Nb).Bs(new nb.a(mb.a.Ux,
5,()=>{const Ia=ia.a.Yc(3,0,0,1268,0,1069271157,"XLSMacroFailure");this.clientWorkflow.kd.kr([Ia]);this.clientWorkflow.kd.activityState[ma.a.Aq]=mb.a.efb})):m.AFrameworkApplication.hideHeader?gb.HelperMethods.Ze(this.p7b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):I.a.ntw(this.p7b.CopyAndEditUrl,Nb)}reloadWorkbookInEditMode(){if(this.fc)if(D.a.wg.oV&&D.a.wg.IId(),m.AFrameworkApplication.thc&&!m.AFrameworkApplication.Jba)gb.HelperMethods.Ze(this.$.qpb(!0),z.a.blank,
void 0,"FileOperationCommandHandler.BuildHostUrl");else{var Bb=this.$,Nb=!1,Ia=this.jc.hasUnsupportedFeaturesForEdit,jb=this.workbookContext.FileWasRepaired;xa.d(this.workbookContext.WorkbookFileName)?(Nb=!0,k.ULS.sendTraceTag(537162634,0,50,`FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = ${Ia}`)):xa.a(this.workbookContext.WorkbookFileName)&&(Nb=!0,k.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));
var Ob=Bb.pe.get(59);Ob=!(Bb.ea.jc.supportsEditing&&Ob);if(Nb&&!Ia||Ob&&(Nb||Ia)){let Jb;Jb=Ob?Ia?-2066104278:816071846:Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&X.a(this.$.ya,25)&&!this.$.DAb?765011943:-213064907;Nb=()=>{const Kb=ia.a.I_a([Jb]);this.clientWorkflow.kd.kr(Kb);this.clientWorkflow.kd.activityState[ma.a.Aq]=mb.a.efb}}else Nb=()=>{Bb.qI(!0,!1);var Jb=this.clientWorkflow.kd;const Kb=Jb.activityState;Kb[Pb.a.nT]=1;Kb[ra.a.YYb]=v.a.Elc;Kb[Ca.a.Qr]=!0;Kb[Va.a.dZb]=
this.jc.hasUnsupportedFeaturesForEdit;Kb[Pb.a.Cga]=!!this.workbookContext.EditUrl;Kb[Xb.a.h2]=this.workbookContext.EditUrl;if(!this.p7b.CopyAndEditUrl){const Qa=[Da.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&X.a(this.$.ya,25)&&!this.$.DAb?-943219229:1821390342];Jb.kr(ia.a.T3(this.businessBar.s8c,Qa))}jb&&!Ia?(xa.b(this.workbookContext.WorkbookFileName)&&Da.EwaSettings.isChangeGateEnabled("OfficeVSO:5693008_CGForFlightODFRepairEnabled")?(Jb=ia.a.I_a([-425642652]),
k.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):Jb=ia.a.I_a([108482388]),this.clientWorkflow.kd.kr(Jb),Kb[ma.a.Aq]=mb.a.WWf):this.$.ea.p8e?(k.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Qb.b().$Ud("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Kb[ma.a.Aq]=mb.a.vGb):Kb[ma.a.Aq]=
this.$.ea.dhc?mb.a.eCb:mb.a.efb};Ua.a(Bb).Bs(new nb.a(mb.a.Ux,5,Nb))}}reloadWorkbookInViewMode(){if(this.fc){D.a.wg.oV&&D.a.wg.IId();var Bb=this.$;y.a.Xg&&ab.g(Bb).Xb.textBox.blur();Ua.a(Bb).Bs(new nb.a(mb.a.Ux,5,()=>{Bb.qI(!Bb.ea.isNamedObjectViewMode,!1);const Nb=this.clientWorkflow.kd.activityState;Nb[ma.a.Aq]=mb.a.Hha;Nb[Pb.a.nT]=1;Nb[Pb.a.XX]=!0;Nb[Ca.a.Qr]=!1;Nb[Ca.a.Rmb]=!0;Nb[ra.a.YYb]=v.a.Elc}))}}reloadWorkbook(Bb,Nb){if(this.fc){var Ia=this.$;Ia.JU&65536&&Ua.a(Ia).Bs(new nb.a(mb.a.Ux,5,
()=>{Ia.qI(Bb,!0);const jb=this.clientWorkflow.kd.activityState;jb[ma.a.Aq]=mb.a.dz;jb[Ca.a.qUc]=this.workbookContext.NovMode;Nb||(jb[Pb.a.nT]=1,jb[Pb.a.TYb]=new hb)}))}}setCalculationMode(Bb,Nb){k.ULS.sendTraceTag(537162629,0,50,`SetCalculationMode ,calculation mode chosen : ${Nb} `);const Ia=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=Nb;const jb=()=>new na(Nb);return T.a(this.$.userOperationManager,(Ob,Jb,Kb)=>K(this.$.pa.va,Nb,sa.b(Ob,Wa.NRi(this.$,Ia)),sa.a(Jb,Wa.MRi(this.$,
Ia)),Kb,null),Ob=>new G.a(197,0,Ob,void 0,jb),Bb)}static GAe(Bb){Bb.rb&&0<Bb.rb.uR&&Bb.rb.S$c(Nb=>{Nb.Zu()})}static NRi(Bb,Nb){return Ia=>{ia.a.ug(Ia.Errors)&&(Bb.ea.workbookContext.CalcMode=Nb,k.ULS.sendTraceTag(537162628,0,50,`OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to ${Nb}.  Error id names: ${ia.a.xc(Ia.Errors)}`))}}static MRi(Bb,Nb){return()=>{Bb.ea.workbookContext.CalcMode=Nb;k.ULS.sendTraceTag(537162627,0,50,`OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to ${Nb})`)}}}
Object(n.a)(Wa,"FileOperationsCommandHandler",B.a,[164]);var Sa=a(152);class yb extends d.a{constructor(Bb){super(Bb)}vd(){const Bb=this.$,Nb=[],Ia=f.GetServiceTaskFactory.create(Bb.da,56,this.la,this.fb);Nb.push(Ia);const jb=f.GetServiceTaskFactory.Sa(Bb.da,5,4,this.fb);Nb.push(jb);e.TaskExtensions.Aa(oa.Task.XI(...Nb),()=>{Sa.b(Ia)&&this.$c([new Wa(Bb,Ia.result,new b.a(()=>f.GetServiceTaskFactory.create(Bb.da,137,this.la,this.fb)),jb.result)])},this.la,0)}static ka(Bb){d.a.Od(94,new yb(Bb))}}Object(n.a)(yb,
"FileOperationsCommandHandlerFactory",d.a,[]);a.d(C,"a",function(){return Ma});const Ma=()=>{c.a.Fa(yb.ka)}},1167:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(8),f=a(19),e=a(66),k=a(60),l=a(5),m=a(31);class u{}u.jsh="ewa-resizehdr-row-hidden";u.ish="ewa-resizehdr-col-hidden";Object(n.a)(u,"CssClassNames",null,[]);var t=a(237),w=a(13),r=a(154),v=a(633),y=a(27),x=a(223),B=a(4),z=a(263),A=a(15),I=a(77),F=a(132),U=a(43),X=a(145),T=a(24),G=a(53),D=a(12),J=a(71),L=a(1),H=a(93),R=a(11),Q=a(14),O=a(250),
V=a(133),W=a(371),da=a(42),ta=a(34);class K{constructor(Ca,ra,ma,hb,vb,Va,db){this.iwa=Ca;this.vDb=ra;this.UOa=ma;this.akd=hb;this.mcb=vb;this.ejf=Va;this.k5h=db}}Object(n.a)(K,"HeaderEventCachedInfo",null,[]);class na{constructor(Ca){this.S7c=Ca}uDe(Ca){Ca=R.HelperMethods.HEd(Ca);return Math.max(0,Math.min(na.drf,Ca))}kDe(Ca){return this.IYi(Ca)}c0g(Ca){return Math.round(this.S7c*Ca+2*this.HZe()+1)}IYi(Ca){return Math.max(0,Math.min(na.Iqf,(Math.max(0,Math.min(d.a.hlc,Ca))-2*this.HZe()-1)/this.S7c))}HZe(){return Math.floor(Math.max((this.S7c+
3)/4,2))}Cbc(Ca,ra){return ra?Ca?na.drf:d.a.Wwd:Ca?na.Iqf:d.a.hlc}}na.drf=409;na.Iqf=255;Object(n.a)(na,"ResizeHeadersConverter",null,[]);var P=a(190);class ka extends H.a{constructor(Ca,ra){super(ra.domElement);this.BX=this.QUf=!1;this.aj=this.i8a=this.hBa=null;this.YLd=!0;this.hic=!1;this.sKb=this.ol=this.offset=0;this.bN=this.sW=this.I0=null;this.m6h="headerResizeTooltip";this.wG=this.mvd=null;this.gYc=this.N8=this.jAa=!1;this.KGf=this.R$a=d.a.Iwa;this.Ucf=L.EwaSettings.isChangeGateEnabled("OfficeVSO:6649809_AutoFitHiddenRowCol");
this.iQb=!1;this.JN=ma=>{if(this.grid.Wj)return!1;ma=ta.a(this.grid.$).Vd(ma);if(3===ma.tb&&!this.fjf(ma.Ca)||!this.FJf(ma,!1))return!1;A.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");const hb=this.Ayc();this.bdd(ma.clientPoint,hb,!0);this.jAa||(t.a.instance.ra(w.a.Gj,this.domElement.ownerDocument.body,this.a$a),r.a.instance.ra(w.a.Yf,this.domElement.ownerDocument.body,this.a$a),this.jAa=!0);this.gff()&&this.BX&&this.L$e(ma);return!1};this.MEb=ma=>
{ma=ta.a(this.grid.$).Vd(ma);this.gff()&&this.gYc&&this.L$e(ma);if(!ma.Ca.type.includes("touch")&&ma.Ca.button!==Sys.UI.MouseButton.leftButton||!this.wAb)return!1;J.g(ma.Ca);this.sMe();ma=this.grid.Wj?this.R$a:d.a.Iwa;var hb=!1;if(this.grid.Wj&&this.aj){var vb=ma!==this.ol||!this.Ucf&&this.N8;L.EwaSettings.isChangeGateEnabled("OfficeVSO:7021389_removeHiddenCellFromModelFix")&&!vb&&this.iQb&&(this.Ee.removeRowColFromModel(this.aj.FTc,this.aj.VPf),hb=!0)}else this.aj&&(ma=this.N8?this.Ced():this.aj.f4()),
vb=ma!==this.ol;this.hBa&&vb&&ma!==d.a.Iwa?(ma=this.grid,vb=this.Mgd(ma),hb={},hb.SheetMultiRange=U.r(vb,ma.$),ka.vQd(hb,this.isRow,this.ol),this.cmh(hb),ma.xHj=!0):(hb&&(L.EwaSettings.isChangeGateEnabled("OfficeVSO:7094259_fixSelectionBugAfterRehideRowCol")&&this.Ee.xea(this.grid.ha.sa.selectedRanges),this.Ee.Ip("HeaderResizeBehavior::onDocumentMouseUp")),this.Dg(null,null),this.GIb());return this.iQb=this.N8=!1};this.uca=ma=>{if(this.grid.Wj)return!1;ma=v.a.create(ma.eventName,ma.Db,ma.Ca,ma.tb);
ma=ta.a(this.grid.$).Vd(ma);if(!this.FJf(ma,!0))return!1;ma=this.grid;var hb=this.Mgd(ma);hb=U.r(hb,ma.$);ma.ob.Pg([this.isRow?13:14]);ma.ob.bBa();this.GIb();ma.$.fd(this.isRow?146338636:1391094586,I.a.Gb,30,{["autoFitRanges"]:hb});return!1};this.Izf=ma=>{this.BX?(this.N8&&!this.iQb&&this.GCg(),this.hic||this.cbf(),ma=new Sys.UI.DomEvent(ma),ma=v.a.create(w.a.lha,this.domElement,ma,2),ma=ta.a(this.grid.$).Vd(ma),this.wBd(ma.clientPoint)):A.ULS.sendTraceTag(521480320,2,50,`HeaderResizeBehavior.onHeaderResizeChanged: Reached during no resize mode. cellAbsoluteIndex = ${this.aj?
this.aj.FTc:-1}, isRow = ${this.isRow}`)};this.Jzf=ma=>{ma=new Sys.UI.DomEvent(ma);ma=v.a.create(w.a.lha,this.domElement,ma,2);this.MEb(ma)};this.PMi=ma=>{this.Sya(ma,this.aj,!1)};this.a$a=ma=>{ma=ta.a(this.grid.$).Vd(ma);J.g(ma.Ca);return this.wBd(ma.clientPoint)};this.nI=ma=>{if(this.grid.Wj)return!1;ma=ta.a(this.grid.$).Vd(ma);let hb;if(!this.Dhf||-1!==this.grid.ha.selectionType)return da.a(this.grid.$).gq()&&(hb=this.mfd(ma))&&(hb.iwa.style.cursor=""),!1;if(this.BX)return this.cbf(),!1;hb=this.mfd(ma);
if(!hb)return!1;hb.iwa.style.cursor=!this.grid.eb&&this.wsd(hb)?this.isRow?"row-resize":"col-resize":"";J.g(ma.Ca);return!0};this.Fp=()=>{this.GIb()};this.Dg=()=>{if((3===I.a.Gb||y.a.Ap)&&this.grid.ha.sa.Bg){var ma=this.grid.ha.sa.Xc;if(!(!ma.isRow&&!ma.gf||!this.domElement||ma.isRow&&this.isRow&&!this.Ee.$n.includes(ma.top)||ma.gf&&!this.isRow&&!this.Ee.$n.includes(ma.left))){var hb=this.grid.dg(ma,this.Ee.xj.paneType);if(hb){if(this.grid.Wj){const vb=this.isRow?ma.bottom:ma.right;this.aj=this.Ee.fs(T.Range.Uc(ma.bottom,
ma.right));if(!this.aj){A.ULS.sendTraceTag(522826880,2,50,`HeaderResizeBehavior.onSelectionEnded: Cell being resized is undefined. Couldn't create touch resizer. Absolute index ${vb}, is row ${this.isRow}`);return}}this.wG||this.Zah();ma.isRow&&this.isRow?(D.DOMElementExtensions.setVisible(this.wG,!0),this.wG.style.top=hb.bottomRight.y-this.wG.offsetHeight/2+"px"):ma.isRow||this.isRow||(D.DOMElementExtensions.setVisible(this.wG,!0),O.c(this.wG.style,this.grid.rtl,hb.bottomRight.x-this.wG.offsetWidth/
2+"px"))}}}};this.TF=(ma,hb)=>{L.EwaSettings.isChangeGateEnabled("OfficeVSO:6385697_HeaderResize_LogOnPartialInteractivityStatusChanged")&&A.ULS.sendTraceTag(521787422,2,50,`HeaderResizeBehavior.onPartialInteractivityStatusChanged: was called. isActivated ${hb.dM}`);hb.dM&&this.Tpb()};this.Ee=ra;this.isRow=ra.isRow;this.rtl=ra.xj.rtl;this.grid=Ca;this.Lqf=this.isRow?d.a.Wwd:d.a.hlc;this.h6h=Q.a.instance.ga(441);this.q6h=Q.a.instance.ga(440);this.k6h=Q.a.instance.ga(442);V.a(this.grid.$,ma=>{this.mvd=
ma.ZP(F.a.Wgj,!1)});this.j8i();this.grid.ha.uT(this.Dg);this.grid.ha.s2(this.Fp);this.grid.Uu(this.Dg);da.a(this.grid.$).Wf.E9(this.TF)}get wAb(){return this.BX}get Dhf(){const Ca=(new X.a(this.grid.$.xa)).Wd(this.isRow?16:8),ra=this.grid.$.rb.iy,ma=this.grid.Fi,hb=da.a(this.grid.$).gq();return Ca&&!ra&&!ma&&!hb}get Ygj(){this.Kmh();return ka.ncb}Sya(Ca,ra,ma){var hb=new Sys.UI.DomEvent(Ca);hb=v.a.create(w.a.lha,this.domElement,hb,2);hb=ta.a(this.grid.$).Vd(hb);this.EJf(ra,hb.clientPoint.x,hb.clientPoint.y,
!1,ma,Ca);Ca=this.Ayc();this.bdd(this.hBa,Ca,!0);this.jAa||(Ca=this.domElement.ownerDocument.body,Ca.addEventListener(w.a.lha,this.Izf),Ca.addEventListener(w.a.QGa,this.Jzf),this.jAa=!0)}NMi(Ca,ra,ma){this.EJf(ra,Ca.clientX,Ca.clientY,!0,this.Ucf?ma:!1,Ca);Ca=this.grid;ra=this.Mgd(Ca);ra=U.r(ra,Ca.$);Ca.ob.Pg([this.isRow?13:14]);Ca.ob.bBa();this.GIb();Ca.$.fd(this.isRow?146338636:1391094586,I.a.Gb,30,{["autoFitRanges"]:ra})}dispose(){this.X0c();this.grid.ha&&(this.grid.ha.IR(this.Dg),this.grid.ha.W6(this.Fp));
this.grid.xy(this.Dg);da.a(this.grid.$)&&da.a(this.grid.$).Wf.nda(this.TF);x.a.instance.Ba(w.a.xk,this.domElement,this.uca);t.a.instance.Ba(w.a.Nf,this.domElement.ownerDocument.body,this.MEb);r.a.instance.Ba(w.a.ue,this.domElement.ownerDocument.body,this.MEb);y.a.Ap||(t.a.instance.Ba(w.a.pointerDown,this.domElement,this.JN),t.a.instance.Ba(w.a.Gj,this.domElement,this.nI));this.jAa&&(t.a.instance.Ba(w.a.Gj,this.domElement.ownerDocument.body,this.a$a),r.a.instance.Ba(w.a.Yf,this.domElement.ownerDocument.body,
this.a$a),this.jAa=!1);this.wG&&(t.a.instance.Ba(w.a.pointerDown,this.wG,this.JN),x.a.instance.Ba(w.a.xk,this.wG,this.uca),this.X0c(),this.wG=null);this.QUf&&(D.DOMElementExtensions.sf(ka.ncb),ka.ncb=null);this.Ee=null;super.dispose()}j8i(){x.a.instance.ra(w.a.xk,this.domElement,this.uca);t.a.instance.ra(w.a.Nf,this.domElement.ownerDocument.body,this.MEb);r.a.instance.ra(w.a.ue,this.domElement.ownerDocument.body,this.MEb);y.a.Ap||(t.a.instance.ra(w.a.pointerDown,this.domElement,this.JN),t.a.instance.ra(w.a.Gj,
this.domElement,this.nI))}Kmh(){if(!ka.ncb){document.getElementById(ka.PUf);this.QUf=!0;var Ca=ka.ncb=document.createElement("div");this.grid.$.frame.Gaa().appendChild(Ca);Ca.id=ka.PUf;Ca.className=m.a.ksh;D.DOMElementExtensions.setVisible(Ca,!1)}}sMe(){if(this.jAa){const Ca=this.domElement.ownerDocument.body;this.grid.Wj?(Ca.removeEventListener(w.a.lha,this.Izf),Ca.removeEventListener(w.a.QGa,this.Jzf)):(t.a.instance.Ba(w.a.Gj,Ca,this.a$a),r.a.instance.Ba(w.a.Yf,Ca,this.a$a));this.jAa=!1}this.BX=
!1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")?this.TQf():(this.sVf(),this.WJd());W.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")}sVf(){this.grid.ob.Pg([this.isRow?13:14]);this.grid.ob.bBa()}GCg(){this.Ee.addRowColToModel(this.aj.FTc-1,this.aj.VPf);this.iQb=!0}wBd(Ca){if(!this.BX)return!1;const ra=this.isRow;if(!this.grid.Wj&&!this.I0){this.I0=document.createElement("div");this.I0.style.cssText="position: relative; width: inherit; height: inherit;"+
(ra?"top: 0px; ":this.rtl?"right: 0px:":"left: 0px:");for(var ma=this.aj.gK();ma.nextSibling;)this.I0.appendChild(ma.nextSibling);ma.parentNode.appendChild(this.I0)}ma=ra?Ca.y-this.i8a.y:(this.rtl?-1:1)*(Ca.x-this.i8a.x);const hb=ra?Ca.y-this.hBa.y:(this.rtl?-1:1)*(Ca.x-this.hBa.x),vb=this.grid.Wj?this.R$a:this.aj.f4();if(vb===d.a.Iwa)return!1;ma&&(0<this.ol||0<vb+hb)&&vb+hb<=this.Lqf&&(this.ol=this.Ayc(hb),this.bdd(Ca,this.ol,!1),this.grid.Wj?this.ol>=ka.L8e?(this.YLd=!0,this.aj.setCellExtent(this.ol)):
this.YLd&&(this.YLd=!1,this.aj.setCellExtent(ka.L8e)):(D.DOMElementExtensions.Loa(this.aj.gK(),!ra,Math.max(this.sKb+hb,0)),this.I0.style[ra?"top":this.rtl?"right":"left"]=Math.max(hb,-this.sKb)+"px"),ma=(this.grid.Wj?this.KGf:ra?this.aj.Ee.uC:this.aj.Ee.wC)+Math.max(hb,this.grid.Wj?-this.R$a+ka.Zcc:-this.sKb),D.DOMElementExtensions.Loa(this.aj.Ee.domElement,!ra,ma),this.grid.Wj&&this.aj.Ee.Voj(ma),this.i8a=new Sys.UI.Point(Ca.x,Ca.y),D.DOMElementExtensions.setVisible(this.wG,!1));return!0}f4(){return this.aj?
this.N8?ka.w6h:this.aj.f4():d.a.Iwa}bdd(Ca,ra,ma){this.bN&&ma&&(A.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.WJd());this.bN||ma||A.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.mvd&&this.mvd(()=>({["Location"]:"canvas"}));this.bN?this.$We(ra):(this.bN=document.createElement("div"),
this.bN.id=this.m6h,this.$We(ra),this.bN.className=m.a.Mqh,ra=document.getElementById(this.grid.$.Cb+l.a.Csf),ra.insertBefore(this.bN,ra.firstChild),Ca=ta.a(this.grid.$).Ija(Ca),this.bN.style.left=(this.rtl?Math.max(Ca.x-this.bN.offsetWidth,0):Ca.x-Math.max(Ca.x+this.bN.offsetWidth-ra.offsetWidth,0)).toString()+"px",ra=document.getElementById(l.a.gsa),this.bN.style.top=(Ca.y-(B.AFrameworkApplication.ta&&B.AFrameworkApplication.ta.Oa.We?0:ra.offsetHeight)-this.bN.offsetHeight).toString()+"px")}WJd(){D.DOMElementExtensions.sf(this.bN);
this.bN=null}$We(Ca){var ra=new na(this.grid.$.workbookContext.DxDigitNormal);ra=this.isRow?ra.uDe(Ca).toFixed(2):ra.kDe(Ca).toFixed(2);this.bN.innerText=`${this.isRow?this.h6h:this.q6h} ${ra} (${Ca.toString()} ${this.k6h})`}FJf(Ca,ra){let ma;if(-1!==this.grid.ha.selectionType||2===Ca.tb&&Ca.Ca.button!==Sys.UI.MouseButton.leftButton||!this.wsd(ma=this.mfd(Ca))||!this.Dhf)return!1;J.g(Ca.Ca);this.hBa=this.i8a=new Sys.UI.Point(Ca.clientPoint.x,Ca.clientPoint.y);this.rUg(ma,ra);if(!this.aj)return!1;
this.BX=!0;this.Xli(this.aj,ma)&&this.m$h();this.sKb=this.Ced();return this.GJf(Ca.Ca.rawEvent,ra)}EJf(Ca,ra,ma,hb,vb,Va){this.BX=!0;this.N8=vb;this.aj=Ca;this.hic=!1;this.hBa=this.i8a=new Sys.UI.Point(ra,ma);Ca=this.aj.getRange();this.sW=vb?this.gqe(Ca):Ca;this.R$a=this.f4();this.KGf=this.isRow?this.aj.Ee.uC:this.aj.Ee.wC;this.GJf(Va,hb)}GJf(Ca,ra){V.b(this.grid.$).Hd(F.a.Ngj,{["IsResizingHiddenHeader"]:this.N8,["IsAutoFitting"]:ra,["NumberOfSelectedRanges"]:this.grid.ha.sa.PK,["Location"]:"canvas"});
this.grid.Iyj&&(ra=ra?"header_resize_autofit":"header_resize_start",P.b(this.grid.$).HBa(Ca,ra,void 0));this.offset=this.aj.Taa();this.ol=this.grid.Wj?this.R$a:this.aj.f4();if(this.ol===d.a.Iwa)return!1;W.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0}Xli(Ca,ra){var ma=this.aj.gK();if(!ma)return A.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;ma=ma.nextSibling;if(!ma)return!1;Ca=Ca.getRange();ma=this.Ee.nva(ma).getRange();if(!Ca||
!ma)return A.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;Ca=this.isRow?Ca.bottom:Ca.right;ma=this.isRow?ma.bottom:ma.right;return Ca+1!==ma&&Ca!==ma&&this.wsd(ra,!0)}m$h(){var Ca=this.aj.gK();const ra=this.Ee.nva(Ca.nextSibling);ka.Yli(ra,this.isRow)?(this.aj=ra,this.sW=this.aj.getRange()):(this.HCg(Ca),this.aj=ra,Ca=this.aj.getRange(),this.sW=this.gqe(Ca),this.N8=!0)}gqe(Ca){return this.isRow?new T.Range(Ca.top-1,Ca.left,Ca.top-1,Ca.right,!1,!0):new T.Range(Ca.top,Ca.left-
1,Ca.bottom,Ca.left-1,!1,!0)}HCg(Ca){const ra=this.Ee.nva(Ca.nextSibling),ma=ka.b8g(ra,this.isRow,this.rtl);ma&&Ca.parentNode.insertBefore(ma,ra.gK())}Mgd(Ca){const ra=this.sW,ma=Ca.ha.sa.selectedRanges;if(Ca.ha.sa.Psb(ra))if(this.isRow){if(z.a.all(ma,hb=>hb.isRow))return ma}else if(z.a.all(ma,hb=>hb.gf))return ma;return[ra]}getCellExtent(){return this.aj.getCellExtent()}Ced(){const Ca=this.aj.gK().style;return Math.max(0,Math.min(this.Lqf,0|parseInt(this.isRow?Ca.height:Ca.width,10)))}Ayc(Ca=0){const ra=
this.grid;var ma=this.Ee.xj.paneType;let hb;hb=this.isRow?3===ma?[3,2]:[1,4]:4===ma?[2,4]:[1,3];var vb=ra.view.visibleArea.bottomRight;const Va=Math.max(this.grid.Wj?this.R$a:this.aj.f4(),0);Ca=this.N8&&!this.grid.Wj?Math.max(this.Ced(),0):Math.max(Va+Ca,0);L.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?(ma=ra.uSh(ma,this.isRow),ma=this.isRow?new k.a(0,this.offset,ma,Ca):new k.a(this.offset,0,Ca,ma)):ma=this.isRow?new k.a(0,this.offset,vb.x,Ca):new k.a(this.offset,0,Ca,vb.y);
vb=[this.isRow?13:14];L.EwaSettings.isChangeGateEnabled("OfficeVSO:6964315_DottedResizer")?ra.ob.zi(new T.Range(1,1,d.a.eh,d.a.ph,!1,!0),vb,!1):ra.ob.zi(T.Range.Uc(1,1),vb,!1);ra.ob.Jn(vb,ma,hb);return Ca}X0c(){this.sW=this.hBa=this.i8a=null;if(this.I0){const Ca=this.I0.parentNode;if(Ca)for(Ca.removeChild(this.I0);this.I0.firstChild;)Ca.appendChild(this.I0.firstChild);this.I0=null}this.aj=null;this.BX=!1;L.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")||this.TQf()}TQf(){this.hic=
!1;this.WJd();D.DOMElementExtensions.setVisible(ka.ncb,!1);D.DOMElementExtensions.setVisible(this.wG,!1);L.EwaSettings.isChangeGateEnabled("OfficeVSO:6443346_removeResizeArtifacts")&&this.sVf()}mfd(Ca){if(D.DOMElementExtensions.yz(Ca.Db,"a"))return null;const ra=this.fjf(Ca.Ca);if(ra&&this.grid.ha.sa.Bg){var ma=this.grid.ha.sa.Xc;ma=this.Ee.fs(T.Range.Uc(ma.bottom,ma.right))}else ma=this.Ee.nva(Ca.Db);if(!ma)return null;const hb=ma.gK(),vb=new Sys.UI.Bounds(hb.offsetLeft,hb.offsetTop,hb.offsetWidth,
hb.offsetHeight);var Va=D.DOMElementExtensions.getBoundingClientRect(Ca.Db);Va=new Sys.UI.Point(Ca.clientPoint.x-Va.x,Ca.clientPoint.y-Va.y);this.isRow&&!ra&&(Va.y+=R.HelperMethods.dD(Ca.Db,hb,this.rtl).y);return new K(hb,Va,vb,ma.getRange(),Math.max(ka.ZAi,Math.min(ka.Wzi,(this.isRow?vb.height:vb.width)*ka.Xgj)),ra,!this.isRow&&0<hb.getElementsByTagName("input").length)}wsd(Ca,ra=!1){if(!Ca||this.grid.eb)return!1;if(Ca.ejf)return!0;var ma=Ca.UOa;const hb=Ca.mcb;var vb=this.Ee.xj.paneType,Va=this.grid.Hf(vb).mi,
db=!!Va&&Va.top===Ca.akd.top,oa=!!Va&&Va.left===Ca.akd.left;vb=!!Va&&Va.bottom===Ca.akd.bottom&&(3===vb||2===vb);this.isRow?(oa=Ca.vDb.y,Ca=oa<=hb&&!db,ma=oa>=ma.height-hb-(vb?ka.QEh:0),ra=ra?Ca:ma||Ca):(vb=Ca.k5h,db=this.rtl,Va=Ca.vDb.x,Ca=Va<=hb&&(!oa||db)&&(!vb||!db),ma=Va>=ma.width-hb&&(!db||!oa)&&(!vb||db),ra=ra?db?ma:Ca:Ca||ma);return ra}rUg(Ca,ra){const ma=this.isRow;if(Ca.ejf)this.aj=this.Ee.nva(Ca.iwa);else if(ma&&Ca.vDb.y<=Ca.mcb&&Ca.UOa.height>Ca.mcb||!ma&&Ca.UOa.width>Ca.mcb&&(!this.rtl&&
Ca.vDb.x<=Ca.mcb||this.rtl&&Ca.vDb.x>=Ca.UOa.width-Ca.mcb)){if(this.aj=Ca.iwa.previousSibling?this.Ee.nva(Ca.iwa.previousSibling):this.JRh(),ra&&Ca.iwa.classList.contains(ma?m.a.URe:m.a.TRe)&&(Ca=this.Ee.nva(Ca.iwa)))Ca=Ca.getRange(),this.sW=ma?new T.Range(Ca.top-1,Ca.left,Ca.top-1,Ca.right,!1,!0):new T.Range(Ca.top,Ca.left-1,Ca.bottom,Ca.left-1,!1,!0)}else this.aj=this.Ee.nva(Ca.iwa);!this.sW&&this.aj&&(this.sW=this.aj.getRange())}JRh(){var Ca=this.isRow?1:0;return(Ca=this.Ee.xj.AG(this.Ee.xj.Ea.Og(this.grid.$.oa,
e.a.AM(this.Ee.position.X+Ca-1,this.Ee.position.Y-Ca,this.Ee.position.PaneType))))?Ca.IRh():null}cbf(){this.hic=!0;const Ca=this.Ygj;D.DOMElementExtensions.setVisible(Ca,!0);Ca.style.cursor=this.isRow?m.a.fPe:m.a.TNe;this.Ayc()}cmh(Ca){this.grid.$.fd(this.isRow?745189930:-445963340,I.a.Gb,30,{["resizeRowColumnParameters"]:Ca})}Zah(){const Ca=document.createElement("div");Ca.className=m.a.lth;const ra=document.createElement("div");ra.className=f.a.WA;Ca.appendChild(ra);const ma=document.createElement("img");
ma.src=G.a.Ue(0);ma.className=this.isRow?f.a.hsh:f.a.csh;ra.appendChild(ma);this.Ee.RA.domElement.parentNode.insertBefore(Ca,this.Ee.RA.domElement);this.grid.Wj?Ca.addEventListener(w.a.g$,this.PMi):(t.a.instance.ra(w.a.pointerDown,Ca,this.JN),x.a.instance.ra(w.a.xk,Ca,this.uca));D.DOMElementExtensions.setVisible(Ca,!1);this.wG=Ca}GIb(){this.X0c();this.wG&&(this.Ee.RA.domElement.parentNode.removeChild(this.wG),this.wG=null)}fjf(Ca){return D.DOMElementExtensions.xf(this.wG,Ca.target)}Tpb(){this.BX&&
(L.EwaSettings.isChangeGateEnabled("OfficeVSO:6810003_HandleCancelResize")&&this.grid.Wj&&this.wBd(this.hBa),this.sMe(),this.grid.Wj||D.DOMElementExtensions.Loa(this.aj.gK(),!this.isRow,this.sKb),this.GIb(),this.iQb=this.N8=!1)}gff(){return L.EwaSettings.ma(672)}L$e(Ca){(Ca=Ca.Ca.rawEvent)&&Ca.detail===ka.Alj&&(Ca.type===w.a.kq?(this.BX=!1,this.gYc=!0):Ca.type===w.a.jI&&(this.BX=!0,this.gYc=!1))}static Y7g(Ca,ra){return new ka(Ca,ra)}static vQd(Ca,ra,ma){if(ra){Ca.ColumnWidth=-1;Ca.RowHeight=ma;for(const hb of Ca.SheetMultiRange.Ranges)hb.FirstColumn=
0,hb.LastColumn=0}else{Ca.RowHeight=-1;Ca.ColumnWidth=ma;for(const hb of Ca.SheetMultiRange.Ranges)hb.FirstRow=0,hb.LastRow=0}}static Yli(Ca,ra){if(!Ca||!Ca.gK())return A.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;const ma=Ca.getRange();Ca=Ca.gK().style;if(!ma||!Ca)return A.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;Ca=ra?Ca.height:Ca.width;return(ra?ma.top:ma.left)===(ra?d.a.eh:d.a.ph)&&Ca===ka.Aig}static b8g(Ca,ra,ma){if(!Ca)return A.ULS.shipAssertTag(537154012,
2,!1,"header after hidden is null"),null;var hb=Ca.gK();if(!hb||!hb.style)return A.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;Ca=document.createElement("div");const vb=hb.style;Ca.style.top=ra?vb.top:ka.Aig;ra||(ma?Ca.style.right=vb.right:Ca.style.left=vb.left);Ca.classList.add(ra?u.jsh:u.ish);Ca.classList.add(ra?m.a.Rtb:m.a.Qtb);ma=document.createElement("div");ma.classList.add(ra?m.a.HRe:m.a.E$c);hb=ra?Number.parseInvariant(hb.innerText):T.Range.G0a(hb.innerText);
ma.innerText=ra?(hb-1).toString():T.Range.QP(hb-1);Ca.appendChild(ma);return Ca}}ka.ZAi=0;ka.Wzi=5;ka.Zcc=1;ka.L8e=1;ka.w6h=0;ka.QEh=3;ka.Xgj=.1;ka.PUf="ewa-rszrbg";ka.Aig="0px";ka.Alj=2;ka.ncb=null;Object(n.a)(ka,"HeaderResizeBehavior",H.a,[378]);class pa extends b.a{constructor(){super();this.Eb()}create(){this.pb(ka.Y7g)}static ka(Ca){Ca.da.Ga(136,new pa)}}Object(n.a)(pa,"HeaderResizeBehaviorFactory",b.a,[]);var Na=a(694),Z=a(50),Ra=a(37),Da=a(173),Ba=a(421),ea=a(515),Y=a(370),ja=a(171),ca=a(282),
ba=a(281),ua=a(75),wa=a(21);class ia{constructor(Ca,ra){this.isRow=!1;this.autoFitRange=null;this.isRow=Ca;this.autoFitRange=ra}}Object(n.a)(ia,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[115]);class xa{constructor(Ca){this.resizeParameters=null;this.resizeParameters=Ca}}Object(n.a)(xa,"MacroRecorderSheetRowsColumnsResizedPayload",null,[115]);var gb=a(82);b=a(284);var va=a(22);class sa extends b.a{constructor(Ca,ra){super(Ca);this.Zvb=ma=>{ma=this.Afd(ma);return this.Ucd(ma)};this.Ogj=(ma,
hb)=>{var vb=this.G7a=hb[sa.Xgi];1===ma?(ma=hb[sa.nCj],vb=this.Q4e(ma,vb),A.ULS.shipAssertTag(537153996,0,vb!==sa.rba,`ResizeHeadersDialogHandler - invalid size input, size = ${ma}`),ma=vb!==this.amd,A.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",this.isRow,this.G7a,vb,ma),ma&&this.E5g(vb)):A.ULS.sendTraceTag(537153994,0,50,`ResizeHeadersDialog Cancel button pressed, isRow = ${this.isRow}.`)};this.isRow=
2040891415===ra.command;this.gridView=wa.g(this.$);this.nuc=new na(this.$.workbookContext.DxDigitNormal);this.amd=this.SUg();Ca=this.m4g(this.amd);ra=this.o4g(this.amd);this.Nl=Q.a.instance.ga(this.isRow?482:483);Ca=this.WM(Ca,ra);this.initializeAndShow(this.Nl,this.Ogj,Ca);A.ULS.sendTraceTag(537153997,0,50,`ResizeHeaders React Dialog opened, isRow = ${this.isRow}.`)}get uc(){return"ResizeHeadersDialog"}get G7a(){return sa.jae}set G7a(Ca){sa.jae=Ca}WM(Ca,ra){return{[sa.D4]:this.uc,[sa.lmi]:this.isRow,
[sa.J$h]:Ca,[sa.I$h]:ra,[sa.eji]:this.G7a,[sa.zfd]:this.Zvb}}SUg(){const Ca=this.bIh();try{return this.EMh(Ca)}finally{Ca&&Ca.dispose()}}E5g(Ca){const ra={};ra.SheetMultiRange=U.r(this.gridView.ha.sa.selectedRanges,this.$);sa.vQd(ra,this.isRow,Ca);this.$.fd(this.isRow?745189930:-445963340,I.a.Gb,8,{["resizeRowColumnParameters"]:ra})}Q4e(Ca,ra){return va.a.c5(Ca)?ra?this.l4g(Ca):this.n4g(Ca):sa.rba}n4g(Ca){return Math.floor(parseFloat(Ca))}l4g(Ca){Ca=parseFloat(Ca);return 0>Ca?sa.rba:Ca?this.isRow?
R.HelperMethods.QYi(Ca):this.nuc.c0g(Ca):0}o4g(Ca){return Ca===sa.rba?"":this.isRow?this.nuc.uDe(Ca).toString():this.nuc.kDe(Ca).toFixed(2)}m4g(Ca){return Ca===sa.rba?"":Ca.toString()}EMh(Ca){if(!Ca||!Ca.$$mn()||!Ca.Sn)return sa.rba;var ra=Object(gb.a)(329,Ca.Sn);if(!ra)return sa.rba;for(ra=this.isRow?ra.yyb:ra.Zld;Ca.$$mn();){const ma=Object(gb.a)(329,Ca.Sn);if(ma&&(this.isRow?ma.yyb:ma.Zld)!==ra)return sa.rba}return ra}bIh(){const Ca=[];for(const ma of this.gridView.ha.sa.selectedRanges){const hb=
ma.clone();var ra=this.gridView.Hf(this.gridView.ib.Oi(hb));ra=hb.Ie(ra.mi);if(!ra)return null;this.isRow?hb.right=hb.left=ra.left:hb.top=hb.bottom=ra.top;Ca.push(hb)}return Ca.length?this.gridView.J$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",Ca):null}Afd(Ca){if(!va.a.c5(Ca))return 1;Ca=this.Q4e(Ca,this.G7a);if(0===Ca)if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const ra=this.gridView.ha.sa.selectedRanges;if(this.gridView.Zd){if(!this.gridView.Zd.oxe(ra,
this.isRow))return 3}else if(this.Ehf())return 3}else if(this.Ehf())return 3;return this.Voi(Ca)?0:2}Ehf(){const Ca=this.gridView.ha.sa.selectedRanges;return this.isRow&&U.P(Ca)||!this.isRow&&U.O(Ca)}Ucd(Ca){let ra="";switch(Ca){case 0:ra="";break;case 1:ra=Q.a.instance.ga(772);break;case 2:ra=String.format(Q.a.instance.mb(99),0,this.Cbc(this.G7a));break;case 3:ra=Q.a.instance.ga(773)}return ra}Voi(Ca){return 0<=Ca&&Ca<=this.Cbc(!1)}Cbc(Ca){return this.nuc.Cbc(Ca,this.isRow)}static vQd(Ca,ra,ma){if(ra){Ca.ColumnWidth=
sa.rba;Ca.RowHeight=ma;for(const hb of Ca.SheetMultiRange.Ranges)hb.FirstColumn=0,hb.LastColumn=0}else{Ca.RowHeight=sa.rba;Ca.ColumnWidth=ma;for(const hb of Ca.SheetMultiRange.Ranges)hb.FirstRow=0,hb.LastRow=0}}}sa.D4="id";sa.lmi="isRow";sa.J$h="initialSizeInPx";sa.I$h="initialSizeInDefaultUnits";sa.eji="isInitialUnitsDefaultUnits";sa.zfd="getInputErrorIfInvalid";sa.nCj="size";sa.Xgi="isDefaultUnits";sa.rba=-1;sa.jae=!0;Object(n.a)(sa,"ResizeHeadersDialog",b.a,[]);var ab=a(61);const Ua=(Ca,ra,ma,
hb,vb,Va,db=null)=>{db=Ca.Na(41,db);db.resizeRowColumnParameters=ra;return ab.g(Ca,"ResizeRowsColumns",db,ma,hb,vb,Va,0)};var nb=a(341),Ha=a(458),sb=a(65),Qb=a(29),mb=a(343);class Pb{constructor(Ca,ra){this.HQi=(ma,hb)=>{if(!ca.a(ma)&&hb){const vb=!!ma&&!!ma.RequestTelemetryData;wa.g(this.$).Pi.vla(hb,ma.StateId,vb?ma.RequestTelemetryData.EcsOperationDuration:0,vb?ma.RequestTelemetryData.EcsRequestDuration:0,vb?ma.RequestTelemetryData.WfeRequestDuration:0)}};this.$Hi=(ma,hb)=>{hb&&hb.I0b&&hb.I0b.SheetName&&
hb.I0b.Ranges.length&&hb.lgi&&L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&(ma=sb.d(this.$.xa.oa),this.b0g(new nb.a(U.B(hb.I0b.Ranges[0]),ma)))};this.$=Ca;this.xg=ra}Lc(Ca,ra){Ca=!0;switch(ra){case -445963340:case 1391094586:Ca=this.Wd(8);break;case 745189930:case 146338636:Ca=this.Wd(16)}return!Ca}executeCommand(Ca,ra,ma){var hb=wa.g(this.$);const vb=ra.command;var Va=Da.a.create().toString();let db=Ra.TaskExtensions.ak();switch(vb){case 1391094586:case 146338636:Ca=
1391094586===vb;(Va=ma.autoFitRanges)&&Va.Ranges&&Va.Ranges.length||(Va=U.r(hb.ha.sa.selectedRanges,this.$));db=this.bih(Ca?1:0,Va,ra);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Ca=-445963340===vb||-706918724===vb||369708605===vb;if(-445963340===vb||745189930===vb){var oa=Ba.a(ra.command);hb.Pi.A7(16,Va,oa);hb=ma.resizeRowColumnParameters}else{ma=hb.ha.sa.selectedRanges;let Wa=0;for(var Oa of ma)if(-706918724===vb||369708605===vb){const Sa=
Oa.right-Oa.left+1;Wa+=0<Sa?Sa:-1*Sa}else if(1542466017===vb||1051390410===vb)Wa+=Oa.bottom-Oa.top+1;369708605===vb||1542466017===vb?A.ULS.sendTraceTag(520938758,0,50,`ResizeCommandHandler.doResize: Unhide Rows/Columns NumberOfRanges=${Wa}`):(-706918724===vb||1051390410===vb)&&A.ULS.sendTraceTag(520938757,0,50,`ResizeCommandHandler.doResize: hide Rows/Columns NumberOfRanges=${Wa}`);if(!L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)||!hb.Zd){if(-706918724===vb&&6===
ra.Re&&U.O(ma)){A.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===vb&&6===ra.Re&&U.P(ma)){A.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}}Oa=369708605===vb||1542466017===vb?-2:0;hb={};hb.SheetMultiRange=U.r(ma,this.$);if(Ca)for(oa of hb.SheetMultiRange.Ranges)oa.FirstRow=0,oa.LastRow=
0;else for(const Sa of hb.SheetMultiRange.Ranges)Sa.FirstColumn=0,Sa.LastColumn=0;hb.RowHeight=Ca?-1:Oa;hb.ColumnWidth=Ca?Oa:-1}db=this.vih(hb,ra,Va,Ca);break;case 957527587:case 2040891415:new sa(this.$,ra)}return db}b0g(Ca){L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataTableProactiveSuggestions",!1)&&Ra.TaskExtensions.Aa(Z.GetServiceTaskFactory.Sa(this.$.da,426,427,1),ra=>{void ra.result.oYd(Ca,"ColumnAutoFit")},this.$.la,3)}Ac(Ca,ra,ma,hb){if(Ca=!!ma&&!!hb&&1===
hb.$y)switch(ra.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:Ca=!1}return Ca}Oc(){return!1}vvi(Ca){A.ULS.sendTraceTag(537154004,0,50,`ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: ${Ca.success}. Reason: ${Object(Ha.c)(Ca)?void 0:Ca.reason}.`)}Wd(Ca){return(new X.a(this.$.xa)).Wd(Ca)}bih(Ca,ra,ma){const hb=this.$.pa.va.Tb(),vb=0===Ca,Va=()=>
new ia(vb,ra);return Y.a(this.$.userOperationManager,(db,oa,Oa)=>{var Wa=this.$.pa.va;db=ba.b(db,this.$Hi);var Sa={lgi:!vb,I0b:ra};const yb=Wa.Na(41,hb);yb.isRow=vb;yb.autoFitRanges=ra;return ab.g(Wa,"AutoFit",yb,db,oa,Oa,Sa,0)},db=>new ja.a(135,0,db,void 0,Va),ma)}vih(Ca,ra,ma,hb){const vb=ra.command,Va=wa.g(this.$),db=U.g(Ca.SheetMultiRange.Ranges);if(L.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HideLastRowCol",!1)){const Sa=-706918724===vb||-445963340===vb&&0===Ca.ColumnWidth;if((1051390410===
vb||745189930===vb&&0===Ca.RowHeight||Sa)&&null!=Va.Zd&&!Va.Zd.oxe(db,!hb))return this.lhh(hb),Ra.TaskExtensions.ak()}let oa;if(745189930===vb||-445963340===vb)A.ULS.shipAssertTag(537154002,0,this.$.activeItemName===Ca.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!"),oa=this.xg.EAj(Va,db,hb?Ca.ColumnWidth:Ca.RowHeight,!hb),this.vvi(oa),Object(Ha.c)(oa)&&Va.Pi.D0(ma,ua.BasicTelemetryCalculator.NQ);const Oa=this.$.pa.va.Tb({j_:!0,AZ:3});hb=(Sa,yb,Ma)=>
{this.$.Ay();U.i(db,",",this.$,!1);return Ua(this.$.pa.va,Ca,ba.b(Sa,this.HQi),yb,Ma,ma,Oa)};const Wa=()=>new xa(Ca);return oa&&Object(Ha.c)(oa)?L.EwaSettings.$b()?Y.a(this.$.userOperationManager,hb,Sa=>new ja.a(136,0,Sa,64,Wa),ra):Y.a(this.$.userOperationManager,hb,Sa=>new ea.a(136,0,Sa,void 0,Wa),ra):Y.a(this.$.userOperationManager,hb,Sa=>new ja.a(136,0,Sa,void 0,Wa),ra)}lhh(Ca){Ca=Qb.a.Yc(1,0,Ca?774:776,Ca?775:777,0,Ca?-2037763134:503471870,Ca?"HideAllColumnsError":"HideAllRowsError");new mb.a(this.$,
Ca)}}Object(n.a)(Pb,"ResizeCommandHandler",null,[164]);class gc extends Na.a{constructor(Ca){super(Ca)}vd(){const Ca=Z.GetServiceTaskFactory.create(this.$.da,18,this.la,this.fb);Ra.TaskExtensions.Aa(Ca,()=>{this.$c([new Pb(this.$,Ca.result)])},this.la,3)}static ka(Ca){Na.a.Od(113,new gc(Ca))}}Object(n.a)(gc,"ResizeCommandHandlerFactory",Na.a,[]);a.d(C,"a",function(){return Xb});const Xb=()=>{c.a.Fa(Ca=>{pa.ka(Ca);gc.ka(Ca)})}},1172:function(n,C,a){n=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();
this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(T){this.bA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}l7c(T){this.bA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(n.a)(b,"ErrorDialog",c.StandardDialog,[321]);var d=a(15),f=a(155);class e{BXe(){d.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const T=new f.a;T.setResult("api.onedrive.com");return T.task}}Object(n.a)(e,"OneDriveConsumerEndpointHelper",
null,[219]);var k=a(84),l=a(54),m=a(373),u=a(227);class t{constructor(T,G,D,J){this.CEa=this.i6=null;this.dRc=this.fRc=!1;this.pXa=null;this.nb=T;this.cRb=G;this.iEa=D;this.Ps=J}get rre(){return this.cRb}get fa(){return this.nb}B4a(){this.pXa||(this.pXa=this.K$a?u.a.create(this.K$a,null,null,null,!1):null);return this.pXa}setup(T){this.CEa=T;this.fRc||this.dRc?this.fRc&&this.CEa&&this.CEa(!0):(T=this.B4a())?(this.dRc=!0,T.F8a.continueWith(G=>{this.xPi(G)}),m.a.yia(T)):(d.ULS.sendTraceTag(20509837,
352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.CEa(!1))}MBd(T){d.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",T.exception?T.exception.toString():"No error detail.")}xPi(T){this.dRc=!1;if(T.Tf)this.MBd(T),this.CEa(!1);else try{this.fRc=!0,d.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.fmd(),d.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.CEa(!0)}catch(G){d.ULS.sendTraceTag(20555412,
352,10,"Failed during OneDrive API init: {0}",G.toString()),this.CEa(!1)}}startPicker(T){this.i6=T;this.iEa?d.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(k.a)(this,this.jAd,"onApiReady")))}jAd(T){T?this.Pjc():this.uj()}uj(){this.Ps().displayError(l.a.KUi)}onSuccess(T){d.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.i6&&this.i6(!0,T)}dispose(){this.pXa&&this.pXa.dispose()}}Object(n.a)(t,"AOneDriveFilePickerApiManager",null,[280,10]);class w extends t{constructor(T,G,D,J,L,H){super(G,D,J,H);this.Mh=null;this.T1=T;this.Cxg=L}get K$a(){return this.fa.Xa("OneDriveApiUrl")}start(T,G){this.Mh=T;this.startPicker(G)}fmd(){WL.init(1===this.rre||2===this.rre?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}startPicker(T){this.i6=
T;!this.iEa&&this.T1.rMa?(d.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(k.a)(this,this.jAd,"onApiReady"))):(d.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Cxg())}Pjc(){try{d.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Mh).then(Object(k.a)(this,this.onSuccess,"onSuccess"),Object(k.a)(this,this.h6,"onFailure"))}catch(T){d.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",
T,T.stack),this.uj()}}h6(T){if(T&&T.error){if("user_canceled"===T.error.code){d.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}d.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",T.error.code,T.error.message)}else d.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.i6&&this.i6(!1,T);this.uj()}}Object(n.a)(w,"OneDriveFilePickerApiManagerV5",t,[]);class r extends t{constructor(T,G,D,J,L){super(T,G,D,J);this.yTb=
this.Ude=null;this.Gpg=L;this.options={};this.options.clientId=this.fa.Xa("OneDriveApiV7ClientId");this.options.cancel=Object(k.a)(this,this.PAc,"toggleHostDivVisibility")}get K$a(){return this.fa.Xa("OneDriveApiV72Url")}start(T,G){this.yTb=G;const D=this.Gpg.BXe();D.continueWith(()=>{d.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.Ude=D.result;this.startPicker((J,L)=>{this.PAc();T(J,L)})},3);D.continueWith(()=>{d.ULS.sendTraceTag(24134242,
352,15,D.exception.message);this.PAc()},5)}fmd(){this.options.success=T=>{const G={};G.data=T;this.onSuccess(G)};this.options.error=T=>{const G={};G.error=T;this.h6(G)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.Ude;this.options.advanced.iframeParentDiv=this.yTb}Pjc(){try{d.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.PAc(),OneDrive.open(this.options)}catch(T){d.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",
T.message),this.uj()}}h6(T){this.i6&&this.i6(!1,T);this.uj()}PAc(){this.yTb.style.visibility="hidden"===this.yTb.style.visibility?"":"hidden"}}Object(n.a)(r,"OneDriveFilePickerApiManagerV7",t,[]);class v extends t{constructor(T,G,D,J){super(T,G,D,J);this.wmg=T;this.options={};this.options.advanced={};this.options.action="query";this.options.clientId=this.fa.Xa("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get K$a(){return this.fa.Xa("OneDriveApiV72Url")}start(T,G,D,J){this.options.advanced.iframeParentDiv=
D;this.options.advanced.endpointHint=J;this.options.cancel=G;this.wmg.qa("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(T)}startPicker(T){this.i6=T;this.iEa?d.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(d.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(k.a)(this,this.jAd,"onApiReady")))}fmd(){this.options.success=T=>{const G={};G.data=T;this.onSuccess(G)};this.options.error=T=>{const G={};G.error=T;this.h6(G)}}Pjc(){try{d.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(T){d.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",T.message,T.stack),this.uj()}}MBd(T){d.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",
T.exception?T.exception.toString():"No error detail.");m.a.jaj(this.K$a);this.pXa=null}uj(){this.Ps().l7c(l.a.Kjj)}h6(T){this.i6&&this.i6(!1,T)}}Object(n.a)(v,"OneDriveFilePickerApiManagerV72",t,[]);class y{constructor(T){this.olsSessionId=this.value=this.key=null;this.olsSessionId=T}}Object(n.a)(y,"IExtraData",null,[]);var x=a(4);class B extends v{constructor(T,G,D,J){super(T,G,D,J);this.options.advanced.filter=T.Xa("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";
this.options.multiSelect=x.AFrameworkApplication.zre;T.qa("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=T.Xa("OneDriveApiV72CommandMode")||"none");T.qa("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new y(x.AFrameworkApplication.userSessionId))}get K$a(){return this.fa.Xa("OneDriveApiV72Url")}Pjc(){try{d.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,
this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",x.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(T){d.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",T.message,T.stack),this.uj()}}}Object(n.a)(B,"OneDriveFilePickerApiOpenManagerV72",v,[]);var z=a(238);class A{constructor(T){this.pk=null;this.zh=T;this.gQc=3}BXe(){this.pk=new f.a;d.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");
this.LOd();return this.pk.task}LOd(T=null){const G=String.format("GetMoreInfoHandler.ashx?{0}",x.AFrameworkApplication.hIa);this.zh.z9(G,1,null,T,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(k.a)(this,this.RSh,"getMoreInfoSucceeded"),Object(k.a)(this,this.PSh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")}PSh(T){if(T.data.httpStatus===z.a.ZGb&&"X-NewKey"in T.data.responseHeaders){d.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");
const G={};G["X-Key"]=T.data.responseHeaders["X-NewKey"];this.LOd(G)}else 0<this.gQc?(d.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.gQc),this.gQc--,this.LOd()):(d.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.pk.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}RSh(T){"PersonalFileStorageUrl"in T.data.responseHeaders&&""!==T.data.responseHeaders.PersonalFileStorageUrl?
(d.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.pk.setResult(T.data.responseHeaders.PersonalFileStorageUrl)):(d.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.pk.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}Object(n.a)(A,"OneDriveForBusinessEndpointHelper",null,[219]);var I=a(247),F=a(562);class U{constructor(){this.gb=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Wh(T){this.gb=
T;this.gb.register(w,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").wc().Fc(()=>new w(F.a.instance,x.AFrameworkApplication.fa,x.AFrameworkApplication.E2a,x.AFrameworkApplication.limitedEdit,x.AFrameworkApplication.x5f,()=>new b));x.AFrameworkApplication.uif?this.gb.register(219,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Fc(()=>new e):this.gb.register(219,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").wc().Fc(()=>
new A(x.AFrameworkApplication.yd));this.gb.register(r,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").wc().Fc(()=>new r(x.AFrameworkApplication.fa,x.AFrameworkApplication.E2a,x.AFrameworkApplication.limitedEdit,()=>new b,this.gb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));this.gb.register(v,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").wc().Fc(()=>new v(x.AFrameworkApplication.fa,x.AFrameworkApplication.E2a,x.AFrameworkApplication.limitedEdit,
()=>new b));this.gb.register(B,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").wc().Fc(()=>new B(x.AFrameworkApplication.fa,x.AFrameworkApplication.E2a,x.AFrameworkApplication.limitedEdit,()=>new b))}static main(){I.a.instance.Gi(new U)}}Object(n.a)(U,"PackageManager",null,[3,4]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.OneDriveFilePickerApi");U.main()}},1180:function(n,C,a){n=a(0);var c=a(84),b=a(15),d=a(134),f=a(54),e=a(25);class k extends d.StandardDialog{constructor(Q,
O){super();this.qXa=!1;this.xA=null;this.La=Q;this.pib=O;this.YSa=!1}displayError(Q,O,V){this.xA=O;this.qXa=V;b.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",Q,V);Q=this.w0c(Q);0===Q?(this.Rb=6,this.rc(0,CommonUIStrings.l_DialogClose)):(this.Rb=0,this.rc(1,CommonUIStrings.l_DialogClose));0===Q&&b.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.bA(f.a.Jjj,this.ted(Q),this.sNh(Q,O),Object(c.a)(this,this.TMd,"retryDialogHandler"),!0)}TMd(Q){1===
Q?(b.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.xA?this.La.de(e.a.nKb,2,[this.xA,this.qXa]):this.La.processAction(e.a.nKb,2)):b.ULS.sendTraceTag(8194011,216,50,"User cancel the error dialog.")}w0c(Q){return 0>Q||6<Q?(b.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",Q),0):Q}sNh(Q,O){Q=this.w0c(Q);return this.pib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][Q]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,O),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][Q]}ted(Q){Q=this.w0c(Q);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,
CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][Q]}}Object(n.a)(k,"ErrorRetryDialog",d.StandardDialog,[285]);class l{constructor(Q,O){this.nb=Q;this.La=O;this.pib=this.nb.qa("SaveToHostWithExtraCharsInFileName")}create(){return new k(this.La,this.pib)}}Object(n.a)(l,"ErrorRetryDialogFactory",null,[263]);d=a(1050);var m=a(144);class u{static get mg(){return m.a.Yp(u.ml,
CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}u.ml="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(n.a)(u,"FileNameDialogHtml",null,[]);var t=a(4),w=a(30);class r extends d.a{constructor(Q,O,V,W,da,ta){super(Q,O,V,W,da,ta);this.mg=u.mg;this.Ce="FileNameDialog-SaveAsToHost"}fQ(Q,O){const V=w.a.Fq(t.AFrameworkApplication.nm.jn);O={["txtFileName"]:Q||V,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:O};this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(c.a)(this,this.G9b,"fileNameDialogHandler"),O);this.mJe(Q,V)}}Object(n.a)(r,"FileNameDialog",d.a,[286]);class v{constructor(Q,
O,V,W,da,ta){this.La=O;this.nb=Q;this.lX=W;this.wga=ta;this.Ps=da;this.af=V}create(){return new r(this.nb,this.La,this.af,this.lX,this.Ps,this.wga)}}Object(n.a)(v,"FileNameDialogFactory",null,[261]);var y=a(643),x=a(106);class B{constructor(Q,O,V){this.wga=V;this.NIc=O;this.nb=Q}Ig(){2===t.AFrameworkApplication.ta.Oa.Dj?t.AFrameworkApplication.vb.Le(e.a.nKb,x.a.frame,Object(c.a)(this,this.RWf,"saveAsToHostActionDispatcher"),4):t.AFrameworkApplication.vb.Nb(e.a.nKb,x.a.frame,Object(c.a)(this,this.RWf,
"saveAsToHostActionDispatcher"))}RWf(Q,O,V,W,da){return O.contextId!==x.a.frame||Q!==e.a.nKb?2:this.nb.qa("SaveAsToHostBrsIsEnabled")?1===V?y.SessionStatusManager.instance.s5a||t.AFrameworkApplication.X4?8:32:2===V?(b.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),Q=this.NIc.create(),da&&Object.getType(da)===Array&&2===da.length?Q.fQ(da[0],!!da[1]):Q.fQ(null,!1),32):8:8}}Object(n.a)(B,"SaveAsToHostActor",null,[]);var z=a(41),A=a(80),I=a(39),F=a(238),U=a(372),
X=a(164),T=a(644),G=a(767);class D{constructor(Q,O,V,W,da,ta,K,na){this.Hm=null;this.qXa=this.CDa=!1;this.vga=this.Mh=this.xA=null;this.nb=O;this.AFa=this.nb.appSettings.SaveAsToHostWebServiceBase;this.Z9d=W;this.Wkb=da;this.zh=V;this.Ps=ta;this.Ch=na;this.af=K;this.La=Q;this.xfa=O.Xa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}QMb(){1!==this.af.state&&(this.Hm=this.Wkb(),this.Hm.message=CommonUIStrings.l_CommentProgressTooltip,this.Hm.Rb=5,this.Hm.ut=!1,this.Hm.aBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))}eS(Q=0){1!==this.af.state&&this.Ps.create().displayError(Q,w.a.Fq(this.xA),this.qXa)}CQa(){const Q=this.nb.appSettings.BreadcrumbFolderUrl;b.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");I.a.Ze(Q,I.a.cX(3),void 0,"UploadToHostManager.RedirectToFolder")}BQa(Q){let O=!1,V=!1;this.nb&&(O=this.nb.qa("SaveACopyIsEnabledForUiHost"),V=this.nb.qa("UiHostSupportsDocRebootFeatures"));b.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",
Q,O,V);if(O&&V){b.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const W={};W[U.a.wQa]="1";W[U.a.documentUrl]=Q;W[U.a.reason]=T.a.saveAs;t.AFrameworkApplication.XU().execute(da=>{da.Mj(X.a.dua,W)})}else O&&!V&&t.AFrameworkApplication.Dba?I.a.Ze(Q,I.a.cX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):I.a.Ze(Q,I.a.cX(3),void 0,"UploadToHostManager.RedirectToEditUrl")}aoa(Q,O,V=null){b.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");
this.Z9d&&!this.Z9d()&&this.zh&&(this.Ch&&(this.vga=this.Ch.Bc("DialogShown","SaveAsToHostUploadTime")),this.QMb(),this.qXa=O,this.xA=Q,(this.Mh=V)&&"true"===this.Mh.SkipSaveToHost?this.f9b():this.mQ())}mQ(){32!==this.La.processAction(e.a.HRa,1)?(b.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.f9b()):this.La.de(e.a.HRa,2,[()=>{b.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.f9b()},(Q,
O)=>{b.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.eS(O)}])}VTi(Q){this.KIa();this.CDa=!1;if(Q&&Q.data&&Q.data.Xd)if(({fu:O}=z.d(Q.data.Xd)).returnValue)if(Q=O,Q.StatusCode!==F.a.VO&&Q.StatusCode!==F.a.Prb){b.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var O={};O.FailureReason=Q.StatusCode.toString();O.ExtraInfo=Q.ExtraInfo;this.rda(O);this.eS(parseInt(Q.ExtraInfo))}else{b.ULS.sendTraceTag(8194050,
216,50,"UploadToHost execute success.");this.HLd();try{Q.NewDocumentUrl&&""!==Q.NewDocumentUrl?this.BQa(Q.NewDocumentUrl):this.CQa()}catch(V){b.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",V.toString())}this.FGb()}else b.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:G.a.kfb(Q.data.Xd)}),this.rda({["FailureReason"]:"Failed to deserialize response"}),this.eS();else b.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.rda({["FailureReason"]:"null response"}),this.eS()}UTi(Q){5!==Q.data.status&&12!==Q.data.status||this.CDa?(b.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:Q.data.status,["HttpStatus"]:Q.data.httpStatus}),this.rda({["FailureReason"]:Q.data.httpStatus.toString()}),this.KIa(),this.eS(),this.FGb()):(b.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.CDa=!0,this.Mh&&"true"===this.Mh.SkipSaveToHost?this.f9b():
this.mQ())}KIa(){this.Hm&&(this.Hm.close(),this.Hm=null)}FGb(){this.vga&&(this.vga.stop(),this.vga=null)}HLd(){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.processAction(e.a.buc,2)}rda(Q){this.Mh&&"VersionHistory"===this.Mh.SaveEntryPoint&&this.La.de(e.a.KLd,2,Q)}f9b(){let Q=this.AFa+this.xfa;Q=A.a.Kl(Q,"qs",w.a.mf(t.AFrameworkApplication.qj));Q=A.a.Kl(Q,"n",w.a.mf((new Date).getTime().toString()));Q=A.a.Kl(Q,"ov",w.a.mf(this.qXa.toString()));Q=A.a.Kl(Q,"fn",w.a.mf(this.xA));this.Mh&&
this.Mh.FileDownloadUrl&&(Q=A.a.Kl(Q,"furl",w.a.mf(this.Mh.FileDownloadUrl)));this.zh.Jm(Q,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(c.a)(this,this.VTi,"onUploadFinished"),Object(c.a)(this,this.UTi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(n.a)(D,"UploadToHostManager",null,[254]);var J=a(247),L=a(783);class H{constructor(){this.gb=null}get name(){return"Common.App.SaveAsToHost"}init(){t.AFrameworkApplication.fa.qv(Object(c.a)(this,this.zB,"onFullAppSettingsReady"))}zB(){t.AFrameworkApplication.fa.qa("SaveAsToHostBrsIsEnabled")&&
this.gb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Ig()}Wh(Q){this.gb=Q;this.gb.register(l,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Fc(()=>new l(t.AFrameworkApplication.fa,t.AFrameworkApplication.vb)).wc();this.gb.register(D,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Fc(()=>new D(t.AFrameworkApplication.vb,t.AFrameworkApplication.fa,t.AFrameworkApplication.yd,()=>t.AFrameworkApplication.Qg,
()=>(new L.a).create(),Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.AFrameworkApplication.ta,t.AFrameworkApplication.ta.ZD)).wc();this.gb.register(v,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Fc(()=>new v(t.AFrameworkApplication.fa,t.AFrameworkApplication.vb,t.AFrameworkApplication.ta,t.AFrameworkApplication.ta.Oa,Q.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).wc();
this.gb.register(B,"Common.App.SaveAsToHost.SaveAsToHostActor").Fc(()=>new B(t.AFrameworkApplication.fa,Q.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),Q.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).wc()}dispose(){}static main(){J.a.instance.Gi(new H)}}Object(n.a)(H,"SaveAsToHostPackage",null,[3,4]);a.d(C,"a",function(){return R});const R=()=>{Type.registerNamespace("Common.App.SaveAsToHost");H.main()}},1181:function(n,C,a){n=a(0);var c=a(84),b=a(15),d=a(144);class f{static get mg(){return d.a.Yp(f.ml,
CommonUIStrings.l_SaveACopyFileName)}}f.ml="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(n.a)(f,"FileNameDialogHtml",null,[]);var e=a(4),k=a(30);class l extends d.a{constructor(G,D,J,L){super();this.lTb=
this.B8=null;this.La=G;this.lX=D;this.omb=J;this.rc(1,CommonUIStrings.l_SaveButtonLabel);this.mg=f.mg;this.Ce="FileNameDialog-SaveACopy";this.Mh=L}fQ(G,D,J){this.lTb=G;this.B8=J;G={["txtFileName"]:k.a.Fq(e.AFrameworkApplication.nm.jn),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,D)};this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(c.a)(this,this.G9b,"fileNameDialogHandler"),G);b.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");
document.getElementById("txtFileName").focus()}G9b(G,D){1!==G?b.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(G=D.txtFileName.trim(),b.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),D=k.a.e4(e.AFrameworkApplication.fileName),G&&""!==G&&""!==D&&(G+=D),this.omb.aoa(this.lTb,this.B8,G,this.Mh))}}Object(n.a)(l,"FileNameDialog",d.a,[334]);class m{constructor(G,D,J){this.La=G;this.lX=D;this.omb=J}create(G){return new l(this.La,
this.lX,this.omb,G)}}Object(n.a)(m,"FileNameDialogFactory",null,[320]);var u=a(134),t=a(25);class w extends u.StandardDialog{constructor(G){super();this.Rb=1;this.rc(1,CommonUIStrings.l_RetryButtonLabel);this.rc(0,CommonUIStrings.l_DialogClose);this.La=G}displayError(G){b.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",G);this.bA(G,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(c.a)(this,this.TMd,"retryDialogHandler"))}TMd(G){1===G?(b.ULS.sendTraceTag(7165653,
216,50,"User click to retry the action."),this.La.processAction(t.a.saveACopy,2)):b.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(n.a)(w,"RetryDialog",u.StandardDialog,[248]);u=a(1051);var r=a(834),v=a(373),y=a(106);class x extends u.a{constructor(G,D,J,L){super(G,D,J,L);this.Gug=D}O7a(){return this.nb.qa("SaveACopyBrsIsEnabled")}gXe(){return t.a.saveACopy}N1b(){v.a.UId(Object(c.a)(this,this.iXf,"saveToCloudActionDispatcher"));v.a.P8c([new r.a(t.a.saveACopy,y.a.frame,0)],
this.Gug.B4a())}AOf(){b.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}Object(n.a)(x,"SaveACopyActor",u.a,[]);u=a(1054);class B extends u.a{constructor(G,D,J,L,H,R,Q){super(D,J,L,H,R,Q);this.gqg=G}onSuccess(G){G&&G.data&&G.data.folders?(b.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.gqg.create(this.Mh).fQ(G.data.folders[0].id,G.data.folders[0].name,G.data.folders[0].urls.viewInBrowser)):(b.ULS.sendTraceTag(7165656,216,
10,"Fail to select folder to upload file."),this.uj())}h6(G){G&&G.error&&"user_canceled"===G.error.code&&b.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.h6(G)}uj(){b.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.uj()}}Object(n.a)(B,"SaveACopyManager",u.a,[]);var z=a(1052);class A extends z.a{constructor(G,D,J,L,H,R){super(D,J,L,H,R);this.La=G}$qd(){return!!this.Mh&&!!this.Mh.SaveEntryPoint&&"VersionHistory"===this.Mh.SaveEntryPoint.toString()}eS(){b.ULS.sendTraceTag(7205459,
216,50,"Display Error for Save A Copy.");this.$qd()&&this.La.de(t.a.KLd,2,{["FailureReason"]:"Unknown"});super.eS()}CQa(){b.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.$qd()&&this.La.processAction(t.a.buc,2);super.CQa()}BQa(G){b.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",G);this.$qd()&&this.La.processAction(t.a.buc,2);super.BQa(G)}mQ(){this.Mh&&"true"===this.Mh.SkipSaveToHost?super.mQ():32!==this.La.processAction(t.a.HRa,
1)?(b.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),super.mQ()):this.La.de(t.a.HRa,2,[()=>{b.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");z.a.prototype.mQ.call(this)},()=>{b.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.eS()}])}}Object(n.a)(A,"SaveACopyUploadToCloudManager",z.a,[]);var I=a(247),F=a(562),U=a(783);class X{constructor(){this.gb=
null}get name(){return"Common.App.SaveACopy"}init(){e.AFrameworkApplication.fa.qv(Object(c.a)(this,this.zB,"onFullAppSettingsReady"))}zB(){e.AFrameworkApplication.fa.qa("SaveACopyBrsIsEnabled")&&this.gb.resolve("Common.App.SaveACopy.SaveACopyActor").Ig()}dispose(){}Wh(G){this.gb=G;this.gb.register(A,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Fc(()=>new A(e.AFrameworkApplication.vb,G.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new U.a).create(),()=>new w(e.AFrameworkApplication.vb),
e.AFrameworkApplication.ta,e.AFrameworkApplication.ta.ZD)).wc();this.gb.register(m,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Fc(()=>new m(e.AFrameworkApplication.vb,e.AFrameworkApplication.ta.Oa,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).wc();this.gb.register(x,"Common.App.SaveACopy.SaveACopyActor").Fc(()=>new x(G.resolve("Common.App.SaveACopy.SaveACopyManager"),G.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
e.AFrameworkApplication.fa,e.AFrameworkApplication.ta.ZD)).wc();this.gb.register(B,"Common.App.SaveACopy.SaveACopyManager").Fc(()=>new B(G.resolve("Common.App.SaveACopy.FileNameDialogFactory"),G.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),F.a.instance,G.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),e.AFrameworkApplication.fa,e.AFrameworkApplication.E2a,()=>new w(e.AFrameworkApplication.vb))).wc()}static main(){I.a.instance.Gi(new X)}}Object(n.a)(X,"PackageManager",
null,[3,4]);a.d(C,"a",function(){return T});const T=()=>{Type.registerNamespace("Common.App.SaveACopy");X.main()}},1182:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(15),f=a(30),e=a(82),k=a(241),l=a(36);class m extends k.a{constructor(J,L,H){super(J,L);this.dEd=this.executionContext=null;this.rXi=(R,Q)=>{this.wGb(R,Q)};this.YJ=H}initialize(J){super.initialize(J)}execute(J){this.executionContext=J;J=Object(e.a)(6,this.executionContext.De);this.Frb(J);return 1}SI(J){super.SI(J)}Frb(){this.subscribe(this.executionContext,
this.rXi,J=>{this.dEd.add_disposing(J)})}wGb(J){this.unsubscribe(L=>{J.remove_disposing(L)});this.executionContext.activityState[l.a.i2]=0}}Object(n.a)(m,"PasswordProtectedFileActivity",k.a,[]);var u=a(284),t=a(261),w=a(14);class r extends u.a{constructor(J){super(J);this.Ppa=0;this.D5i=(L,H)=>{this.hbb(L,H)};this.p0d=(L,H)=>{this.HUa(L,H)}}get uc(){return"PasswordDialog"}get Asb(){return this.Ppa}get Nl(){return w.a.instance.ga(1980)}hbb(J){this.Ppa=J}j3(){const J={};J[u.a.description]=w.a.instance.ga(1981);
J[u.a.B6]=w.a.instance.ga(1977);J[u.a.HHf]=w.a.instance.ga(1999);J[u.a.FHf]=w.a.instance.ga(2E3);J[u.a.GHf]=w.a.instance.ga(1978);J[u.a.Gld]=w.a.instance.ga(1984);J[u.a.Xte]=w.a.instance.ga(1668);J[u.a.eWj]=w.a.instance.Va(25);J[u.a.$gg]=this.p0d;return J}rta(){const J={};J[t.a.dv]=this.uc;J[u.a.x_a]=this.j3();return J}Ag(){this.Rb=1;this.initializeAndShow(this.Nl,this.D5i,this.rta())}}Object(n.a)(r,"PasswordProtectedFilePasswordInputDialog",u.a,[]);var v=a(61),y=a(29),x=a(282),B=a(51);class z extends r{constructor(J){super(J);
this.OMd=5;this.U$d=!1;this.passwordToModify=null;this.IHf=()=>{this.$.isEditMode&&this.Fhc&&(B.b().M8c("PasswordToModifyPasswordVerifiedTillInteractive"),this.$.Hl(this.IHf))};this.Ag();this.$.kl(this.IHf)}get Fhc(){return this.U$d}get Nl(){return w.a.instance.ga(1982)}hbb(J,L){super.hbb(J,L);d.ULS.sendTraceTag(537154755,0,50,`PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: ${J}`)}HUa(J,L){this.passwordToModify=J;const H={};H.FileModifyPassword=
f.a.mf(J);v.M(this.$.pa.va,H,this.$Ti(L),this.ZTi(L),null,null)}j3(){const J=super.j3();J[u.a.Gld]=w.a.instance.ga(1985);J[u.a.description]=w.a.instance.Va(24);return J}Ag(){B.b().M8c("PasswordToModifyDialogShown");d.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");super.Ag()}$Ti(J){return L=>{y.a.lh(L.Errors,[-2019873242])&&this.X6b(this.wrb());if(!L||x.a(L))if(0<this.OMd)this.eNf(J);else{d.ULS.sendTraceTag(537154754,
0,10,`VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: ${y.a.xc(L.Errors)}`);this.$.ea.Gp(L.Errors);this.hide();return}this.U$d=L.Result;this.Fhc&&(B.b().$Ud("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),d.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));
J(this.Fhc?0:1)}}ZTi(J){return()=>{0<this.OMd?this.eNf(J):(d.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),J(3))}}eNf(J){--this.OMd;this.HUa(this.passwordToModify,J)}wrb(){return y.a.Yc(1,0,1667,1668,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")}}Object(n.a)(z,"PasswordProtectedFileModifyPasswordInputDialog",r,[]);var A=a(6);class I extends m{constructor(J,L,H){super(J,L,H)}Frb(J){this.dEd=
new z(J);super.Frb(J)}wGb(J,L){const H=J.Asb,R=J.Fhc,Q=J.passwordToModify;super.wGb(J,L);this.executionContext.nya([2001366804]);switch(H){case 1:R?(L=Object(e.a)(6,this.executionContext.De),this.executionContext.activityState[l.a.eme]=f.a.mf(Q),this.executionContext.activityState[l.a.PYa]=!0,J.passwordToModify="",this.gh(L.isEditMode?A.a.Fj:this.RJ)):d.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Dp();break;case 0:this.executionContext.activityState[l.a.Qr]=!1;this.gh(this.YJ);this.Dp();break;default:d.ULS.sendTraceTag(537154756,0,50,`PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '${H}'`)}}}Object(n.a)(I,"PasswordProtectedFileModifyActivity",m,[]);class F extends b.a{constructor(J,L,H,R){super();this.activityName=J;this.RJ=L;this.YJ=H;this.$=R;this.Eb()}create(){this.pb(new I(this.activityName,this.RJ,this.YJ))}static ka(J){J.da.Ga(434,new F(A.a.vGb,
A.a.efb,A.a.xqb,J))}}Object(n.a)(F,"PasswordProtectedFileModifyActivityFactory",b.a,[]);var U=a(42);class X extends r{constructor(J,L){super(J);this.password=null;this.Djf=L;this.Ag()}HUa(J,L){this.password=J;L(0)}j3(){const J=super.j3();this.Djf&&(J[u.a.anh]=1);return J}Ag(){d.ULS.sendTraceTag(537154722,0,50,`PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword=${this.Djf}`);super.Ag();U.a(this.$).jqe()}}Object(n.a)(X,"PasswordProtectedFileOpenPasswordInputDialog",
r,[]);class T extends m{constructor(J,L,H){super(J,L,H)}Frb(J){const L=y.a.lh(this.executionContext.errors,[1217361942]);this.dEd=new X(J,L);J.Hfc||J.UIe();super.Frb(J)}wGb(J,L){let H,R;H=J.password;J.password="";R=J.Asb;super.wGb(J,L);this.executionContext.activityState[l.a.vUc]=f.a.mf(H);this.executionContext.activityState[l.a.PYa]=!0;this.executionContext.nya([110414285,1217361942]);d.ULS.sendTraceTag(537154752,0,50,`PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: ${R}`);
switch(R){case 1:this.gh(this.RJ);this.Dp();break;case 0:this.gh(this.YJ),this.Dp()}}}Object(n.a)(T,"PasswordProtectedFileOpenActivity",m,[]);class G extends b.a{constructor(J,L,H,R){super();this.activityName=J;this.RJ=L;this.YJ=H;this.$=R;this.Eb()}create(){this.pb(new T(this.activityName,this.RJ,this.YJ))}static ka(J){J.da.Ga(386,new G(A.a.Wpc,A.a.Fj,A.a.Rj,J))}}Object(n.a)(G,"PasswordProtectedFileOpenActivityFactory",b.a,[]);a.d(C,"a",function(){return D});const D=()=>{c.a.Fa(G.ka);c.a.Fa(F.ka)}},
1190:function(n,C,a){n=a(0);var c=a(134);class b extends c.StandardDialog{constructor(){super();this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose)}displayError(T){this.bA(T,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}}Object(n.a)(b,"ErrorDialog",c.StandardDialog,[248]);var d=a(1054),f=a(1051),e=a(15),k=a(84),l=a(4),m=a(251),u=a(39),t=a(25);class w extends c.StandardDialog{constructor(T,G,D){super();this.La=T;this.T1=G;this.lX=D;this.Nv=!1;this.Rb=1;this.s0(1);
this.rc(1,CommonUIStrings.l_SignIn);this.rc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}fQ(){this.T1.aZa(Object(k.a)(this,this.zEf,"onSignIn"));this.Dl(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(k.a)(this,this.cci,"inputHandler"))}cci(T){0===T?(e.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.A6()}OXg(){let T="2";if(this.lX)switch(this.lX.Dj){case 3:T="0";break;case 2:T="3";break;case 1:T="1"}return T}hide(){this.T1.PIb(Object(k.a)(this,
this.zEf,"onSignIn"));super.hide()}A6(){const T=new m.QueryStringBuilder("Signin.aspx");T.Zi("prompt","1");T.Zi("cbcxt",this.OXg());l.AFrameworkApplication.SYa(T);u.a.Ze(T.toString(),"LoginWindow",void 0,"SignInDialog")}zEf(){this.wn&&this.hide();e.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(t.a.saveToCloudStorage,2)}}Object(n.a)(w,"SignInDialog",c.StandardDialog,[283]);class r{constructor(T,G,D){this.La=T;this.T1=
G;this.lX=D}create(){return new w(this.La,this.T1,this.lX)}}Object(n.a)(r,"SignInDialogFactory",null,[244]);var v=a(80),y=a(30);class x{constructor(T,G,D,J,L,H,R){this.AFa=T;this.xA=G;this.hWa=D;this.lTb=J;this.EPc=L;this.xfa=H;this.Mh=R}execute(T,G){if(!l.AFrameworkApplication.Qg&&l.AFrameworkApplication.yd){var D=this.AFa+this.xfa;D=v.a.Kl(D,"fo",y.a.mf(this.lTb));D=v.a.Kl(D,"fn",y.a.mf(this.xA));D=v.a.Kl(D,"qs",y.a.mf(this.EPc));D=v.a.Kl(D,"n",y.a.mf((new Date).getTime().toString()));this.Mh&&
this.Mh.FileDownloadUrl&&(D=v.a.Kl(D,"furl",y.a.mf(this.Mh.FileDownloadUrl)));this.hWa&&(D=v.a.Kl(D,"fnn",y.a.mf(this.hWa)));l.AFrameworkApplication.yd.Jm(D,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,T,G,null)}}}Object(n.a)(x,"SkyDriveUploadCaller",null,[282]);class B{constructor(T){this.nb=T;this.BFa=T.appSettings.SkyDriveUploadWebServiceBase;this.xA=T.appSettings.FileName;this.xfa=T.Xa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(T,G,D){return new x(this.BFa,this.xA,
G,T,l.AFrameworkApplication.qj,this.xfa,D)}}Object(n.a)(B,"SkydriveUploadCallerFactory",null,[243]);var z=a(1052),A=a(247),I=a(562),F=a(783);class U{constructor(){this.gb=null}get name(){return"Common.App.SaveToCloudStorage"}init(){l.AFrameworkApplication.fa.qa("SaveToCloudStorageUIIsEnabled")&&this.gb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ig()}dispose(){}Wh(T){this.gb=T;this.gb.register(r,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Fc(()=>
new r(l.AFrameworkApplication.vb,I.a.instance,l.AFrameworkApplication.ta.Oa)).wc();this.gb.register(B,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Fc(()=>new B(l.AFrameworkApplication.fa)).wc();this.gb.register(f.a,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Fc(()=>new f.a(T.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),T.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.ta.ZD)).wc();this.gb.register(z.a,"Common.App.SaveToCloudStorage.UploadToCloudManager").Fc(()=>new z.a(T.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new F.a).create(),()=>new b,l.AFrameworkApplication.ta,l.AFrameworkApplication.ta.ZD)).wc();this.gb.register(d.a,"Common.App.SaveToCloudStorage.SaveToCloudManager").Fc(()=>new d.a(T.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),I.a.instance,T.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),
l.AFrameworkApplication.fa,l.AFrameworkApplication.E2a,()=>new b)).wc()}static main(){A.a.instance.Gi(new U)}}Object(n.a)(U,"PackageManager",null,[3,4]);a.d(C,"a",function(){return X});const X=()=>{Type.registerNamespace("Common.App.SaveToCloudStorage");U.main()}},1191:function(n,C,a){n=a(0);var c=a(84),b=a(15),d=a(4),f=a(54),e=a(416),k=a(83);class l{constructor(z,A,I,F){this.tNc=null;this.uSb=F;this.FX=z;this.GX=A;this.eE=I;this.aie=this.iqf.sxj;z=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");
this.Ptg=z[0];this.Otg=z[1]}get iqf(){return this.tNc||(this.tNc=k.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get lwa(){return CommonUIStrings.l_OICErrorHelpLink}get Sxc(){return this.aie}get kqf(){return this.Ptg}get jqf(){return this.Otg}get hqf(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.aie?3:2}get ztb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get U3b(){return!!this.GX}get Atb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get Nl(){return CommonUIStrings.l_DefaultDialogTitle}KHd(z){this.qEb(z)}Ztd(z){this.qEb(z)}qEb(z){let A=
10;this.GX&&1===z&&(this.GX(this.eE),A=1);this.FX&&this.FX(this.eE);this.eG(A)}VOa(){e.Redirect.showHelp("OICFailure");this.eG(2)}$zd(){this.iqf.Flf();this.eG(4)}eG(z){b.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.uSb,z);d.AFrameworkApplication.Utc(f.a.uGf,this.uSb,z)}dispose(){this.eE=this.FX=this.GX=null}}Object(n.a)(l,"AOICErrorDialog",null,[10]);var m=a(44),u=a(134);class t extends l{constructor(z,A,I,F){super(z,A,I,F);this.Jqa=this.im=null;
z=document.createElement("span");z.id="errorMessageText";z.innerText=this.errorMessage;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.im=document.createElement("a");this.im.href="#";this.im.innerText=this.lwa;z.appendChild(this.im);m.a.addHandler(this.im,"click",Object(c.a)(this,this.VOa,"oicErrorHelpLinkHandler"));A=new u.StandardDialog;A.Ce=this.id;this.Sxc?(I=document.createElement("span"),F=document.createElement("span"),I.innerText=this.kqf,F.innerText=
this.jqf,this.Jqa=document.createElement("a"),this.Jqa.href="#",this.Jqa.innerText=this.hqf,z.appendChild(document.createElement("br")),z.appendChild(I),z.appendChild(this.Jqa),z.appendChild(F),m.a.addHandler(this.Jqa,"click",Object(c.a)(this,this.$zd,"oicErrorMacOfferLinkHandler"))):this.U3b&&(z.appendChild(document.createElement("br")),z.appendChild(document.createElement("br")),I=document.createElement("span"),I.innerText=this.ztb,z.appendChild(I));this.U3b?(A.Rb=1,A.rc(1,this.Atb)):A.Rb=0;A.Dl(this.Nl,
null,this.icon,Object(c.a)(this,this.Ztd,"legacyOICErrorDialogHandler"),z);A.DW("errorMessageText")}dispose(){this.im&&(m.a.removeHandler(this.im,"click",Object(c.a)(this,this.VOa,"oicErrorHelpLinkHandler")),this.im=null);this.Jqa&&(m.a.removeHandler(this.Jqa,"click",Object(c.a)(this,this.$zd,"oicErrorMacOfferLinkHandler")),this.Jqa=null);super.dispose()}}Object(n.a)(t,"OICErrorDialog",l,[]);class w{constructor(z,A,I){this.FX=A;this.GX=z;this.eE=I}get id(){return"OICErrorDialogWithDownload"}get mNe(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get lwa(){return CommonUIStrings.l_OICErrorHelpLink}get ztb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get Atb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get Nl(){return CommonUIStrings.l_DefaultDialogTitle}KHd(z){this.qEb(z)}Ztd(z){this.qEb(z)}qEb(z){let A=
10;1===z&&(this.GX(this.eE),A=1);this.FX&&this.FX(this.eE);this.eG(A)}VOa(){e.Redirect.showHelp("OICFailure");this.eG(2)}eG(z){d.AFrameworkApplication.Utc(f.a.vGf,3,z)}dispose(){this.eE=this.GX=this.FX=null}}Object(n.a)(w,"AOICErrorDialogWithDownload",null,[10]);class r extends w{constructor(z,A,I){super(z,A,I);this.im=null;z=document.createElement("span");z.id="errorMessageText";z.innerText=this.mNe;z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));this.im=document.createElement("a");
this.im.href="#";this.im.innerText=this.lwa;z.appendChild(this.im);m.a.addHandler(this.im,"click",Object(c.a)(this,this.VOa,"oicErrorHelpLinkHandler"));z.appendChild(document.createElement("br"));z.appendChild(document.createElement("br"));A=document.createElement("span");A.innerText=this.ztb;z.appendChild(A);A=new u.StandardDialog;A.Ce=this.id;A.Rb=1;A.rc(1,this.Atb);A.Dl(this.Nl,null,this.icon,Object(c.a)(this,this.Ztd,"legacyOICErrorDialogHandler"),z);A.DW("errorMessageText")}dispose(){this.im&&
(m.a.removeHandler(this.im,"click",Object(c.a)(this,this.VOa,"oicErrorHelpLinkHandler")),this.im=null);super.dispose()}}Object(n.a)(r,"OICErrorDialogWithDownload",w,[]);var v=a(144);class y extends l{constructor(z,A,I,F){super(z,A,I,F);A={["errorMessage"]:this.errorMessage};A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.lwa,["onExecute"]:U=>{this.VOa(U)}};this.Sxc?(A.macOfficePreLinkText=this.kqf,A.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.hqf,
["onExecute"]:U=>{this.$zd(U)}},A.macOfficePostText=this.jqf):this.U3b&&(A.errorFileDownloadOffer=this.ztb);z=new v.a(!1,!1,!0);this.U3b?(z.Rb=1,z.rc(1,this.Atb)):z.Rb=0;z.Ce=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Nl,Object(c.a)(this,this.KHd,"reactOICErrorDialogHandler"),A)}}Object(n.a)(y,"ReactOICErrorDialog",l,[]);class x extends w{constructor(z,A,I){super(z,A,I);A={["errorMessage"]:this.mNe,["errorFileDownloadOffer"]:this.ztb};A.helpLink=
{["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.lwa,["onExecute"]:F=>{this.VOa(F)}};z=new v.a(!1,!1,!0);z.Rb=1;z.rc(1,this.Atb);z.Ce=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};z.initializeAndShow(this.Nl,Object(c.a)(this,this.KHd,"reactOICErrorDialogHandler"),A)}}Object(n.a)(x,"ReactOICErrorDialogWithDownload",w,[]);a.d(C,"a",function(){return B});class B{constructor(){this.pjb=!!d.AFrameworkApplication.ta&&d.AFrameworkApplication.ta.Oa.vv}q9g(z,A,I){this.pjb?
new y(z,A,null,I):new t(z,A,null,I)}r9g(z,A,I){this.pjb?new x(z,A,I):new r(z,A,I)}s9g(z,A,I,F,U){const {ReactOICErrorDialogWithTrial:X}=a(1329),{OICErrorDialogWithTrial:T}=a(1330);this.pjb?new X(z,A,I,null,F,U):new T(z,A,I,null,F,U)}static get instance(){return B.Ma||(B.Ma=new B)}}B.Ma=null;Object(n.a)(B,"OICErrorDialogFactory",null,[506])},1208:function(n,C,a){var c=a(9);n=a(0);var b=a(694),d=a(21),f=a(43),e=a(1),k=a(15),l=a(30),m;(function(F){F[F.url=0]="url";F[F.ref=1]="ref";F[F.mailto=2]="mailto"})(m||
(m={}));Object(n.b)("HyperlinkSelectionState",m);var u=a(771),t=a(8),w=a(585),r=a(61),v=a(96),y=a(14);class x extends u.a{constructor(F,U,X){super(F);this.Nmb=0;this.vzb=!1;this.b2a=null;this.fJe=!1;this.jrb=!0;this.Nl=this.eUc=null;this.Kyd=0;this.Jyd=this.Lyd=null;this.removeHyperLink=!1;this.location=this.cellValue=null;this.U7h=(T,G)=>{1===T||2===T?(k.ULS.sendTraceTag(555755670,0,50,`HyperLink ${1===T?"OK":"Remove"} pressed`),this.Lyd=G[x.Nsi],this.Kyd=G[x.dmj],this.Jyd=G[x.xhh],2===T&&(this.removeHyperLink=
!0),this.commit()):k.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};this.NVj=(T,G)=>0!==G&&T.length?1===G?this.SZe(f.y(T,this.ea.xa)||this.wCi(T),765):this.SZe(l.a.Aod(T),767):null;this.selectedRange=U;this.eM=X;this.ea=F.ea;this.sheetName=U.SheetName;this.cMa();this.Po();this.Rb=this.vzb?9:1;this.rc(1,y.a.instance.ga(4));this.vzb&&this.rc(2,y.a.instance.ga(768));this.initializeAndShow(this.Nl,this.U7h,{[x.dv]:this.uc,[x.OVj]:this.NVj,[x.$Pg]:{[x.Ggh]:this.fJe,[x.yhh]:this.b2a,[x.$Ag]:this.Nmb,
[x.aBg]:this.eUc,[x.M4g]:this.jrb}})}get uc(){return"HyperLinkDialog"}G0e(F,U){switch(U){case 2:return F.startsWith("mailto:")?F:"mailto:"+F;case 1:return`${t.a.nJf}${this.ZRh(F)}`;default:return F}}get hA(){return 526}EE(){const F=this.$;this.location=this.G0e(this.Lyd,this.Kyd);try{this.location=v.a.ki(this.location)}catch(T){k.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}k.ULS.sendTraceTag(555755667,0,50,`Committing ${m[this.Kyd]} link`);this.cellValue=this.Jyd.length?this.Jyd:
this.Lyd;F.Ay();const U=F.pa.va.Tb(),X=f.s(this.selectedRange);return(T,G,D)=>r.b(F.pa.va,X,this.cellValue,this.location,this.removeHyperLink,!1,123,T,G,D,this.eM.range,U)}Qj(){const F=f.s(this.selectedRange);return()=>new w.a(F,this.cellValue,this.location)}Xyh(){let F=this.eM.cell.I5a;this.eM.cell.kxb?F&&F.startsWith("mailto:")?(this.Nmb=2,F=F.substr(7)):this.Nmb=0:this.Nmb=1;return F}cMa(){e.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.vzb=this.eM.Zaa:this.vzb=!!this.eM.EKa(64)||
!!this.eM.EKa(128)}Po(){if(this.vzb){this.b2a=this.eM.text;const F=this.Xyh();F&&(this.eUc=F);this.Nl=y.a.instance.ga(832);this.jrb=this.eUc===this.b2a}else this.eM.text?(this.b2a=this.eM.text,this.jrb=!1):(this.b2a="",this.jrb=!0),this.Nmb=0,this.Nl=y.a.instance.ga(831);this.eM.tF&&(this.jrb=!1,this.fJe=!0,e.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.b2a=this.eM.formulaBarText))}wCi(F){return this.ea.Ab.Lk(F)}SZe(F,U){return F?null:y.a.instance.ga(U)}ZRh(F){let U,
X;({sheetName:U,range:X}=f.Z(F,this.ea.xa)).returnValue&&X&&(F=f.x(X,U||this.sheetName,!1));return F}}x.OVj="validateLinkValues";x.$Pg="bodyProps";x.Ggh="disableDisplayText";x.yhh="displayTextValue";x.$Ag="activeLinkOption";x.aBg="activeLinkValue";x.M4g="copyLinkValueToDisplay";x.Nsi="linkValue";x.dmj="selectedLink";x.xhh="displayText";Object(n.a)(x,"HyperlinkDialog",u.a,[]);var B=a(55);class z{constructor(F,U){this.$=F;this.gridView=U}Lc(){return!1}Ac(F,U){return 1===F&&-1583422759===U.command}Oc(){return!1}executeCommand(){this.xAj();
return B.Task.Ta(!0)}xAj(){const F=f.v(this.gridView.ha.sa.Xc,this.$),U=d.e(this.gridView);(!e.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Sp([this.gridView.ha.sa.Xc],!0))&&U&&new x(this.$,F,U)}}Object(n.a)(z,"ShowHyperlinkCommandHandler",null,[164]);class A extends b.a{constructor(F){super(F)}vd(){this.$c([new z(this.$,d.g(this.$))])}static ka(F){b.a.Od(105,new A(F))}}Object(n.a)(A,"ShowHyperlinkCommandHandlerFactory",b.a,[]);a.d(C,
"a",function(){return I});const I=()=>{c.a.Fa(A.ka)}},1209:function(n,C,a){var c=a(9);n=a(0);var b=a(4),d=a(106),f=a(694),e=a(61),k=a(50),l=a(37),m=a(15),u=a(183),t=a(25),w=a(55);class r{constructor(A,I){this.$=A;this.gi=I}Lc(){return!1}executeCommand(A,I,F){A=2;switch(I.command){case -309686558:A=this.gi.de(t.a.saveACopy,2,F);break;case 617689800:A=this.gi.de(t.a.saveToCloudStorage,2,F);break;case -1244760097:A=this.gi.de(t.a.saveToSharePoint,2,F)}return 2===A&&I?u.a(I.command):w.Task.Ta(!0)}Ac(A,
I){A=!1;switch(I.command){case -1244760097:case -309686558:case 617689800:A=!0,m.ULS.shipAssertTag(537153984,0,this.$.wka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return A}Oc(){return!1}}Object(n.a)(r,"SaveToHostCommandHandler",null,[164]);class v extends f.a{constructor(A){super(A);this.MDh=(I,F,U,X,T)=>1===U?32:I===t.a.HRa&&2===U?(I=this.$.pa.va.Tb(),e.C(this.$.pa.va,T[0],T[1],null,null,I),32):8}vd(){l.TaskExtensions.Aa(k.GetServiceTaskFactory.create(this.$.da,
155,this.la,this.fb),()=>{this.$c([new r(this.$,b.AFrameworkApplication.vb)])},this.la,3);b.AFrameworkApplication.vb.Nb(t.a.HRa,d.a.frame,this.MDh)}static ka(A){f.a.Od(267,new v(A))}}Object(n.a)(v,"SaveToHostCommandHandlerFactory",f.a,[]);var y=a(222);class x{constructor(A,I){this.$=A;this.gi=I;this.$.da.Ga(393,this)}Lc(A){switch(A){case -309686558:return 8===this.gi.processAction(t.a.saveACopy,1,null);case 617689800:return 8===this.gi.de(t.a.saveToCloudStorage,1,null);case -1244760097:return 8===
this.gi.de(t.a.saveToSharePoint,1,null)}return!1}dispose(){this.$=null}}Object(n.a)(x,"SaveToHostManager",null,[239,10]);class B extends y.a{constructor(A){super();this.$=A;this.Eb()}create(){this.pb(this.$.da.za(393)||new x(this.$,b.AFrameworkApplication.vb))}static ka(A){A.da.Ga(394,new B(A))}}Object(n.a)(B,"SaveToHostManagerFactory",y.a,[]);a.d(C,"a",function(){return z});const z=()=>{c.a.Fa(v.ka);c.a.Fa(B.ka)}},1210:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(15),f=a(82),e=a(114),k=a(29),
l=a(36);class m extends e.a{constructor(G,D){super(G,D)}execute(G){const D=Object(f.a)(6,G.De);d.ULS.shipAssertTag(537153921,0,k.a.lob(G.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");D.qI(!0,!0);G.activityState[l.a.XYb]=D.ea.sessionId;G.activityState[l.a.Qmb]=!0;G.activityState[l.a.cZb]=!0;d.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3}}Object(n.a)(m,"SessionReloadActivity",e.a,
[]);var u=a(6);class t extends b.a{constructor(){super();this.Eb()}create(){this.pb(new m(u.a.Ucb,u.a.dz))}static ka(G){G.da.Ga(142,new t)}}Object(n.a)(t,"SessionReloadActivityFactory",b.a,[]);var w=a(58),r=a(265),v=a(109),y=a(47),x=a(45),B=a(35),z=a(1),A=a(46),I=a(245),F=a(115);class U extends e.a{constructor(G,D,J,L,H){super(G,D);U.swd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];U.rwd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];
U.cqf=[-1468309555,611268539,-1750576502,61029505];U.bqf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];this.Hyc=J;this.hCj=L;this.kLj=H}execute(G){var D=Object(f.a)(6,G.De);G.activityState[l.a.Mra]=!0;var J=U.hYh(G);if(U.kwj(G,J))return U.hzi(G),J=50,0<G.errors.length&&(J=15),d.ULS.sendTraceTag(537153891,0,J,`SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : ${k.a.xc(G.errors)}`),G.activityState[l.a.Mra]=!1,this.gh(u.a.idle),
3;switch(J){case 1:case 3:this.Xbi(G,J);break;case 2:this.Wbi(G);break;case 0:G.activityState[l.a.QYa]=null}d.ULS.sendTraceTag(21837003,0,50,`SessionReloadSilentActivity.Execute: silentReloadType:${J}. activityName:${this.activityName}. NextActivityName:${this.t_}. TimeFromLastStatefulResponse:${D.ea.O0}.`);var L=B.a.rg(G.activityState,F.a.hfb);d.ULS.shipAssertTag(40502925,0,!L||L&&(1===J||3===J),`triggerSilentReloadAfterTokenRefresh: ${L}, silentReloadType: ${J}`);D=D.el.reloadCount;return 0!==J&&
0<D?(L=r.a.Nva(D,200),d.ULS.sendTraceTag(537153890,0,50,`SessionReloadSilentActivity.Execute: schedule Silent-Type [${J}] retryNum [${D}] delayInMs [${L}] activityName [${this.activityName}]`),y.a.instance.create(()=>{U.yM(G)},L,x.a.qoj),1):3}Xbi(G,D){d.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");const J=Object(f.a)(6,G.De);G.activityState[l.a.Qmb]=!0;J.Hfc||A.PageLoadTrackingInfo.instance.wj("ReopenOnLoad");!U.isEditMode(G)&&k.a.lob(G.errors)&&
(d.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),G.activityState[l.a.XYb]=J.ea.sessionId,G.activityState[l.a.cZb]=!0);G.Jwd();3===D?(J.ea.fg()||J.ea.DEi(),J.qI(!0,!0),this.gh(this.kLj),G.activityState[l.a.Vle]=J.workbookContext.CalcMode):(z.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===D&&J.qI(!0,!0),G.activityState[l.a.nUc]=!1,this.gh(this.Hyc))}Wbi(G){d.ULS.sendTraceTag(537153888,
0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");G.activityState[l.a.QYa]=null;G.Jwd();this.gh(this.hCj);G=Object(f.a)(6,G.De);G.Hfc||(A.PageLoadTrackingInfo.instance.wj("RefreshOnLoad"),G.tJb())}static yM(G){G.yM()}static hYh(G){const D=Object(f.a)(6,G.De),J=D.ea,L=U.isEditMode(G);var H=k.a.lh(G.errors,L?U.rwd:U.swd);const R=k.a.lh(G.errors,L?U.bqf:U.cqf),Q=D.hN,O=D.el.reloadCount,V=D.ya.MaxConsecutiveSilentReloadAllowed,W=D.el.m8e(),da=k.a.xc(G.errors),ta=k.a.xc(G.Fza),
K=0<k.a.LM(pa=>!pa.triggerSilentReopenOnly,G.errors).length;let na=H;const P=B.a.rg(G.activityState,F.a.hfb);P&&(na=!0);const ka={name:"SessionReloadSilentActivity.GetSilentReloadType"};ka.editMode=L;ka.isSilentReopenError=H;ka.isSilentRefreshError=R;ka.reloadSequenceCount=D.el.LQa;ka.reloadCount=O;ka.maxReloads=V;ka.stopSilentReloads=W;ka.errorNames=da;ka.processedErrorNames=ta;ka.isClientDirty=Q;ka.errorsForSilentReopenOnly=K;ka.triggerSilentReloadAfterTokenRefresh=P;ka.IsReopenDisabled=D.aNa;H=
w.a.kc(ka);d.ULS.sendTraceTag(21837004,0,50,H);if(!W){if(na&&(L?U.bwj(G):U.dwj(G)))return I.a.a3f(G,D)?3:D.aNa?2:1;if(R&&(L||!J.lbb))return 2}return 0}static kwj(G,D){for(const J of G.errors)if(-1337545025===J.MessageId||-238814601===J.MessageId)return!1;return k.a.LM(J=>!J.triggerSilentReopenOnly,G.errors).length?3!==D:!1}static hzi(G){const D=k.a.LM(J=>!J.triggerSilentReopenOnly,G.errors);for(const J of D)G.fca(J)}static isEditMode(G){const D=Object(f.a)(6,G.De);return D.ea.fc?D.rv&&!!(D.Cd&64):
B.a.rg(G.activityState,l.a.Qr)}static dwj(G){const D=Object(f.a)(6,G.De),J=k.a.T3(G.errors,U.swd);if(v.b(J,L=>L.ForceVersionUpgrade))return!1;G=k.a.lob(G.errors);return!D.ea.lbb||G?!0:!1}static bwj(G){G=k.a.T3(G.errors,U.rwd);return!v.b(G,D=>D.ForceVersionUpgrade)}}U.swd=null;U.rwd=null;U.cqf=null;U.bqf=null;Object(n.a)(U,"SessionReloadSilentActivity",e.a,[]);class X extends b.a{constructor(G,D){super();this.activityName=G;this.RJ=D;this.Eb()}create(){this.pb(new U(this.activityName,this.RJ,u.a.dz,
u.a.hj,u.a.COb))}static ka(G){G.da.Ga(143,new X(u.a.wna,u.a.M0b));G.da.Ga(144,new X(u.a.mwc,u.a.BPa));G.da.Ga(145,new X(u.a.nwc,u.a.jDd));G.da.Ga(154,new X(u.a.Vcb,u.a.OO))}}Object(n.a)(X,"SessionReloadSilentActivityFactory",b.a,[]);a.d(C,"a",function(){return T});const T=()=>{c.a.Fa(G=>{t.ka(G);X.ka(G)})}},1220:function(n,C,a){var c=a(9);n=a(0);var b=a(222),d=a(15),f=a(82),e=a(241),k=a(317),l=a(29),m=a(14),u=a(379),t=a(96);class w extends u.a{constructor(z,A){super(z,A);this.Ppa=0;this.Ir()}get uc(){return"SharedWorkbookDialog"}get Asb(){return this.Ppa}vO(z,
A){this.Ppa=z;super.vO(z,A)}Ir(){super.Ir();this.Rb=9;const z=this.RRh();this.rc(1,m.a.instance.ga(1666));this.rc(2,m.a.instance.ga(994));this.Dl(m.a.instance.ga(707),t.a.ki(z),this.icon,this.E0)}RRh(){return String.format(m.a.instance.ga(708))}}Object(n.a)(w,"LegacySharedWorkbookDialog",u.a,[]);var r=a(6),v=a(36);class y extends e.a{constructor(z,A,I){super(z,A);this.executionContext=null;this.usi=F=>{const U=this.Ns.kd,X=Object(f.a)(6,U.De);let T;T=F.Asb;this.unsubscribe(G=>{F.remove_disposing(G)});
for(let G=0,D=U.errors.length;G<D;G++)-573864504===U.errors[G].MessageId&&U.fca(U.errors[G]);switch(T){case 1:X.ea.uBc=!0;d.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");this.gh(X.isEditMode?r.a.COb:this.Mdh);this.Dp();break;case 2:this.gh(r.a.openInExcelClient);this.Dp();break;case 0:U.activityState[v.a.Qr]=!1,this.gh(this.YJ),this.Dp()}};this.Mdh=A;this.YJ=I}initialize(z){super.initialize(z)}execute(z){this.executionContext=
z;this.a7g();return 1}SI(z){super.SI(z)}a7g(){const z=Object(f.a)(6,this.executionContext.De),A=l.a.I_a([-573864504]);A[0].HelpDescription=m.a.instance.ga(710);A[0].HelpTopicId=k.a.vsi;const I=new w(z,A[0]);this.subscribe(this.executionContext,this.usi,F=>{I.add_disposing(F)})}}Object(n.a)(y,"LegacySharedWorkbookActivity",e.a,[]);class x extends b.a{constructor(z,A,I,F){super();this.activityName=z;this.RJ=A;this.YJ=I;this.$=F;this.Eb()}create(){this.pb(new y(this.activityName,this.RJ,this.YJ))}static ka(z){z.da.Ga(460,
new x(r.a.eCb,r.a.efb,z.ZAb?r.a.Rj:r.a.xqb,z))}}Object(n.a)(x,"LegacySharedWorkbookActivityFactory",b.a,[]);a.d(C,"a",function(){return B});const B=()=>{c.a.Fa(x.ka)}},1244:function(n,C,a){n=a(0);var c=a(1281),b=a(1282),d=a(4);class f{constructor(){this.u6d=this.gb=null}get name(){return"Common.App.DirectPrint"}Wh(l){this.gb=l;l.register(c.a,"Common.App.DirectPrint.DirectPrintDialogFactory").wc().Fc(()=>new c.a(d.AFrameworkApplication.ta.QW));l.register(232,"Common.App.DirectPrint.IDirectPrintManager").wc().Fc(()=>
b.a.create(this.gb))}init(){this.u6d=this.gb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.u6d.start()}dispose(){}}Object(n.a)(f,"PackageManager",null,[3,4]);var e=a(247);a.d(C,"a",function(){return k});const k=()=>{Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Gi(new f)}},1257:function(n,C,a){n=a(0);var c=a(15),b=a(4),d=a(86),f=a(27),e=a(38),k=a(78),l;(function(H){H[H.unableToRefreshLock=0]="unableToRefreshLock";H[H.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";
H[H.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";H[H.workbookTooLarge=3]="workbookTooLarge";H[H.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";H[H.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";H[H.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";H[H.unsupportedFeatures=7]="unsupportedFeatures";H[H.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";H[H.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";
H[H.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";H[H.lastGenericStatusError=11]="lastGenericStatusError";H[H.scratchPadWarning=12]="scratchPadWarning";H[H.authenticationLost=13]="authenticationLost";H[H.odfCompatibilityIssues=14]="odfCompatibilityIssues";H[H.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";H[H.workbookIsIrmProtected=16]="workbookIsIrmProtected";H[H.biFeatureNotAvailable=17]="biFeatureNotAvailable";H[H.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";
H[H.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";H[H.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";H[H.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";H[H.editAttemptInReadOnly=22]="editAttemptInReadOnly";H[H.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";H[H.unsupportedBrowser=24]="unsupportedBrowser";H[H.readOnlyPermissions=25]="readOnlyPermissions";H[H.documentIsIrmProtectedWarning=26]=
"documentIsIrmProtectedWarning";H[H.policyWarningMessage=27]="policyWarningMessage";H[H.workingOnIt=28]="workingOnIt";H[H.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";H[H.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";H[H.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";H[H.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";H[H.legacyConnectionsBB=33]="legacyConnectionsBB";H[H.tooManyLoadBlockingFloatingObjectsBB=
34]="tooManyLoadBlockingFloatingObjectsBB";H[H.groupedSlicersBB=35]="groupedSlicersBB";H[H.thirdPartyAddinDisabled=36]="thirdPartyAddinDisabled";H[H.financeLinkedEntityDisclaimerBar=37]="financeLinkedEntityDisclaimerBar";H[H.wolframDeprecationAlertBar=38]="wolframDeprecationAlertBar";H[H.wacGdprNotice=39]="wacGdprNotice";H[H.automaticSensitivityLabel=40]="automaticSensitivityLabel";H[H.recommendedSensitivityLabel=41]="recommendedSensitivityLabel";H[H.mandatorySensitivityLabel=42]="mandatorySensitivityLabel";
H[H.localStorageDisabled=43]="localStorageDisabled";H[H.autoRefreshDisabled=44]="autoRefreshDisabled";H[H.corruptedFileRepaired=45]="corruptedFileRepaired";H[H.corruptedOdsFileRepaired=46]="corruptedOdsFileRepaired";H[H.minorVersionLimitReached=47]="minorVersionLimitReached";H[H.sensitivityApplicationGenericError=48]="sensitivityApplicationGenericError";H[H.sensitivityApplicationTooLargeFileError=49]="sensitivityApplicationTooLargeFileError";H[H.sensitivityApplicationLabelNotSupportedError=50]="sensitivityApplicationLabelNotSupportedError";
H[H.sensitivityApplicationLabelDisabledError=51]="sensitivityApplicationLabelDisabledError";H[H.sensitivityApplicationMandatoryConflictError=52]="sensitivityApplicationMandatoryConflictError";H[H.sensitivityApplicationMinorVersionLimitReachedError=53]="sensitivityApplicationMinorVersionLimitReachedError";H[H.sensitivityApplicationSetLabelError=54]="sensitivityApplicationSetLabelError";H[H.promptEnableExternalLinks=55]="promptEnableExternalLinks";H[H.networkDown=56]="networkDown";H[H.defaultToViewDueToCogs=
57]="defaultToViewDueToCogs";H[H.refreshLinkedEntityErrorBar=58]="refreshLinkedEntityErrorBar";H[H.promptEnableLinkedEntitiesUntrustedImages=59]="promptEnableLinkedEntitiesUntrustedImages";H[H.canvasHealth=60]="canvasHealth";H[H.novModeDepreciation=61]="novModeDepreciation";H[H.mismatchedFileFormatConverted=62]="mismatchedFileFormatConverted";H[H.optimizeWorkbook=63]="optimizeWorkbook";H[H.novModePostDepreciation=64]="novModePostDepreciation";H[H.officeScriptsRunning=65]="officeScriptsRunning";H[H.powerQueryRefreshDataSourceNotSupported=
66]="powerQueryRefreshDataSourceNotSupported";H[H.readOnlyPivotTable=67]="readOnlyPivotTable";H[H.powerQueryRefreshHostNotSupported=68]="powerQueryRefreshHostNotSupported";H[H.refreshPageAfterEnablingTheExtension=69]="refreshPageAfterEnablingTheExtension";H[H.msFormsDataSyncStatus=70]="msFormsDataSyncStatus";H[H.count=71]="count"})(l||(l={}));Object(n.b)("EwaBusinessBarEntryType",l);var m=a(5),u=a(1057);class t extends Sys.EventArgs{constructor(H,R,Q=null){super();this.RGa=H;this.m7c=R;this.data=
Q}}Object(n.a)(t,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var w=a(1059),r=a(1058),v=a(1061),y=a(1060),x=a(1055),B=a(473),z=a(50),A=a(538),I=a(37),F=a(646),U=a(29),X=a(1),T=a(21),G=a(57),D=a(68),J=a(835);a.d(C,"a",function(){return L});class L extends k.a{constructor(H,R){super();this.Ra=new e.a;this.HP=null;this.mIc=[];this.anc=()=>{this.$.pa.rMa?this.removeEntry(13):this.Zf(13,null)};this.yi=(Q,O)=>{for(let V=0,W=L.Icc().length;V<W;V++)Q=L.Icc()[V],this.removeEntry(Q);O.context&&
0<O.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),this.removeEntry(21));this.yej()};this.co=(Q,O)=>{var V;Q=this.KAh(O.errors);let W=[];for(let ta=0,K=Q.length;ta<K;++ta){const na=Q[ta];if(1===na.Type&&na.Appearance&32)W=this.v4h(na,W);else if(O.aoj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var da=(null===(V=O.context)||void 0===V?0:V.stopwatch)?O.context.stopwatch.yc:-1;5E3>da?c.ULS.sendTraceTag(537170208,0,50,`OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = ${da}ms).`):b.AFrameworkApplication.qni()||this.REg(na,O.context.methodName)}da=[...L.Icc()];for(let P=0,ka=W.length;P<ka;++P){const pa=W[P];this.Zf(pa,na);Array.remove(da,pa)}for(let P=0,ka=da.length;P<ka;++P)this.removeEntry(da[P])}};this.Wc=(Q,
O)=>{this.Ec(Q,O)};this.Ec=()=>{const Q=this.$.ea;Q.fc||Q.fg()||(this.vJd(),this.mIc.length=0)};this.dd=(Q,O)=>{this.$.ea.fg()&&!O.qV||this.raf(O.qV)};this.RFb=()=>{const Q=this.$.userOperationManager.ucc();Q&&Q.operation.flags&1&&this.Q4f()};this.Azf=()=>{this.Q4f()};this.Vf=()=>{this.$ye();this.Z4f()};this.IN=()=>{if(this.$.h5&&this.$.ea.fg()&&this.$.ea.fc)if(this.$.ea.isEditMode)this.removeEntry(45),this.removeEntry(12),this.removeEntry(29),this.removeEntry(30),this.removeEntry(31),this.removeEntry(32),
this.removeEntry(34),this.removeEntry(22),this.removeEntry(57);else{const Q=this.$.da.za(331);Q&&Q.BJa||this.removeEntry(55);this.removeEntry(5)}};this.$=H;this.FZa=R;this.jNg();b.AFrameworkApplication.yd&&b.AFrameworkApplication.yd.TUc(this);this.MYa=Array(71);for(let Q=0;71>Q;Q++)this.MYa[Q]=null;this.Oh=F.EcmaDateClock.instance;this.Akf=this.Oh.zb.getTime();R&&(R=H.pa,R.ux(this.co),R.pr(this.yi),R.qnb(this.anc),R.aZa(this.anc),H.ea.rk(this.Wc),H.ea.Vu(this.Vf),H.kl(this.dd),H.sk(this.Ec),H.ea.aY(this.IN),
H.userOperationManager.nr(this.RFb),X.EwaSettings.ma(169)&&H.ea.Wg.get(45)&&b.AFrameworkApplication.fa.qa("SupportsPolicies")||this.b7e(),this.raf(G.c(H)));H.da.Ga(5,this)}b7e(){U.a.Dq(this.$.ea.VF)&&this.co(this,new B.a(this.$.ea.VF,null,!1,-1,-1,-1,-1,"",-1,"",-1))}tFg(H){this.Ra.addHandler("bBarAttachedOrDetached",H)}get s8c(){return this.mIc}get domElement(){return this.HP?this.HP.domElement:null}dispose(){if(this.$){const H=this.$,R=H.pa;R.yy(this.co);R.Fs(this.yi);R.atc(this.anc);R.PIb(this.anc);
H.ea.Pk(this.Wc);H.ea.Sw(this.Vf);H.Hl(this.dd);H.Gl(this.Ec);H.ea.b0(this.IN);H.userOperationManager.ho(this.RFb);T.g(H).Xb.Ak(this.Azf)}d.a.Ia(this.HP);this.$=this.HP=null;super.dispose()}zfi(H){switch(H){case 4:case 5:case 11:case 55:case 7:case 37:case 38:return!0;case 59:return X.EwaSettings.ma(648);default:return!1}}Zf(H,R,Q=null,O=null,V=null){if(!this.$.isMobileMode||this.zfi(H))this.FZa&&!this.OE(H)&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,
0,50,`Adding entry to BB: ${Enum.toString(l,H)}`),this.MYa[H]=this.Oh.Iea,this.HP.qC(H,R,O,V),this.Ra.raiseEvent("bBarAttachedOrDetached",new t(H,!0,Q))),R&&32===R.Appearance&&D.a(this.$).kd.fca(R)}lAj(H,R,Q,O){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");x.a.initialize(H,R,Q,O);this.Zf(39,null)}mzj(H,R,Q,O){u.a.initialize(H,R,Q,O);this.Zf(40,null)}vBj(H,R,Q,O){r.a.initialize(H,R,Q,O);this.Zf(41,null)}LAj(H,R,Q,O){w.a.initialize(H,R,Q,O);this.Zf(42,null)}EBj(H,R,
Q,O){y.a.initialize(H,R,Q,O);this.Zf(53,null)}DBj(H,R,Q,O){v.a.initialize(H,R,Q,O);this.Zf(54,null)}removeEntry(H){this.FZa&&(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,`Removing entry from BB: ${Enum.toString(l,H)}`),this.MYa[H]=null,this.HP.removeEntry(H)&&this.Ra.raiseEvent("bBarAttachedOrDetached",new t(H,!1)))}Aka(H){return this.FZa?this.HP.Aka(H):!1}OE(H){return this.FZa?this.HP.OE(H):!1}NDb(){c.ULS.sendTraceTag(537170248,0,
50,"Network disconnect notification received from the app")}cmc(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)}jNg(){const {BusinessBarControl:H}=a(1146);if(this.FZa&&!this.HP){T.g(this.$).Xb.Vk(this.Azf);var R=document.getElementById(this.$.Cb+m.a.hwe);this.HP=new H(this.$,R)}}vJd(){this.FZa&&this.HP.vJd()}yej(){if(X.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){const R=
this.Oh.Iea;if(3E5<=R-this.Akf){this.Akf=R;for(let Q=0;71>Q;Q++){var H=this.MYa[Q];if(H&&(H=R-H,3E5<=H)){const O=Enum.toString(l,Q);c.ULS.sendTraceTag(537170241,0,50,`${"OnWebMethodSuccess"}: entry [${O}] was activated but not turned off for ${H} Millis`)}}}}}KAh(H){const R=[];for(const Q of H)switch(Q.MessageId){case -113742550:const O=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941];(this.$.ea.isNamedObjectViewMode||U.a.lh(H,O))&&R.push(-113742550)}return U.a.bG(H,
R)}v4h(H,R){switch(H.MessageId){case 2113407564:const Q=U.a.I_a([1821390342,-943219229,-502303485,1437034227]);for(let O=0;O<Q.length;O++)Q[O].HelpTopicId=H.HelpTopicId,Q[O].HelpDescription=H.HelpDescription,this.mIc.push(Q[O])}switch(H.MessageId){case -395951567:this.Zf(6,H);break;case 1643490758:this.Zf(4,H);break;case -907264831:this.Zf(5,H);break;case 757111532:case 2113407564:this.Zf(7,H);break;case 2010656511:this.Zf(15,H);break;case 1321660996:this.$.O5c=!0;this.Zf(8,H);break;case 526339737:this.$.O5c=
!0;this.Zf(9,H);break;case -407088521:this.Zf(10,H);break;case 1756116017:this.Zf(14,H);break;case -1703455218:this.Zf(17,H);break;case 1393475740:this.Zf(25,H);break;case -949523941:this.Zf(26,H);break;case 1779381952:this.Zf(44,H);break;case 1421575100:this.Zf(45,H);break;case 613676060:this.Zf(46,H);break;case 1233668252:this.Zf(62,H);break;case 1911608588:H=!!(this.$.Cd&64);!this.$.ea.fg()&&H&&R.push(29);break;case 1544494907:break;case -655555355:R.push(this.Urd()?1:0);break;case -1221382671:R.push(2);
break;case 1662282929:R.push(3);break;case 104919273:this.$.ea.fg()||R.push(30);break;case -689453604:H=!!(this.$.Cd&64);this.$.ea.p8e=!0;!this.$.ea.fg()&&H&&R.push(31);break;case 157762400:this.$.ea.dhc=!0;!this.$.ea.fg()&&this.$.Cd&64&&!this.$.isEditMode&&R.push(32);break;case -1125398042:X.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CleanLoadBlockingFloatingObjects",!1)&&!this.$.ea.fg()&&this.$.Cd&64&&!this.$.isEditMode&&R.push(34);break;case -73730134:!this.$.ea.fg()&&this.$.Cd&
64&&R.push(33);break;case -293349236:R.push(66);break;case 1580811823:R.push(68);break;case -37299333:break;case 136737622:R.push(47);break;case -1780327030:this.Zf(55,H);break;case -113742550:this.Zf(57,H);break;case -260312420:this.$.ea.fg()||R.push(67);break;default:this.Zf(11,H)}return R}E$h(){if(b.AFrameworkApplication.fa.qa("WildFireExcelBizBar")&&!J.a.Fpd(J.a.Cdd(1))&&(f.a.xp||f.a.Xg)){const H=z.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);I.TaskExtensions.Aa(H,()=>{this.Zf(20,null)},
this.la,3)}}Z9h(H){!H&&A.a(this.$)&&this.Zf(61,null)}$9h(H){!H&&A.b(this.$)&&this.Zf(64,null)}raf(H){(!H&&!this.$.printingEnabled||this.$.pe.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.Zf(16,null));this.E$h();this.$ye();this.Z4f();this.Z9h(H);this.$9h(H)}$ye(){this.$.workbookContext.Options&32768&&this.aAj()}aAj(){this.MYa[37]||this.Zf(37,null)}dCj(){this.MYa[38]||
this.Zf(38,null)}Z4f(){X.EwaSettings.ma(648)&&this.$.workbookContext.Options&524288&&this.Zf(59,null)}v5f(H,R){this.Zf(58,H,null,R)}ZUc(H,R=null){this.HP.OE(H)?this.HP.jPb(H,R):this.Zf(H,null,null,null,R)}Q4f(){this.$.Cd&8&&this.Zf(12,null)}Urd(){const H=this.$.da.za(38);return H?H.tokenExpired:!1}REg(H,R){if(!this.OE(21)&&-1387426400!==H.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");const Q={};Q.FailedMethod=R;this.Zf(21,H,
Q)}}static Icc(){return L.vqe||(L.vqe=[0,1,2,3])}Gdd(H){return this.HP.Gdd(H)}}L.vqe=null;Object(n.a)(L,"BusinessBarManager",k.a,[530,10,72])},1269:function(n,C,a){n=a(0);var c=a(222),b=a(1257);class d extends c.a{constructor(k){super();this.$=k;this.Eb()}create(){this.pb(this.$.da.za(5)||new b.a(this.$,!this.$.gba))}static ka(k){k.da.Ga(4,new d(k))}}Object(n.a)(d,"BusinessBarManagerFactory",c.a,[]);var f=a(9);a.d(C,"a",function(){return e});const e=()=>{f.a.Fa(d.ka)}},1280:function(n,C,a){n=a(0);
var c=a(15),b=a(84),d=a(850),f=a(835),e=a(1202);class k{constructor(){this.nFc=new e.a;this.lFc=new e.a;this.kFc=new e.a;this.bRg(this.nFc);this.aRg(this.lFc);this.$Qg(this.kFc);this.rKc=new e.a;this.qKc=new e.a;this.pKc=new e.a;this.yTg(this.rKc);this.xTg(this.qKc);this.wTg(this.pKc);this.DGc=new e.a;this.uRg(this.DGc);this.QFa(this.DGc);this.QFa(this.kFc);this.QFa(this.lFc);this.QFa(this.nFc);this.QFa(this.qKc);this.QFa(this.rKc);this.QFa(this.pKc)}LYh(w,r){switch(w){case 1:return this.c1h(r);case 2:return this.LIh(r)}return f.a.dyc?
this.DGc:null}bRg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)}aRg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)}$Qg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)}yTg(w){w.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);
w.add("OverlayBig","Get the Word app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover Word");w.add("OverlaySmallSplit2","designed for the iPad.");w.add("SkipButton","Skip for now")}uRg(w){w.add("Headline","Get the Office Online extension for Chrome");w.add("UseAppButton","Get the extension");w.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")}xTg(w){w.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);
w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);w.add("OverlayBig","Get the PowerPoint app");w.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");w.add("OverlaySmallSplit1","Discover PowerPoint");w.add("OverlaySmallSplit2",
"designed for the iPad.");w.add("SkipButton","Skip for now")}wTg(w){w.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);w.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);w.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);w.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);w.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)}QFa(w){w.add("Corporation","Microsoft Corporation")}c1h(w){switch(w){case 3:return this.rKc;
case 2:return this.qKc;case 1:return this.pKc}return null}LIh(w){switch(w){case 3:return this.nFc;case 2:return this.lFc;case 1:return this.kFc}return null}static get instance(){k.Ma||(k.Ma=new k);return k.Ma}}k.Ma=null;Object(n.a)(k,"WildFireStringFactory",null,[]);var l=a(4),m=a(39),u=a(27);a.d(C,"a",function(){return t});class t{constructor(w,r,v,y,x=null,B=null){this.FOc=null;this._id=w;this.nPc=r;this.Xqg=x;this.jjb=y;this.vlb=B;this.opa=null;this.uYa=v;this.Tlb=k.instance.LYh(r,w)}N3c(){this.opa=
new d.a(this.title,this.message,null);this.opa.addButton(this.qwe,Object(b.a)(this,this.bwf,"onButtonOneClick"),"");this.uYa&&this.opa.$Dg(this.swe,Object(b.a)(this,this.ewf,"onButtonTwoClick"));this.opa.w$=Object(b.a)(this,this.uJe,"dismissBar");this.opa.image=3;this.opa.id=16;this.opa.closeable=!0}get title(){return this.Tlb.na("Headline")}get message(){return this.Tlb.na("CallToAction")}get MUj(){return this.uYa}get qwe(){return this.uYa?this.Tlb.na("InstallButton"):this.Tlb.na("UseAppButton")}get swe(){return this.uYa?
this.Tlb.na("OpenAppButton"):""}bwf(){this.uYa?this.Fci():this.DUj()}ewf(){this.uYa&&this.PUi()}get BTg(){return this.opa}get openUrl(){this.FOc||(this.FOc=this.Xqg());return this.FOc}Fci(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.jjb&&this.vlb&&this.vlb();f.a.MOf(this._id,this.nPc)}PUi(){this.openUrl&&(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.jjb&&this.vlb&&this.vlb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(f.a.Bre(this._id),
this.openUrl,0,!1))}DUj(){f.a.dyc?this.FTg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),f.a.LQd("BizBarClicked"),1!==this.nPc&&2!==this.nPc||f.a.VZg(this.openUrl,this.jjb,this._id,this.vlb))}FTg(){this.jjb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");m.a.LU(l.AFrameworkApplication.fa.appSettings.WildFireChromeExtensionUrl.toString())}Wgh(){this.jjb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):
c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");f.a.LQd(f.a.wze)}uJe(){f.a.dyc?this.Wgh():(f.a.LQd(f.a.Cdd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))}static d5b(){const w=l.AFrameworkApplication.ta.Oa,r=new t(w.Dj,f.a.Gcc(),8<u.a.J5a,1===w.a6,()=>w.Dx,w.KWf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return r}}Object(n.a)(t,"WildFireBusinessBar",null,[])},1281:function(n,C,a){n=a(0);var c=a(15),b=a(84),d=a(134),f=a(4),e=a(13),k=a(94),
l=a(44),m=a(180),u=a(1074),t=a(88),w=a(56),r=a(80),v=a(939);class y extends d.StandardDialog{constructor(B,z,A,I=null){super();this.mP=this.jm=this.cqa=null;this.fn=[];this.yVb=z;this.iP=B;this.qrg=A;this.IWb=I;this.Slb=new v.a("LoadResource","LoadPrintablePdf")}fQ(){this.Rb=5;this.width=40;const B=document.createElement("span");B.id=this.ni("DirectPrintHeaderContent");const z=document.createElement("span");z.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(z,"DirectPrintHeader");
this.mP=document.createElement("iframe");this.mP.name="pdfObjectFrame";this.mP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.mP.onload=Object(b.a)(this,this.T0i,"printablePdfLoaded");if(this.IWb&&0<this.IWb.count){var A=r.a.pgd(this.yVb,this.IWb);const I=r.a.SJd(this.yVb,this.IWb);this.jm=document.createElement("form");this.jm.id="printPreviewPostForm";this.jm.method="POST";this.jm.target=this.mP.name;this.jm.action=I;for(let F of A)A=document.createElement("input"),A.type="hidden",A.name=
F.key,A.value=F.value,this.jm.appendChild(A)}else this.mP.setAttribute("src",this.yVb);Sys.UI.DomElement.addCssClass(this.mP,m.a.zde);this.qrg?(Sys.UI.DomElement.addCssClass(this.mP,"DirectPrintPdfObjectHidden"),z.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,t.a.wh(this.mP,t.a.sC,t.a.tk)):(Sys.UI.DomElement.addCssClass(this.mP,"DirectPrintPdfObject"),this.fn.push(this.mP));B.appendChild(z);B.appendChild(document.createElement("br"));B.appendChild(this.mP);this.jm&&B.appendChild(this.jm);
B.appendChild(document.createElement("br"));B.appendChild(this.G2g(this.jm?"#":this.yVb));this.Slb.start();this.nDb(CommonUIStrings.l_AppTitle,null,null,null,null,B);this.DW(this.ni("DirectPrintHeaderContent"));this.jm&&this.jm.submit();this.H7g();c.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")}G2g(B){const z=document.createElement("span");var A=document.createElement("span");A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;z.appendChild(A);f.AFrameworkApplication.fa&&
(2===f.AFrameworkApplication.ta.Oa.Dj&&f.AFrameworkApplication.fa.qa("PPTDisableDirectPrintDialogDownloadPDFLink")||1===f.AFrameworkApplication.ta.Oa.Dj&&f.AFrameworkApplication.fa.qa("XLODisableDirectPrintDialogOpenPDFLink"))?(B=document.createElement("span"),2===f.AFrameworkApplication.ta.Oa.Dj?B.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===f.AFrameworkApplication.ta.Oa.Dj&&(B.innerText=CommonUIStrings.l_InternalError_Directive,c.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.cqa=B,z.appendChild(document.createElement("br")),z.appendChild(B)):(A=document.createElement("a"),A.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,A.href=B,A.target="_blank",A.id="PrintPDFLink",A.className="AllowBrowserClick",this.cqa=A,z.appendChild(document.createElement("br")),z.appendChild(A),this.jm&&l.a.addHandler(A,"click",Object(b.a)(this,this.$oc,"onSubmit")),this.iP.ra(e.a.click,this.cqa,Object(b.a)(this,this.zKe,"downloadPDFLinkClicked"),null));this.fn.push(this.cqa);
return z}$oc(B){this.jm&&(this.jm.target="_blank",this.jm.submit());B.preventDefault()}H7g(){if(0<this.fn.length){const B=new u.a(this.fn),z=k.FocusManager.instance().wQ();z&&(this.cqa.focus(),z.jf=B,z.h_=!0)}}zKe(){c.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1}Nud(){c.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}T0i(){c.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Slb&&this.Slb.stop()}dispose(){this.cqa&&
(this.iP.Ba(e.a.click,this.cqa,Object(b.a)(this,this.zKe,"downloadPDFLinkClicked")),this.cqa=null);w.a.a0(this.mP);this.mP=null;super.dispose()}}Object(n.a)(y,"DirectPrintDialog",d.StandardDialog,[275]);a.d(C,"a",function(){return x});class x{constructor(B){this.iP=B}yNh(B,z){return new y(this.iP,B,z,null)}}Object(n.a)(x,"DirectPrintDialogFactory",null,[233])},1282:function(n,C,a){n=a(0);var c=a(15),b=a(553),d=a(84),f=a(1333),e=a(1075);class k{constructor(r,v){this.W8f=r;this.FTa=v}}Object(n.a)(k,
"DirectPrintProbeResults",null,[]);var l=a(4),m=a(263),u=a(27),t=a(111);a.d(C,"a",function(){return w});class w{constructor(r,v,y,x,B,z,A,I,F,U){this.$Xb=null;this.opg=r;this.mkb=v;this.gOc=y;this.tsg=x;this.Zsg=B;this.xPc=new b.a(Object(d.a)(this,this.tVh,"getProbeResults"));this.RVa=z;this.vbe=F;this.dyg=A;this.$sg=I;this.gtg=U}get VC(){return this.opg}start(){}V2i(){const r=Array(this.VC.ETa.length);if(void 0!==this.mkb&&null!==this.mkb)for(let v=0;v<this.VC.ETa.length;v++)r[v]=this.VC.ETa[v]in
this.mkb&&this.tsg(this.mkb[this.VC.ETa[v]]);return r}W2i(){const r=Array(this.VC.FTa.length),v=!(void 0===this.gOc||null===this.gOc);for(let y=0;y<this.VC.FTa.length;y++){const x=this.VC.FTa[y];r[y]=v&&x in this.gOc?!0:this.Zsg(x)}return r}bZh(){const r=this.V2i(),v=Array(r.length);for(let y=0;y<r.length;y++)v[y]=r[y]?this.$yh(this.mkb[this.VC.ETa[y]]):null;return v}$yh(r){if(void 0===r||null===r)return null;r=r.enabledPlugin;return void 0===r||null===r?null:r.name}tVh(){var r=this.bZh();const v=
this.W2i(),y={},x={};for(let B=0;B<this.VC.ETa.length;B++)y[this.VC.ETa[B]]=r[B];for(r=0;r<this.VC.FTa.length;r++)x[this.VC.FTa[r]]=v[r];return new k(y,x)}Tyj(){return this.gtg||!this.VC.isEnabled||l.AFrameworkApplication.isUnifiedHostMode?!1:this.TGj()}fyc(){if(null!=this.$Xb)return this.$Xb;const r=w.hef(this.VC);return this.$Xb=this.VC.ief&&r||this.Yfi()}Yfi(){return u.a.yp&&this.VC.$fi&&u.a.yze>=this.VC.FYg?!0:!1}TGj(){if(!this.$sg(this.VC))return!1;var r=t.a.Zhd(this.xPc.value.W8f);for(const v of r)if(void 0!==
v&&null!==v)return!0;r=t.a.Zhd(this.xPc.value.FTa);for(const v of r)if(v)return!0;return!1}w5h(){const r=t.a.Zhd(this.xPc.value.W8f);for(const v of r)if(m.a.contains(this.VC.L8h,v))return!0;return!1}r5f(r){l.AFrameworkApplication.ta&&l.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")?this.vbe(r,null):this.Tyj()?this.ohh(r,this.w5h()&&!0):this.vbe(r,null)}ohh(r,v){const y=this.dyg.Bc("UserAction","OpenDirectPrintDialog");this.RVa.yNh(r,v).fQ();y.stop()}static Dif(r){try{return new ActiveXObject(r),
!0}catch(v){c.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",r)}return!1}static kef(r){return void 0===r||null===r?!1:!(void 0===r.enabledPlugin||null===r.enabledPlugin)}static create(r){const v=new e.a(l.AFrameworkApplication.fa.appSettings);let y=null;try{y=window.navigator.mimeTypes}catch(U){c.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let x=null;try{x=window.navigator.plugins}catch(U){c.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const B=
w.kef,z=w.Dif;r=r.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const A=l.AFrameworkApplication.ta.ZD,I=w.Eif,F=!!l.AFrameworkApplication.ta&&l.AFrameworkApplication.ta.Oa.vv&&!l.AFrameworkApplication.fa.qa("PrintDialogFallbackLinkEnabled");return new w(v,y,x,B,z,r,A,I,(U,X)=>new f.a(U,!1,X,!0,F),l.AFrameworkApplication.yka)}static Eif(r){return u.a.yp||u.a.pu&&r.lji||r.ief&&w.hef(r)?!0:!1}static hef(r){var v=u.a.dtb;if(v){var y=v.split(".");if(2===y.length)return v=parseInt(y[0]),y=
parseInt(y[1]),v>r.Axd||v===r.Axd&&y>=r.Qrf}return!1}}Object(n.a)(w,"DirectPrintManager",null,[232])},1328:function(n,C,a){a.d(C,"a",function(){return m});n=a(0);var c=a(84);C=a(134);var b=a(1063),d=a(260),f=a(4),e=a(13),k=a(80),l=a(27);class m extends C.StandardDialog{constructor(u,t=!0,w=!1,r=null,v=null,y=!1){super();this.nWa=this.mWa=this.jm=this.DX=null;var x=this.mXd?this.mXd:CommonUIStrings.l_DefaultDialogTitle;m.B5a=y;this.CSb=r||new b.a(u,!0);this.CSb.Jte(this);const B=[],z=[];m.Gu&&(this.kWc&&
this.kWc.forEach(F=>{Array.add(B,F)}),this.Spe&&this.Spe.forEach(F=>{Array.add(z,F)}));t?w?(this.Rb=4,this.rc(1,this.buttonText),this.rc(2,CommonUIStrings.l_DialogClose)):(this.Rb=6,this.rc(0,CommonUIStrings.l_DialogClose)):this.Rb=5;y=document.createElement("span");this.e5c&&(y.className=this.e5c);r=document.createElement("a");r.innerText=this.$jc;r.href=u;r.target="_blank";r.id=this.Zjc;r.className=d.AFrame.yqe;var A=!l.a.xz&&!!v&&0<v.count;if(A){const F=k.a.pgd(u,v);v=k.a.SJd(u,v);r.href="#";r.target=
"_self";this.jm=document.createElement("form");this.jm.id="printPreviewPostForm1";this.jm.method="post";this.jm.target="_blank";this.jm.action=v;for(var I of F)v=document.createElement("input"),v.type="hidden",v.name=I.key,v.value=I.value,this.jm.appendChild(v)}else this.jm=null;this.jm||m.B5a?m.B5a||Array.add(z,{["type"]:"AppLinkProps",["id"]:this.Zjc,["text"]:this.$jc,["onExecute"]:()=>{this.lNf()}}):Array.add(z,{["type"]:"AppLinkProps",["id"]:this.Zjc,["text"]:this.$jc,["handler"]:{["href"]:A?
"#":u,["target"]:A?"_self":"_blank"}});this.COa&&Array.add(B,this.COa);w?(u=document.createElement("span"),u.innerText=this.COa.replace("{0}",""),y.appendChild(u)):this.Grf?(u=document.createElement("span"),u.id=this.ni("message"),I=document.createElement("span"),v=document.createElement("span"),A=this.COa.split("{0}"),I.innerText=A[0],v.innerText=A[1],u.appendChild(I),u.appendChild(r),u.appendChild(v),y.appendChild(u)):(u=document.createElement("span"),u.innerText=this.COa,y.appendChild(u),y.appendChild(document.createElement("br")),
y.appendChild(document.createElement("br")),y.appendChild(r),m.B5a||Array.add(B,"{0}"));this.jm&&y.appendChild(this.jm);m.Gu&&(this.A8a&&(this.aCb?this.Hme(this.A8a,this.aCb):(Array.add(B,"{0}"),Array.add(z,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.A8a,["onExecute"]:()=>{this.Tjc()}}))),this.Nra(B,z));this.nDb(x,null,this.z$e,null,Object(c.a)(this,this.iw,"dialogHandler"),m.Gu?null:y);this.DW(this.ni("message"));!m.Gu&&this.aCb&&this.A8a&&(x=document.createElement("div"),x.className=
"WACDialogLearnMoreLinkContainer",this.DX=document.createElement("a"),this.DX.innerText=this.A8a,this.DX.href=this.aCb,this.DX.target="_blank",this.DX.id=this.ni("LearnMoreLinkId"),this.DX.className=d.AFrame.yqe,x.appendChild(this.DX),t?this.wb.insertBefore(x,this.wb.lastChild):this.wb.appendChild(x),this.DW(String.format("{0} {1}",this.ni("message"),this.ni("LearnMoreLinkId"))));this.Yhb=r;w?this.EI(this.ZB):this.EI(this.Yhb);this.jnf();f.AFrameworkApplication.ta.QW.ra(e.a.click,this.Yhb,Object(c.a)(this,
this.xKe,"downloadLinkClicked"),null);this.DX&&f.AFrameworkApplication.ta.QW.ra(e.a.click,this.DX,Object(c.a)(this,this.Tjc,"learnMoreLinkClicked"),null);this.ASb=!1}get z$e(){return null}get mXd(){return null}get COa(){return null}get aCb(){return null}get A8a(){return null}get Grf(){return!1}get buttonText(){return CommonUIStrings.l_Open}get e5c(){return null}get kWc(){return null}get Spe(){return null}NXc(){this.jm&&(this.mWa||(this.mWa=Object(c.a)(this,this.OFi,"onActionButtonClicked"),this.Ly.ra(e.a.click,
this.ZB,this.mWa)),this.nWa||(this.nWa=Object(c.a)(this,this.PFi,"onActionButtonKeyUp"),this.Yd.ra(e.a.Ed,this.ZB,this.nWa)));super.NXc()}OFi(u){this.mSe(u);return!0}PFi(u){return this.rkf(u,Object(c.a)(this,this.mSe,"executeDismissActionButtonFromArgs"))}mSe(u){this.jm&&this.jm.submit();this.Iua(u.Db)}Nud(){}xKe(){this.lnf();this.jm?this.jm.submit():this.CSb.s7c();return!0}Tjc(){return!1}dispose(){this.CSb.dispose();this.Yhb&&(f.AFrameworkApplication.ta.QW.Ba(e.a.click,this.Yhb,Object(c.a)(this,
this.xKe,"downloadLinkClicked")),this.Yhb=null);this.DX&&(f.AFrameworkApplication.ta.QW.Ba(e.a.click,this.DX,Object(c.a)(this,this.Tjc,"learnMoreLinkClicked")),this.DX=null);this.Ly&&this.mWa&&(this.Ly.Ba(e.a.click,this.ZB,this.mWa),this.mWa=null);this.Yd&&this.nWa&&(this.Yd.Ba(e.a.Ed,this.ZB,this.nWa),this.nWa=null);super.dispose()}lNf(){this.jm&&(document.body.appendChild(this.jm),this.jm.submit(),document.body.removeChild(this.jm))}iw(u){1===u&&(this.Nud(),this.jm?m.Gu&&this.lNf():this.CSb.s7c());
this.dispose()}static get Gu(){return f.AFrameworkApplication.ta.Oa.vv&&f.AFrameworkApplication.ta.Oa.nhf}static get B5a(){return m.W8d}static set B5a(u){m.W8d=u}}m.W8d=!1;Object(n.a)(m,"ADialogWithLinkToResource",C.StandardDialog,[])},1329:function(n,C,a){a.r(C);a.d(C,"ReactOICErrorDialogWithTrial",function(){return f});n=a(0);var c=a(84);C=a(1065);var b=a(416),d=a(144);class f extends C.a{constructor(e,k,l,m,u,t){super(e,k,l,m,u,t);k={["errorMessage"]:this.lNe,["offerString"]:this.zuf};e=new d.a(!1,
!1,!0);this.R4f?(e.Rb=1,k.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.lwa,["onExecute"]:()=>{b.Redirect.showHelp(this.X8e)}}):(e.Rb=4,e.rc(2,this.t$e));e.rc(1,this.uYb);e.Ce=this.id;k={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:k};e.initializeAndShow(this.Nl,Object(c.a)(this,this.s5i,"reactOICErrorDialogWithTrialHandler"),k)}}Object(n.a)(f,"ReactOICErrorDialogWithTrial",C.a,[])},1330:function(n,C,a){a.r(C);a.d(C,"OICErrorDialogWithTrial",function(){return d});n=
a(0);var c=a(84);C=a(1065);var b=a(134);class d extends C.a{constructor(f,e,k,l,m,u){super(f,e,k,l,m,u);f=document.createElement("span");f.innerText=this.lNe;f.appendChild(document.createElement("br"));f.appendChild(document.createElement("br"));e=document.createElement("span");e.innerText=this.zuf;f.appendChild(e);e=new b.StandardDialog;this.R4f?(e.Rb=1,e.Qme(this.lwa,this.X8e)):(e.Rb=4,e.rc(2,this.t$e));e.rc(1,this.uYb);e.Ce=this.id;e.Dl(this.Nl,null,this.icon,Object(c.a)(this,this.qsi,"legacyOICErrorDialogWithTrialHandler"),
f)}}Object(n.a)(d,"OICErrorDialogWithTrial",C.a,[])},1331:function(n,C,a){a.r(C);a.d(C,"CheckRoamingRightsRequest",function(){return c});n=a(0);a=a(1066);class c extends a.a{constructor(){super()}uwb(){return 2}Daa(){return 1}}Object(n.a)(c,"CheckRoamingRightsRequest",a.a,[])},1332:function(n,C,a){a.r(C);a.d(C,"GetRoamingLauncherRequest",function(){return c});n=a(0);a=a(1066);class c extends a.a{constructor(){super()}uwb(){return 0}Daa(){return 2}}Object(n.a)(c,"GetRoamingLauncherRequest",a.a,[])},
1333:function(n,C,a){a.d(C,"a",function(){return m});n=a(0);var c=a(15),b=a(1328),d=a(1063),f=a(4),e=a(88),k=a(80),l=a(27);class m extends b.a{constructor(u,t,w=null,r=!0,v=!1){super(u,!0,!(m.XBa&&r),new d.a(u,t),w,v);m.XBa=m.XBa&&r;if(m.XBa){t=document.createElement("iframe");r=null;v=this.jgh;t.name="pdfObjectFrame";t.id="pdfObjectIFrame";if(w&&0<w.count){const y=k.a.pgd(u,w);u=k.a.SJd(u,w);r=document.createElement("form");r.id="printPreviewPostForm";r.method="POST";r.target=t.name;r.action=u;for(let x of y)u=
document.createElement("input"),u.type="hidden",u.name=x.key,u.value=x.value,r.appendChild(u)}else t.src=u;v.appendChild(t);r&&(v.appendChild(r),r.submit());Sys.UI.DomElement.addCssClass(t,"DirectPrintPdfObjectHidden");e.a.wh(t,e.a.sC,e.a.tk)}}get z$e(){return"Print_32x32x32"}get mXd(){return m.XBa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get COa(){return m.XBa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get kWc(){const u=[];Array.add(u,CommonUIStrings.l_PrintDialogCanCloseDocument);
if(b.a.B5a){let t=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==f.AFrameworkApplication.ta.Oa.aHe&&(t=f.AFrameworkApplication.ta.Oa.aHe);Array.add(u,t)}return m.XBa?u:null}get $jc(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get Zjc(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get e5c(){return f.AFrameworkApplication.NIe?"UIFontDialogTextLarge":null}jnf(){c.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}lnf(){f.AFrameworkApplication.Ln.pyb(9540);
c.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}Nud(){c.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get XBa(){return!!f.AFrameworkApplication.ta&&f.AFrameworkApplication.ta.Oa.vv&&f.AFrameworkApplication.fa.qa("DirectPrintDialogAsStandardDialogIsEnabled")&&!(l.a.xz||l.a.pu||l.a.Uf||l.a.eNa)&&!f.AFrameworkApplication.isUnifiedHostMode&&f.AFrameworkApplication.fa.qa("ShouldHostDefaultToNativeBrowserPrintExperience")}static set XBa(u){}}Object(n.a)(m,
"PrintDialogWithLinkToPdf",b.a,[])},1350:function(n,C,a){n=a(0);var c=a(84),b=a(41);class d{constructor(){this.classId=0}static AIa(m){try{return b.a(m)}catch(u){}return null}}Object(n.a)(d,"ARoamingAppsResponse",null,[]);class f{constructor(){this.state=this.callback=null;this.Rod=!1}}Object(n.a)(f,"GetRoamingAppsLauncherContext",null,[]);var e=a(4),k=a(107);a.d(C,"a",function(){return l});class l{constructor(m){this.BGc=!1;this.KXa=l.Wec;this.oQc=this.sOc=0;this.platform=null;this.Ewg=m;this.lke=
this.pQc=!1}get roamingAppsAreEnabled(){return this.Ewg}get YUj(){return this.roamingAppsAreEnabled&&this.pQc?this.lke:!1}sYg(){e.AFrameworkApplication.zhc&&this.roamingAppsAreEnabled&&!this.pQc&&!this.BGc&&(this.oQc=1,this.BGc=!0,this.vgj(),this.jSe())}vgj(){this.KXa=l.Wec;this.sOc=0}getRoamingAppsLauncher(m,u,t){this.YUj?(m=new f,m.callback=u,m.state=t,m.Rod=!0,this.oSe(m)):u(!1,"",t)}jSe(){const m=new (a(1331).CheckRoamingRightsRequest);m.RoamingApp=this.oQc;m.BaseDocQuerySignature=e.AFrameworkApplication.qj;
m.execute(Object(c.a)(this,this.uYg,"checkUserRoamingRightsSucceeded"),Object(c.a)(this,this.tYg,"checkUserRoamingRightsFailed"),null)}uYg(m){e.AFrameworkApplication.Qg||((m=d.AIa(m.data.Xd))?this.NQd(m.HasRights):this.NQd(!1))}tYg(){if(!e.AFrameworkApplication.Qg)if(this.sOc>=l.Ozi)this.NQd(!1);else{var m=new k.a(2,1,this.KXa,Object(c.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);e.AFrameworkApplication.Hi.Fg(m);this.sOc++;this.KXa*=l.Rhj;this.KXa>l.arf&&(this.KXa=l.arf)}}NQd(m){this.lke=
m;this.pQc=!0;this.BGc=!1}retryCheckUserRoamingRights(){this.jSe()}oSe(m){const u=new (a(1332).GetRoamingLauncherRequest);u.RoamingApp=this.oQc;u.BaseDocQuerySignature=e.AFrameworkApplication.qj;u.execute(Object(c.a)(this,this.SWh,"getRoamingAppsLauncherSucceeded"),Object(c.a)(this,this.RWh,"getRoamingAppsLauncherFailed"),m)}SWh(m){if(!e.AFrameworkApplication.Qg){var u=d.AIa(m.data.Xd);m=m.data.state;u?(this.platform=u.Platform,m.callback(!0,u.Launcher,m.state)):m.callback(!1,"",m.state)}}RWh(m){if(!e.AFrameworkApplication.Qg){var u=
m.data.state;5===m.data.status&&u.Rod?(u.Rod=!1,this.oSe(u)):u.callback(!1,"",u.state)}}static get instance(){return l.kC||(l.kC=new l(e.AFrameworkApplication.DMg))}}l.Wec=1E3;l.Rhj=5;l.arf=12E5;l.Ozi=5;l.kC=null;Object(n.a)(l,"RoamingAppsManager",null,[])},1425:function(n,C,a){a.r(C);var c=a(1049),b=a(0),d=a(247);class f{get name(){return"Common.App.DialogWithLinkToResource"}Wh(){}init(){}dispose(){}static main(){d.a.instance.Gi(new f)}}Object(b.a)(f,"CommonAppDialogWithLinkToResourcePackage",null,
[3,4]);var e=a(553),k=a(15),l=a(84),m=a(810),u=a(30),t=a(131);class w{static Hlh(xc){return w.bwe("New",xc)}static Ilh(xc){return w.bwe("Open",xc)}static Nve(xc,jd){return w.nha("LoadingMenuSection",w.Mti,xc,w.rpb("lblLoading",jd))}static spb(xc,jd,Nd=null,Ld=null){return w.nha("MessageMenuSection",w.ssf,jd,w.rpb("lblMessage",xc,Nd,Ld))}static nSg(xc){return w.Nve(xc,CommonUIStrings.l_VoicedLoadingText)}static oSg(xc,jd){return w.spb(CommonUIStrings.l_NewCreationLocationMessage,xc.xi,jd.wR,jd.eoa)}static mSg(xc,
jd){return w.spb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,jd.eoa,"\n\n"),xc.xi)}static Pve(xc){return w.spb(CommonUIStrings.l_NewGenericErrorMessage,xc.xi)}static kSg(xc,jd,Nd){return w.nha("menuNewBlank",w.e6h,Nd?xc.xi:null,w.mpb(xc.I8e,xc.J8e,xc.K8e,null,xc.gka,xc.cyb,jd,"blank"))}static jTg(){return w.rpb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static Zve(){return w.rpb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static kTg(xc,jd){return w.nha("menuNewTemplates",
xc,null,jd)}static iSg(xc,jd){return w.nha("menuNewMoreTemplates",w.zVe,null,w.mpb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,xc,jd))}static mRg(xc,jd,Nd){let Ld="";Nd&&jd&&(Ld=w.nha("BrowseMoreMenuSection",w.zVe,null,w.mpb("btnBrowseMore",jd,jd,null,null,null,xc||"1959943459",Nd)));return Ld}static rpb(xc,jd,Nd=null,Ld=null){let Za=Ld;jd&&0<jd.length&&(Za=w.ntf.iqc(jd).trimEnd(),Za=0<=Za.indexOf("{0}")?String.format(Za,Ld):String.format("{0} {1}",
Za,Ld));Nd=Nd&&Ld?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',u.a.nf(Nd),u.a.nf(Ld),u.a.nf(Za)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',u.a.nf(xc||""),w.ntf.iqc(u.a.nf(jd||"")),Nd)}static mpb(xc,jd,Nd,Ld,Za,Pa,Ab,Aa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
u.a.nf(xc||""),u.a.nf(jd||""),u.a.nf(Nd||""),Ld||"32by32",u.a.nf(Za||""),u.a.nf(Pa||""),Ab,u.a.nf(Aa||""))}static bwe(xc,jd){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',xc,jd)}static nha(xc,jd,Nd,Ld){Nd=Nd?String.format('Title="{0}"',u.a.nf(Nd)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
u.a.nf(xc||""),u.a.nf(jd||""),Nd,Ld)}}w.ssf="MenuMru";w.Mti="MenuLoading";w.e6h="MenuHeader";w.zVe="MenuFooter";w.ntf=t.a.Hx("\n","&#10;");Object(b.a)(w,"NewAndOpenXmlUtilities",null,[]);var r=a(4),v=a(98),y=a(159);class x{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(b.a)(x,"HostInformation",null,[]);var B=a(107),z=a(39),A=a(372),I=a(164),F=a(644),U=a(578),X=a(106),T=a(25);class G{constructor(xc,jd,Nd,Ld,Za,Pa){this.qSc=this.Uo=this.tRb=null;this.fXb=this.BRc=
!1;this.rce=0;this.pRc=this.MLc=!1;this.K1=xc;this.uib=jd;this.LDa=new e.a(()=>new m.a(Nd.value,Object(l.a)(this,this.fwb,"getMoreInfoEventReceived")));this.eug=Ld;this.Qqa=Za;this.uxg=Pa;this.Jlb=this.byc;2===this.MK.lca&&(this.pRc=!0)}get vP(){switch(this.MK.lca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}Ig(){const xc=this.MK.z9a;xc.Nb(T.a.newDocument,X.a.frame,Object(l.a)(this,this.newDocument,"newDocument"));xc.Le(T.a.Bqc,X.a.frame,
Object(l.a)(this,this.Bqc,"populateNewMenu"),96)}newDocument(xc,jd,Nd,Ld,Za){return 1===Nd?32:2===Nd&&Za&&Za.MenuItemId&&Za.SourceControlId?this.k1a(Za.MenuItemId,Za.SourceControlId):8}k1a(xc,jd){var Nd=this.fmc.y4c;if(null===Nd)return 8;var Ld=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(r.AFrameworkApplication.Jba&&Ld){k.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Za={};Za[A.a.h$f]=
xc;Za[A.a.vP]=this.vP;Za[A.a.lcid]=r.AFrameworkApplication.lcid.toString();Za[A.a.reason]=F.a.createNew;r.AFrameworkApplication.XU().execute(Pa=>{Pa.Mj(I.a.k1a,Za)})}else Ld=(new Date).getTime(),jd=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Nd,u.a.mf(this.Ela),u.a.mf(xc),u.a.mf(this.vP),u.a.mf(r.AFrameworkApplication.lcid.toString()),u.a.mf(Ld.toString()),u.a.mf(jd),u.a.mf(r.AFrameworkApplication.canary),r.AFrameworkApplication.qj),
(Nd=r.AFrameworkApplication.fa.Xa("ScenarioId"))&&""!==Nd&&(jd+="&wdscenarioid="+u.a.mf(Nd)),jd+="&"+r.AFrameworkApplication.icc(),r.AFrameworkApplication.jxa&&(jd+="&"+r.AFrameworkApplication.xbc()),(Nd=this.Uo?this.Uo.wR:null)&&(jd+="&DestinationUrl="+u.a.mf(Nd)),z.a.Ze(jd,"_blank",void 0,"CreateNewDocument");2===this.MK.lca&&k.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:U.a[this.MK.lca],["Template"]:xc});return 32}Vwi(xc){let jd=Number.MAX_VALUE,Nd=Number.MIN_VALUE;
const Ld=window.performance;if(Ld&&"undefined"!==typeof Ld.getEntriesByName){for(let Pa=0;Pa<xc.length;Pa++){var Za=Ld.getEntriesByName(xc[Pa]);Za&&0<Za.length&&(Za=Za[0],jd=Math.min(parseInt(String(Za.fetchStart)),jd),Nd=Math.max(parseInt(String(Za.responseEnd)),Nd))}Nd>jd&&k.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:Nd-jd,["MinFetchStart"]:jd,["MaxResponseEnd"]:Nd})}}Bqc(xc,jd,Nd,Ld,Za){if(1===Nd)return this.pRc&&(r.AFrameworkApplication.uN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.pRc=!1),32;2!==Nd||this.MLc||(this.rce=(new Date).getTime(),k.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.byc,["CachedNewMenuXmlExists"]:!!this.tRb,["ShouldCallGetMoreInfo"]:this.MK.supportsGetMoreInfoForPersonalStorage}));return this.wZi(Za)}wZi(xc){xc&&(this.tRb?xc.PopulationXML=this.tRb:(this.MK.supportsGetMoreInfoForPersonalStorage&&!this.Uo&&this.xDi.oZ("Opened New menu",!0),xc.PopulationXML=this.IHh(this.getTemplateListJson())));
return 32}shf(){return!this.MK.supportsGetMoreInfoForPersonalStorage||!!this.Uo&&3===this.Uo.state&&!!this.Uo.eoa&&!!this.Uo.wR}Jli(){return r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.TZ?!0:this.shf()}getTemplateListJson(){if(!this.byc||!this.Jli())return null;if(this.Jlb&&!this.fXb){var xc="9";const jd=r.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in jd&&(xc=jd.NumberOfTemplatesInBackstage);let Nd=this.vP;"TemplateCollectionId"in jd&&(Nd=jd.TemplateCollectionId);
xc=String.format(this.MK.AV+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",u.a.mf(r.AFrameworkApplication.lcid.toString()),u.a.mf(Nd),xc);Boolean.parse(jd.AppendOriginQueryParam||"false")&&(xc+="&org=backstage");xc+="&"+r.AFrameworkApplication.icc();r.AFrameworkApplication.jxa&&(xc+="&"+r.AFrameworkApplication.xbc());this.MK.ODb.Jm(xc,1,null,null,!1,2,Ld=>{this.MK.$ba("CreateNewActor.GetTemplateListJson",Ld.data);this.wIj(Ld.data.Xd)},Ld=>{this.MK.$ba("CreateNewActor.GetTemplateListJson",
Ld.data);this.vIj()},null,void 0,void 0,void 0,void 0,"5");this.Jlb=!1}return this.qSc}wIj(xc){this.qSc=xc;this.Jlb=!1;this.cIb();if(r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.TZ&&y.c()){xc=r.AFrameworkApplication.fa.qa("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const jd=r.AFrameworkApplication.Jba;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.qSc,!0,xc&&jd))}}vIj(){this.fXb=this.Jlb=!0;this.cIb();r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.TZ&&
y.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));v.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}IZh(xc){var jd=0;for(var Nd=0;Nd<xc.length;Nd++)if("ST"===xc[Nd].ImageType){jd=Nd;break}const Ld=xc.length?xc[jd]:null;xc=Ld?Ld.Url||"":"";var Za;let Pa=Nd=jd=!1;if(Ld&&(Za=Ld.AspectRatio))Za=parseFloat(Za),1>Za?jd=!0:1.5<Za?Nd=!0:1===Za&&(Pa=!0);else switch(k.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",
{["Url"]:xc}),this.MK.lca){case 3:jd=!0;break;case 2:Nd=!0;break;case 5:Pa=!0}return{returnValue:xc,G8h:jd?"95by123":Nd?"123by69":Pa?"100by100":"123by95"}}IHh(xc){xc=({Fxc:jd}=this.lSg(xc,this.fmc,this.fmc.SGa||"1056925771")).returnValue;if(jd){this.tRb=xc;var jd=(new Date).getTime()-this.rce;k.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:jd})}return xc}fwb(xc,jd){k.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");
this.Uo||3!==xc.state?2===xc.state&&(k.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.BRc=!0,this.cIb()):(this.Uo=xc,jd||this.cIb(),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.TZ&&y.c()&&y.d("setFileMenuHostInformation")&&(xc=Object.assign(new x,{hostUrl:this.Uo.wR,hostName:this.Uo.eoa,folderUrl:r.AFrameworkApplication.breadcrumbFolderUrl,folderName:r.AFrameworkApplication.breadcrumbFolderName}),k.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),
appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(xc))))}lSg(xc,jd,Nd){let Ld;Ld=!1;const Za=this.shf();let Pa="";this.MK.supportsGetMoreInfoForPersonalStorage&&(this.BRc?(Pa=w.Pve(jd),this.BRc=!1,k.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Uo?Za?Pa=w.oSg(jd,this.Uo):this.Uo.Pci?(Ld=!0,this.Jlb=!1,Pa=w.mSg(jd,this.Uo),k.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(Ld=!0,Pa=w.Pve(jd),k.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Uo.wR,["StorageServiceDisplayNameIsSet"]:!!this.Uo.eoa})):(Pa=w.nSg(jd.xi),k.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Za&&(Pa+=w.kSg(jd,Nd,!Pa)+({Fxc:Ld}=this.iTg(xc,Nd)).returnValue);return{returnValue:w.Hlh(Pa),Fxc:Ld}}iTg(xc,jd){let Nd;Nd=!1;if(!this.byc)return Nd=!0,k.ULS.sendTraceTag(5849609,
202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Fxc:Nd};let Ld="",Za="",Pa="MenuTemplate";if(this.fXb)Ld=w.Zve(),this.fXb=!1,k.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(xc){try{const Ab=Sys.Serialization.JavaScriptSerializer.deserialize(xc,!0);Ld=this.hTg(Ab,jd);k.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");r.AFrameworkApplication.otf&&"OneDrive"===this.Ela&&(Za=w.iSg(this.yDi,r.AFrameworkApplication.otf))}catch(Ab){k.ULS.sendTraceTag(5849613,
202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:xc}),Ld=w.Zve()}Nd=!0}else Pa="MenuLoading",Ld=w.jTg(),k.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:w.kTg(Pa,Ld)+Za,Fxc:Nd}}hTg(xc,jd){let Nd="";const Ld=[];for(let Pa=0;Pa<xc.length;Pa++){var Za=xc[Pa];let Ab="";if(Za){const Aa=Za.Title,rb=Za.AssetId;Za=Za.Thumbnails;rb&&Aa&&Za&&({G8h:Za,returnValue:Ab}=this.IZh(Za),Nd+=w.mpb("jbtnNewTemplate"+Pa,Aa,null,
Za,null,Ab,jd,rb))}Ld[Pa]=Ab}xc=new B.a(4,1,5E3,()=>{this.Vwi(Ld)},106);this.MK.dmc.Fg(xc);return Nd}cIb(){this.MLc=!0;this.MK.gtf.ax(this.fmc.Cub);this.MLc=!1}get MK(){return this.K1.value}get fmc(){return this.uib.value}get xDi(){return this.LDa.value}get yDi(){return this.eug.value}get Ela(){return this.Qqa.value}get byc(){return this.uxg.value}}Object(b.a)(G,"CreateNewActor",null,[]);var D=a(1327);class J extends D.a{constructor(){super()}Ene(){this.rT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);
this.rT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.rT(2,CommonUIStrings.l_Open);this.rT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.rT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.rT(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return J.Ma||(J.Ma=new J)}static lVi(xc){return J.instance.ga(xc)}}J.Ma=null;Object(b.a)(J,"MruActorIntlHelper",D.a,[]);var L;(function(xc){xc[xc.success=0]="success";xc[xc.failure=1]="failure";xc[xc.spinner=2]="spinner";xc[xc.none=3]="none"})(L||
(L={}));Object(b.b)("DisplayState",L);var H=a(41);class R{constructor(xc,jd,Nd,Ld,Za,Pa,Ab,Aa){this.jGc=null;this.pTc=!0;this.sRb="";this.azg=0;this.WWa=null;this.GMc=3;this.nb=Aa;this.K1=xc;this.pj=jd;this.hqg=Nd;this.kng=Ld;this.jng=Za;this.LDa=new e.a(()=>new m.a(Pa.value,null));this.Sqg=new e.a(()=>new m.a(Ab.value,Object(l.a)(this,this.fCi,"mruEventResultReceived")));this.nb.qa("WacInTabOpenMRUIsEnabledForUiHost");this.nb.qa("UiHostSupportsDocRebootFeatures")}fCi(xc,jd){this.WWa=xc;jd||this.cPf()}k9i(){this.Iw.z9a.Le(T.a.Aqc,
X.a.frame,Object(l.a)(this,this.Aqc,"populateMruMenu"),96)}Aqc(xc,jd,Nd,Ld,Za){return 1!==Nd&&Za?this.tZi(Za):32}tZi(xc){this.lmh();this.kmh();xc.PopulationXML=w.Ilh(this.sRb+this.jGc);return 32}lmh(){var xc=3;let jd=!1;if(this.sRb&&this.azg===this.WWa.hKj)k.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),xc=this.GMc;else{k.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});
var Nd=this.Iw.mw();this.WWa=this.eCi.oZ("File Open opened",!0);this.sRb&&2!==this.GMc&&3!==this.WWa.state?jd=!0:(xc=this.BXh(this.WWa),r.AFrameworkApplication.ta&&r.AFrameworkApplication.ta.Oa.TZ&&y.c()&&xc&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(xc,!0)),this.sRb=({pDi:xc}=this.JHh(this.WWa)).returnValue);Nd=this.Iw.mw()-Nd;k.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:Nd})}2!==xc&&(Nd={["DisplayState"]:L[xc]},
1!==xc&&(Nd.IsStale=jd),k.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Nd));this.GMc=xc}BXh(xc){let jd;try{jd=H.c(xc.Wxd)}catch(Nd){jd=null,k.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",Nd)}return jd}kmh(){this.pTc?(k.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.jGc=({iXj:this.pTc}=this.oyi()).returnValue):k.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
k.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.pTc,["NotDisplayingLink"]:!this.jGc})}JHh(xc){let jd;1===xc.state||0===xc.state?(k.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),xc=2,jd=w.Nve(this.Nja(2),this.Nja(5))):3===xc.state&&xc.Wxd?(jd=this.jSg(xc.Wxd),xc=0):(k.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),jd=w.spb(this.Nja(1),this.Nja(2)),xc=1);return{returnValue:jd,
pDi:xc}}jSg(xc){let jd;const Nd=this.jDb.SGa||"2155708348";if(xc.length){jd=w.rpb("lblRecentDocuments",this.Nja(3));let Ld=0;for(let Za=0;Za<xc.length;Za++){const Pa=xc[Za];"FileName"in Pa&&"DocumentUrl"in Pa&&"Path"in Pa&&(jd+=w.mpb("MruButton"+Za,Pa.FileName.toString(),Pa.Path.toString(),null,this.jDb.gka,this.jDb.cyb,Nd,Pa.DocumentUrl.toString()),Pa.IsPinned&&Ld++)}jd=w.nha("RecentDocumentsMenuSection",w.ssf,this.Nja(2),jd);k.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",
["TotalDocuments"]:xc.length,["NumPinnedDocuments"]:Ld})}else jd=w.spb(this.Nja(0),this.Nja(2)),k.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return jd}oyi(){let xc;xc=!0;let jd=this.FQg;var Nd=this.EQg;if(jd&&Nd||!this.Iw.supportsGetMoreInfoForPersonalStorage)xc=!1;else{const Ld=this.Ebc.oZ("File Open",!1);3===Ld.state&&(jd=Ld.wR,Nd=Ld.eoa,xc=!1)}Nd=Nd?String.format(this.Nja(4),Nd):null;return{returnValue:w.mRg(this.jDb.SGa,Nd,jd),iXj:xc}}cPf(){this.Iw.gtf.ax(this.jDb.Cub)}get Iw(){return this.K1.value}get Nja(){return this.pj.value}get jDb(){return this.hqg.value}get FQg(){return this.kng.value}get EQg(){return this.jng.value}get Ebc(){return this.LDa.value}get eCi(){return this.Sqg.value}}
Object(b.a)(R,"MruRenderer",null,[]);var Q=a(238),O=a(767);class V{constructor(xc,jd,Nd,Ld,Za,Pa,Ab){this.Uo=null;this.ihe=!1;this.eqa=this.f4d=0;this.lug=xc;this.mXa=jd;this.ZUb=Nd;this.uib=Ld;this.Qqa=Za;this.K1=Pa;this.LDa=new e.a(()=>new m.a(Ab.value,Object(l.a)(this,this.fwb,"getMoreInfoEventReceived")))}k1a(){!this.Uo&&this.Hyd.supportsGetMoreInfoForPersonalStorage?this.Ebc.oZ("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}fwb(xc){if(!this.Uo&&3===xc.state)this.Uo=xc;else if(2===
xc.state){this.ihe?k.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Ebc.oZ("NewDocumentFromStream",!0),this.ihe=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.f4d=(new Date).getTime();var xc=this.dAh.y4c;if(null===xc)this.mXa(null);else{var jd=this.ZUb.menuItemId,Nd=this.ZUb.nG,Ld=this.ZUb.iGj,Za=this.ZUb.iAh;this.eqa="streamBase64"===Ld?Za.length/1024:0;k.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.vP,
this.eqa);var Pa=(new Date).getTime();xc=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",xc,u.a.mf(this.Ela),u.a.mf(jd),u.a.mf(this.vP),u.a.mf(r.AFrameworkApplication.lcid.toString()),u.a.mf(Pa.toString()),u.a.mf(Nd),u.a.mf(r.AFrameworkApplication.canary),r.AFrameworkApplication.qj,u.a.mf(Ld));xc+="&"+r.AFrameworkApplication.icc();r.AFrameworkApplication.jxa&&(xc+="&"+r.AFrameworkApplication.xbc());(jd=this.Uo?this.Uo.wR:null)&&
(xc+="&DestinationUrl="+u.a.mf(jd));this.Hyd.ODb.Jm(xc,2,Za,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(l.a)(this,this.sDi,"newDocumentFromStreamSuccessHandler"),Object(l.a)(this,this.rDi,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}sDi(xc){if(xc&&xc.data&&xc.data.Xd)if(({fu:jd}=H.d(xc.data.Xd)).returnValue)if(xc=jd,xc.StatusCode!==Q.a.VO&&xc.StatusCode!==Q.a.Prb)k.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",
this.vP,this.eqa,xc.StatusCode),this.mXa(null);else if(xc.NewDocumentUrl&&""!==xc.NewDocumentUrl){var jd=(new Date).getTime()-this.f4d;k.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.vP,this.eqa,jd);this.lug(xc.NewDocumentUrl)}else k.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.vP,this.eqa),this.mXa(null);else k.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",
this.vP,this.eqa,{["ResponseData"]:O.a.kfb(xc.data.Xd)}),this.mXa(null);else k.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.vP,this.eqa),this.mXa(null)}rDi(xc){xc&&xc.data&&k.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.vP,this.eqa,xc.data.status);this.mXa(null)}get vP(){switch(this.Hyd.lca){case 3:return"WordWAC";case 1:return"ExcelWAC";
case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get dAh(){return this.uib.value}get Ela(){return this.Qqa.value}get Hyd(){return this.K1.value}get Ebc(){return this.LDa.value}}Object(b.a)(V,"NewDocumentFromStreamOperation",null,[]);class W{constructor(xc,jd,Nd,Ld){this.uib=xc;this.Qqa=jd;this.K1=Nd;this.Rqg=Ld}create(xc,jd,Nd){return new V(xc,jd,Nd,this.uib,this.Qqa,this.K1,this.Rqg)}}Object(b.a)(W,"NewDocumentFromStreamOperationFactory",null,[783]);var da=a(83),ta=a(518),K=a(55);
class na{get name(){return"Common.App.NewAndOpen.UX"}Wh(xc){xc.register(W,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").wc().Fc(()=>new W(new e.a(()=>r.AFrameworkApplication.ta.Oa.Ned()),new e.a(()=>r.AFrameworkApplication.Ela),new e.a(()=>xc.yh("Common.INewAndOpenCommonHelpers")),new e.a(()=>xc.yh("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){r.AFrameworkApplication.fa.qv(()=>{this.uyb()})}uyb(){const xc=
ta.a.er(da.a.instance.Ub("Common.INewAndOpenCommonHelpers")),jd=ta.a.er(da.a.instance.Ub("Common.IEventEmitter<Common.IGetMoreInfoResult>"));r.AFrameworkApplication.Ela&&K.Task.WAA.call(null,xc,jd).continueWith(()=>{const Nd=new G(new e.a(()=>xc.result),new e.a(()=>r.AFrameworkApplication.ta.Oa.Ned()),new e.a(()=>jd.result),new e.a(()=>r.AFrameworkApplication.ta.Oa.Oed().SGa||"1959943459"),new e.a(()=>r.AFrameworkApplication.Ela),new e.a(()=>r.AFrameworkApplication.nki));Nd.Ig();Nd.cIb()});if(r.AFrameworkApplication.GNf){const Nd=
ta.a.er(da.a.instance.Ub("Common.IEventEmitter<Common.IMruResult>"));K.Task.WAA.call(null,xc,jd,Nd).continueWith(()=>{const Ld=new R(new e.a(()=>xc.result),new e.a(()=>J.lVi),new e.a(()=>r.AFrameworkApplication.ta.Oa.Oed()),new e.a(()=>r.AFrameworkApplication.kVi),new e.a(()=>r.AFrameworkApplication.jVi),new e.a(()=>jd.result),new e.a(()=>Nd.result),r.AFrameworkApplication.fa);Ld.k9i();Ld.cPf()})}}dispose(){}}Object(b.a)(na,"UXPackageManager",null,[3,4,10]);var P=a(1172),ka=a(1180),pa=a(1153),Na=
a(1190),Z=a(1181),Ra;(function(xc){xc[xc.myFiles=0]="myFiles";xc[xc.recent=1]="recent";xc[xc.currentFolder=2]="currentFolder";xc[xc.yourPhone=3]="yourPhone"})(Ra||(Ra={}));Object(b.b)("SharedFilePickerLandingLocation",Ra);class Da{constructor(xc){this.NLa=this.Qab=null;this._initialized=!1;this.Nkd=xc}A2a(xc){this._initialized||(xc.qo(I.a.iOf),xc.$l(I.a.iOf,Object(l.a)(this,this.vQi,"onReceivedPickerResponse")),this._initialized=!0)}Ped(xc){return this.NLa=new Promise((jd,Nd)=>{const Ld={};Ld[A.a.iYi]=
xc;this.Qab=(Za,Pa)=>{""===Pa?(k.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),jd(Za)):("Canceled"===Pa?k.ULS.sendTraceTag(572548164,306,50,Pa):k.ULS.sendTraceTag(556901065,306,10,Pa),Nd(Pa))};this.Nkd.execute(Za=>{this.A2a(Za);Za.Mj(I.a.pVi,Ld)})})}vQi(xc){this.Qab(xc.Values[A.a.fmj],void 0===xc.Values[A.a.BEd]||null===xc.Values[A.a.BEd]?"":xc.Values[A.a.BEd])}prd(){return r.AFrameworkApplication.fa.qa("UiHostCommonFilePicker")}XEe(xc,jd,Nd,Ld,Za,Pa,Ab){const Aa={};Aa[A.a.Slj]=
xc;Aa[A.a.titleText]=jd;Aa[A.a.tKg]=Nd;Aa[A.a.uKg]=Ld;Aa[A.a.vKg]=!1;Aa[A.a.nhh]=!0;Aa[A.a.pAh]=Za;Aa[A.a.mYi]=Pa;Aa[A.a.lYi]=Ra[Ab];y.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Aa[A.a.nYi]="Dark");return Aa}}Object(b.a)(Da,"SharedFilePickerManager",null,[301]);class Ba{constructor(){this.gb=null}get name(){return"Common.App.SharedFilePicker"}Wh(xc){this.gb=xc;xc.register(Da,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").wc().Fc(()=>
new Da(xc.Ub("Postmessage.IHostPostmessenger")))}init(){r.AFrameworkApplication.fa.qv(()=>{this.uyb()})}uyb(){this.gb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){d.a.instance.Gi(new Ba)}}Object(b.a)(Ba,"SharedFilePickerPackage",null,[3,4]);var ea=a(1280),Y=a(835),ja=a(27);class ca{get name(){return"Common.App.WildFire"}mme(xc){let jd=!1;xc&&(xc.N3c(),xc.BTg&&(jd=!1));return jd}m6g(){var xc=r.AFrameworkApplication.ta.Oa;xc=new ea.a(xc.Dj,Y.a.Gcc(),!1,1===xc.a6);
this.mme(xc)&&k.ULS.sendTraceTag(17571982,306,50,"ChromeExtBannerDisplayed")}d5b(xc,jd,Nd,Ld,Za,Pa){xc=new ea.a(xc,Nd,Ld,jd,Za,Pa);this.mme(xc)&&k.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")}rbh(){const xc=r.AFrameworkApplication.ta.Oa;var jd=r.AFrameworkApplication.fa;const Nd=xc.Dj,Ld=1===xc.a6;if(jd.qa(Y.a.r0h(Nd))){var Za=Y.a.Gcc(),Pa=8<ja.a.J5a;if(2!==Nd||2!==Za||!Ld){jd=jd.qa(Y.a.s0h(Nd));var Ab=xc.KWf(),Aa=()=>xc.Dx;jd&&!Y.a.Fpd(Y.a.Cdd(Nd))&&this.d5b(Nd,Ld,Za,Pa,Aa,Ab)}}}init(){var xc=
r.AFrameworkApplication.fa;const jd=xc.qa("WildFireChromeExtensionEnabled");xc=xc.qa("WildFireChromeExtensionBar")&&jd;Y.a.dyc&&xc&&!Y.a.Fpd(Y.a.wze)?this.m6g():(document.body&&Y.a.qyj&&this.rbh(),r.AFrameworkApplication.vb.Nb(T.a.Rtd,X.a.frame,Object(l.a)(this,this.Rtd,"launchWildFireBusinessBar")))}Rtd(xc,jd,Nd,Ld,Za){if(1===Nd)return 32;if(!Za)return 8;this.d5b(Za.app,Za.mode,Za.platform,Za.useTwoButton,null,null);return 32}dispose(){}Wh(){}static main(){d.a.instance.Gi(new ca)}}Object(b.a)(ca,
"PackageManager",null,[3,4]);var ba=a(1269);a(1062);var ua=a(9),wa=a(694),ia=a(50),xa=a(37),gb=a(183);class va{constructor(xc){this.gi=xc}Lc(){return!1}executeCommand(xc,jd,Nd){return 2!==this.gi.de(T.a.newDocument,2,Nd)?K.Task.Ta(!0):gb.a(jd.command)}Ac(xc,jd){return 1056925771===jd.command}Oc(xc,jd,Nd){xc=!0;switch(jd){case "PopulateNewMenu":this.gi&&this.gi.de(T.a.Bqc,2,Nd);break;default:xc=!1}return xc}}Object(b.a)(va,"CreateNewCommandHandler",null,[164]);class sa extends wa.a{constructor(xc){super(xc)}vd(){const xc=
ia.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),jd=ia.GetServiceTaskFactory.create(this.$.da,165,this.la,this.fb);xa.TaskExtensions.Aa(xa.TaskExtensions.Td([xc,jd],this.la),()=>{this.$c([new va(r.AFrameworkApplication.vb)])},this.la,3)}static ka(xc){wa.a.Od(87,new sa(xc))}}Object(b.a)(sa,"CreateNewCommandHandlerFactory",wa.a,[]);var ab=a(1166),Ua=a(1064),nb=a(1208),Ha=a(510),sb=a(102),Qb=a(171),mb=a(11),Pb=a(22),gc=a(281),Xb=a(993);class Ca{}Ca.create="Create";Ca.activate="Activate";
Ca.close="Close";Ca.remove="Delete";Ca.duplicate="Duplicate";Object(b.a)(Ca,"Actions",null,[]);var ra=a(29),ma=a(42);class hb extends K.Task{constructor(xc){super();this.F1d=null;this.H1d=0;this.iRb=null;this._state=0;this.moveNext=()=>{try{for(this._state=1;1===this._state;)this.nXa=this.nXa()}catch(jd){this.dispose(),this.NAa(jd),this._state=3}};this.Ot=xc;this.nXa=this.gEc;this.moveNext()}gEc(){this.F1d=ra.a.Yc(3,2,0,1669,0,-1244327602,"MsFormDeleteConfirmation");this.iRb=ma.a(this.Ot.$).uj(this.F1d).G();
this.iRb.isCompleted||(this._state=2,this.iRb.Y9a(this.moveNext));return this.Rig}Rig(){this.H1d=this.iRb.oZ();0===this.H1d&&(this.Ot.$.workbookContext.Options=mb.HelperMethods.qO(!1,this.Ot.$.workbookContext.Options,2048),this.Ot.deleteMsFormMetaDataSheet());this._state=3;this.mLb(!0)}dispose(){}}Object(b.a)(hb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",K.Task,[10]);class vb{}vb.action="Action";vb.CCh="FlexPane";vb.D$b="formId";vb.id="id";vb.title="Title";
vb.uQb="XlWorkbookId";vb.xEh="Fragment";vb.host="Host";vb.iLj="TopView";vb.e2="auth_pvr";Object(b.a)(vb,"Parameters",null,[]);var Va=a(61);const db=(xc,jd,Nd,Ld,Za,Pa,Ab=null)=>{Ab=xc.Na(9,Ab);Ab.sheetName=jd;Ab.confirmationChoice=!0;return Va.g(xc,"DeleteSheet",Ab,Nd,Ld,Za,Pa,0)};class oa{constructor(xc){this.zo="Excel";this.$=xc;this.MU=Xb.a.current}get hasMsForm(){return sb.c(this.$.sg)}get Slc(){return this.$.workbookContext.MsFormId}get qQb(){return this.$.workbookContext.MsFormDocUrl}get e2(){return Pb.a.contains(this.$.Xv.DocumentHostInfo.FileSource,
"onedrive",!0)?"MSA":"OrgId"}Lc(xc,jd){switch(jd){case -105284469:return!sb.i(this.$.sg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1}executeCommand(xc,jd){xc=xa.TaskExtensions.ak();jd=jd.command;switch(jd){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:xc=this.deleteMsForm();break;default:xc=gb.a(jd)}return xc}Ac(xc,
jd){if(!this.$.ea.Wg.get(61))return!1;xc=!1;switch(jd.command){case -105284469:xc=sb.i(this.$.sg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:xc=this.hasMsForm}return xc}Oc(){return!1}insertMsForm(){const xc=u.a.Fq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),jd={},Nd={};jd[vb.action]=Ca.create;jd[vb.e2]=this.e2;Nd[vb.action]=Ca.create;Nd[vb.uQb]=encodeURIComponent(this.qQb);Nd[vb.host]=this.zo;Nd[vb.title]=encodeURIComponent(xc);this.bDb(jd,
Nd);this.$.workbookContext.Options=mb.HelperMethods.qO(!1,this.$.workbookContext.Options,2048)}editMsForm(){const xc={},jd={};xc[vb.e2]=this.e2;jd[vb.D$b]=this.Slc;jd[vb.uQb]=encodeURIComponent(this.qQb);jd[vb.host]=this.zo;this.bDb(xc,jd)}previewMsForm(){const xc={},jd={};xc[vb.e2]=this.e2;jd[vb.D$b]=this.Slc;jd[vb.uQb]=encodeURIComponent(this.qQb);jd[vb.host]=this.zo;jd[vb.iLj]="Preview";this.bDb(xc,jd)}sendMsForm(){const xc={},jd={};xc[vb.e2]=this.e2;jd[vb.D$b]=this.Slc;jd[vb.CCh]="SendForm";jd[vb.uQb]=
encodeURIComponent(this.qQb);jd[vb.host]=this.zo;this.bDb(xc,jd)}deleteMsForm(){return new hb(this)}deleteMsFormMetaDataSheet(){this.$.userOperationManager.cs(new Qb.a(158,0,(xc,jd,Nd)=>db(this.$.pa.Ew,this.MU.Iub,gc.b(xc,()=>{this.Beh()}),jd,Nd,null)))}Beh(){const xc={},jd={};xc[vb.action]=Ca.remove;xc[vb.e2]=this.e2;jd[vb.action]=Ca.remove;jd[vb.host]=this.zo;jd[vb.D$b]=encodeURIComponent(this.Slc);jd[vb.uQb]=encodeURIComponent(this.qQb);this.bDb(xc,jd)}bDb(xc,jd){const Nd=this.$.ya.MsFormBaseUrl+
"/Pages/DesignPage.aspx";let Ld="";var Za="";if(jd){for(let Aa in jd){var Pa=Aa,Ab=jd[Aa];Za+=Za.length?"&":"";Za+=Pa+"="+Ab}xc||(xc={});xc[vb.xEh]=encodeURIComponent(Za)}if(xc)for(let Aa in xc)jd=Aa,Za=xc[Aa],Ld+=Ld.length?"&":"?",Ld+=jd+"="+Za;window.open(Nd+Ld,"_blank")}}Object(b.a)(oa,"MsFormCommandHandler",null,[164]);class Oa extends wa.a{constructor(xc){super(xc)}vd(){const xc=ia.GetServiceTaskFactory.create(this.$.da,203,this.la,this.fb);xa.TaskExtensions.Aa(xa.TaskExtensions.Td([xc],this.la),
()=>{this.$c([new oa(this.$)])},this.la,3)}static ka(xc){xc.ea.Wg.get(61)&&wa.a.Od(215,new Oa(xc))}}Object(b.a)(Oa,"MsFormCommandHandlerFactory",wa.a,[]);var Wa=a(222);class Sa extends Wa.a{constructor(xc){super();this.$=xc;this.Eb()}create(){xa.TaskExtensions.Aa(ia.GetServiceTaskFactory.create(this.$.da,164,this.la,this.fb),()=>{this.pb(new na)},this.la,3)}}Object(b.a)(Sa,"NewAndOpenUXFactory",Wa.a,[]);class yb{constructor(xc,jd){this.gi=jd;this.$=xc}executeCommand(xc,jd,Nd){xc=2;switch(jd.command){case T.a.openUrlInNewTab:xc=
this.gi.de(T.a.openUrlInNewTab,2,Nd);break;case T.a.APa:xc=this.gi.de(T.a.APa,2,Nd)}return 2!==xc?K.Task.Ta(!0):gb.a(jd.command)}Ac(xc,jd){return jd.command===T.a.openUrlInNewTab||jd.command===T.a.APa}Oc(xc,jd,Nd){return"PopulateMruMenu"===jd?(this.gi.de(T.a.Aqc,2,Nd),!0):!1}Lc(){return!1}}Object(b.a)(yb,"OpenFromMruCommandHandler",null,[164]);class Ma extends wa.a{constructor(xc){super(xc)}vd(){const xc=ia.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),jd=ia.GetServiceTaskFactory.create(this.$.da,
165,this.la,this.fb);xa.TaskExtensions.Aa(xa.TaskExtensions.Td([xc,jd],this.la),()=>{this.$c([new yb(this.$,r.AFrameworkApplication.vb)])},this.la,3)}static ka(xc){wa.a.Od(88,new Ma(xc))}}Object(b.a)(Ma,"OpenFromMruCommandHandlerFactory",wa.a,[]);var Bb=a(1144),Nb=a(1182),Ia=a(1220),jb=a(1067),Ob=a(1162),Jb=a(1068),Kb=a(1069),Qa=a(1167),ha=a(1209),qa=a(1210),pb=a(82),bb=a(370),eb=a(100),Fa=a(21),tb=a(371);class dc{constructor(xc,jd){this.sheetName=null;this.value=!1;this.sheetName=xc;this.value=jd}getSheetName(){return this.sheetName}Uva(){return this.value}}
Object(b.a)(dc,"MacroRecorderSheetOptionToggledPayload",null,[115]);const jc=(xc,jd,Nd,Ld,Za,Pa,Ab,Aa=null)=>{Aa=xc.Na(9,Aa);Aa.sheetName=jd;Aa.show=Nd;return Va.g(xc,"ShowGridlines",Aa,Ld,Za,Pa,Ab,0)},fb=(xc,jd,Nd,Ld,Za,Pa,Ab,Aa=null)=>{Aa=xc.Na(9,Aa);Aa.sheetName=jd;Aa.show=Nd;return Va.g(xc,"ShowHeadings",Aa,Ld,Za,Pa,Ab,0)},ec=(xc,jd,Nd,Ld,Za,Pa,Ab,Aa=null)=>{Aa=xc.Na(9,Aa);Aa.sheetName=jd;Aa.directionRtl=Nd;return Va.g(xc,"ChangeSheetDirection",Aa,Ld,Za,Pa,Ab,0)};class lb{constructor(xc){this.$=
xc}Lc(){return!1}executeCommand(xc,jd){const Nd={};this.$.gk(Nd);xc=jd.command;const Ld=Object(pb.a)(eb.a,this.$.xa.getItemByName(Nd.SheetName));if(!Ld)return gb.a(xc);let Za,Pa,Ab,Aa,rb;switch(xc){case 705559150:case -1411193626:Za=16;Pa=!Ld.hideGridLines;Ab=jc;rb=183;Aa=Ld.hideGridLines;break;case -2052321504:case 515737500:Za=4;Pa=!Ld.headersVisible;Ab=fb;rb=184;Aa=!Ld.headersVisible;break;case -1478455630:Za=2;Pa=!Ld.displayRtl;Ab=ec;rb=185;Aa=!Ld.displayRtl;Fa.g(this.$).Ea.CQj(Pa);break;default:return gb.a(xc)}Ld.cqb(Za,
Pa);const Lb=()=>new dc(Nd.SheetName,Aa),oc=this.$.pa.va;return bb.a(this.$.userOperationManager,($c,Fd,Cd)=>Ab(oc,Nd.SheetName,Aa,gc.b($c,$d=>{lb.GFb($d,Ld,Za,Pa)}),gc.a(Fd,()=>{lb.REb(Ld,Za,Pa)}),Cd,null),$c=>new Qb.a(rb,0,$c,void 0,Lb),jd)}Ac(xc,jd){xc=!1;switch(jd.command){case -1411193626:case 515737500:case -1478455630:xc=!0;break;case 705559150:case -2052321504:xc=tb.a(this.$)}return xc}Oc(){return!1}static GFb(xc,jd,Nd,Ld){ra.a.Dq(xc.Errors)&&jd.cqb(Nd,!Ld)}static REb(xc,jd,Nd){xc.cqb(jd,
!Nd)}}Object(b.a)(lb,"SheetOptionsToggleCommandHandler",null,[164]);class ac extends wa.a{constructor(xc){super(xc)}vd(){this.$c([new lb(this.$)])}static ka(xc){wa.a.Od(100,new ac(xc))}}Object(b.a)(ac,"SheetOptionsToggleCommandHandlerFactory",wa.a,[]);var Gb=a(173),wb=a(178),qc=a(147),Ya=a(65),xb=a(59),wc=a(208),Oc=a(588),Cb=a(90),Ib=a(1),fc=a(249),vc=a(210),Cc=a(12);class fd extends vc.a{constructor(xc,jd,Nd,Ld=null){super(xc,Nd,2,Ld);this.mKc=null;this.onResize=()=>{const Za=this.LQh();this.PLa.setAttribute("width",
Za.x.toString());this.PLa.setAttribute("height",Za.y.toString());this.oRj(Za);this.BBd()};this.XHe=jd;this.$.LA(this.onResize);this.Tdc()}get PLa(){return this.mKc}initialize(){let xc;const jd=this.$.Cb+"iframeDialog_frame",Nd=this.$.Cb+"iframeDialog";xc=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',jd,this.y_e(Nd));this.Pb.style.margin=mb.HelperMethods.pc(0);this.Pb.style.marginBottom=mb.HelperMethods.pc(-2);this.Pb.innerHTML=xc;this.mKc=document.getElementById(jd);
this.domElement.id=Nd;this.onResize(null,Sys.EventArgs.Empty);super.initialize()}dispose(){this.$&&this.$.LD(this.onResize);super.dispose()}setFocus(){Cc.DOMElementExtensions.setFocus(this.PLa)}onHide(){this.PLa.contentWindow.close();Cc.DOMElementExtensions.sf(this.PLa);this.mKc=null;super.onHide()}oRj(xc){const jd=this.domElement.style;jd.width=mb.HelperMethods.pc(xc.x);jd.marginLeft=mb.HelperMethods.pc(-xc.x/2)}LQh(){const xc=Cc.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*
xc.width),this.XHe.x),Math.min(Math.floor(.9*xc.height),this.XHe.y))}}Object(b.a)(fd,"IFrameDialog",vc.a,[]);var od=a(5),Ub=a(72),Fc=a(14);class $b extends fd{constructor(xc){super(xc,new Sys.UI.Point(960,680),Fc.a.instance.ga(1267));this.name=od.a.RLe}get uc(){return"EmbeddingDialog"}y_e(xc){const jd=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);wc.a.Kg(jd,od.a.uoh,xc);Ub.a(this.$.ya,34)&&wc.a.Kg(jd,od.a.UNe,"1");Ub.a(this.$.ya,35)&&wc.a.Kg(jd,od.a.WNe,"1");Ub.a(this.$.ya,36)&&wc.a.Kg(jd,
od.a.VNe,"1");return jd.toString()}onShow(){k.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");super.onShow()}}Object(b.a)($b,"EmbeddingDialog",fd,[]);var zc=a(1235),Wc=a(86),yc=a(80),pd=a(819);class xd{}xd.v2f="FrameDialog_ShareFromEdit";xd.view="FrameDialog_View";xd.CAe="FrameDialog_CloseAndRefresh";xd.jvj="FrameDialog_ShareFromView";xd.edit="FrameDialog_Edit";xd.w7i="FrameDialog_RefreshGrid";xd.w_g="FrameDialog_CloseMe";xd.MAe="FrameDialog_CloseMeError";xd.ready=
"FrameDialog_Ready";xd.PYi="FrameDialog_PleaseClose";xd.mK="GotoRange";Object(b.a)(xd,"PostMessageConstants",null,[]);var Vb=a(515),Uc=a(283),ud=a(116),Vc=a(282),yd=a(97);class Sd{constructor(){this.mK=null;this.eFd=1461300262}}Object(b.a)(Sd,"SessionUpdateContext",null,[]);class Wd extends fd{constructor(xc,jd,Nd){super(xc,new Sys.UI.Point(Wd.aeh,Wd.Ddh),Fc.a.instance.ga(jd?1272:1271));this.r1a=null;this.CLc=!1;this.hpc=Ld=>{const Za=this.$,Pa=new Sd;Pa.mK=Ld.Values[xd.mK];let Ab=!1;switch(Ld.MessageId){case xd.v2f:this.Zu();
Ab=!0;Pa.eFd=1334518759;break;case xd.view:this.qoa=Fc.a.instance.ga(1272);this.yfg(!0);break;case xd.CAe:this.Zu(),Ab=!0}Ld=(Aa,rb,Lb)=>Uc.l(Za.pa.va,gc.b(Aa,this.LRi),rb,Lb,Pa);Ib.EwaSettings.$b()?(Ld=new Qb.a(140,0,Ld),Ld.flags=Ab?16:80):(Ld=Ab?new Qb.a(140,0,Ld):new Vb.a(140,0,Ld),Ld.flags=16);Za.userOperationManager.Wb(Ld,this.Jd)};this.FJi=()=>{const Ld=this.$;Ld.ya.SurveyRedirectUrl?(this.Zu(),Ld.fd(1305810481,0,8,null)):(this.qoa=Fc.a.instance.ga(1271),this.yfg(!1))};this.ZRi=()=>{const Ld=
this.$;this.Zu();Ld.fd(1334518759,0,8,null)};this.nnc=Ld=>{const Za=this.$;this.Zu();Ld.MessageId===xd.MAe&&Za.ea.hcd()};this.rQi=()=>{this.CLc=!0;this.raiseEvent(Wd.$td)};this.LRi=(Ld,Za)=>{if(!Vc.a(Ld)){Ld=this.$;if(Za.mK){const Pa=Ld.ea.xa;if(Pa.contains(Za.mK.SheetName))this.$nc(Za);else{let Ab=null;Ab=()=>{Pa.Vma(Ab);this.$nc(Za)};Pa.Oga(Ab)}}1461300262!==Za.eFd&&Ld.fd(Za.eFd,0,8,null)}};this.Y$d=jd;this.Jd=Nd}ZGg(xc){this.addHandler(Wd.$td,xc)}acj(xc){this.removeHandler(Wd.$td,xc)}get uc(){return"FormDialog"}get Yff(){return this.CLc}get n7a(){return this.Y$d}dispose(){Wc.a.Ia(this.r1a);
this.r1a=null;super.dispose()}initialize(){super.initialize();const xc=yc.a.Oaa(this.$.ya.FormLightBoxUrl),jd=this.r1a=new zc.a(this.PLa.contentWindow,xc);jd.isEnabled()&&jd.OFa(xc)&&(this.Nma(xd.v2f,this.hpc),this.Nma(xd.view,this.hpc),this.Nma(xd.CAe,this.hpc),this.Nma(xd.jvj,this.ZRi),this.Nma(xd.edit,this.FJi),this.Nma(xd.w7i,this.hpc),this.Nma(xd.ready,this.rQi),this.Nma(xd.w_g,this.nnc),this.Nma(xd.MAe,this.nnc))}close(xc){xc===this.xM&&this.Yff&&this.r1a.send(new pd.a(xd.PYi))||super.close(xc)}y_e(){return this.VEe(this.n7a)}VEe(xc){const jd=
this.$.ya,Nd=new Sys.StringBuilder(jd.FormLightBoxUrl);wc.a.Kg(Nd,od.a.gEh,this.$.ea.sessionId);wc.a.Kg(Nd,od.a.eEh,xc?od.a.fEh:od.a.dEh);ud.a.NZa(Nd,jd);return Nd.toString()}yfg(xc){this.CLc=!1;this.PLa.src=this.VEe(xc);this.Y$d=xc}Nma(xc,jd){this.r1a.qo(xc);this.r1a.$l(xc,jd)}$nc(xc){const jd=this.$.ea.xa.getItemByName(xc.mK.SheetName);jd&&0===jd.aA&&Fa.g(this.$).yg(xc.mK,null,null,null,20,yd.a.QDh)}}Wd.aeh=900;Wd.Ddh=1200;Wd.$td="lightBoxReady";Object(b.a)(Wd,"FormDialog",fd,[206]);var Hd;(function(xc){xc[xc.comment=
10]="comment";xc[xc.range=12]="range";xc[xc.table=13]="table";xc[xc.chart=14]="chart";xc[xc.sheet=15]="sheet"})(Hd||(Hd={}));Object(b.b)("NavigationType",Hd);var le=a(869),Le=a(119),Md=a(19),ke=a(560),ve=a(944),ge=a(285),we=a(739),De=a(53);class ib extends we.a{constructor(xc,jd,Nd,Ld,Za,Pa=0,Ab){super(xc,Fc.a.instance.ga(jd),!1);this.htmlSanitizationHelper=null;this.message=Nd;this.GFi=Ld;this.U0d=Za;this.operationFlags=Pa;this.htmlSanitizationHelper=Ab}get uc(){return"WebMethodConfirmationDialog"}get hA(){return 1005}get CHa(){return this.operationFlags}initialize(){let xc=
"<div class='"+Le.a.yo+"'>\r\n\t<div class='"+Le.a.iOe+"'>\r\n\t\t<div class='"+Md.a.tAe+"'>\r\n\t\t\t<img src='{0}' class='"+Md.a.bRe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Le.a.lOe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";xc=String.format(xc,De.a.Ue(13),Fc.a.instance.ga(25),Fc.a.instance.ga(this.message));this.htmlSanitizationHelper&&Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SocialSharingSanitizeInnerHtml",
!1)?this.htmlSanitizationHelper.fdb(this.Pb,xc):this.Pb.innerHTML=xc;this.addButton(0,this.GFi);this.addButton(1);super.initialize()}EE(){return this.U0d}}Object(b.a)(ib,"WebMethodConfirmationDialog",we.a,[]);class Yb extends le.a{constructor(xc,jd){super(xc,Fc.a.instance.ga(1274));this.htmlSanitizationHelper=this.oUa=this.PRa=this.textBox=null;this.CFf=()=>{const Nd=this.$;this.Zu();const Ld=new ib(Nd,1277,1278,1279,(Za,Pa,Ab)=>{var Aa=Nd.pa.va.Tb(),rb=Nd.pa.va;Aa=rb.Na(1,Aa);return Va.g(rb,"UnshareForm",
Aa,Za,Pa,Ab,null,0)},16,this.htmlSanitizationHelper);Ld.initialize();Ld.ig()};this.htmlSanitizationHelper=jd}get uc(){return"ShareFormDialog"}dispose(){this.oUa&&this.oUa.lda(this.CFf);Wc.a.qc([this.textBox,this.PRa,this.oUa]);this.oUa=this.PRa=this.textBox=null;super.dispose()}initialize(){let xc="<div class='"+Le.a.yo+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Le.a.Gtb+"'>\r\n\t<input type='text' id='{1}' class='"+Le.a.gF+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
xc=String.format(xc,Fc.a.instance.ga(1275),"sfd_input","sfd_unshare",Md.a.Xp,Fc.a.instance.ga(1276));this.Pb.innerHTML=xc;this.textBox=new ge.a(this.getElementById("sfd_input"));this.PRa=new ve.a(this.textBox.domElement);this.oUa=ke.a.create(this.getElementById("sfd_unshare"));this.oUa.p2(this.CFf);this.textBox.text=Fc.a.instance.ga(741);this.textBox.enabled=!1;this.textBox.readOnly=!ja.a.Xg;this.addButton(1,10);super.initialize()}Bsa(){return(xc,jd,Nd)=>{var Ld=this.$.pa.va.Tb(),Za=this.$.pa.va;
xc=this.pva(xc);jd=this.pja(jd);Ld=Za.Na(1,Ld);return Va.g(Za,"ShareForm",Ld,xc,jd,Nd,null,0)}}QK(xc,jd,Nd){this.textBox.text=xc.Result;this.textBox.enabled=!0;Cc.DOMElementExtensions.setVisible(this.oUa.domElement,!0);super.QK(xc,jd,Nd)}setFocus(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(xc){}super.setFocus()}}Object(b.a)(Yb,"ShareFormDialog",le.a,[]);var pc=a(245),Jc=a(6),Xc=a(81),M=a(252),$a=a(68),ob=a(623),Tb=a(140),Dc=a(422),ad=a(172),ld=a(254),md=a(17),Wb=
a(251);class Nc extends wb.a{constructor(xc,jd,Nd){super();this.lxe=this.mxe=!1;this.ZGi=()=>{this.mxe=!0;this.u4f()};this.$=xc;this.Ua=jd;this.hK=Nd;$a.a(this.$).OId(new Tb.a(Jc.a.wdg,Jc.a.idle,Nc.lXg),new pc.a(Jc.a.KAe,Jc.a.r_,null,Jc.a.OO,Jc.a.idle))}get WDc(){return sb.b(this.$.sg)}get GNd(){return this.$.isEditMode&&(this.$.ea.Xjh||this.$.hN)}Lc(xc,jd){xc=this.$.workbookContext.FullDocumentInfo;switch(jd){case 353606613:case -1099009678:case 192430811:return!Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 783415632:return!Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return jd=ld.a()&&this.$.ea.Wg.get(5),!xc.FileSharingUrl&&!jd;case -1570751769:case 1986648902:return 131072!==(this.$.JU&131072);case 330035228:return!(this.z3a(!0)&&this.WDc);case -509039657:return!(this.z3a()&&this.WDc);case 1334518759:return!(this.z3a()&&this.WDc&&this.xxe())}return!1}executeCommand(xc,
jd,Nd){xc=this.$.workbookContext.FullDocumentInfo;var Ld=T.a.workflow,Za=xa.TaskExtensions.ak();const Pa=jd.command;if(Pa===Ld||-266099===Pa)return this.W4h(jd,Ld,xc);switch(Pa){case 1986648902:this.J1f();break;case -1570751769:this.G2h(jd);break;case 869186573:jd=T.a.ivj;Za=r.AFrameworkApplication.fa.qa("ShareMenuIsEnabled");Ld=null;(Ib.EwaSettings.ma(549)||Za)&&Nd&&"CopyLink"===Nd.SourceControlId?(Ld={},Ld[A.a.VLb]="copy",jd=T.a.t2f):Za&&Nd&&"ManageAccess"===Nd.SourceControlId?(Ld={},Ld[A.a.VLb]=
"manageAccess",jd=T.a.kvj):Nd&&"LinkToComment"===Nd.SourceControlId&&(Ld={},Ld[A.a.VLb]="copy",Ld[A.a.hRd]=Nd.navId,jd=T.a.t2f);Za=this.C5f(xc,Ld);ad.c(jd);break;case -1099009678:Za=this.oxc(12,xc);break;case 192430811:Za=this.oxc(13,xc);break;case 353606613:Za=this.oxc(14,xc);break;case 783415632:Za=this.oxc(15,xc);break;case -59906385:case 1197060601:this.k4h(jd,xc);break;case 1305810481:this.K6e(!1,jd);break;case 330035228:this.K6e(!0,jd);break;case -509039657:Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&
Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SocialSharingSanitizeInnerHtml",!1)?xa.TaskExtensions.Aa(ia.GetServiceTaskFactory.Sa(this.$.da,498,499,0),Ab=>{this.deleteForm(Ab.result)},this.$.la,3):this.deleteForm(null);break;case 1334518759:jd.uzb=!0;Ib.EwaSettings.isChangeGateEnabled("OfficeVSO:6296544_ReduceInnerHTMLUsage")&&Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SocialSharingSanitizeInnerHtml",!1)?xa.TaskExtensions.Aa(ia.GetServiceTaskFactory.Sa(this.$.da,
498,499,0),Ab=>{this.shareForm(Ab.result)},this.$.la,3):this.shareForm(null);break;case 710925581:xb.a.wg.Hxc("710925581")&&(Za=xa.TaskExtensions.Aa(this.hK.value,Ab=>{Ab.result.Mj(I.a.conversation,{})},this.la,3));break;case 327119921:this.u2h();break;default:Za=gb.a(Pa)}return Za}Ac(xc,jd){xc=!1;jd=jd.command;if(jd===T.a.workflow)return!0;switch(jd){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:xc=
!0;break;case 353606613:case -1099009678:case 192430811:xc=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode;break;case 783415632:xc=Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)&&!this.$.ea.isNamedObjectViewMode}return xc}Oc(xc,jd,Nd){if("PopulateFormMenu"===jd){jd=this.WDc?this.xxe()?Nc.myh:Nc.nyh:Nc.wDi;xc=this.Ua.Dc();for(let Ld=0;Ld<jd.length;Ld++)xc.buttons.push(this.Ua.qb(jd[Ld]));jd=this.Ua.Up("Forms.Flyout");
jd.sc.push(xc);Nd.MenuItems=jd.yC();return!0}return!1}W4h(xc,jd,Nd){return this.GNd&&xc.command===jd?(this.ENd(xc,-266099),xa.TaskExtensions.Uaa()):xa.TaskExtensions.Aa(this.hK.value,Ld=>{Oc.a(Ld.result,I.a.workflow,null,Nd.WorkflowPostMessage)||mb.HelperMethods.Ze(Nd.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.la,3)}xxe(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.Wg.get(26)}u2h(){var xc=Gb.a.create().toString();k.ULS.sendTraceTag(528581128,
306,50,`Calling share to teams deeplink with ID: ${xc}`);var jd=this.$.frame,Nd=jd.w9a,Ld=this.$;const Za=new Wb.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsMeetingShareEndpoint"));Za.Zi("deeplinkId",xc);Za.Zi("lm","deeplink");xc=Za.Zi;var Pa={};const Ab=new Wb.QueryStringBuilder(r.AFrameworkApplication.fa.Xa("TeamsAppSharingUrl"));Ab.Zi("auth","2");Ab.Zi("flight","officeunihost");Ab.Zi("source","TEAMS-ELECTRON.meetingStage.deeplink");var Aa={};Aa.fileType=u.a.e4(Ld.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);
Aa.objectUrl=Ld.workbookContext.FullDocumentInfo.WorkbookPath;Aa.baseUrl=Ld.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;{Ld=Ld.workbookContext.WorkbookFileVersionId;let rb=decodeURIComponent(Ld);for(;Ld!=rb;)Ld=rb,rb=decodeURIComponent(Ld);0>Ld.indexOf("{")||0>Ld.indexOf("}")?(k.ULS.sendTraceTag(528250338,306,15,`Decoded fileId does not match expected format. Decoded id: ${Ld}`),Ld=""):Ld=Ld.substring(Ld.indexOf("{")+1,Ld.indexOf("}")).toLowerCase()}Aa.fileId=Ld;Aa=H.c(H.c(Aa));Ab.Zi("subEntityId",
Aa.substring(1,Aa.length-1));Pa.appSharingUrl=Ab.toString();Pa.appId=r.AFrameworkApplication.fa.Xa("TeamsAppId");Pa=JSON.stringify(Pa);xc.call(Za,"appContext",Pa);Nd.call(jd,Za.toString(),!0)}G2h(xc){this.GNd?this.ENd(xc,1986648902):this.J1f()}K6e(xc,jd){!xc&&this.$.ya.SurveyRedirectUrl?this.$1i():(xc=new Wd(this.$,xc,jd),xc.initialize(),xc.ig())}k4h(xc,jd){this.GNd&&1197060601===xc.command?this.ENd(xc,-59906385):xa.TaskExtensions.Aa(this.hK.value,Nd=>{Nd=Nd.result;Nd&&Oc.a(Nd,I.a.replyWithChanges,
null,this.$.ea.Wg.get(8))||(Nd=new Sys.StringBuilder(jd.ReplyWithChangesUrl),wc.a.Kg(Nd,Dc.e,Dc.d),qc.a.ntw(Nd.toString(),this.$))},this.la,3)}ENd(xc,jd){const Nd=$a.a(this.$).kd.activityState,Ld=new Cb.a(jd,xc.method,xc.mode,xc.Re,xc.tabName);ma.a(this.$).Bs(new fc.a(Jc.a.Ux,5,()=>{Nd[M.a.Aq]=Jc.a.LWf;Nd[ob.a.jUc]=Ld;this.$.el.Ty("SocialSharingSaveBeforeCommand");this.$.el.pne(Ld.command)}))}J1f(){const xc=this.$.ya.DocumentHostInfo;xc.HostEmbeddedViewUrl||this.mxe?this.u4f():this.$.pe.get(53)&&
xa.TaskExtensions.Aa(this.hK.value,jd=>{this.cOj(jd.result)||qc.a.ntw(xc.FileEmbedCommandUrl,this.$)},this.la,3)}cOj(xc){return xc.isEnabled()&&(this.lxe||(this.lxe=xc.$l(I.a.kxe,this.ZGi)))?xc.Mj(I.a.Tzh,null):!1}u4f(){if(ja.a.Ap)qc.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{const xc=new $b(this.$);xc.initialize();xc.ig()}}deleteForm(xc){const jd=this.$;xc=new ib(jd,1280,1281,1273,(Nd,Ld,Za)=>{var Pa=jd.pa.va.Tb(),Ab=jd.pa.va;Pa=Ab.Na(9,Pa);Pa.surveyId=null;return Va.g(Ab,"DeleteSurvey",Pa,
Nd,Ld,Za,null,0)},0,xc);xc.initialize();xc.ig()}shareForm(xc){const jd=this.$.workbookContext.FullDocumentInfo;this.$.ea.Wg.get(26)?(xc=new Yb(this.$,xc),xc.initialize(),xc.ig()):xa.TaskExtensions.Aa(this.hK.value,Nd=>{Oc.a(Nd.result,I.a.shareForm,{[A.a.iHj]:this.$.workbookContext.SurveyTitle},this.$.ea.Wg.get(10))||qc.a.ntw(jd.ShareFormCommandUrl,this.$)},this.la,3)}$1i(){const xc=this.$;xc.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");const jd=new Sys.StringBuilder(xc.ya.SurveyRedirectUrl);
wc.a.Kg(jd,"startupDialog","FormEdit");const Nd=$a.a(this.$),Ld=Nd.kd.activityState;Ld[Xc.a.h2]=jd.toString();Ld[Xc.a.fM]=Xc.a.syd;this.$.el.Ty("SocialSharingEnvironmentChange");ma.a(xc).Bs(new fc.a(Jc.a.Ux,5,()=>{const Za=ra.a.Yc(3,2,1325,1326,1327,554412057,"FossEnvironmentUnsupported");Nd.kd.kr([Za]);Ld[M.a.Aq]=Jc.a.wdg}))}z3a(xc=!1){return(this.$.ea.isEditMode||xc)&&this.$.ea.Wg.get(25)&&ld.a()}SXh(xc){var jd=Fa.g(this.$).ha;const Nd=this.$.xa.oa?Ya.d(this.$.xa.oa):null;if(!Nd)return k.ULS.sendTraceTag(537151649,
0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: ${Hd[xc]}.`),null;var Ld=null;14===xc?Ld=this.sXh(jd):12===xc?(Ld=jd.eia,Ld=Pb.a.contains(Ld,"!",!0)?Ld.split("!")[1]:Ld):13===xc&&(jd=jd.sa.selectedRanges,jd[0]&&(jd=Fa.g(this.$).Fb.hk(jd[0])))&&(Ld=jd.mj);if(!Ld&&15!==xc)return k.ULS.sendTraceTag(537151648,0,10,`SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: ${Hd[xc]}`),null;jd={};
jd[A.a.VLb]="copy";jd[A.a.hRd]=this.kOh(xc,Ld,Nd);k.ULS.sendTraceTag(537151647,0,50,`SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: ${Hd[xc]} and sectionNameOrId: ${Ld} and SheetId: ${Nd}`);return jd}sXh(xc){if(xc.Qa.LZ&&(xc=xc.Qa.dc.floatingObject)&&0===xc.type){const jd=xc.id.split(".");if(1<jd.length)return jd[1];k.ULS.sendTraceTag(537151646,0,10,`SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  ${xc.id}`)}return null}kOh(xc,
jd,Nd){let Ld=xc+"_";Ld=btoa(15===xc?Ld+Nd:Ld+(jd+"_"+Nd));Ld=Ld.replace(RegExp("\\+","g"),"-");Ld=Ld.replace(RegExp("\\/","g"),"_");return Ld=Ld.replace(RegExp("\\=+$","g"),"")}C5f(xc,jd,Nd=!1){return xa.TaskExtensions.Aa(this.hK.value,Ld=>{Oc.a(Ld.result,I.a.sharing,jd,this.$.ea.Wg.get(5))?(k.ULS.sendTraceTag(537151644,0,50,`SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: ${jd?jd[A.a.VLb]:""}`),Nd&&Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)&&Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&window.addEventListener("message",this.r7e)):mb.HelperMethods.Ze(xc.FileSharingUrl,"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)}r7e(xc){if(xc&&xc.data)try{switch(JSON.parse(xc.data).name){case "share_dismiss":this.gMj()}}catch(jd){k.ULS.sendTraceTag(512328543,0,50,"SocialSharingCommandHandler.handleShareMessage Failed to parse data with exception : "+jd.message)}}oxc(xc,jd){if(15===
xc&&!Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSheet",!1)||15!==xc&&!Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;const Nd=this.SXh(xc);if(Nd)return k.ULS.sendTraceTag(520737606,0,50,`SocialSharingCommandHandler.ShareExcelSection: Calling share dialog with nav id=${Nd[A.a.hRd]}`),this.C5f(jd,Nd,!0);k.ULS.sendTraceTag(537151643,0,10,`SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: ${Hd[xc]}`);
return null}gMj(){window.addEventListener("message",this.r7e);Ib.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DeepLinkCreationSurveyFPS",!1)&&(this.$.fd(638984051,0,0,null),k.ULS.sendTraceTag(512328542,0,50,"SocialSharingCommandHandler.triggerDeepLinkCreationSurvey: FPS survey got triggered."))}}Nc.wDi=[103];Nc.myh=[107,104,105,106];Nc.nyh=[104,105];Nc.lXg=[new md.a(Jc.a.KAe,554412057,0,0,1328),new md.a(Jc.a.idle,554412057,0,1)];Object(b.a)(Nc,"SocialSharingCommandHandler",wb.a,[164]);
class gd extends wa.a{constructor(xc){super(xc)}vd(){const xc=new e.a(()=>ia.GetServiceTaskFactory.create(this.$.da,137,this.la,this.fb));xa.TaskExtensions.Aa(ia.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb),jd=>{this.$c([new Nc(this.$,jd.result,xc)])},this.la,3)}static ka(xc){wa.a.Od(114,new gd(xc))}}Object(b.a)(gd,"SocialSharingCommandHandlerFactory",wa.a,[]);var Gd=a(1149);class Zd{constructor(xc){this.gi=xc}executeCommand(xc,jd,Nd){return 2!==this.gi.de(T.a.tryOfficeThroughTellMe,
2,Nd)?K.Task.Ta(!0):gb.a(jd.command)}Ac(xc,jd){return 215809929===jd.command}Oc(){return!1}Lc(){return!1}}Object(b.a)(Zd,"TryOfficeThroughTellMeCommandHandler",null,[164]);class xe extends wa.a{constructor(xc){super(xc)}vd(){this.$c([new Zd(r.AFrameworkApplication.vb)])}static ka(xc){wa.a.Od(207,new xe(xc))}}Object(b.a)(xe,"TryOfficeThroughTellMeCommandHandlerFactory",wa.a,[]);var Re=a(155),Ue=a(77),jf=a(152),Bf=a(261),Ae=a(144),Qe=a(185);class Je{static SM(){return Ae.a.Yp(Je.ml,Qe.a.Va(436))}}Je.ml=
"<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(b.a)(Je,"NamedSheetViewTeachingDialogHtml",null,[]);var se=a(51);class cb extends Bf.a{constructor(xc){super(xc);this.stopwatch=this.kp=null;this.ECi=jd=>{if(1===jd)this.$.Ka.Lb(new Cb.a(-2050946363,
Ue.a.Gb,2,8,null)).continueWith(Nd=>{this.kp.setResult(!jf.a(Nd)&&Nd.result)}),jd="Yes";else{const Nd=2===jd;this.kp.setResult(Nd);jd=2===jd?"No":"Close";Nd&&this.v0i()}this.Ovi(jd);this.hide()}}get uc(){return"ShowNamedSheetViewTeachingDialog"}Ag(){this.Rb=4;this.stopwatch=this.$.Jb.Bc("UserAction",this.uc);const xc=Fc.a.instance.ga(1911);this.mg=Je.SM();this.kp=new Re.a;this.initializeAndShow(xc,this.ECi,{});return this.kp.task}Cv(xc){super.Cv(xc);this.rc(1,Fc.a.instance.ga(1913));this.rc(2,Fc.a.instance.Va(449))}v0i(){this.$.ea.$lc=
!1}Ovi(xc){const jd={};jd.a=this.$.ya.UserSessionId;jd.b="NamedSheetViewTeachingDialogClose";jd.c=xc;jd.e=!0;this.stopwatch&&(this.stopwatch.stop(),jd.d=this.stopwatch.yc);se.b().Ne(53,jd,!0)}}Object(b.a)(cb,"NamedSheetViewTeachingDialog",Bf.a,[]);var Rb=a(161);class uc{constructor(xc){this.$=xc;xc.da.Ga(309,this)}VSa(){if(this.ayj()){if(Ib.EwaSettings.ma(573)){this.$.xa.oa.Dd.ASd=!0;const xc=new Re.a;this.$.Ka.Lb(new Cb.a(-2050946363,Ue.a.Gb,2,0,null)).continueWith(jd=>{xc.setResult(!jf.a(jd)&&jd.result)});
return xc.task}return(new cb(this.$)).Ag()}return K.Task.Ta(!0)}ayj(){const xc=this.$.xa.oa;return this.$.ea.H9a&&this.$.ea.$lc&&!xc.Dd.uv&&this.$.ea.HM&&!Rb.f(this.$)}}Object(b.a)(uc,"NamedSheetViewPublic",null,[734]);class Sc extends Wa.a{constructor(xc){super();this.$=xc;this.Eb()}create(){this.pb(this.$.da.za(309)||new uc(this.$))}static ka(xc){xc.da.Ga(310,new Sc(xc))}}Object(b.a)(Sc,"NamedSheetViewPublicFactory",Wa.a,[]);var ub=a(7),Zb=a(187),Ec=a(1326),ed=a(860),Kd=a(460);class fe{constructor(xc,
jd,Nd,Ld,Za,Pa,Ab){this.title=xc;this.body=jd;this.G0i=Nd;this.primaryButtonAction=Ld;this.secondaryButtonAction=Pa;this.nYf=Za;this.targetObject=Ab}}Object(b.a)(fe,"NamedSheetViewTeachingCalloutContent",null,[]);class be{constructor(xc){this.sje=0;this.W9f=xc}get U9f(){return this.sje}get i2i(){return this.U9f<this.W9f.count?this.W9f.na(this.sje++):null}}Object(b.a)(be,"NamedSheetViewTeachingCalloutList",null,[]);var me=a(1073);class re{constructor(xc){this.stopwatch=this.P_b=this.pAc=this.EWd=null;
this.V9f=0;this.$=xc}x$h(xc){this.V9f=xc;const jd=Object(ub.a)(new Zb.a,{});re.Whi(xc)?(jd.add(new fe(Fc.a.instance.Va(438),Fc.a.instance.Va(439),Fc.a.instance.ga(1941),()=>{this.dI(2,"Continue");this.SJ(!0)},Fc.a.instance.ga(1942),()=>{this.SJ();this.dI(1,"ExitGuide")},me.a())),1===xc&&jd.add(new fe(Fc.a.instance.ga(1943),Fc.a.instance.Va(441),Fc.a.instance.ga(1941),()=>{this.dI(2,"FirstEnterTempViewContinueSecond");this.SJ(!0)},Fc.a.instance.ga(1942),()=>{this.SJ();this.dI(1,"FirstEnterTempViewExitGuideSecond")},
me.a())),jd.add(new fe(Fc.a.instance.Va(442),Fc.a.instance.Va(443),Fc.a.instance.ga(1941),()=>{this.dI(2,"FirstEnterExitCalloutContinue");this.SJ(!0)},Fc.a.instance.ga(1942),()=>{this.SJ();this.dI(1,"FirstEnterExitCalloutGuide")},re.i1e())),jd.add(new fe(Fc.a.instance.ga(1944),Fc.a.instance.Va(440),Fc.a.instance.ga(1945),()=>{this.d5f();this.SJ();this.dI(1,"LearnMore")},Fc.a.instance.ga(1946),()=>{this.SJ();this.dI(1,"Done")},re.h1e()))):2===xc?jd.add(new fe(Fc.a.instance.ga(1943),Fc.a.instance.Va(441),
Fc.a.instance.ga(1940),()=>{this.SJ();this.dI(1,"EnterTempViewAfterPersistedView")},null,null,me.a())):3===xc&&(jd.add(new fe(Fc.a.instance.Va(438),Fc.a.instance.ga(1952),Fc.a.instance.ga(1941),()=>{this.dI(2,"AutoOptInExitCalloutContinue");this.SJ(!0)},Fc.a.instance.ga(1942),()=>{this.SJ();this.dI(1,"AutoOptInExitGuide")},re.i1e())),jd.add(new fe(Fc.a.instance.ga(1943),Fc.a.instance.Va(441),Fc.a.instance.ga(1941),()=>{this.dI(2,"Continue");this.SJ(!0)},Fc.a.instance.ga(1942),()=>{this.SJ();this.dI(1,
"ExitGuide")},me.a())),jd.add(new fe(Fc.a.instance.ga(1944),Fc.a.instance.Va(440),Fc.a.instance.ga(1945),()=>{this.d5f();this.SJ();this.dI(1,"LearnMore")},Fc.a.instance.ga(1946),()=>{this.SJ();this.dI(1,"Done")},re.h1e())));this.EWd=new be(jd)}d5f(){const xc=new Cb.a(-859308420,Ue.a.Gb,this.$.Kc,9,null);this.$.Ka.Lb(xc,{[Ue.a.kg]:"HelpID=SheetViews",["InputMethod"]:Ue.a.Gb,[Ue.a.Qc]:od.a.aV,["ShouldCanvasTakeFocus"]:!0})}show(xc){this.x$h(xc);this.Tdb()}Orj(xc){this.P_b=xc}Tdb(){var xc=this.EWd.i2i;
if(xc){var jd=Object(ub.a)(new Ec.a,{label:xc.G0i,onExecute:xc.primaryButtonAction}),Nd=null;xc.nYf&&(Nd=Object(ub.a)(new Ec.a,{label:xc.nYf,onExecute:xc.secondaryButtonAction}));xc=Object(ub.a)(new ed.a,{target:xc.targetObject,content:xc.body,title:xc.title,showCloseIcon:!0,primaryButtonProps:jd,secondaryButtonProps:Nd,useTeachingStyles:!0});xc=this.P_b.callout(xc);jd=Object(ub.a)(new Kd.a,{onShow:()=>{this.dI(0)}});this.pAc=this.P_b.addNotification(xc,jd)}}dismiss(){this.SJ();this.dI(1,"DismissedByOthers")}SJ(xc=
!1){this.pAc&&(this.P_b.removeNotification(this.pAc),this.pAc=null);xc&&this.Tdb()}dI(xc,jd=null){const Nd={};Nd.a=this.$.ya.UserSessionId;Nd.b=this.V9f;Nd.c=this.EWd.U9f;Nd.d=xc;Nd.e=jd;0===xc?this.stopwatch=this.$.Jb.Bc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Nd.f=this.stopwatch.yc,this.stopwatch=null),2===xc&&(this.stopwatch=this.$.Jb.Bc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));se.b().Ne(52,Nd,!0)}static h1e(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")}static i1e(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")}static Whi(xc){return 0===
xc||1===xc}}Object(b.a)(re,"NamedSheetViewTeachingCallout",null,[736]);class Xe extends Wa.a{constructor(xc){super();this.$=xc;this.Eb()}create(){let xc=this.$.da.za(322);xc||(xc=new re(this.$),this.$.da.Ga(322,xc));this.pb(xc)}static ka(xc){xc.da.Ga(323,new Xe(xc))}}Object(b.a)(Xe,"NamedSheetViewTeachingCalloutFactory",Wa.a,[]);var We=a(1244),ee=a(1139);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Object(c.a)();Type.registerNamespace("CADWLTR");f.main();Type.registerNamespace("Common.App.NewAndOpen.UX");d.a.instance.Gi(new na);Object(P.a)();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");
Object(ka.a)();Object(pa.a)();Object(Na.a)();Object(Z.a)();Type.registerNamespace("Common.App.SharedFilePicker");Ba.main();Type.registerNamespace("Common.App.WildFire");ca.main();Object(ba.a)();ua.a.Fa(sa.ka);Object(ab.a)();Object(Ua.a)();Object(nb.a)();Ha.a.Qi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(()=>{ua.a.Fa(xc=>{Oa.ka(xc)})})();
(()=>{ua.a.Fa(xc=>{xc.da.Ga(165,new Sa(xc))})})();ua.a.Fa(Ma.ka);Object(Bb.a)();Object(Nb.a)();Object(Ia.a)();Object(jb.a)();Object(Ob.a)();Object(Jb.a)();Object(Kb.a)();Object(Qa.a)();Object(ha.a)();Object(qa.a)();ua.a.Fa(ac.ka);ua.a.Fa(gd.ka);Object(Gd.a)();ua.a.Fa(xe.ka);(()=>{ua.a.Fa(xc=>{Sc.ka(xc);Xe.ka(xc)})})();Object(We.a)();Object(ee.a)()},707:function(n,C,a){a.d(C,"a",function(){return X});n=a(0);var c=a(7),b=a(15),d=a(86),f=a(223),e=a(13),k=a(108),l=a(175),m=a(4),u=a(85);C=a(236);var t=
a(1056),w=a(19),r=a(5),v=a(322),y=a(53),x=a(12),B=a(71),z=a(14),A=a(21),I=a(96),F=a(900),U=a(1);class X extends C.a{constructor(T,G){super(document.createElement("div"));this.Zlf=this.Mqe=this.ile=this.b3b=this.Vba=this.f8=this.XO=this.cz=null;this.gwa=this.tZ=this.ov=this.hideCloseButton=!1;this.RHi=D=>{this.vD(D)};this.XHi=D=>{13===D.keyCode&&this.vD(D)};this.cAd=D=>{this.Io(D.tb);return!0};this.hAd=D=>{this.v_(D.tb);return!0};this.doc=D=>{this.gma(D.tb?D.tb:0);return!0};this.SHi=D=>{this.vD(D.Ca);
return!0};this.Pkg=(D=null)=>{this.Io(D.inputMethod?D.inputMethod:0);return!0};this.Qkg=(D=null)=>{this.v_(D.inputMethod?D.inputMethod:0);return!0};this.i1=T;this.bD=G;this.iYc=G.RGa.toString();this.title=G.title;this.message=G.message;this.set_visibilityMode(1)}get ETg(){return this.bD.RGa}get businessBar(){return this.i1}get actionButton(){return this.bD?this.bD.actionButton:""}get uGa(){return this.bD?this.bD.uGa:""}get linkText(){return this.bD?this.bD.link:""}get $k(){return this.bD?this.bD.$k:
""}get alt(){return this.bD?this.bD.alt:""}dispose(){d.a.qc([this.b3b,this.XO,this.f8]);this.ov&&this.XO&&(f.a.instance.Ba(e.a.click,this.XO.domElement,this.cAd),k.KeyInputManager.instance.Hv(this.domElement,this.ile));this.tZ&&this.f8&&(f.a.instance.Ba(e.a.click,this.f8.domElement,this.hAd),k.KeyInputManager.instance.Hv(this.domElement,this.Mqe));this.gwa&&this.Vba&&(f.a.instance.Ba(e.a.click,this.Vba,this.doc),k.KeyInputManager.instance.Hv(this.domElement,this.Zlf));this.Vba=this.cz=this.i1=this.f8=
this.XO=null;super.dispose()}update(){}HQj(){this.KFe(!0)}N3c(){this.KFe(!1)}q$g(){this.message=I.a.ki(this.message);this.title=I.a.ki(this.title);l.UISurfaces.Rfd().then(T=>{T.initializeMessageBarInStore();let G=Object(c.a)(new F.a,{messageTitle:this.title,message:this.message,isMultiline:!1,messageBarType:this.bD.DTg,dismissButtonAriaLabel:z.a.instance.ga(10)});this.hideCloseButton||(G.onDismiss=this.SHi);this.gwa&&(G.linkProps={["type"]:"AppLinkProps",["text"]:this.linkText,["onExecute"]:this.doc});
this.ov&&(G.firstActionButtonProps={["type"]:"AppButtonProps",["label"]:this.actionButton,["onExecute"]:this.Pkg});this.tZ&&(G.secondActionButtonProps={["type"]:"AppButtonProps",["label"]:this.uGa,["onExecute"]:this.Qkg});T.createNewMessageBar(this.domElement,G);return null},()=>{b.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized");return null});m.AFrameworkApplication.fa.qa("Fluent2StyleIsEnabled")&&(this.domElement.classList.add("VNextBusinessBarEntry"),this.domElement.classList.add("WACBusinessBarEntry"));
this.domElement.classList.add("ReactBusinessBarEntry");this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)}LFe(T){let G="<div class='"+t.a.Knh+"' id='{0}'><div class='"+t.a.Inh+"'><a class='"+t.a.Qnh+"' title='{1}'><span class='"+w.a.$2b+" "+t.a.Mnh+"' id='{2}'>";this.$k.length&&(G+="<img class='{3}' src='{4}'/>");G+="</span></a><span class='"+t.a.Pnh+"' id='{5}'>{6}</span><span class='"+t.a.Onh+"' id='message'>{7}</span><a id='link' href='#' class='"+t.a.Nnh+"'>{8}</a><span class='"+
t.a.MNe+"'><button type='button' id='action' class='"+t.a.LNe+"'>{9}</button></span><span class='"+t.a.MNe+"'><button type='button' id='altAction' class='"+t.a.LNe+"'>{10}</button></span></div><a class='"+t.a.Lnh+"' tabindex='0' role='button'><span id='close' class='"+w.a.WA+"'><img class='"+w.a.o$c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";T||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var D=this.businessBar.$.Cb;T=D+"ewaBusinessBarEntryBody"+
this.iYc;const J=D+"ewaBusinessBarEntryTitle"+this.iYc;D=D+"ewaBusinessBarEntryIcon"+this.iYc;this.domElement.className=t.a.Jnh;this.domElement.innerHTML=String.format(G,T,this.alt,D,this.$k,y.a.Ue(0),J,this.title,this.message,this.linkText,this.actionButton,this.uGa,y.a.Ue(13),z.a.instance.ga(798));x.DOMElementExtensions.yu(this.domElement,r.a.ksa,J,T);this.Vba=$get("link",this.domElement);x.DOMElementExtensions.setVisible(this.Vba,this.gwa);this.gwa&&(f.a.instance.ra(e.a.click,this.Vba,this.doc),
this.Zlf=k.KeyInputManager.instance.Ds(this.Vba,this.doc,u.a.fi,u.a.a1));this.XO=new v.a(x.DOMElementExtensions.getElementById(this.domElement,"action"));this.XO.isVisible=this.ov;this.f8=new v.a(x.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.f8.isVisible=this.tZ;this.ov&&(f.a.instance.ra(e.a.click,this.XO.domElement,this.cAd),this.ile=k.KeyInputManager.instance.Ds(this.XO.domElement,this.cAd,u.a.fi,u.a.a1),this.tZ&&(f.a.instance.ra(e.a.click,this.f8.domElement,this.hAd),
this.Mqe=k.KeyInputManager.instance.Ds(this.XO.domElement,this.hAd,u.a.fi,u.a.a1)));this.cz=$get("close",this.domElement);this.b3b=this.ve.$d(this.cz);this.b3b.ka("click",this.RHi);this.b3b.ka("keydown",this.XHi);x.DOMElementExtensions.setVisible(this.cz,!this.hideCloseButton)}KFe(T){65==this.bD.RGa?this.LFe(T):U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.q$g():this.LFe(T)}Io(){b.ULS.sendTraceTag(21517968,0,50,`BusinessBar [${this.bD.hash}]: BusinessBarEntry.OnActionClick() for EntryName ${this.bD.j9c}`);
A.g(this.businessBar.$).Qo(!0)}v_(){b.ULS.sendTraceTag(537170257,0,50,`BusinessBar [${this.bD.hash}]: BusinessBarEntry.OnAltActionClick()`);A.g(this.businessBar.$).Qo(!0)}gma(){b.ULS.sendTraceTag(537170256,0,50,`BusinessBar [${this.bD.hash}]: BusinessBarEntry.OnLinkClick()`);A.g(this.businessBar.$).Qo(!0)}vD(T){b.ULS.sendTraceTag(21517971,0,50,`BusinessBar [${this.bD.hash}]: BusinessBarEntry.OnCloseClick() for EntryName ${this.bD.j9c}`);this.set_visible(!1);this.businessBar.removeEntry(this.ETg);
B.g(T)}cK(){return U.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.domElement.getElementsByTagName("button")[0]:this.XO.domElement}}Object(n.a)(X,"BusinessBarEntry",C.a,[])},782:function(n,C,a){a.r(C);n=a(0);var c=a(7),b=a(15),d=a(4);a(27);var f=a(382),e=a(38),k=a(50),l=a(12),m=a(128),u=a(14),t=a(21);class w extends Sys.EventArgs{constructor(D){super();this.O0i=D}}Object(n.a)(w,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var r=a(259),v=a(246);
class y{constructor(D){this.og=D}di(){r.a(this.og.$).nB(this.ee)||r.a(this.og.$).di(this)}U7(){r.a(this.og.$).nB(this.ee)&&r.a(this.og.$).Tz(this)}get ee(){return v.a.tKf}get nc(){const {PrintPreviewPane:D}=a(782);return document.getElementById(D.M0i)}get Jf(){return!0}mh(D){return l.DOMElementExtensions.xf(this.nc,D)}sj(){this.og.$.frame.He.Zj(this.og.$.frame.He.eF)}Vj(){}hg(D,J){return J?!1:(this.og.enterPrintPreviewHeaderFocusTrapZone(),!0)}}Object(n.a)(y,"PrintPreviewHeaderKeyboardAccessibleSection",
null,[107]);class x{constructor(D){this.og=D}di(){r.a(this.og.$).nB(this.ee)||r.a(this.og.$).di(this)}U7(){r.a(this.og.$).nB(this.ee)&&r.a(this.og.$).Tz(this)}get ee(){return v.a.uKf}get nc(){const {PrintPreviewPane:D}=a(782);return this.og.useMSPdfViewer?document.getElementById(a(782).PrintPreviewPane.fEd):document.getElementById(D.SHf)}get Jf(){return!0}mh(D){return l.DOMElementExtensions.xf(this.nc,D)}sj(){this.og.$.frame.He.Zj(this.og.$.frame.He.eF)}Vj(){}hg(D,J){return J?!1:(this.og.useMSPdfViewer?
(D=document.getElementById(a(782).PrintPreviewPane.fEd))&&l.DOMElementExtensions.setFocus(D,!0):l.DOMElementExtensions.setFocus(this.og.VK),!0)}}Object(n.a)(x,"PrintPreviewKeyboardAccessibleSection",null,[107]);class B{constructor(D){this.og=D}di(){r.a(this.og.$).nB(this.ee)||r.a(this.og.$).di(this)}U7(){r.a(this.og.$).nB(this.ee)&&r.a(this.og.$).Tz(this)}get ee(){return v.a.xKf}get nc(){const {PrintPreviewPane:D}=a(782);return document.getElementById(D.lGd)}get Jf(){return!0}mh(D){return l.DOMElementExtensions.xf(this.nc,
D)}sj(){this.og.$.frame.He.Zj(this.og.$.frame.He.eF)}Vj(){}hg(D,J){return J?!1:(this.og.enterPrintSettingsTaskPaneFocusTrapZone(),!0)}}Object(n.a)(B,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[107]);class z{constructor(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}}Object(n.a)(z,"MSPdfViewerFileUrl",null,[]);class A{constructor(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=
this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}}Object(n.a)(A,"PrintSettingsTaskPaneProps",null,[]);class I{constructor(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}}Object(n.a)(I,"ViewerPaneProps",null,[]);var F=a(1076),U=a(377),X=a(5),T=a(1077);a.d(C,"PrintPreviewPane",function(){return G});
class G extends e.a{constructor(D,J,L,H){super();this.rCb=this.gkc=this.VK=this.pHb=this.Mw=this.QV=this.JD=this.YF=null;this.qCb=!1;this.axa=!0;this.mGd=this.iGd=this.jGd=this.ewaAccessibilityManager=this.aqc=null;this.mod=!1;this.dAf=()=>{b.ULS.sendTraceTag(537154206,0,50,`PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: ${this.qCb}`);this.qCb&&(this.c7h(),this.VK.style.visibility="visible",this.gkc?this.gkc.stop():b.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),
this.raiseEvent(G.bEb,new w(1)),this.SPd(),this.qCb=!1)};this.$=D;this.HD=J;this.c$g();this.useMSPdfViewer=L;this.isUniversalPrintEnabled=H;this.isExportPdfMode=!1}oHg(D){this.addHandler(G.bEb,D)}ncj(D){this.removeHandler(G.bEb,D)}mBj(D){this.isExportPdfMode=D;this.Y9g()}nBj(){var D=this.$.Jb.Bc("UserAction","createSettingsPaneStopwatch");const J=document.getElementById(G.lGd);this.e$g();const L=this.f$g();this.JD.createPrintSettingsTaskPane(J,L);D.stop();this.qCb=!1;if(this.isUniversalPrintEnabled&&
this.Mw){D="A4";switch(L.selectedPrintSettingsValues.selectedPaperSize){case 8:D="A3";break;case 9:D="A4";break;case 11:D="A5";break;case 12:D="JIS B4";break;case 13:D="JIS B5";break;case 5:D="North America Legal";break;case 1:D="North America Letter";break;case 6:D="North America Invoice";break;case 7:D="North America Executive";break;case 3:D="North America Ledger"}this.YF.setDocumentSettings({mediaSize:D,orientation:2===L.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===
L.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.bJd()}setPageRangeSettings(D,J,L,H,R){this.JD&&(this.JD.setPageRangeSettings(D,J,L,H,R),this.T0f(String.format(u.a.instance.mb(205),H,R,D)))}S6h(){this.Mw&&(this.Mw.style.display="none")}Qhh(){this.dispose();this.qZd();this.AOj();this.YF&&this.YF.closePrintPreviewPane();this.QV=this.JD=this.YF=this.Mw=null}tti(D){b.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?
((this.rCb=this.$.Jb.Bc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||b.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.QV.renderPdf(D)):this.VK&&((this.gkc=this.$.Jb.Bc("UserAction","loadPdfStopwatch"))||b.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.qCb=!0,this.VK.src&&this.VK.src===D?this.dAf(null):this.VK.src=D);if(this.isUniversalPrintEnabled&&this.Mw){const J=U.b(this.$.workbookContext);
this.YF.setFileUrl(D,J)}}onPdfLoad(){this.rCb?(b.ULS.sendTraceTag(537154208,0,50,`PrintPreviewPane:onPdfLoad - Rendering time : ${this.rCb.yc} ms, isFirstTimeLoad: ${this.axa}`),this.rCb.stop()):b.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(G.bEb,new w(1));this.hideWaitCursor();this.SPd()}printPdf(){l.DOMElementExtensions.setFocus(this.VK);this.VK.contentWindow.print()}bCj(){this.showSpinner();this.showWaitCursor();this.T0f("")}c7h(){this.hideSpinner();
this.hideWaitCursor()}bA(D,J,L=null){this.Mw&&this.QV&&(this.mod=!1,this.QV.showErrorDetails(J,D,L),this.HD.z6a=!0,this.VK&&(this.VK.src=""),this.disablePrintButton(),this.hideWaitCursor(),G.Oki(J)&&(this.mod=!0,this.IPi()))}hidePreviewError(){this.HD.z6a=!1;this.QV.hidePreviewError();this.enablePrintButton()}Hhh(){(this.pHb=document.getElementById(G.vKf))&&this.pHb.parentNode&&this.pHb.parentNode.removeChild(this.pHb)}hideErrorMessageForPrintOptions(){this.JD&&this.JD.hideErrorMessageForPrintOptions()}showErrorMessageForPrintOptions(D){this.JD&&
this.JD.showErrorMessageForPrintOptions(D)}showSpinner(){this.HD.z6a||this.mod?this.hidePreviewError():this.VK&&(this.VK.style.visibility="hidden");this.QV&&this.QV.showSpinner()}hideSpinner(){this.QV&&this.QV.hideSpinner()}enablePrintButton(){this.JD&&this.JD.enablePrintButton();this.isUniversalPrintEnabled&&this.Mw&&this.YF.updatePrintButtonEnableDisableState(!0)}disablePrintButton(){this.JD&&this.JD.disablePrintButton();this.isUniversalPrintEnabled&&this.Mw&&this.YF.updatePrintButtonEnableDisableState(!1)}showWaitCursor(){this.JD&&
this.JD.showWaitCursor();this.isUniversalPrintEnabled&&this.Mw&&this.YF.updatePrintButtonEnableDisableState(!1)}hideWaitCursor(){this.JD&&this.JD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Mw&&this.YF.updatePrintButtonEnableDisableState(!0)}a$g(){if(this.Mw)b.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Mw=document.createElement("div"),this.Mw.id=G.vKf,this.Mw.classList.add(G.P0i),this.$.qr.insertBefore(this.Mw,
this.$.qr.firstChild),d.AFrameworkApplication.ta&&d.AFrameworkApplication.ta.Oa.We){const D=document.getElementById(X.a.gsa);D&&(this.Mw.style.top=`${D.clientHeight}px`,this.Mw.style.height=`calc(100vh - ${D.clientHeight}px)`)}}enterPrintPreviewHeaderFocusTrapZone(){this.YF.enterPrintPreviewHeaderFocusTrapZone()}enterPrintSettingsTaskPaneFocusTrapZone(){this.YF.enterPrintSettingsTaskPaneFocusTrapZone()}AZi(){this.$.da.Za(15,D=>{this.ewaAccessibilityManager=D;this.ewaAccessibilityManager.mode=3})}c$g(){this.mGd=
new B(this);this.jGd=new x(this);this.iGd=new y(this)}bJd(){this.mGd.di();this.jGd.di();this.iGd.di();this.AZi()}qZd(){this.mGd.U7();this.jGd.U7();this.iGd.U7();t.g(this.$).t0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)}cO(){this.aqc=m.a.instance.$d(this.VK);this.aqc.ka("load",this.dAf)}AOj(){this.aqc&&this.VK&&this.aqc.detach("load")}SPd(){this.isUniversalPrintEnabled?this.Z_f(G.N0i,G.ADi):this.Z_f(G.lGd,G.pKf)}Z_f(D,J){this.axa&&(D=document.getElementById(D))&&(J=l.DOMElementExtensions.getElementById(D,
J))&&(this.axa=!1,J.focus())}IPi(){this.HD.z6a=!1;this.enablePrintButton();this.SPd()}Y9g(){const D=k.GetServiceTaskFactory.Sa(this.$.da,283,284,0).result.ko;D.loadScript("excel-print-preview-sprite").then(()=>{D.loadScript("printPreviewer").then(()=>{D.loadScript("excelPrintPreviewer").then(()=>{this.d$g()})},()=>{b.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},()=>{b.ULS.sendTraceTag(525358668,
0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}d$g(){const D=this.$.Jb.Bc("UserAction","createEmptyPreviewerStopwatch");this.a$g();this.b$g();this.isUniversalPrintEnabled?this.YF.createEmptyPrintPreviewPaneAsync(this.Mw,this.SFe()).then(()=>{D.stop();this.ACe();this.YF.updatePrintButtonEnableDisableState(!1)}):(this.YF.createEmptyPrintPreviewPane(this.Mw,this.SFe()),D.stop(),this.ACe())}ACe(){const D=this.$.Jb.Bc("UserAction",
"createPdfPreviewPaneStopwatch"),J=document.getElementById(G.fEd);this.useMSPdfViewer&&(J.tabIndex=0);this.K9g();this.J9g(J);D.stop();this.raiseEvent(G.bEb,new w(0))}b$g(){this.YF||(this.YF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.YF||b.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")}e$g(){this.JD||(this.JD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.JD||b.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")}K9g(){this.QV||(this.QV=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.QV||b.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")}J9g(D){this.QV.createPrintPreviewPane(D,this.obh());this.useMSPdfViewer||(this.VK=l.DOMElementExtensions.getElementById(this.Mw,
G.SHf),this.VK.title=u.a.instance.ga(1215),this.cO())}f$g(){let D,J="en-US";D=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?J=this.$.ya.DataCultureTag:b.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object(c.a)(new A,{whatToPrintOptions:this.HD.yv.whatToPrintOptions,orientationOptions:this.HD.yv.orientationOptions,paperSizeOptions:this.HD.yv.paperSizeOptions,scalingOptions:this.HD.yv.scalingOptions,
marginDetailedOptions:this.HD.tSh(),selectedPrintSettingsValues:this.HD.qVh(),printSettingsTaskPaneCallbacks:this.HD.oVh(),logger:new f.a,shouldDisableCurrentSelection:this.HD.Kxc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:D,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})}SFe(){return this.isUniversalPrintEnabled?this.HD.mVh():Object(c.a)(new F.a,{backActionButtonText:u.a.instance.ga(1213),printPreviewPaneCallbacks:this.HD.q2e(),logger:new f.a,disableTellMeControl:!0,
isExportPdfMode:!1})}obh(){return this.useMSPdfViewer?Object(c.a)(new I,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.Y8g(),onPdfLoad:()=>{this.onPdfLoad()}}):Object(c.a)(new I,{useMSPdfViewer:!1})}Y8g(){return Object(c.a)(new z,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})}T0f(D){this.Mw&&this.YF.setAdditionalHeaderText(D)}static Oki(D){return 3===D||2===D}}G.vKf="PrintPreviewerContainer";
G.lGd="printSettingsTaskPaneId";G.fEd="previewId";G.SHf="printpreviewiframe";G.M0i="printPreviewHeaderId";G.pKf="printButton";G.N0i="printPreviewPaneId";G.ADi="printButtonId";G.P0i=T.a.Mw;G.bEb="pppnosu";Object(n.a)(G,"PrintPreviewPane",e.a,[362])},835:function(n,C,a){a.d(C,"a",function(){return e});n=a(0);var c=a(15),b=a(4),d=a(39),f=a(27);class e{static FXe(k,l){switch(k){case 3:return e.v0h(l);case 2:return e.lUh(l);case 1:return e.yOh(l)}return""}static v0h(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString();
case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkWordWac.toString()}return""}static lUh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkPptWac.toString()}return""}static yOh(k){switch(k){case 1:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return b.AFrameworkApplication.fa.appSettings.WildFireAdjustLinkExcelWac.toString()}return""}static openInClient(k,
l,m){if(f.a.Xg||f.a.xp)window.setTimeout(()=>{e.MOf(m,e.Gcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(e.Bre(m),k,0,!1)}static VZg(k,l,m,u){l&&u&&u();e.openInClient(k,l,m)}static Gcc(){return f.a.Xg?1:f.a.xp?2:f.a.Z7a?3:f.a.isMac?4:0}static r0h(k){switch(k){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}}static s0h(k){switch(k){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";
case 1:return"WildFireExcelBizBarFlight";default:return""}}static get Szb(){return"zh-CN"===window.navigator.language}static MOf(k,l){1===l?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),k=e.FXe(k,l),8<f.a.J5a?d.a.Ze(k,void 0,void 0,"RedirectToAppStore"):d.a.LU(k)):document.hidden||(e.Szb?(k=b.AFrameworkApplication.fa.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),d.a.LU(k)):c.ULS.sendTraceTag(18088019,
306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(e.FXe(k,l),null,null)))}static Bre(k){switch(k){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}}static get dyc(){return(f.a.Z7a||f.a.isMac)&&f.a.yp}static get qyj(){return f.a.Xg||f.a.xp}static Cdd(k){switch(k){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}}static Fpd(k){return(k=
e.rRh(k))&&""!==k?Boolean.parse(k):!1}static LQd(k){e.lrj(k)}static rRh(k){try{return localStorage.getItem(k)}catch(l){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+l.message),null}}static lrj(k){try{localStorage.setItem(k,"true")}catch(l){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+l.message)}}}e.wze="ChromeExtensionBarDismiss";Object(n.a)(e,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kmhv.js.map/4538e03c0a76f765232b35cc3347a69c/EwaDSEsNext.kmhv.js.map