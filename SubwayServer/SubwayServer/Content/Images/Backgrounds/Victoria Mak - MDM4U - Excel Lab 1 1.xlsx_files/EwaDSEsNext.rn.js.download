'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1140:function(n,C,a){n=a(0);var c=a(84),b=a(553),d=a(15),f=a(134);class e{constructor(Ua,nb,Ha){this.rTd=this.sTd=this.tTd=!1;this.ITd=!Ua&&!nb;this.JTd=!Ua&&!Ha;this.ITd||this.JTd||(this.tTd=!Ua,this.sTd=!nb,this.rTd=!Ha)}}Object(n.a)(e,"RenameDisabledDialogInfo",null,[]);class k extends f.StandardDialog{constructor(Ua,nb,Ha,sb,Qb){super();this.MWd=[];this.B1=new e(Ua,nb,Ha);this.Era=sb;this.sqa=Qb;this.Ce=
"RenameDisabledDialog";this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose);this.Jtj();this.Pdj()}Jtj(){this.B1.ITd?this.MMb(this.Era?this.sqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.B1.JTd?this.MMb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.VCg();this.Nra(this.MWd)}MMb(Ua){Array.add(this.MWd,Ua)}VCg(){const Ua=[];this.B1.tTd||Array.add(Ua,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.B1.sTd||Array.add(Ua,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.B1.rTd||Array.add(Ua,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Ua.length&&Array.add(this.MWd,Ua)}}Object(n.a)(k,"ReactRenameDisabledDialogBase",f.StandardDialog,[]);class l extends k{constructor(Ua,nb,Ha,sb,Qb){super(Ua,nb,Ha,sb,Qb)}Pdj(){this.nDb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(n.a)(l,"ReactRenameDisabledDialog",k,[]);var m=a(144);class u{static get mg(){return m.a.Yp(u.ml,
CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}u.ml="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(n.a)(u,"RenameDisabledDialogHtml",null,[]);class t extends m.a{constructor(Ua,nb,Ha,sb,Qb){super();this.B1=new e(Ua,nb,Ha);this.Era=sb;this.sqa=Qb;this.Ce="RenameDisabledDialog";this.Rb=0;this.rc(1,CommonUIStrings.l_DialogClose);this.mg=u.mg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.DW("RenameRow")}h$a(){if(this.B1.ITd){let Ua;Ua=this.Era?this.sqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;t.MMb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Ua)}else this.B1.JTd?t.MMb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.b7h()}b7h(){this.B1.tTd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.B1.sTd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.B1.rTd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static MMb(Ua,nb,Ha){Ua.style.display="none";nb.innerText=Ha}}Object(n.a)(t,"RenameDisabledDialog",m.a,[]);var w=a(4),r=a(30),v=a(106),y=a(25);class x{constructor(Ua,nb){this.pEa=0;this.La=Ua;this.v8=nb}initialize(Ua){if(!this.La||!this.v8)return!1;this.pEa=Ua;this.Ig();return!0}Ig(){this.La.Nb(y.a.Nha,v.a.frame,Object(c.a)(this,this.Nha,"commitNewDocumentTitle"))}Nha(Ua,nb,Ha,sb,Qb){if(1===Ha)return this.La.processAction(y.a.renameFile,
1);Ua=r.a.Fq(this.v8.jn);Qb=(0,Qb.getNewDocumentTitle)();Qb.length>this.pEa&&(Qb=Qb.substr(0,this.pEa));if(32!==this.La.de(y.a.renameFile,2,Qb))return this.aX(Ua),8;this.aX(Qb);return 32}aX(Ua){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Ua))}static Bfd(){return new x(w.AFrameworkApplication.vb,w.AFrameworkApplication.nm)}}Object(n.a)(x,"ReactRenameUIHandler",null,[461]);var B=a(92),z=a(520),A=a(555),I=a(13),F=a(108),U=a(237),X=a(88),T=a(39),G=a(27),D=a(83);class J{constructor(Ua,
nb,Ha,sb,Qb,mb,Pb,gc,Xb,Ca,ra,ma){this._initialized=!1;this._element=null;this.pEa=0;this.VQc=this.wKc=!1;this.La=Ua;this.LFc=nb;this.Yd=Ha;this.DA=sb;this.v8=Qb;this.$ge=mb;this.DWb=Pb;this.GGc=gc;this.J8=Xb;this.Q$d=Ca;this.IWa=ra;this.rLc=ma}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(Ua,nb,Ha){if(!(this.La&&this.v8&&this.$ge&&this.DWb&&this.GGc&&nb)||0>=Ua)return!1;this._element=nb;this._element.title=Ha;this._element.setAttribute(X.a.Kd,X.a.Ys);this._element.setAttribute("Unselectable",
"on");this.pEa=Ua;this.Av();return this._initialized=!0}Av(){this.LFc&&(this.LFc.ra(I.a.blur,this._element,Object(c.a)(this,this.onBlur,"onBlur")),this.LFc.ra(I.a.paste,this._element,Object(c.a)(this,this.onPaste,"onPaste")));this.Yd.ra(I.a.Qb,this._element,Object(c.a)(this,this.onKeyDown,"onKeyDown"));this.DA.ra(I.a.pointerDown,this._element,Object(c.a)(this,this.onPointerDown,"onPointerDown"));this.DA.ra(I.a.Nf,this._element,Object(c.a)(this,this.Mf,"onPointerUp"))}onBlur(){this.isActive&&!this.wKc&&
(this.Q$d||this.GGc(this._element),this.XBe(),this.d6c(!1));return this.wKc=!1}onPaste(){d.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(Ua){return this.isActive?this.UNi(Ua):this.VNi(Ua)}UNi(Ua){let nb=!1;switch(Ua.Ca.keyCode){case Sys.UI.Key.enter:this.XBe();this.d6c(this.IWa||this.rLc);nb=!0;break;case Sys.UI.Key.tab:this.Q$d&&this.GGc(this._element);break;case Sys.UI.Key.esc:this.GMd(),this.d6c(this.IWa||this.rLc),nb=!0}return nb}VNi(Ua){let nb=
!1;switch(Ua.Ca.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.vbg(this.rLc),this.isActive&&this.DWb(this._element),nb=!0}return nb}onPointerDown(){this.isActive||(this.vbg(!1),this.isActive&&(this._element.focus(),this.DWb(this._element),this.VQc=!0));return!1}Mf(){return this.VQc?(this.DWb(this._element),this.VQc=!1,!0):!1}q7a(){return 32===this.La.processAction(y.a.renameFile,1)}XBe(){const Ua=r.a.Fq(this.v8.jn);let nb=this._element.innerText.trim();nb.length>this.pEa&&(nb=nb.substr(0,
this.pEa));nb!==Ua&&""!==nb?32!==this.La.de(y.a.renameFile,2,nb)?this.GMd():this.aX(nb):this.GMd()}GMd(){this.aX(r.a.Fq(this.v8.jn))}aX(Ua){this._initialized&&(this._element.innerText=Ua,this.$ge())}vbg(Ua){this.q7a()?this.isActive||(Ua&&(this.wKc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(X.a.Kd,X.a.AXc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,B.CuiHelper.hLe),
this.J8&&this.J8.execute(nb=>{nb.EMf(!0)}),Ua&&this._element.focus(),d.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.La.processAction(y.a.Ydb,2)}d6c(Ua){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(X.a.Kd,X.a.Ys);Sys.UI.DomElement.removeCssClass(this._element,B.CuiHelper.hLe);this.J8&&this.J8.execute(nb=>{nb.EMf(!1)});Ua&&(this._element.blur(),this._element.focus())}static Wz(){z.a.Wz(w.AFrameworkApplication.isRtl)}static Bfd(){return new J(w.AFrameworkApplication.vb,
A.a.instance,F.KeyInputManager.instance,U.a.instance,w.AFrameworkApplication.nm,J.Wz,T.a.Qlj,T.a.DZg,D.a.instance.Ub("Common.App.Header.HeaderEventSource"),G.a.Ika,G.a.Xg,G.a.Uf)}}Object(n.a)(J,"RenameUIHandler",null,[461]);class L{static get instance(){return w.AFrameworkApplication.ta.Oa.ps?L.Ma||(L.Ma=x.Bfd()):L.Ma||(L.Ma=J.Bfd())}}L.Ma=null;Object(n.a)(L,"RenameUIHandlerFactory",null,[]);var H=a(98),R=a(135);class Q{constructor(){this.uDi=this.qDi=this.Sbh=null}}Object(n.a)(Q,"RenameMruEntryProperties",
null,[]);var O=a(372),V=a(164),W=a(644),da;(function(Ua){Ua[Ua.unknown=-1]="unknown";Ua[Ua.success=0]="success";Ua[Ua.renameInvalidFileName=1]="renameInvalidFileName";Ua[Ua.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Ua[Ua.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Ua[Ua.permissionDenied=4]="permissionDenied";Ua[Ua.serverCommunicationFailure=5]="serverCommunicationFailure";Ua[Ua.fileNameTooLong=6]="fileNameTooLong"})(da||(da={}));Object(n.b)("CommonOperationResult",
da);class ta{constructor(Ua,nb,Ha,sb,Qb,mb,Pb,gc,Xb,Ca,ra,ma){this.aae=Ua;this.La=nb;this.QGc=Ha;this.Mv=sb;this.iEa=Qb;this.Czg=mb;this.Era=Pb;this.$je=gc;this.gwg=Xb;this.sqa=Ca;this.nb=ra;this.fwg=ma}Ig(){w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.ps||this.gi.Nb(y.a.Dyb,v.a.frame,Object(c.a)(this,this.Dyb,"initializeRenameUIHandler"));this.gi.Nb(y.a.Ydb,v.a.frame,Object(c.a)(this,this.Ydb,"showRenameDisabledDialog"));this.gi.Nb(y.a.renameFile,v.a.frame,Object(c.a)(this,this.renameFile,
"renameFile"));this.gi.Le(y.a.fileNameUpdate,v.a.frame,Object(c.a)(this,this.v7i,"refreshFilename"),64);this.gi.Le(y.a.Qlc,v.a.frame,Object(c.a)(this,this.Qlc,"moveToFolderCompleteByHost"),64);this.gi.Nb(y.a.IOa,v.a.frame,Object(c.a)(this,this.IOa,"moveToFolder"));w.AFrameworkApplication.ta&&(w.AFrameworkApplication.fa.qa("PostMessageEmbedded")||w.AFrameworkApplication.fa.qa("IsJsApi"))&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",!0)&&w.AFrameworkApplication.XU().execute(Ua=>
{Ua.qo(V.a.qsf);Ua.$l(V.a.qsf,ta.k6i);Ua.qo(V.a.Qad);Ua.$l(V.a.Qad,ta.i6i)})}q7a(){return 0===this.fwg.L2e()?32:8}SUj(){return this.ez?this.Era?this.ez.hKe:this.ez.gvb:!0}Dyb(){return L.instance.initialize(w.AFrameworkApplication.I9b,w.AFrameworkApplication.d2a,w.AFrameworkApplication.WKd||CommonUIStrings.l_RenameFileTooltip)?32:8}Ydb(){const Ua=this.SUj(),nb=this.Czg();d.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.iEa,nb,Ua,this.Era);w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.vv&&w.AFrameworkApplication.fa.qa("ReactRenameDisabledDialogIsEnabled")?new l(this.iEa,!nb,!Ua,this.Era,this.sqa()):new t(this.iEa,!nb,!Ua,this.Era,this.sqa());return 32}renameFile(Ua,nb,Ha,sb,Qb){if(1===Ha)return this.q7a();if(!w.AFrameworkApplication.j9b)return 8;if(8===this.q7a())return this.gi.processAction(y.a.Ydb,2),8;d.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");w.AFrameworkApplication.j9b(Qb,Object(c.a)(this,
this.vFb,"onRenameFileSuccess"),Object(c.a)(this,this.BQi,"onRenameFileFailure"));return 32}vFb(Ua,nb){Ua?0!==Ua.OperationResult?this.D6e(Ua.OperationResult):(this.fnj(nb,Ua.NewName),this.sQj(Ua,Object(c.a)(w.AFrameworkApplication.ta.Oa,w.AFrameworkApplication.ta.Oa.Ueg,"updateOpenInClientDocumentUrl")),w.AFrameworkApplication.fa.qa("DocumentNameInJewelInfoMenuIsEnabled")&&w.AFrameworkApplication.ta.updateCommandUI(),this.gwg.zdg()):this.D6e(5)}fnj(Ua,nb){const Ha={};Ha[O.a.hAh]=nb;Ua.Mj(V.a.Qad,
Ha)}sQj(Ua,nb){this.GQj(Ua);w.AFrameworkApplication.N6b=Ua.DirectInvokeDavUrl;nb=nb(Ua.EditDocInClientUrl);const Ha=new Q;Ha.uDi=this.Mv.jn;Ha.Sbh=nb;Ha.qDi=Ua.EditDocInClientUrl;this.gi.de(y.a.renameMostRecentlyUsedFileEntry,2,Ha)}D6e(Ua){switch(Ua){case 1:Ua=new f.StandardDialog,Ua.Rb=0,Ua.JW(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.hVf()}}GQj(Ua){this.Mv.jn=ta.sLg(this.Mv.jn,Ua.NewName);Ua.BreadcrumbFolderName&&(this.Mv.breadcrumbFolderName=
Ua.BreadcrumbFolderName);Ua.BreadcrumbFolderUrl&&(this.Mv.breadcrumbFolderUrl=Ua.BreadcrumbFolderUrl);this.$je(Ua.NewName)}BQi(Ua){const nb=new f.StandardDialog;nb.Rb=0;switch(Ua){case 1:d.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");nb.ZAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:d.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");nb.ZAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,
null);break;default:d.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",{["Result"]:Ua}),nb.ZAa(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}w.AFrameworkApplication.XU().execute(Ha=>{Ha.Mj(V.a.gAh,{["FailureMessage"]:da[Ua]})});this.hVf()}v7i(Ua,nb,Ha){if(1===Ha)return this.q7a();if(!w.AFrameworkApplication.vJa)return 8;w.AFrameworkApplication.vJa(Object(c.a)(this,this.Ioc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Hoc,"onRefreshFilenameFailure"),
!1);return 32}IOa(Ua,nb,Ha,sb,Qb){if(1===Ha)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?32:8;if(2===Ha){const mb={};Ua=w.AFrameworkApplication.Jba;nb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures");Ua=(!Ua||Ua&&nb)&&w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);mb[O.a.SGj]=Ua;Qb&&Qb.MoveButtonClickedTime&&(mb[O.a.OBi]=Qb.MoveButtonClickedTime.getTime());w.AFrameworkApplication.XU().execute(Pb=>{Pb.Mj(V.a.IOa,
mb)});if(Qb&&Qb.MoveButtonClickedTime){if(Ua=R.a.Ur())Qb=(new Date).getTime()-Qb.MoveButtonClickedTime.getTime(),Ua.set("MovePostDuration",Qb.toString());H.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Ua)}return 32}return 8}Qlc(Ua,nb,Ha,sb,Qb){if(1===Ha)return w.AFrameworkApplication.fa.qa("UiHostSupportsMoveToFolder")?this.q7a():8;if(2===Ha){if(!w.AFrameworkApplication.TYf)return H.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,
null),8;if(!Qb)return H.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",!1,!1,null),8;if(Qb[O.a.Hgi])if(Qb[O.a.Qfg])if(Ua=Qb[O.a.Qfg].toLowerCase(),nb=w.AFrameworkApplication.fa.qa("UiHostSupportsDocRebootFeatures"),Ha=w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),nb&&w.AFrameworkApplication.Jba&&Ha){const mb={};mb[O.a.wQa]="1";mb[O.a.documentUrl]=Ua;mb[O.a.reason]=W.a.saveAs;H.Health.instance.recordKpiSuccess("MoveToFolder",null);
w.AFrameworkApplication.XU().execute(Pb=>{Pb.Mj(V.a.dua,mb)})}else if(!w.AFrameworkApplication.Jba&&Ha)H.Health.instance.recordKpiSuccess("MoveToFolder",null),T.a.Ze(Ua,T.a.cX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return H.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else H.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else w.AFrameworkApplication.vJa(Object(c.a)(this,this.Ioc,"onRefreshFilenameSuccess"),Object(c.a)(this,
this.Hoc,"onRefreshFilenameFailure"),!1),w.AFrameworkApplication.TYf(),H.Health.instance.recordKpiSuccess("MoveToFolder",null)}return 32}Qyj(Ua,nb){return Ua&&nb?Ua!==this.Mv.breadcrumbFolderName||nb!==this.Mv.breadcrumbFolderUrl:!1}Ioc(Ua,nb){Ua&&(Ua.NewName!==r.a.Fq(this.Mv.jn)||this.Qyj(Ua.BreadcrumbFolderName,Ua.BreadcrumbFolderUrl))&&this.vFb(Ua,nb)}Hoc(){}hVf(){this.$je(r.a.Fq(this.Mv.jn))}get gi(){return this.La.value}get ez(){return this.QGc.value}static get instance(){return ta.Ma||(ta.Ma=
ta.hvb())}static hvb(){return new ta(w.AFrameworkApplication.r7a,new b.a(()=>w.AFrameworkApplication.vb),new b.a(()=>w.AFrameworkApplication.ez),w.AFrameworkApplication.nm,w.AFrameworkApplication.limitedEdit,()=>w.AFrameworkApplication.userCanRename,w.AFrameworkApplication.Gtc,Object(c.a)(L.instance,L.instance.aX,"updateTitle"),D.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.fa,D.a.instance.resolve("Common.IRenameProps"))}static sLg(Ua,
nb){Ua=r.a.e4(Ua);return nb+Ua}static k6i(Ua){const nb=Ua.Values[O.a.eki];d.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",nb);nb?w.AFrameworkApplication.vb.de(y.a.Qlc,2,Ua.Values):H.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static i6i(Ua){w.AFrameworkApplication.vb.de(y.a.renameFile,2,Ua.Values.NewName)}}ta.Ma=null;Object(n.a)(ta,"RenameActor",null,[]);a(570);class K{}Object(n.a)(K,"ActivityEventName",null,[]);class na{}
na.compatMode="CompatMode";na.noSelection="NoSelection";Object(n.a)(na,"ActivityEventReason",null,[]);var P=a(643);class ka{constructor(Ua,nb){this.La=Ua;this.RVa=nb}Ig(){this.La.Nb(y.a.w5f,v.a.frame,Object(c.a)(this,this.yBj,"showRenameDialogAction"))}yBj(Ua,nb,Ha){Ua=32;if(1===Ha)return P.SessionStatusManager.instance.s5a||w.AFrameworkApplication.X4?8:32;2===Ha&&(32!==this.La.processAction(y.a.renameFile,1)?(this.La.processAction(y.a.Ydb,2),Ua=8):32===this.La.processAction(y.a.LMb,1)?this.La.processAction(y.a.LMb,
2):this.RVa.value.create().iyc());return Ua}}Object(n.a)(ka,"RenameDialogActor",null,[452]);class pa{constructor(Ua,nb,Ha){this.dialog=null;this.La=Ua;this.Mv=nb;this.dqa=Ha}kWh(){const Ua={};Ua.nameInputProps={["type"]:"AppInputProps",["id"]:pa.c2a,["label"]:CommonUIStrings.l_RenameDialogLabel,["value"]:r.a.Fq(this.Mv.jn),["maxLength"]:this.dqa};return Ua}iyc(){const Ua={["id"]:"RenameDialog",["bodyControls"]:this.kWh()};this.dialog=new m.a(!1,!1,!0);this.dialog.Rb=1;this.dialog.Ce="RenameDialog";
this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.UKd,"renameDialogHandler"),Ua)}UKd(Ua,nb){nb&&1===Ua&&nb[pa.c2a]&&(Ua=r.a.Fq(this.Mv.jn),nb=(nb[pa.c2a]||"").trim(),nb!==Ua&&""!==nb&&this.La.de(y.a.renameFile,2,nb))}}pa.c2a="txtDocumentName";Object(n.a)(pa,"ReactRenameDialog",null,[472]);class Na{static get mg(){return m.a.Yp(Na.ml,CommonUIStrings.l_RenameDialogLabel)}}Na.ml="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(n.a)(Na,"RenameDialogHtml",null,[]);class Z extends m.a{constructor(Ua,nb,Ha){super();this.La=Ua;this.Mv=nb;this.dqa=Ha;this.Ce="RenameDialog";this.mg=Na.mg}iyc(){var Ua={["txtDocumentName"]:r.a.Fq(this.Mv.jn)};this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(c.a)(this,this.UKd,"renameDialogHandler"),Ua);Ua=document.getElementById(Z.c2a);0<this.dqa&&(Ua.maxLength=this.dqa);Ua.focus()}UKd(Ua,nb){1===Ua&&(Ua=r.a.Fq(this.Mv.jn),nb=(nb[Z.c2a]||"").trim(),nb!==Ua&&""!==nb&&this.La.de(y.a.renameFile,
2,nb))}}Z.c2a="txtDocumentName";Object(n.a)(Z,"RenameDialog",m.a,[472]);class Ra{constructor(Ua){this.v8=null;this.dqa=0;this.La=Ua;this._initialized=!1}initialize(Ua,nb){this.v8=Ua;this.dqa=nb;this._initialized=!0}create(){return this._initialized?w.AFrameworkApplication.ta&&w.AFrameworkApplication.ta.Oa.vv&&w.AFrameworkApplication.fa.qa("ReactRenameDialogIsEnabled")?new pa(this.La,this.v8,this.dqa):new Z(this.La,this.v8,this.dqa):null}}Object(n.a)(Ra,"RenameDialogFactory",null,[451]);var Da=a(260),
Ba=a(172),ea=a(159),Y=a(107),ja=a(103);class ca{constructor(Ua,nb){this.La=Ua;this.Zb=nb}Ig(){this.La.Nb(y.a.LMb,v.a.frame,Object(c.a)(this,this.zBj,"showRenameFlyoutAction"))}IVg(){return ea.d("setDocumentTitleFlyoutOpened")&&w.AFrameworkApplication.ta.Oa.ps}zBj(Ua,nb,Ha){if(1===Ha)return this.IVg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}hEg(){ca.ani&&w.AFrameworkApplication.d7a&&ja.a.instance.Fg(new Y.a(5,1,5E3,()=>{32===this.La.processAction(y.a.LMb,
1)&&this.Zb&&this.Zb.ii.name===Da.AFrame.U$&&(Ba.a("RenameFloatieShownOnNewDocumentLoad",!0),this.La.processAction(y.a.LMb,2))}))}static get ani(){ca.lUb&&null!=ca.lUb||(w.AFrameworkApplication.zkc("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),ca.lUb=w.AFrameworkApplication.fa?w.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return ca.lUb}}ca.lUb=null;Object(n.a)(ca,"RenameFlyoutActor",null,
[444]);class ba{constructor(Ua,nb,Ha,sb,Qb){this.QGc=Qb;this.bae=Ha;this.aae=sb;this.Gzg=Ua;this.sqa=nb}get ez(){return this.QGc.value}L2e(){if(!this.aae())return 5;if(this.sqa())return 1;if(this.ez){if(this.bae&&!this.ez.hKe)return 3;if(!this.bae&&!this.ez.gvb)return 4}return this.Gzg()?0:2}}Object(n.a)(ba,"RenameProps",null,[443]);a(187);var ua=a(99);class wa{constructor(Ua,nb,Ha,sb,Qb,mb){this.cn=!1;this.PMc=new ua.a;this.WVa=nb;this.QL=Ha;this.Vng=sb;this.nb=Qb;this.Kie=mb}enable(){this.cn||(this.zdg(),
this.eVd(),this.cn=!0)}generateKey(Ua,nb,Ha){return String.format("{0}/{1}/{2}",Ha,Ua,nb)}wRh(){const Ua=r.a.Fq(this.WVa().jn);return this.generateKey(this.WVa().breadcrumbFolderName,this.WVa().breadcrumbFolderUrl,Ua)}xRh(Ua,nb,Ha){return Ua&&nb?this.generateKey(Ua,nb,Ha):Ha}rgh(Ua,nb,Ha){return Ua&&Ua!==this.WVa().breadcrumbFolderName||nb&&nb!==this.WVa().breadcrumbFolderUrl?!0:Ha!==r.a.Fq(this.WVa().jn)}zdg(){const Ua=this.wRh();this.PMc.ia(Ua,new Date)}wEd(Ua){this.vxj(Ua)&&this.gle(Ua)}vxj(Ua){const nb=
this.Vng();return nb?this.Kie&&this.Kie.Qzb||!nb.Def||!w.AFrameworkApplication.vJa?(this.Y7f(Ua),this.cn=!1):!0:!1}KEf(Ua,nb,Ha,sb){const Qb=this.rgh(Ua,nb,Ha);Ua=this.xRh(Ua,nb,Ha);nb=this.PMc.Cc(Ua).returnValue;Qb&&!nb&&(this.E6e(sb),d.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.evd));Qb||this.PMc.ia(Ua,this.QL())}}Object(n.a)(wa,"ARenamedFileChecker",null,[411]);class ia extends wa{constructor(Ua,nb,Ha,sb,Qb,mb,Pb,gc){super(Ua,nb,Ha,sb,Qb,mb);this.Ufe=Qb;this.ewg=Pb;this.Crg=
gc}get evd(){return"RenamedFileCheckerUsingSettingsRefresh"}eVd(){this.Ufe.MVc(Object(c.a)(this,this.p7e,"handleSettingsRefresh"))}p7e(Ua,nb){nb&&nb.QDb&&nb.IFi&&(nb.z7a("BreadcrumbDocName")||nb.z7a("BreadcrumbFolderName")||nb.z7a("BreadcrumbFolderUrl")||nb.z7a("DirectInvokeDAVUrl")||nb.z7a("EditDocInClientUrl"))&&(d.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.evd),this.wEd(nb))}Y7f(){this.Ufe.wcj(Object(c.a)(this,this.p7e,"handleSettingsRefresh"))}gle(Ua){if(Ua&&Ua.QDb){const nb=
Ua.QDb;this.KEf(nb.Xa("BreadcrumbFolderName"),nb.Xa("BreadcrumbFolderUrl"),nb.Xa("BreadcrumbDocName"),Ua)}}E6e(Ua){const nb={OperationResult:0,classId:1};Ua=Ua.QDb;nb.BreadcrumbFolderName=Ua.Xa("BreadcrumbFolderName");nb.BreadcrumbFolderUrl=Ua.Xa("BreadcrumbFolderUrl");nb.DirectInvokeDavUrl=Ua.Xa("DirectInvokeDAVUrl");nb.EditDocInClientUrl=Ua.Xa("EditDocInClientUrl");Ua=Ua.Xa("BreadcrumbDocName");nb.NewName=w.AFrameworkApplication.cua?Ua:r.a.Fq(Ua);this.Crg.execute(Ha=>{this.aei(nb,Ha)})}aei(Ua,nb){this.ewg().vFb(Ua,
nb)}}Object(n.a)(ia,"RenamedFileCheckerUsingSettingsRefresh",wa,[]);class xa extends wa{constructor(Ua,nb,Ha,sb,Qb,mb,Pb,gc,Xb,Ca){super(Ua,Ha,sb,Qb,mb,Xb);this.jlb=this.gYb=null;this.kvg=nb;this.La=Pb;this.he=gc;Ca&&Ca.execute(ra=>{this.L9i(ra)})}get evd(){return"RenamedFileCheckerUsingTask"}L9i(Ua){this.gYb=Ua;this.gYb.NHg(Object(c.a)(this,this.sjd,"handleVisibilityChange"))}sjd(Ua,nb){!this.cn||0!==nb.newState&&1!==nb.newState||this.jlb||(this.eVd(),this.wEd(this.jlb))}eVd(){this.jlb=new Y.a(3,
2,this.kvg(),Object(c.a)(this,this.wEd,"performRenameFileCheckTick"),89);this.he.Fg(this.jlb)}Y7f(Ua){this.he.jp(Ua)}gle(Ua){this.gYb&&2===this.gYb.DZj?this.L$i(Ua):w.AFrameworkApplication.vJa(Object(c.a)(this,this.Ioc,"onRefreshFilenameSuccess"),Object(c.a)(this,this.Hoc,"onRefreshFilenameFailure"),!0)}L$i(Ua){this.he.jp(Ua);this.jlb=null}Ioc(Ua){Ua&&this.KEf(Ua.BreadcrumbFolderName,Ua.BreadcrumbFolderUrl,Ua.NewName,null)}E6e(){this.La.processAction(y.a.fileNameUpdate,2)}Hoc(){}}Object(n.a)(xa,"RenamedFileCheckerUsingTask",
wa,[]);var gb=a(94);class va{constructor(){this.nb=this.gb=null}get name(){return"Common.App.RenameFile"}Wh(Ua){this.gb=Ua;this.nb=w.AFrameworkApplication.fa;this.gb.register(ka,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Fc(()=>new ka(w.AFrameworkApplication.vb,this.gb.zMd("Common.App.Rename.IRenameDialogFactory"))).wc();this.gb.register(Ra,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Fc(()=>new Ra(w.AFrameworkApplication.vb)).wc();
this.gb.register(411,"Common.App.Rename.IRenamedFileChecker").Fc(()=>this.B$g()).wc();this.gb.register(ca,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Fc(()=>new ca(w.AFrameworkApplication.vb,gb.FocusManager.instance())).wc()}B$g(){if(this.nb.qa("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const Ua=this.gb.yh("Common.IRefreshableAppSettings");if(Ua&&Ua.Iqd)return new ia(()=>Ua.qd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>w.AFrameworkApplication.nm,()=>
new Date,()=>w.AFrameworkApplication.ez,Ua,this.gb.yh("Common.ISessionStatus"),()=>ta.instance,this.gb.Ub("Postmessage.IHostPostmessenger"))}return new xa(()=>this.nb.qd("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>this.nb.qd("RenamedFileCheckerPingIntervalInMs",12E4),()=>w.AFrameworkApplication.nm,()=>new Date,()=>w.AFrameworkApplication.ez,w.AFrameworkApplication.fa,w.AFrameworkApplication.vb,w.AFrameworkApplication.Hi,this.gb.yh("Common.ISessionStatus"),this.gb.Ub("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.nb.qv(Object(c.a)(this,
this.zB,"onFullAppSettingsReady"))}zB(){const Ua=w.AFrameworkApplication.ta.Oa.ps;w.AFrameworkApplication.r7a()&&L.instance.initialize(w.AFrameworkApplication.I9b,Ua?null:w.AFrameworkApplication.d2a,Ua?null:w.AFrameworkApplication.WKd||CommonUIStrings.l_RenameFileTooltip)&&(this.gb.register(ba,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Fc(()=>new ba(()=>w.AFrameworkApplication.userCanRename,()=>w.AFrameworkApplication.isReadOnlyRecommended,w.AFrameworkApplication.Gtc,w.AFrameworkApplication.r7a,
new b.a(()=>w.AFrameworkApplication.ez))).wc(),ta.instance.Ig(),this.nb.qa("RenameDialogIsEnabled")&&(this.gb.resolve("Common.App.Rename.RenameDialogFactory").initialize(w.AFrameworkApplication.nm,w.AFrameworkApplication.I9b),this.gb.resolve("Common.App.Rename.IRenameDialogActor").Ig()),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").Ig(),w.AFrameworkApplication.Gtc&&this.gb.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.gb.resolve("Common.App.Rename.IRenameFlyoutActor").hEg())}dispose(){}}
Object(n.a)(va,"PackageManager",null,[3,4]);var sa=a(247);a.d(C,"a",function(){return ab});const ab=()=>{Type.registerNamespace("Common.App.Rename");sa.a.instance.Gi(new va,7)}},1442:function(n,C,a){a.r(C);n=a(1140);var c=a(9);C=a(0);var b=a(694),d=a(50),f=a(37),e=a(4),k=a(59),l=a(183),m=a(25),u=a(55);class t{constructor(ta){this.renameFileManager=ta}executeCommand(ta,K,na){switch(K.command){case m.a.Nha:return k.a.wg.ps?2!==e.AFrameworkApplication.vb.de(m.a.Nha,2,na)?u.Task.Ta(!0):l.a(K.command):
l.a(K.command);case 1897077126:return this.renameFileManager.renameFile(na,K),u.Task.Ta(!0);default:return l.a(K.command)}}Ac(ta,K,na,P){switch(K.command){case m.a.Nha:return k.a.wg.ps;case 1897077126:return!!P&&2===P.$y}return!1}Oc(){return!1}Lc(){return!1}dispose(){this.renameFileManager=null}}Object(C.a)(t,"RenameFileCommandHandler",null,[164,10]);class w extends b.a{constructor(ta){super(ta)}vd(){const ta=d.GetServiceTaskFactory.create(this.$.da,119,this.la,this.fb);f.TaskExtensions.Aa(ta,()=>
{this.$c([new t(ta.result)])},this.la,3)}static ka(ta){b.a.Od(118,new w(ta))}}Object(C.a)(w,"RenameFileCommandHandlerFactory",b.a,[]);var r=a(86),v=a(222),y=a(226),x=a(15),B=a(30),z=a(78),A=a(377),I=a(77),F=a(370),U=a(171),X=a(90),T=a(282),G=a(1),D=a(22),J=a(281);class L{constructor(ta){this.$=ta}get Def(){return this.$.workbookContext.FileCoauthorable}get Qzb(){return!1}get gvb(){return this.$.ea.amIAlone}get hKe(){if(this.gvb)return!0;for(const ta of this.$.ea.Rm)if(!ta.SupportsRename)return!1;
return!0}}Object(C.a)(L,"EwaCoauthManager",null,[561]);var H=a(61),R=a(68);class Q extends z.a{constructor(ta,K){super();this.dda=this.VKd=this.zSf=this.k6c=null;this.Xja=()=>{var na=this.$.ea.Eo;if(na&&na.WorkbookFileName){var P=B.a.Fq(na.WorkbookFileName),ka=!!D.a.compare(this.$.workbookContext.WorkbookFileName,na.WorkbookFileName,!1),pa=G.EwaSettings.ma(535)&&!!na.BreadcrumbFolderUrl&&!!D.a.compare(this.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,na.BreadcrumbFolderUrl,!1);if(ka||pa)this.dda=
{},this.dda.NewFileName=P,this.dda.EditDocInClientUrl=na.EditDocInClientUrl,this.dda.DirectInvokeDAVUrl=na.DirectInvokeDAVUrl,this.dda.DownloadACopyUrl=na.DownloadACopyUrl,G.EwaSettings.ma(535)&&na.BreadcrumbFolderUrl&&(this.dda.BreadcrumbFolderName=na.BreadcrumbFolderName,this.dda.BreadcrumbFolderUrl=na.BreadcrumbFolderUrl),na=e.AFrameworkApplication.vb.de(m.a.fileNameUpdate,2,P),this.dda=null,x.ULS.shipAssertTag(537154064,0,32===na,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};
this.TJi=(na,P,ka)=>{this.zSf=P;this.VKd=ka;this.$.Ka.Lb(new X.a(1897077126,I.a.Gb,2,3,null),{["newFileName"]:na})};this.SJi=na=>{this.dda&&na(this.M2e(this.dda),this.ks)};this.vFb=na=>{T.a(na)||!na.Result?(na=Q.gHh(na),R.a(this.$).kd.gM([-414480287,650565124,-782844485,1223808266,-62451516,1636785843]),this.VKd(na)):this.zSf(this.M2e(na.Result),this.ks)};this.AQi=()=>{this.VKd(5)};this.$=ta;this.ks=K;this.$.ea.Vu(this.Xja)}initialize(){e.AFrameworkApplication.j9b=this.TJi;e.AFrameworkApplication.vJa=
this.SJi;this.k6c=e.AFrameworkApplication.ez;e.AFrameworkApplication.ez=new L(this.$)}dispose(){e.AFrameworkApplication.j9b=null;e.AFrameworkApplication.vJa=null;this.$.ea.Sw(this.Xja);e.AFrameworkApplication.ez=this.k6c;this.$=this.k6c=null;super.dispose()}renameFile(ta,K){const na=ta.newFileName;if(na){const P=this.$.pa.va.Tb();F.a(this.$.userOperationManager,(ka,pa,Na)=>{var Z=this.$.pa.va;ka=J.b(ka,this.vFb);pa=J.a(pa,this.AQi);const Ra=Z.Na(9,P);Ra.newFileName=na;return H.g(Z,"RenameFile",Ra,
ka,pa,Na,null,0)},ka=>new U.a(134,0,ka),K)}}rgi(){return 32===e.AFrameworkApplication.vb.processAction(m.a.Nha,1)}M2e(ta){var K=this.$.workbookContext;e.AFrameworkApplication.OY=ta.DownloadACopyUrl;const na=G.EwaSettings.ma(535)&&!!ta.BreadcrumbFolderUrl;na&&(e.AFrameworkApplication.nm.breadcrumbFolderName=ta.BreadcrumbFolderName,e.AFrameworkApplication.nm.breadcrumbFolderUrl=ta.BreadcrumbFolderUrl,K.FullDocumentInfo.BreadcrumbFolderUrl=ta.BreadcrumbFolderUrl,K.FullDocumentInfo.BreadcrumbFolderName=
ta.BreadcrumbFolderName);K.FullDocumentInfo.BreadcrumbDocName=ta.NewFileName;A.d(K,ta.NewFileName);K={};K.NewName=ta.NewFileName;K.DirectInvokeDavUrl=ta.DirectInvokeDAVUrl;K.EditDocInClientUrl=ta.EditDocInClientUrl;na&&(K.BreadcrumbFolderName=ta.BreadcrumbFolderName,K.BreadcrumbFolderUrl=ta.BreadcrumbFolderUrl);K.OperationResult=0;return K}static gHh(ta){switch(ta.Errors[0].MessageId){case -414480287:ta=2;break;case 650565124:ta=1;break;case 1636785843:ta=6;break;case -782844485:ta=4;break;default:ta=
5}return ta}}Object(C.a)(Q,"RenameFileManager",z.a,[524,10]);var O=a(51);class V extends v.a{constructor(ta){super();this.DY=this.renameFileManager=null;this.$=ta;this.Eb()}create(){if(!this.DY){const ta=y.a.p1a(O.b(),this.la,"Task","IRenameFileManager");this.DY=ta.task;const K=d.GetServiceTaskFactory.create(this.$.da,137,this.la,this.fb),na=d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb);f.TaskExtensions.Aa(f.TaskExtensions.Td([na,K],this.la),()=>{const P=new Q(this.$,K.result);this.$.da.Ga(120,
P);ta.setResult(P)},this.la,3)}this.DY.continueWith(ta=>{this.pb(ta.result)})}dispose(){r.a.Ia(this.renameFileManager);this.$=this.renameFileManager=null;super.dispose()}static ka(ta){ta.da.Ga(119,new V(ta))}}Object(C.a)(V,"RenameFileManagerServiceFactory",v.a,[]);class W{constructor(ta){this.gi=ta}Lc(){return!1}executeCommand(ta,K,na){return 2!==this.gi.de(m.a.w5f,2,na)?u.Task.Ta(!0):l.a(K.command)}Ac(ta,K){return 1204860550===K.command}Oc(){return!1}}Object(C.a)(W,"RenameFileDialogCommandHandler",
null,[164]);class da extends b.a{constructor(ta){super(ta)}vd(){f.TaskExtensions.Aa(d.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb),()=>{this.$c([new W(e.AFrameworkApplication.vb)])},this.la,3)}static ka(ta){b.a.Od(131,new da(ta))}}Object(C.a)(da,"RenameFileDialogCommandHandlerFactory",b.a,[]);Type.registerNamespace("_Ewa");Object(n.a)();(()=>{c.a.Fa(ta=>{V.ka(ta);w.ka(ta)})})();c.a.Fa(da.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.rn.js.map/d7a52f898c05a0bd02dfdfd5422ed633/EwaDSEsNext.rn.js.map