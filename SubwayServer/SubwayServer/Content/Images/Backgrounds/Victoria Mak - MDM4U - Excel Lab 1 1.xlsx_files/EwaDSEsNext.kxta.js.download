'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1093:function(n,C,a){a.r(C);a.d(C,"InsightsMenuItemFactory",function(){return f});n=a(0);var c=a(701),b=a(311),d=a(30);class f{constructor(e=null){this.Wrg=e||CommonUIStrings.l_InsightsButtonText}get nRa(){return 10}YP(e){var k=e.Qz;e=c.a.k5()?c.a.tta(k,1):c.a.P4c(k);k=String.format(this.Wrg,k);return this.yGh(e,k)}yGh(e,k){return b.a(f.Dbf,c.a.k5()?"1914896509":"3317204163",d.a.nf(k),c.a.Eci,null,d.a.nf(e),
d.a.nf(k),null,null)}}f.Dbf="bInsights";Object(n.a)(f,"InsightsMenuItemFactory",null,[477])},1094:function(n,C,a){a.d(C,"a",function(){return d});n=a(0);var c=a(311),b=a(30);class d{constructor(f,e,k,l,m){this.BWb=f;this.AWb=e;this.Pyg=k;this.nrg=l;this.p9d=m}get nRa(){return 4}YP(f,e=null){e=e.sessionId+"|"+e.fV+"|"+f.Qz;if(this.p9d||this.nrg){let k=this.p9d||b.a.nea(CommonUIStrings.l_HelpTooltip)===b.a.nea(f.Qz.trim());if(this.Pyg&&2<f.Qz.length){const l=f.Qz;";"===l.charAt(0)&&";"===l.charAt(l.length-
1)&&l.substring(1,l.length-1)===d.fkd&&(k=!0)}f=k?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,f.Qz);return this.WWe(e,b.a.nf(f),k)}return this.WWe(e,b.a.nf(String.format(CommonUIStrings.l_TextWithQuotation,f.Qz)),!1)}WWe(f,e,k){return c.a(d.fkd,k?this.AWb:this.BWb,e,"OfficeAssistant_16x16x32","A0",b.a.nf(f),e,null,null)}}d.fkd="bSearchHelp";Object(n.a)(d,"AssistanceMenuItemFactory",null,[477])},1095:function(n,C,a){a.d(C,"a",function(){return e});
n=a(0);var c=a(4),b=a(311),d=a(151),f=a(30);class e{get nRa(){return 13}YP(){return e.ORg()}static ORg(){return b.b(e.HUe,"798637440",f.a.nf(CommonUIStrings.l_LookupFirstRunExperienceTitle),c.AFrameworkApplication.pB,d.getImageClass("Info_32x32x32"),null,null,f.a.nf(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,f.a.nf(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}e.HUe="bTellMeFirstRun";Object(n.a)(e,"FirstRunMenuItemFactory",null,[477])},1096:function(n,
C,a){a.d(C,"a",function(){return f});n=a(0);var c=a(4),b=a(311),d=a(30);class f{constructor(e=null,k=null){this.gde=e;this.rug=k||CommonUIStrings.l_LookupNoResultsDescription}get nRa(){return 14}YP(e){e=String.format(this.rug,e.Qz);return this.qSg(e)}qSg(e){return b.b(f.Btf,"798637440",d.a.nf(CommonUIStrings.l_LookupNoResultsTitle),this.gde?c.AFrameworkApplication.pB:null,this.gde,null,null,d.a.nf(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,d.a.nf(e),null,null)}}f.Btf="lookupNoResults";
Object(n.a)(f,"NoCommandsFoundMenuItemFactory",null,[477])},1097:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b,d){this.FontWeight=0;this.Text=null;this.FontWeight=b;this.Text=d}}Object(n.a)(c,"LabelFormatted",null,[])},1098:function(n,C,a){a.d(C,"a",function(){return k});n=a(0);a(706);var c=a(709),b=a(711),d=a(710),f=a(701),e=a(30);class k{constructor(l){this.Wa=l}Xx(){return"Assistance"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:this.Wa.TFb?3:2}wv(l,m,u=!1,t,w=null){t=
new d.a(l);if((!w||Array.contains(w,8))&&!f.a.mD(l)){w=new b.a(8);if(u){u=e.a.nea(CommonUIStrings.l_HelpTooltip)===e.a.nea(l.Gd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.Gd);const r=[];this.Wa.Axa&&(this.Wa.NSd||r.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),u=this.u1e(l.Gd));const v="||"+l.Gd;r.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",u));r.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",
v));appChrome.api.dispatch(r);l=new c.a("GetHelpFromTellMe",4,l.Gd,null,1)}else l=new c.a("bSearchHelp",4,l.Gd,null,1);w.Qn(l);w.displayName=CommonUIStrings.l_HelpButtonTitle;t.Km(w)}m.resultsUpdated(t)}bwa(l,m=null){const u=new b.a(8),t=e.a.nea(CommonUIStrings.l_HelpTooltip)===e.a.nea(l.Gd.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,l.Gd);for(let r=0;r<m.length&&2>r;r++){var w=void 0;w=[];let v="GetHelpWithDescriptionFromTellMe"+(r+1).toString(),
y=4;if(this.Wa.kMb)w.push(appChrome.actions.setControlLabel(v,t)),w.push(appChrome.actions.setCompoundButtonCommandValueId(v,l.Gd)),w.push(appChrome.actions.updateCompoundButtonDescription(v,this.c_h(m.length)));else if(this.Wa.lMb){let x=this.F4e(m[r]);v="GetHelpFromTellMe"+(r+1).toString();this.Wa.Axa&&(x=this.u1e(x));y=9;w.push(appChrome.actions.setControlLabel(v,x));w.push(appChrome.actions.setButtonCommandValueId(v,this.a_h(m[r])))}appChrome.api.dispatch(w);w=new c.a(v,y,null,null,0);w.label=
this.F4e(m[r]);w.description=this.$Zh(m[r]);u.Qn(w);if(this.Wa.lMb)break}u.displayName=CommonUIStrings.l_HelpButtonTitle;return u}c_h(l){return 1===l?String.format(CommonUIStrings.l_SearchResultText,l):String.format(CommonUIStrings.l_SearchResultsText,l)}u1e(l){return this.Wa.Hrd?f.a.dfd(l,CommonUIStrings.l_HelpScopedButtonText):l+CommonUIStrings.l_HelpScopedButtonText}F4e(l){return l.name?l.name:""}$Zh(l){return l.description?l.description:""}a_h(l){return l.id?"AssetID="+l.id:""}}Object(n.a)(k,
"AssistanceResultsProvider",null,[478])},1099:function(n,C,a){a.d(C,"a",function(){return l});n=a(0);a(706);var c=a(709),b=a(711),d=a(710),f=a(702),e=a(701),k=a(914);class l{constructor(m){this.Wa=m}Xx(){return"Image"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:3===this.Wa.Rl?3:2}wv(m,u,t,w,r=null){t=new d.a(m);(!r||Array.contains(r,19))&&e.a.mD(m)&&this.Wa.Hy&&this.bwa(m,t,1);u.resultsUpdated(t)}bwa(m,u,t,w=null){var r=[];let v;f.TellMeActor.instance.Wx()&&f.TellMeActor.instance.Wx().Axa?(v=this.Wa.Hrd?
e.a.dfd(m.Gd,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):m.Gd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,this.Wa.NSd||r.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):v=this.Wa.Hy?e.a.mD(m)?this.Wa.jsa?e.a.kva(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.Wa.jsa?e.a.kva(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,m.Gd)):
String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,m.Gd):this.Wa.Hdb?CommonUIStrings.l_TellMeImageSuggestionButtonText:m.Gd+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;this.Wa.q4?(f.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",v)),r=e.a.tta(m.Gd,9,Object.assign(new k.a,{landingTab:"Image"})),f.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",r))):(r.push(appChrome.actions.setControlLabel("ImageForSearch",
v)),m=e.a.tta(m.Gd,9,Object.assign(new k.a,{landingTab:"Image"})),r.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",m)),appChrome.api.dispatch(r));t=new c.a("ImageForSearch",12,null,null,t);w&&(t.score=w.ConfidenceScore);w=new b.a(19,this.Wa.Hdb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);w.Qn(t);u.Km(w)}}Object(n.a)(l,"ImageResultsProvider",null,[478])},1100:function(n,C,a){a.d(C,"a",function(){return k});n=a(0);a(706);var c=a(709),b=a(711),d=a(710),f=
a(701),e=a(4);class k{constructor(l){this.Wa=l}Xx(){return"Template"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:3}wv(l,m){l=new d.a(l);m.resultsUpdated(l)}bwa(l,m,u){var t=[];let w;w=this.Wa.Hy?this.Wa.jsa?f.a.kva(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,l.Gd)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,l.Gd):String.format(CommonUIStrings.l_TellMeTemplateButtonText,l.Gd);t.push(appChrome.actions.setControlLabel("TemplateForSearch",w));t.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",
String.format(e.AFrameworkApplication.fa.Xa("TellMeTemplateProviderURL"),e.AFrameworkApplication.uiCulture,l.Gd)));appChrome.api.dispatch(t);l=new b.a(23);l.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;t=new c.a("TemplateForSearch",24,null,null,0);t.label=u[0].Title?u[0].Title:"";t.description=u[0].Description?u[0].Description:"";l.Qn(t);m.Km(l)}}Object(n.a)(k,"TemplateResultsProvider",null,[478])},1101:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.eAc=
this.fba=this.twa=this.Pm=this.z1b=this.Mr=this.QUa=0}}Object(n.a)(c,"TRIESCAN",null,[])},1133:function(n,C,a){a.r(C);var c=a(0),b=a(706),d=a(776),f=a(729),e=a(943);class k{constructor(Ta,zb){this.fmg=Ta;this.Ai=zb}resultsUpdated(Ta){this.fmg.Bsj(this.Ai,Ta)}}Object(c.a)(k,"AggregatorResultsProviderCallback",null,[488]);var l=a(711),m=a(710);class u{constructor(Ta){this.jX=null;this.Wa=Ta;this.Wa.AGa&&(this.jX=null)}Xx(){return"AppsForOffice"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,
zb,cc,Bc,Zc=null){cc=new m.a(Ta);if(!Zc||Array.contains(Zc,1))Zc=new l.a(1),this.jX.yZj(Zc,Ta.Gd),cc.Km(Zc);zb.resultsUpdated(cc)}}Object(c.a)(u,"AppsForOfficeRecommendationResultsProvider",null,[478]);var t=a(1098),w=a(697),r=a(718),v=a(414);class y{constructor(Ta,zb){this.Da=Ta;this.Dxi=zb}isMatch(Ta,zb){if(!Object(v.a)(631,Ta))throw Error.argument("objToTest","Expected feature bundle");let cc;return({value:cc}=Ta.Vi(this.Da.gY)).returnValue?this.Da.m0d.isMatch(cc,zb):this.Dxi}}Object(c.a)(y,"AnnotatedWithAndValueMatchesAnnotationFilter",
null,[701]);class x{constructor(Ta,zb){this.Da=Ta;this.awd=zb}isMatch(Ta){if(!Object(v.a)(631,Ta))throw Error.argument("objToTest","Expected feature bundle");return!!(this.awd^Ta.Vi(this.Da.gY).returnValue)}}Object(c.a)(x,"AnnotatedWithAnnotationFilter",null,[701]);class B{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if(!Object(v.a)(633,Ta))throw Error.argument("objToTest","Expected struct value");return this.Da.m0d.isMatch(Ta.xva(this.Da.fieldIndex),zb)}}Object(c.a)(B,"FieldValueMatchesStructFilter",
null,[701]);class z{constructor(Ta,zb){Ta&&(this.fieldIndex=Ta.na(0),this.m0d=zb.UU(Ta.na(1)))}}Object(c.a)(z,"FieldValueMatchesStructFilterInit",null,[]);class A{constructor(Ta){this.awd=Ta}isMatch(Ta){if(!Object(v.a)(631,Ta))throw Error.argument("objToTest","Expected feature bundle");return!!(this.awd^Ta.ujd)}}Object(c.a)(A,"HasAnnotationsAnnotationFilter",null,[701]);class I{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb){if(!Object(v.a)(632,Ta))throw Error.argument("objToTest","Expected list value");
switch(this.FK){case 0:for(const cc of Ta.items)if(this.Da.filter.isMatch(cc,zb))return!0;return!1;case 1:for(const cc of Ta.items)if(!this.Da.filter.isMatch(cc,zb))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(I,"ItemTestListFilter",null,[701]);class F{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if(!Object(v.a)(632,Ta))throw Error.argument("objToTest","Expected list value");return this.Da.filter.isMatch(Ta.items.length,zb)}}Object(c.a)(F,"LengthMatchesListFilter",null,[701]);
class U{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb,cc=null){let Bc=0===this.FK;for(const Zc of this.Da.vze)if((Bc=Zc.isMatch(Ta,zb,cc))?1===this.FK:0===this.FK)return Bc;2===this.FK&&(Bc=!Bc);return Bc}}Object(c.a)(U,"NonterminalFilter",null,[701]);class X{constructor(Ta,zb){if(Ta){var cc=Ta.na(0);this.vze=Array(cc);for(let Bc=0;Bc<cc;++Bc)this.vze[Bc]=zb.UU(Ta.na(1+Bc))}}}Object(c.a)(X,"NonterminalFilterInit",null,[]);class T{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb){if("number"!==
typeof Ta)throw Error.argument("objToTest","Expected number value");let cc=this.Da.number;if(this.Da.query){zb=this.Da.query.zk(null,zb);if("number"!==typeof zb)throw Error.invalidOperation("Query did not return number");cc+=zb}switch(this.FK){case 0:return Ta===cc;case 1:return Ta<cc;case 2:return Ta<=cc;case 3:return Ta>cc;case 4:return Ta>=cc;default:throw Error.notImplemented();}}}Object(c.a)(T,"NumberFilter",null,[701]);class G{constructor(Ta,zb){Ta&&(this.number=Ta.na(0),this.query=Ta.na(1)?
zb.kv(Ta.na(1)):null)}}Object(c.a)(G,"NumberFilterInit",null,[]);class D{constructor(Ta,zb,cc){this.fbc=this.FOh;this.Pxi=Ta;this.opf=zb;this.npf=cc}d0c(Ta){this.opf=Ta}FOh(Ta){if(!Ta)throw Error.argument("name","Invalid named feature bundle reference");const zb=Ta.substr(1);return 1===Ta.charCodeAt(0)&&zb===this.Pxi?this.opf:this.npf?this.npf.fbc(Ta):null}}Object(c.a)(D,"SimpleNamedFeatureBundleResolver",null,[717]);class J{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if(!Object(v.a)(631,Ta))throw Error.argument("objToTest",
"Expected feature bundle");Ta=this.Da.query.zk(null,new D(this.Da.nDc,Ta,zb));if("boolean"!==typeof Ta)throw Error.invalidOperation("Query did not return bool");return Ta}}Object(c.a)(J,"PredicateAnnotationFilter",null,[701]);class L{constructor(Ta,zb){Ta&&(this.nDc=zb.ga(Ta.na(0)),this.query=zb.kv(Ta.na(1)))}}Object(c.a)(L,"PredicateAnnotationFilterInit",null,[]);class H{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if("boolean"!==typeof Ta)throw Error.argument("objToTest","Expected bool value");zb=
this.Da.query.zk(null,zb);if("boolean"!==typeof zb)throw Error.invalidOperation("Query did not return bool");return Ta===zb}}Object(c.a)(H,"QueryBooleanFilter",null,[701]);class R{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb){if("number"!==typeof Ta)throw Error.argument("objToTest","Expected integer");zb=this.Da.query.zk(null,zb);if("number"!==typeof zb)throw Error.invalidOperation("Query did not return an enum value");switch(this.FK){case 0:return Ta===zb;case 1:return 0!==(Ta&zb);case 2:return Ta===
(Ta&zb);case 3:return zb===(Ta&zb);default:throw Error.notImplemented();}}}Object(c.a)(R,"QueryEnumFilter",null,[701]);class Q{constructor(Ta,zb){Ta&&(this.nhc=1===Ta.na(0),this.query=zb.kv(Ta.na(1)))}}Object(c.a)(Q,"QueryEnumFilterInit",null,[]);class O{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb){if(!Object(v.a)(632,Ta))throw Error.argument("objToTest","Expected list value");zb=this.Da.query.zk(null,zb);if(!Object(v.a)(632,zb))throw Error.invalidOperation("Query did not return list value");
if(Ta.hI!==zb.hI)return!1;switch(this.FK){case 0:return w.Annotations.iCa(w.Annotations.dSh(Ta.hI),Ta,zb);case 1:for(const cc of Ta.items)for(const Bc of zb.items)if(w.Annotations.iCa(Ta.hI,cc,Bc))return!0;return!1;case 2:for(const cc of Ta.items)for(const Bc of zb.items)if(!w.Annotations.iCa(Ta.hI,cc,Bc))return!1;return!0;case 3:for(const cc of zb.items)for(const Bc of Ta.items)if(!w.Annotations.iCa(Ta.hI,cc,Bc))return!1;return!0;default:throw Error.notImplemented();}}}Object(c.a)(O,"QueryListFilter",
null,[701]);class V{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta,zb){if("string"!==typeof Ta)throw Error.argument("objToTest","Expected string");zb=this.Da.query.zk(null,zb);if("string"!==typeof zb)throw Error.invalidOperation("Query did not return string");this.Da.Hnd&&(Ta=Ta.toUpperCase(),zb=zb.toUpperCase());switch(this.FK){case 0:return Ta===zb;case 1:return 0<=Ta.indexOf(zb);case 2:return Ta.startsWith(zb);case 3:return Ta.endsWith(zb);case 4:return 0<=zb.indexOf(Ta);case 5:return zb.startsWith(Ta);
case 6:return zb.endsWith(Ta);default:throw Error.notImplemented();}}}Object(c.a)(V,"QueryStringFilter",null,[701]);class W{constructor(Ta,zb){Ta&&(this.query=zb.kv(Ta.na(0)),this.Hnd=1===Ta.na(1))}}Object(c.a)(W,"QueryStringFilterInit",null,[]);class da{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if(!Object(v.a)(633,Ta))throw Error.argument("objToTest","Expected struct value");zb=this.Da.query.zk(null,zb);if(!Object(v.a)(633,zb))throw Error.invalidOperation("Query did not return struct value");return Ta.isEqual(Ta)}}
Object(c.a)(da,"QueryStructFilter",null,[701]);class ta{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){Ta=this.Da.query.zk(null,zb);if("boolean"!==typeof Ta)throw Error.invalidOperation("Query did not return bool");return Ta}}Object(c.a)(ta,"QueryWhereConstraintFilter",null,[701]);class K{constructor(Ta){this.Da=Ta}isMatch(Ta){if("string"!==typeof Ta)throw Error.argument("objToTest","Expected string");return this.Da.NId.test(Ta)}}Object(c.a)(K,"RegexStringFilter",null,[701]);class na{constructor(Ta,zb){Ta&&
(this.NId=zb.H2e(Ta.na(0)))}}Object(c.a)(na,"RegexStringFilterInit",null,[]);class P{constructor(Ta,zb){Ta&&(this.filter=zb.UU(Ta.na(0)))}}Object(c.a)(P,"SingleFilterFilterInit",null,[]);class ka{constructor(Ta,zb){Ta&&(this.query=zb.kv(Ta.na(0)))}}Object(c.a)(ka,"SingleQueryFilterInit",null,[]);class pa{constructor(Ta){this.Da=Ta}isMatch(Ta){if("boolean"!==typeof Ta)throw Error.argument("objToTest","Expected bool value");return Ta===this.Da.value}}Object(c.a)(pa,"StoredValueBooleanFilter",null,[701]);
class Na{constructor(Ta){Ta&&(this.value=1===Ta.na(0))}}Object(c.a)(Na,"StoredValueBooleanFilterInit",null,[]);class Z{constructor(Ta,zb){this.Da=Ta;this.FK=zb}isMatch(Ta){if("number"!==typeof Ta)throw Error.argument("objToTest","Expected integer");switch(this.FK){case 0:return this.Da.nhc?this.Da.value?!!(Ta&this.Da.value):!Ta:Ta===this.Da.value;case 1:return this.Da.nhc?(Ta&this.Da.value)===this.Da.value:32>Ta&&(1<<Ta&this.Da.value)===this.Da.value;case 2:return this.Da.nhc?!!(Ta&this.Da.value):
32>Ta&&!!(1<<Ta&this.Da.value);default:throw Error.notImplemented();}}}Object(c.a)(Z,"StoredValueEnumFilter",null,[701]);class Ra{constructor(Ta){Ta&&(this.nhc=1===Ta.na(0),this.value=Ta.na(1))}}Object(c.a)(Ra,"StoredValueEnumFilterInit",null,[]);class Da{constructor(){this.DWi=null;this.HZc=this.OLa=0}}Object(c.a)(Da,"WHEREConstraintData",null,[]);class Ba{constructor(Ta){this.Da=Ta}isMatch(Ta,zb){if(!Object(v.a)(Da,Ta))throw Error.argument("objToTest","Expected WHERE constraint data");let cc=-1,
Bc=-1;const Zc=Ta.DWi;switch(this.Da.F_c){case 4:cc=Zc.pub;Bc=Zc.CUd;break;case 5:cc=Ta.OLa;Bc=Zc.pub-Ta.OLa;break;case 6:cc=Zc.pub+Zc.CUd;Bc=Ta.OLa+Ta.HZc-cc;break;case 1:case 2:case 3:let nd=!1;for(let sd=Zc.FZj;sd;sd=sd.next)if(this.Da.UUj===sd.name){nd=!0;1===this.Da.F_c?(cc=sd.pub,Bc=sd.CUd):2===this.Da.F_c?(cc=Ta.OLa,Bc=sd.pub-Ta.OLa):(cc=sd.pub+sd.CUd,Bc=Ta.OLa+Ta.HZc-cc);break}if(!nd)return!1;break;case 7:cc=Ta.OLa;Bc=Ta.HZc;break;default:throw Error.notImplemented();}return null!==this.Da.kEj.RZj(Zc.r_j,
cc,Bc,cc,!0,2,zb)}}Object(c.a)(Ba,"SubSreWhereConstraintFilter",null,[701]);class ea{constructor(Ta,zb){if(Ta){var cc=zb.ga(Ta.na(0));this.F_c=cc.charCodeAt(0);this.UUj=cc.substr(1);this.kEj=zb.bXh(Ta.na(1))}}}Object(c.a)(ea,"SubSreWhereConstraintFilterInit",null,[]);class Y{constructor(Ta){this.Da=Ta}isMatch(Ta,zb,cc=null){if(!Object(v.a)(631,Ta))throw Error.argument("objToTest","Expected feature bundle");if(null==cc)throw Error.argumentNull("parentTextForSpan");if(this.Da.cre&&!this.Da.cre.isMatch(Ta,
zb))return!1;if(this.Da.PWd){let Bc;if(({value:Bc}=Ta.Vi(this.Da.PDj)).returnValue){if(!this.Da.PWd.isMatch(Bc,zb))return!1}else{let Zc,nd;if(!({value:Zc}=Ta.Vi(this.Da.K6f)).returnValue||!({value:nd}=Ta.Vi(this.Da.J6f)).returnValue||0>Zc||0>nd||Zc+nd>cc.length||!this.Da.PWd.isMatch(cc.substr(Zc,nd),zb))return!1}}if(this.Da.g7f){let Bc;if(!({value:Bc}=Ta.Vi(this.Da.K6f)).returnValue||!this.Da.g7f.isMatch(Bc,zb))return!1}if(this.Da.Olf){let Bc;if(!({value:Bc}=Ta.Vi(this.Da.J6f)).returnValue||!this.Da.Olf.isMatch(Bc,
zb))return!1}return!0}}Object(c.a)(Y,"TextSpanFilter",null,[701]);class ja{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.K6f=Ta.na(0),this.J6f=Ta.na(1),this.PDj=Ta.na(2),this.PWd=Ta.na(3)?zb.UU(Ta.na(3)):null,this.cre=Ta.na(4)?zb.UU(Ta.na(4)):null,this.g7f=Ta.na(5)?zb.UU(Ta.na(5)):null,this.Olf=Ta.na(6)?zb.UU(Ta.na(6)):null)}}Object(c.a)(ja,"TextSpanFilterInit",null,[]);class ca{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.gY=Ta.na(0),this.m0d=Ta.na(1)?zb.UU(Ta.na(1)):
null)}}Object(c.a)(ca,"ValueFilterAnnotationFilterInit",null,[]);var ba=a(734);class ua{UU(Ta,zb){const cc=Ta.na(0),Bc=new ba.a;Bc.bva(Ta,1,Ta.count-1);switch(cc){case 1:return new U(new X(Bc,zb),0);case 2:return new U(new X(Bc,zb),1);case 3:return new U(new X(Bc,zb),2);case 101:return new K(new na(Bc,zb));case 103:return new V(new W(Bc,zb),0);case 104:return new V(new W(Bc,zb),1);case 105:return new V(new W(Bc,zb),2);case 106:return new V(new W(Bc,zb),3);case 107:return new V(new W(Bc,zb),4);case 108:return new V(new W(Bc,
zb),5);case 109:return new V(new W(Bc,zb),6);case 201:return new pa(new Na(Bc));case 202:return new H(new ka(Bc,zb));case 301:return new T(new G(Bc,zb),0);case 302:return new T(new G(Bc,zb),1);case 303:return new T(new G(Bc,zb),2);case 304:return new T(new G(Bc,zb),3);case 305:return new T(new G(Bc,zb),4);case 401:return new Z(new Ra(Bc),0);case 402:return new Z(new Ra(Bc),1);case 403:return new Z(new Ra(Bc),2);case 404:return new R(new Q(Bc,zb),0);case 405:return new R(new Q(Bc,zb),1);case 406:return new R(new Q(Bc,
zb),2);case 407:return new R(new Q(Bc,zb),3);case 501:return new B(new z(Bc,zb));case 502:return new da(new ka(Bc,zb));case 601:return new I(new P(Bc,zb),0);case 602:return new I(new P(Bc,zb),1);case 603:return new F(new P(Bc,zb));case 604:return new O(new ka(Bc,zb),0);case 605:return new O(new ka(Bc,zb),1);case 606:return new O(new ka(Bc,zb),2);case 607:return new O(new ka(Bc,zb),3);case 701:return new A(!1);case 702:return new A(!0);case 703:return new x(new ca(Bc,zb),!1);case 704:return new x(new ca(Bc,
zb),!0);case 705:return new y(new ca(Bc,zb),!1);case 706:return new y(new ca(Bc,zb),!0);case 707:return new J(new L(Bc,zb));case 901:return new Y(new ja(Bc,zb));case 1002:return new ta(new ka(Bc,zb));case 1001:return new Ba(new ea(Bc,zb));default:throw Error.argument("initData");}}}Object(c.a)(ua,"FilterFactory",null,[690]);var wa=a(704);class ia{constructor(Ta){this.Da=Ta}get Iq(){return this.Da.Iq}get vI(){return this.Da.vI}get Szc(){return this.Da.Szc}get cgc(){return this.Da.cgc}load(Ta,zb){return this.zk(Ta,
Ta?new D("root",Ta,zb):zb)}store(Ta,zb,cc){this.qeb(Ta,zb,Ta?new D("root",Ta,cc):cc,null)}zk(Ta,zb){if(!this.cgc&&!this.Da.annotations.T6a(this.Iq,Ta))throw Error.argument("input","Input value not of expected type");let cc=this.Da.LUe;for(;cc;)Ta=cc.load(Ta,zb),cc=cc.next;return Ta}qeb(Ta,zb,cc,Bc){if(!this.Szc)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.cgc&&!this.Da.annotations.T6a(this.Iq,Ta))throw Error.argument("lvalue","Lvalue not of expected type");
if(!this.Da.annotations.T6a(this.vI,zb))throw Error.argument("rvalue","Rvalue not of expected type");return this.Da.LUe.store(Ta,zb,cc,Bc)}static kBe(Ta,zb,cc,Bc){if(cc===Bc)return zb;if(w.Annotations.Lt(cc)&&w.Annotations.Lt(Bc)){cc=w.Annotations.Cja(cc);Bc=w.Annotations.Cja(Bc);const Zc=new wa.a(Ta,Bc);for(const nd of zb.items)Array.add(Zc.items,ia.kBe(Ta,nd,cc,Bc));return Zc}if(cc===w.Annotations.P7){if(Bc===w.Annotations.YW)return zb;if(Bc===w.Annotations.EL)return zb.toString()}else if(cc===
w.Annotations.YW){if(Bc===w.Annotations.P7)return Math.floor(zb);if(Bc===w.Annotations.EL)return zb.toString()}else if(cc===w.Annotations.EL){if(Bc===w.Annotations.P7)return parseInt(zb);if(Bc===w.Annotations.YW)return parseFloat(zb)}throw Error.invalidOperation("Type conversion failure in query step");}}Object(c.a)(ia,"AnnotationQuery",null,[708]);class xa{constructor(){this.vI=this.Iq=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}Dja(Ta){if(this.next)return{returnValue:this.next,
D7:Ta};if(Ta){const zb=Ta.cDe;Ta=Ta.hKf;return{returnValue:zb,D7:Ta}}return{returnValue:null,D7:Ta}}}Object(c.a)(xa,"AnnotationQueryStep",null,[727]);class gb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=this.Da.query.zk(Ta,zb);if(w.Annotations.Lt(this.Iq)){var cc=w.Annotations.Cja(this.Iq);let Zc=new wa.a(this.Da.annotations,cc);if(w.Annotations.Lt(this.Da.query.vI)){if(Ta.items.length!==zb.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");
for(let nd=0,sd=Ta.items.length;nd<sd;++nd)Array.add(Zc.items,this.L1b(Ta.items[nd],zb.items[nd],cc===w.Annotations.YW))}else for(var Bc of Ta.items)Array.add(Zc.items,this.L1b(Bc,zb,cc===w.Annotations.YW));return Zc}if(w.Annotations.Lt(this.Da.query.vI)){Bc=new wa.a(this.Da.annotations,this.Iq);for(cc of zb.items)Array.add(Bc.items,this.L1b(Ta,cc,this.Iq===w.Annotations.YW));return Bc}return this.L1b(Ta,zb,this.Iq===w.Annotations.YW)}L1b(Ta,zb,cc){Ta=this.W_a(Ta,zb);return cc?Ta:Math.floor(Ta)}}
Object(c.a)(gb,"NumericAnnotationQueryStep",xa,[]);class va extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Ta+zb}}Object(c.a)(va,"AddAnnotationQueryStep",gb,[]);class sa extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){if(this.Iq===w.Annotations.S0&&this.Da.query.vI===w.Annotations.S0){let Zc;if(({result:Zc}=this.yxe(Ta)).returnValue)return Zc}if(w.Annotations.Lt(this.Iq)){var cc=new wa.a(this.Da.annotations,w.Annotations.S0);zb=this.Da.query.zk(Ta,zb);if(w.Annotations.Lt(this.Da.query.vI)){if(Ta.items.length!==
zb.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let Zc=0,nd=Ta.items.length;Zc<nd;++Zc)Array.add(cc.items,this.Wqb(zb.items[Zc],Ta.items[Zc]))}else for(var Bc of Ta.items)Array.add(cc.items,this.Wqb(zb,Bc));return cc}Bc=this.Da.query.zk(Ta,zb);if(w.Annotations.Lt(this.Da.query.vI)){zb=new wa.a(this.Da.annotations,w.Annotations.S0);for(cc of Bc.items)Array.add(zb.items,this.Wqb(cc,Ta));return zb}return this.Wqb(Bc,Ta)}}Object(c.a)(sa,"BinaryBooleanAnnotationQueryStep",
xa,[]);class ab extends sa{constructor(Ta){super(Ta)}yxe(Ta){return{returnValue:!Ta,result:!1}}Wqb(Ta,zb){return Ta&&zb}}Object(c.a)(ab,"AndAnnotationQueryStep",sa,[]);class Ua{constructor(Ta){Ta&&(this.annotations=Ta)}}Object(c.a)(Ua,"AnnotationsOnlyQueryStepInit",null,[]);class nb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=this.Da.query.zk(Ta,zb);Ta=Ta.clone();w.Annotations.Lt(this.Da.query.vI)?Array.addRange(Ta.items,zb.items):Array.add(Ta.items,zb);return Ta}}Object(c.a)(nb,
"AppendAnnotationQueryStep",xa,[]);class Ha extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){if(this.Iq===w.Annotations.TB)return this.executeScript(Ta,zb);const cc=new wa.a(this.Da.annotations,w.Annotations.TB);for(const Bc of Ta.items)Array.add(cc.items,this.executeScript(Bc,zb));return cc}executeScript(Ta,zb){const cc=new r.a(this.Da.annotations);cc.Vha(Ta);Ta=new r.a(this.Da.annotations);this.Da.script.jaa(null,new D("Input",cc,new D("Output",Ta,zb)));return Ta}}Object(c.a)(Ha,"ApplyAnnotationQueryStep",
xa,[]);class sb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){if(this.Iq===w.Annotations.TB)return zb=this.executeScript(Ta,zb),zb.Vi(this.Da.are).returnValue||new wa.a(this.Da.annotations,w.Annotations.TB),zb;const cc=new wa.a(this.Da.annotations,w.Annotations.TB);for(const Bc of Ta.items)if(Ta=this.executeScript(Bc,zb),({value:Ta}=Ta.Vi(this.Da.are)).returnValue)for(const Zc of Ta.items)Array.add(cc.items,Zc);return cc}executeScript(Ta,zb){const cc=new r.a(this.Da.annotations);cc.Vha(Ta);
Ta=new r.a(this.Da.annotations);this.Da.script.jaa(null,new D("Input",cc,new D("Output",Ta,zb)));return Ta}}Object(c.a)(sb,"ApplyExpandAnnotationQueryStep",xa,[]);class Qb{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.script=zb.hKa(Ta.na(0)),this.are=Ta.na(1))}}Object(c.a)(Qb,"ApplyExpandQueryStepInit",null,[]);class mb{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.script=zb.hKa(Ta.na(0)))}}Object(c.a)(mb,"ApplyQueryStepInit",null,[]);class Pb extends xa{constructor(Ta){super();
this.Da=Ta}load(Ta){if(this.Iq===w.Annotations.TB)return this.hkc(Ta);const zb=new wa.a(this.Da.annotations,this.Da.annotations.getAttributeType(this.Da.gY));for(const cc of Ta.items)Array.add(zb.items,this.hkc(cc));return zb}store(Ta,zb,cc,Bc){if(this.Iq===w.Annotations.TB){var Zc=zb,nd=({D7:Bc}=this.Dja(Bc)).returnValue;nd&&(Zc=nd.store(w.Annotations.XA(this.hkc(Ta)),zb,cc,Bc));Ta.Hn(this.Da.gY,Zc)}else{var sd=zb;if(Zc=({D7:Bc}=this.Dja(Bc)).returnValue){sd=new wa.a(this.Da.annotations,this.Da.annotations.getAttributeType(this.Da.gY));
for(nd of Ta.items)Array.add(sd.items,this.hkc(nd));sd=Zc.store(sd,zb,cc,Bc)}zb=sd;if(zb.items.length!==Ta.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let h=0,Hb=Ta.items.length;h<Hb;++h)cc=Ta.items[h],cc.isReadOnly&&(cc=cc.clone(),Ta.items[h]=cc),cc.Hn(this.Da.gY,zb.items[h])}return Ta}hkc(Ta){({value:Ta}=Ta.Vi(this.Da.gY)).returnValue||(Ta=this.Da.annotations.dJh(this.Da.gY));return Ta}}Object(c.a)(Pb,"AttrAnnotationQueryStep",xa,[]);class gc{constructor(Ta,
zb){Ta&&(this.annotations=zb,this.gY=Ta.na(0))}}Object(c.a)(gc,"AttrQueryStepInit",null,[]);class Xb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){const zb=new r.a(this.Da.annotations);zb.Vha(Ta);return this.Da.module.execute(zb)}}Object(c.a)(Xb,"CallModuleAnnotationQueryStep",xa,[]);class Ca{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.module=zb.Tfd(Ta.na(0)))}}Object(c.a)(Ca,"CallModuleQueryStepInit",null,[]);class ra extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,
zb){if(w.Annotations.Lt(this.Iq)){var cc=this.Da.query.zk(Ta,zb);zb=new wa.a(this.Da.annotations,w.Annotations.EL);let nd="string"===typeof cc;for(var Bc of Ta.items)if(nd)Array.add(zb.items,Bc+cc);else for(var Zc of cc.items)Array.add(zb.items,Bc+Zc);return zb}Bc=this.Da.query.zk(Ta,zb);if("string"===typeof Bc)return Ta+Bc;Zc=new wa.a(this.Da.annotations,w.Annotations.EL);for(cc of Bc.items)Array.add(Zc.items,Ta+cc);return Zc}}Object(c.a)(ra,"ConcatAnnotationQueryStep",xa,[]);class ma extends xa{constructor(Ta){super();
this.Da=Ta}load(Ta){return ia.kBe(this.Da.annotations,Ta,this.Iq,this.vI)}}Object(c.a)(ma,"ConvertAnnotationQueryStep",xa,[]);class hb extends xa{constructor(){super()}load(Ta){return Ta.items.length}}Object(c.a)(hb,"CountAnnotationQueryStep",xa,[]);class vb extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Ta/zb}}Object(c.a)(vb,"DivideAnnotationQueryStep",gb,[]);class Va extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=new D(this.Da.nDc,null,zb);for(const cc of Ta.items)if(zb.d0c(cc),
this.Da.query.zk(cc,zb))return!0;return!1}}Object(c.a)(Va,"ExistsAnnotationQueryStep",xa,[]);class db extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Math.pow(Ta,zb)}}Object(c.a)(db,"ExpAnnotationQueryStep",gb,[]);class oa{constructor(Ta,zb){Ta&&(this.oaa=zb.ga(Ta.na(0)))}}Object(c.a)(oa,"FeatureBundleNameQueryStepInit",null,[]);class Oa extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){if(w.Annotations.Lt(this.Iq)){const zb=new wa.a(this.Da.annotations,this.Da.annotations.VKa(w.Annotations.Cja(this.Iq),
this.Da.fieldIndex));for(const cc of Ta.items)Array.add(zb.items,cc.xva(this.Da.fieldIndex));return zb}return Ta.xva(this.Da.fieldIndex)}store(Ta,zb,cc,Bc){if(w.Annotations.Lt(this.Iq)){var Zc=zb,nd=({D7:Bc}=this.Dja(Bc)).returnValue;if(nd){Zc=new wa.a(this.Da.annotations,this.Da.annotations.VKa(w.Annotations.Cja(this.Iq),this.Da.fieldIndex));for(var sd of Ta.items)Array.add(Zc.items,sd.xva(this.Da.fieldIndex));Zc=nd.store(Zc,zb,cc,Bc)}zb=Zc;if(zb.items.length!==Ta.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");
for(let h=0,Hb=Ta.items.length;h<Hb;++h)cc=Ta.items[h],cc.isReadOnly&&(cc=cc.clone(),Ta.items[h]=cc),cc.OPd(this.Da.fieldIndex,zb.items[h])}else nd=zb,(sd=({D7:Bc}=this.Dja(Bc)).returnValue)&&(nd=sd.store(w.Annotations.XA(Ta.xva(this.Da.fieldIndex)),zb,cc,Bc)),Ta.OPd(this.Da.fieldIndex,nd);return Ta}}Object(c.a)(Oa,"FieldAnnotationQueryStep",xa,[]);class Wa{constructor(Ta,zb){Ta&&(this.annotations=zb,this.fieldIndex=Ta.na(0))}}Object(c.a)(Wa,"FieldQueryStepInit",null,[]);class Sa extends xa{constructor(Ta){super();
this.Da=Ta}load(Ta,zb){for(const cc of Ta.items)if(this.Da.filter.isMatch(cc,zb))return cc;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(Ta,zb,cc,Bc){let Zc=zb,nd=-1;for(let h=0,Hb=Ta.items.length;h<Hb;h++)if(this.Da.filter.isMatch(Ta.items[h],cc)){nd=h;break}if(0>nd)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const sd=({D7:Bc}=this.Dja(Bc)).returnValue;sd&&(Zc=sd.store(w.Annotations.XA(Ta.items[nd]),zb,cc,Bc));
Ta.items[nd]=Zc;return Ta}}Object(c.a)(Sa,"FirstItemMatchingAnnotationQueryStep",xa,[]);class yb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=new D(this.Da.nDc,null,zb);for(const cc of Ta.items)if(zb.d0c(cc),!this.Da.query.zk(cc,zb))return!1;return!0}}Object(c.a)(yb,"ForAllAnnotationQueryStep",xa,[]);class Ma extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){Ta=zb?zb.fbc(this.Da.oaa):null;if(!Ta)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Da.oaa+
'"');return Ta}store(Ta,zb,cc,Bc){Ta=cc?cc.fbc(this.Da.oaa):null;if(!Ta)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Da.oaa+'"');let Zc=zb;const nd=({D7:Bc}=this.Dja(Bc)).returnValue;nd&&(Zc=nd.store(Ta,zb,cc,Bc));Ta!==Zc&&Ta.Vha(Zc);return Ta}}Object(c.a)(Ma,"GetAnnotationQueryStep",xa,[]);class Bb{constructor(Ta,zb){this.Fog=Ta;this.Dvg=zb}get cDe(){return this.Fog}get hKf(){return this.Dvg}}Object(c.a)(Bb,"AnnotationQueryStoreContinuation",null,[871]);class Nb extends xa{constructor(Ta){super();
this.Da=Ta}load(Ta,zb){return this.Da.wAc.zk(Ta,zb)?this.Da.ubg.zk(Ta,zb):this.Da.y9b?this.Da.y9b.zk(Ta,zb):Ta}store(Ta,zb,cc,Bc){var Zc=this.Da.wAc.zk(Ta,cc);this.next&&(Bc=new Bb(this.next,Bc));if(Zc)return this.Da.ubg.qeb(Ta,zb,cc,Bc);if(this.Da.y9b)return this.Da.y9b.qeb(Ta,zb,cc,Bc);Zc=zb;let nd=null;Bc&&(nd=Bc.cDe,Bc=Bc.hKf);nd&&(Zc=nd.store(w.Annotations.XA(Ta),zb,cc,Bc));return Zc}}Object(c.a)(Nb,"IfAnnotationQueryStep",xa,[]);class Ia{constructor(Ta,zb){Ta&&(this.wAc=zb.kv(Ta.na(0)),this.ubg=
zb.kv(Ta.na(1)),this.y9b=Ta.na(2)?zb.kv(Ta.na(2)):null)}}Object(c.a)(Ia,"IfQueryStepInit",null,[]);class jb{constructor(Ta,zb){Ta&&(this.o9h=zb.kv(Ta.na(0)),this.Mjf=zb.kv(Ta.na(1)))}}Object(c.a)(jb,"IndexAndItemQueryStepInit",null,[]);class Ob extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){const cc=this.Da.o9h.zk(Ta,zb);zb=this.Da.Mjf.zk(Ta,zb);Ta=Ta.clone();if(0>cc||cc>Ta.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");if(w.Annotations.Lt(this.Da.Mjf.vI))for(let Bc=
0;Bc<zb.items.length;++Bc)Array.insert(Ta.items,cc+Bc,zb.items[Bc]);else Array.insert(Ta.items,cc,zb);return Ta}}Object(c.a)(Ob,"InsertAtAnnotationQueryStep",xa,[]);class Jb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){return!(!zb||!zb.fbc(this.Da.oaa))}}Object(c.a)(Jb,"IsDefinedAnnotationQueryStep",xa,[]);class Kb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=this.Xvb(Ta,zb);return Ta.items[zb]}store(Ta,zb,cc,Bc){const Zc=this.Xvb(Ta,cc);let nd=zb;const sd=({D7:Bc}=this.Dja(Bc)).returnValue;
sd&&(nd=sd.store(w.Annotations.XA(Ta.items[Zc]),zb,cc,Bc));Ta.items[Zc]=nd;return Ta}Xvb(Ta,zb){zb=this.Da.query.zk(Ta,zb);if(0>zb||zb>=Ta.items.length)throw Error.invalidOperation("Index out of range in Item store step");return zb}}Object(c.a)(Kb,"ItemAnnotationQueryStep",xa,[]);class Qa extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){const cc=new wa.a(this.Da.annotations,w.Annotations.Cja(this.Iq));for(const Bc of Ta.items)this.Da.filter.isMatch(Bc,zb)&&Array.add(cc.items,Bc);return cc}}
Object(c.a)(Qa,"ItemsMatchingAnnotationQueryStep",xa,[]);class ha extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){zb=this.Xvb(Ta,zb);return Ta.items[Ta.items.length-zb-1]}store(Ta,zb,cc,Bc){const Zc=this.Xvb(Ta,cc);let nd=zb;const sd=({D7:Bc}=this.Dja(Bc)).returnValue;sd&&(nd=sd.store(w.Annotations.XA(Ta.items[Ta.items.length-Zc-1]),zb,cc,Bc));Ta.items[Ta.items.length-Zc-1]=nd;return Ta}Xvb(Ta,zb){zb=this.Da.query?this.Da.query.zk(Ta,zb):0;if(0>zb||zb>=Ta.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");
return zb}}Object(c.a)(ha,"LastItemAnnotationQueryStep",xa,[]);class qa extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){if(w.Annotations.Lt(this.Iq)){const zb=new wa.a(this.Da.annotations,w.Annotations.P7);for(const cc of Ta.items)Array.add(zb.items,cc.length);return zb}return Ta.length}}Object(c.a)(qa,"LengthAnnotationQueryStep",xa,[]);class pb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){if(w.Annotations.Lt(this.Iq)){const cc=new wa.a(this.Da.annotations,w.Annotations.S0);for(const Bc of Ta.items)Array.add(cc.items,
this.Da.filter.isMatch(Bc,zb));return cc}return this.Da.filter.isMatch(Ta,zb)}}Object(c.a)(pb,"MatchesAnnotationQueryStep",xa,[]);class bb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){return this.Da.filter.isMatch(Ta,zb)}}Object(c.a)(bb,"MatchesAsListAnnotationQueryStep",xa,[]);class eb extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Ta%zb}}Object(c.a)(eb,"ModuloAnnotationQueryStep",gb,[]);class Fa extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Ta*zb}}Object(c.a)(Fa,"MultiplyAnnotationQueryStep",
gb,[]);class tb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){if(w.Annotations.Lt(this.Iq)){const zb=new wa.a(this.Da.annotations,w.Annotations.S0);for(const cc of Ta.items)Array.add(zb.items,!cc);return zb}return!Ta}}Object(c.a)(tb,"NotAnnotationQueryStep",xa,[]);class dc extends sa{constructor(Ta){super(Ta)}yxe(Ta){return{returnValue:Ta,result:!0}}Wqb(Ta,zb){return Ta||zb}}Object(c.a)(dc,"OrAnnotationQueryStep",sa,[]);class jc extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){const cc=
this.Da.bVd.zk(Ta,zb);Ta=this.Da.mrb.zk(Ta,zb);zb=new wa.a(this.Da.annotations,w.Annotations.P7);for(let Bc=0;Bc<Ta;++Bc)Array.add(zb.items,cc+Bc);return zb}}Object(c.a)(jc,"RangeAnnotationQueryStep",xa,[]);class fb{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.filter=zb.UU(Ta.na(0)))}}Object(c.a)(fb,"SingleFilterQueryStepInit",null,[]);class ec{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.query=Ta.na(0)?zb.kv(Ta.na(0)):null)}}Object(c.a)(ec,"SingleOptionalQueryQueryStepInit",
null,[]);class lb{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.query=zb.kv(Ta.na(0)))}}Object(c.a)(lb,"SingleQueryQueryStepInit",null,[]);class ac{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.bVd=zb.kv(Ta.na(0)),this.mrb=Ta.na(1)?zb.kv(Ta.na(1)):null)}}Object(c.a)(ac,"StartAndCountOrLengthQueryStepInit",null,[]);class Gb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){let cc;({startIndex:zb,length:cc}=this.occ(Ta,zb));const Bc=new wa.a(this.Da.annotations,
Ta.hI);for(let Zc=0;Zc<cc;++Zc)Array.add(Bc.items,Ta.items[zb+Zc]);return Bc}store(Ta,zb,cc,Bc){let Zc,nd;({startIndex:Zc,length:nd}=this.occ(Ta,cc));var sd=zb;const h=({D7:Bc}=this.Dja(Bc)).returnValue;if(h){sd=new wa.a(this.Da.annotations,Ta.hI);for(let Hb=0;Hb<nd;++Hb)Array.add(sd.items,Ta.items[Zc+Hb]);sd=h.store(sd,zb,cc,Bc)}zb=sd;for(cc=0;cc<nd;++cc)Array.removeAt(Ta.items,Zc);for(let Hb=0,hc=zb.items.length;Hb<hc;++Hb)Array.insert(Ta.items,Zc+Hb,zb.items[Hb]);return Ta}occ(Ta,zb){let cc;cc=
this.Da.bVd.zk(Ta,zb);if(0>cc)throw Error.invalidOperation("Invalid start index in Sublist() query step");zb=this.Da.mrb?this.Da.mrb.zk(Ta,zb):Ta.items.length-cc;if(0>zb||cc+zb>Ta.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{startIndex:cc,length:zb}}}Object(c.a)(Gb,"SublistAnnotationQueryStep",xa,[]);class wb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta,zb){if(w.Annotations.Lt(this.Iq)){const cc=new wa.a(this.Da.annotations,
w.Annotations.EL);for(let Bc=0,Zc=Ta.items.length;Bc<Zc;++Bc)Array.add(cc.items,this.g4e(Ta.items[Bc],zb));return cc}return this.g4e(Ta,zb)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}g4e(Ta,zb){let cc;({startIndex:zb,length:cc}=this.occ(Ta,zb));return Ta.substr(zb,cc)}occ(Ta,zb){let cc;cc=this.Da.bVd.zk(Ta,zb);if(0>cc)throw Error.invalidOperation("Invalid start index in Substring() query step");zb=this.Da.mrb?this.Da.mrb.zk(Ta,zb):Ta.length-cc;if(0>
zb||cc+zb>Ta.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{startIndex:cc,length:zb}}}Object(c.a)(wb,"SubstringAnnotationQueryStep",xa,[]);class qc extends gb{constructor(Ta){super(Ta)}W_a(Ta,zb){return Ta-zb}}Object(c.a)(qc,"SubtractAnnotationQueryStep",gb,[]);class Ya extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){const zb=new wa.a(this.Da.annotations,w.Annotations.EL);for(let cc=0;cc<Ta.length;++cc)Array.add(zb.items,Ta.charAt(cc).toString());
return zb}}Object(c.a)(Ya,"ToCharListAnnotationQueryStep",xa,[]);class xb extends xa{constructor(Ta){super();this.Da=Ta}load(Ta){const zb=new wa.a(this.Da.annotations,this.Iq);Array.add(zb.items,Ta);return zb}}Object(c.a)(xb,"ToListAnnotationQueryStep",xa,[]);class wc extends xa{constructor(Ta){super();this.Da=Ta}load(){return this.Da.value}}Object(c.a)(wc,"ValueAnnotationQueryStep",xa,[]);class Oc{constructor(Ta,zb){if(Ta){var cc=Ta.na(0),Bc=1;this.value=({HQ:Bc}=zb.BIa(cc,Ta,Bc,null,null,null)).returnValue;
w.Annotations.dOa(this.value)}}}Object(c.a)(Oc,"ValueQueryStepInit",null,[]);class Cb{constructor(Ta,zb){Ta&&(this.nDc=zb.ga(Ta.na(0)),this.query=zb.kv(Ta.na(1)))}}Object(c.a)(Cb,"VarNameAndQueryQueryStepInit",null,[]);class Ib{constructor(Ta,zb){this.V7d=null;if(Ta){this.annotations=zb.annotations;var cc=0;this.Iq=Ta.na(cc);++cc;this.vI=Ta.na(cc);++cc;this.Szc=1===Ta.na(cc);++cc;this.cgc=1===Ta.na(cc);++cc;var Bc=Ta.na(cc);++cc;if(Bc){var Zc=cc,nd=cc+Bc,sd=cc+2*Bc;cc+=3*Bc;var h=Ta.count-cc,Hb=null;
for(let Hc=0;Hc<Bc;++Hc){var hc=cc+Ta.na(sd+Hc);const id=(Hc===Bc-1?h:Ta.na(sd+Hc+1))-Ta.na(sd+Hc),Ed=new ba.a;Ed.bva(Ta,hc,id);hc=Ib.kTh(Ta.na(nd+Hc),Ed,zb);hc.Iq=Ta.na(Zc+Hc);hc.vI=Hc===Bc-1?this.vI:Ta.na(Zc+Hc+1);Hb?Hb.next=hc:this.V7d=hc;Hb=hc}}}}get LUe(){return this.V7d}static kTh(Ta,zb,cc){switch(Ta){case 1:return new Ma(new oa(zb,cc));case 2:return new Jb(new oa(zb,cc));case 3:return new Pb(new gc(zb,cc.annotations));case 4:return new Oa(new Wa(zb,cc.annotations));case 5:return new Nb(new Ia(zb,
cc));case 6:return new pb(new fb(zb,cc));case 43:return new bb(new fb(zb,cc));case 45:return new Ha(new mb(zb,cc));case 49:return new sb(new Qb(zb,cc));case 46:return new wc(new Oc(zb,cc.annotations));case 51:return new Xb(new Ca(zb,cc));case 52:return new jc(new ac(zb,cc));case 53:return new ma(new Ua(cc.annotations));case 13:return new Kb(new lb(zb,cc));case 14:return new ha(new ec(zb,cc));case 15:return new hb;case 18:return new Sa(new fb(zb,cc));case 16:return new yb(new Cb(zb,cc));case 17:return new Va(new Cb(zb,
cc));case 22:return new Ob(new jb(zb,cc));case 24:return new nb(new lb(zb,cc));case 26:return new Gb(new ac(zb,cc));case 27:return new Qa(new fb(zb,cc));case 30:return new xb(new Ua(cc.annotations));case 31:return new wb(new ac(zb,cc));case 32:return new ra(new lb(zb,cc));case 47:return new qa(new Ua(cc.annotations));case 48:return new Ya(new Ua(cc.annotations));case 34:return new va(new lb(zb,cc));case 35:return new qc(new lb(zb,cc));case 36:return new Fa(new lb(zb,cc));case 37:return new vb(new lb(zb,
cc));case 38:return new eb(new lb(zb,cc));case 39:return new db(new lb(zb,cc));case 40:return new ab(new lb(zb,cc));case 41:return new dc(new lb(zb,cc));case 42:return new tb(new Ua(cc.annotations));default:throw Error.argument("currStepInitData");}}}Object(c.a)(Ib,"AnnotationQueryInit",null,[]);class fc{constructor(Ta){this.Da=Ta}execute(Ta,zb){this.jaa(Ta,Ta?new D("root",Ta,zb):zb)}jaa(Ta,zb){for(const cc of this.Da.commands)zb=cc.execute(Ta,zb)}}Object(c.a)(fc,"AnnotationScript",null,[707]);class vc{constructor(Ta){this.Da=
Ta}execute(Ta,zb){const cc=this.Da.fci.zk(Ta,zb),Bc=this.Da.UVi.zk(Ta,zb);this.Da.script.jaa(Ta,new D("Input",cc,new D("Output",Bc,zb)));return zb}}Object(c.a)(vc,"ApplyAnnotationScriptCommand",null,[914]);class Cc{constructor(Ta,zb){Ta&&(this.fci=zb.kv(Ta.na(0)),this.UVi=zb.kv(Ta.na(1)),this.script=zb.hKa(Ta.na(2)))}}Object(c.a)(Cc,"ApplyScriptCommandInit",null,[]);class fd{constructor(Ta){this.Da=Ta}execute(Ta,zb){const cc=this.Da.xNd.zk(Ta,zb);this.Da.Gkc.qeb(Ta,cc,zb,null);return zb}}Object(c.a)(fd,
"AssignAnnotationScriptCommand",null,[914]);class od{constructor(Ta){this.Da=Ta}execute(Ta,zb){const cc=this.Da.Gkc.zk(Ta,zb);Ta=this.Da.xNd.zk(Ta,zb);cc!==Ta&&cc.Vha(Ta);return zb}}Object(c.a)(od,"CopyAnnotationScriptCommand",null,[914]);class Ub{constructor(Ta){this.Da=Ta}execute(Ta,zb){let cc=this.Da.nud.zk(Ta,zb);if(this.Da.nud.Szc){cc=w.Annotations.XA(cc);var Bc=new D(this.Da.oaa,null,zb);for(let nd=0,sd=cc.items.length;nd<sd;++nd){var Zc=this.lSe(Ta,cc.items[nd],Bc);if(0>this.Da.uuc)cc.items[nd]=
Zc;else if(({value:Zc}=Zc.Vi(this.Da.uuc)).returnValue)cc.items[nd]=Zc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Da.nud.qeb(Ta,cc,zb,null)}else{Bc=new D(this.Da.oaa,null,zb);for(let nd=0,sd=cc.items.length;nd<sd;++nd)this.lSe(Ta,cc.items[nd],Bc)}return zb}lSe(Ta,zb,cc){let Bc;0>this.Da.uuc?Bc=w.Annotations.XA(zb):(Bc=new r.a(this.Da.annotations),Bc.Hn(this.Da.uuc,zb));cc.d0c(Bc);this.Da.aQg.jaa(Ta,cc);return Bc}}Object(c.a)(Ub,"EnumerateAnnotationScriptCommand",
null,[914]);class Fc{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.oaa=zb.ga(Ta.na(0)),this.nud=zb.kv(Ta.na(1)),this.aQg=zb.hKa(Ta.na(2)),this.uuc=Ta.na(3))}}Object(c.a)(Fc,"EnumerateScriptCommandInit",null,[]);class $b{constructor(Ta){this.Da=Ta}execute(Ta,zb){this.Da.wAc.zk(Ta,zb)?this.Da.XMj.jaa(Ta,zb):this.Da.bTe&&this.Da.bTe.jaa(Ta,zb);return zb}}Object(c.a)($b,"IfAnnotationScriptCommand",null,[914]);class zc{constructor(Ta,zb){Ta&&(this.wAc=zb.kv(Ta.na(0)),this.XMj=zb.hKa(Ta.na(1)),
this.bTe=Ta.na(2)?zb.hKa(Ta.na(2)):null)}}Object(c.a)(zc,"IfScriptCommandInit",null,[]);class Wc{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.Gkc=zb.kv(Ta.na(0)),this.xNd=zb.kv(Ta.na(1)))}}Object(c.a)(Wc,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class yc{constructor(Ta){this.Da=Ta}execute(Ta,zb){const cc=this.Da.xNd.zk(this.Da.Gkc.zk(Ta,zb),zb);this.Da.Gkc.qeb(Ta,cc,zb,null);return zb}}Object(c.a)(yc,"ModifyAnnotationScriptCommand",null,[914]);class pd{constructor(Ta){this.Da=
Ta}execute(Ta,zb){const cc=new r.a(this.Da.annotations);this.Da.query&&cc.Vha(this.Da.query.zk(Ta,zb));return zb=new D(this.Da.oaa,cc,zb)}}Object(c.a)(pd,"NewAnnotationScriptCommand",null,[914]);class xd{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.oaa=zb.ga(Ta.na(0)),this.query=Ta.na(1)?zb.kv(Ta.na(1)):null)}}Object(c.a)(xd,"NewScriptCommandInit",null,[]);class Vb{constructor(Ta){this.Da=Ta}execute(Ta,zb){Ta=this.Da.query.zk(Ta,zb);if(this.Da.query.vI===w.Annotations.TB)Ta.Isc(this.Da.gY);
else for(const cc of Ta.items)cc.Isc(this.Da.gY);return zb}}Object(c.a)(Vb,"RemoveAnnotationScriptCommand",null,[914]);class Uc{constructor(Ta,zb){Ta&&(this.annotations=zb.annotations,this.query=zb.kv(Ta.na(0)),this.gY=Ta.na(1))}}Object(c.a)(Uc,"RemoveScriptCommandInit",null,[]);class ud{constructor(Ta,zb){if(Ta){var cc=0,Bc=Ta.na(cc);++cc;if(Bc){var Zc=cc,nd=cc+Bc;cc+=2*Bc;var sd=Ta.count-cc;this.commands=Array(Bc);for(let h=0;h<Bc;++h){const Hb=cc+Ta.na(nd+h),hc=(h===Bc-1?sd:Ta.na(nd+h+1))-Ta.na(nd+
h),Hc=new ba.a;Hc.bva(Ta,Hb,hc);this.commands[h]=ud.iTh(Ta.na(Zc+h),Hc,zb)}}}}static iTh(Ta,zb,cc){switch(Ta){case 1:return new fd(new Wc(zb,cc));case 2:return new yc(new Wc(zb,cc));case 3:return new Vb(new Uc(zb,cc));case 6:return new pd(new xd(zb,cc));case 7:return new Ub(new Fc(zb,cc));case 8:return new $b(new zc(zb,cc));case 9:return new od(new Wc(zb,cc));case 10:return new vc(new Cc(zb,cc));default:throw Error.argument("initData");}}}Object(c.a)(ud,"AnnotationScriptInit",null,[]);var Vc=a(937);
class yd{constructor(Ta){this.Pj=Ta;this.$B=0}$K(){const Ta=this.Pj.En(this.$B,4);this.$B+=4;return Ta}get array(){return this.Pj}get offset(){return this.$B}set offset(Ta){this.$B=Ta}}Object(c.a)(yd,"ByteArrayReader",null,[]);class Sd{constructor(){this.ru=null;this.zpf=this.wN=0}na(Ta){if(0>Ta||Ta>=this.wN)throw Error.argumentOutOfRange("index");return this.ru.En(this.zpf+4*Ta,4)}get count(){return this.wN}static N7g(Ta,zb,cc){const Bc=new Sd;Bc.ru=Ta;Bc.zpf=zb;Bc.wN=cc;return Bc}}Object(c.a)(Sd,
"ReadOnlyListOverByteArray",null,[585]);class Wd{constructor(Ta,zb){this.mpf=this.lpf=!1;this.Wl=this.eca=this.Qvd=this.ppf=null;try{this.Wl=zb.annotations;const cc=zb.mva(Ta.na(0)),Bc=new yd(cc);if(-914743053!==Bc.$K())throw Error.argument("Input does not represent a flat lexicon");this.lpf=1===Bc.$K();this.mpf=1===Bc.$K();const Zc=Bc.$K();Bc.offset+=Zc;const nd=Bc.$K();this.Qvd=Wd.KWi(Bc,nd,this.Wl);const sd=Bc.$K();this.ppf=Wd.PWi(Bc,sd);const h=Bc.$K();this.eca=new Vc.a(Bc.array,Bc.offset);Bc.offset+=
h}catch(cc){throw Error.argument("initData");}}get trie(){return this.eca}FKh(Ta){return"i"===Ta&&this.mpf?"\u0130":Ta.toUpperCase()}Hnd(){return this.lpf}KIh(Ta){let zb;zb=new wa.a(this.Wl,w.Annotations.TB);if(1!==Ta)if(0===Ta)Ta=new r.a(this.Wl),Array.add(zb.items,Ta);else if(Ta&1073741824){Ta=this.ppf[Ta&-1073741825];for(let Bc=0;Bc<Ta.length;++Bc){var cc=Ta[Bc];cc=0===cc?new r.a(this.Wl):this.Qvd[cc-2];Array.add(zb.items,cc)}}else Array.add(zb.items,this.Qvd[Ta-2]);return{returnValue:!0,xsi:zb}}static KWi(Ta,
zb,cc){if(zb%4)throw Error.argument("reader");const Bc=Sd.N7g(Ta.array,Ta.offset,zb/4);Ta.offset+=zb;Ta=[];for(zb=0;zb<Bc.count;){const Zc=({HQ:zb}=cc.BIa(w.Annotations.TB,Bc,zb,null,null,null)).returnValue;Array.add(Ta,Zc)}return Ta}static PWi(Ta,zb){zb=Ta.offset+zb;const cc=[];for(;Ta.offset<zb;){const Bc=Ta.$K(),Zc=Array(Bc);for(let nd=0;nd<Bc;++nd){const sd=Ta.$K();Zc[nd]=sd}Array.add(cc,Zc)}return cc}}Object(c.a)(Wd,"RawFlatLexicon",null,[706]);var Hd=a(917),le=a(918);class Le{constructor(Ta){if(null==
Ta)throw Error.argumentNull("base64String");const zb=Ta.length;if(zb%4)throw Error.argument("base64String's length must be a multiple of 4");this.wN=.75*zb;this.oOa=Array(Math.ceil(this.wN/4));Ta.endsWith("==")?this.wN-=2:Ta.endsWith("=")&&--this.wN;let cc=0;for(let Bc=0;Bc<zb;Bc+=4){const Zc=Le.Zuc[Ta.charCodeAt(Bc)-43]<<18|Le.Zuc[Ta.charCodeAt(Bc+1)-43]<<12|Le.Zuc[Ta.charCodeAt(Bc+2)-43]<<6|Le.Zuc[Ta.charCodeAt(Bc+3)-43];let nd=Zc>>16&255;this.oOa[Math.floor(cc/4)]|=nd<<cc%4*8;++cc;nd=Zc>>8&255;
this.oOa[Math.floor(cc/4)]|=nd<<cc%4*8;++cc;nd=Zc&255;this.oOa[Math.floor(cc/4)]|=nd<<cc%4*8;++cc}}get length(){return this.wN}na(Ta){if(0>Ta||Ta>=this.wN)throw Error.argumentOutOfRange("i");return this.ZXe(Ta)}En(Ta,zb){if(0>Ta||0>zb||Ta+zb>this.wN)throw Error.argument("Bad range");let cc=0;for(let Bc=0;Bc<zb;++Bc)cc|=this.ZXe(Ta+Bc)<<8*Bc;return cc}c6i(Ta,zb){let cc=0,Bc=0,Zc=Math.floor(Ta/8);for(Ta%=8;Bc<zb;){const nd=8-Ta>zb-Bc?zb-Bc:8-Ta,sd=this.na(Zc);cc|=(sd>>Ta&~(255<<nd))<<Bc;Bc+=nd;++Zc;
Ta=0}return cc}ZXe(Ta){return this.oOa[Math.floor(Ta/4)]>>Ta%4*8&255}}Le.Zuc=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(c.a)(Le,"ByteArray",null,[]);class Md{constructor(Ta,zb,cc){this.Sq=Ta;this.Fxi=zb;this.Oxi=cc;this.Hpf=Array(Ta.b?Ta.b.length:0);this.uwd=new Hd.a(new le.a(this.mva(this.Sq.s)));this.EK=Array(Ta.t.length);
this.rmg=new w.Annotations(this.iva(0),this)}get annotations(){return this.rmg}get Tih(){return this.Sq.d}LSh(){if(!(""in this.Sq.m))throw Error.argument("name","Unrecognized module");return this.Tfd(this.Sq.m[""])}mva(Ta){if(0>Ta||!this.Sq.b||Ta>=this.Sq.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.Hpf[Ta]||(this.Hpf[Ta]=new Le(this.Sq.b[Ta]))}ga(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(1!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not a string");
if(null==this.EK[Ta]){const zb=this.iva(Ta).na(0);this.EK[Ta]=this.uwd.ga(zb)}return this.EK[Ta]}H2e(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.EK[Ta]){var zb=this.iva(Ta);const cc=this.ga(zb.na(0));zb=1===zb.na(1);this.EK[Ta]=new RegExp(cc,zb?"i":"")}return this.EK[Ta]}bXh(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Sq.t[Ta])throw Error.argument("blobID",
"Requested blob is not an SRE");throw Error.notImplemented();}Tfd(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not an NL module");return this.EK[Ta]||(this.EK[Ta]=this.Oxi.aTh(this.iva(Ta),this))}kv(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not an annotation query");return this.EK[Ta]||(this.EK[Ta]=
new ia(new Ib(this.iva(Ta),this)))}hKa(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not an annotation script");return this.EK[Ta]||(this.EK[Ta]=new fc(new ud(this.iva(Ta),this)))}UU(Ta){if(1>Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not a filter");return this.EK[Ta]||(this.EK[Ta]=this.Fxi.UU(this.iva(Ta),this))}RVh(Ta){if(1>
Ta||Ta>=this.Sq.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Sq.t[Ta])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.EK[Ta]||(this.EK[Ta]=new Wd(this.iva(Ta),this))}iva(Ta){const zb=this.Sq.n[Ta];Ta=(Ta<this.Sq.t.length-1?this.Sq.n[Ta+1]:this.Sq.n.length)-zb;if(0>zb||0>Ta||zb+Ta>this.Sq.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+zb+","+Ta+")");const cc=new ba.a;cc.Bcd(this.Sq.n,zb,Ta);return cc}}Object(c.a)(Md,
"ObjectFetcher",null,[689]);class ke{constructor(Ta,zb,cc){if(!Ta)throw Error.argumentNull("prediction");if(!zb)throw Error.argumentNull("fieldNames");if(!cc)throw Error.argumentNull("values");if(zb.length!==cc.length)throw Error.argument("values","fieldNames and values do not have same length");this.uvg=Ta;this.pOa=zb;this.ZCb=cc}get prediction(){return this.uvg}get qTe(){return this.pOa.length}uKa(Ta){return 0<=Ta&&Ta<this.pOa.length?this.pOa[Ta]:null}Uva(Ta){return 0<=Ta&&Ta<this.ZCb.length?this.ZCb[Ta]:
null}}Object(c.a)(ke,"PredictionData",null,[]);class ve{constructor(Ta,zb){if(!Ta)throw Error.argumentNull("predictions");if(!zb)throw Error.argumentNull("tokenAttributes");this.Rxi=Ta;this.byi=zb}xgd(){return this.Rxi}uXe(){return this.byi}}Object(c.a)(ve,"PredictionDataWithTokenAttributes",null,[]);class ge{constructor(Ta,zb){this.prediction=null;this.score=0;this.prediction=Ta;this.score=zb}}Object(c.a)(ge,"PredictionWithScore",null,[]);class we{constructor(Ta,zb){if(!Ta)throw Error.argumentNull("predictions");
if(!zb)throw Error.argumentNull("attributes");this.vvg=Ta;this.hRb=zb}xgd(){return this.vvg}uXe(){return this.hRb}}Object(c.a)(we,"PredictionsWithTokenAttributes",null,[]);class De{constructor(Ta,zb,cc){if(!Ta)throw Error.argumentNull("attributeName");if(!zb)throw Error.argumentNull("fieldNames");if(!cc)throw Error.argumentNull("values");if(zb.length!==cc.length)throw Error.argument("values","fieldNames and values do not have same length");this.Nmg=Ta;this.pOa=zb;this.ZCb=cc}get attributeName(){return this.Nmg}get qTe(){return this.pOa.length}uKa(Ta){return 0<=
Ta&&Ta<this.pOa.length?this.pOa[Ta]:null}Uva(Ta){return 0<=Ta&&Ta<this.ZCb.length?this.ZCb[Ta]:null}}Object(c.a)(De,"TokenAttributes",null,[]);var ib=a(84),Yb=a(683);class pc{constructor(Ta,zb,cc,Bc,Zc){this.AQb=0;this.G1d=null;this.BQb=this.ngb=0;this.hEc=this.XUa=this.gX=this.ogb=null;this.I1d=0;this.nXa=this.Vo=null;this._state=-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Ot=Ta;this.Mig=this.Qig=zb;this.Lig=this.Oig=cc;this.yQb=this.Nig=
Bc;this.zQb=this.Pig=Zc}gEc(){this.BQb=0;return this.D1d}D1d(){if(!(this.BQb<this.yQb))return this.E1d;this.ogb=this.Mig.items[this.BQb+this.Lig];this.gX=new r.a(this.Ot.Da.annotations);1!==this.yQb&&this.Ot.Da.$yb||this.gX.Vha(this.ogb);if(0<=this.Ot.Da.Vlc){({value:this.XUa}=this.gX.Vi(this.Ot.Da.Vlc)).returnValue?this.XUa=this.XUa.XA():this.XUa=new wa.a(this.Ot.Da.annotations,w.Annotations.TB);this.hEc=this.zQb.items;this.I1d=this.hEc.length;for(this.AQb=0;this.AQb<this.I1d;++this.AQb)this.G1d=
this.hEc[this.AQb],Array.add(this.XUa.items,this.G1d);this.gX.Hn(this.Ot.Da.Vlc,this.XUa)}else 0<=this.Ot.Da.$Td?this.gX.Hn(this.Ot.Da.$Td,this.zQb.items[0]):0<=this.Ot.Da.XYc?this.gX.Hn(this.Ot.Da.XYc,!0):this.Ot.Da.Pgf?this.zQb.items[0].B$b((Ta,zb)=>this.gX.Hn(Ta,zb)):(this.gX.Vha(this.zQb.items[0]),1!==this.yQb&&this.Ot.Da.$yb||(({value:this.ngb}=this.ogb.Vi(this.Ot.Da.$G)).returnValue&&this.gX.Hn(this.Ot.Da.$G,this.ngb),({value:this.ngb}=this.ogb.Vi(this.Ot.Da.zJ)).returnValue&&this.gX.Hn(this.Ot.Da.zJ,
this.ngb),this.ogb.Vi(this.Ot.Da.rsa).returnValue&&this.gX.Hn(this.Ot.Da.rsa,this.ngb)));this.Vo=this.gX;this._state=2;return this.Tig}E1d(){this._state=3}Sig(){this.BQb++;return this.D1d}Tig(){return 1<this.yQb&&this.Ot.Da.$yb?this.E1d:this.Sig}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new pc(this.Ot,this.Qig,this.Oig,this.Nig,this.Pig)).getEnumerator()}[Symbol.iterator](){return Object(Yb.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=
1:(this._state=1,this.nXa=this.gEc());for(;1===this._state;)this.nXa=this.nXa();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.Vo}}Object(c.a)(pc,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",null,[10,33,71]);class Jc{constructor(Ta,zb,cc){this.VCb=this.Apf=0;this.V8a=null;this.vwd=this.Wvd=this.T8a=this.Nkc=this.Zvd=0;this.Pkc=!1;this.kwd=Ta;this.wwd=zb;this.Qxi=
cc}q1e(){null===this.V8a&&({o$f:this.V8a,u$e:this.Zvd,length:this.Nkc,izh:Ta}=this.kwd.B4e(this.wwd.items[this.VCb],this.Qxi),this.Pkc=Ta||this.Pkc);if(this.T8a<this.Nkc){var Ta=this.V8a.charAt(this.Zvd+this.T8a);++this.T8a;return{returnValue:!0,ch:Ta}}if(this.VCb===this.wwd.items.length-1)return{returnValue:!1,ch:"\x00"};++this.VCb;this.T8a=0;this.V8a=null;return{returnValue:!0,ch:" "}}iJd(Ta,zb){this.T8a===this.Nkc&&this.V8a&&(this.vwd=zb,this.Wvd=this.VCb-this.Apf+1)}Bgj(Ta){if(0>Ta||Ta>=this.wwd.items.length)throw Error.argumentOutOfRange("iToken");
this.VCb=this.Apf=Ta;this.V8a=null;this.Wvd=this.T8a=this.Nkc=this.Zvd=0;this.vwd=-1;this.Pkc=!1}pSh(){return{WTg:this.Wvd,uqi:this.vwd,ezh:this.Pkc}}}Object(c.a)(Jc,"TriePrefixVisitor",null,[674]);class Xc{constructor(Ta){this.Da=Ta}execute(Ta){if(!({value:cc}=Ta.Vi(this.Da.b$)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let zb;({value:zb}=Ta.Vi(this.Da.aha)).returnValue||(zb=null);var cc=this.sIh(cc,zb);Ta=w.Annotations.XA(Ta);Ta.Hn(this.Da.b$,cc);return Ta}sIh(Ta,
zb){let cc=null;const Bc=this.Da.flatLexicon.trie,Zc=new Jc(this,Ta,zb);let nd=null;this.Da.flatLexicon.Hnd()&&(nd=Object(ib.a)(this.Da.flatLexicon,this.Da.flatLexicon.FKh,"getCaseInsensitiveForm"));let sd=0,h;var Hb;let hc;for(;sd<Ta.items.length;){const Hc=Ta.items[sd];Zc.Bgj(sd);Bc.Ghg(Zc,nd);({WTg:h,uqi:Hb,ezh:hc}=Zc.pSh());if(0<h){({xsi:Hb}=this.Da.flatLexicon.KIh(Hb));for(let id of this.l9g(Ta,sd,h,Hb)){1<h&&this.Da.$yb&&this.P9g(Ta,zb,sd,Hc,h,hc,id);if(!cc)for(cc=new wa.a(this.Da.annotations,
w.Annotations.TB),Hb=0;Hb<sd;++Hb)Array.add(cc.items,Ta.items[Hb]);Array.add(cc.items,id)}sd+=h}else cc&&Array.add(cc.items,Hc),++sd}return cc||Ta}P9g(Ta,zb,cc,Bc,Zc,nd,sd){if(nd)nd=!0;else if(this.Da.Cgf){nd=!1;var h=-1;for(var Hb=0;Hb<Zc;Hb++){var hc=Ta.items[cc+Hb];let Id;var Hc=void 0;if(!({value:Id}=hc.Vi(this.Da.$G)).returnValue||!({value:Hc}=hc.Vi(this.Da.zJ)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<Hb){if(Id>h+1){nd=!0;break}if(0>h||null===zb||h>=zb.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==zb.charAt(h)){nd=!0;break}}h=Id+Hc}}else nd=!1;if(nd){Hc=new Sys.StringBuilder;for(nd=0;nd<Zc;++nd)({o$f:h,u$e:Hb,length:hc}=this.B4e(Ta.items[cc+nd],zb)),0<nd&&Hc.append(" "),Hc.append(h.substr(Hb,hc));sd.Hn(this.Da.rsa,Hc.toString())}Ta=Ta.items[cc+Zc-1];let id,Ed;({value:Bc}=Bc.Vi(this.Da.$G)).returnValue&&
({value:id}=Ta.Vi(this.Da.$G)).returnValue&&({value:Ed}=Ta.Vi(this.Da.zJ)).returnValue?(sd.Hn(this.Da.$G,Bc),sd.Hn(this.Da.zJ,id+Ed-Bc)):(sd.Isc(this.Da.$G),sd.Isc(this.Da.zJ))}l9g(Ta,zb,cc,Bc){return new pc(this,Ta,zb,cc,Bc)}B4e(Ta,zb){let cc,Bc;if(({value:cc}=Ta.Vi(this.Da.rsa)).returnValue)Bc=!0,zb=0,Ta=cc.length;else{Bc=!1;if(null===zb)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");cc=zb;if(!({value:zb}=Ta.Vi(this.Da.$G)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:Ta}=Ta.Vi(this.Da.zJ)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>zb||0>Ta||zb+Ta>cc.length)throw Error.argument("Token start/length values out of range","token");}return{o$f:cc,u$e:zb,length:Ta,izh:Bc}}}Object(c.a)(Xc,"FlatLexiconNLModule",null,[623]);class M{constructor(Ta,zb){this.XYc=this.Vlc=this.$Td=this.rsa=this.zJ=this.$G=this.aha=this.b$=0;this.Pgf=this.Cgf=this.$yb=!1;this.flatLexicon=null;this.annotations=zb.annotations;
let cc=0;try{this.b$=Ta.na(cc),++cc,this.aha=Ta.na(cc),++cc,this.$G=Ta.na(cc),++cc,this.zJ=Ta.na(cc),++cc,this.rsa=Ta.na(cc),++cc,this.$Td=Ta.na(cc),++cc,this.Vlc=Ta.na(cc),++cc,this.XYc=Ta.na(cc),++cc,this.$yb=1===Ta.na(cc),++cc,this.Cgf=1===Ta.na(cc),++cc,this.Pgf=1===Ta.na(cc),++cc,this.flatLexicon=zb.RVh(Ta.na(cc))}catch(Bc){throw Error.argument("initData");}}}Object(c.a)(M,"FlatLexiconNLModuleInit",null,[]);class $a{constructor(){this.Zxb=0;this.Uad=null;this.yKb=0}}Object(c.a)($a,"FeatureGenStackRec",
null,[]);class ob{constructor(Ta){this.xXd=Array(Ta);this.Xeb=Array(Ta);this.DVd=[];this.j8f=[]}}Object(c.a)(ob,"TokenStringLattice",null,[]);const Tb=(Ta,zb,cc)=>{for(let Bc=0;Bc<Ta.length;Bc++)cc=zb(cc,Ta[Bc]);return cc},Dc=(Ta,zb)=>{const cc=Array(Ta.length);for(let Bc=0;Bc<Ta.length;Bc++)cc[Bc]=zb(Ta[Bc]);return cc},ad=(Ta,zb)=>{zb=Array(Math.min(zb,Ta.length));for(let cc=0;cc<zb.length;cc++)zb[cc]=Ta[cc];return zb},ld=(Ta,zb)=>{const cc=[];for(const Bc of Ta)zb(Bc)&&Array.add(cc,Bc);return cc};
class md{constructor(Ta,zb){this.key=Ta;this.value=zb}}Object(c.a)(md,"KeyValuePair",null,[]);const Wb=(Ta,zb)=>({returnValue:zb in Ta,value:Ta[zb]}),Nc=Ta=>{const zb=[];for(let cc in Ta){const Bc=new md(cc,Ta[cc]);Array.add(zb,Bc)}return zb};class gd{constructor(Ta){this.A4e=this.QZh;this.Da=Ta;this.Skc=this.iwd=this.jwd=0;for(const zb of this.Da.z9b)this.jwd=Math.max(this.jwd,zb.iFd),this.iwd=Math.max(this.iwd,zb.bFd),this.Skc=Math.max(this.Skc,zb.geb.length)}get QAh(){return this.Da.SAc.trie}execute(Ta){if(!Ta)throw Error.argumentNull("input");
let zb,cc;({tokens:zb,gri:cc}=this.RZh(Ta));let Bc=null,Zc=null,nd={};if(this.Da.Fzb){zb=w.Annotations.XA(zb);for(var sd=0;sd<zb.items.length;++sd)zb.items[sd]=w.Annotations.XA(zb.items[sd])}else({eTe:Zc,returnValue:Bc}=this.O1e(Ta,nd));sd=Array(this.Skc);const h=Array(this.Skc);for(var Hb=0;Hb<h.length;++Hb)h[Hb]=new $a;for(Hb=-this.jwd;Hb<zb.items.length+this.iwd;++Hb){let hc=null;this.Da.Fzb&&(hc=zb.items[Hb],nd={},{eTe:Zc,returnValue:Bc}=this.O1e(hc,nd));for(const Hc of this.Da.z9b){if(0>Hb&&
-Hb>Hc.iFd||Hb>=zb.items.length&&Hb-zb.items.length+1>Hc.bFd)continue;let id=!0;for(let Ed=0;Ed<Hc.geb.length;++Ed){const Id=Hb+Hc.geb[Ed];sd[Ed]=Id;if(0>Id?0>this.Da.jFd:Id>=zb.items.length?0>this.Da.cFd:!cc.Xeb[Id]){id=!1;break}}id&&({Kbh:Bc,Lbh:Zc}=this.Nci(Hc,cc,Bc,Zc,nd,h,sd))}this.Da.Fzb&&(hc.Hn(this.Da.Cka?this.Da.h_a:this.Da.f_a,Bc),this.Da.Cka&&hc.Hn(this.Da.g_a,Zc))}Ta=w.Annotations.XA(Ta);this.Da.Fzb?Ta.Hn(this.Da.b$,zb):(Ta.Hn(this.Da.Cka?this.Da.h_a:this.Da.f_a,Bc),this.Da.Cka&&Ta.Hn(this.Da.g_a,
Zc));return Ta}RZh(Ta){let zb,cc;if(!Ta||!({value:zb}=Ta.Vi(this.Da.b$)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Bc;({value:Bc}=Ta.Vi(this.Da.aha)).returnValue||(Bc="");cc=new ob(zb.items.length);const Zc=ld(this.Da.zXd,nd=>!nd.Fyb||nd.Fyb.isMatch(Ta,null));for(let nd=0;nd<zb.items.length;++nd){const sd=zb.items[nd];let h=null;cc.xXd[nd]=cc.DVd.length;let Hb=cc.Xeb[nd]=0;for(const hc of Zc)0<hc.dDb&&cc.Xeb[nd]+Hb>=hc.dDb||hc.vOb&&!hc.vOb.isMatch(sd,
null)||({wOb:h,zpb:Hb}=hc.apply(this,sd,nd,cc,Bc,h,Hb))}return{tokens:zb,gri:cc}}Nci(Ta,zb,cc,Bc,Zc,nd,sd){let h=0;nd[0].Zxb=-1;for(nd[0].Uad=Ta.PVf;;){var Hb=sd[h],hc=0>Hb||Hb>=zb.Xeb.length?1:zb.Xeb[Hb];let Ed=!1;for(;nd[h].Zxb<hc-1;){++nd[h].Zxb;var Hc=void 0,id=void 0;0>Hb?(Hc=this.Da.jFd,id=1):Hb>=zb.xXd.length?(Hc=this.Da.cFd,id=1):(id=zb.xXd[Hb]+nd[h].Zxb,Hc=zb.DVd[id],id=zb.j8f[id]);nd[h].yKb=id*(h?nd[h-1].yKb:Ta.score);if(({value:Hc}=Wb(nd[h].Uad,Hc.toString())).returnValue){h===Ta.geb.length-
1?(Hb=Hc,nd[h].yKb&&(({value:hc}=Wb(Zc,Hb.toString())).returnValue||(hc=-1),0>hc&&(cc=w.Annotations.XA(cc),Array.add(cc.items,Hb)),this.Da.Cka&&(Bc=w.Annotations.XA(Bc),0>hc?Array.add(Bc.items,nd[h].yKb):Bc.items[hc]+=nd[h].yKb),0>hc&&(this.Da.ijf||this.Da.Cka)&&(Zc[Hb.toString()]=cc.items.length-1))):(++h,nd[h].Zxb=-1,nd[h].Uad=Hc);Ed=!0;break}}if(!Ed&&(--h,0>h))break}return{Kbh:cc,Lbh:Bc}}O1e(Ta,zb){let cc;if(({value:cc}=Ta.Vi(this.Da.Cka?this.Da.h_a:this.Da.f_a)).returnValue)for(let Bc=0;Bc<cc.items.length;++Bc)zb[cc.items[Bc].toString()]=
Bc;else cc=new wa.a(this.Da.annotations,w.Annotations.P7);if(this.Da.Cka){if(({value:zb}=Ta.Vi(this.Da.g_a)).returnValue||(zb=new wa.a(this.Da.annotations,w.Annotations.YW)),zb.items.length!==cc.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Da.annotations.PO(w.Annotations.TB,Ta));}else zb=null;return{returnValue:cc,eTe:zb}}get VKj(){return this.Da.SAc}QZh(Ta,zb){var cc;if(({value:cc}=zb.Vi(this.Da.rsa)).returnValue)Ta=
cc;else{if(!({value:cc}=zb.Vi(this.Da.$G)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:zb}=zb.Vi(this.Da.zJ)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>cc||0>zb||cc+zb>Ta.length)throw Error.argument("Token indices are out of range");Ta=Ta.substr(cc,zb)}return Ta}}Object(c.a)(gd,"NGramNLModule",null,[623,658]);class Gd{constructor(Ta){this.geb=null;this.score=this.bFd=this.iFd=0;this.PVf=null;if(Ta){var zb=0;try{if(Ta.na(zb)!==Gd.TGa)throw Error.argument("initData",
"Input does not represent a feature template");++zb;const cc=Ta.na(zb);++zb;this.geb=Array(cc);for(let Bc=0;Bc<cc;++Bc)this.geb[Bc]=Ta.na(zb),++zb;this.iFd=Ta.na(zb);++zb;this.bFd=Ta.na(zb);++zb;this.score=Ta.na(zb);++zb;this.PVf=({s$e:zb}=Gd.FNf(Ta,zb)).returnValue}catch(cc){throw Error.argument("initData");}}}static FNf(Ta,zb){const cc=Ta.na(zb);++zb;const Bc={};for(let Zc=0;Zc<cc;++Zc){const nd=Ta.na(zb);++zb;Ta.na(zb)?Bc[nd.toString()]=({s$e:zb}=Gd.FNf(Ta,zb)).returnValue:(++zb,Bc[nd.toString()]=
Ta.na(zb),++zb)}return{returnValue:Bc,s$e:zb}}}Gd.TGa=240803228;Object(c.a)(Gd,"FeatureTemplate",null,[676]);var Zd=a(844);class xe{constructor(Ta,zb){this.Cka=this.ijf=this.Fzb=!1;this.rsa=this.zJ=this.$G=this.b$=this.aha=this.g_a=this.h_a=this.f_a=0;this.SAc=null;this.cFd=this.jFd=0;this.z9b=this.zXd=null;if(Ta){this.annotations=zb.annotations;var cc=0;try{this.Fzb=1===Ta.na(cc);++cc;this.ijf=1===Ta.na(cc);++cc;this.Cka=1===Ta.na(cc);++cc;this.f_a=Ta.na(cc);++cc;this.h_a=Ta.na(cc);++cc;this.g_a=
Ta.na(cc);++cc;this.aha=Ta.na(cc);++cc;this.b$=Ta.na(cc);++cc;this.$G=Ta.na(cc);++cc;this.zJ=Ta.na(cc);++cc;this.rsa=Ta.na(cc);++cc;this.SAc=this.eXi(zb.mva(Ta.na(cc)));++cc;this.jFd=Ta.na(cc);++cc;this.cFd=Ta.na(cc);++cc;const Bc=Ta.na(cc);++cc;this.zXd=Array(Bc);for(let nd=0;nd<Bc;++nd){const sd=Ta.na(cc);++cc;const h=this.SAc.trie,Hb=new ba.a;Hb.bva(Ta,cc,sd);this.zXd[nd]=this.jXi(Hb,zb,h);cc+=sd}const Zc=Ta.na(cc);++cc;this.z9b=Array(Zc);for(zb=0;zb<Zc;++zb){const nd=Ta.na(cc);++cc;const sd=new ba.a;
sd.bva(Ta,cc,nd);this.z9b[zb]=this.QWi(sd);cc+=nd}}catch(Bc){throw Error.argument("initData");}}}eXi(Ta){return new Hd.a(new le.a(Ta))}jXi(Ta,zb,cc){return Zd.a.create(Ta,zb,cc)}QWi(Ta){return new Gd(Ta)}}Object(c.a)(xe,"NGramNLModuleInit",null,[]);class Re{constructor(Ta){this.Da=Ta}execute(Ta){if(!Ta)throw Error.argumentNull("input");Ta=Ta.clone();this.Da.script.execute(Ta,null);return Ta}}Object(c.a)(Re,"ScriptNLModule",null,[623]);class Ue{constructor(Ta,zb){Ta&&(this.script=zb.hKa(Ta.na(0)))}}
Object(c.a)(Ue,"ScriptNLModuleInit",null,[]);const jf=Ta=>{Ta=Dc(Ta,zb=>zb*zb);return Math.sqrt(Tb(Ta,(zb,cc)=>zb+cc,0))},Bf=Ta=>Tb(Ta,(zb,cc)=>zb>cc?zb:cc,Ta[0]);class Ae{constructor(Ta){this.Da=Ta}execute(Ta){if(!Ta)throw Error.argumentNull("input");var zb=[],cc=[];this.W_g(Ta,zb,cc);this.vJg(zb,cc);const Bc={};for(let nd=0;nd<zb.length;++nd){var Zc=zb[nd];const sd=this.Da.Qbf.na(Zc);Zc=this.Da.Rbf.na(Zc);for(let h=0;h<Zc;++h){const Hb=this.Da.JYg.na(this.Da.Cze.na(sd+h)),hc=this.Da.Dze.na(sd+h);
let Hc;({value:Hc}=Wb(Bc,Hb)).returnValue||(Hc=0);Bc[Hb]=Hc+cc[nd]*hc}}cc=Nc(Bc);cc.sort((nd,sd)=>{var h=nd.value,Hb=sd.value;(h=-(h>Hb?1:h<Hb?-1:0))||(h=nd.key.localeCompare(sd.key));return h});zb=new wa.a(this.Da.annotations,w.Annotations.TB);for(const nd of ad(cc,this.Da.szi))cc=new r.a(this.Da.annotations),cc.Hn(this.Da.ZNg,nd.key),cc.Hn(this.Da.aOg,nd.value),Array.add(zb.items,cc);Ta.Hn(this.Da.$Ng,zb);return Ta}W_g(Ta,zb,cc){if(({value:Ta}=Ta.Vi(this.Da.YNg)).returnValue){let Bc;if(({value:Bc}=
Ta.Vi(this.Da.h_a)).returnValue){let Zc;if(!({value:Zc}=Ta.Vi(this.Da.g_a)).returnValue||Bc.items.length!==Zc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.k3b(Bc,Zc,zb,cc)}if(({value:Bc}=Ta.Vi(this.Da.cOg)).returnValue){let Zc;if(!({value:Zc}=Ta.Vi(this.Da.dOg)).returnValue||Bc.items.length!==Zc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");this.k3b(Bc,
Zc,zb,cc)}({value:Bc}=Ta.Vi(this.Da.f_a)).returnValue&&this.k3b(Bc,null,zb,cc);({value:Bc}=Ta.Vi(this.Da.bOg)).returnValue&&this.k3b(Bc,null,zb,cc)}}k3b(Ta,zb,cc,Bc){for(let nd=0;nd<Ta.items.length;++nd){var Zc=void 0;Ta.hI===w.Annotations.EL?({value:Zc}=Wb(this.Da.VKe,Ta.items[nd])).returnValue||(Zc=-1):(Zc=Ta.items[nd],Zc=Zc>=this.Da.Bxd&&Zc<=this.Da.Uzi?this.Da.azd?this.Da.azd.na(Zc-this.Da.Bxd)-1:Zc-this.Da.Bxd:-1);if(0<=Zc){let sd;sd=zb?zb.items[nd]:1;0<sd&&(Array.add(cc,Zc),Array.add(Bc,sd))}}}vJg(Ta,
zb){if(Ta.length){switch(this.Da.D2i){case 0:break;case 1:for(var cc=0;cc<zb.length;++cc)zb[cc]=1+Math.log(zb[cc]);break;case 2:cc=Bf(zb);for(let Bc=0;Bc<zb.length;++Bc)zb[Bc]=.5+zb[Bc]/cc*.5;break;case 3:for(cc=0;cc<zb.length;++cc)zb[cc]=1;break;default:throw Error.notImplemented();}if(this.Da.pfc)for(cc=0;cc<zb.length;++cc)zb[cc]*=this.Da.pfc.na(Ta[cc]);Ta=jf(zb);for(cc=0;cc<zb.length;++cc)zb[cc]/=Ta}}}Object(c.a)(Ae,"TfIdfRankerNLModule",null,[623]);class Qe{constructor(Ta,zb=0){if(!Ta)throw Error.argumentNull("byteArray");
this.Tkc=zb;if(604662927!==Ta.En(this.Tkc+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this._count=Ta.En(this.Tkc+4,4);this.Yof=Ta.En(this.Tkc+8,4);this.yxi=Ta}na(Ta){if(0>Ta||Ta>=this.count)throw Error.argumentOutOfRange("index");return this.yxi.c6i(8*this.Tkc+96+Ta*this.Yof,this.Yof)}get count(){return this._count}}Object(c.a)(Qe,"CompactIntArray",null,[585]);const Je=(Ta,zb)=>{zb=Array(zb);for(let nd=0;nd<zb.length;nd++){var cc=nd,Bc=Ta.$K(),Zc=1===(Bc>>
31&1)?-1:1;const sd=Bc&8388607;Bc=Bc>>23&255;256===Bc+1?Zc=sd?Number.NaN:1===Zc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Bc?(Bc-=127,Zc=Zc*se(sd,1)*Math.pow(2,Bc)):Zc=Zc*se(sd,0)*Math.pow(2,-126);zb[cc]=Zc}return zb},se=(Ta,zb)=>{let cc=0;for(let Bc=0;23>Bc;Bc++)cc+=(Ta>>22-Bc&1)/Math.pow(2,Bc+1);return zb+cc};class cb{constructor(Ta,zb){this.azd=null;this.kuf=0;this.Rbf=this.Qbf=this.pfc=null;this.juf=0;this.Dze=this.Cze=null;this.annotations=zb.annotations;let cc=0;this.bOg=Ta.na(cc);++cc;
this.f_a=Ta.na(cc);++cc;this.cOg=Ta.na(cc);++cc;this.dOg=Ta.na(cc);++cc;this.h_a=Ta.na(cc);++cc;this.g_a=Ta.na(cc);++cc;this.YNg=Ta.na(cc);++cc;this.$Ng=Ta.na(cc);++cc;this.ZNg=Ta.na(cc);++cc;this.aOg=Ta.na(cc);++cc;var Bc=Ta.na(cc);++cc;var Zc=Array(Bc);for(var nd=0;nd<Bc;++nd)Zc[nd]=zb.ga(Ta.na(cc)),++cc;this.JYg=ba.a.H4c(Zc);this.szi=Ta.na(cc);++cc;this.D2i=Ta.na(cc);++cc;Bc=Ta.na(cc);++cc;this.VKe={};for(Zc=0;Zc<Bc;++Zc){nd=zb.ga(Ta.na(cc));++cc;const sd=Ta.na(cc);++cc;this.VKe[nd]=sd}this.Bxd=
Ta.na(cc);++cc;this.Uzi=Ta.na(cc);++cc;Bc=Ta.na(cc);++cc;0<Bc&&(Bc=zb.mva(Ta.na(cc)),++cc,this.azd=this.Spc(new yd(Bc)));++cc;Ta=zb.mva(Ta.na(cc));this.YWi(Ta)}Spc(Ta){return new Qe(Ta.array,Ta.offset)}YWi(Ta){try{const zb=new yd(Ta);this.kuf=zb.$K();1===zb.$K()?this.pfc=ba.a.H4c(Je(zb,this.kuf)):this.pfc=null;const cc=zb.$K();this.Qbf=this.Spc(zb);zb.offset+=cc;const Bc=zb.$K();this.Rbf=this.Spc(zb);zb.offset+=Bc;this.juf=zb.$K();const Zc=zb.$K();this.Cze=this.Spc(zb);zb.offset+=Zc;this.Dze=ba.a.H4c(Je(zb,
this.juf))}catch(zb){throw Error.argument("byteReader");}}}Object(c.a)(cb,"TfIdfRankerNLModuleInit",null,[]);class Rb{constructor(Ta,zb,cc,Bc){this.VDd=Ta;this.AUe=cc;this.tokens=Bc;this.gU=zb;this.Scb=-1;this.Zvc=0}}Object(c.a)(Rb,"TokenizerData",null,[]);class uc{constructor(Ta){this.Da=Ta}execute(Ta){if(!Ta)throw Error.argumentNull("input");if(!({value:Bc}=Ta.Vi(this.Da.aha)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let zb;({value:zb}=
Ta.Vi(this.Da.$G)).returnValue||(zb=0);let cc;({value:cc}=Ta.Vi(this.Da.zJ)).returnValue||(cc=Bc.length-zb);if(0>zb||zb>Bc.length)throw Error.argument("input","Start index out of range");if(0>cc||cc>Bc.length)throw Error.argument("input","Length out of range");if(zb+cc>Bc.length)throw Error.argument("input","Bad start-length range");var Bc=new Rb(Bc,zb,zb+cc,new wa.a(this.Da.annotations,w.Annotations.TB));this.WKj(Bc);Ta=Ta.isReadOnly?Ta.clone():Ta;Ta.Hn(this.Da.b$,Bc.tokens);return Ta}WKj(Ta){for(;Ta.gU<
Ta.AUe;){if(this.Da.Aid){var zb=this.Da.Aid.Fof(Ta.VDd,Ta.gU,Ta.AUe-Ta.gU,null);!zb.succeeded&&zb.xtf&&(zb=zb.xtf);if(zb.succeeded){this.GBf(Ta,zb.length,this.Da.M5e);Ta.gU+=zb.length;continue}}zb=Ta.VDd.substr(Ta.gU);let cc=-1,Bc=-1,Zc=-1;for(let nd=0;nd<this.Da.Uuc.length;++nd){const sd=this.Da.Uuc[nd].exec(zb);sd&&0<sd[1].length&&(0>cc||sd[0].length>Bc)&&(cc=nd,Bc=sd[0].length,Zc=sd[1].length)}0<=cc?(this.GBf(Ta,Zc,this.Da.pNd[cc]),Ta.gU+=Zc):Ta.gU+=1}}GBf(Ta,zb,cc){if(this.Da.cif)cc!==uc.lUg&&
(0>Ta.Scb&&(Ta.Scb=Ta.gU),Ta.Zvc=Ta.gU+zb-Ta.Scb,cc===uc.kUg&&(0<=Ta.Scb&&0<Ta.Zvc&&(zb=new r.a(this.Da.annotations),zb.Hn(this.Da.$G,Ta.Scb),zb.Hn(this.Da.zJ,Ta.Zvc),zb.Hn(this.Da.WXc,uc.mUg),zb.Hn(this.Da.aha,Ta.VDd),Array.add(Ta.tokens.items,zb)),Ta.Scb=-1,Ta.Zvc=0));else{let Bc=new r.a(this.Da.annotations);Bc.Hn(this.Da.$G,Ta.gU);Bc.Hn(this.Da.zJ,zb);Bc.Hn(this.Da.WXc,cc);Array.add(Ta.tokens.items,Bc)}}}uc.lUg="GAP";uc.kUg="EOS_CHUNK";uc.mUg="SENTENCE";Object(c.a)(uc,"TokenizerNLModule",null,
[623]);class Sc{constructor(Ta,zb){this.zJ=this.$G=this.WXc=this.b$=this.aha=0;this.cif=!1;this.pNd=this.Uuc=this.M5e=this.Aid=null;if(Ta){this.annotations=zb.annotations;var cc=0;try{this.aha=Ta.na(cc);++cc;this.b$=Ta.na(cc);++cc;this.WXc=Ta.na(cc);++cc;this.$G=Ta.na(cc);++cc;this.zJ=Ta.na(cc);++cc;this.cif=1===Ta.na(cc);++cc;var Bc=Ta.na(cc);++cc;0<Bc&&(this.Aid=zb.Tfd(Bc).QAh);this.M5e=Ta.na(cc)?zb.ga(Ta.na(cc)):"";++cc;const Zc=Ta.na(cc);++cc;this.Uuc=Array(Zc);this.pNd=Array(Zc);for(Bc=0;Bc<
Zc;++Bc)this.Uuc[Bc]=new RegExp(zb.ga(Ta.na(cc))),++cc,this.pNd[Bc]=zb.ga(Ta.na(cc)),++cc}catch(Zc){throw Error.argument("initData");}}}}Object(c.a)(Sc,"TokenizerNLModuleInit",null,[]);class ub{constructor(Ta){this.Da=Ta}execute(Ta){if(!Ta)throw Error.argumentNull("input");let zb;if(!({value:zb}=Ta.Vi(this.Da.$te)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const cc of this.Da.MUd)zb=cc.apply(zb);Ta=w.Annotations.XA(Ta);Ta.Hn(this.Da.aue,
zb);return Ta}static hXc(Ta,zb){const cc=new Sys.StringBuilder;for(let Bc=0;Bc<Ta.length;++Bc)cc.append(zb(Ta.substr(Bc,1)));return cc.toString()}}Object(c.a)(ub,"TransliteratorNLModule",null,[623]);class Zb{constructor(Ta){Ta&&(this.style=Ta.na(0))}apply(Ta){return ub.hXc(Ta,zb=>Zb.kXg(zb,this.style))}static kXg(Ta,zb){switch(zb){case 0:return Ta.toLowerCase();case 1:return"I"===Ta?"\u0131":Ta.toLowerCase();case 2:return Ta.toUpperCase();case 3:return"i"===Ta?"\u0130":Ta.toUpperCase();default:throw Error.invalidOperation();
}}}Zb.UGa=0;Object(c.a)(Zb,"ChangeCaseTransliterationStage",null,[610]);class Ec{apply(Ta){return ub.hXc(Ta,Ec.OLj)}static OLj(Ta){const zb=Ta.charCodeAt(0);return 65281<=zb&&65374>=zb?String.fromCharCode(zb-65248):Ta}}Ec.UGa=4;Object(c.a)(Ec,"LatinFullWidthToHalfWidthTransliterationStage",null,[610]);class ed{constructor(Ta,zb){Ta&&(this.NId=zb.H2e(Ta.na(0)),this.sej=zb.ga(Ta.na(1)))}apply(Ta){return Ta.replace(this.NId,this.sej)}}ed.UGa=1;Object(c.a)(ed,"RegexReplaceTransliterationStage",null,[610]);
class Kd{constructor(Ta,zb){if(Ta){var cc=Ta.na(0),Bc=zb.ga(Ta.na(1)),Zc=new Qe(zb.mva(Ta.na(2)));Ta=0>Ta.na(3)?null:new Qe(zb.mva(Ta.na(3)));this.NVd={};for(zb=0;zb<cc;++zb)this.NVd[Bc.charAt(zb).toString()]=Bc.substr(Zc.na(zb),Ta?Ta.na(zb):1)}}apply(Ta){return ub.hXc(Ta,zb=>zb in this.NVd?this.NVd[zb]:zb)}}Kd.UGa=2;Object(c.a)(Kd,"SingleCharSubstitutionsTransliterationStage",null,[610]);class fe{constructor(Ta,zb){this.aue=this.$te=0;this.MUd=null;if(Ta){this.annotations=zb.annotations;var cc=0;
try{this.$te=Ta.na(cc);++cc;this.aue=Ta.na(cc);++cc;const Bc=Ta.na(cc);++cc;this.MUd=Array(Bc);for(let Zc=0;Zc<Bc;++Zc){const nd=Ta.na(cc);++cc;const sd=Ta.na(cc);++cc;const h=new ba.a;h.bva(Ta,cc,sd);cc+=sd;this.MUd[Zc]=this.dXi(nd,h,zb)}}catch(Bc){throw Error.argument("initData");}}}dXi(Ta,zb,cc){switch(Ta){case Zb.UGa:return new Zb(zb);case ed.UGa:return new ed(zb,cc);case Kd.UGa:return new Kd(zb,cc);case Ec.UGa:return new Ec;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");
}}}Object(c.a)(fe,"TransliteratorNLModuleInit",null,[]);class be{aTh(Ta,zb){const cc=Ta.na(0),Bc=new ba.a;Bc.bva(Ta,1,Ta.count-1);switch(cc){case 0:return new Re(new Ue(Bc,zb));case 2:return new uc(new Sc(Bc,zb));case 3:return new gd(new xe(Bc,zb));case 5:return new Xc(new M(Bc,zb));case 9:return new ub(new fe(Bc,zb));case 10:return new Ae(new cb(Bc,zb));default:throw Error.notImplemented();}}}Object(c.a)(be,"NLModuleFactory",null,[546]);class me{constructor(Ta){this.iUg=";";if(!Ta)throw Error.argumentNull("resource");
this.hR=new Md(Ta,new ua,new be);this.kwd=this.hR.LSh();this.Wof=this.hR.annotations.ivb("Text.Text");this.Uof=this.hR.annotations.ivb("Classification.Predictions");this.Uvd=this.hR.annotations.ivb("Classification.PredictionString");this.Vof=this.hR.annotations.ivb("Classification.Probability");this.xxi=this.hR.annotations.ivb("NLMod.Tokens");if(0>this.Wof||0>this.Uof||0>this.Uvd||0>this.Vof)throw Error.argument("resourceObj","Resource does not represent a ranker");}uJh(){const Ta=[];this.R$c(void 0,
this.TXe(Ta),null);return Ta}wJh(Ta,zb){const cc=[],Bc=[];this.R$c(Ta,this.TXe(cc),(Zc,nd)=>{const sd=this.hR.annotations.KXe(Zc),h=[],Hb=[];zb&&zb.length&&-1===Array.indexOf(zb,sd)||(Zc=this.hR.annotations.getAttributeType(Zc),this.ZIf(Zc,nd,h,Hb),nd=new De(sd,h,Hb),Array.add(Bc,nd))});return new we(cc,Bc)}vJh(Ta){const zb=[];this.R$c(Ta,cc=>{let Bc;if(({value:Bc}=cc.Vi(this.Uvd)).returnValue){let Zc;({value:Zc}=cc.Vi(this.Vof)).returnValue&&Array.add(zb,new ge(Bc,Zc))}},null);return zb}R$c(Ta,zb,
cc){var Bc=new r.a(this.hR.annotations);Bc.Hn(this.Wof,Ta);Ta=this.kwd.execute(Bc);if(({value:Bc}=Ta.Vi(this.Uof)).returnValue)for(const Zc of Bc.items)zb(Zc);if(cc&&({value:zb}=Ta.Vi(this.xxi)).returnValue)for(const Zc of zb.items)Zc.B$b(cc)}ZIf(Ta,zb,cc,Bc){if(w.Annotations.Lt(Ta))for(var Zc of zb.items)this.ZIf(zb.hI,Zc,cc,Bc);else if(w.Annotations.ncg(Ta)){Zc=this.hR.annotations.A1e(Ta);for(let nd=0;nd<Zc;nd++)Array.add(cc,this.hR.annotations.b4e(Ta,nd)),Array.add(Bc,this.hR.annotations.PO(this.hR.annotations.VKa(Ta,
nd),zb.xva(nd)))}else Array.add(cc,"VALUE"),Array.add(Bc,this.hR.annotations.PO(Ta,zb))}TXe(Ta){return zb=>{let cc;({value:cc}=zb.Vi(this.Uvd)).returnValue&&Array.add(Ta,this.XUh(cc))}}XUh(Ta){const zb=Ta.indexOf(this.iUg);return 0>zb?Ta:Ta.substring(0,zb)}}Object(c.a)(me,"Ranker",null,[]);var re=a(756),Xe=a(777),We=a(709),ee=a(702),xc=a(701),jd=a(4);class Nd{constructor(Ta,zb){this.dbe="";this.IPc=null;this.JPc=!1;this.jX=null;this.Omg=["TellMe.TellMeParamCollection"];this.Wa=Ta;this.Pfa=zb;this.Wa.AGa&&
(this.jX=null)}get xrc(){if(!this.IPc&&!this.JPc){let Ta=null;try{Ta=window.TellMeModel}catch(zb){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("QueryRanker","TellMeModel not found. Exception: "+zb)}if(Ta){try{this.IPc=new me(Ta)}catch(zb){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+zb)}this.JPc=!0}else if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("QueryRanker","Classifier model not found")}return this.IPc}Xx(){return"Command"}rF(){return 0===
this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc=!1,Bc=b.a.tellMe,Zc=null){const nd=new m.a(Ta);if((!Zc||Array.contains(Zc,0))&&!xc.a.mD(Ta)){if(!this.xrc&&this.JPc){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.Wa.AGa&&this.jX&&this.jX.initialize();if(re.CommandResultsUtility.Snd(Ta.Gd)&&(Zc=re.CommandResultsUtility.LYe(Ta.Gd),0<Zc.results.length)){Zc.displayName=
"Classifier Debug";nd.Km(Zc);zb.resultsUpdated(nd);return}Zc=Ta?this.dbe=Ta.Gd:this.dbe;if(jd.AFrameworkApplication.fa.qa("TellMeParameterizedQueriesEnabled")){Zc=this.ZUh(Zc);var sd=this.Fac(Zc.xgd());Zc=Zc.uXe()}else Zc=this.YUh(Zc),sd=this.HLh(Zc),Zc=[];re.CommandResultsUtility.rkc(sd,!1,"Classifier","TFIDF");sd=re.CommandResultsUtility.ccc(Ta,sd,this.Wa,this.jX,this.Pfa,Zc,0,1);0<sd.results.length&&Bc!==b.a.contextMenu&&(sd.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cc||sd.results.length||
this.Wa.Cwa||this.Wa.Wna||(Ta=new We.a("lookupNoResults",14,Ta.Gd,null,1),sd.Qn(Ta));0<sd.results.length&&nd.Km(sd);nd.attributes=Zc}zb.resultsUpdated(nd)}xgd(){let Ta=[];try{Ta=this.xrc.uJh()}catch(zb){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("GetPredictions","Exception: "+zb)}return Ta}YUh(Ta){let zb=[];try{zb=this.xrc.vJh(Ta)}catch(cc){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("GetPredictionsWithScore","Exception: "+cc)}return zb}ZUh(Ta){try{return this.xrc.wJh(Ta,
this.Omg)}catch(zb){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("GetPredictionsWithTokenAttributes","Exception: "+zb)}return new we([],[])}Fac(Ta){const zb=[];if(Ta)for(const cc of Ta)zb.push(new Xe.a(cc,-99999));return zb}HLh(Ta){const zb=[];if(Ta)for(const cc of Ta)zb.push(new Xe.a(cc.prediction,cc.score));return zb}}Object(c.a)(Nd,"CommandResultsProvider",null,[478]);var Ld=a(916),Za=a(30);class Pa{constructor(Ta,zb,cc,Bc){this.PG=Ta;this.Ara=zb;this.Mje=Bc;this.qqg=cc;this.Wa=
ee.TellMeActor.instance.Wx()}Xx(){return"EmptyQuery"}rF(){return 1===this.Wa.Rl?1:0}wv(Ta,zb,cc=!1,Bc,Zc=null){Bc=new m.a(Ta);if((!Zc||Array.contains(Zc,5)||Array.contains(Zc,6)||Array.contains(Zc,4))&&xc.a.mD(Ta)){this.PG.rKa().length||!this.qqg||this.Mje||(Ta=new l.a(6),Zc=new We.a(null,13,void 0,void 0,1),Ta.Qn(Zc),Bc.Km(Ta));Ta=new l.a(4);if(0<this.PG.rKa().length){Ta.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;Zc=this.PG.rKa();var nd=[];for(var sd of Zc)nd.push(sd.Id);re.CommandResultsUtility.Vdg(nd,
this.Wa);for(var h of Zc)re.CommandResultsUtility.Qwa(h.Id)&&Ta.Qn(new We.a(h.Id,5,null,null,2));Bc.Km(Ta)}if(this.Mje&&0<this.Ara.length&&this.PG.rKa().length<Pa.Yqf){sd=new l.a(5);sd.displayName=CommonUIStrings.l_TellMeTryQueryTitle;h=Pa.Yqf-Ta.results.length;Ta=[];for(Zc=0;Zc<this.Ara.length&&Zc<h;++Zc){if(cc){nd=xc.a.PYd+(Zc+1);const Hb=this.Ara[Zc].key,hc=Za.a.replaceAll(Hb,'"',"");Ta.push(appChrome.actions.setControlLabel(nd,Hb));Ta.push(appChrome.actions.setButtonCommandValueId(nd,hc));nd=
new Ld.a(Hb,7,0,hc,nd)}else nd=new Ld.a(this.Ara[Zc].key,7,0,this.Ara[Zc].value);sd.Qn(nd)}0<Ta.length&&appChrome.api.dispatch(Ta);Bc.Km(sd)}}zb.resultsUpdated(Bc)}}Pa.Yqf=5;Object(c.a)(Pa,"EmptyQueryResultsProvider",null,[478]);class Ab{constructor(Ta){this.Wa=Ta}Xx(){return"Feedback"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc,Bc,Zc=null){Ta=new m.a(Ta);if(!Zc||Array.contains(Zc,21))Zc=[],Zc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),
appChrome.api.dispatch(Zc),Zc=new l.a(22),Zc.displayName="",Zc.Qn(new We.a("TellMeFeedback",23,null,null,1)),Ta.Km(Zc);zb.resultsUpdated(Ta)}}Object(c.a)(Ab,"FeedbackResultsProvider",null,[478]);class Aa{constructor(Ta,zb,cc,Bc){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=Ta;this.CommandId=zb;this.CommandValueId=cc;this.InputText=Bc}}Object(c.a)(Aa,"FindInDocumentProp",null,[]);var rb=a(914);class Lb{constructor(Ta){this.ANc=2;this.zEa=[];this.Pqa=[];this.Wa=Ta;Lb.W3=
Ta.eUe;Lb.gUe="FindInDocumentSuggestion";Lb.hIf="FindInDocumentSuggestion3";this.ptg=Object.assign(new rb.a,{landingTab:"Indoc",data:null});this.lxg=this.Wa.Fdb||!!jd.AFrameworkApplication.ta&&jd.AFrameworkApplication.ta.Oa.Fdb}Xx(){return"FindInDocument"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:3===this.Wa.Rl?this.Wa.q6f?2:3:2}wv(Ta,zb,cc=!1,Bc,Zc=null){const nd=new m.a(Ta);if(Zc&&!Array.contains(Zc,2))zb.resultsUpdated(nd);else if(Array.clear(this.zEa),xc.a.mD(Ta)){if(cc&&this.R3f()){cc=new l.a(2);
cc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Zc=1;Bc="";if(0<this.Pqa.length&&!this.Wa.Hdb)for(var sd of this.Pqa)if(""!==sd.Label.toLowerCase()){if(Zc>=this.ANc)break;this.gfg(cc,sd.Label,sd.CommandValueId,Lb.gUe+Zc,sd.InputText);Zc++}sd="";this.Wa.Hy?(nd.Km(cc),cc=new l.a(3),sd=this.Wa.jsa?xc.a.kva(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):CommonUIStrings.l_TellMeOpenFindPaneTextV2):sd=CommonUIStrings.l_TellMeOpenFindPaneText;Bc=this.KYe("");this.gfg(cc,sd,Bc,Lb.hIf,"");
nd.Km(cc)}zb.resultsUpdated(nd)}else sd="",cc&&(cc=this.KYe(Ta.Gd),Bc=[],this.Wa.Axa?(this.Wa.NSd&&Bc.push(appChrome.actions.setControlIconSet(Lb.W3,{"default":"FindInDocument_20"})),sd=this.Wa.Hrd?xc.a.dfd(Ta.Gd,CommonUIStrings.l_FindInDocumentScopedButtonText):Ta.Gd+CommonUIStrings.l_FindInDocumentScopedButtonText):this.Wa.Hy?(sd=this.Wa.jsa?xc.a.kva(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,Ta.Gd)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,Ta.Gd),
Bc.push(appChrome.actions.setControlIconSet(Lb.W3,{"default":"FindInDocument_20"}))):sd=this.Wa.Hdb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,Ta.Gd),this.Wa.q4?(ee.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Lb.W3,sd)),ee.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Lb.W3,cc))):(Bc.push(appChrome.actions.setControlLabel(Lb.W3,sd)),Bc.push(appChrome.actions.setButtonCommandValueId(Lb.W3,cc)),appChrome.api.dispatch(Bc)),
this.C0f(sd,Lb.W3,cc,Ta.Gd)),this.Wa.q6f?(sd=new We.a(Lb.W3,8,Ta.Gd),cc=new l.a(2),cc.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,cc.Qn(sd),nd.Km(cc),zb.resultsUpdated(nd)):this.Wa.ZOh().then(h=>{const Hb=new We.a(Lb.W3,8,Ta.Gd,null,1);Hb.count=h;h=new l.a(2);h.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;h.Qn(Hb);nd.Km(h);zb.resultsUpdated(nd)},h=>{ee.TellMeActor.instance.tc.onError("FindInDocumentResultsProvider:issueQuery","Find manager promise rejected: "+h);h=new We.a(Lb.W3,
8,Ta.Gd,null,1);const Hb=new l.a(2);Hb.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;Hb.Qn(h);nd.Km(Hb);zb.resultsUpdated(nd)})}R3f(){return!!this.Wa&&this.Wa.$xc}gfg(Ta,zb,cc,Bc,Zc=null){const nd=[];zb&&nd.push(appChrome.actions.setControlLabel(Bc,zb));this.Wa.Hy&&nd.push(appChrome.actions.setControlIconSet(Bc,{"default":"FindInDocument_20"}));nd.push(appChrome.actions.setButtonCommandValueId(Bc,cc));appChrome.api.dispatch(nd);this.C0f(zb,Bc,cc,"");Ta.Qn(new We.a(Bc,8,Zc,null,1,-99999))}KYe(Ta){return this.lxg?
xc.a.tta(Ta,15,this.ptg):Za.a.nf(Ta)}C0f(Ta,zb,cc,Bc){this.R3f()&&this.zEa.length<this.ANc&&(Ta=new Aa(Ta,zb,cc,Bc),Array.add(this.zEa,Ta))}Brj(Ta){for(let zb=0;zb<this.zEa.length;zb++)if(this.zEa[zb].CommandId===Ta){const cc=this.zEa[zb].Label;let Bc=!1;if(0<this.Pqa.length){let Zc=0;for(const nd of this.Pqa){if(nd.Label===cc){Array.removeAt(this.Pqa,Zc);Bc=!0;break}Zc++}}!Bc&&this.Pqa.length>=this.ANc-1&&Array.removeAt(this.Pqa,1);Array.insert(this.Pqa,0,this.zEa[zb])}}}Lb.W3=null;Lb.gUe=null;Lb.hIf=
null;Object(c.a)(Lb,"FindInDocumentResultsProvider",null,[478]);var oc=a(1099);class $c{constructor(Ta){this.Wa=Ta}Xx(){return"Insights"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc=!1,Bc,Zc=null){Bc=new m.a(Ta);if(!Zc||Array.contains(Zc,13))if(this.gyj()||!xc.a.mD(Ta)){Zc=new l.a(13);var nd=""===Ta.Gd.trim(),sd=nd?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",h=new We.a(sd,10,Ta.Gd,null,1);cc&&(cc=null,xc.a.k5()?nd?nd=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(nd=this.Wa.Hdb?
CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,Ta.Gd),cc=xc.a.tta(Ta.Gd,1)):(nd=String.format(CommonUIStrings.l_InsightsButtonText,Ta.Gd),cc=xc.a.P4c(Ta.Gd)),this.Wa.q4?(ee.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(sd,nd)),cc&&ee.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",cc))):(Ta=[],Ta.push(appChrome.actions.setControlLabel(sd,nd)),cc&&Ta.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
cc)),appChrome.api.dispatch(Ta)),h.label=nd);Zc.Qn(h);Bc.Km(Zc)}zb.resultsUpdated(Bc)}gyj(){return xc.a.k5()&&this.Wa.rIj}}Object(c.a)($c,"InsightsResultsProvider",null,[478]);var Fd=a(1097);class Cd{constructor(Ta){this.Wa=Ta}Xx(){return"Learning"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc,Bc,Zc=null){cc=new m.a(Ta);Zc&&!Array.contains(Zc,21)||!xc.a.mD(Ta)||(Zc=[],Bc=this.Wa.bsi,Zc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Bc)),Bc=Cd.GPh(Bc),Zc.push(appChrome.actions.setControlLabel("LearningForSearch",
Bc)),appChrome.api.dispatch(Zc),Ta=new We.a("LearningForSearch",22,Ta.Gd,null,1),Zc=new l.a(21),Zc.Qn(Ta),cc.Km(Zc));zb.resultsUpdated(cc)}static GPh(Ta){const zb=[];Array.add(zb,new Fd.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(zb,new Fd.a(400,CommonUIStrings.l_TellMeLearningButtonText));Array.add(zb,new Fd.a(600,Ta));Array.add(zb,new Fd.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));Ta={};Ta.parts=zb;return JSON.stringify(Ta)}}Object(c.a)(Cd,"LearningProvider",null,
[478]);var $d=a(455);class he{constructor(Ta,zb){this.RWa=this.tYa=this.bra=this.WUb=null;this.dC=!1;this.kXa=Ta;this.Tog=zb;Ta&&this.SSe(Ta)}oBc(){this.kXa.oBc()&&this.SSe(this.kXa)}YYh(Ta){let zb=[];var cc=[];Ta=he.VDi(Ta);var Bc="";Array.clear(cc);for(let Zc=0;Zc<Ta.length;Zc++){const nd=Ta.charAt(Zc);-1!==" ".indexOf(nd)?(Bc.length&&Array.add(cc,Bc),Bc=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(nd)?(Bc.length&&Array.add(cc,Bc),Bc=nd,Array.add(cc,Bc),Bc=""):Bc+=nd}Bc.length&&Array.add(cc,
Bc);for(Ta=0;Ta<cc.length;Ta++)Bc=this.GLh(cc[Ta]),Bc=this.p4g(Bc),zb=he.CAi(zb,Bc);return zb=this.IDg(zb)}Z6a(){this.dC||this.oBc();return this.dC}d6b(Ta){return this.WUb[Ta.toString()]}IDg(Ta){for(let zb=0;zb<Ta.length;zb++){const cc=this.bra[zb];if(Ta[zb].commandId!==this.d6b(cc[0]))throw Error.create("Incorrect Tcid orders with Priors data");let Bc;(Bc=Ta[zb]).score=Bc.score+cc[1]}return Ta}p4g(Ta){const zb=[];for(var cc=0;cc<this.bra.length;cc++)zb.push(new Xe.a(this.d6b(this.bra[cc][0]),-5));
cc=new $d.a;for(var Bc=0;Bc<Ta.length;Bc++)cc.add(this.d6b(Ta[Bc][0]));for(Bc=0;Bc<zb.length;Bc++){const nd=zb[Bc];for(let sd=0;sd<Ta.length;sd++){var Zc=Ta[sd];const h=this.d6b(Zc[0]);Zc=Zc[1];if(h===nd.commandId){nd.score=Zc;cc.remove(h);break}}if(!cc.count)break}return zb}GLh(Ta){const zb=1>Ta.length;for(let sd=0;2>=sd;sd++){const h=this.RWa;for(let Hb in h){var cc=h[Hb],Bc=Ta,Zc=Hb;const hc=Zc.length+1,Hc=Array((Bc.length+1)*hc);for(var nd=0;nd<=Bc.length;nd++)Hc[nd*hc]=nd;for(nd=0;nd<=Zc.length;nd++)Hc[nd]=
nd;for(nd=0;nd<Zc.length;nd++)for(let id=0;id<Bc.length;id++)Hc[(id+1)*hc+(nd+1)]=Bc.charAt(id)===Zc.charAt(nd)?Hc[id*hc+nd]:Math.min(Math.min(Hc[id*hc+(nd+1)]+1,Hc[(id+1)*hc+nd]+1),Hc[id*hc+nd]+1);Bc=Hc[Bc.length*hc+Zc.length];if((!Bc||!zb)&&Bc<=sd)return cc}}return this.tYa}SSe(Ta){this.WUb=Ta.Sfd();this.bra=Ta.sVh();this.tYa=Ta.u_h();this.RWa=Ta.ARh();if(this.dC=!!this.WUb&&!!this.bra&&!!this.RWa&&!!this.tYa)this.dC=0<this.bra.length&&he.mnd(this.bra);this.dC&&(this.dC=0<this.tYa.length&&he.mnd(this.tYa));
this.dC&&(this.RWa=he.W_h(this.RWa));this.dC||(this.RWa=this.tYa=this.bra=this.WUb=null)}b_h(Ta){Ta=this.YYh(Ta);return this.IAh(Ta,this.Tog)}IAh(Ta,zb){let cc=[];for(let Bc=0;Bc<Ta.length;Bc++)Ta[Bc].score>=zb&&cc.push(Ta[Bc]);cc.sort((Bc,Zc)=>Bc.score<Zc.score?1:Bc.score>Zc.score?-1:0);0<cc.length-10&&(cc=cc.slice(0,10));return cc}static CAi(Ta,zb){if(!Ta.length)return zb;if(Ta.length!==zb.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");
for(let cc=0;cc<Ta.length;cc++){if(Ta[cc].commandId!==zb[cc].commandId)throw Error.create("Incorrect CommandId");let Bc;(Bc=Ta[cc]).score=Bc.score+zb[cc].score}return Ta}static VDi(Ta){return Za.a.sl(Ta)}static mnd(Ta){for(let zb=0;zb<Ta.length;zb++)if(2!==Ta[zb].length)return!1;return!0}static W_h(Ta){const zb={};for(let Zc in Ta){var cc=Zc,Bc=Ta[Zc];const nd=Bc;nd.length&&he.mnd(nd)&&(zb[cc]=Bc)}return zb}}Object(c.a)(he,"NaiveBayesClassifierModel",null,[]);class ue{constructor(Ta,zb){this.jX=null;
this.Wa=Ta;this.fkb=new he(zb,Ta.c1e);this.Wa.AGa&&(this.jX=null)}Xx(){return"NBCommand"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc=!1,Bc=b.a.tellMe,Zc=null){const nd=new m.a(Ta);if((!Zc||Array.contains(Zc,0))&&!xc.a.mD(Ta)){if(re.CommandResultsUtility.Snd(Ta.Gd)&&(Zc=re.CommandResultsUtility.LYe(Ta.Gd),0<Zc.results.length)){Zc.displayName="Classifier Debug";nd.Km(Zc);zb.resultsUpdated(nd);return}if(!this.fkb.Z6a()){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("CRASH",
"NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.Wa.AGa&&this.jX&&this.jX.initialize();Zc=this.fkb.b_h(Ta.Gd);re.CommandResultsUtility.rkc(Zc,!1,"Classifier","NaiveBayesian");Zc=re.CommandResultsUtility.ccc(Ta,Zc,this.Wa,this.jX,null,null,0,1);0<Zc.results.length&&Bc!==b.a.contextMenu&&(Zc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);cc||Zc.results.length||this.Wa.Cwa||this.Wa.Wna||(Ta=new We.a("lookupNoResults",
14,Ta.Gd,null,1),Zc.Qn(Ta));0<Zc.results.length&&nd.Km(Zc)}zb.resultsUpdated(nd)}}Object(c.a)(ue,"NaiveBayesCommandProvider",null,[478]);class Me{constructor(){this.xEa=null;this.dC=!1;this.oBc()}oBc(){this.dC||(this.xEa=window.NBCRM)&&4===this.xEa.length&&(this.dC=!0);return this.dC}sVh(){return this.dC?this.xEa[1]:null}u_h(){return this.dC?this.xEa[2]:null}ARh(){return this.dC?this.xEa[3][0]:null}Sfd(){return this.dC?this.xEa[0][0]:null}}Object(c.a)(Me,"NaiveBayesModelAdapter",null,[493]);var ff=
a(199);class Ve{constructor(Ta){this.Wa=Ta}Xx(){return"OfficeScript"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb){const cc=new m.a(Ta);if(!xc.a.mD(Ta)){Ta=ff.d(Ta.Gd);var Bc=new l.a(25);Bc.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Bc=this.tne(Ta,Ve.SOj,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,Bc);Bc=this.tne(Ta,Ve.REh,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Bc);cc.Km(Bc)}zb.resultsUpdated(cc)}tne(Ta,
zb,cc,Bc,Zc,nd){const sd=[];for(const h of zb)if(ff.a(Ta,h)){this.Wa.q4?(ee.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(cc,Zc)),ee.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(cc,Bc))):(sd.push(appChrome.actions.setControlLabel(cc,Zc)),sd.push(appChrome.actions.setButtonCommandValueId(cc,Bc)),appChrome.api.dispatch(sd));nd.Qn(new We.a(cc,26,null,null,1));break}return nd}}Ve.SOj="unhide row rows col cols column columns".split(" ");Ve.REh=["freeze",
"selection","pane","panes"];Object(c.a)(Ve,"OfficeScriptsSamplesProvider",null,[478]);var Ze=a(187),gf=a(331),Nf=a(802),Df=a(743),tg=a(801),Fg=a(41),Rf=a(173),Ea=a(695);class Fb{constructor(Ta){this.Qy=null;this.HG=-1;this.bxd=14;this.exd=12;this.attributes=this.WSc=this.query=null;this.o7a=!1;this.JXa=[];this.zh=jd.AFrameworkApplication.yd;jd.AFrameworkApplication.fa&&(this.bxd=jd.AFrameworkApplication.fa.qd("TellMeMaxTermedResults",this.bxd),this.exd=jd.AFrameworkApplication.fa.qd("TellMeMaxZeroTermResults",
this.exd));this.uB=Ta}get vh(){return this.JXa}get BBc(){return this.WSc}Km(Ta){let zb=!1;for(let cc=0;cc<this.vh.length;cc++)if(27!==this.vh[cc].groupType&&this.vh[cc].groupType===Ta.groupType){this.bVc(this.vh[cc],Ta);zb=!0;break}zb||this.vh.push(Ta)}bVc(Ta,zb){for(let cc=0;cc<zb.results.length;cc++)Ta.Qn(zb.results[cc])}UQf(Ta){const zb=[];for(const cc of this.vh)cc.groupType!==Ta&&zb.push(cc);this.vh.length!==zb.length&&(this.JXa=zb)}V$i(Ta){let zb=null,cc=null,Bc=null;for(let Zc=0;Zc<Ta.length;Zc++){const nd=
Ta[Zc];if(nd&&nd.vh&&nd.vh.length)for(const sd of nd.vh)if(17===sd.groupType||18===sd.groupType)zb=sd;else if(0===sd.groupType||16===sd.groupType)cc=sd,Bc=nd}zb&&cc&&0<cc.results.length&&(17===zb.groupType&&({NUc:cc,eVc:zb}=re.CommandResultsUtility.ICg(cc,zb,this.uB.Wx()?this.uB.Wx().gLh:-.6)),Bc.UQf(cc.groupType))}FDj(){new Ze.a;this.dNb(this.uB.Vpf)}MAb(Ta,zb){return this.query.Gd.length>this.uB.Wx().BVh&&this.ali(Ta,zb)||this.query.Gd.length>this.uB.Wx().CVh&&this.Cni(Ta,zb)?!0:!1}Cni(Ta,zb){return Ta&&
Ta.length&&zb&&zb.length?-1===zb.toLowerCase().indexOf(Ta.toLowerCase())?!1:!0:!1}ali(Ta,zb){return Ta&&Ta.length&&zb&&zb.length?zb.toLowerCase().startsWith(Ta.toLowerCase()):!1}NAh(Ta){const zb=[];for(const cc of this.uB.Wx().Hy?this.BBc:this.vh)Ta.contains(cc.groupType)||zb.push(cc);this.uB.Wx().Hy?this.WSc=zb:this.JXa=zb}qTj(Ta,zb){const cc=[];for(const Bc of this.vh){const Zc=Bc;if(13!==Zc.groupType){const nd=Ta[Df.a[Zc.groupType].toLowerCase()];let sd="False";nd<zb&&(sd="True");Zc.displayName=
Zc.displayName+" ("+sd+": "+nd+")"}cc.push(Zc)}this.JXa=cc}dNb(Ta,zb=!1,cc=null){if(this.uB.Wx().Hy){if(!zb)for(this.WSc=Array(this.vh.length),zb=0;zb<this.vh.length;zb++)this.BBc[zb]=this.vh[zb];this.uB.dqf.dNb(this.vh,this.BBc,this.query,Ta,cc)}else{for(cc=new Ze.a;this.vh.length;){zb=this.vh.pop();const Bc=Df.a[zb.groupType].toLowerCase(),Zc=Ta[Bc];if(Ea.c(Zc))throw Error.create("GroupId "+Bc+" missed from group SortingOrder");cc.add(new gf.a(Zc,zb))}cc.Sc((Bc,Zc)=>Bc.key<Zc.key?-1:1);for(Ta=0;Ta<
cc.count;Ta++)zb=cc.na(Ta).value,this.vh.push(zb)}}GDj(){var Ta=!1;let zb=!1,cc=!1;for(let Zc=0;Zc<this.vh.length;Zc++){var Bc=this.vh[Zc];const nd=Bc.groupType;if(8===nd||15===nd||14===nd){Bc=Bc.results;for(let sd=0;sd<Bc.length;sd++){if(8===nd&&this.MAb(this.query.Gd,Bc[sd].label)){Ta=!0;break}if(15===nd&&this.MAb(this.query.Gd,Bc[sd].label)){zb=!0;break}if(14===nd){if(this.MAb(this.query.Gd,Bc[sd].label)||this.MAb(this.query.Gd,Bc[sd].description)){cc=!0;break}const h=Bc[sd].label.split(" ");for(const Hb of h)if(this.MAb(this.query.Gd,
Hb)){cc=!0;break}}}}}Ta=this.uB.XWh(Ta,zb,cc);this.dNb(Ta)}rPa(Ta,zb,cc,Bc,Zc,nd){if(Zc===this.Qy){var sd=Ta.data.Xd;Zc=null;try{Zc=Fg.b(sd)}catch(ie){ee.TellMeActor.instance.tc.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+ie);return}if("RankerResults"in Zc&&Zc.RankerResults){this.V2();var h=Zc.RankerResults,Hb=new Ze.a,hc=new Ze.a;sd=0;for(var Hc of h){h=Hc.ProviderId;var id=Hc.Score;sd+=id;Hb.add(new gf.a(h,id))}Hb.Sc((He,te)=>He.value>te.value?
-1:1);id=nd?nd.HXh:1E-6;Hc={};h={};let ie=0;for(var Ed=0;Ed<Hb.count;Ed++){let He=parseInt(Hb.na(Ed).key),te=Hb.na(Ed).value/sd;1===He&&(h.answer=ie++,h.entity=ie++,h.definition=ie++,h.wolframanswer=ie++,te<id&&(hc.add(9),hc.add(11),hc.add(10),hc.add(12)),Hc.answer=te,Hc.entity=te,Hc.definition=te,Hc.wolframanswer=te);2===He&&(h.assistance=ie++,te<id&&hc.add(8),Hc.assistance=te);3===He&&(h.classifier=ie++,h.serviceclassifier=ie++,te<id&&(hc.add(0),hc.add(17)),Hc.classifier=te,Hc.serviceclassifier=
te);4===He&&(h.people=ie++,te<id&&hc.add(14),Hc.people=te);5===He&&(h.document=ie++,te<id&&hc.add(15),Hc.document=te);6===He&&(h.findindocument=ie++,te<id&&hc.add(2),Hc.findindocument=te);7===He&&(h.notes=ie++,te<id&&hc.add(20),Hc.notes=te);8===He&&(h.image=ie++,te<id&&hc.add(19),Hc.image=te)}Hb=new Ze.a;Hb.add("classifier");Hb.add("serviceclassifier");Hb.add("appsforoffice");Hb.add("addin");Hb.add("findindocument");Hb.add("assistance");Hb.add("document");Hb.add("people");Hb.add("answer");Hb.add("wolframanswer");
Hb.add("definition");Hb.add("entity");Hb.add("image");Hb.add("template");Hb.add("officescript");for(Ed=0;Ed<Hb.count;Ed++)Hb.na(Ed)in h||(h[Hb.na(Ed)]=ie++);h.learning=ie++;h.insights=ie++;h.feedback=ie++;nd&&nd.Wji&&this.qTj(Hc,id);nd&&nd.Xji&&this.NAh(hc);hc={};for(var Id in Hc)hc[Id]=Hc[Id]*sd;this.dNb(h,!0,hc)}if(nd.jrd&&"Intents"in Zc&&Zc.Intents){Id=Zc.Intents;for(var Xd of Id)if(this.hsd(Xd)&&"Serplet"===Xd.GroupType&&Xd.ConfidenceScore>Xd.ConfidenceThreshold){Id=!1;Zc=0;if(nd.krd){sd=new We.a("",
28);for(hc=0;hc<this.vh.length;hc++)if((Hb=this.vh[hc].results)&&0<Hb.length){Zc=hc;sd=Hb[0];break}2===sd.groupType&&(Id=!0)}sd=new l.a(13);Id&&nd.krd&&(sd=new l.a(13,CommonUIStrings.l_TellMeWebTitle));hc=new We.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Gd,null,0);Hb=[];Hc=null;Hc=xc.a.k5()?xc.a.tta(this.query.Gd,1):xc.a.P4c(this.query.Gd);Hb.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Hc));Hc=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,
this.query.Gd);Hb.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Hc));appChrome.api.dispatch(Hb);sd.Qn(hc);hc=[];if(Id&&nd.krd)for(hc.push(this.vh[Zc]),hc.push(sd),Id=Zc+1;Id<this.vh.length;Id++)(Zc=this.vh[Id].results)&&0<Zc.length&&hc.push(this.vh[Id]);else for(hc.push(sd),Id=0;Id<this.vh.length;Id++)(Zc=this.vh[Id].results)&&0<Zc.length&&hc.push(this.vh[Id]);this.JXa=hc}}if(nd.PAb&&!nd.Hy){Xd=Id=-1;for(Zc=0;Zc<this.vh.length;Zc++)switch(this.vh[Zc].groupType){case 23:Id=
Zc;break;case 0:case 17:case 2:-1===Xd&&(Xd=Zc)}if(-1!==Id){Xd=-1===Xd?0:Id>Xd?Xd+1:Xd;Id=this.vh[Id];Zc=Array(this.vh.length);sd=0;for(hc=0;hc<Zc.length;hc++)hc===Xd?Zc[hc]=Id:(23===this.vh[sd].groupType&&sd++,Zc[hc]=this.vh[sd],sd++);this.JXa=Zc}}Bc.resultsUpdated(this);Bc=ee.TellMeActor.instance.tc;Bc.C_(zb.length,"RankerInference",Ta.data.httpStatus.toString(),Math.round(window.performance.now()-cc),tg.a.b$f,!0,Nf.a.eba);this.o7a&&Bc&&(Ta=this.query.Iza,zb=Bc.fSb,nd.zic&&Ta>zb&&!nd.Hy&&(Bc.lvd(this.query.Gd),
Bc.FPd(Ta)))}}hsd(Ta){if("GroupType"in Ta&&Ta.GroupType&&"ConfidenceScore"in Ta&&"ConfidenceThreshold"in Ta)return!0;ee.TellMeActor.instance.tc.onError("IsValidIntentGroup","Invalid intents found");return!1}ePa(Ta,zb,cc,Bc,Zc){Bc===this.Qy&&(this.V2(),ee.TellMeActor.instance.tc.C_(zb.length,"RankerInference",Ta.data.httpStatus.toString(),Math.round(window.performance.now()-cc),tg.a.b$f,!1,Nf.a.eba));Zc.resultsUpdated(this)}V2(){-1!==this.HG&&(window.clearTimeout(this.HG),this.HG=-1)}HDj(Ta){let zb;
zb=this.uB.Wx().Hy?ee.TellMeActor.instance.tc.uhd(this.BBc,this.query.Gd):ee.TellMeActor.instance.tc.uhd(this.vh,this.query.Gd);var cc=this.uB.Wx().GXh;""!==cc&&(cc="_"+cc);let Bc="";this.uB.Wx().Lpd&&(Bc="RankerInference"+cc+",");this.uB.Wx().jrd&&(Bc+="SerpletClassifier");","===Bc.charAt(Bc.length-1)&&(Bc=Bc.substring(0,Bc.length-1));cc=ee.TellMeActor.instance.tc.r4e(Bc);const Zc=this.Qy=Rf.a.create().toString();cc["Client-Request-Id"]=Zc;const nd=window.performance.now(),sd=this.uB.Wx()?this.uB.Wx().IXh:
600;this.V2();this.HG=window.setTimeout(()=>{if(Zc===this.Qy){this.Qy="";this.HG=-1;Ta.resultsUpdated(this);const h={};h[d.a.provider]="Ranker";h[d.a.kQa]=this.query.Iza;ee.TellMeActor.instance.tc.GN(f.a.timedOut,sd,h)}},sd);this.zh.Jm(ee.TellMeActor.instance.tc.s4e(),2,zb,cc,!1,0,h=>{this.rPa(h,this.query.Gd,nd,Ta,Zc,this.uB.Wx())},h=>{this.ePa(h,this.query.Gd,nd,Zc,Ta)},null,null,!1,4E3,6E3)}MMj(){var Ta=0,zb=new Ze.a,cc=this.uB.Tpf,Bc=this.uB.Upf;for(var Zc=0;Zc<this.vh.length;Zc++){var nd=this.vh[Zc],
sd=Df.a[nd.groupType].toLowerCase(),h=cc[sd];Ta+=nd.results.length;nd.results.length>h&&(sd=Bc[sd],Ea.c(sd)||zb.add(new gf.a(sd,nd)))}Bc=!this.query||""===this.query.Gd.trim();Zc=Ta-(Bc?this.exd:this.bxd);if(!(0>=Zc)){Bc=window.performance.now();Ta=Ta.toString()+" total,"+Zc.toString()+" to remove.";if(0<zb.count)for(zb.Sc((Hb,hc)=>Hb.key>hc.key?-1:1),nd=0;nd<zb.count&&0<Zc;nd++){sd=zb.na(nd).value;h=Df.a[sd.groupType].toLowerCase();let Hb=sd.results.length-cc[h];Hb>Zc&&(Hb=Zc);0<Hb&&(sd.XJd(Hb),
Ta+=h+": "+Hb.toString()+" results removed.",Zc-=Hb)}if(0<Zc){Ta+=Zc.toString()+" results left after trimming.";zb=new Ze.a;cc=this.uB.Ypf;for(nd=0;nd<this.vh.length;nd++)sd=this.vh[nd],h=cc[Df.a[sd.groupType].toLowerCase()],Ea.c(h)||zb.add(new gf.a(h,sd));zb.Sc((Hb,hc)=>Hb.key<hc.key?-1:1);for(cc=0;0<Zc;)nd=zb.na(cc++).value,Zc>=nd.results.length?(Array.remove(this.vh,nd),Ta+=Df.a[nd.groupType]+": "+nd.results.length.toString()+" results force removed.",Zc-=nd.results.length):(nd.XJd(Zc),Ta+=Df.a[nd.groupType]+
": "+Zc.toString()+" results force removed.",Zc=0)}ee.TellMeActor.instance.tc&&(zb={},zb[d.a.message]=Ta,ee.TellMeActor.instance.tc.GN("ShowOptimal",window.performance.now()-Bc,zb))}}}Object(c.a)(Fb,"CombineResultsUpdatedEventArgs",null,[467]);var Gc=a(915);class hd{constructor(Ta,zb,cc,Bc=!1,Zc=""){this.YOc=this.fQc=!1;this.dE=Ta;this.VEa=[];this.xfe=zb.length;this.Wa=ee.TellMeActor.instance.Wx();this.oUb=Bc;this.pFa=Zc;this.gYa={};for(Ta=0;Ta<zb.length;++Ta)this.gYa[Ta.toString()]=cc?0:zb[Ta].rF()}Bsj(Ta,
zb){zb&&zb.query&&zb.query.Iza<ee.TellMeActor.instance.HX||(this.VEa[Ta]=zb,this.YOc?this.fQc=!0:(!this.Wa||3!==this.Wa.Rl||3!==this.gYa[Ta.toString()]||this.WIe())&&this.ufc())}EXi(){this.YOc=!0}gPj(){this.YOc=!1;this.fQc&&(this.fQc=!1,this.ufc())}WIe(){if(this.VEa.length<this.xfe)return!1;for(let Ta=0;Ta<this.xfe;++Ta)if(!this.VEa[Ta])return!1;return!0}ufc(){var Ta=this.WIe();const zb=window.performance.now(),cc=new Fb(ee.TellMeActor.instance.x8d);cc.V$i(this.VEa);for(var Bc=0;Bc<this.VEa.length;++Bc){var Zc=
this.VEa[Bc];if(Zc&&Zc.vh&&Zc.vh.length&&(cc.query=Zc.query,Zc.attributes&&0<Zc.attributes.length&&(cc.attributes=Zc.attributes),Zc&&Zc.vh&&(Ta||this.kYg(Bc,this.VEa))))for(const nd of Zc.vh)cc.Km(nd)}cc.vh&&cc.vh.length&&(cc.o7a=Ta,this.Wa&&this.Wa.zYd&&cc.MMj(),Gc.a.yif()&&(this.Wa&&this.Wa.rmi&&cc.query.Gd&&0<cc.query.Gd.length?cc.GDj():cc.FDj()),Gc.a.yif()&&this.Wa&&(this.Wa.Lpd||this.Wa.jrd)&&this.oUb&&cc.query.Gd&&0<cc.query.Gd.length&&cc.o7a&&this.pFa!==b.a.contextMenu?(3===this.Wa.Rl&&Ta||
this.dE.resultsUpdated(cc),cc.HDj(this.dE)):this.dE.resultsUpdated(cc),Ta=ee.TellMeActor.instance.tc,cc.o7a&&Ta&&(Bc=cc.query.Iza,Zc=Ta.fSb,cc.query.Gd&&0<cc.query.Gd.length&&this.oUb&&this.Wa.zic&&this.pFa!==b.a.contextMenu&&Bc>Zc&&!this.Wa.Lpd&&!this.Wa.Hy&&(Ta.lvd(cc.query.Gd),Ta.FPd(Bc)),Ta.GN(f.a.Mhj,window.performance.now()-zb)))}kYg(Ta,zb){if(!(this.gYa&&Ta.toString()in this.gYa)||zb.length<=Ta||!zb[Ta])return!1;if(!zb[Ta].vh.length)return!0;const cc=this.gYa[Ta.toString()];if(0===cc)return!0;
const Bc=this.gYa;for(let nd in Bc){var Zc=Bc[nd];const sd=Number.parseInvariant(nd);if(sd!==Ta&&Zc===cc&&!(zb.length>sd&&zb[sd]))return!1}return!0}}Object(c.a)(hd,"ResultsAggregator",null,[]);var Ad=a(1199);class Td{constructor(){this.Oeb=this.Peb=this.Neb=this.logCount=this.logRank=this.invertedRank=0}vCg(Ta,zb){switch(Ta){case 1:this.invertedRank=zb;break;case 3:this.logRank=zb;break;case 2:this.logCount=zb;break;case 5:this.Neb=zb;break;case 4:this.Peb=zb;break;case 6:this.Oeb=zb}}}Object(c.a)(Td,
"CommandFeatures",null,[]);class pe{constructor(Ta){this.B7d=0;this.cug=Ta;this.Xng={}}get modelId(){return this.cug}get featureIntercept(){return this.B7d}get Cqb(){return this.Xng}WBg(Ta,zb,cc){0===zb?this.B7d=cc:(this.Cqb[Ta]||(this.Cqb[Ta]=new Td),this.Cqb[Ta].vCg(zb,cc))}}Object(c.a)(pe,"CoefficientsModel",null,[]);const qe=(Ta,zb)=>Math.pow(10,-zb/(60*Math.LN10/Math.LN2*Ta));class $e{constructor(Ta,zb){this.Qvg=Ta;this._count=1;this.rfa=new Td;this.features.logCount=1+Math.log(this.count)/Math.LN2;
this.features.invertedRank=Ta?1/Ta:0;this.features.logRank=2/Math.pow(2,Ta);this.features.Neb=qe(10,zb);this.features.Peb=qe(2,zb);this.features.Oeb=qe(1,zb)}get nQa(){return this.Qvg}get count(){return this._count}get features(){return this.rfa}c9h(){this._count=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}oTj(Ta){const zb=2/Math.pow(2,Ta);this.features.invertedRank=Math.max(this.features.invertedRank,Ta?1/Ta:0);this.features.logRank=Math.max(this.features.logRank,zb)}eUj(Ta){const zb=
qe(10,Ta),cc=qe(2,Ta);Ta=qe(1,Ta);this.features.Neb=Math.max(this.features.Neb,zb);this.features.Peb=Math.max(this.features.Peb,cc);this.features.Oeb=Math.max(this.features.Oeb,Ta)}}Object(c.a)($e,"CommandModel",null,[]);class Ie{constructor(Ta){this.khb=null;if(!Ta&&ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("PredictionEngine","IModelAdapter can't be null");this.kXa=Ta;this.VUb=this.tud()}tud(){const Ta=this.kXa.ISh(),zb=this.kXa.Sfd();if(void 0===Ta||null===Ta||void 0===zb||null===
zb)return!1;try{window.performance.now();this.khb={};for(let cc=0;cc<Ta.length;cc++){const Bc=Ta[cc],Zc=zb[Bc[0].toString()].trim(),nd=Bc[1],sd=0!==nd?zb[Bc[2].toString()].trim():"",h=Bc[3];Zc in this.khb||(this.khb[Zc]=new pe(Zc));this.khb[Zc].WBg(sd,nd,h)}}catch(cc){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("LoadModelData","Error Loading Suggestions Model: "+cc);return!1}return!0}oGh(){const Ta=this.kXa.aRh(),zb={};if(!Ta)return zb;let cc=1;for(let Bc=0;Bc<Ta.length;Bc++){const Zc=
Ta[Bc];Zc.Id in zb?(zb[Zc.Id].c9h(),zb[Zc.Id].oTj(cc),zb[Zc.Id].eUj(Zc.TimeElapsedSinceClick)):zb[Zc.Id]=new $e(cc,Zc.TimeElapsedSinceClick);cc++}return zb}Z6a(){this.VUb||(this.VUb=this.tud());return this.VUb}WUh(){let Ta=[];if(!this.VUb){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("GetPredictedCommands","IModelAdapter returned no data");return Ta}const zb=this.oGh(),cc=this.khb;for(let Zc in cc){const nd=cc[Zc],sd=nd.modelId;let h=0;for(let Hb in zb){var Bc=Hb;const hc=zb[Hb].features;
(Bc=Bc in nd.Cqb?nd.Cqb[Bc]:null)&&(h+=hc.invertedRank*Bc.invertedRank+hc.logRank*Bc.logRank+hc.logCount*Bc.logCount+hc.Neb*Bc.Neb+hc.Peb*Bc.Peb+hc.Oeb*Bc.Oeb)}h+=nd.featureIntercept;Ta.push(new Xe.a(sd,h))}Ta.sort((Zc,nd)=>Zc.score<nd.score?1:Zc.score>nd.score?-1:0);0<Ta.length-10&&(Ta=Ta.slice(0,10));return Ta}}Object(c.a)(Ie,"PredictionEngine",null,[]);class af{constructor(){this.uhe={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}Fac(Ta,zb){return zb&&"word"===zb.application.toLowerCase()&&
Ta in this.uhe?this.uhe[Ta]:[]}}Object(c.a)(af,"SuggestionResultsUtility",null,[]);class Ce{constructor(Ta,zb,cc){this.Wa=zb;this.fkb=new Ie(Ta);this.PG=cc;this.Wie=new af}Xx(){return"Suggestion"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(Ta,zb,cc,Bc=b.a.tellMe,Zc=null){cc=new m.a(Ta);ee.TellMeActor.instance.FPb=!1;if((!Zc||Array.contains(Zc,16))&&xc.a.mD(Ta)){if(!this.fkb.Z6a()){if(ee.TellMeActor.instance.tc)ee.TellMeActor.instance.tc.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}if(this.grd()&&0<this.Wie.Fac(ee.TellMeActor.instance.C5b,this.Wa).length){const sd=this.Wie.Fac(ee.TellMeActor.instance.C5b,this.Wa);Zc=[];for(var nd of sd)this.Wa.$xc&&"Find"===nd||Zc.push(new Xe.a(nd,0));ee.TellMeActor.instance.FPb=!0}else Zc=this.fkb.WUh();re.CommandResultsUtility.rkc(Zc,!0,"Recommended","LRE");nd=[];for(const sd of Zc)this.PG&&this.PG.S2c(sd.commandId)||nd.push(sd);Ta=re.CommandResultsUtility.ccc(Ta,
nd,this.Wa,null,null,null,16,1);0<Ta.results.length&&Bc!==b.a.contextMenu&&(Ta.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<Ta.results.length&&cc.Km(Ta)}zb.resultsUpdated(cc)}grd(){return!!this.Wa&&(this.Wa.grd||this.Wa.tpi)}}Object(c.a)(Ce,"SuggestionResultsProvider",null,[478]);class uf{aRh(){return ee.TellMeActor.instance.WGc}ISh(){return window.TellMeSuggestionModel}Sfd(){return window.CoefficientModelIdMap}}Object(c.a)(uf,"SuggestionsModelAdapter",null,[491]);var mf=a(1274),Cf=a(1100);
a.d(C,"AggregatorResultsProvider",function(){return hg});class hg{constructor(Ta=!1){this.zXa={};this.zXa[b.a.tellMe]=[];this.zXa[b.a.contextMenu]=[];this.oUb=Ta}Hjf(Ta,zb,cc,Bc,Zc=null){let nd;var sd=!1;switch(Bc){case b.a.contextMenu:nd=this.zXa[b.a.contextMenu];sd=!0;break;default:nd=this.zXa[b.a.tellMe]}zb=new hd(zb,nd,sd,this.oUb,Bc);zb.EXi();for(let h=0;h<nd.length;++h){const Hb=window.performance.now(),hc=new k(zb,h);(sd=ee.TellMeActor.instance.Wx())&&sd.BQg?window.setTimeout(()=>{nd[h].wv(Ta,
hc,cc,Bc,Zc);if(ee.TellMeActor.instance.tc){const Hc={};Hc[d.a.provider]=nd[h].Xx();Hc[d.a.kQa]=Ta.Iza;ee.TellMeActor.instance.tc.GN(f.a.wv,window.performance.now()-Hb,Hc)}},0):(nd[h].wv(Ta,hc,cc,Bc,Zc),ee.TellMeActor.instance.tc&&(sd={},sd[d.a.provider]=nd[h].Xx(),sd[d.a.kQa]=Ta.Iza,ee.TellMeActor.instance.tc.GN(f.a.wv,window.performance.now()-Hb,sd)))}zb.gPj()}Xx(){return"Aggregator"}rF(){return 0}wv(Ta,zb,cc=!1,Bc=b.a.tellMe,Zc=null){if(ee.TellMeActor.instance.rBi)this.Hjf(Ta,zb,cc,Bc,Zc);else{const nd=
window.performance.now();ee.TellMeActor.instance.fXj.then(()=>{ee.TellMeActor.instance.tc&&ee.TellMeActor.instance.tc.GN(f.a.sBi,window.performance.now()-nd);this.Hjf(Ta,zb,cc,Bc,Zc);return!0})}}Tu(Ta,zb){this.zXa[zb].push(Ta)}ZCg(Ta){switch(Ta){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const zb=this.zXa[b.a.tellMe];for(const cc of zb)if("FindInDocument"===cc.Xx()){cc.Brj(Ta);break}}}static createInstance(Ta,zb,cc,Bc){const Zc=Bc&&xc.a.fSd(zb);var nd=
Zc&&zb.fDd;const sd=zb.Rrd&&!xc.a.lNa(),h=zb.$pd,Hb=new hg(Zc);if(zb.hyj){var hc=new Cd(zb);Hb.Tu(hc,b.a.tellMe)}hc=zb.Ri?jd.AFrameworkApplication.fa.qa("TellMeIsSuggestionsForSimplifiedUxEnabled"):jd.AFrameworkApplication.fa.qa("TellMeSuggestionsIsEnabled");const Hc=!hc&&jd.AFrameworkApplication.fa.qa("TellMeFirstRunExperienceIsEnabled");Hb.Tu(new Pa(Ta,zb.TNj,Hc,!1),b.a.tellMe);hc&&Hb.Tu(new Ce(new uf,zb,Ta),b.a.tellMe);Ta=jd.AFrameworkApplication.ta.Oa.Sif?new ue(zb,new Me):new Nd(zb,cc);Hb.Tu(Ta,
b.a.contextMenu);(Zc&&zb.gDd||nd)&&Hb.Tu(mf.a.qGe(zb,!0),b.a.tellMe);Hb.Tu(Ta,b.a.tellMe);!zb.zBh||"Word"===zb.application&&zb.fUe||Hb.Tu(new Lb(zb),b.a.tellMe);zb.AGa&&(nd=new u(zb),Hb.Tu(nd,b.a.tellMe),Hb.Tu(nd,b.a.contextMenu));!zb.a_a||zb.lMb||zb.kMb||Hb.Tu(new t.a(zb),b.a.tellMe);Bc&&(zb.Cwa||xc.a.k5())&&(nd=new $c(zb),Hb.Tu(nd,b.a.tellMe),Hb.Tu(nd,b.a.contextMenu));Zc&&Hb.Tu(mf.a.qGe(zb,!1),b.a.tellMe);Bc&&!zb.OVd&&xc.a.eSd(zb)&&(Hb.Tu(new Ad.a(zb),b.a.tellMe),zb.EGj&&Hb.Tu(new Ad.a(zb),b.a.contextMenu));
sd&&Hb.Tu(new Ab(zb),b.a.tellMe);(zb.Odb||zb.Hy)&&Hb.Tu(new oc.a(zb),b.a.tellMe);zb.PAb&&Hb.Tu(new Cf.a(zb),b.a.tellMe);Bc&&zb.Dfc&&Hb.Tu(new e.AddinResultsProvider(zb),b.a.tellMe);h&&"Excel"===zb.application&&Hb.Tu(new Ve(zb),b.a.tellMe);return Hb}}Object(c.a)(hg,"AggregatorResultsProvider",null,[478])},1199:function(n,C,a){n=a(0);var c=a(706),b=a(890),d=a(776),f=a(729),e=a(802);class k{constructor(D,J){this.DimensionValue=this.DimensionName=null;this.DimensionName=D;this.DimensionValue=J}}Object(n.a)(k,
"Dimension",null,[]);class l{constructor(D,J,L,H,R){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=D;this.Query=J;this.From=L;this.Size=H;R&&(this.Filter=R)}}Object(n.a)(l,"EntityRequest",null,[]);class m{constructor(D){this.QueryString=null;this.QueryString=D}}Object(n.a)(m,"Query",null,[]);var u=a(709);class t{constructor(D,J){this.Dimensions=this.Name=null;this.Name=D;this.Dimensions=J}}Object(n.a)(t,"Scenario",null,[]);var w=a(711),r=a(710);class v{constructor(D,
J,L,H){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=D;this.TimeZone=J;this.Cvid=L;this.Scenario=H}}Object(n.a)(v,"SubstrateBody",null,[]);var y=a(801),x=a(702),B=a(701),z=a(4),A=a(1004),I=a(1003),F=a(914),U=a(41),X=a(30),T=a(173);a.d(C,"a",function(){return G});class G{constructor(D){this.wkb=this.kra=this.aVb=this.wib=this.Mkb=0;this.kde=this.Oee=this.Qy=null;this.hEa=0;this.HG=-1;this.Xlb="";this.zh=z.AFrameworkApplication.yd;this.Wa=D;this.sXb=this.whd();this.OQc=
new b.a;this.hce=this.Wa.zYd?3:2;this.wje=this.Wa.zYd&&this.Wa.c5f?5:3;this.Vke=this.Wa.$xc?2:3;this.Wke=1;this.NUb=this.Wa.D1e;this.uie=this.Wa.jni;this.mlb=D.Q3e;z.AFrameworkApplication.fa&&(this.Oee=z.AFrameworkApplication.fa.Xa("AppCatalogUrl")+z.AFrameworkApplication.fa.Xa("SearchPersonaPhotoBaseUrl"))}Xx(){return"Substrate"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:3}wv(D,J,L,H=c.a.tellMe,R=null){const Q=new r.a(D);if(!R||Array.contains(R,14)||Array.contains(R,15)||Array.contains(R,20))if(!this.hEa||
window.performance.now()-this.hEa>=B.a.zag)if(L=this.OQc.e4e())this.hEa=window.performance.now(),L.then(O=>{O&&""!==O?(this.Xlb=O,""!==this.Qy&&this.d4e(D,H,this.Xlb,J,R)):(x.TellMeActor.instance.tc.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),J.resultsUpdated(Q))},O=>{x.TellMeActor.instance.tc.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+O);J.resultsUpdated(Q)});else{if(x.TellMeActor.instance.tc)x.TellMeActor.instance.tc.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");J.resultsUpdated(Q)}else this.Xlb&&""!==this.Xlb?this.d4e(D,H,this.Xlb,J,R):(J.resultsUpdated(Q),x.TellMeActor.instance.tc.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else J.resultsUpdated(Q)}iAa(){this.kra=this.wkb=this.aVb=this.wib=this.Mkb=0}d4e(D,J,L,H,R){this.iAa();const Q=new r.a(D),O=this.Qy=T.a.create().toString();this.V2();this.HG=window.setTimeout(()=>{if(O===this.Qy){this.Qy="";this.HG=-1;H.resultsUpdated(Q);const da={};da[d.a.provider]=
this.Xx();da[d.a.kQa]=D.Iza;x.TellMeActor.instance.tc.GN(f.a.timedOut,this.mlb,da)}},this.mlb);const V={"Content-Type":"application/json",Accept:"application/json"};V.Authorization="Bearer "+L;V["X-Office-Version"]=z.AFrameworkApplication.buildVersion;V["X-Office-Application"]=z.AFrameworkApplication.fa.Xa("Application");V["X-Office-Platform"]="WAC";V["X-TellMe-SessionId"]=x.TellMeActor.instance.wcc();V["X-TellMe-Culture"]=z.AFrameworkApplication.uiCulture;V["X-TellMe-ProcessSessionId"]=z.AFrameworkApplication.userSessionId;
V["Client-Request-Id"]=O;const W=window.performance.now();this.zh.Jm(this.RYh(),2,this.SYh(D.Gd,this.Wa.application,x.TellMeActor.instance.wcc(),B.a.mD(D)),V,!1,0,da=>{this.rPa(da,D,H,O,W,J,R)},da=>{this.ePa(da,D,H,O,W)},null,null,!1,4E3,6E3)}V2(){-1!==this.HG&&(window.clearTimeout(this.HG),this.HG=-1)}rPa(D,J,L,H,R,Q,O){x.TellMeActor.instance.tc.C_(J.Gd.length,this.sXb.join(","),D.data.httpStatus.toString(),Math.round(window.performance.now()-R),y.a.substrate,!0,e.a.eba);const V=B.a.mD(J),W=new r.a(J);
if(H===this.Qy){this.V2();D=U.b(D.data.Xd);if(D.Groups){D=D.Groups;for(const da of D)"People"===da.Type&&this.Wa.WNb&&(O?Array.contains(O,14):1)?(D=this.Z1e(da.Suggestions,V,Q),0<D.results.length&&W.Km(D)):"File"===da.Type&&this.Wa.VNb&&(O?Array.contains(O,15):1)?(D=this.a_e(da.Suggestions,V,Q),0<D.results.length&&W.Km(D)):"Notes"===da.Type&&this.Wa.Bxa&&Q!==c.a.contextMenu&&(O?Array.contains(O,20):1)&&(D=this.z1e(da.Suggestions,V,J),0<D.results.length&&W.Km(D))}L.resultsUpdated(W);x.TellMeActor.instance.tc.C_(J.Gd.length,
this.sXb.join(","),"",Math.round(window.performance.now()-R),"",!0,e.a.provider)}else L.resultsUpdated(W)}z1e(D,J,L){const H=new w.a(20);H.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const R of D)this.Ooi(R)&&(D=R.NotesType,D=X.a.sl(D),D=this.BTh(D,R.LastModifiedTime,R.BodyPreview,R.Subject,J,L,R))&&(D.groupType=20,H.Qn(D));return H}Z1e(D,J,L){const H=new w.a(14);H.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const Q of D)if(this.Poi(Q)){var R=Q.Id.split("@")[0];D=Q.EmailAddresses[0];
let O=Q.Type;if(void 0===O||null===O)O="User";if(R=this.vUh(O,Q.DisplayName,Q.JobTitle,D,R,L,J))R.description=D,D=Q.JobTitle,"Department"in Q&&"CompanyName"in Q&&(D+="@"+Q.Department+"@"+Q.CompanyName),R.s_b=D,H.Qn(R)}return H}a_e(D,J,L){const H=new w.a(15);H.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const O of D)if(this.Ioi(O)){var R=O.FileName;D=O.FileExtension;const V=R.length>D.length?R.substr(0,R.length-D.length-1):O.Title;var Q=void 0;D=0;"DateCreated"in O?(D=B.a.Hhd(O.DateCreated),
Q=B.a.w4e(O.DateCreated),Q=String.format(CommonUIStrings.l_CreatedTimeFormatString,O.Author,Q)):Q=O.Author;const W=O.AccessUrl+"?web=1",da=X.a.wZ(W);R=String.format('<a href="{0}">{1}</a>',da,X.a.zg(R));if(L!==c.a.contextMenu||X.a.ixa(W))if(R=this.MOh(V,L===c.a.contextMenu?R:W,Q,O.FileExtension,O.Text,J))R.description=O.Author,R.B_b=D,H.Qn(R)}return H}ePa(D,J,L,H,R){H===this.Qy&&(this.V2(),x.TellMeActor.instance.tc.C_(J.Gd.length,this.sXb.join(","),D.data.httpStatus.toString(),Math.round(window.performance.now()-
R),y.a.substrate,!1,e.a.eba));D=new r.a(J);L.resultsUpdated(D)}vUh(D,J,L,H,R,Q,O){O=O?this.Wke:this.hce;if(!window.LPC&&!B.a.hod()||this.Mkb===O)return null;this.Mkb+=1;O="PeopleSuggestion"+this.Mkb.toString();var V=this.Oee+"?size=1&accountName="+H;D=Object.assign(new A.a,{PersonaType:D,Smtp:H,ProfilePictureUrl:V,AadObjectId:R});const W=Object.assign(new I.a,{identifiers:D,displayName:J});D=Q===c.a.contextMenu;this.Wa.q4?(x.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(O,
W,J,L)),Q===c.a.contextMenu&&(L=B.a.eGe(J,H,R),x.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(O,L))),x.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(O,D))):(V=[],V.push(appChrome.actions.setPersonaButtonCoauthor(O,W,J,L)),Q===c.a.contextMenu&&(L=B.a.eGe(J,H,R),V.push(appChrome.actions.setButtonCommandValueId(O,L))),V.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(O,D)),appChrome.api.dispatch(V));return new u.a(O,
11,J,H,0)}BTh(D,J,L,H,R,Q,O){if(R&&!this.Wa.Wif||this.aVb===this.NUb||this.wkb===this.NUb||this.kra===this.NUb)return null;var V=null;this.aVb+=1;R="";const W=[],da={};O.type="Notes";this.kde=Object.assign(new F.a,{landingTab:"Notes",data:O});Q=B.a.tta(Q.Gd,33,this.kde);if("onenotepagepreviews"===D){if(!("ClickthroughUrl"in O&&O.ClickthroughUrl)||""===O.ClickthroughUrl)return null;this.wkb+=1;R="OnenoteNotesSuggestion"+this.wkb.toString();da["default"]="SaveAsonetoc2_20";V=O.ClickthroughUrl;W.push(appChrome.actions.setControlIconSet(R,
da));W.push(appChrome.actions.setCompoundButtonCommandValueId(R,V));V=new u.a(R,19,null,null,0)}else if("stickynote"===D){if(!this.uie)return null;this.kra+=1;R="NotesSuggestion"+this.kra.toString();da["default"]="ShowAllNotes_20";W.push(appChrome.actions.setControlIconSet(R,da));W.push(appChrome.actions.setCompoundButtonCommandValueId(R,Q));V=new u.a(R,21,null,null,0)}else if("samsung"===D){if(!this.uie)return null;this.kra+=1;R="NotesSuggestion"+this.kra.toString();da["default"]="CategoryCollapsed_20";
W.push(appChrome.actions.setControlIconSet(R,da));W.push(appChrome.actions.setCompoundButtonCommandValueId(R,Q));V=new u.a(R,20,null,null,0)}""!==R&&(D=B.a.w4e(J),D=String.format(CommonUIStrings.l_LastModifiedString,D),V.label=H,V.B_b=B.a.Hhd(J),W.push(appChrome.actions.setControlLabel(R,H)),W.push(appChrome.actions.updateCompoundButtonDescription(R,D)),W.push(appChrome.actions.setControlCustomTooltip(R,L)),appChrome.api.dispatch(W));return V}MOh(D,J,L,H,R,Q){if(this.wib===(Q?this.Vke:this.wje))return null;
this.wib+=1;Q="FileSuggestion"+this.wib.toString();const O=[],V={};V["default"]=B.a.MQh(H);this.Wa.q4?(x.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Q,D)),x.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(Q,V)),x.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Q,L)),x.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Q,J)),x.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(Q,
R))):(O.push(appChrome.actions.setControlLabel(Q,D)),O.push(appChrome.actions.setControlIconSet(Q,V)),O.push(appChrome.actions.updateCompoundButtonDescription(Q,L)),O.push(appChrome.actions.setCompoundButtonCommandValueId(Q,J)),O.push(appChrome.actions.setControlCustomTooltip(Q,R)),appChrome.api.dispatch(O));return new u.a(Q,6,D,L,0)}whd(){const D=[];this.Wa.WNb&&Array.add(D,"People");this.Wa.VNb&&Array.add(D,"File");this.Wa.Bxa&&Array.add(D,"Notes");return D}SYh(D,J,L,H){var R=new m(D);D=new l("File",
R,0,H?this.Vke:this.wje,null);H=new l("People",R,0,H?this.Wke:this.hce,B.a.NXi);R=new l("Notes",R,0,this.NUb,null);J=new k("app",J.toLowerCase());var Q=[];Array.add(Q,J);J=new t("tellmesearch",Q);Q=[];this.Wa.VNb&&Array.add(Q,D);this.Wa.WNb&&Array.add(Q,H);this.Wa.Bxa&&Array.add(Q,R);L=new v(Q,"UTC",L,J);return U.c(L)}RYh(){let D=this.Wa.FGj;this.Wa.Bxa&&(D+="?&setflight=NotesFrom3S");""!==this.Wa.f4e&&(D=D+"&"+this.Wa.f4e);return D}Poi(D){return"DisplayName"in D&&"Id"in D&&"EmailAddresses"in D&&
!!D.Id&&!!D.EmailAddresses}Ioi(D){return"FileExtension"in D&&!!D.FileExtension&&"FileName"in D&&!!D.FileName&&""!==D.FileName&&"AccessUrl"in D&&!!D.AccessUrl&&""!==D.AccessUrl}Ooi(D){return"Id"in D&&!!D.Id&&"NotesType"in D&&!!D.NotesType&&"Subject"in D&&!!D.Subject&&""!==D.Subject}}Object(n.a)(G,"SubstrateResultsProvider",null,[478])},1274:function(n,C,a){n=a(0);var c=a(187),b=a(706),d=a(890),f=a(776),e=a(729),k=a(802),l=a(709),m=a(711),u=a(710),t=a(702),w=a(701);class r{constructor(G){this.Wa=G;
this.sXb=this.whd()}Xx(){return"Add-ins"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:3}wv(G,D){G=new u.a(G);D.resultsUpdated(G)}bwa(G,D,J){let L;L=this.Wa.Hy?new m.a(26):new m.a(24);L.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;J&&this.OBj(G.Gd,D,L)}OBj(G,D,J){const L=[];let H;H=this.Wa.Dei?this.Wa.Hy&&this.Wa.jsa?w.a.kva(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,G)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,G):this.Wa.Eei?this.Wa.Hy&&
this.Wa.jsa?w.a.kva(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,G)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,G):this.Wa.Hy&&this.Wa.jsa?w.a.kva(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,G)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,G);this.Wa.q4?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",H)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",
G))):(L.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",H)),L.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",G)),appChrome.api.dispatch(L));J.Qn(new l.a("LaunchAddinDialogFromTellMe",27));D.Km(J)}whd(){const G=[];this.Wa.Dfc&&Array.add(G,"Addin");return G}}Object(n.a)(r,"AddinStoreResultsProvider",null,[478]);var v=a(1098),y=a(756),x=a(777),B=a(1099),z=a(1199),A=a(1100),I=a(801),F=a(4),U=a(41),X=a(173);a.d(C,"a",function(){return T});class T{constructor(G,
D,J){this.Klb=this.YWb=this.ZWb=this.XWb=!1;this.Qy=null;this.HG=-1;this.pFa=this.Wlb=null;this.cmb="";this.hEa=0;this.Wa=G;const L=w.a.k5();this.Wpa=D||[];this.zh=F.AFrameworkApplication.yd;this.die=G.gDd;this.$Wb=G.fDd;this.tRc=L&&this.Ldb();this.vRc=L&&this.Mdb();this.sxg=L&&this.Ndb();this.xRc=this.Qdb();this.eie=this.Odb();G.OVd&&w.a.eSd(G)&&(this.Wlb=new z.a(G),this.XWb=G.VNb,this.ZWb=G.WNb,this.YWb=G.Bxa,this.Klb=this.XWb&&this.Mq("File")||this.ZWb&&this.Mq("People")||this.YWb&&this.Mq("Notes"));
this.WWb=this.Uxj();this.dXb=G.TFb;this.wRc=this.nyj();this.cie=this.Txj();this.F3d=this.vZh();this.t3d=new v.a(G);this.Lrg=new B.a(G);this.Nyg=new A.a(G);this.amg=new r(G);this.mlb=J;this.OQc=new d.a;this.dXb&&(this.t3d=new v.a(G))}Mq(G){return Array.contains(this.Wpa,G)?!0:!1}Xx(){return"TellMeService"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:this.Mq("Command")||this.Mq("Recommended")?2:3}sZh(G){let D="";if(!G&&this.Mq("Command")&&this.Wa.Qpd){D+="CommandSearch_DLIS,";var J=this.Wa.f$f;0<J.length&&
(D+=J+",")}G&&this.Mq("Recommended")&&this.$Wb&&(J=this.Wa.g$f,0<J.length&&(D+=J+","));!G&&this.Mq("Help")&&(G=this.Wa.e$f,0<G.length&&(D+=G+","));0<D.length&&(D=D.substr(0,D.length-1));return D}wv(G,D,J,L=b.a.tellMe,H=null){const R=new u.a(G);J=w.a.mD(G);if(this.Klb&&(!this.hEa||window.performance.now()-this.hEa>=w.a.zag)){var Q=this.OQc.wZh();if(Q)this.hEa=window.performance.now(),Q.then(da=>{this.cmb=da},da=>{t.TellMeActor.instance.tc.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+
da)});else if(t.TellMeActor.instance.tc)t.TellMeActor.instance.tc.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var O=this.Klb&&!!this.cmb;Q=O||J&&this.Mq("Recommended")&&this.$Wb;O=O||!J&&(this.die&&this.Mq("Command")||this.tRc&&this.Mq("Answer")||this.vRc&&this.Mq("Definition")||this.eie&&this.Mq("Image")||this.dXb&&this.Mq("Help")||this.xRc&&this.Mq("WolframAnswer")||this.wRc&&this.Mq("Template")||this.cie&&this.Mq("Addin"));if(Q||O)if(this.pFa=L,L={"Content-Type":"application/json",
Accept:"application/json"},L["X-Office-Version"]=F.AFrameworkApplication.buildVersion,L["X-Office-Application"]=F.AFrameworkApplication.fa.Xa("Application"),L["X-Office-Platform"]="WAC",L["X-TellMe-SqmUserId"]=F.AFrameworkApplication.fa.Xa("LoggableUserId")||"",L["X-TellMe-SessionId"]=t.TellMeActor.instance.wcc(),this.cmb&&(L.Authorization="Bearer "+this.cmb),Q=this.sZh(J),0<Q.length&&(L["X-TellMe-Flights"]=Q),Q=[],!J&&this.Mq("Answer")&&this.tRc&&(H?Array.contains(H,9):1)&&Array.add(Q,"Answer"),
!J&&this.Mq("Command")&&this.die&&!y.CommandResultsUtility.Snd(G.Gd)&&(H?Array.contains(H,17):1)&&Array.add(Q,"Command"),!J&&this.Mq("Definition")&&this.vRc&&(H?Array.contains(H,10):1)&&Array.add(Q,"Definition"),!J&&this.Mq("Help")&&this.dXb&&(H?Array.contains(H,8):1)&&Array.add(Q,"Help"),!J&&this.Mq("WolframAnswer")&&this.xRc&&(H?Array.contains(H,12):1)&&Array.add(Q,"WolframAnswer"),J&&this.Mq("Recommended")&&this.$Wb&&!t.TellMeActor.instance.FPb&&(H?Array.contains(H,18):1)&&Array.add(Q,"Recommended"),
!J&&this.Mq("Image")&&this.eie&&(H?Array.contains(H,19):1)&&Array.add(Q,"Image"),this.cmb&&this.Klb&&(H?Array.contains(H,14)||Array.contains(H,15)||Array.contains(H,20):1)&&(this.Wlb.iAa(),this.XWb&&this.Mq("File")&&Array.add(Q,"File"),this.ZWb&&this.Mq("People")&&Array.add(Q,"People"),this.YWb&&this.Mq("Notes")&&Array.add(Q,"Notes")),!J&&this.Mq("Template")&&this.wRc&&(H?Array.contains(H,23):1)&&Array.add(Q,"Template"),!J&&this.Mq("Addin")&&this.cie&&(H?Array.contains(H,24):1)&&Array.add(Q,"Addin"),
Q.length){L["X-TellMe-SuggestionTypes"]=Q.join(",");L["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;L["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;var V=this.Qy=X.a.create().toString();L["Client-Request-Id"]=V;var W=window.performance.now();this.V2();this.HG=window.setTimeout(()=>{if(V===this.Qy){this.Qy="";this.HG=-1;D.resultsUpdated(R);const da={};da[f.a.provider]=this.Xx();da[f.a.kQa]=G.Iza;t.TellMeActor.instance.tc.GN(e.a.timedOut,this.mlb,da)}},this.mlb);this.zh.Jm(this.F3d,
2,this.uZh(G.Gd),L,!1,0,da=>{this.rPa(da,G,D,V,W,H)},da=>{this.ePa(da,G,D,V,W)},null,null,!1,4E3,6E3)}else t.TellMeActor.instance.tc.onError("IssueQuery","Empty Online Provider List: No online calls by provider"),D.resultsUpdated(R);else D.resultsUpdated(R)}V2(){-1!==this.HG&&(window.clearTimeout(this.HG),this.HG=-1)}rPa(G,D,J,L,H,R){const Q=new u.a(D);if(L===this.Qy){this.V2();t.TellMeActor.instance.tc.C_(D.Gd.length,this.Wpa.join(","),G.data.httpStatus.toString(),Math.round(window.performance.now()-
H),I.a.tellMe,!0,k.a.eba);L=G.data.Xd;G=null;try{G=U.b(L)}catch(K){t.TellMeActor.instance.tc.onError("OnSuccessCallBack","Exception occured while deserializing response:"+K);return}L=w.a.mD(D);if("Groups"in G&&G.Groups){var O=G.Groups;for(var V of O)if("GroupType"in V&&"Suggestions"in V&&V.Suggestions)if("Commands"===V.GroupType&&(R?Array.contains(R,17):1)||"Recommended"===V.GroupType&&(R?Array.contains(R,18):1)){var W=(O="Recommended"===V.GroupType)?"DLIS":"NaiveBayes";"Source"in V&&V.Source&&(W=
V.Source);var da=V.Suggestions;new c.a;var ta=[];for(const K of da)this.Goi(K)&&(da=K.Type,("Command"===da||O&&"Recommended"===da)&&ta.push(new x.a(K.CommandId,K.Score)));y.CommandResultsUtility.rkc(ta,!D.Gd.trim().length,V.GroupType,W);W=t.TellMeActor.instance.PG;da=[];for(const K of ta)O&&W&&W.S2c(K.commandId)||da.push(K);ta=y.CommandResultsUtility.ccc(D,da,this.Wa,null,null,null,O?18:17,0);0<ta.results.length&&(this.pFa!==b.a.contextMenu&&(ta.displayName=O?CommonUIStrings.l_TellMeTryCommandTitle:
CommonUIStrings.l_TellMeCommandProviderTitle),Q.Km(ta))}else if("Answer"===V.GroupType){da=V.Suggestions;O=null;ta=2147483647;W="";for(const K of da)if(this.Eoi(K))if(W=K.Type,da=this.uwb(W),"Answer"===W&&this.tRc){O=this.YFe(W,K,D.Gd);break}else da&&da<ta&&(ta=da,O=this.YFe(W,K,D.Gd));ta=w.a.Khj(D.Gd,W);O&&(R?Array.contains(R,O.type):1)&&(W=[],this.WWb?this.Wa.q4?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(O.value,O.Qz)),t.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(O.value,
O.description)),t.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(O.value,ta))):(W.push(appChrome.actions.setControlLabel(O.value,O.Qz)),W.push(appChrome.actions.updateCompoundButtonDescription(O.value,O.description)),W.push(appChrome.actions.setCompoundButtonCommandValueId(O.value,ta)),appChrome.api.dispatch(W)):this.Wa.q4?(t.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(O.value,O.Qz+" - "+O.description)),t.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(O.value,
ta))):(W.push(appChrome.actions.setControlLabel(O.value,O.Qz+" - "+O.description)),W.push(appChrome.actions.setButtonCommandValueId(O.value,ta)),appChrome.api.dispatch(W)),ta=this.pah(O.type),ta.Qn(O),Q.Km(ta))}else"Help"===V.GroupType&&V.Suggestions.length&&(R?Array.contains(R,8):1)?this.dXb&&(O=this.t3d.bwa(D,V.Suggestions))&&0<O.results.length&&Q.Km(O):"Template"===V.GroupType&&(R?Array.contains(R,23):1)?(O=V.Suggestions)&&0<O.length&&this.Nyg.bwa(D,Q,O):"Addin"===V.GroupType&&(R?Array.contains(R,
24):1)?(O=V.Suggestions)&&0<O.length&&this.amg.bwa(D,Q,O):"Substrate"===V.GroupType&&this.Klb&&"Type"in V&&("File"===V.Type&&this.XWb&&(R?Array.contains(R,15):1)?(O=this.Wlb.a_e(V.Suggestions,L,this.pFa))&&0<O.results.length&&Q.Km(O):"People"===V.Type&&this.ZWb&&(R?Array.contains(R,14):1)?(O=this.Wlb.Z1e(V.Suggestions,L,this.pFa))&&0<O.results.length&&Q.Km(O):"Notes"===V.Type&&this.YWb&&(R?Array.contains(R,14):1)&&(O=this.Wlb.z1e(V.Suggestions,L,D))&&0<O.results.length&&Q.Km(O));else t.TellMeActor.instance.tc.onError("OnSuccessCallBack",
"GroupType"in V?"Invalid group suggestions found for "+V.GroupType:"Invalid group found")}if(G.Intents){V=G.Intents;for(const K of V)this.hsd(K)&&("Image"===K.GroupType&&K.ConfidenceScore>K.ConfidenceThreshold&&(R?Array.contains(R,19):1)?this.Lrg.bwa(D,Q,0,K):"Commands"===K.GroupType&&K.ConfidenceScore<K.ConfidenceThreshold&&(R?Array.contains(R,17):1)&&(V=new m.a(17),Q.Km(V)))}J.resultsUpdated(Q);t.TellMeActor.instance.tc.C_(D.Gd.length,this.Wpa.join(","),"",Math.round(window.performance.now()-H),
"",!0,k.a.provider)}}ePa(G,D,J,L,H){const R=new u.a(D);L===this.Qy&&(this.V2(),t.TellMeActor.instance.tc.C_(D.Gd.length,this.Wpa.join(","),G.data.httpStatus.toString(),Math.round(window.performance.now()-H),I.a.tellMe,!1,k.a.eba));J.resultsUpdated(R)}uwb(G){switch(G){case "Entity":return this.sxg?3:0;case "Definition":return this.vRc?5:0;case "WolframAnswer":return this.xRc?2:0;default:return 0}}YFe(G,D,J){switch(G){case "Answer":return new l.a(this.WWb?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===D.Title?J:D.Title,D.Description,0);case "Entity":return new l.a(this.WWb?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===D.Title?J:D.Title,D.Description,0);case "Definition":return new l.a(this.WWb?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===D.Title?J:D.Title,D.Description,0);case "WolframAnswer":return new l.a("WolframForSearch",3,""===D.Title?J:D.Title,D.Description,0);default:return null}}pah(G){switch(G){case 0:return new m.a(9,CommonUIStrings.l_TellMeAnswersTitle);case 2:return new m.a(11,
CommonUIStrings.l_TellMeEntityTitle);case 1:return new m.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new m.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new m.a(19,this.Wa.Hdb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}Eoi(G){return"Type"in G&&!!G.Type&&""!==G.Type&&"Description"in G&&!!G.Description&&""!==G.Description}Goi(G){return"Type"in G&&!!G.Type&&""!==G.Type&&"CommandId"in G&&!!G.CommandId&&""!==G.CommandId&&"Score"in
G&&!!G.Score}hsd(G){if("GroupType"in G&&G.GroupType&&"ConfidenceScore"in G&&"ConfidenceThreshold"in G)return!0;t.TellMeActor.instance.tc.onError("IsValidIntentGroup","Invalid intents found");return!1}uZh(G){const D=w.a.Cif(G),J={};J.Query=G;D&&this.$Wb&&(J.CommandClickedEvents=t.TellMeActor.instance.WGc,J.CommandActionEvents=t.TellMeActor.instance.d5d,J.TellMeCommandClickMruEvents=t.TellMeActor.instance.Mce,J.ContentType=t.TellMeActor.instance.C5b);this.wRc&&(G={},G.Application=this.Wa.application,
J.TemplateInfo=G);return U.c(J)}Ldb(){return!!this.Wa&&this.Wa.Ldb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Ldb}Mdb(){return!!this.Wa&&this.Wa.Mdb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Mdb}Ndb(){return!!this.Wa&&this.Wa.Ndb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Ndb}Qdb(){return!!this.Wa&&this.Wa.Qdb||!!F.AFrameworkApplication.ta&&F.AFrameworkApplication.ta.Oa.Qdb}Odb(){return!!this.Wa&&(this.Wa.Odb||this.Wa.Hy)}Uxj(){return!!this.Wa&&
!this.Wa.Axa}nyj(){return!!this.Wa&&this.Wa.PAb}Txj(){return!!this.Wa&&this.Wa.Fei&&this.Wa.Cei}Uif(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Vif(){return!!F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}vZh(){if(!F.AFrameworkApplication.fa)return"";if(this.Vif())return F.AFrameworkApplication.fa.Xa("TellMeServiceProdEndpointForSearch");
if(this.Uif())return F.AFrameworkApplication.fa.Xa("TellMeServiceEdogEndpointForSearch");if(w.a.hod())return F.AFrameworkApplication.fa.Xa("TellMeServiceIntEndpointForSearch");let G=F.AFrameworkApplication.fa.Xa("TellMeServiceSearchEndpoint");G&&""!==G||(G=F.AFrameworkApplication.d$f);return G}static qGe(G,D){if(D)return new T(G,["Command","Recommended"],G.EOh);D=w.a.k5()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");
return new T(G,D,G.Q3e)}}Object(n.a)(T,"TellMeServiceProvider",null,[478])},1283:function(n,C,a){n=a(0);var c=a(15),b=a(788),d=a(223),f=a(13),e=a(108),k=a(4),l=a(85),m=a(260),u=a(236),t=a(138),w=a(19),r=a(5),v=a(259),y=a(246),x=a(12),B=a(14),z=a(703);class A{}A.Z1g="CondtionalFormattingPane";A.a2g="CondtionalFormattingPaneHeader";A.$1g="CondtionalFormattingPaneBody";A.b2g="CondtionalFormattingPaneTitle";A.Y1g="CondtionalFormattingCloseButton";Object(n.a)(A,"CssClassNames",null,[]);a.d(C,"a",function(){return G});
const I=A.Z1g,F=A.a2g,U=A.$1g,X=r.a.kAc+A.b2g,T=r.a.Deb+A.Y1g;class G extends u.a{constructor(D,J,L){super(D);this.DAe=this.ie=null;this.oq=0;this.Kp=!1;this.Ec=(H,R)=>{R.fg||this.qg(!1)};this.woc=()=>{this.e0c();return!1};this.jk=()=>{this.raiseEvent("CFTPCR");return!1};this.$=J;this.taskPaneManager=L;v.a(J).di(this);this.z6g();this.$.sk(this.Ec)}sP(D){this.get_events().addHandler("CFTPR",D)}HR(D){this.get_events().removeHandler("CFTPR",D)}kM(D){this.addHandler("CFTPC",D)}eO(D){this.removeHandler("CFTPC",
D)}NVc(D){this.addHandler("CFTPCO",D)}CKd(D){this.removeHandler("CFTPCO",D)}OVc(D){this.addHandler("CFTPE",D)}DKd(D){this.removeHandler("CFTPE",D)}QHg(D){this.addHandler("CFTPCR",D)}Fcj(D){this.removeHandler("CFTPCR",D)}get isVisible(){return super.isVisible}set isVisible(D){super.isVisible!==D&&((super.isVisible=D)?this.raiseEvent("CFTPE"):this.raiseEvent("CFTPCO"))}get Jf(){return this.isVisible}get ee(){return y.a.W1g}get hh(){return 9}get $k(){return w.a.nRe}get eN(){return B.a.instance.ga(1073)}get Ho(){return 320}get isResizable(){return!1}get nc(){return this.domElement}get height(){return this.taskPaneManager.DO.offsetHeight}get titleText(){return B.a.instance.ga(1302)}JH(){}fq(){return this.Kp}ns(){return this.Kp}tR(){}FQ(){return!1}sj(){}Vj(){}dispose(){this.$&&
this.$.Gl(this.Ec);this.ie&&(d.a.instance.Ba(f.a.click,this.ie,this.jk),e.KeyInputManager.instance.Hv(this.ie,this.DAe));this.ie=this.taskPaneManager=this.$=null;this.sPj();super.dispose()}hg(){this.Y_f();this.e0c();return!0}mh(D){return x.DOMElementExtensions.xf(this.nc,D)}qg(D){this.Kp=D;const J=this.taskPaneManager;x.DOMElementExtensions.isVisible(J.EO);this.isVisible=D;this.taskPaneManager.gA();D&&0<J.PB.length&&(!J.oh||9!==J.oh.taskPane.hh||J.isCollapsed)&&J.gG(this,!0);this.$.$e()}CM(){var D=
this.$.Cb;const J=z.b("div","ConditionalFormattingPaneBodyId",U);D=document.getElementById(D+r.a.H3b);const L=this.gH();D.appendChild(L);D.appendChild(J);return J}gH(){const D=z.b("div","ConditionalFormattingPaneHeaderId",F),J=z.b("span","ConditionalFormattingPaneTitleId",X);J.innerText=this.titleText;J.setAttribute("aria-live","polite");J.setAttribute("role","heading");J.setAttribute("aria-level","2");J.setAttribute(t.a.ariaLabel,B.a.instance.ga(1303));this.ie=b.a.qb("ConditionalFormattingPaneCloseButtonId",
T,B.a.instance.ga(10),"ClosePaneGlyph_16x16x32",!1);this.ie.classList.add(k.AFrameworkApplication.isRtl?r.a.vaa:r.a.waa);d.a.instance.ra(f.a.click,this.ie,this.jk);this.DAe=e.KeyInputManager.instance.Ds(this.ie,this.jk,l.a.fi);D.appendChild(J);D.appendChild(this.ie);return D}z6g(){this.$.frame.He.Zj("ConditionalFormattingPane");const D=this.$.frame.He.Ei("ConditionalFormattingPane");D.parent=m.AFrame.zT;D.sN=!0;d.a.instance.Vza(f.a.click,this.nc,this.woc,null,!0)}e0c(){this.$.frame.He.Yj("ConditionalFormattingPane")}Dqj(){this.$.frame.He.Yj(this.$.frame.He.eF||
m.AFrame.zT)}sPj(){d.a.instance.EBc(f.a.click,this.nc,this.woc,!0)}E_g(){this.qg(!1);this.Dqj();this.raiseEvent("CFTPC")}Y_f(){const D=document.getElementById(G.firstPaneElementId);D?D.focus():c.ULS.sendTraceTag(51663744,0,10,"ConditionalFormattingTaskPane.SetFocusOnPaneFirstElement: could not find element.")}setFocusOnToolbarFirstElement(){this.taskPaneManager.setFocusOnToolbarFirstElement()}static get firstPaneElementId(){return G.h8h}static get ruleManagerId(){return G.k8h}static get loadingRuleListId(){return G.i8h}static get ruleListId(){return G.j8h}static ka(D,
J){var L=D.Cb;let H=document.getElementById(L+r.a.H3b);H||(H=document.createElement("div"),H.id=D.Cb+r.a.H3b,document.getElementById(L+r.a.lR).appendChild(H));H.classList.add(I);L=D.da;return L.za(248)||L.Ga(248,new G(H,D,J))}}G.h8h=r.a.z2c;G.k8h=r.a.yCe;G.i8h=r.a.X1g;G.j8h=r.a.xCe;Object(n.a)(G,"ConditionalFormattingTaskPane",u.a,[429,10,420,107])},1334:function(n,C,a){a.r(C);a.d(C,"SurfaceStringTokenStringGenerator",function(){return b});n=a(0);var c=a(844);class b extends c.a{constructor(d){super(d);
this.Da=d}apply(d,f,e,k,l,m,u){null==m&&(m=d.A4e(l,f));u=c.a.Nne(d,m,this.Da.score,e,k,u);return{wOb:m,zpb:u}}}b.Apb=0;Object(n.a)(b,"SurfaceStringTokenStringGenerator",c.a,[])},1335:function(n,C,a){a.r(C);a.d(C,"QueryTokenStringGenerator",function(){return d});n=a(0);var c=a(844),b=a(697);class d extends c.a{constructor(f){super(f);this.Da=f}apply(f,e,k,l,m,u,t){e=this.Da.query.load(e,null);m=0;let w=null;this.Da.query.vI===b.Annotations.S0?e&&(w=this.Da.name):((w=this.Da.name)&&(w+="_"),w+=this.Da.annotations.PO(this.Da.query.vI,
e));null!=w&&(m=c.a.Nne(f,w,this.Da.score,k,l,m));return{wOb:u,zpb:t+m}}}d.Apb=1;Object(n.a)(d,"QueryTokenStringGenerator",c.a,[])},1336:function(n,C,a){a.r(C);a.d(C,"FuzzyMatchTokenStringGenerator",function(){return b});n=a(0);var c=a(844);class b extends c.a{constructor(d){super(d);this.Da=d}apply(d,f,e,k,l,m,u){null==m&&(m=d.A4e(l,f));d=this.Da.oNe.rxi(m);if(this.Da.gGf)for(var t of d)if(!t.Nx&&t.i$b)return{wOb:m,zpb:u};t=0;for(const w of d)if(w.Nx&&!({FZc:t}=this.Qse(w,!0,e,k,t)).returnValue)return{wOb:m,
zpb:u};if(this.Da.caf)for(const w of d)if(!({FZc:t}=this.Qse(w,!1,e,k,t)).returnValue)break;return{wOb:m,zpb:u}}Qse(d,f,e,k,l){let m;f?(f=0,m=d.i$b?1:0):(f=d.i$b?1:0,m=d.count-f);for(let u=0;u<m;++u)if(c.a.One(d.Qua+f+u,this.Da.score,e,k),++l,0<this.Da.axd&&l>=this.Da.axd)return{returnValue:!1,FZc:l};return{returnValue:!0,FZc:l}}}b.Apb=2;Object(n.a)(b,"FuzzyMatchTokenStringGenerator",c.a,[])},1345:function(n,C,a){a.r(C);n=a(0);var c=a(743),b=a(187),d=a(331),f=a(82),e=a(711);class k{constructor(x,
B,z,A=0){this.Y5e=x;this.groupType=B;this.Iid=A;this.KJb=z}}Object(n.a)(k,"SortingGroup",null,[]);class l{constructor(x,B,z,A){this.order=x;this.iLa=B;this.Z1h=z;this.groupType=A}}Object(n.a)(l,"SortingProp",null,[]);var m=a(702),u=a(706),t=a(701),w=a(695);class r{constructor(x,B){this.Xpf={};this.Wpf={};this.Qpf=this.gqf=1;this.Yve(x,B)}IDj(x,B,z){var A=t.a.mD(z)?this.Xpf:this.Wpf;z=new b.a;for(var I of B)B=Object(f.a)(l,A[c.a[I.groupType].toLowerCase()]),w.c(B)||z.add(new d.a(B,I));z.Sc((U,X)=>
U.key.order<X.key.order?-1:1);Array.clear(x);I=m.TellMeActor.instance.tE;for(B=0;B<z.count;){A=z.na(B).key.iLa;var F=z.na(B).value;const U=new e.a(z.na(B).key.groupType);w.c(I)||I.Location===u.a.contextMenu||(U.displayName=z.na(B).key.Z1h);for(const X of F.results)U.Qn(X);for(F=++B;F<z.count&&z.na(F).key.iLa===A;)this.bVc(U,z.na(F).value),F=++B;x.push(U)}}KTj(x,B){this.Qpf=this.gqf=1;this.Yve(x,B)}Yve(x,B){this.E6f(x);for(var z=0;z<x.length;z++){let A=x[z];for(const I of A.KJb)this.CCg(I,z,A.Y5e,
A.groupType)}this.E6f(B);for(x=0;x<B.length;x++){z=B[x];for(const A of z.KJb)this.BCg(A,x,z.Y5e,z.groupType)}}E6f(x){x.sort((B,z)=>Object(f.a)(k,B).Iid>Object(f.a)(k,z).Iid?-1:1)}CCg(x,B,z,A){this.Xpf[c.a[x].toLowerCase()]=new l(this.gqf++,B,z,A)}BCg(x,B,z,A){this.Wpf[c.a[x].toLowerCase()]=new l(this.Qpf++,B,z,A)}bVc(x,B){for(let z=0;z<B.results.length;z++)x.Qn(B.results[z])}}Object(n.a)(r,"BaseGroupingSorter",null,[]);class v{constructor(){this.blc=[new k(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new k(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new k(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new k("",13,[13]),new k("",22,[22])];this.Ukc=[new k(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new k(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new k(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new k("",13,[13]),new k("",22,[22])];this.tpf=new r(this.blc,this.Ukc)}dNb(x,
B,z,A=null,I=null){let F=!1;if(A){for(const U of t.a.mD(z)?this.blc:this.Ukc)this.V4i(U,A);F=!0}if(I){for(const U of t.a.mD(z)?this.blc:this.Ukc)this.LTj(B,U,I);F=!0}F&&this.tpf.KTj(this.blc,this.Ukc);this.tpf.IDj(x,B,z)}V4i(x,B){const z=new b.a;for(var A of x.KJb){const I=B[c.a[A].toLowerCase()];z.add(new d.a(w.c(I)?Number.MAX_VALUE:I,A))}if(z.count){z.Sc((I,F)=>I.key<F.key?-1:1);B=Array(z.count);for(A=0;A<z.count;A++)B[A]=z.na(A).value;x.KJb=B}}LTj(x,B,z){let A=0;for(const I of B.KJb)if(c.a[I].toLowerCase()in
z&&z[c.a[I].toLowerCase()])for(const F of x)if(F.groupType===I){A+=z[c.a[I].toLowerCase()];break}B.Iid=A}}Object(n.a)(v,"SimplifiedGroupingSorter",null,[]);a.d(C,"GroupsPlacementInfo",function(){return y});class y{constructor(x){this.Vpf={};this.Tpf={};this.Upf={};this.Ypf={};this.qwd={};this.Zpf=this.dyi=this.Vxi=this.Xxi=1;this.dqf=null;this.Rq=x;this.bTg();this.xZi();this.RSg();this.VRg();x.Hy&&(this.dqf=new v)}Wt(x){this.Vpf[c.a[x].toLowerCase()]=this.Xxi++}Vv(x,B){this.Tpf[c.a[x].toLowerCase()]=
B}w9(x){this.Upf[c.a[x].toLowerCase()]=this.Vxi++}WG(x){this.Ypf[c.a[x].toLowerCase()]=this.dyi++}lr(x){this.qwd[c.a[x].toLowerCase()]=this.Zpf++}bTg(){const x=!!this.Rq&&this.Rq.Axa,B=!!this.Rq&&this.Rq.TFb,z=!!this.Rq&&this.Rq.Bxa,A=!!this.Rq&&this.Rq.Rrd&&!t.a.lNa(),I=!!this.Rq&&this.Rq.PAb,F=!!this.Rq&&this.Rq.Dfc,U=!!this.Rq&&this.Rq.$pd;this.Wt(4);this.Wt(18);this.Wt(16);this.Wt(7);this.Wt(17);this.Wt(0);this.Wt(1);U&&this.Wt(25);I&&this.Wt(23);x||this.Wt(2);x&&!B||this.Wt(8);this.Wt(15);z&&
this.Wt(20);this.Wt(14);this.Wt(9);this.Wt(12);this.Wt(10);this.Wt(11);x&&this.Wt(2);x&&!B&&this.Wt(8);this.Wt(19);F&&this.Wt(24);this.Wt(21);this.Wt(13);A&&this.Wt(22)}xZi(){this.Vv(21,1);this.Vv(4,3);this.Vv(18,3);this.Vv(16,3);this.Vv(7,3);this.Vv(17,5);this.Vv(0,5);this.Vv(1,1);this.Vv(25,2);this.Vv(2,1);this.Vv(8,2);this.Vv(15,3);this.Vv(14,2);this.Vv(24,3);this.Vv(9,1);this.Vv(12,1);this.Vv(10,1);this.Vv(11,1);this.Vv(19,1);this.Vv(23,1);this.Vv(13,1);this.Vv(20,2);this.Vv(22,1)}RSg(){this.w9(4);
this.w9(0);this.w9(17);this.w9(7);this.w9(16);this.w9(18);this.w9(15);this.w9(20);this.w9(8);this.w9(14)}VRg(){this.WG(14);this.WG(10);this.WG(12);this.WG(9);this.WG(11);this.WG(20);this.WG(15);this.WG(8);this.WG(2);this.WG(1);this.WG(24);this.WG(7);this.WG(18);this.WG(16);this.WG(17);this.WG(0);this.WG(4)}ygj(){this.qwd={};this.Zpf=1}XWh(x,B,z){this.ygj();const A=!!this.Rq&&this.Rq.Axa,I=!!this.Rq&&this.Rq.TFb,F=!!this.Rq&&this.Rq.Bxa,U=!!this.Rq&&this.Rq.Rrd&&!t.a.lNa(),X=!!this.Rq&&this.Rq.PAb,
T=!!this.Rq&&this.Rq.Dfc,G=!!this.Rq&&this.Rq.$pd;x=x&&I;this.lr(4);this.lr(18);this.lr(16);this.lr(7);this.lr(17);this.lr(0);this.lr(1);G&&this.lr(25);X&&this.lr(23);A&&!I||!x||this.lr(8);B&&this.lr(15);A||this.lr(2);T&&this.lr(24);z&&this.lr(14);A&&!I||x||this.lr(8);B||this.lr(15);F&&this.lr(20);z||this.lr(14);this.lr(9);this.lr(12);this.lr(10);this.lr(11);A&&this.lr(2);A&&!I&&this.lr(8);this.lr(19);this.lr(21);this.lr(13);U&&this.lr(22);return this.qwd}Wx(){return this.Rq}}Object(n.a)(y,"GroupsPlacementInfo",
null,[])},1347:function(n,C,a){a.r(C);n=a(0);var c=a(942),b=a(802),d=a(743),f=a(1274),e=a(801);class k{constructor(y="",x="",B="",z=-99999,A=-1,I=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=y?y:"";this.Description=x?x:"";this.Type=B?B:"";this.Score=z;this.Age=A;this.Count=I}}Object(n.a)(k,"Suggestion",null,[]);class l{constructor(y,x){this.GroupType=this.Suggestions=null;this.Suggestions=y;this.GroupType=x}}Object(n.a)(l,"SuggestionGroup",null,[]);class m{}
m.help="help";m.answer="answer";m.commands="commands";m.coj="servicecommands";m.h$f="template";Object(n.a)(m,"SuggestionGroupType",null,[]);var u=a(702),t=a(701),w=a(4),r=a(41);a.d(C,"InteractionLogger",function(){return v});class v{constructor(y,x,B){this.iIc=0;this.pSc=this.Ejb=null;this.jh=y;this.GRc=this.qHc=this.HKc=!1;this.Kog=x;this.zh=w.AFrameworkApplication.yd;this.Wa=B;this.fSb=this.WOc=0}get pbb(){return this.jh.pbb}bxc(y){this.jh.bxc(y)}Vnf(){if(this.Ejb){var y=0;for(const x of this.Ejb)this.jh.twi(x,
y++);this.Ejb=null}}beginQuery(y,x,B){this.jh.iwi(y,x,B)}Uya(y,x){this.jh.gPg(y,x);this.HKc=!0;this.GRc=!1}dma(){this.HKc=!1;this.qHc||(this.Vnf(),this.jh.jMe(this.iIc))}jwi(y,x){this.jh.kwi(y,x)}cIi(y,x,B,z,A){for(const I of this.Kog)if(y.startsWith(I)){this.GRc=!0;break}this.jh.Aui(y,x,B,z,A)}yIi(y){this.qHc=!1;this.iIc=y;this.HKc||this.GRc||(this.Vnf(),this.jh.jMe(this.iIc,!1))}xIi(y,x){this.jh.Dui(y,x);this.qHc=!0}Vcd(y,x){if(!y.count)return"";let B="";const z=Date.now();for(let A of y)y=(z-A.timeStamp)/
1E3,y=t.a.BYd(y),0<B.length&&(B+=";"),B+=x?A.commandId:A.controlId,B+=":",B+=y.toString();return B}ema(){var y=this.Vcd(c.a.instance.yhb,!1);0<y.length&&this.jh.xui(y);y=this.Vcd(c.a.instance.DVa,!0);0<y.length&&this.jh.Xti(y);y=this.Vcd(c.a.instance.cTb,!0);0<y.length&&this.jh.dvi(y);y=u.TellMeActor.instance.Nce;0<y.length&&this.jh.hwi(r.c(y))}Ewi(y){this.jh.gui(y)}C_(y,x,B,z,A,I,F){this.jh.Bvi(y,x,B,z,A,I,F)}hvd(y,x,B,z){this.jh.hvd(y,x,B,z)}GN(y,x,B=null){this.jh.Wui(y,x,B)}onError(y,x,B=null){this.jh.Rud(y,
x,B)}srj(y){this.Ejb=y}XYh(y){const x=[];if(!y)return x;for(let B=0;B<y.length;B++){const z=d.a[y[B].groupType].toLowerCase(),A=[],I=y[B].results;if(I){for(let F=0;F<I.length;F++)"findindocument"===z?Array.add(A,new k("","",z,I[F].score,I[F].B_b,I[F].count)):Array.add(A,new k(I[F].label,I[F].description,z,I[F].score,I[F].B_b,I[F].count));"answer"===z||"definition"===z||"wolframanswer"===z||"entity"===z?Array.add(x,new l(A,m.answer)):"classifier"===z||"appsforoffice"===z?Array.add(x,new l(A,m.commands)):
"serviceclassifier"===z?Array.add(x,new l(A,m.coj)):"assistance"===z?Array.add(x,new l(A,m.help)):("document"===z||"people"===z||"findindocument"===z||"notes"===z||"image"===z||"template"===z)&&Array.add(x,new l(A,z))}}return x}uhd(y,x){const B={};B.Query=x;B.SuggestionGroups=r.c(this.XYh(y));return r.c(B)}r4e(y){const x={"Content-Type":"application/json",Accept:"application/json"};x["X-Office-Version"]=w.AFrameworkApplication.buildVersion;x["X-Office-Application"]=w.AFrameworkApplication.fa.Xa("Application");
x["X-Office-Platform"]="WAC";x["X-TellMe-SqmUserId"]=w.AFrameworkApplication.fa.Xa("LoggableUserId")||"";x["X-TellMe-SessionId"]=this.jh.pbb.fV;x["X-TellMe-SuggestionTypes"]="Ranker";x["X-TellMe-Culture"]=w.AFrameworkApplication.uiCulture;x["X-TellMe-ProcessSessionId"]=w.AFrameworkApplication.userSessionId;x["X-TellMe-Flights"]=y;x["X-TellMe-PartialQueryIndex"]=this.WOc;return x}rPa(y,x,B){this.C_(x.length,"RankerLogging",y.data.httpStatus.toString(),Math.round(window.performance.now()-B),e.a.c$f,
!0,b.a.eba)}ePa(y,x,B){this.C_(x.length,"RankerLogging",y.data.httpStatus.toString(),Math.round(window.performance.now()-B),e.a.c$f,!1,b.a.eba)}s4e(){this.pSc||(this.pSc=new f.a(this.Wa,null,6E3));return this.pSc.F3d}lvd(y){const x=this.uhd(this.Ejb,y),B=this.r4e("RankerLogging"),z=window.performance.now();this.zh.Jm(this.s4e(),2,x,B,!1,0,A=>{this.rPa(A,y,z)},A=>{this.ePa(A,y,z)},null,null,!1,4E3,6E3);this.WOc++}ngj(){this.WOc=0}FPd(y){this.fSb=y}}Object(n.a)(v,"InteractionLogger",null,[])},1429:function(n,
C,a){a.r(C);var c=a(4),b=a(247),d=a(0),f=a(694),e=a(5),k=a(77),l=a(90),m=a(1),u=a(183),t=a(133),w=a(25),r=a(55);class v{constructor(Gb,wb){this.gi=Gb;this.$=wb}Lc(){return!1}executeCommand(Gb,wb,qc,Ya){m.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&t.b(this.$).wLd();Gb=qc[k.a.Qc];return m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&m.EwaSettings.ma(238)||!(Gb&&Gb===e.a.bId||7===wb.Re&&qc.SourceControlId===
this.$.Cb+e.a.Qcc)?m.EwaSettings.ma(238)&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature&&(2===wb.Re||7===wb.Re||m.EwaSettings.isChangeGateEnabled("OfficeVSO:3009717_EnableTellMeHelpForAgaveHelpPane")&&-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),Gb))?(qc[e.a.moa]=Ya?Ya.enabledInViewModeRibbon:!1,wb=new l.a(-859308420,wb.method,wb.mode,wb.Re,wb.tabName),this.$.Ka.Lb(wb,qc)):2===this.gi.de(w.a.searchHelp,2,qc)?u.a(wb.command):r.Task.Ta(!0):2===this.gi.de(w.a.giveFeedback,
2,qc)?u.a(wb.command):r.Task.Ta(!0)}Ac(Gb,wb){return-1376725189===wb.command||-1969051244===wb.command}Oc(){return!1}}Object(d.a)(v,"AssistanceCommandHandler",null,[164]);class y extends f.a{constructor(Gb){super(Gb)}vd(){this.$c([new v(c.AFrameworkApplication.vb,this.$)])}static ka(Gb){f.a.Od(112,new y(Gb))}}Object(d.a)(y,"AssistanceCommandHandlerFactory",f.a,[]);var x=a(15),B=a(84);class z{constructor(){this.correlationId=this.sessionId=this.FPc=null;this.actionId=0;this.vYb=null}get Gd(){return this.FPc?
this.FPc:""}set Gd(Gb){this.FPc=Gb}}Object(d.a)(z,"AssistanceSearchVariableUrlParameterSet",null,[]);var A=a(318),I=a(643),F=a(83),U=a(106);class X{constructor(){this.hx=!1;this.Py=!0;this.hhe=this.Hgb=null}get isInitialized(){return this.hx}initialize(Gb,wb){const qc=!!Gb&&!!wb;qc&&(this.Hgb=Gb,this.hhe=wb);this.hx=qc;c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)||F.a.instance.Ub("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Ya=>
{Ya.pF("Enabled").then(xb=>{this.Py=xb;return null},()=>null)})}Ig(Gb){Gb||(Gb=c.AFrameworkApplication.vb);c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.Py=c.AFrameworkApplication.SD,F.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(wb=>{wb.isFeatureEnabled("mso_sendASmile",!0).then(qc=>{this.Py=c.AFrameworkApplication.SD&&qc;(qc=c.AFrameworkApplication.ta)&&
qc.updateCommandUI();return null},()=>null)}));Gb.Nb(w.a.searchHelp,U.a.frame,Object(B.a)(this,this.BBj,"showSearchResults"))}BBj(Gb,wb,qc,Ya,xb){if(1===qc)return c.AFrameworkApplication.fa.qa("IsFeedbackExperiencesAvailable")||(this.Py=!1),xb&&"SourceControlId"in xb&&(xb=xb.SourceControlId,("GiveFeedback"===xb||"btnFeedback"===xb||"btnFeedbackPane"===xb||"PptEditingStatusBar.GiveFeedbackPane"===xb||"GiveFeedbackPane"===xb)&&!this.Py)?8:I.SessionStatusManager.instance.s5a?8:32;x.ULS.sendTraceTag(4761738,
1302,50,"");A.a.mark(4771);if(this.isInitialized){Gb=xb.CommandValueId;wb=xb.SourceControlId;xb=Object.assign(new z,{actionId:w.a.searchHelp,vYb:xb});if(void 0!==Gb&&null!==Gb)xb=X.B_h(Gb);else if(void 0!==wb&&null!==wb)switch(wb){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":xb.actionId=w.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":xb.actionId=w.a.Q2g;break;case "btnShowTraining":case "Training":xb.actionId=
w.a.JLj;break;case "btnWhatsNew":case "WhatsNew":xb.actionId=w.a.uXj}this.Hgb.Ezj(this.hhe,xb);A.a.mark(4772);return 32}A.a.mark(4772);return 8}dispose(){this.Hgb&&(this.Hgb.dispose(),this.Hgb=null)}static get instance(){X.Ma||(X.Ma=new X);return X.Ma}static B_h(Gb){const wb=new z,qc=Gb.indexOf("|");wb.sessionId=Gb.substring(0,qc);const Ya=Gb.indexOf("|",qc+1);wb.correlationId=Gb.substring(qc+1,Ya);wb.Gd=Gb.substr(Ya+1);return wb}}X.Ma=null;Object(d.a)(X,"AssistanceActor",null,[10]);var T=a(39),G=
a(30),D=a(695);class J{constructor(){this.s3d=this.nb=this.pVa=null;this.QOc=!1}Ezj(Gb,wb){if(wb.actionId!==w.a.giveFeedback||c.AFrameworkApplication.SD)if(this.QOc&&!c.AFrameworkApplication.disableWholeAppsForOfficeFeature)this.pVa||(this.pVa=this.s3d()),this.pVa.Vdb();else if(wb.actionId===w.a.giveFeedback)this.nzj();else{Gb=Gb.Acc(wb);wb=null;try{G.a.ixa(Gb)&&(wb=T.a.Ze(Gb,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(qc){throw x.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+qc.message),qc;}wb?x.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",Gb):x.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",Gb,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else x.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.pVa&&(this.pVa.dispose(),this.pVa=null)}k2f(Gb,wb,qc){qc&&D.c(Gb)?this.QOc=!1:(this.s3d=Gb,this.QOc=qc);this.nb=wb}nzj(){c.AFrameworkApplication.vb.processAction(w.a.giveFeedback,2)}static createInstance(Gb,wb,qc=null){const Ya=new J;null==qc?Ya.k2f(Gb,wb,c.AFrameworkApplication.Ate||wb.qa("HelpTabIsEnabled")):Ya.k2f(Gb,wb,qc);return Ya}}Object(d.a)(J,"AssistanceDisplayManager",
null,[447,10]);var L=a(558);class H{constructor(Gb,wb,qc,Ya,xb){this.E1=Gb;this.kug=wb;this.KUb=qc;this.xmg=Ya;this.Jbe=xb}get lcid(){return this.E1}get namespace(){return this.kug}get wOa(){return this.KUb}get iMg(){return this.xmg}get locale(){return this.Jbe}static l_h(Gb){const wb=Gb.indexOf(".");return 0<=wb&&wb<Gb.length&&(Gb=parseInt(Gb.substring(0,wb)),!isNaN(Gb))?Gb:H.eNg}static createInstance(Gb){return new H(c.AFrameworkApplication.lcid,Gb,H.l_h(c.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
L.a.fK(c.AFrameworkApplication.lcid).name)}}H.eNg=16;Object(d.a)(H,"AssistanceSearchUrlParameterSet",null,[]);var R=a(251);class Q{constructor(Gb,wb){Gb=new R.QueryStringBuilder(Gb);Gb.Zi("clid",wb.lcid.toString());Gb.Zi("p1",wb.namespace);Gb.Zi("ver",wb.wOa.toString());Gb.Zi("apps",wb.iMg);Gb.Zi("lc",wb.locale);this._url=Gb.toString()}Acc(Gb){const wb=new R.QueryStringBuilder(this._url);wb.Zi("src","TellMe");wb.Zi("query",Gb.Gd);wb.Zi("sessionid",Gb.sessionId);wb.Zi("correlationid",Gb.correlationId);
return wb.toString()}static createInstance(Gb){return new Q(c.AFrameworkApplication.Bte,Gb)}}Object(d.a)(Q,"AssistanceSearchUrlProvider",null,[446]);class O{Wh(){}init(){c.AFrameworkApplication.a_a&&!c.AFrameworkApplication.suppressHelp&&X.instance.Ig(c.AFrameworkApplication.vb)}dispose(){X.instance.dispose()}N$h(){X.instance.initialize(J.createInstance("XLWAEndUser",c.AFrameworkApplication.fa),Q.createInstance(H.createInstance(void 0)))}}Object(d.a)(O,"AssistancePackage",null,[3,4]);class V extends O{constructor(){super()}get name(){return"Excel.Assistance"}init(){super.init();
this.N$h()}}Object(d.a)(V,"ExcelAssistancePackage",O,[]);var W=a(9),da=a(510),ta=a(50),K=a(37),na=a(38);class P extends na.a{constructor(Gb,wb,qc,Ya){super();this.ele=0;this.CYa=null;this.us=0;this.menuId=this.lY=null;this.Zuf=()=>{this.CYa=null;this.us=3;this.Rmf("OnAccountingFormatMenuDataLoadFailure");this.fda();this.raiseEvent("ek2")};this.$uf=(xb,wc)=>{this.CYa=wc.CYa;this.us=2;this.Rmf("OnAccountingFormatMenuDataLoadSuccess");this.fda();this.raiseEvent("ek1")};this.frame=Gb;this.ksb=wb;this.ksb.jVc(this.$uf);
this.ksb.iVc(this.Zuf);this.xg=Ya;this.j9a=qc;this.yfj()}jVc(Gb){this.addHandler("ek1",Gb)}eRf(Gb){this.removeHandler("ek1",Gb)}iVc(Gb){this.addHandler("ek2",Gb)}dRf(Gb){this.removeHandler("ek2",Gb)}dispose(){this.ksb.eRf(this.$uf);this.ksb.dRf(this.Zuf);super.dispose()}Oc(Gb,wb,qc){if("PopulateAccountingFormatsMenu"!==wb)return!1;this.menuId=qc.MenuId;if(2!==this.us&&3!==this.us)return!1;this.lY=this.lY||this.j9a.EGh(this.CYa,qc.MenuId);qc.MenuItems=this.lY;return!0}Lc(){return!1}Ac(Gb,wb){return 443187837===
wb.command}executeCommand(Gb,wb,qc){return 443187837===wb.command?(Gb={ValidMembers:32,NumberFormat:14},Gb.NumberFormatOptions=this.CYa.NumberFormatOptions[parseInt(qc[k.a.Qc].toString(),10)],this.xg.formatCells(443187837,Gb,wb),r.Task.Ta(!0)):u.a(wb.command)}yfj(){this.ele=Date.now();this.us=1;this.ksb.Zsi()}Rmf(Gb){x.ULS.sendTraceTag(537155170,0,50,`AccountingFormatMenuCommandHandler.${Gb}: AccountingFormat Menu loading time was : ${Date.now()-this.ele} ms`)}fda(){this.menuId&&this.frame.ax(this.menuId)}}
Object(d.a)(P,"AccountingFormatMenuCommandHandler",na.a,[164,418]);var ka=a(171),pa=a(29),Na=a(281);class Z extends Sys.EventArgs{constructor(Gb){super();this.CYa=Gb}}Object(d.a)(Z,"AccountingFormatMenuDataLoadedEventArgs",Sys.EventArgs,[]);var Ra=a(61);class Da extends na.a{constructor(Gb,wb){super();this.MFi=()=>{this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};this.NFi=qc=>{!pa.a.Dq(qc.Errors)&&qc.Result?this.raiseEvent("AccountingFormatMenuDataLoaded",new Z(qc.Result)):this.raiseEvent("AccountingFormatOptionsDataLoadFailed")};
this.va=Gb;this.userOperationManager=wb}jVc(Gb){this.addHandler("AccountingFormatMenuDataLoaded",Gb)}eRf(Gb){this.removeHandler("AccountingFormatMenuDataLoaded",Gb)}iVc(Gb){this.addHandler("AccountingFormatOptionsDataLoadFailed",Gb)}dRf(Gb){this.removeHandler("AccountingFormatOptionsDataLoadFailed",Gb)}Zsi(){this.userOperationManager.Wb(new ka.a(166,0,(Gb,wb,qc)=>{var Ya=this.va;Gb=Na.b(Gb,this.NFi);wb=Na.a(wb,this.MFi);const xb=Ya.Na(5);return Ra.g(Ya,"GetAccountingFormatMenuData",xb,Gb,wb,qc,null,
4)},16),null)}}Object(d.a)(Da,"AccountingFormatMenuDataLoader",na.a,[417]);class Ba{constructor(Gb){this.Ua=Gb}EGh(Gb,wb){return this.jHh(Gb,wb).yC()}jHh(Gb,wb){wb=this.Ua.Up(wb);if(Gb){var qc=this.Ua.Dc();for(let Ya=0;Ya<Gb.NumberOfMenuItems;++Ya){const xb=this.h5g(Ya.toString(),Gb.MenuItemLabels[Ya]);qc.buttons.push(xb)}wb.sc.push(qc)}Gb=this.Ua.Dc();qc=this.V8g();Gb.buttons.push(qc);wb.sc.push(Gb);return wb}h5g(Gb,wb){Gb=this.Ua.WP(137,"Number.AccountingFormatOptionMenuItem_"+Gb,443187837,null,
1,"None",0,0,Gb,!1,0);Gb.label=wb;Gb.$R(wb);return Gb}V8g(){return this.Ua.WP(137,"Number.MoreAccountingFormatOptionsMenuItem",2105621672,null,1,"None",501,0,"3",!1,1596)}}Object(d.a)(Ba,"AccountingFormatMenuRenderer",null,[416]);class ea extends f.a{constructor(Gb){super(Gb)}vd(){const Gb=ta.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.fb),wb=ta.GetServiceTaskFactory.create(this.$.da,102,this.la,this.fb);K.TaskExtensions.Aa(K.TaskExtensions.Td([Gb,wb],this.la),()=>{var qc=new Da(this.$.pa.va,
this.$.userOperationManager);const Ya=new Ba(wb.result);qc=new P(this.$.frame,qc,Ya,Gb.result);this.$.da.Ga(191,qc);this.$c([qc])},this.$.la,3)}static ka(Gb){f.a.Od(190,new ea(Gb))}}Object(d.a)(ea,"AccountingFormatMenuCommandHandlerFactory",f.a,[]);var Y=a(58);class ja extends Sys.EventArgs{constructor(Gb){super();this.DWj=Gb}}Object(d.a)(ja,"NumberFormatViewModelLoadedEventArgs",Sys.EventArgs,[]);var ca=a(51);class ba extends na.a{constructor(Gb){super();this.dUi=wb=>{pa.a.Dq(wb.Errors)?this.raiseEvent("NumberFormatViewModelFailed"):
this.raiseEvent("NumberFormatViewModelLoaded",new ja(wb.Result))};this.cUi=()=>{this.raiseEvent("NumberFormatViewModelFailed")};this.$=Gb}znb(Gb){this.addHandler("NumberFormatViewModelLoaded",Gb)}aJb(Gb){this.removeHandler("NumberFormatViewModelLoaded",Gb)}pHg(Gb){this.addHandler("NumberFormatViewModelFailed",Gb)}ocj(Gb){this.removeHandler("NumberFormatViewModelFailed",Gb)}Hti(Gb,wb,qc){const Ya={};Ya.a=this.$.ya.UserSessionId;qc&&(Ya.b=Y.a.kc(qc));wb&&(Ya.c=Y.a.kc(wb));ca.b().Ne(6,Ya);this.$.userOperationManager.Wb(new ka.a(160,
0,(xb,wc,Oc)=>{var Cb=this.$.pa.va;xb=Na.b(xb,this.dUi);wc=Na.a(wc,this.cUi);const Ib=Cb.Na(1);Ib.activeCell=Gb;Ib.numberFormatOptions=wb;Ib.prevNumberFormatOptions=qc;return Ra.g(Cb,"GetNumberFormatViewModelData",Ib,xb,wc,Oc,null,0)},16),null)}}Object(d.a)(ba,"NumberFormatClientViewModelDataLoader",na.a,[422]);var ua=a(43),wa=a(21),ia=a(7),xa=a(144),gb=a(774),va=a(14),sa=a(261);class ab{constructor(Gb,wb){this.z_g=(qc,Ya)=>{1===qc?(qc=Ya.resultLanguageIndex,x.ULS.sendTraceTag(537155167,0,50,`ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on OK. selected index:${qc}`),
this.numberFormatViewModel.Wwc(qc,"ChangeLocaleDialog")):x.ULS.sendTraceTag(537155166,0,50,"ChangeLocaleDialog.CloseReactChangeLocaleDialog pressing on Cancel");this.dispose()};this.oFb=()=>{this.numberFormatViewModel.ogf(2,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded")&&(x.ULS.sendTraceTag(537155165,0,50,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded success"),this.mVi())};this.nFb=()=>{x.ULS.sendTraceTag(537155164,0,15,"ChangeLocaleDialog.OnNumberFormatViewModelLoaded failure")};this.numberFormatViewModel=
wb;this.activeCell=Gb;this.numberFormatViewModel.znb(this.oFb);this.numberFormatViewModel.Uoe(this.nFb)}initialize(){const Gb=Object(ia.a)(new gb.a,{Caller:2,NumberFormatCategory:-1});this.numberFormatViewModel.c9c(this.activeCell,Gb)}dispose(){this.numberFormatViewModel&&(this.numberFormatViewModel.aJb(this.oFb),this.numberFormatViewModel.cSf(this.nFb))}mVi(){const Gb={[sa.a.dv]:"ChangeLocaleDialog",["languageList"]:this.numberFormatViewModel.dl.Locales,["helpLink"]:this.numberFormatViewModel.SGf},
wb=new xa.a(!1,!1,!0);wb.Rb=1;wb.Ce="ChangeLocaleDialog";wb.initializeAndShow(va.a.instance.ga(2214),this.z_g,Gb)}}Object(d.a)(ab,"ChangeLocaleDialog",null,[10]);var Ua=a(1168);class nb{constructor(Gb,wb){this.$=Gb;this.numberFormatViewModel=wb}Lc(){return!1}Ac(Gb,wb){Gb=!1;switch(wb.command){case 2105621672:case -168056295:case 151715844:Gb=!0}return Gb}executeCommand(Gb,wb,qc){Gb=!1;switch(wb.command){case 151715844:Gb=this.SUi();break;case 2105621672:case -168056295:Gb=this.openNumberFormatDialog(wb,
qc)}return r.Task.Ta(Gb)}Oc(){return!1}kXe(){let Gb=null;const wb=wa.g(this.$).ha.sa.activeCell;wb&&(Gb=ua.o(wb,this.$));return Gb}openNumberFormatDialog(Gb,wb){var qc;let Ya=null;k.a.Qc in wb&&wb[k.a.Qc]&&(Ya=parseInt(wb[k.a.Qc].toString(),10));const xb=this.kXe();if(!xb)return!1;this.numberFormatViewModel.IUf();wb=null!==(qc=null===wb||void 0===wb?void 0:wb.onClose)&&void 0!==qc?qc:wc=>{wc&&this.numberFormatViewModel.formatCells(this.numberFormatViewModel.Mbc(),Gb)};(new Ua.a(this.$,xb,this.numberFormatViewModel,
Gb,Ya,wb)).initialize();return!0}SUi(){const Gb=this.kXe();if(!Gb)return!1;this.numberFormatViewModel.IUf();(new ab(Gb,this.numberFormatViewModel)).initialize();return!0}}Object(d.a)(nb,"NumberFormatCommandHandler",null,[164]);var Ha=a(109),sb=a(11),Qb=a(1084),mb=a(42),Pb=a(249),gc=a(6),Xb=a(141),Ca=a(252),ra=a(68);class ma extends na.a{constructor(Gb,wb,qc){super();this.Yfh=[va.a.instance.ga(489),va.a.instance.ga(490),va.a.instance.ga(491),va.a.instance.ga(492),va.a.instance.ga(493),va.a.instance.ga(494),
va.a.instance.ga(495),va.a.instance.ga(496),va.a.instance.ga(497),va.a.instance.ga(498),va.a.instance.ga(499),va.a.instance.ga(500)];this.dl=null;this.KBf=(Ya,xb)=>{(this.dl=xb?xb.DWj:null)?this.a4i():this.tMf()};this.JBf=()=>{this.tMf()};this.$=Gb;this.KWg=wb;this.hEb=qc;this.hEb.znb(this.KBf);this.hEb.pHg(this.JBf);this.$.da.Ga(193,this)}znb(Gb){this.addHandler("NumberFormatViewModelLoaded",Gb)}aJb(Gb){this.removeHandler("NumberFormatViewModelLoaded",Gb)}Uoe(Gb){this.addHandler("NumberFormatViewModelFailed",
Gb)}cSf(Gb){this.removeHandler("NumberFormatViewModelFailed",Gb)}get SGf(){return"https://go.microsoft.com/fwlink/p/?linkid=2134522"}dispose(){this.hEb.aJb(this.KBf);this.hEb.ocj(this.JBf);super.dispose()}formatCells(Gb,wb){const qc={};qc.NumberFormatOptions=Gb;qc.ValidMembers=32;qc.NumberFormat=14;Gb=Object(ia.a)(new Qb.a,{color:this.dl.Color,sample:this.dl.Sample,Cmc:this.dl.NumberFormatString});this.KWg.formatCells(2105621672,qc,wb,Gb)}get Cmc(){return this.dl.NumberFormatString}hYe(Gb){return this.Yfh[Gb]}Mbc(){return this.GDe(this.dl.NumberFormatOptions)}GDe(Gb){return Object(ia.a)(new gb.a,
{NumberFormatCategory:Gb.NumberFormatCategory,DecimalPlaces:Gb.DecimalPlaces,IsComma:Gb.IsComma,NegativeNumberType:Gb.NegativeNumberType,NegativeCurrencyType:Gb.NegativeCurrencyType,CurrencyType:Gb.CurrencyType,DateType:Gb.DateType,TimeType:Gb.TimeType,FractionType:Gb.FractionType,SpecialType:Gb.SpecialType,CustomType:Gb.CustomType,LocaleType:Gb.LocaleType,IsInputCalendar:Gb.IsInputCalendar,CalendarType:Gb.CalendarType,IsGannen:Gb.IsGannen,IsOverrideDataLocale:Gb.IsOverrideDataLocale,Caller:Gb.Caller})}IUf(){this.dl=
null}c9c(Gb,wb){this.hEb.Hti(Gb,wb,this.dl?this.dl.NumberFormatOptions:null)}ogf(Gb,wb){x.ULS.shipAssertTag(537155107,0,!!this.dl,"NumberFormatViewModel.IsModelLoadedBy: numberFormatViewModelData is null");const qc=this.Mbc().Caller,Ya=qc===Gb;Ya||x.ULS.sendTraceTag(537155106,0,15,`NumberFormatViewModel.IsModelLoaddedBy: expected caller in '${wb}' should be ${Gb} but caller is ${qc}`);return Ya}Wwc(Gb,wb){const qc=this.dl.LocaleTags;if(Ha.e(qc))x.ULS.shipAssertTag(537155105,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: localeTags array is null or empty");
else if(qc.length!==this.dl.Locales.length)x.ULS.shipAssertTag(537155104,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: length mismatch: localeTags:${qc.length}. localeNames:${this.dl.Locales.length}.`);else if(0>Gb||Gb>=qc.length)x.ULS.shipAssertTag(537155103,0,!1,`NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedLocaleIndex ${Gb} is out of range:[0:${qc.length}]`);else{var Ya=qc[Gb];if(Ya){var xb={};sb.HelperMethods.K_f(ma.ZVi,Ya,this.$.ya.OverrrideDataLocaleCookieTTLDays,"OverrideDataLocale",
xb);this.$.sendBeaconTraceTag(590878544,50,!0,"NumberFormatViewModel.SetOverrideDataLocaleCookie: setting cookie. caller:{0}. currentDomain:{1}. cookieDomain:{2}. hostNameJsApi:{3}. hostName:{4}. uiHost:{5}. prevDataLocale:{6}. prevCookieVal:{7}. selectedLocaleIndex:{8}. selectedCultureTag:{9}. cookieSetOK:{10}. newCookieVal:{11}.",wb,xb.currentDomain,xb.parentDomain,this.$.ya.HostNameJsApi,this.$.ya.HostName,this.$.ya.UiHost,qc[0],xb.prevCookieVal,Gb,Ya,xb.cookieSetOK,xb.newCookieVal);mb.a(this.$).Bs(new Pb.a(gc.a.Ux,
5,()=>{const wc=ra.a(this.$).kd.activityState;wc[Xb.a.XX]=!0;wc[Ca.a.Aq]=gc.a.r1c;this.$.el.Ty("OverrideDataLocale_"+wb.substring(0,1))}))}else x.ULS.shipAssertTag(537155102,0,!1,"NumberFormatViewModel.SetOverrideDataLocaleCookie: selectedCultureTag is null or empty")}}a4i(){this.raiseEvent("NumberFormatViewModelLoaded")}tMf(){this.raiseEvent("NumberFormatViewModelFailed")}}ma.ZVi="rsOverride";Object(d.a)(ma,"NumberFormatViewModel",na.a,[415,10]);class hb extends f.a{constructor(Gb){super(Gb)}vd(){const Gb=
ta.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.fb);K.TaskExtensions.Aa(Gb,()=>{var wb=new ma(this.$,Gb.result,new ba(this.$));wb=new nb(this.$,wb);this.$c([wb])},this.$.la,3)}static ka(Gb){f.a.Od(189,new hb(Gb))}}Object(d.a)(hb,"NumberFormatCommandHandlerFactory",f.a,[]);var vb=window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"SpellCheckUpSellButton",LabelText:"TellMeStringId.Ewr_SpellCheckUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSSpellCheck",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"MacrosUpSellButton",LabelText:"TellMeStringId.Ewr_MacrosUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSMacros",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"HeaderFooterUpSellButton",LabelText:"TellMeStringId.Ewr_HeaderFooterUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",Id:"UpSellInformationMenuSection",
ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x0CDCFF89",Description:"TellMeStringId.Ewr_DesktopUpSellDescription",Id:"TellMe.TryOfficeThroughTellMeForXLSHeaderFooter",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_TryOffice",LabelText:"TellMeStringId.Ewr_DesktopUpSellTitle"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"SpellCheckUpSellButtonEnterprise",LabelText:"TellMeStringId.Ewr_SpellCheckUpSell"},children:[{name:"Menu",
attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Command:"0x2F9A3D80",Id:"MacrosUpSellButtonEnterprise",
LabelText:"TellMeStringId.Ewr_MacrosUpSell"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]},{name:"FlyoutAnchor",
attrs:{Command:"0x2F9A3D80",Id:"HeaderFooterUpSellButtonEnterprise",LabelText:"TellMeStringId.Ewr_HeaderFooterUpSell"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"TellMeStringId.Ewr_DeskTopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Command:"0x56BA1B75",Description:"TellMeStringId.Ewr_OpenInDesktopDescription",Id:"TellMe.OpenInClient",Image48by48:"EWA_MENU_CLUSTER",Image48by48Class:"ewamenu_excel48",
LabelText:"TellMeStringId.Ewr_OpenInDesktopExcel"}}]}]}]}]}]},Va=a(931);class db extends f.a{constructor(Gb){super(Gb)}vd(){this.$.Yx(()=>{this.$c([new Va.ConditionalFormattingCommandHandler(this.$)])})}static ka(Gb){f.a.Od(247,new db(Gb))}}Object(d.a)(db,"ConditionalFormattingCommandHandlerFactory",f.a,[]);var oa=a(222),Oa=a(1283),Wa=a(415);class Sa extends oa.a{constructor(Gb){super();this.fh=this.Bi=null;this.$=Gb;this.Eb()}get AD(){this.Bi||(this.Bi=K.TaskExtensions.Aa(Wa.a(this.$),Gb=>{this.fh=
Oa.a.ka(this.$,Gb.result)},this.la,3));return this.Bi}create(){const Gb=ta.GetServiceTaskFactory.create(this.$.da,203,this.la,this.fb),wb=ta.GetServiceTaskFactory.create(this.$.da,155,this.la,this.fb);K.TaskExtensions.Aa(K.TaskExtensions.ts(K.TaskExtensions.Td([Gb,wb],this.la),()=>this.AD,this.la),()=>{this.pb(this.fh)},this.la,3)}dispose(){this.fh=this.Bi=this.$=null;super.dispose()}static ka(Gb){Gb.da.Ga(249,new Sa(Gb))}}Object(d.a)(Sa,"ConditionalFormattingTaskPaneFactory",oa.a,[]);var yb=a(53),
Ma=a(702),Bb=a(148),Nb=a(418),Ia=a(331),jb=a(701),Ob=a(151),Jb=a(688);class Kb{constructor(Gb=null,wb=null,qc=null,Ya,xb=null){this.zgb=null;this.T2d=!1;this.N7d=this.oVa=null;this.vxg=this.$he=this.ymg=this.O7d=!1;this.XRb=null;this.Jmg=null==wb?c.AFrameworkApplication.a_a:wb;this.Xrg=null==qc?c.AFrameworkApplication.Cwa:qc;this.Txg=null==xb?c.AFrameworkApplication.Wna:xb;this.org=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeHelpOnHelpIsEnabled");this.Qyg=!!c.AFrameworkApplication.fa&&
c.AFrameworkApplication.fa.qa("TellMeCommandHookIsEnabled");this.Iuj(!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeIgnoreQueryForHelp"));this.Iyg=!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.OAb;this.Jyg=!jb.a.Dka()&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMePeopleSuggestionIsEnabled");this.Hyg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeFileSuggestionIsEnabled");this.bqg=!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.GSa;
this.Kyg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.mxg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("HelpShowsTopSearchResult");this.Kug=this.lMb||this.kMb;this.Iug=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("OnlineCommandSuggestionsIsEnabled");this.Jug=this.Qpd;this.Xsg=!!c.AFrameworkApplication.fa&&this.tellMeInSharedHeaderIsEnabled&&c.AFrameworkApplication.fa.qa("StyledHeaderInLabelIsEnabled");this.Pqg=
c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.Uqg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.Lqg=c.AFrameworkApplication.fa?parseFloat(c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.Vsg=!!c.AFrameworkApplication.fa&&
(c.AFrameworkApplication.fa.qa("SmartLookupNoteSearchIsEnabled")||c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.pyg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.Wqg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",
""):"";this.nxg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.Mxg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.txg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("ShowFindInDocumentInZeroTermSearchBox")||this.Hy;this.etg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.qa("TellMeTemplateProviderIsEnabled")||
c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.Fsg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.Psg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeIsRuleBasedSortingEnabled")&&"en-US"===c.AFrameworkApplication.uiCulture;this.btg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.qa("TellMeFeedbackProviderIsEnabled")||
c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.itg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeZeroTermContextualCommandSuggestionsEnabled");this.zmg=this.tellMeInSharedHeaderIsEnabled&&!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",!1);this.hrg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",
!1);this.Qxg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==c.AFrameworkApplication.fa.Xa("Application"));this.ing=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",!1);this.Azg=!!c.AFrameworkApplication.fa&&(c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",
!1)||c.AFrameworkApplication.fa.qa("TellMePerformanceMarkerEnabled"));this.fsg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.jsg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",!1);this.Ssg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",
!1);this.Uwg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.Ylg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.Tqg=c.AFrameworkApplication.fa?c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.dtg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeNotesSuggestionIsEnabled")||
this.Tif;this.hsg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.isg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",!1);this.gsg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",
!1);this.Lyg=this.Xni&&(this.fDd||this.gDd||this.TFb||this.tellMeInSharedHeaderIsEnabled&&jb.a.k5()&&!!c.AFrameworkApplication.fa&&(this.Odb||this.Ldb||this.Mdb||this.Ndb||this.Qdb||c.AFrameworkApplication.fa.qa("ShowAnswerSearchResults")||c.AFrameworkApplication.fa.qa("ShowDefinitionSearchResults")||c.AFrameworkApplication.fa.qa("ShowEntitySearchResults")||c.AFrameworkApplication.fa.qa("ShowWolframSearchResults")));this.Zlg=!!c.AFrameworkApplication.fa&&!c.AFrameworkApplication.fa.qa("AppsForOfficeThirdPartyIsDisabled")&&
c.AFrameworkApplication.fa.qa("AppsForOfficeAllowExternalMarketplace")&&c.AFrameworkApplication.V9;this.$lg=!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("AppsForOfficePrivateCatalogIsEnabled");this.$$h(Gb||{});this.BWb="2918242107";this.AWb="1454393937";this.GEa={};this.Ara=[];this.L3g=[jb.a.qBc]}get application(){return this.oVa}get a_a(){return this.Jmg}get ulj(){return this.BWb}get tlj(){return this.AWb}get eUe(){return this.N7d}get zBh(){return this.O7d}get Cwa(){return this.Xrg}get Wna(){return this.Txg}get AGa(){return this.ymg}get u6h(){return this.org}get AIj(){return this.Qyg}get Xni(){return!0}get tIj(){return this.Lyg}get fxj(){return this.$he}Iuj(Gb){this.$he=
Gb}get tellMeInSharedHeaderIsEnabled(){return this.Iyg}get WNb(){return this.Jyg}get VNb(){return this.Hyg}get fetchTokensForSearch(){return this.bqg}get rIj(){return this.Kyg}get zYd(){return!1}get TFb(){return this.Kug}get fDd(){return this.Iug}get gDd(){return this.Jug}get Axa(){return!1}get zic(){return!1}get Hrd(){return this.Xsg}get NSd(){return this.vxg}get Odb(){return!1}get hyj(){return!1}get bsi(){return""}get BVh(){return 4}get CVh(){return 5}get GXh(){return""}get EOh(){return this.Pqg}get Q3e(){return this.Uqg}get IXh(){return 1E3}get HXh(){return 1E-6}get FGj(){return this.pyg}get OVd(){return!1}get EGj(){return!1}get rmi(){return this.Psg}get jrd(){return!1}get krd(){return!1}get Xji(){return!1}get Wji(){return!1}get Tif(){return!1}get Wif(){return!1}get fUe(){return!1}get Fdb(){return!1}get Ldb(){return!1}get Mdb(){return!1}get Ndb(){return!1}get Qdb(){return!1}get lMb(){return this.mxg}get Hdb(){return this.nxg}get kMb(){return!1}get XYe(){return null}get grd(){return!1}get $xc(){return this.txg}get D1e(){return 0}get gLh(){return this.Lqg}get f4e(){return this.Wqg}get jni(){return this.Vsg}get c1e(){return-3.9}get Hy(){return this.Mxg}get PAb(){return this.etg}get $pd(){return this.Fsg}get Rrd(){return this.btg}get jsa(){return this.zmg}get tpi(){return this.itg}get q4(){return this.hrg}get q6f(){return this.Qxg}get BQg(){return this.ing}get YCc(){return this.Azg}get Dfc(){return this.fsg}get Fei(){return this.jsg}get Hmi(){return this.Ssg}get fYf(){return this.Uwg}get jJg(){return this.Ylg}get Rl(){return this.Tqg}get Bxa(){return this.dtg}get Dei(){return this.hsg}get Eei(){return this.isg}get Cei(){return this.gsg}get Ope(){return this.Zlg}get Ppe(){return this.$lg}get yK(){return!!c.AFrameworkApplication.ta&&
c.AFrameworkApplication.ta.Oa.Ri}get Ri(){return!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.Ri}get hki(){return!!c.AFrameworkApplication.ta&&c.AFrameworkApplication.ta.Oa.Hxj}get Ctf(){return Ob.getImageClass("OfficeAssistant_32x32x32")}ZOh(){return Promise.reject("GetFindMatchCount method is not overridden")}Lic(Gb){return Array.contains(appChrome.selectors.getVisibleControlIds(),Gb)}ggc(){return!1}get Lpd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeModelRankerEnabled")}get e$f(){return c.AFrameworkApplication.fa?
c.AFrameworkApplication.fa.Xa("TellMeServiceHelpClassifierModelName"):""}get Qpd(){return!!c.AFrameworkApplication.fa&&c.AFrameworkApplication.fa.qa("TellMeMultiLingualCommandModelEnabled")}get Yjd(){return"NoOpHeaderUi"}get hDe(){return this.XRb}get parameterData(){return this.GEa}get TNj(){return this.Ara}Wmh(){if(this.zgb&&!this.T2d&&(this.T2d=!0,this.H1f(this.zgb),this.Ri)){var Gb=F.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");Gb=(new Jb.a(Gb)).Q3a(this.zgb.kj);appChrome.api.dispatch(Gb)}}get mYf(){return""}pXe(){throw Error.notImplemented();
}H1f(){}Nfh(Gb){const wb=[];for(let qc=0;qc<Gb.length;++qc)Gb[qc].Syj?wb.push(new Ia.a(Gb[qc].BKg,jb.a.acg+qc.toString())):wb.push(new Ia.a(Gb[qc].standard,jb.a.qBc+qc.toString()));return wb}$gj(Gb){var wb=window.TellMeAdditionalControls;if(wb&&Gb){Gb.SUf(wb);this.zgb=this.pXe();Gb=wb.children;for(const qc of Gb)this.zgb.vme(qc.attrs.Id,qc)}}dhj(Gb){const wb=this.hDe;for(let qc in wb)Gb.fhj(wb[qc])}$$h(Gb){const wb={};for(let qc in Gb){const Ya=qc,xb=Gb[qc];for(let wc in xb){const Oc=wc,Cb=xb[wc];
(wb[Oc]||(wb[Oc]={}))[Ya]=Cb}}this.XRb=wb}get g$f(){return""}get f$f(){return""}get c5f(){return!1}}Object(d.a)(Kb,"TellMeApplicationData",null,[465]);class Qa{constructor(Gb,wb=null,qc=!1){this.standard=Gb;this.BKg=wb;this.Syj=qc}}Object(d.a)(Qa,"TryQuerySet",null,[]);var ha=a(1351),qa=a(1010),pb=a(246),bb=a(35);class eb{}eb.l8h={["faShare_FriendlyLabel"]:0,["Jewel_Close_FriendlyLabel"]:1,["Alignment_AlignCenter_FriendlyLabel"]:2,["Cells_Insert_FriendlyLabel"]:3,["Cells_Delete_FriendlyLabel"]:4,
["Tables_Table_FriendlyLabel"]:5,["Apps_AppsForOffice_FriendlyLabel"]:6,["Charts_InsertColumn_FriendlyLabel"]:7,["Charts_InsertLine_FriendlyLabel"]:8,["Charts_InsertPie_FriendlyLabel"]:9,["Charts_InsertBar_FriendlyLabel"]:10,["Charts_InsertArea_FriendlyLabel"]:11,["Charts_InsertScatter_FriendlyLabel"]:12,["Charts_InsertOther_FriendlyLabel"]:13,["Picture_InsertPictures_Local_FriendlyLabel"]:14,["Links_Hyperlink_FriendlyLabel"]:15,["Comments_CommentInsert_FriendlyLabel"]:16,["Update_RefreshSelectedConnection_FriendlyLabel"]:17,
["Update_RefreshAllConnections_FriendlyLabel"]:18,["Update_PivotTableChangeDataSource_FriendlyLabel"]:19,["Actions_MovePivotTable_FriendlyLabel"]:20,["PivotTableStyleOptions_PivotTableRowHeaders_FriendlyLabel"]:21,["PivotTableStyleOptions_PivotTableColumnHeaders_FriendlyLabel"]:22,["PivotTableStyleOptions_PivotTableBandedRows_FriendlyLabel"]:23,["PivotTableStyleOptions_PivotTableBandedColumns_FriendlyLabel"]:24,["Show_PivotTableShowFieldList_FriendlyLabel"]:25,["Show_PivotTableShowSettings_FriendlyLabel"]:26,
["Show_PivotTableShowExpandButton_FriendlyLabel"]:27,["ChartData_SwitchRowCol_FriendlyLabel"]:28,["ChartData_EditData_FriendlyLabel"]:29,["Charts_Change_Column_FriendlyLabel"]:30,["Charts_Change_Line_FriendlyLabel"]:31,["Charts_Change_Pie_FriendlyLabel"]:32,["Charts_Change_Bar_FriendlyLabel"]:33,["Charts_Change_Area_FriendlyLabel"]:34,["Charts_Change_Scatter_FriendlyLabel"]:35,["Charts_Change_Other_FriendlyLabel"]:36,["Labels_Legend_FriendlyLabel"]:37,["Labels_DataLabels_FriendlyLabel"]:38,["Labels_DataTable_FriendlyLabel"]:39,
["Axes_Axes_FriendlyLabel"]:40,["Axes_Gridlines_FriendlyLabel"]:41,["ChartTaskpane_Format_FriendlyLabel"]:42,["ChartFormat_Fill_FriendlyLabel"]:43,["ChartFormat_Outline_FriendlyLabel"]:44,["Automatic_FriendlyLabel"]:45,["AutoSum_Max_FriendlyLabel"]:46,["AutoSum_Min_FriendlyLabel"]:47,["AxisTitle_Horizontal_None_FriendlyLabel"]:48,["AxisTitle_Vertical_None_FriendlyLabel"]:49,["ChartTitle_Centered_FriendlyLabel"]:50,["ChartTitle_None_FriendlyLabel"]:51,["DataTable_None_FriendlyLabel"]:52,["Insert_Tables_Form_FriendlyLabel"]:53,
["Jewel_DownloadCopy_FriendlyLabel"]:54,["Jewel_DownloadAsOds_FriendlyLabel"]:55,["Jewel_Embed_FriendlyLabel"]:56,["Jewel_NewBlank_FriendlyLabel"]:57,["Jewel_PreviousVersions_FriendlyLabel"]:58,["Jewel_Share_FriendlyLabel"]:59,["Legend_None_FriendlyLabel"]:60,["Number_NumberFormatAccounting_FriendlyLabel"]:61,["Number_NumberFormatCurrency_FriendlyLabel"]:62,["Number_NumberFormatFraction_FriendlyLabel"]:63,["Number_NumberFormatGeneral_FriendlyLabel"]:64,["Number_NumberFormatLongDate_FriendlyLabel"]:65,
["Number_NumberFormatNumber_FriendlyLabel"]:66,["Number_NumberFormatPercentage_FriendlyLabel"]:67,["Number_NumberFormatScientific_FriendlyLabel"]:68,["Number_NumberFormatShortDate_FriendlyLabel"]:69,["Number_NumberFormatText_FriendlyLabel"]:70,["ShapeStyles_ShapeMoreStyles_FriendlyLabel"]:71,["Number_NumberFormatTime_FriendlyLabel"]:72,["Ewr_FindInWorksheetDialogTitle"]:73,["Ewr_Ribbon_Insert_Function"]:74,["Jewel_RenameFileDialog_FriendlyLabel"]:75,["TableStyles_TableMoreStyles_FriendlyLabel"]:76,
["Ewr_SpellCheckUpSell"]:77,["Ewr_MacrosUpSell"]:78,["Ewr_PivotTableUpSell"]:79,["Ewr_HeaderFooterUpSell"]:80,["Ewr_DeskTopFeature"]:81,["Ewr_OpenInDesktopExcel"]:82,["Ewr_OpenInDesktopDescription"]:83,["Ewr_DesktopUpSellTitle"]:84,["Ewr_DesktopUpSellDescription"]:85,["Tables_PivotTable_FriendlyLabel"]:86,["Ewr_Cell_Styles"]:87};Object(d.a)(eb,"TellMeStringMapping",null,[]);class Fa{constructor(){this.A0a=yb.a.current.P$e||[]}fhj(Gb){for(let qc in Gb){var wb=qc;this.$_b(Gb,wb);Fa.Hse(Gb,wb)}}SUf(Gb){var wb=
Fa.KKa(Gb);for(let xb in wb){var qc=xb,Ya=wb[xb];void 0!==Ya&&null!==Ya&&(Fa.Hse(wb,qc),this.$_b(wb,qc))}Gb=Fa.Bo(Gb);for(wb=0;wb<Gb.length;wb++)this.SUf(Gb[wb])}$_b(Gb,wb){if(Gb[wb]){let qc=Gb[wb].toString();for(let Ya=0,xb=this.A0a.length;Ya<xb;Ya++)if(this.A0a[Ya].SubstitutionToken){let wc=bb.a.Cc(Fa.Aqb,this.A0a[Ya].ImageName);wc||(wc=new RegExp(this.A0a[Ya].SubstitutionToken,"g"),Fa.Aqb[this.A0a[Ya].ImageName]=wc);qc=qc.replace(wc,this.A0a[Ya].ImagePath)}Gb[wb]=qc}}static KKa(Gb){return Gb.attrs}static Bo(Gb){Gb=
Gb.children;return void 0===Gb||null===Gb?[]:Gb}static Hse(Gb,wb){if(Gb[wb]){var qc=Gb[wb].toString(),Ya=qc.split(".");if(2===Ya.length&&"TellMeStringId"===Ya[0])if(qc=eb.l8h[Ya[1]],Ya=_EwaS.TellMeStringManagerData.BootstrapStringDictionary[va.a.ssb].UnencodedStrings){if(0>qc||qc>=Ya.length)throw Error.argumentOutOfRange("Could not find resource with id "+qc);qc=Ya[qc]}else throw Error.invalidOperation("String dictionary could not be loaded");Gb[wb]=qc}}}Fa.Aqb={};Object(d.a)(Fa,"EwaResolver",null,
[462,463]);class tb{constructor(){this.Ice=this.Jce=null}get GBi(){return this.Ice}YP(Gb){this.Jce=Gb;return this.Q8g(Gb)}nEi(){this.Ice=this.Jce}ERh(Gb){return 8===Gb.type?String.format(CommonUIStrings.l_FindInDocumentText,Gb.Qz):Gb.Qz}ILh(Gb){return Gb.Qz}}Object(d.a)(tb,"ParameterizedCommand",null,[]);var dc=a(311);class jc extends tb{constructor(Gb){super();this.isReactRibbonEnabled=Gb}get commandId(){return this.isReactRibbonEnabled?"FindParameterized":"Editing.Find"}get xWi(){return"Find"}Q8g(Gb){const wb=
G.a.nf(String.format(va.a.instance.Va(423),Gb.Qz));return dc.a(jb.a.Abh(Gb.value),"1540292897",wb,"find16",null,G.a.nf(Gb.Qz),wb,null,null)}}Object(d.a)(jc,"FindParameterizedCommand",tb,[]);class fb extends Kb{constructor(Gb){super(window.TellMeControlMetadataOverrides);this.oVa="Excel";this.BWb="-1376725189";this.AWb="-1386334072";const wb=new Fa;this.dhj(wb);var qc=new jc(this.Ri);this.parameterData[qc.commandId]=qc;c.AFrameworkApplication.fa.qa("TellMeTryQueriesIsEnabled")&&(qc=[new Qa(va.a.instance.Va(418),
"",!1),new Qa(va.a.instance.Va(419),"",!1),new Qa(va.a.instance.Va(420),"",!1),new Qa(va.a.instance.Va(421),"",!1),new Qa(va.a.instance.Va(422),"",!1)],this.Ara=this.Nfh(qc));this.$gj(wb);c.AFrameworkApplication.fa.qa("TellMeFindInDocumentIsEnabled")&&(this.O7d=!0,this.N7d=this.Ri?"FindParameterized":"EditingFind");this.$=Gb}get sRa(){return pb.a.QJb}get Ctf(){return Ob.getImageClass("OfficeAssistant_32x32x32")}pXe(){const Gb=new ha.a;return new qa.a("TellMeRoot",Gb)}H1f(Gb){const wb=c.AFrameworkApplication.fa.qa("TellMeDesktopUpSellIsEnabled")&&
c.AFrameworkApplication.fa.qa("TellMeDesktopUpSellInExcel"),qc=c.AFrameworkApplication.Yni;Gb=Gb.kj;Gb.MacrosUpSellButton=!wb||qc;Gb.HeaderFooterUpSellButton=!wb||qc;Gb.MacrosUpSellButtonEnterprise=!wb||!qc;Gb.HeaderFooterUpSellButtonEnterprise=!wb||!qc}get Tif(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.NotesSuggestionIsEnabled",!1)}get Wif(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermNotesSuggestionIsEnabled",
!1)}get D1e(){return c.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.Excel.TellMe.NumberOfNotesSuggestionsToShow",2)}get g$f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.ZeroTermModelName","")}get f$f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.MultiLanguageModelName","")}get OVd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ServiceAADAuthIsEnabled",!1)}get e$f(){return c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.HelpClassifierModelName",
"")}get Odb(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowImageSearchResults",!1)}get Qpd(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.MLCModelIsEnabled",!1)}get c5f(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.ShowMoreFileResults",!1)}get zic(){return c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.EnableRankerLogging",!1)}get c1e(){var Gb=
c.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.Excel.TellMe.NBClassifierScoreThreshold","-7.0");Gb=parseFloat(Gb);return isNaN(Gb)?-7:Gb}get Ope(){let Gb=!1;this.$&&(Gb=!m.EwaSettings.ma(186)&&this.$.ea.Wg.get(27)&&this.$.V9);return Gb}get Ppe(){let Gb=!1;this.$&&(Gb=this.$.pe.get(35));return Gb}}Object(d.a)(fb,"ExcelTellMeApplicationData",Kb,[]);class ec{constructor(Gb){this.commandUIManager=null;this.dIi=wb=>{this.commandUIManager=wb;Bb.a(this.Jc).ZFa(this.sca)};this.sca=()=>
{this.commandUIManager=this.Jc.da.za(53)};this.Jc=Gb;this.Jc.da.Za(53,this.dIi)}Lc(){return!1}executeCommand(Gb,wb,qc){Gb=0;switch(wb.command){case -1642491107:Gb=w.a.tellMe;break;case -240091811:Gb=w.a.tellMeAccessibilityMenuText;break;case -1543335331:Gb=w.a.tellMeCacheAsyncMenuRefresh;break;case 815990803:Gb=w.a.tellMeFocusInput;break;case 586156566:Gb=w.a.tellMeInteractionBegin;break;case -1051173363:Gb=w.a.tellMeRestoreFocus;break;case 878547493:Gb=w.a.tellMeLogCommandExecuted;break;case 1024534176:Gb=
w.a.tellMeLogInputBlur;break;case -1991747669:Gb=w.a.tellMeLogInputFocus;break;case -28797232:Gb=w.a.tellMeLogMenuClose;break;case -1814078912:Gb=w.a.tellMeLogMenuOpen;break;case 1404166600:Gb=w.a.tellMeTryQuery;break;case -2064212100:Gb=w.a.tellMeFeedback}let Ya=0;Gb&&(Ya=c.AFrameworkApplication.vb.de(Gb,2,qc),this.nUj());x.ULS.sendTraceTag(537151007,0,50,`TellMeCommandHandler.ExecuteCommand: ActionId (${Gb}) , response (${Ya})`);return Gb&&2!==Ya?r.Task.Ta(!0):u.a(wb.command)}Ac(Gb,wb){Gb=!1;switch(wb.command){case -1642491107:case -240091811:case -1543335331:case 815990803:case 586156566:case 878547493:case 1024534176:case -1991747669:case -28797232:case -1814078912:case 1404166600:case -2064212100:Gb=
!0}return Gb}Oc(Gb,wb,qc){"PopulateTellMe"===wb&&c.AFrameworkApplication.vb.de(w.a.tellMe,2,qc);return!1}dispose(){!!this.Jc&!!Bb.a(this.Jc)&&Bb.a(this.Jc).XQa(this.sca);this.commandUIManager=null}nUj(){!m.EwaSettings.ma(23)&&this.commandUIManager&&this.commandUIManager.Zdg("sbTellMe",!1)}static initData(Gb){Gb=new fb(Gb);Ma.TellMeActor.instance.initialize(Gb,null,null,null,null,null,Nb.a.pC.TBa,c.AFrameworkApplication.fa,F.a.instance.Ub("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
null,F.a.instance.Ub("Common.ISystemInitiatedFeedback"));Ma.TellMeActor.instance.Ig()}}Object(d.a)(ec,"TellMeCommandHandler",null,[164,10]);class lb extends f.a{constructor(Gb){super(Gb)}vd(){const Gb=[];var wb=yb.a.loadScript(91,4,this.fb,void 0,void 0,108);const qc=yb.a.loadScript(c.AFrameworkApplication.ta.Oa.Sif?95:94,4,this.fb,void 0,void 0,108);Gb.push(wb);Gb.push(qc);wb=!1;(wb=c.AFrameworkApplication.fa.qa("TellMeIsSuggestionsForSimplifiedUxEnabled"))&&Gb.push(yb.a.loadScript(96,4,this.fb,
void 0,void 0,108));wb=!1;(wb=c.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.RegisterAgaveCommandManagerForTellMeAddinSearch",!1))&&Gb.push(ta.GetServiceTaskFactory.Sa(this.$.da,374,375,1));K.TaskExtensions.Aa(r.Task.XI(...Gb),()=>{m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TellMe.InitTellMeApplicationDataWithEwaControl",!1)?ec.initData(this.$):ec.initData();this.$c([new ec(this.$)])},this.la,3)}static ka(Gb){f.a.Od(108,new lb(Gb))}}Object(d.a)(lb,"TellMeCommandHandlerFactory",
f.a,[]);var ac=window.AssistanceTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"AssistanceTaskPane",Title:"Office Assistance",Width:"330"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"AssistanceIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ConditionalFormatting");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.NumberFormat");Type.registerNamespace("_Ewa");
Type.registerNamespace("Common.App.Assistance");c.AFrameworkApplication.a_a&&(b.a.instance.Gi(new V),W.a.Fa(y.ka));Type.registerNamespace("NLRT");da.a.Qi('.NumberFormatStyleItem{color:#444;font:inherit}.NumberFormatStyleItem select,.NumberFormatStyleItem input{margin-bottom:1.5%}.NumberFormatCategoryList{width:22%;height:50%;margin-bottom:20%;height:65%}.NumberFormatRtlFloat{float:right}.NumberFormatLtrFloat{float:left}.NumberFormatDynamicList{width:70%;height:70%}.NumberFormatDynamicListRtlMargin{margin-right:3%}.NumberFormatDynamicListLtrMargin{margin-left:3%}.NumberFormatDlgFunctionBody{margin:0 13px 10px 13px;width:100%;height:346px}.NumberFormatDlgWidth{width:560px}.NumberFormatDlgBodyWidth{width:560px}.NumberFormatDescriptionItem{height:32%;width:95%;position:relative;top:4%;z-index:-1}.NumberFormatLinkItem{margin-bottom:6px;display:inline-block}.NumberFormatRtlLabelItem{margin-left:2%}.NumberFormatLtrLabelItem{margin-right:2%}.NumberFormatSampleItem{width:100%;background-color:#fff}.NumberFormatDynamicListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemWidth{width:100%;font:inherit}.NumberFormatCategoryListItemHeight{max-height:325px}.NumberFormatSymbolItemWidth{width:100%}.NumberFormatItemColorStyle{color:#f00}.NumberFormatFocusCheckbox{outline:none}.NumberFormatBorderLabel{border:1px #808080 dashed}.NumberFormatFontLabel{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif}.NumberFormatSelectionBorder{border:1px solid #a9a9a9}');
W.a.Fa(hb.ka);W.a.Fa(ea.ka);vb;da.a.Qi('.ewa-condfmt-dlg-err-label{width:400px;min-height:21px;margin-bottom:-15px;font-size:8pt;color:#d90000}.ewa-condfmt-dlg-header-label{font-weight:bold}.ewa-condfmt-dlg-with-label{padding-left:3px;padding-right:3px}.ewa-condfmt-dlg-list{width:auto;width:initial}.ewa-condfmt-dlg-input{width:auto;width:initial;padding-left:3px}.CondtionalFormattingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.CondtionalFormattingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.CondtionalFormattingPaneBody{flex:auto;position:relative}.CondtionalFormattingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.CondtionalFormattingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(()=>{W.a.Fa(Gb=>{Sa.ka(Gb);db.ka(Gb)})})();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");W.a.Fa(lb.ka);Type.registerNamespace("Common.App.Assistance");ac},697:function(n,C,a){a.r(C);n=a(0);var c=a(414),b=a(718),d=a(704),f=a(917),e=a(918);class k{constructor(m,u){this.rqa=!1;this.gR=null;if(!m)throw Error.argumentNull("annotations");if(!m.T7a(u))throw Error.argument("structTypeID",
"Invalid struct type ID");this.Wl=m;this.U8a=this.Wl.A1e(u);this.jyg=u}get LZa(){return this.Wl}get isReadOnly(){return this.rqa}get cea(){return this.jyg}xva(m){if(0>m||m>=this.U8a)throw Error.argument("iField","Invalid field index");return this.gR&&null!=this.gR[m]?this.gR[m]:this.Wl.a4e(this.cea,m)}OPd(m,u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>m||m>=this.U8a)throw Error.argument("iField","Invalid field index");if(!this.Wl.T6a(this.Wl.VKa(this.cea,
m),u))throw Error.argument("value","Value is not of the correct type for the specified field");(this.gR||(this.gR=Array(this.U8a)))[m]=u}PO(){const {Annotations:m}=a(697);let u="[";if(this.gR){let t=!0;for(let w=0;w<this.U8a;++w){if(null==this.gR[w])continue;const r=this.Wl.VKa(this.cea,w);if(m.iCa(r,this.gR[w],this.Wl.a4e(this.cea,w)))continue;t?t=!1:u+=", ";u+=this.Wl.b4e(this.cea,w);u+="=";const v=this.Wl.PO(r,this.gR[w]);r===m.EL?(u+='"',u+=b.a.w9c(v),u+='"'):u+=v}}return u+"]"}isEqual(m){const {Annotations:u}=
a(697);if(this===m)return!0;if(!m||this.Wl!==m.LZa||this.cea!==m.cea)return!1;for(let t=0;t<this.U8a;++t)if(!u.iCa(this.Wl.VKa(this.cea,t),this.xva(t),m.xva(t)))return!1;return!0}clone(){const m=new k(this.Wl,this.cea);this.gR&&(m.gR=Array.clone(this.gR));return m}XA(){return this.isReadOnly?this.clone():this}Fud(){const {Annotations:m}=a(697);if(!this.isReadOnly&&(this.rqa=!0,this.gR))for(let u=0;u<this.U8a;++u){const t=this.gR[u];null!=t&&m.dOa(t)}}toString(){return this.PO()}}Object(n.a)(k,"StructValue",
null,[633,634]);a.d(C,"Annotations",function(){return l});class l{constructor(m,u){if(!m)throw Error.argumentNull("initData");if(!u)throw Error.argumentNull("objectFetcher");this.zxi=u.Tih;let t=0;var w=u.mva(m.na(t));++t;this.uwd=new f.a(new e.a(w));this.Kpg=m.na(t);++t;this.gpf=Array(this.o8b);this.QCb=Array(this.o8b);this.bya=Array(this.o8b);for(w=0;w<this.o8b;++w){this.gpf[w]=u.ga(m.na(t));++t;this.QCb[w]=m.na(t);++t;var r=m.na(t);++t;this.bya[w]=Array(r);for(var v=0;v<r;++v)this.bya[w][v]=u.ga(m.na(t)),
++t}this.iyg=m.na(t);++t;this.eqf=Array(this.rNb);this.Ykc=Array(this.rNb);this.Zkc=Array(this.rNb);this.Xkc=Array(this.rNb);for(w=0;w<this.rNb;++w)for(this.eqf[w]=u.ga(m.na(t)),++t,r=m.na(t),++t,this.Ykc[w]=Array(r),this.Zkc[w]=Array(r),this.Xkc[w]=Array(r),v=0;v<r;++v)this.Ykc[w][v]=u.ga(m.na(t)),++t,this.Zkc[w][v]=m.na(t),++t,this.Xkc[w][v]=({HQ:t}=this.BIa(this.Zkc[w][v],m,t,null,null,null)).returnValue,l.dOa(this.Xkc[w][v]);this.Mmg=m.na(t);++t;this.Svd=Array(this.i_a);this.Tvd=Array(this.i_a);
this.Rvd=Array(this.i_a);for(w=0;w<this.i_a;++w)this.Svd[w]=u.ga(m.na(t)),++t,this.Tvd[w]=m.na(t),++t,this.Rvd[w]=({HQ:t}=this.BIa(this.Tvd[w],m,t,null,null,null)).returnValue,l.dOa(this.Rvd[w])}ivb(m){for(let u=0;u<this.i_a;++u)if(this.Svd[u]===m)return u;return-1}KXe(m){if(!this.Q7a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Svd[m]}getAttributeType(m){if(!this.Q7a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Tvd[m]}VKa(m,u){if(!this.T7a(m))throw Error.argument("structTypeID",
"Invalid struct type ID");m=this.Zkc[l.sNb(m)];if(0>u||u>=m.length)throw Error.argument("iField","Invalid field index");return m[u]}PO(m,u){if(!this.nsd(m))throw Error.argument("typeID","Invalid type ID");if(!this.T6a(m,u))throw Error.argument("value","Value is not of the correct type");switch(m){case l.EL:return u;case l.S0:return u?"True":"False";case l.P7:case l.YW:return u.toString();case l.TB:return u.PO();default:if(!l.Lt(m)&&l.POb(m)){m=l.k9c(m);const r=this.bya[m].length;switch(this.QCb[m]){case 0:return this.bya[m][u];
case 1:if(u){var t="";for(var w=1;w<r;++w)u&1<<w-1&&(0<t.length&&(t+=" & "),t+=this.bya[m][w]);return t}return this.bya[m][0];case 2:t="";for(w=0;w<r;++w)u&1<<w&&(0<t.length&&(t+=" & "),t+=this.bya[m][w]);return t;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.QCb[m]);}}else return u.PO()}}nsd(m){switch(m){case l.EL:case l.S0:case l.P7:case l.YW:case l.TB:return!0;default:return l.Lt(m)?this.nsd(l.Cja(m)):l.POb(m)?this.Hoi(m):this.T7a(m)}}Hoi(m){m=l.k9c(m);return 0<=m&&
m<this.gpf.length}T7a(m){m=l.sNb(m);return 0<=m&&m<this.eqf.length}Q7a(m){return 0<=m&&m<this.i_a}T6a(m,u){if(null==u)return!1;switch(m){case l.EL:return"string"===typeof u;case l.S0:return"boolean"===typeof u;case l.P7:return"number"===typeof u;case l.YW:return"number"===typeof u;case l.TB:return Object(c.a)(631,u);default:if(l.Lt(m))return Object(c.a)(632,u)&&u.hI===l.Cja(m);if(l.POb(m)){if("number"!==typeof u)return!1;m=l.k9c(m);const t=this.bya[m].length;switch(this.QCb[m]){case 0:return 0<=u&&
u<t;case 1:return!(u&-1<<t-1);case 2:return!!u&&!(u&-1<<t);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.QCb[m]);}}else return Object(c.a)(633,u)&&u.cea===m}}get i_a(){return this.Mmg}get o8b(){return this.Kpg}get rNb(){return this.iyg}dJh(m){if(!this.Q7a(m))throw Error.argument("attrID","Invalid attribute ID");return this.Rvd[m]}A1e(m){if(!this.T7a(m))throw Error.argument("structTypeID","Invalid struct type ID");return this.Ykc[l.sNb(m)].length}b4e(m,u){if(!this.T7a(m))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.Ykc[l.sNb(m)][u]}a4e(m,u){if(!this.T7a(m))throw Error.argument("structTypeID","Invalid struct type ID");m=this.Xkc[l.sNb(m)];if(0>u||u>=m.length)throw Error.argument("iField","Invalid field index");return m[u]}BIa(m,u,t,w,r,v){if(!u)throw Error.argumentNull("initData");if(l.Lt(m)){var y=u.na(t);++t;m=l.Cja(m);var x=new d.a(this,m);for(var B=0;B<y;++B)Array.add(x.items,({HQ:t}=this.BIa(m,u,t,w,r,v)).returnValue);return{returnValue:x,HQ:t}}switch(m){case l.EL:return{returnValue:(w||
this.uwd).ga(u.na(t++)),HQ:t};case l.S0:return{returnValue:1===u.na(t++),HQ:t};case l.P7:return{returnValue:u.na(t++),HQ:t};case l.YW:return{returnValue:(r||this.zxi)[u.na(t++)],HQ:t};case l.TB:m=u.na(t++);y=new b.a(this);for(x=0;x<m;++x)B=u.na(t),++t,v&&(B=v[B]),y.Hn(B,({HQ:t}=this.BIa(this.getAttributeType(B),u,t,w,r,v)).returnValue);return{returnValue:y,HQ:t};default:if(l.POb(m))return{returnValue:u.na(t++),HQ:t};if(l.ncg(m)){y=u.na(t++);x=new k(this,m);for(B=0;B<y;++B){const z=u.na(t);++t;x.OPd(z,
({HQ:t}=this.BIa(this.VKa(m,z),u,t,w,r,v)).returnValue)}return{returnValue:x,HQ:t}}throw Error.argument("typeID","Invalid type ID");}}static POb(m){return 16<=(m&16383)&&16384!==(m&16384)&&32768!==(m&32768)}static ncg(m){return 16<=(m&16383)&&16384===(m&16384)&&32768!==(m&32768)}static Lt(m){return 32768===(m&32768)}static dSh(m){if(l.Lt(m))throw Error.argument("nonListTypeID","Non-list type ID required");return m|32768}static Cja(m){if(!l.Lt(m))throw Error.argument("listTypeID","List type ID required");
return m&-32769}static iCa(m,u,t){switch(m){case l.EL:case l.S0:case l.P7:case l.YW:return u===t;case l.TB:return u.isEqual(t);default:return l.Lt(m)?u.isEqual(t):l.POb(m)?u===t:u.isEqual(t)}}static dOa(m){Object(c.a)(634,m)&&m.Fud()}static XA(m){return Object(c.a)(634,m)?m.XA():m}static k9c(m){return m-16}static sNb(m){return(m&-16385)-16}}l.EL=1;l.S0=2;l.P7=3;l.YW=5;l.TB=9;Object(n.a)(l,"Annotations",null,[635])},701:function(n,C,a){n=a(0);var c=a(331);class b{constructor(){this.userId=this.email=
this.displayName=null}}Object(n.a)(b,"InsertMentionParameters",null,[]);class d{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(n.a)(d,"InsightsParameters",null,[]);var f=a(1094),e=a(1095),k=a(1096),l=a(1097),m=a(4);class u{constructor(){this.currentDocumentPath=m.AFrameworkApplication.fa.Xa("EditDocInClientUrl")}}Object(n.a)(u,"SmartLookupApplicationInterface",null,[]);class t{}Object(n.a)(t,"SmartLookupSelection",null,[]);var w=a(41),r=a(27),v=a(30),y=a(695);
a.d(C,"a",function(){return x});class x{static get Eci(){return"Insights_16x16x32"}static get yBh(){return"Find_16x16x32"}static get uHf(){return"-Parameterized"}static get YTd(){return"Parameterized"}static get qBc(){return"bTryQuery"}static get PYd(){return"TellMeSuggestion_"}static get acg(){return"bTryQueryAlternate"}static get IWd(){return"MenuTellMe"}static get NXi(){const B={},z=[];Array.add(z,{Term:{PeopleType:"Person"}});B.And=z;return B}static Abh(B){return B+x.uHf}static getParameter(B){let z=
"",A="";if(B)for(let I=0;I<B.qTe;++I)"Type"===B.uKa(I)?z=B.Uva(I):"Value"===B.uKa(I)&&(A=B.Uva(I));return new c.a(z,A)}static P4c(B){B=Object.assign(new d,{neighborhood:B,mentionStart:0,mentionLength:B.length});return w.c(B)}static eGe(B,z,A){B=Object.assign(new b,{displayName:B,email:z,userId:A});return w.c(B)}static tta(B,z,A=null){B=Object.assign(new t,{neighborhood:B,mentionStart:0,mentionLength:B?B.length:0});z=Object.assign(new u,{selection:B,userIntent:null,entryPoint:z,launchData:A});return w.c(z)}static Khj(B,
z){return x.tta(B,x.Lhj(z))}static Lhj(B){switch(B){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static aff(){return!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.qa("IsGoLocalEnvironment")}static lNa(){const B=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Xa("SovereignEnvironmentName"):null;return!!B&&0<B.length}static isEnterpriseUser(){const B=m.AFrameworkApplication.fa?
m.AFrameworkApplication.fa.Xa("HostAuthType"):null;return!!B&&"aad"===B.toLowerCase()||"external"===B&&x.hod()}static fSd(B){return B.tIj&&!x.lNa()}static Whf(){const B=m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.Xa("UiHostIntegrationType"):"";return!!m.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===B&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",!1)}static eSd(B){return B.tellMeInSharedHeaderIsEnabled&&B.fetchTokensForSearch&&
(B.WNb||B.VNb||B.Bxa)&&!x.Whf()&&x.isEnterpriseUser()&&!x.lNa()}static k5(){return m.AFrameworkApplication.fa?m.AFrameworkApplication.Wna||m.AFrameworkApplication.fa.qa("SmartLookupEnableNativePane"):m.AFrameworkApplication.Wna}static mD(B){return!B||x.Cif(B.Gd)}static Cif(B){return!B||!B.trim().length}static BYd(B){if(!B)return 0;const z=Math.pow(10,5);return Math.round(B*z)/z}static toUtc(B){return B?new Date(B.getUTCFullYear(),B.getUTCMonth(),B.getUTCDate(),B.getUTCHours(),B.getUTCMinutes(),B.getUTCSeconds(),
B.getUTCMilliseconds()):null}static Hhd(B){B=new Date(B);return(x.toUtc(new Date).getTime()-B.getTime())/1E3}static Rif(B){const {InsightsMenuItemFactory:z}=a(1093);switch(B){case f.a.fkd:case e.a.HUe:case z.Dbf:case k.a.Btf:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return B.startsWith(x.qBc)||
B.startsWith(x.PYd)||B.startsWith(x.acg)||B.startsWith("PeopleSuggestion")||B.startsWith("FileSuggestion")||B.startsWith("FindInDocumentSuggestion")||B.startsWith("NotesSuggestion")||B.startsWith("OnenoteNotesSuggestion")||B.startsWith("SmartLookupFromTellMe")||B.startsWith("GetHelpFromTellMe")||B.startsWith("GetHelpWithDescriptionFromTellMe")||B.startsWith("AddinSuggestion")||B.startsWith("OfficeScripts")?!0:!1}static dfd(B,z){const A=[];Array.add(A,new l.a(400,B));Array.add(A,new l.a(200,z));B=
{};B.parts=A;return JSON.stringify(B)}static kva(B){const z=B.indexOf("<b0>"),A=B.lastIndexOf("</b0>"),I=[];Array.add(I,new l.a(400,B.substring(0,z)));Array.add(I,new l.a(600,B.substring(z+4,A)));Array.add(I,new l.a(400,B.substring(A+5,B.length)));B={};B.parts=I;return JSON.stringify(B)}static w4e(B){const z=x.Hhd(B);return 60>z?CommonUIStrings.l_TimeSince_SecsAgo:3600>z?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(z/60).toString()):86400>z?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(z/3600).toString()):172800>z?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(B)).localeFormat("MMMM dd, yyyy"))}static CLh(B){const z=Array(B.length);for(let A=0;A<B.length;A++)z[A]=B[A].commandId;return z}static hod(){if("Dev Box"===m.AFrameworkApplication.fa.Xa("StatusBarEnvironmentNameToUse"))return!0;let B=m.AFrameworkApplication.fa.Xa("UserPrincipalName");B=y.c(B)?"":v.a.sl(B);const z=m.AFrameworkApplication.fa.wo("TellMeIntEnabledForFeatureCrew")?
m.AFrameworkApplication.fa.ow("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(z,B)&&"inner"===m.AFrameworkApplication.fa.Xa("Microsoft365Ring")}static MQh(B){switch(B.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Dka(){return r.a.tv&&!r.a.yp}}x.zag=9E5;Object(n.a)(x,"TellMeUtils",null,[])},702:function(n,C,a){a.r(C);n=a(0);var c=a(84),b=a(414),d=a(82),f=a(942),e=a(92);class k{constructor(ma,hb,vb,Va,db,oa){this.groupType=ma;this.resultType=hb;
this.FVd=vb;this.iLa=Va;this.j7c=db;this.resultIndex=oa}}Object(n.a)(k,"ClickLoggingInfo",null,[]);const l=ma=>{const hb=[];for(;ma;)Array.add(hb,"{ContextId:"+ma.contextId+", IsGraphNodeContext:"+ma.Pgc+"}"),ma=ma.VDb;hb.reverse();return"{"+hb.join(", ")+"}"};class m{constructor(){this.fV=this.sessionId=null}}Object(n.a)(m,"CorrelationRecord",null,[494]);var u=a(729);class t{constructor(ma,hb){this.Id=null;this.TimeStamp=0;this.Id=ma;this.TimeStamp=hb}}Object(n.a)(t,"MRUControl",null,[]);var w;(function(ma){ma[ma.Answer=
0]="Answer";ma[ma.Definition=1]="Definition";ma[ma.Entity=2]="Entity";ma[ma.WolframAnswer=3]="WolframAnswer";ma[ma.Assistance=4]="Assistance";ma[ma.Command=5]="Command";ma[ma.Document=6]="Document";ma[ma.TryQuery=7]="TryQuery";ma[ma.FindInDocument=8]="FindInDocument";ma[ma.HelpAction=9]="HelpAction";ma[ma.Insights=10]="Insights";ma[ma.People=11]="People";ma[ma.Image=12]="Image";ma[ma.FirstRunResult=13]="FirstRunResult";ma[ma.NoCommandsFoundResult=14]="NoCommandsFoundResult";ma[ma.TestResult=15]="TestResult";
ma[ma.AppsForOffice_Installed=16]="AppsForOffice_Installed";ma[ma.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";ma[ma.AppsForOffice_Query=18]="AppsForOffice_Query";ma[ma.Notes_Onenote=19]="Notes_Onenote";ma[ma.Notes_Samsung=20]="Notes_Samsung";ma[ma.Notes_Sticky=21]="Notes_Sticky";ma[ma.Learning=22]="Learning";ma[ma.Feedback=23]="Feedback";ma[ma.Template=24]="Template";ma[ma.Addin=25]="Addin";ma[ma.OfficeScript=26]="OfficeScript";ma[ma.AddinStoreEntry=27]="AddinStoreEntry";ma[ma.Unknown=
28]="Unknown"})(w||(w={}));Object(n.b)("ResultType",w);var r=a(915),v=a(701),y=a(4),x=a(816);class B{constructor(ma,hb){this.Wtg=10;this.lJ=[];this.J1=[];this.K$d=this.J$d=!1;this.jkb=this.ikb="";this.gXa=hb;this.Wa=ma;this.gae=ma.Ri}rKa(){!this.J$d&&this.gae&&this.Wa&&r.a.fgf()&&(this.ikb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.Wa.application,this.lJ=this.bYe(),this.J$d=!0);return this.lJ}yVh(){!this.K$d&&this.gae&&this.Wa&&r.a.fgf()&&(this.jkb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.Wa.application,
this.J1=this.bYe(!0),this.K$d=!0);return this.J1}Zni(ma){return ma.startsWith("TellMeUpsell")||"OpenInClientUpsell"===ma||"TryOfficeUpsell"===ma}Xnd(ma){return this.$ei(ma)||this.Zni(ma)||v.a.Rif(ma)?!1:!0}l2(ma){ma=ma.ControlId;this.Xnd(ma)&&(ma=this.bKd(ma),this.aaj(ma),this.Ayi(),Array.insert(this.lJ,0,new t(ma,Date.now())),this.ikb.length&&(ma=JSON.stringify(this.lJ),x.a.instance.setItem(this.ikb,ma)))}Tu(ma){this.zyi();Array.insert(this.J1,0,new t(w[ma],Date.now()));this.jkb.length&&(ma=JSON.stringify(this.J1),
x.a.instance.setItem(this.jkb,ma))}bYe(ma=!1){if(!this.lJ.length){var hb=ma?x.a.instance.getItem(this.jkb):x.a.instance.getItem(this.ikb);if(!hb||""===hb)return ma?this.J1:this.lJ;let vb=null;try{vb=JSON.parse(hb)}catch(Va){this.aZg(ma),vb=null}if(!vb||!vb.length||10<vb.length)return ma?this.J1:this.lJ;hb=0;for(const Va of vb)if(ma||this.Wa.Lic(Va.Id)&&this.Xnd(Va.Id))if(ma?Array.insert(this.J1,hb++,Va):Array.insert(this.lJ,hb++,Va),hb===this.gXa)break}return ma?this.J1:this.lJ}S2c(ma){ma=this.bKd(ma);
for(const hb of this.lJ)if(hb.Id===ma)return!0;return!1}aZg(ma=!1){x.a.instance.setItem(ma?this.jkb:this.ikb,"")}zgi(ma){ma=this.bKd(ma.ControlId);return this.Xnd(ma)?this.S2c(ma):!1}aaj(ma){if(0<this.lJ.length){let hb=0;for(const vb of this.lJ){if(vb.Id===ma){Array.removeAt(this.lJ,hb);break}hb++}}}bKd(ma){return"Excel"===this.Wa.application&&ma.startsWith("m_excelWebRenderer_ewaCtl_")?ma.substr(26,ma.length):ma}Ayi(){this.lJ.length===this.gXa&&Array.removeAt(this.lJ,this.lJ.length-1)}zyi(){this.J1.length===
this.Wtg&&Array.removeAt(this.J1,this.J1.length-1)}$ei(ma){ma=ma.split("|");let hb="";if(6<=ma.length)hb=ma[0];else if(3<=ma.length){if("3"===ma[0])return!0;hb=ma[1]}return hb.startsWith("WA")}static createInstance(ma){let hb=3;y.AFrameworkApplication.fa&&(hb=y.AFrameworkApplication.fa.qd("TellMeMaxRecommendedResultsToReturn",3));return new B(ma,hb)}}Object(n.a)(B,"MruControlsManager",null,[490]);class z{constructor(ma){this.GEa=ma}YP(ma,hb){let vb;return ma.Qz&&(vb=this.GEa[ma.value])?vb.YP(ma,hb):
(vb=this.IYe(ma.value))?vb.YP(vb.GBi,hb):null}pUh(ma,hb){if(ma=this.GEa[ma])for(const vb of hb)if(hb=v.a.getParameter(vb),hb.key===ma.xWi)return hb.value;return null}pEi(ma){(ma=this.IYe(ma))&&ma.nEi()}IYe(ma){const hb=ma.indexOf(v.a.uHf);return 0<hb?this.GEa[ma.substring(0,hb)]:null}}Object(n.a)(z,"ParameterizedCommandManager",null,[489]);var A=a(743);class I{constructor(ma,hb){this.Gd=ma;this.Iza=hb}}Object(n.a)(I,"TellMeQuery",null,[]);var F=a(916);class U{constructor(ma,hb){this.Id=null;this.TimeElapsedSinceClick=
0;this.Id=ma;this.TimeElapsedSinceClick=hb}}Object(n.a)(U,"CommandClickedEvent",null,[]);var X=a(695);class T{constructor(ma,hb){this.Fug=ma;this.HX=hb}resultsUpdated(ma){this.Fug(X.c(ma.query)?"":ma.query.Gd,ma.vh,ma.attributes,this.HX,ma.o7a)}}Object(n.a)(T,"ResultsUpdatedCallback",null,[488]);var G=a(187);class D{constructor(ma,hb){this.menuModel=ma;this.lVf=hb}}Object(n.a)(D,"GeneratedMenuModel",null,[]);class J{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;
this.ariaRoleDescription=null}}Object(n.a)(J,"MenuModel",null,[]);class L{constructor(ma,hb,vb){this.Wa=ma;this.GEa=hb;this.sFa=vb}wHh(ma,hb,vb){const {TellMeActor:Va}=a(702);let db=0;const oa=new J,Oa=[];let Wa="";oa.sections=[];let Sa=new G.a;const yb=!!this.Wa&&this.Wa.Axa;var Ma=!!this.Wa&&this.Wa.Fdb||y.AFrameworkApplication.ta.Oa.Fdb;for(const Nb of ma){ma=0;yb||(Sa=new G.a);const Ia=new G.a;let jb=Nb.displayName;for(const Ob of Nb.results){if(0<=Ob.value.indexOf(v.a.YTd)){if(Ob.Qz){var Bb=
this.GEa[Ob.value];if(Bb&&Ob.value.endsWith(v.a.YTd)){if("FindParameterized"!==Ob.value&&!Ma){const Jb=[];Jb.push(appChrome.actions.setControlLabel(Ob.value,Bb.ERh(Ob)));Jb.push(appChrome.actions.setButtonCommandValueId(Ob.value,Bb.ILh(Ob)));appChrome.api.dispatch(Jb)}Bb=Ob.value.replace(v.a.YTd,"");Sa.remove(Bb)?ma--:Ia.add(Bb);Sa.add(Ob.value);ma++}}}else switch(Ob.type){case 5:Ia.contains(Ob.value)||(Sa.add(Ob.value),ma++);break;case 7:Sa.add(Ob.Qz);ma++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:Sa.add(Ob.value),
ma++}13===Nb.groupType&&(jb=v.a.k5()?0<hb.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,hb):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,hb));21===Nb.groupType&&(jb=CommonUIStrings.l_LearningUILiveText)}db+=ma;""!==jb&&0<ma&&(Wa+=" , "+ma.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+jb+" , ");0<Sa.count&&!yb&&(ma=appChrome.api.menuSection(Sa.toArray(),Nb.displayName,null,A.a[Nb.groupType]),Oa.push(ma))}Ma=
null;0<db&&(Ma=0<hb.length?1!==db?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,db,hb):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,hb):1!==db?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,db):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,yb?(hb=appChrome.api.menuSection(Sa.toArray(),"",null,null),Oa.push(hb)):Ma+=Wa);vb&&(this.Wa.q4?Va.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Ma)):
appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Ma)));oa.sections=Oa;return new D(oa,db,[])}static get x8c(){return L.$6d||(L.$6d=new D(Object.assign(new J,{sections:[]}),0,[]))}}L.$6d=null;Object(n.a)(L,"TellMeMenuDefintionGenerator",null,[]);var H;(function(ma){ma[ma.TellMeControlActivated=0]="TellMeControlActivated";ma[ma.TellMeQueryExecuted=1]="TellMeQueryExecuted";ma[ma.TellMeResultsRendered=2]="TellMeResultsRendered";ma[ma.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(H||
(H={}));Object(n.b)("PerformanceMarker",H);var R;(function(ma){ma[ma.TellMeTimeToRender=0]="TellMeTimeToRender";ma[ma.TellMeSessionLength=1]="TellMeSessionLength";ma[ma.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(R||(R={}));Object(n.b)("PerformanceMeasure",R);class Q{mark(ma){window.performance.mark(H[ma])}measure(ma,hb,vb){const {TellMeActor:Va}=a(702);try{window.performance.measure(R[ma],H[hb],H[vb])}catch(db){Va.instance.tc.onError("TellMePerformance:Measure","error measuring "+R[ma])}}Yud(ma,
hb,vb){const {TellMeActor:Va}=a(702);Va.instance.tc.hvd(hb,vb,ma,this.xSh(ma))}oZg(){var ma=[0,1,2,3];for(const hb of ma)window.performance.clearMarks(H[hb])}clearMeasures(ma){for(const hb of ma)window.performance.clearMeasures(R[hb])}xSh(ma){let hb=0;(ma=this.zIh(ma))&&0<ma.length&&(hb=ma[ma.length-1].duration);return hb}zIh(ma){return window.performance.getEntriesByName(R[ma],"measure")}}Object(n.a)(Q,"TellMePerformance",null,[]);var O=a(802),V=a(801),W=a(41);class da{constructor(ma){this.Myg=ma}GFb(ma,
hb,vb){const {TellMeActor:Va}=a(702);Va.instance.tc.C_(hb,V.a.Vab,ma.data.httpStatus.toString(),Math.round(window.performance.now()-vb),V.a.Vab,!0,O.a.eba);ma=W.b(ma.data.Xd);hb=-1;ma.Index&&(hb=ma.Index);Va.instance.tc.jwi(hb,this.Myg)}REb(ma,hb,vb){const {TellMeActor:Va}=a(702);Va.instance.tc.C_(hb,V.a.Vab,ma.data.httpStatus.toString(),Math.round(window.performance.now()-vb),V.a.Vab,!1,O.a.eba)}AVh(ma){if(ma&&""!==ma.trim()){const vb=window.performance.now(),Va=y.AFrameworkApplication.a$f;var hb=
{};hb.Text=ma;hb.IsFileHash="false";hb=W.c(hb);y.AFrameworkApplication.yd.Jm(Va,2,hb,{"Content-Type":"application/json",Accept:"application/json"},!1,0,db=>{this.GFb(db,ma.length,vb)},db=>{this.REb(db,ma.length,vb)},null,null,!1,4E3,6E3)}}}Object(n.a)(da,"TellMeQueryIndexCallback",null,[]);var ta=a(706);class K{constructor(ma,hb,vb){this.xml=ma;this.lVf=hb;this.Bhh=vb}}Object(n.a)(K,"GeneratedMenuXml",null,[]);var na=a(1094),P=a(30);class ka{constructor(ma,hb){this.XRb=ma||{};this.Pfa=hb}get nRa(){return 5}YP(ma,
hb=null){return this.Pfa.YP(ma,hb)||this.wRg(ma.value)}wRg(ma){return ka.kZc(ma,this.XRb[ma]||null)}static kZc(ma,hb=null){ma=String.format('<ClonedControl Id="{0}" ',ma);for(let db in hb){var vb=db,Va=hb[db];Va=Va?P.a.nf(Va.toString()):"";ma+=String.format('{0}="{1}" ',vb,Va)}return ma+"/>"}}Object(n.a)(ka,"CommandMenuItemFactory",null,[477]);var pa=a(311);class Na{constructor(){this.mqg=CommonUIStrings.l_FindInDocumentText}get nRa(){return 8}YP(ma){var hb=ma.Qz;ma=P.a.nf(ma.value);const vb=P.a.nf(hb);
hb=P.a.nf(String.format(this.mqg,hb));return this.cGh(ma,vb,hb)}cGh(ma,hb,vb){return pa.a(ma,"1540292897",vb,v.a.yBh,null,hb,vb,null,null)}}Object(n.a)(Na,"FindInDocumentMenuItemFactory",null,[477]);var Z=a(1095),Ra=a(1093),Da=a(1096);class Ba{get nRa(){return 7}YP(ma){const hb=Object(d.a)(F.a,ma);return this.EHh(P.a.nf(ma.value),hb.id)}EHh(ma,hb){return pa.a(hb,"1404166600",ma,null,null,ma,ma,null,null)}}Object(n.a)(Ba,"TryQueryMenuItemFactory",null,[477]);class ea{constructor(ma){this.w7d=[];this.Wa=
ma}DOh(ma){for(const hb of this.w7d)if(hb.nRa===ma)return hb;return null}Uza(ma){this.w7d.push(ma)}b8i(ma){this.Uza(new ka(this.Wa.hDe,ma));this.Uza(new Da.a(this.Wa.Ctf));this.Uza(new na.a(this.Wa.ulj,this.Wa.tlj,this.Wa.AIj,this.Wa.u6h,this.Wa.fxj));this.Uza(new Ra.InsightsMenuItemFactory);this.Uza(new Na);this.Uza(new Z.a);this.Uza(new Ba)}}Object(n.a)(ea,"MenuItemFactoryRegistry",null,[]);var Y=a(709);class ja{constructor(ma,hb){this.Wa=ma;this.oce=new ea(this.Wa);this.oce.b8i(hb)}xHh(ma,hb){let vb=
0;const Va=[],db=[];for(const Oa of ma){ma=v.a.IWd;var oa=[];for(const Wa of Oa.results){const Sa=this.oce.DOh(Wa.type).YP(Wa,hb);ma=v.a.IWd;oa.push(Sa);if(13===Wa.type||14===Wa.type)ma="Menu32";17===Wa.type&&(ma="MenuTellMeExtended");Wa.groupType=Oa.groupType;db.push(Object(d.a)(Y.a,Wa))}vb=vb?vb:oa.length;oa=pa.e("TellMeDropdownControls",oa);ma=pa.h("TellMeDropdownMenuSection",oa,ma,Oa.displayName);Va.push(ma)}hb=pa.i(Va,"LookupDropdownMenu");return new K(hb,vb,db)}static get V7b(){return ja.a7d||
(ja.a7d=new K(pa.i([],"LookupDropdownMenu"),0,[]))}}ja.a7d=null;Object(n.a)(ja,"TellMeXmlGenerator",null,[]);class ca{}ca.dCi="MRU";ca.test="Test";Object(n.a)(ca,"ActionType",null,[]);var ba=a(776),ua;(function(ma){ma[ma.Service=0]="Service";ma[ma.Local=1]="Local";ma[ma.MRU=2]="MRU";ma[ma.TestResult=3]="TestResult";ma[ma.Unknown=4]="Unknown"})(ua||(ua={}));Object(n.b)("SubResultType",ua);var wa=a(111);class ia{constructor(ma,hb,vb,Va,db=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=
this.SubResultType=this.ResultType=null;this.CommandId=ma;this.IsEnabled=hb;this.ResultType=w[vb];this.SubResultType=ua[Va];this.OptionalData=db?wa.a.toJSON(db):null}}Object(n.a)(ia,"ResultInfo",null,[]);var xa=a(124),gb=a(146),va=a(321);class sa{constructor(ma,hb=null){this.L9d="TellMeWAC.";this.bvg=ma;this.nzg=hb}j7(ma,hb,vb){hb=xa.a.Sj(hb);ma=xa.a.c5b(ma,this.bvg,this.nzg,vb,hb);gb.a.j7(ma,this.L9d)}rna(ma,hb,vb=0){hb=xa.a.Sj(hb);gb.a.rna(Object.assign(new va.a,{name:ma,dataFields:hb,durationMs:vb}),
this.L9d)}}Object(n.a)(sa,"TellMeOtelLogger",null,[492]);var ab=a(173);class Ua{constructor(ma,hb,vb,Va,db,oa,Oa){this.nJ=this.aM=this.h5d=null;this.fRb=ma;this.tHc=hb;this.e9=vb;this.qqa=Va;this.tqa=db;this.ctg=oa;this.nJ=Oa?Oa:new sa(this.qqa?e.CuiHelper.XTd:e.CuiHelper.rAc)}get Ri(){return this.qqa}get pbb(){return this.e9}bxc(ma){this.h5d=ma;switch(ma){case ta.a.contextMenu:this.aM=ta.a.contextMenu;break;default:this.aM=ta.a.tellMe}}gPg(ma,hb){this.e9.fV||(this.e9.fV=ab.a.create().toString(),
this.Zmf(ma,!0,hb))}jMe(ma,hb=!0){this.e9.fV&&this.Sui(ma,hb);this.qqa&&appChrome.api.updateTellMeCorrelationId("");this.e9.fV=null}Zmf(ma,hb,vb){const {TellMeActor:Va}=a(702),db=this.MJ(u.a.Fwa);db[ba.a.culture]=this.tHc;db[ba.a.appName]=this.fRb;db[ba.a.context]=ma;db[ba.a.pic]=this.tqa;db[ba.a.Vni]=this.ctg;db[ba.a.$mi]=vb;db[ba.a.gji]=hb;db[ba.a.contentType]=Va.instance.C5b;this.nJ.j7(u.a.Fwa,db,this.h5d);this.qqa&&appChrome.api.updateTellMeCorrelationId(this.e9.fV)}Sui(ma,hb){const vb=this.MJ(u.a.fMa);
vb[ba.a.Jjh]=ma;vb[ba.a.fji]=hb;this.nJ.rna(u.a.fMa,vb)}iwi(ma,hb,vb){let Va=0;!vb&&0<ma.length&&(Va=ma.trim().split(" ").length);const db=this.MJ(u.a.query);db[ba.a.query]="!";db[ba.a.kQa]=hb;db[ba.a.DLf]=ma.length;db[ba.a.Ejf]=vb;db[ba.a.NXj]=Va;this.nJ.j7(u.a.query,db,this.aM)}Bvi(ma,hb,vb,Va,db,oa,Oa){const Wa=this.MJ(u.a.latency);Wa[ba.a.culture]=this.tHc;Wa[ba.a.DLf]=ma;Wa[ba.a.scg]=hb;Wa[ba.a.statusCode]=vb;Wa[ba.a.oO]=db;Wa[ba.a.isSuccess]=oa;Wa[ba.a.eri]=Oa;this.nJ.rna(u.a.latency,Wa,Va)}hvd(ma,
hb,vb,Va){const db=this.MJ(u.a.performance);db[ba.a.culture]=this.tHc;db[ba.a.kPg]=H[ma];db[ba.a.Qlh]=H[hb];db[ba.a.XXi]=R[vb];this.nJ.rna(u.a.performance,db,Va)}twi(ma,hb){var {TellMeActor:vb}=a(702);const {CommandResultsUtility:Va}=a(756);if(ma.results.length){var db=this.MJ(u.a.aTf);db[ba.a.iLa]=hb.toString();db[ba.a.groupType]=A.a[ma.groupType];16===ma.groupType&&(db[ba.a.Lmi]=vb.instance.FPb);hb=[];vb=[];var oa=[];for(const Oa of ma.results)db[ba.a.resultType]||(db[ba.a.resultType]=w[Oa.type]),
ma={},25===Oa.type&&(ma.AssetId=Oa.s_b),vb.push(Va.Qwa(Oa.value)),hb.push(Oa.value),oa.push(new ia(Oa.value,Va.Qwa(Oa.value),Oa.type,Oa.x8f,ma));0<hb.length&&(db[ba.a.Nhj]="{"+hb.join(", ")+"}",db[ba.a.Dlh]="{"+vb.join(", ")+"}",db[ba.a.Ghj]=W.c(oa));this.nJ.j7(u.a.aTf,db,this.aM)}}YHh(ma,hb){if(4===ma)return ca.dCi;switch(hb){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return w[hb]}Aui(ma,hb,vb,Va,db){const oa=
this.MJ(u.a.click);oa[ba.a.scg]=ma;oa[ba.a.FWi]=hb;oa[ba.a.commandId]=vb;oa[ba.a.OP]=Va;oa[ba.a.actionType]=this.YHh(db.groupType,db.resultType);oa[ba.a.resultType]=w[db.resultType];oa[ba.a.FVd]=ua[db.FVd];oa[ba.a.groupType]=A.a[db.groupType];oa[ba.a.iLa]=db.iLa.toString();oa[ba.a.j7c]=db.j7c.toString();oa[ba.a.resultIndex]=db.resultIndex.toString();this.nJ.j7(u.a.click,oa,this.aM)}Dui(ma,hb){this.e9.fV||(this.e9.fV=ab.a.create().toString(),this.Zmf("",!1,hb));hb=this.MJ(u.a.fDe);hb[ba.a.kQa]=ma;
this.nJ.rna(u.a.fDe,hb)}pnf(ma,hb,vb){if(ma){if(vb)for(let Va in vb)ma[Va]=vb[Va];this.nJ.rna(u.a.events,ma,hb)}}Wui(ma,hb,vb=null){const Va=this.MJ(u.a.events);Va[ba.a.event]=ma;this.pnf(Va,Math.round(hb),vb)}Rud(ma,hb,vb=null){const Va=this.MJ(u.a.events);Va[ba.a.event]=u.a.error;Va[ba.a.module]=ma;Va[ba.a.errorMessage]=hb;Va[ba.a.message]=hb;this.pnf(Va,Math.round(window.performance.now()),vb)}xui(ma){const hb=this.MJ(u.a.ABe);hb[ba.a.value]=ma;hb[ba.a.Trc]=this.qqa;this.nJ.j7(u.a.ABe,hb,this.aM)}Xti(ma){const hb=
this.MJ(u.a.jle);hb[ba.a.value]=ma;hb[ba.a.Trc]=this.qqa;this.nJ.j7(u.a.jle,hb,this.aM)}dvi(ma){const hb=this.MJ(u.a.PTe);hb[ba.a.value]=ma;hb[ba.a.Trc]=this.qqa;this.nJ.j7(u.a.PTe,hb,this.aM)}hwi(ma){const hb=this.MJ(u.a.tLf);hb[ba.a.value]=ma;hb[ba.a.Trc]=this.qqa;this.nJ.j7(u.a.tLf,hb,this.aM)}gui(ma){const hb=this.MJ(u.a.xZf);hb[ba.a.value]=ma;this.nJ.j7(u.a.xZf,hb,this.aM)}kwi(ma,hb){const vb=this.MJ(u.a.CLf);vb[ba.a.Vab]=ma;hb&&(vb[ba.a.fV]=hb);this.nJ.rna(u.a.CLf,vb)}MJ(ma){return{["SessionID"]:this.e9.sessionId,
["CorrelationID"]:this.e9.fV,["Time"]:(new Date).getTime(),["Event"]:ma,["Scenario"]:this.aM}}}Object(n.a)(Ua,"UsageLogger",null,[479]);var nb=a(94),Ha=a(1027),sb=a(686),Qb=a(107),mb=a(88);a(834);a(373);var Pb=a(27),gc=a(558),Xb=a(106),Ca=a(25);a.d(C,"TellMeActor",function(){return ra});class ra{constructor(){this.Pfa=this.PG=this.Zb=this.nb=this.yS=this.ZO=this.he=this.La=this.tc=this.Qu=this.HNc=this.Uke=this.IX=this.Wa=null;this.PWa=!1;this.WGc=[];this.d5d=[];this.Mce=[];this.Nce=[];this.dae=!1;
this.EVa=this.sFa=null;this.rjb=this.tqa=!1;this.dug=!0;this.tE=this.DTb=this.x8d=this.Gce=null;this.YO=[];this.Hpa=this.PVa=this.p1=null;this.EWa=!1;this.NNc=0;this.uVa=null;this.HX=-1;this.qce=0;this.vjb=!1;this.Wpa=null;this.fke=!1;this.sE=null}get C5b(){return this.yS?this.yS.contentType:ra.unknown}get actions(){return this.YO}set actions(ma){this.YO=ma}wcc(){return this.tc?this.tc.pbb.fV:null}Wx(){return this.Wa}get rBi(){return this.dug}get fXj(){return this.Gce}performance(){return this.Qu}get FPb(){return this.fke}set FPb(ma){this.fke=
ma}TBa(ma){const hb=window.performance.now();this.sFa&&!X.c(ma)&&(this.sFa(ma),this.tc.GN(u.a.TBa,window.performance.now()-hb))}initialize(ma,hb=null,vb=null,Va=null,db=null,oa=null,Oa=null,Wa=null,Sa=null,yb=null,Ma=null){const {InteractionLogger:Bb}=a(1347),{GroupsPlacementInfo:Nb}=a(1345),{AggregatorResultsProvider:Ia}=a(1133);this.Wa=ma;this.tqa=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.rrd;this.tc=Va;if(!Va){Va=new m;Va.sessionId=y.AFrameworkApplication.userSessionId;const jb=
gc.a.fK(y.AFrameworkApplication.lcid)||gc.a.Idi;this.tc=new Bb(new Ua(this.Wa.application,jb.name,Va,this.Wa.Ri,this.tqa,ma.tellMeInSharedHeaderIsEnabled,null),this.Wa.L3g,this.Wa)}this.Pfa=new z(this.Wa.parameterData);this.Uke=vb||new ja(this.Wa,this.Pfa);this.sFa=Oa;this.HNc=this.HNc||new L(this.Wa,this.Wa.parameterData,Oa);this.Zb=nb.FocusManager.instance();this.PG=B.createInstance(this.Wa);this.x8d=new Nb(ma);this.La=db||y.AFrameworkApplication.vb;this.he=oa||y.AFrameworkApplication.Hi;this.ZO=
Sa;this.IX=hb;this.sE=Ma;this.Qu=new Q;Sa?Sa.execute(jb=>{jb.isFeatureEnabled(ra.sIj,!0).then(Ob=>{const {AggregatorResultsProvider:Jb}=a(1133);this.vjb=Ob;this.IX=this.IX||Jb.createInstance(this.PG,this.Wa,this.Pfa,this.vjb);return null})}):(this.vjb=!0,this.IX=this.IX||Ia.createInstance(this.PG,this.Wa,this.Pfa,this.vjb));this.nb=Wa;this.p1=ja.V7b;this.Gce=new Promise(()=>{});yb&&yb.execute(jb=>{this.yS=jb});this.Wa.Ri&&v.a.Whf()&&(ma=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.Wa.application),
appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(ma,ma)))}Ig(){this.zEg()}zEg(){this.La.Le(Ca.a.tellMe,Xb.a.frame,Object(c.a)(this,this.tellMe,"tellMe"),96);this.La.Le(Ca.a.tellMeCacheAsyncMenuRefresh,Xb.a.frame,Object(c.a)(this,this.oUg,"cacheAsyncMenuRefreshFunction"),96);this.La.Le(Ca.a.tellMeLogCommandExecuted,Xb.a.frame,Object(c.a)(this,this.yvi,"logItemExecuted"),96);this.La.Le(Ca.a.tellMeLogMenuClose,Xb.a.frame,Object(c.a)(this,this.Eui,"logControlDeactivation"),96);this.La.Le(Ca.a.tellMeLogInputFocus,
Xb.a.frame,Object(c.a)(this,this.uvi,"logInputFocus"),96);this.La.Le(Ca.a.tellMeInteractionBegin,Xb.a.frame,Object(c.a)(this,this.Fwa,"interactionBegin"),96);this.La.Le(Ca.a.tellMeRestoreFocus,Xb.a.frame,Object(c.a)(this,this.Fwa,"interactionBegin"),96);this.La.Le(Ca.a.tellMeLogInputBlur,Xb.a.frame,Object(c.a)(this,this.tvi,"logInputBlur"),96);this.La.Le(Ca.a.tellMeLogMenuOpen,Xb.a.frame,Object(c.a)(this,this.Cui,"logControlActivated"),96);this.La.Le(Ca.a.tellMeFocusInput,Xb.a.frame,Object(c.a)(this,
this.zDh,"focusSearchBox"),96);this.La.Le(Ca.a.tellMeAccessibilityMenuText,Xb.a.frame,Object(c.a)(this,this.L2g,"constructLiveNotificationForMenu"),96);this.La.Le(Ca.a.tellMeTryQuery,Xb.a.frame,Object(c.a)(this,this.Cbf,"insertTryQuery"),96);this.La.Le(Ca.a.asi,Xb.a.frame,Object(c.a)(this,this.Cbf,"insertTryQuery"),96);this.La.Le(Ca.a.kAh,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.lAh,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.mAh,
Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.nAh,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.oAh,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.MUi,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.NUi,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.OUi,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.OXi,Xb.a.frame,Object(c.a)(this,
this.jfc,"insertMention"),96);this.La.Le(Ca.a.PXi,Xb.a.frame,Object(c.a)(this,this.jfc,"insertMention"),96);this.La.Le(Ca.a.QXi,Xb.a.frame,Object(c.a)(this,this.jfc,"insertMention"),96);this.La.Le(Ca.a.tellMeFeedback,Xb.a.frame,Object(c.a)(this,this.openFeedback,"openFeedback"),96);this.La.Le(Ca.a.uIj,Xb.a.frame,Object(c.a)(this,this.nma,"openOrInsertUrl"),96);this.La.Le(Ca.a.kJg,Xb.a.frame,Object(c.a)(this,this.Itd,"launchAddin"),96);this.La.Le(Ca.a.lJg,Xb.a.frame,Object(c.a)(this,this.Itd,"launchAddin"),
96);this.La.Le(Ca.a.mJg,Xb.a.frame,Object(c.a)(this,this.Itd,"launchAddin"),96);this.La.Le(Ca.a.Cyc,Xb.a.frame,Object(c.a)(this,this.Cyc,"showTellMeCoachmark"),96);this.La.Le(Ca.a.iri,Xb.a.frame,Object(c.a)(this,this.jri,"launchAddinStore"),96)}zDh(ma,hb,vb){if(1===vb)return 32;this.z1f();ma=!1;(this.Wa.tellMeInSharedHeaderIsEnabled||this.tqa)&&(hb=document.getElementById("SearchButton"))&&hb.click();if(!this.Wa.tellMeInSharedHeaderIsEnabled&&this.tqa)for(hb=document.getElementsByClassName("ms-suiteux-search-box"),
vb=0;vb<hb.length;vb++){const Va=hb[vb].querySelector("input[type=search]");Va&&(ma=nb.FocusManager.Boa(Va))}else ma=nb.FocusManager.Boa($get(this.Wa.Ri?e.CuiHelper.XTd:e.CuiHelper.rAc));this.rjb=!0;return ma?32:8}Cbf(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.z1f();ma=db.CommandValueId;hb=this.Wa.Ri?e.CuiHelper.XTd:e.CuiHelper.rAc;this.Wa.Ri&&!X.c(db[sb.a.UAa])&&(db[sb.a.UAa]=!1);if(ma){if(this.Wa.Ri)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ma)),
this.Wpa=[19],32;if(db=$get(hb))db.value=ma}return nb.FocusManager.Boa($get(hb))?32:8}z1f(){this.Zb.AR(this.Wa.tellMeInSharedHeaderIsEnabled||this.tqa?this.Wa.Yjd:this.Wa.sRa,!1)}UHh(ma,hb){switch(ma){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,hb);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,hb);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,hb);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
hb)}return hb}L2g(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;ma=this.p1?this.p1.lVf:0;db.Value=1!==ma?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,ma):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.p1)for(const oa of this.p1.Bhh)db=Object(b.a)(F.a,oa)?oa.id:P.a.replaceAll(oa.value,'"',""),(db=$get(db+"-"+v.a.IWd))&&mb.a.wh(db,mb.a.Xt,P.a.nf(this.UHh(oa.groupType,
db.innerText)));return 32}oUg(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.uVa=new Qb.a(2,1,0,()=>{db[Ha.a.Callback]()},97);this.p1&&this.he.Fg(this.uVa);return 32}yvi(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;db.CloseAllMenus&&(ma=void 0===db.ParentControlId||null===db.ParentControlId?"<NA>":db.ParentControlId,
hb=this.EVa?this.EVa[db.ControlId]:null,!hb&&this.EVa&&"<NA>"!==ma&&(hb=this.EVa[ma]),hb||(hb=this.PWa&&this.PG.zgi(db),hb=this.Ifh(hb,db.ControlId),hb=new k(hb,28,4,-1,-1,-1),this.tc.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+db.ControlId+" determined group:"+A.a[hb.groupType])),this.tc.cIi(db.ControlId,ma,db.CommandId,db.CloseAllMenus,hb),this.Pfa.pEi(db.ControlId),db.Location!==ta.a.contextMenu&&(this.PG.l2(db),this.PG.Tu(hb.resultType),this.Wa.$xc&&this.IX.ZCg(db.CommandId)));
return 32}Eui(ma,hb,vb,Va,db){if(1===vb)return 32;r.a.Wni()&&(new da(this.wcc())).AVh(this.PVa);ma=this.PVa;hb=this.HX;vb=this.tc.fSb;if(X.c(db))return this.tc.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;db=db.UILocation;ma&&0<ma.length&&this.vjb&&v.a.fSd(this.Wa)&&this.Wa.zic&&19!==db&&hb>vb&&!this.Wa.Hy&&(this.tc.lvd(ma),this.tc.FPd(hb));this.tc.ngj();this.Wa.YCc&&19!==db&&(this.Qu.mark(3),this.Qu.measure(1,0,3),this.Qu.measure(2,2,3),this.Qu.Yud(0,1,2),this.Qu.Yud(2,
2,3),this.Qu.Yud(1,0,3),this.Qu.oZg(),this.Qu.clearMeasures([0,2,1]));this.tc.yIi(window.performance.now()-this.NNc);this.Wa.Ri&&(this.Hpa=null,this.tc.dma());this.rjb=this.EWa=!1;this.PVa="";return 32}uvi(ma,hb,vb){if(1===vb)return 32;this.tc.Uya(l(hb),this.rjb);return 32}tvi(ma,hb,vb){if(1===vb)return 32;this.tc.dma();this.EWa=!1;return 32}Cui(ma,hb,vb,Va,db){if(1===vb)return 32;this.tE=null;db&&(this.tE=db);this.Wa.YCc&&(X.c(this.tE)||this.tE.Location!==ta.a.contextMenu)&&this.Qu.mark(0);this.tc.bxc(X.c(this.tE)||
X.c(this.tE.Location)?ta.a.unknown:this.tE.Location);this.tc.xIi(this.qce,this.rjb);this.EWa||this.ema();return 32}MEe(ma,hb){const vb=[],Va=Date.now();for(let db of ma)ma=(Va-db.timeStamp)/1E3,ma=v.a.BYd(ma),Array.add(vb,new U(hb?db.commandId:db.controlId,ma));return vb}qFe(ma=!1){var hb=ma?this.PG.yVh():this.PG.rKa();ma=[];const vb=Date.now();for(const Va of hb)hb=(vb-Va.TimeStamp)/1E3,hb=v.a.BYd(hb),Array.add(ma,new U(Va.Id,hb));return ma}ema(){if(!this.EWa){this.PWa=this.EWa=!0;""!==this.Wa.mYf&&
y.AFrameworkApplication.Yxa(this.Wa.mYf);if(!this.dae){this.dae=!0;const ma={};ma.IsMLREnabled=this.Wa.hki;ma.IsReactRibbonEnabled=this.Wa.Ri;ma.IsSharedHeaderEnabled=!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.ps;ma.IsSearchUxEnabled=this.tqa;ma.IsTellMeInHeaderEnabled=this.Wa.tellMeInSharedHeaderIsEnabled;ma.IsGoLocalEnv=v.a.aff();ma.IsSovereignEnvironment=v.a.lNa();ma.IsTellMeServiceResultsEnabled=v.a.fSd(this.Wa);ma.IsSubstrateProviderEnabled=v.a.eSd(this.Wa);ma.ShouldFetchTokens=
!!y.AFrameworkApplication.ta&&y.AFrameworkApplication.ta.Oa.GSa;ma.IsSerpletEnabled=v.a.k5();ma.FirstOnClickTimeInMS=Math.round(window.performance.now());ma.IsHeaderHidden=y.AFrameworkApplication.hideHeader||y.AFrameworkApplication.hideHeaderEmbedded;ma.IsSearchInHeaderHidden=y.AFrameworkApplication.hideSearchInHeaderByUiHost;void 0!==window.performance.timing&&null!==window.performance.timing&&(ma.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));ma.IsFindWithMatchesEnabled=
this.Wa.fUe;ma.HelpShowsTopSearchResult=this.Wa.lMb;ma.HelpShowsNumberOfMatches=this.Wa.kMb;y.AFrameworkApplication.fa&&(ma.UiHost=y.AFrameworkApplication.fa.Xa("UiHostIntegrationType"));this.tc.Ewi(JSON.stringify(ma))}this.WGc=this.MEe(f.a.instance.yhb,!1);this.d5d=this.MEe(f.a.instance.DVa,!0);this.Mce=this.qFe();this.Nce=this.qFe(!0);this.tc.ema()}}Fwa(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Pb.a.Lff)return 32;
this.NNc=window.performance.now();this.ema();ma=new T(Object(c.a)(this,this.D_,"onRequestCompleted"),0);this.HX++;this.tc.beginQuery("",this.HX,this.PWa);this.p1=ja.V7b;this.Hpa=L.x8c;if(this.IX)ra.instance.actions=[],this.IX.wv(new I("",this.HX),ma,this.Wa.Ri);else this.tc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.uVa&&this.he.Fg(this.uVa);return 32}tellMe(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:TellMe","actiondata comes null"),
16;this.tE=db;this.tc.bxc(X.c(this.tE.Location)?ta.a.unknown:this.tE.Location);ma=this.tE.Value;this.Wa.Ri||ma&&""!==ma.trim()?(!this.Hpa&&this.Wa.Ri&&(this.tc.Uya(l(hb),this.rjb),this.ema()),this.jyh(ma,this.tE.Location),this.tE.PopulationXML=this.p1.xml):this.PWa?this.tE.PopulationXML=this.p1.xml:(this.tE.PopulationXML=ja.V7b.xml,this.Hpa=L.x8c,this.PVa="");return 32}jyh(ma,hb){this.NNc=window.performance.now();this.Wa.YCc&&hb!==ta.a.contextMenu&&this.Qu.mark(1);this.Wa.Ri&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(ma));
ma&&0<ma.trim().length&&(this.PWa=!1);this.Wa.Wmh();hb=X.c(hb)?ta.a.tellMe:hb;if(ma!==this.PVa||this.Wa.Ri){this.HX++;this.tc.beginQuery(ma,this.HX,this.PWa);const vb=new I(ma,this.HX),Va=new T(Object(c.a)(this,this.D_,"onRequestCompleted"),this.HX);this.p1=ja.V7b;this.Hpa=L.x8c;if(this.IX)ra.instance.actions=[],this.IX.wv(vb,Va,this.Wa.Ri,hb,this.Wpa),this.Wpa=null;else this.tc.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.qce=this.HX;this.PVa=ma}}oSj(ma){if(this.Wa.Ri){var hb=
appChrome.selectors.getActiveControlStates();if(hb=Object(d.a)(Object,hb[ma.value])){ma.label=hb.label;let vb=null;"description"in hb&&(vb=hb.description);vb&&Object.getType(vb)===String?ma.description=vb:"secondaryText"in hb?ma.description=hb.secondaryText:"fullDescriptionLabel"in hb&&(ma.description=hb.fullDescriptionLabel)}}}gZi(ma){this.EVa={};let hb=0,vb=0;for(const Va of ma){ma=0;for(const db of Va.results)this.EVa[db.value]=new k(db.groupType,db.type,db.x8f,hb,ma,vb),ma++,vb++,db.label||5!==
db.type||this.oSj(db);0<ma&&hb++}}openUrlInNewTab(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(ma=db.CommandValueId)&&window.open(ma,"_blank");return 32}jfc(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:InsertMention","actiondata comes null"),16;ma=db.UILocation;let oa;db=db.CommandValueId;try{oa=W.a(db)}catch(Oa){return this.tc.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),
16}return X.c(oa)?(this.tc.onError("TellMeActor:InsertMention","insertMentionParameters comes null"),16):X.c(this.DTb)?(this.tc.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==ma?(this.tc.onError("TellMeActor:InsertMention","location "+ma+" is unexpected"),16):this.DTb.jfc(oa.displayName,oa.email,oa.userId)?32:(this.tc.onError("TellMeActor:InsertMention","mention is not inserted"),16)}nma(ma,hb,vb,Va,db){return 1===vb?32:X.c(db)?(this.tc.onError("TellMeActor:OpenOrInsertUrl",
"actiondata comes null"),16):19===db.UILocation?this.Dci(vb,db):this.openUrlInNewTab(ma,hb,vb,Va,db)}openFeedback(ma,hb,vb,Va,db){if(1===vb)return 32;if(X.c(db))return this.tc.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.sE&&this.sE.execute(oa=>{oa.PMb("TellMeSurvey",null)});return 32}Dci(ma,hb){if(1===ma)return 32;if(X.c(hb))return this.tc.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(X.c(this.DTb))return this.tc.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),
16;ma=hb.CommandValueId;return X.c(ma)?(this.tc.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.DTb.insertHtmlText(ma)?32:(this.tc.onError("TellMeActor:InsertUrl","url is not inserted"),16)}D_(ma,hb,vb,Va,db){vb=window.performance.now();this.gZi(hb);this.tc.srj(hb);this.Wa.Ri?(this.Hpa=this.HNc.wHh(hb,ma,db),this.Wa.q4?(this.YO.push(appChrome.actions.updateTellMeSearchResults(this.Hpa.menuModel,ma,db)),appChrome.api.dispatch(this.YO)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.Hpa.menuModel,
ma,db)),this.Wa.YCc&&this.EWa&&(X.c(this.tE)||this.tE.Location!==ta.a.contextMenu)&&(this.Qu.mark(2),this.Qu.measure(0,1,2))):this.p1=this.Uke.xHh(hb,this.tc.pbb);this.uVa&&this.he.Fg(this.uVa);db={};db.GroupsCount=hb.length;db.QueryID=Va;db.QueryLength=ma.length;this.tc.GN(u.a.M$g,window.performance.now()-vb,db)}Ifh(ma,hb){return hb.startsWith(this.Wa.Ri?v.a.PYd:v.a.qBc)?5:ma?4:"bSearchHelp"===hb||hb.startsWith("GetHelpFromTellMe")?8:"bInsights"===hb||hb.startsWith("SmartLookupFromTellMe")?13:hb===
this.Wa.eUe?2:0}Tu(ma,hb){this.IX&&this.IX.Tu(ma,hb)}jri(ma,hb,vb,Va,db){return this.La.de(Ca.a.kri,2,db)}Itd(ma,hb,vb,Va,db){({AddinResultsProvider:ma}=a(943));db=db.CommandValueId;if(X.b(db))return this.tc.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!ma.iGa[db])return this.tc.onError("TellMeActor:LaunchAddin","Add-in with assetId "+db+" doesn't not exist in entitlements"),16;ma=a(943).AddinResultsProvider.iGa[db];hb={};hb.solutionId=ma.id;hb.version=ma.appVersion;hb.storeType=
ma.storeType;hb.storeId=ma.storeId;hb.assetId=ma.assetId;hb.assetStoreId=ma.assetStoreId;hb.displayName=ma.displayName;hb.targetType=ma.targetType;hb.height=ma.height;hb.width=ma.width;ma=this.La.de(Ca.a.xbf,2,hb);if(32!==ma)this.tc.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+ma+". AssetId: "+db);return ma}Cyc(){if(!X.c(this.sE))for(let ma of f.a.instance.DVa){if("ShowContextMenuWithFloatie"===ma.commandId)return this.sE.execute(hb=>{hb.logActivity("TellMe1TabSwitchCoachMarkActivity",
null)}),32;if(ma.commandId&&-1===ma.commandId.indexOf("Tab"))break}return 8}static get instance(){return ra.Ma||(ra.Ma=new ra)}}ra.Ma=null;ra.sIj="mso_tellMeService";ra.unknown="Unknown";Object(n.a)(ra,"TellMeActor",null,[])},704:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(718);class b{constructor(d,f){this.rqa=!1;const {Annotations:e}=a(697);if(!d)throw Error.argumentNull("annotations");if(!d.nsd(f))throw Error.argument("memberTypeID","Invalid type ID");if(e.Lt(f))throw Error.argument("memberTypeID",
"Lists of lists are not permitted");this.Wl=d;this.Xtg=f;this.uq=[]}get LZa(){return this.Wl}get isReadOnly(){return this.rqa}get hI(){return this.Xtg}get items(){return this.uq}PO(){const {Annotations:d}=a(697);let f="[";for(let e=0,k=this.items.length;e<k;++e){0<e&&(f+=", ");const l=this.Wl.PO(this.hI,this.items[e]);this.hI===d.EL?(f+='"',f+=c.a.w9c(l),f+='"'):f+=l}return f+"]"}isEqual(d){const {Annotations:f}=a(697);if(this===d)return!0;if(!d||d.LZa!==this.Wl||d.hI!==this.hI||d.items.length!==
this.items.length)return!1;for(let e=0;e<this.items.length;++e)if(!f.iCa(this.hI,this.items[e],d.items[e]))return!1;return!0}clone(){const d=new b(this.Wl,this.hI);Array.addRange(d.items,this.items);return d}XA(){return this.isReadOnly?this.clone():this}Fud(){const {Annotations:d}=a(697);if(!this.isReadOnly){this.rqa=!0;for(const f of this.items)d.dOa(f)}}toString(){return this.PO()}}Object(n.a)(b,"ListValue",null,[632,634])},706:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.tellMe=
"TellMe";c.contextMenu="ContextMenu";c.unknown="Unknown";Object(n.a)(c,"TellMeScenario",null,[])},709:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b,d,f=null,e=null,k=4,l=-99999,m=0){this.s_b="";this.B_b=-1;this.value=b;this.type=d;this.x8f=k;this.label=this.Qz=f;this.groupType=27;this.description=e;this.score=l;this.count=m}}Object(n.a)(c,"ResultBinding",null,[])},710:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b){this.attributes=null;
this.query=b;this.vh=[]}Km(b){this.vh.push(b)}UQf(b){const d=[];for(const f of this.vh)f.groupType!==b&&d.push(f);this.vh.length!==d.length&&(this.vh=d)}get o7a(){return!1}}Object(n.a)(c,"SimpleResultsUpdatedEventArgs",null,[467])},711:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b=27,d=""){this.zwg=[];this.groupType=b;this.displayName=d}get results(){return this.zwg}Qn(b){b.groupType=this.groupType;Array.add(this.results,b)}XJd(b=1){if(this.results.length>=b)for(let d=
0;d<b;d++)Array.removeAt(this.results,this.results.length-1)}}Object(n.a)(c,"SimpleResultGroup",null,[466])},718:function(n,C,a){n=a(0);class c{constructor(d,f){this.qsa=d;this.value=f}}Object(n.a)(c,"AttrValuePair",null,[]);a.d(C,"a",function(){return b});class b{constructor(d){this.rqa=!1;if(!d)throw Error.argumentNull("annotations");this.Wl=d;this.pD=[]}get LZa(){return this.Wl}get isReadOnly(){return this.rqa}get ujd(){return 0<this.pD.length}Vi(d){if(!this.Wl.Q7a(d))throw Error.argument("attributeID",
"Invalid attribute ID");for(const f of this.pD)if(d===f.qsa)return d=f.value,{returnValue:!0,value:d};return{returnValue:!1,value:null}}Hn(d,f){var {Annotations:e}=a(697);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.Wl.Q7a(d))throw Error.argument("attributeID","Invalid attribute ID");if(!this.Wl.T6a(this.Wl.getAttributeType(d),f))throw Error.argument("value","Value is not of the correct type for the specified attribute");e.dOa(f);
for(e=0;e<this.pD.length;++e){const k=this.pD[e];if(d===k.qsa){k.value=f;return}}Array.add(this.pD,new c(d,f))}Isc(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.Wl.Q7a(d))throw Error.argument("attributeID","Invalid attribute ID");for(let f=0;f<this.pD.length;++f)if(d===this.pD[f].qsa){Array.removeAt(this.pD,f);break}}B$b(d){if(!d)throw Error.argumentNull("action");for(const f of this.pD)d(f.qsa,f.value)}clone(){const d=new b(this.Wl);
d.Vha(this);return d}Vha(d){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!d)throw Error.argumentNull("other");if(d.LZa!==this.Wl)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.pD);d.B$b((f,e)=>{this.Hn(f,e)})}PO(){const {Annotations:d}=a(697);let f="[",e=!0;for(const k of this.pD){e?e=!1:f+=", ";f+=this.Wl.KXe(k.qsa);f+="=";const l=this.Wl.getAttributeType(k.qsa),m=this.Wl.PO(l,k.value);l===d.EL?(f+='"',
f+=b.w9c(m),f+='"'):f+=m}return f+"]"}isEqual(d){const {Annotations:f}=a(697);if(!d)throw Error.argumentNull("other");if(this===d)return!0;if(!d||this.Wl!==d.LZa||this.ujd!==d.ujd)return!1;let e=0,k=null,l=!1;d.B$b((m,u)=>{++e;if(!l){var t=-1;for(let w=0,r=this.pD.length;w<r;++w)if(this.pD[w].qsa===m){t=w;break}0>t?l=!0:(k||(k=Array(this.pD.length)),k[t]=u)}});if(this.pD.length!==e||l)return!1;for(let m=0,u=this.pD.length;m<u;++m)if(!f.iCa(this.Wl.getAttributeType(this.pD[m].qsa),this.pD[m].value,
k[m]))return!1;return!0}XA(){return this.isReadOnly?this.clone():this}Fud(){const {Annotations:d}=a(697);if(!this.isReadOnly){this.rqa=!0;for(const f of this.pD)d.dOa(f.value)}}toString(){return this.PO()}static w9c(d){return d.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(n.a)(b,"FeatureBundle",null,[631,634])},729:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.click="Click";c.Fwa="InteractionBegin";c.fMa="InteractionEnd";c.fDe="ControlActivated";
c.query="Query";c.CLf="QueryIndexRecorded";c.ABe="Clicks";c.jle="ActionEvents";c.PTe="FilteredActionEvents";c.xZf="SessionContext";c.latency="Latency";c.performance="Performance";c.aTf="RenderedResults";c.events="Events";c.M$g="CreateResultsMenu";c.TBa="UpdateRibbonControls";c.Mhj="ResultsAggregation";c.wv="IssueQuery";c.u0g="CommandSuggestions";c.error="Error";c.tud="LoadModelData";c.sBi="ModelDataWaitTime";c.timedOut="TimedOut";c.iJg="AddinQueryCommandReady";c.kIh="GetAddinEntitlements";c.tLf="ProviderMRUEvents";
Object(n.a)(c,"EventNames",null,[])},734:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.owd=null;this.wN=this.twd=0}Bcd(b,d,f){if(!b)throw Error.argumentNull("referenceList");if(0>d||d>b.length)throw Error.argumentOutOfRange("startIndex");if(0>f||f>b.length)throw Error.argumentOutOfRange("length");if(d+f>b.length)throw Error.argument("Invalid start-length range");this.owd=b;this.twd=d;this.wN=f}bva(b,d,f){this.Bcd(b.owd,b.twd+d,f)}na(b){if(0>b||b>=this.wN)throw Error.argumentOutOfRange("index");
return this.owd[this.twd+b]}get count(){return this.wN}static H4c(b){const d=new c;d.Bcd(b,0,b.length);return d}}Object(n.a)(c,"ReadOnlyList",null,[585])},743:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);var c;(function(b){b[b.Classifier=0]="Classifier";b[b.AppsForOffice=1]="AppsForOffice";b[b.FindInDocument=2]="FindInDocument";b[b.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";b[b.RecentlyUsed=4]="RecentlyUsed";b[b.TryQuery=5]="TryQuery";b[b.Empty=6]="Empty";b[b.TryCommand=
7]="TryCommand";b[b.Assistance=8]="Assistance";b[b.Answer=9]="Answer";b[b.Definition=10]="Definition";b[b.Entity=11]="Entity";b[b.WolframAnswer=12]="WolframAnswer";b[b.Insights=13]="Insights";b[b.People=14]="People";b[b.Document=15]="Document";b[b.Recommended=16]="Recommended";b[b.ServiceClassifier=17]="ServiceClassifier";b[b.ServiceRecommended=18]="ServiceRecommended";b[b.Image=19]="Image";b[b.Notes=20]="Notes";b[b.Learning=21]="Learning";b[b.Feedback=22]="Feedback";b[b.Template=23]="Template";b[b.Addin=
24]="Addin";b[b.OfficeScript=25]="OfficeScript";b[b.AddinStoreEntry=26]="AddinStoreEntry";b[b.None=27]="None";b[b.MergedActions=28]="MergedActions";b[b.MergedScopedSearches=29]="MergedScopedSearches";b[b.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(c||(c={}));Object(n.b)("ResultGroupType",c)},756:function(n,C,a){a.r(C);a.d(C,"CommandResultsUtility",function(){return u});n=a(0);var c=a(776),b=a(729),d=a(777),f=a(709),e=a(711),k=a(702),l=a(701),m=a(4);class u{static Vdg(t,w){if(w&&w.Ri){const r=
{};for(const v of t)w.Lic(v)&&(r[v]=appChrome.selectors.getModelType(v));k.TellMeActor.instance.TBa(r)}}static BIj(t){return t.startsWith("btnTellMeOfficeAddIn")}static Qwa(t){const w=k.TellMeActor.instance.Wx();return!!w&&w.Ri&&!appChrome.selectors.isControlDisabled(t)}static rkc(t,w,r,v){if(k.TellMeActor.instance.tc&&t){const y=[];for(const x of t)y.push(String.format('{{"Id":"{0}","Score":{1}}}',x.commandId,x.score));t={};t[c.a.suggestions]="[{"+y.join(",")+"}]";t[c.a.Ejf]=w;t[c.a.groupType]=r;
t[c.a.provider]=v;k.TellMeActor.instance.tc.GN(b.a.u0g,window.performance.now(),t)}}static nMh(t,w){const r=[],v=[];for(const y of w){w=y.commandId;let x=y;y.commandId in t&&(w=t[y.commandId],x=new d.a(w,y.score));Array.contains(v,w)||(r.push(x),v.push(w))}return r}static ccc(t,w,r,v,y,x,B,z){r.XYe&&(w=u.nMh(r.XYe,w));var A=l.a.CLh(w);u.Vdg(A,r);var I=[],F=[];A=[];const U=new e.a(B);B=16===B||18===B||7===B||4===B?m.AFrameworkApplication.fa?m.AFrameworkApplication.fa.qd("TellMeMaxRecommendedResultsToReturn",
3):3:0===B||17===B?5:0;for(const X of w)if(!u.ygi(X.commandId)){w=u.BIj(X.commandId);if(r.Lic(X.commandId)&&!w){if(l.a.Rif(X.commandId))continue;w=null;y&&x&&(w=y.pUh(X.commandId,x));u.Qwa(X.commandId)?Array.add(I,new f.a(X.commandId,5,w,null,z,X.score)):Array.add(F,new f.a(X.commandId,5,w,null,z,X.score))}else r.AGa&&w&&v&&Array.add(A,X.commandId.substr(21));if(I.length+A.length>=B)break}r=0;for(y=0;y<I.length&&r<B;y++,r++)U.Qn(I[y]);for(I=0;I<F.length&&r<B;I++,r++)U.Qn(F[I]);for(F=0;F<A.length&&
r<B;F++,r++)v.v_j(t,A[F],U);return U}static ygi(t){u.$ue||(m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.wo("TellMeControlPredictionBlockList")&&m.AFrameworkApplication.fa.ow("TellMeControlPredictionBlockList").forEach(w=>{Array.add(u.Zue,w.toLowerCase())}),u.$ue=!0);return Array.contains(u.Zue,t.toLowerCase())}static Snd(t){return 2<t.length&&";"===t.charAt(0)&&";"===t.charAt(t.length-1)&&!!m.AFrameworkApplication.fa&&(m.AFrameworkApplication.fa.qa("TellMeCommandHookIsEnabled")||m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",
!1))}static LYe(t){const w=new e.a(0);var r=t.split(";");t=k.TellMeActor.instance.Wx();for(const v of r)if(0<v.length){r=v.split(":");const y=2===r.length?r[0]:v;if(!t.Lic(y))break;if(1===r.length)r=new f.a(y,5,null,null,1),w.Qn(r);else if(2===r.length)r=new f.a(y,5,r[1],null,1),w.Qn(r);else break}return w}static ICg(t,w,r){if(!(w&&w.results&&t&&t.results&&t.results.length))return{returnValue:!1,NUc:t,eVc:w};const v=[];for(var y of w.results)Array.add(v,y.value);y=0;const x=0<w.results.length?w.results[0].score:
0;for(const B of t.results)if(B.score>r&&!Array.contains(v,B.value)&&u.Qwa(B.value)&&(0<x&&(B.score=x),Array.insert(w.results,y,B),y++),2===y)break;return 0<y?(r=w.results.length-5,0<r&&w.XJd(r),{returnValue:!0,NUc:t,eVc:w}):{returnValue:!1,NUc:t,eVc:w}}}u.$ue=!1;u.Zue=[];Object(n.a)(u,"CommandResultsUtility",null,[])},776:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.appName="AppName";c.OP="CloseAllMenus";c.commandId="CommandId";c.context="Context";c.culture="Culture";c.message=
"Message";c.errorMessage="ErrorMessage";c.event="Event";c.fV="CorrelationID";c.FWi="ParentUiElement";c.query="Input";c.kQa="QueryID";c.DLf="QueryLength";c.Vab="QueryIndex";c.Nhj="ResultsList";c.suggestions="Suggestions";c.scenario="Scenario";c.sessionId="SessionID";c.source="Source";c.timeStamp="Time";c.scg="UiElement";c.Trc="ReactUx";c.value="Val";c.statusCode="StatusCode";c.oO="Service";c.isSuccess="IsSuccess";c.eri="LatencyType";c.groupName="GroupName";c.iLa="GroupIndex";c.groupType="GroupType";
c.Ghj="ResultInfoList";c.resultType="ResultType";c.FVd="SubResultType";c.fji="IsInputBlur";c.gji="IsInputFocus";c.$mi="IsShortCutUsed";c.actionType="ActionType";c.count="Count";c.Jjh="DwellTime";c.Ejf="IsZeroTerm";c.NXj="WordsCount";c.pic="IsSearchUxEnabled";c.Vni="IsTellMeInHeaderEnabled";c.module="Module";c.resultIndex="ResultIndex";c.j7c="DisplayIndex";c.Dlh="EnableList";c.provider="Provider";c.contentType="ContentType";c.Lmi="IsSelectionBased";c.kPg="BeginPerformanceMarker";c.Qlh="EndPerformanceMarker";
c.XXi="PerformanceMeasure";Object(n.a)(c,"Columns",null,[])},777:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b,d){this.commandId=b;this.score=d}}Object(n.a)(c,"CommandSuggestion",null,[])},801:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{}c.tellMe="TellMe";c.loki="Loki";c.substrate="Substrate";c.Vab="QueryIndex";c.b$f="TellMeRanker";c.c$f="TellMeRankerLogging";Object(n.a)(c,"Services",null,[])},802:function(n,C,a){a.d(C,"a",function(){return c});n=
a(0);class c{}c.eba="HttpRequest";c.provider="Provider";Object(n.a)(c,"LatencyTypes",null,[])},844:function(n,C,a){n=a(0);class c{constructor(){this.vOb=this.Fyb=null;this.axd=this.score=this.dDb=0}XDd(r,v,y){this.score=r.na(v);++v;this.Fyb=r.na(v)?y.UU(r.na(v)):null;++v;this.vOb=r.na(v)?y.UU(r.na(v)):null;++v;this.dDb=r.na(v);++v;this.axd=r.na(v);++v;return v}}Object(n.a)(c,"TokenStringGeneratorInit",null,[]);class b{constructor(r,v,y,x,B){this.Qua=r;this.count=v;this.i$b=y;this.Nx=x;this.depth=
B}}Object(n.a)(b,"ErrorTolerantTrieMatch",null,[]);var d=a(937),f=a(1101);class e{constructor(r=null,v=0,y=0,x=0){this.mzg=r||new f.a;this.YY=v;this.Nx=y;this.depth=x}get RI(){return this.mzg}getKey(){return this.RI.Pm.toString()+":"+this.YY.toString()}}Object(n.a)(e,"TrieBookmark",null,[]);class k{constructor(r,v){this.eca=r;this.hwd=v}rxi(r){if(null==r)throw Error.argumentNull("prefix");let v={};var y=v[""]=new e;this.vec(y,v);for(y=0;y<r.length;++y){const x=r.charCodeAt(y),B={};for(let z in v)this.NJg(x,
v[z],B);v=B}return this.ULj(v)}vec(r,v){if(!(r.Nx>=this.hwd)&&(r=new e(d.a.q1c(r.RI),r.YY,r.Nx+1,r.depth),r.RI.Mr&d.a.cpa&&(r.YY+=1),this.eca.eUa(r.RI))){r.depth+=1;let y=!0;for(;y;)k.FCc(r,v),this.vec(r,v),r.YY+=this.eca.d4a(r.RI,!0)+(r.RI.Mr&d.a.cpa?1:0),y=this.eca.GOb(r.RI)}}NJg(r,v,y){v.Nx+1<=this.hwd&&(v.Nx+=1,k.FCc(v,y),--v.Nx);v.RI.Mr&d.a.cpa&&(v.YY+=1);if(this.eca.eUa(v.RI)){v.depth+=1;let x=!0;for(;x;)v.RI.QUa===r?(k.FCc(v,y),this.vec(v,y)):v.Nx+1<=this.hwd&&(v.Nx+=1,k.FCc(v,y),this.vec(v,
y),--v.Nx),v.YY+=this.eca.d4a(v.RI,!0)+(v.RI.Mr&d.a.cpa?1:0),x=this.eca.GOb(v.RI)}}ULj(r){const v=[];for(var y in r){const x=r[y];if(!x.RI.Pm)continue;const B=!!(x.RI.Mr&d.a.cpa),z=this.eca.d4a(x.RI,!1)+(B?1:0);Array.add(v,new b(x.YY,z,B,x.Nx,x.depth))}v.sort((x,B)=>{let z=x.Qua-B.Qua;return z||(z=-(x.count-B.count))?z:z=x.depth-B.depth});if(2>v.length)return v;r=[];for(y=0;y<v.length;)y+=k.Wag(y,v,r);return r}static FCc(r,v){const y=r.getKey();y in v?(v=v[y],v.Nx=Math.min(v.Nx,r.Nx)):v[y]=new e(d.a.q1c(r.RI),
r.YY,r.Nx,r.depth)}static Wag(r,v,y){const x=v[r];let B=x.Qua;const z=B+x.count;let A=1,I=x.i$b;for(;r+A<v.length&&v[r+A].Qua<z;){const F=v[r+A];F.Qua>B&&(Array.add(y,new b(B,F.Qua-B,I,x.Nx,x.depth)),I=!1);A+=k.Wag(r+A,v,y);B=F.Qua+F.count}B<z&&Array.add(y,new b(B,z-B,I,x.Nx,x.depth));return A}}Object(n.a)(k,"ErrorTolerantTrieLookupEngine",null,[702]);class l extends c{constructor(r,v,y){super();this.caf=this.gGf=!1;this.oNe=null;if(r){var x=0;try{x=this.XDd(r,x,v);this.gGf=1===r.na(x);++x;this.caf=
1===r.na(x);++x;const B=r.na(x);this.oNe=this.OWi(y,B)}catch(B){throw Error.argument("initData");}}}OWi(r,v){return new k(r,v)}}Object(n.a)(l,"FuzzyMatchTokenStringGeneratorInit",c,[]);class m extends c{constructor(r,v){super();this.query=this.name=null;if(r){this.annotations=v.annotations;var y=0;try{y=this.XDd(r,y,v),this.name=v.ga(r.na(y)),++y,this.query=v.kv(r.na(y))}catch(x){throw Error.argument("initData");}}}}Object(n.a)(m,"QueryTokenStringGeneratorInit",c,[]);class u extends c{constructor(r,
v){super();if(r)try{this.XDd(r,0,v)}catch(y){throw Error.argument("initData");}}}Object(n.a)(u,"SurfaceStringTokenStringGeneratorInit",c,[]);var t=a(734);a.d(C,"a",function(){return w});class w{constructor(r){this.Vvd=r}get Fyb(){return this.Vvd.Fyb}get vOb(){return this.Vvd.vOb}get dDb(){return this.Vvd.dDb}static create(r,v,y){const {SurfaceStringTokenStringGenerator:x}=a(1334),{QueryTokenStringGenerator:B}=a(1335),{FuzzyMatchTokenStringGenerator:z}=a(1336);let A=0;try{if(r.na(A)!==w.TGa)throw Error.argument("initData",
"Input does not represent a token string generator");++A;const I=r.na(A);++A;const F=new t.a;F.bva(r,A,r.count-A);switch(I){case x.Apb:return new x(new u(F,v));case B.Apb:return new B(new m(F,v));case z.Apb:return new z(new l(F,v,y));default:throw Error.argument("initData");}}catch(I){throw Error.argument("initData");}}static Nne(r,v,y,x,B,z){r=r.VKj.getId(v,null);if(0>r)return++z,z;w.One(r,y,x,B);return z}static One(r,v,y,x){Array.add(x.DVd,r);Array.add(x.j8f,v);++x.Xeb[y]}}w.TGa=1099767983;Object(n.a)(w,
"TokenStringGenerator",null,[675])},914:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(){this.data=this.landingTab=null}}Object(n.a)(c,"LaunchData",null,[])},915:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(701);a=a(4);class b{static Wni(){return!c.a.aff()&&!c.a.lNa()&&b.isFeatureEnabled(0)}static yif(){return b.isFeatureEnabled(1)}static fgf(){return b.isFeatureEnabled(2)}static isFeatureEnabled(d){return!!(b.$pg&1<<d)}}b.$pg=a.AFrameworkApplication.fa?
a.AFrameworkApplication.fa.qd("TellMeFeatureConfigValue",0):0;Object(n.a)(b,"TellMeFeatureAvailability",null,[])},916:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);a=a(709);class c extends a.a{constructor(b,d,f,e,k=null){super(b,d,k,null,f);this.id=e}}Object(n.a)(c,"TryQueryResultBinding",a.a,[])},917:function(n,C,a){a.d(C,"a",function(){return c});n=a(0);class c{constructor(b){this.Da=b}get Jla(){return this.Da.Jla}get YGj(){return 4!==this.Da.style}get bHj(){return!0}get trie(){return this.Da.trie}getId(b,
d){if(!this.YGj)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Da.style){case 0:return this.OQh(b,d);default:throw Error.notImplemented();}}ga(b){if(!this.bHj)throw Error.invalidOperation("String lookup not supported on this string table");if(0>b||b>=this.Jla)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Da.style){case 0:return this.JYh(b);case 4:return this.IYh(b);default:throw Error.notImplemented();}}OQh(b,d){b=this.Da.trie.Fof(b,
0,b.length,d);if(!b.succeeded)return-1;if(0>b.ffb||b.ffb>=this.Da.Jla)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Da.HOb?this.Da.FHb.En(this.Da.HOb+4*b.ffb,4):b.ffb}JYh(b){if(this.Da.HOb){let d=0;for(;d<this.Da.Jla&&this.Da.FHb.En(this.Da.HOb+4*d,4)!==b;++d);if(d>=this.Da.Jla)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Da.trie.X3e(d)}return this.Da.trie.X3e(b)}IYh(b){const d=this.Da.FHb.En(this.Da.h8f+4*b,4);b=
this.Da.FHb.En(this.Da.i8f+4*b,4);if(0>b||0>d)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const f=Array(d);for(let e=0;e<d;++e)f[e]=({$7h:b}=this.U5i(b)).returnValue;return String.fromCharCode.apply(null,f)}U5i(b){let d=0;for(let f=0;3>f;++f){const e=this.Da.FHb.na(this.Da.Nye+b)^182;++b;d|=(e&127)<<7*f;if(!(e&128))break}return{returnValue:d,$7h:b}}}Object(n.a)(c,"StringTable",null,[661])},918:function(n,C,a){a.d(C,"a",function(){return b});n=a(0);var c=a(937);
class b{constructor(d){this.trie=null;this.Nye=this.h8f=this.i8f=this.HOb=0;if(d){this.FHb=d;var f=0;if(d.En(f,4)!==b.TGa)throw Error.argument("bytes","Input does not represent a string table");f+=4;this.Jla=d.En(f,4);f+=4;this.style=d.En(f,4);f+=4;switch(this.style){case 0:const e=1===d.En(f,4);f+=4;e||(this.HOb=f,f+=4*this.Jla);d.En(f,4);this.trie=this.kXi(d,f+4);break;case 4:this.i8f=f;this.h8f=f+=4*this.Jla;f+=4*this.Jla;d.En(f,4);this.Nye=f+4;break;default:throw Error.argument("bytes");}}}kXi(d,
f){return new c.a(d,f)}}b.TGa=1025118440;Object(n.a)(b,"StringTableInit",null,[])},931:function(n,C,a){a.r(C);n=a(0);var c=a(7),b=a(15),d=a(38);class f{constructor(){this.QuickFormatType=this.Command=0;this.Formula2=this.Formula1=null;this.Value=10;this.Unique=!1;this.TimePeriodType=0;this.StopIfTrue=!1;this.Priority=-1;this.CustomFormat=null}}Object(n.a)(f,"ConditionalFormattingOptions",null,[]);var e=a(8),k=a(5),l=a(175),m=a(61);const u=(Wa,Sa,yb,Ma,Bb,Nb,Ia,jb=null)=>{jb=Wa.Na(1,jb);jb.entireSheet=
Sa;jb.selectedRanges=yb;return m.g(Wa,"GetConditionalFormattingRules",jb,Ma,Bb,Nb,Ia,4)},t=(Wa,Sa,yb,Ma,Bb,Nb,Ia,jb,Ob=null)=>{Ob=Wa.Na(9,Ob);Ob.deleteCommandType=Sa;Ob.selectedRanges=yb;Ob.id=Ma;return m.g(Wa,"DeleteConditionalFormattingRules",Ob,Bb,Nb,Ia,jb,0)},w=(Wa,Sa,yb,Ma,Bb,Nb,Ia,jb=null)=>{jb=Wa.Na(9,jb);jb.sheetName=Sa;jb.id=yb;return m.g(Wa,"DuplicateConditionalFormattingRule",jb,Ma,Bb,Nb,Ia,0)},r=(Wa,Sa,yb,Ma,Bb,Nb,Ia,jb,Ob=null)=>{Ob=Wa.Na(9,Ob);Ob.conditionalFormattingOptions=Sa;Ob.selectedRanges=
yb;Ob.activeCell=Ma;return m.g(Wa,"AddConditionalFormattingRule",Ob,Bb,Nb,Ia,jb,0)},v=(Wa,Sa,yb,Ma,Bb,Nb,Ia,jb,Ob,Jb=null)=>{Jb=Wa.Na(9,Jb);Jb.id=Sa;Jb.conditionalFormattingOptions=yb;Jb.range=Ma;Jb.activeCell=Bb;return m.g(Wa,"QuickEditConditionalFormattingRule",Jb,Nb,Ia,jb,Ob,0)};var y=a(43),x=a(209),B=a(197),z=a(29),A=a(282);class I{constructor(){this.minimumCFObjectValues=this.midpointCFObjectValues=this.maximumCFObjectValues=this.minimumColor=this.midpointColor=this.maximumColor=null}}Object(n.a)(I,
"ColorScaleFormat",null,[]);class F{constructor(){this.timePeriod=this.unique=this.value=this.formula2=this.formula1=this.quickFormat=this.command=null}}Object(n.a)(F,"ConditionalFormattingEditOptions",null,[]);class U{constructor(){this.index=this.iconSet=0}}Object(n.a)(U,"ConditionalFormattingIconFormat",null,[]);class X{constructor(){this.ruleName=this.isPlaceholder=null;this.ruleType=0;this.ruleId=this.ruleRangeSheetName=this.ruleRange=null;this.priority=0;this.stopIfTrue=!1;this.editOptions=
this.iconSetFormat=this.customFormat=this.dataBarFormat=this.colorScaleFormat=null}}Object(n.a)(X,"ConditionalFormattingRule",null,[]);class T{constructor(){this.thickness=this.themeColor=this.color=this.lineStyle=this.position=null}}Object(n.a)(T,"CustomBorderFormat",null,[]);class G{constructor(){this.textColorThemeInfo=this.textColor=this.backgroundColorThemeInfo=this.backgroundColor=null;this.isTextDoubleUnderlined=this.isTextUnderlined=this.isTextStrikethrough=this.isTextItalic=this.isTextBold=
!1;this.preserveTextColor=this.preserveBackgroundColor=this.gradientFill=this.borderFormat=null}}Object(n.a)(G,"CustomFormat",null,[]);class D{constructor(){this.isLinearGradient=!1;this.degree=0;this.gradientStops=this.radialGradientPosition=null}}Object(n.a)(D,"CustomFormatGradientFill",null,[]);class J{constructor(){this.isBottom=this.isRight=this.isCenter=!1}}Object(n.a)(J,"CustomFormatRadialGradientPosition",null,[]);class L{constructor(){this.isGradientFill=!1;this.fillColor=this.borderColor=
null;this.isNegativeValuesFillColorCustom=this.isLTRDirection=!1;this.negativeValuesFillColor=null;this.isNegativeValuesBorderColorCustom=!1;this.negativeValuesBorderColor=null;this.isShowValueEnabled=!1;this.axisColor=null;this.axisPositionType=0;this.maxBoundCFObjectValues=this.minBoundCFObjectValues=null}}Object(n.a)(L,"DataBarFormat",null,[]);class H{constructor(){this.icons=null;this.isIconOnly=this.isReverseIconsOrder=!1;this.conditionalFormattingIconsCustomOptions=null}}Object(n.a)(H,"IconSetFormat",
null,[]);const R=(Wa,Sa,yb,Ma,Bb)=>{b.ULS.sendTraceTag(537167185,0,50,"GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback");if(Wa&&A.a(Wa)){a:switch(Wa.Errors[0].MessageId){case -139005925:Sa=1;break a;case 1557873584:Sa=2;break a;default:Sa=0}0!==Sa?(b.ULS.sendTraceTag(593589700,0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with expected error: ${Wa.Errors[0].MessageIdName}.`),Bb(Ma,null,Sa)):(Ma=z.a.xc(Wa.Errors),b.ULS.sendTraceTag(593589699,
0,15,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: request ended with errors: ${Ma}.`))}else if(Wa&&Wa.Result){var Nb=Wa.Result,Ia=Nb.Rules.length,jb=0;Wa=0;for(var Ob of Nb.Rules)Ob&&jb++;b.ULS.sendTraceTag(537167184,0,50,`GetConditionalFormattingRulesHelper.ProcessConditionalFormattingResult got ${Ia} rules from server, ${Ia-jb} rules with errors.`);if(1>jb)Sa=[];else{Ob=Array(jb);for(const ha of Nb.Rules)if(ha){jb=new X;jb.ruleId=ha.RuleId;jb.ruleName=ha.Name;jb.priority=
ha.Priority;jb.stopIfTrue=ha.StopIfTrue;jb.ruleRange=y.i(y.g(ha.Range.Ranges),Sa.listSeparator,Sa,!1,!1,!1);jb.ruleRangeSheetName=yb;var Jb;Nb=jb;Ia=ha;switch(Ia.Type){case 0:Nb.ruleType=0;Nb.colorScaleFormat=new I;Ia.ColorScaleFormat?(Nb.colorScaleFormat.maximumColor=Ia.ColorScaleFormat.MaxPointColor,Nb.colorScaleFormat.maximumCFObjectValues={type:Ia.ColorScaleFormat.MaxPointCFValueObject.Type,formula:Ia.ColorScaleFormat.MaxPointCFValueObject.Formula,number:Ia.ColorScaleFormat.MaxPointCFValueObject.Number},
Nb.colorScaleFormat.minimumColor=Ia.ColorScaleFormat.MinPointColor,Nb.colorScaleFormat.minimumCFObjectValues={type:Ia.ColorScaleFormat.MinPointCFValueObject.Type,formula:Ia.ColorScaleFormat.MinPointCFValueObject.Formula,number:Ia.ColorScaleFormat.MinPointCFValueObject.Number},Nb.colorScaleFormat.midpointColor=Ia.ColorScaleFormat.MidPointColor,Ia.ColorScaleFormat.MidPointCFValueObject&&(Nb.colorScaleFormat.midpointCFObjectValues={type:Ia.ColorScaleFormat.MidPointCFValueObject.Type,formula:Ia.ColorScaleFormat.MidPointCFValueObject.Formula,
number:Ia.ColorScaleFormat.MidPointCFValueObject.Number})):b.ULS.shipAssertTag(537167183,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.ColorScaleFormat for color scale rule type");break;case 1:Nb.ruleType=1;Nb.dataBarFormat=new L;Ia.DataBarFormat?(Nb.dataBarFormat.isGradientFill=Ia.DataBarFormat.IsGradientFill,Nb.dataBarFormat.isLTRDirection=Ia.DataBarFormat.IsLTRDirection,Nb.dataBarFormat.fillColor=Ia.DataBarFormat.FillColor,Nb.dataBarFormat.borderColor=Ia.DataBarFormat.BorderColor,
Nb.dataBarFormat.isNegativeValuesFillColorCustom=Ia.DataBarFormat.IsNegativeValuesFillColorCustom,Nb.dataBarFormat.negativeValuesFillColor=Ia.DataBarFormat.NegativeValuesFillColor,Nb.dataBarFormat.isNegativeValuesBorderColorCustom=Ia.DataBarFormat.IsNegativeValuesBorderColorCustom,Nb.dataBarFormat.negativeValuesBorderColor=Ia.DataBarFormat.NegativeValuesBorderColor,Nb.dataBarFormat.isShowValueEnabled=Ia.DataBarFormat.IsShowValueEnabled,Nb.dataBarFormat.axisColor=Ia.DataBarFormat.AxisColor,Nb.dataBarFormat.axisPositionType=
Ia.DataBarFormat.AxisPositionType,Nb.dataBarFormat.minBoundCFObjectValues={type:Ia.DataBarFormat.MinBoundCFValueObject.Type,formula:Ia.DataBarFormat.MinBoundCFValueObject.Formula,number:Ia.DataBarFormat.MinBoundCFValueObject.Number},Nb.dataBarFormat.maxBoundCFObjectValues={type:Ia.DataBarFormat.MaxBoundCFValueObject.Type,formula:Ia.DataBarFormat.MaxBoundCFValueObject.Formula,number:Ia.DataBarFormat.MaxBoundCFValueObject.Number}):b.ULS.shipAssertTag(537167182,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.DataBar for color data bar rule type");
break;case 2:Nb.ruleType=2;Nb.iconSetFormat=new H;if(Ia.IconSetFormat){Nb.iconSetFormat.isReverseIconsOrder=Ia.IconSetFormat.ReverseOrder;Nb.iconSetFormat.isIconOnly=Ia.IconSetFormat.IsIconOnly;b.ULS.shipAssertTag(537167181,0,!!Ia.IconSetFormat.Icons,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat.Icons for icon set rule type");Nb.iconSetFormat.icons=Array(Ia.IconSetFormat.Icons.length);Nb.iconSetFormat.conditionalFormattingIconsCustomOptions=[];for(var Kb=0;Kb<
Ia.IconSetFormat.Icons.length;Kb++)Nb.iconSetFormat.icons[Kb]=new U,Nb.iconSetFormat.icons[Kb].index=Ia.IconSetFormat.Icons[Kb].Icon,Nb.iconSetFormat.icons[Kb].iconSet=Ia.IconSetFormat.Icons[Kb].IconSet,Nb.iconSetFormat.conditionalFormattingIconsCustomOptions.push({isGreaterEqual:Ia.IconSetFormat.ConditionalFormattingIconsCustomOptions[Kb].IsGreaterEqual,cfValueObject:{type:Ia.IconSetFormat.ConditionalFormattingIconsCustomOptions[Kb].CFValueObject.Type,formula:Ia.IconSetFormat.ConditionalFormattingIconsCustomOptions[Kb].CFValueObject.Formula,
number:Ia.IconSetFormat.ConditionalFormattingIconsCustomOptions[Kb].CFValueObject.Number}})}else b.ULS.shipAssertTag(537167180,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.IconSetFormat for icon set rule type");break;case 3:Nb.ruleType=3;Nb.customFormat=new G;if(Ia.CustomFormat){Nb.customFormat.backgroundColor=Ia.CustomFormat.BackgroundColor;Nb.customFormat.textColor=Ia.CustomFormat.TextColor;Nb.customFormat.isTextBold=Ia.CustomFormat.IsTextBold;Nb.customFormat.isTextItalic=
Ia.CustomFormat.IsTextItalic;Nb.customFormat.isTextStrikethrough=Ia.CustomFormat.IsTextStrikethrough;Nb.customFormat.isTextUnderlined=Ia.CustomFormat.IsTextUnderlined;Nb.customFormat.isTextDoubleUnderlined=Ia.CustomFormat.IsTextDoubleUnderlined;if(Ia.CustomFormat.BorderFormat)for(Nb.customFormat.borderFormat=new T,Nb.customFormat.borderFormat.lineStyle=Array(4),Nb.customFormat.borderFormat.color=Array(4),Nb.customFormat.borderFormat.thickness=Array(4),Kb=0;4>Kb;Kb++)Nb.customFormat.borderFormat.lineStyle[Kb]=
Ia.CustomFormat.BorderFormat.LineStyle[Kb],Nb.customFormat.borderFormat.color[Kb]=B.a.sG(x.a.tH(Ia.CustomFormat.BorderFormat.Color[Kb])),Nb.customFormat.borderFormat.thickness[Kb]=Ia.CustomFormat.BorderFormat.Thickness[Kb];Kb=Nb.customFormat;if(Jb=Ia.CustomFormat.GradientFill)if(!Jb.GradientStops||1>=Jb.GradientStops.length||1===Jb.Type&&2!==Jb.GradientStops.length)b.ULS.shipAssertTag(591663646,0,!1,`GetConditionalFormattingRulesHelper.GetFillGradientProperties: missing gradient stops, length=${Jb.GradientStops?
Jb.GradientStops.length:-1}.`),Jb=null;else{var Qa=new D;Qa.gradientStops=Array(Jb.GradientStops.length);for(let qa=0;qa<Jb.GradientStops.length;qa++)Qa.gradientStops[qa]=B.a.sG(x.a.tH(Jb.GradientStops[qa].Color));Qa.isLinearGradient=0===Jb.Type;Qa.degree=Jb.Degree;Qa.isLinearGradient||(Qa.radialGradientPosition=new J,Jb.FillToRight&&1!==Jb.FillToRight?Qa.radialGradientPosition.isCenter=!0:(Qa.radialGradientPosition.isCenter=!1,Qa.radialGradientPosition.isRight=1===Jb.FillToRight,Qa.radialGradientPosition.isBottom=
1===Jb.FillToBottom));Jb=Qa}else Jb=null;Kb.gradientFill=Jb;Ia.EditOptions&&(Nb.editOptions=new F,Nb.editOptions.command=Ia.EditOptions.Command,Nb.editOptions.formula1=Ia.EditOptions.Formula1,Nb.editOptions.formula2=Ia.EditOptions.Formula2,Nb.editOptions.value=Ia.EditOptions.Value,Nb.editOptions.unique=Ia.EditOptions.Unique,Nb.editOptions.timePeriod=Ia.EditOptions.TimePeriodType)}else b.ULS.shipAssertTag(537167179,0,!1,"GetConditionalFormattingRulesHelper.SetFormatForRuleType: got null rule.CustomFormat for custom rule type");
break;default:b.ULS.sendTraceTag(537167178,0,10,"GetConditionalFormattingRulesHelper.GetReactRuleType unexpected rule type")}Ob[Wa]=jb;Wa++}Sa=Ob}Bb(Ma,Sa,0)}else b.ULS.sendTraceTag(593589698,0,10,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesSuccessCallback: failed to get rules from server. Result is null: ${!Wa}.`)},Q=Wa=>{b.ULS.sendTraceTag(593589697,0,50,`GetConditionalFormattingRulesHelper.OnGetConditionalRulesFailed: status = ${Wa.data.status}, HTTP status = ${Wa.data.httpStatus}.`)},
O=(Wa,Sa)=>Wa.priority-Sa.priority;var V=a(1),W=a(21),da=a(145);class ta extends Sys.EventArgs{constructor(Wa,Sa){super();this.Cnd=Sa}}Object(n.a)(ta,"ConditionalFormattingSheetProtectionOptionsChangedEventArgs",Sys.EventArgs,[]);class K{constructor(Wa){this.dQi="OnProtectionOptionsChanged";this.gvf="OnActiveSheetChanging";this.uNa=!1;this.Ra=new d.a;this.p5b=this.Bjc=this.Ljc=this.fKb=0;this.G3b=null;this.Iya=(Sa,yb)=>{W.g(this.$).inRangePicker||W.g(this.$).Fi||!yb.oa||(this.Sze(),V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")?
this.wei(yb.oa)?this.Ra.raiseEvent("sheetProtectionOptionsChangedEventKey",new ta(!0,!1)):this.tca(this.gvf,yb.oa.sheetName,!1):this.tca(this.gvf,yb.oa.sheetName))};this.kvf=(Sa,yb)=>{yb.newName!==yb.oldName&&yb.newName===this.$.xa.oa.name&&this.iQj(yb.newName)};this.Vf=()=>{if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")){const {Uhc:Sa,rLf:yb}=this.Uhc();Sa&&this.$.oa&&this.$.oa.sheetName===yb||this.p5b===this.$.ea.Eo.ConditionalFormattingRulesStateId||
this.tca("LatestCFStateIdChanged")}else this.p5b!==this.$.ea.Eo.ConditionalFormattingRulesStateId&&this.tca("LatestCFStateIdChanged")};this.Wc=(Sa,yb)=>{b.ULS.sendTraceTag(537167202,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged Begin of OnSessionIdChanged");yb.LH&&this.tca("OnSessionIdChanged");b.ULS.sendTraceTag(537167201,0,50,"ActiveSheetConditionalFormattingRules.OnSessionIdChanged End of OnSessionIdChanged")};this.Lo=()=>{b.ULS.sendTraceTag(537167200,0,50,"ActiveSheetConditionalFormattingRules.OnLoadOnDemand");
this.tca("OnLoadOnDemand")};this.$Qj=(Sa,yb,Ma=0)=>{Sa>this.Bjc&&(this.Bjc=Sa,this.G3b=yb,this.xJc=Ma,this.uNa=!0,this.Ra.raiseEvent("ConditionalFormattingRulesChangedEventKey"))};this.$Ki=(Sa,yb,Ma)=>{this.uNa=!1;Q(Sa,yb,Ma)};this.$=Wa;this.xJc=0;this.$.ea.Eo&&(this.p5b=this.$.ea.Eo.ConditionalFormattingRulesStateId)}get $Xe(){return this.xJc}NFg(Wa){this.Ra.addHandler("ConditionalFormattingRulesChangedEventKey",Wa);this.fKb++;1===this.fKb&&this.F7i();this.tca("OnConditionalFormattingRulesChangedEventRegistered")}$aj(Wa){this.Ra.removeHandler("ConditionalFormattingRulesChangedEventKey",
Wa);1>this.fKb||(this.fKb--,this.fKb||this.Vcg())}yIg(Wa){this.Ra.addHandler("sheetProtectionOptionsChangedEventKey",Wa)}kdj(Wa){this.Ra.removeHandler("sheetProtectionOptionsChangedEventKey",Wa)}getConditionalFormattingRules(Wa=null){let Sa;Sa=null;if(!this.uNa)return this.tca("OnInvalidCache"),{returnValue:!1,F3b:Sa};Sa=this.V1g(this.G3b,Wa);return{returnValue:!0,F3b:Sa}}Sze(){this.Bjc=this.Ljc;this.G3b=null;this.uNa=!0;this.xJc=0;this.Ra.raiseEvent("ConditionalFormattingRulesChangedEventKey")}dispose(){this.Vcg()}Cnd(){return this.$.xa?
(new da.a(this.$.xa)).Wd(4):!1}tca(Wa,Sa=null,yb=!0){if(this.$.ea.fc)if(Sa||this.$.xa.oa&&this.$.xa.oa.sheetName)if(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&yb&&!this.Cnd())this.Ra.raiseEvent("sheetProtectionOptionsChangedEventKey",new ta(!0,!1));else{++this.Ljc;var Ma=this.Ljc;this.p5b=this.$.ea.Eo?this.$.ea.Eo.ConditionalFormattingRulesStateId:0;var Bb=Sa||this.$.xa.oa.sheetName;u(this.$.pa.va,!0,this.oOh(Bb),Nb=>{this.aLi(Nb,Bb,Ma)},this.$Ki,null,
this.$.pa.va.Tb())}else b.ULS.sendTraceTag(592487841,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Sheets Active Item is null. ActiveItem is null: {0}. ActiveItem.SheetName is null: {1}. Is during application shut down: {2}. Get rules trigger method: {3}.",!this.$.oa,this.$.oa?!this.$.oa.sheetName:!1,!Sys.Application||Sys.Application.get_isDisposing(),Wa),this.uNa=!1;else b.ULS.sendTraceTag(592843921,0,10,"ActiveSheetConditionalFormattingRules.OnConditionaFormattingRulesChanged: Session is not active."),
this.uNa=!1}aLi(Wa,Sa,yb){Wa&&Wa.Result&&!A.a(Wa)||(this.uNa=!1);R(Wa,this.$,Sa,yb,this.$Qj)}iQj(Wa){for(const Sa of this.G3b)Sa.ruleRangeSheetName=Wa}V1g(Wa,Sa){if(!Wa)return null;const yb=[];Sa=Sa?y.g(Sa):null;for(const Ma of Wa)Sa&&!y.a(y.X(Ma.ruleRange,this.$.listSeparator),Sa)||yb.push(Ma);return yb}F7i(){this.$.xa.wJ(this.Iya);this.$.ea.rk(this.Wc);V.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.xa.YFa(this.kvf);this.$.ea.Vu(this.Vf);
this.$.ea.jM(this.Lo)}Vcg(){this.$.xa.cL(this.Iya);this.$.ea.Pk(this.Wc);V.EwaSettings.isChangeGateEnabled("OfficeVSO:5080484_ConditionalFormattingManagerUpdateOnSheetRename")&&this.$.xa.VQa(this.kvf);this.$.ea.Sw(this.Vf);this.$.ea.GR(this.Lo)}x8a(){this.$.ea.Je!==e.a.Be&&this.$.ea.fc&&this.tca("LatestStateIdChanged")}Uhc(){let Wa=!1,Sa;const yb=this.$.ea.Eo;if(yb&&yb.SheetChanges&&this.$.xa){var Ma=yb.SheetChanges;const Bb=this.$.xa.oa;if(!Bb)return{Uhc:!1,rLf:void 0};for(let Nb of Ma)Ma=128===
Nb.Options||131072===Nb.Options,6!==Nb.Type&&7!==Nb.Type||!Ma||(this.cQi(yb,Bb,Nb),Sa=Nb.Name,Wa=!0)}return{Uhc:Wa,rLf:Sa}}cQi(Wa,Sa,yb){yb=this.$.Pn.getItemByName(yb.Name).index;Wa=Wa.Sheets[yb];yb=1024===(Wa.Flags&1024);const Ma=!!Wa.AllowSheetProtectionFeatures&&!!(Wa.AllowSheetProtectionFeatures&4);yb=!(16===(Wa.Flags&16)&&!yb)||Ma;if(Sa=Wa.Name===Sa.sheetName)yb?(this.Sze(),this.tca(this.dQi,void 0,!1)):this.Bjc=this.Ljc;this.Ra.raiseEvent("sheetProtectionOptionsChangedEventKey",new ta(Sa,yb))}wei(Wa){const Sa=
Wa.sGa&4;return!!Wa&&Wa.wi&&!Sa}oOh(Wa){return y.p(Wa,"",0,0,0,0)}}Object(n.a)(K,"ActiveSheetConditionalFormattingRules",null,[]);var na=a(1312),P=a(740),ka=a(153),pa=a(343),Na=a(172);class Z{static lvf(Wa,Sa){if(Sa&&A.a(Sa)){const yb=z.a.xc(Sa.Errors);b.ULS.sendTraceTag(578336280,0,50,`OnAddConditionalFormattingRuleSuccess: request ended with errors: ${yb}.`);Na.b("ConditionalFormatting_OnAddConditionalFormattingRuleSuccess");Z.j4f(Wa,Sa)}else V.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerSlowOperationsTeachingCallout",
!1)&&(Wa=Wa.da.za(465))&&Wa.R0(4,Sa)}static RFi(Wa){b.ULS.sendTraceTag(578336279,0,50,`GetConditionalFormattingRulesHelper.OnAddConditionalFormattingRuleFailed: status = ${Wa.data.status}, HTTP status = ${Wa.data.httpStatus}.`)}static CJi(Wa,Sa,yb){if(yb&&A.a(yb)){const Ma=z.a.xc(yb.Errors);b.ULS.sendTraceTag(573686987,0,50,`OnEditConditionalFormattingRuleSuccess: request ended with errors: ${Ma}.`);Z.j4f(Wa,yb);Z.xzj(Wa,yb);Sa.y_d()}}static BJi(Wa){b.ULS.sendTraceTag(573686986,0,50,`GetConditionalFormattingRulesHelper.OnEditConditionalFormattingRuleFailed: status = ${Wa.data.status}, HTTP status = ${Wa.data.httpStatus}.`)}static j4f(Wa,
Sa){Sa&&z.a.lh(Sa.Errors,Z.conditionalFormattingAddRuleInvalidFormula)&&(Sa=z.a.Yc(1,1,2217,2218,0,104275673,"ConditionalFormattingAddRuleInvalidFormula"),V.EwaSettings.Dz()?new pa.a(Wa,Sa):(new ka.ErrorDialog(Wa,Sa)).ig())}static xzj(Wa,Sa){if(Sa){let yb=null;z.a.lh(Sa.Errors,Z.conditionalFormattingCantApplyRangeOutsidePivotTable)?yb=z.a.Yc(1,1,2217,2219,0,666127521,"ConditionalFormattingCantApplyRangeOutsidePivotTable"):z.a.lh(Sa.Errors,Z.conditionalFormattingCantApplyRangeInsidePivotTable)&&(yb=
z.a.Yc(1,1,2217,2220,0,1259721746,"ConditionalFormattingCantApplyRangeInsidePivotTable"));yb&&(V.EwaSettings.Dz()?new pa.a(Wa,yb):(new ka.ErrorDialog(Wa,yb)).ig())}}static BJf(Wa,Sa){if(Sa.startsWith("="))return Sa;if(Wa=Wa.da.za(266))if(Wa=Wa.toXLNumber(Sa),null!=Wa)return Wa.toString();return`="${Sa}"`}static uii(Wa,Sa,yb){let Ma;return Wa.startsWith("=")&&({L6:Ma}=y.ab(Wa.substring(1,Wa.length),Sa,yb)).returnValue?0<Ma.length&&!(1===Ma.length&&Ma[0].isSingle):!1}static getFormulaErrorType(Wa,Sa,
yb){return Wa?Z.uii(Wa,Sa,yb)?3:0:1}static getRangeErrorType(Wa,Sa,yb){if(!Wa)return 1;let Ma;return({L6:Ma}=y.ab(Wa,Sa,yb)).returnValue&&y.V(Ma)?0:2}static getRangeError(Wa,Sa,yb,Ma){if(!Wa)return 1;let Bb;return({L6:Bb}=y.ab(Wa,Sa,yb)).returnValue&&y.V(Bb)?this.Zmi(yb,Ma)?6:0:2}static Zmi(Wa,Sa){Wa=Wa.getItemByName(Sa);if(!Wa)return!1;Sa=Wa.sGa&4;return!(!Wa||!Wa.wi||Sa)}}Z.conditionalFormattingAddRuleInvalidFormula=[104275673];Z.conditionalFormattingCantApplyRangeOutsidePivotTable=[666127521];
Z.conditionalFormattingCantApplyRangeInsidePivotTable=[1259721746];Object(n.a)(Z,"ConditionalFormattingRuleEditorHelper",null,[]);var Ra=a(1283),Da=a(33),Ba=a(14);class ea{constructor(){this.getRangeError=this.getRangeErrorType=this.getFormulaErrorType=this.addNewRuleFromTaskPane=this.onRuleEdited=this.onRuleAdded=this.setFocusOnToolbarFirstElement=this.onDeleteRulesByFilter=this.onRuleDuplicate=this.onRuleDelete=this.onRuleHoverStateChange=this.onRuleFilteringOptionsChange=this.changeTaskPaneView=
null}}Object(n.a)(ea,"ConditionalFormattingTaskPaneCallbacks",null,[]);class Y{constructor(){this.type=null;this.ruleFilterOption=this.taskPaneViewType=0;this.notification=this.uiElementsIds=this.error=this.borderMenuController=this.colorPickerButtonController=this.rangePickerController=this.updateTaskPaneTriggerMethodName=this.callbacks=this.rule=this.rules=this.firstPaneElementId=null}}Object(n.a)(Y,"ConditionalFormattingTaskPaneProps",null,[]);class ja{constructor(){this.ruleListId=this.loadingRuleListId=
this.ruleManagerId=this.firstPaneElementId=null}}Object(n.a)(ja,"ConditionalFormattingUIElementIds",null,[]);class ca{constructor(Wa,Sa){this.EAe=null;this.VA=Wa;this.$=Sa}GI(Wa,Sa,yb,Ma=null){l.UISurfaces.Tj().then(Bb=>{Bb.showTaskPane("ConditionalFormattingTaskPane",this.fw(Wa,Sa,yb,void 0,Ma));this.VA.kNi();return null})}Fu(Wa,Sa,yb,Ma=null,Bb=null,Nb=0,Ia=null){l.UISurfaces.Tj().then(jb=>{const Ob=this.$.Jb.Bc("UserAction","ConditionalFormattingTPRenderStopwatch");jb.updateTaskPane("ConditionalFormattingTaskPane",
this.fw(Wa,Sa,yb,Ma,Bb,Nb,Ia));Ob.stop();this.VA.USi();return null})}cN(){l.UISurfaces.Tj().then(Wa=>{Wa.hideTaskPane("ConditionalFormattingTaskPane",2);return null})}w$(){this.EAe()}Dda(){l.UISurfaces.Tj().then(Wa=>{Wa.setSelectedTaskPane("ConditionalFormattingTaskPane");return null})}fw(Wa,Sa,yb,Ma=null,Bb=null,Nb=0,Ia=null){const jb=Object(c.a)(new ea,{onRuleFilteringOptionsChange:this.VA.onRuleFilteringOptionsChange,onRuleHoverStateChange:this.VA.onRuleHoverStateChange,setFocusOnToolbarFirstElement:this.VA.setFocusOnToolbarFirstElement,
onRuleDelete:this.VA.onRuleDelete,onRuleDuplicate:this.VA.onRuleDuplicate,changeTaskPaneView:this.VA.VSi,onDeleteRulesByFilter:this.VA.onDeleteRulesByFilter,onRuleAdded:this.VA.onRuleAdded,onRuleEdited:this.VA.onRuleEdited,addNewRuleFromTaskPane:this.VA.addNewRuleFromTaskPane,getFormulaErrorType:Jb=>Z.getFormulaErrorType(Jb,this.$.listSeparator,this.$.xa),getRangeErrorType:Jb=>Z.getRangeErrorType(Jb,this.$.listSeparator,this.$.xa),getRangeError:(Jb,Kb)=>Z.getRangeError(Jb,this.$.listSeparator,this.$.xa,
Kb)}),Ob=Object(c.a)(new ja,{firstPaneElementId:Ra.a.firstPaneElementId,ruleManagerId:Ra.a.ruleManagerId,loadingRuleListId:Ra.a.loadingRuleListId,ruleListId:Ra.a.ruleListId});Sa=Object(c.a)(new Y,{type:"ConditionalFormattingTaskPaneProps",taskPaneViewType:Sa,ruleFilterOption:yb,rules:Ma,rule:Bb,firstPaneElementId:Ra.a.firstPaneElementId,callbacks:jb,rangePickerController:W.g(this.$).Ff.$bc(),error:Nb,uiElementsIds:Ob,notification:Ia,colorPickerButtonController:this.VA.colorPickerButtonController,
borderMenuController:this.VA.borderMenuController});if(Da.a.od(this.$))return Object(c.a)(new na.a,{contentProps:Sa,onOpen:()=>{this.VA.ny()},onClose:()=>{this.VA.AB()},onShow:()=>{this.VA.$Bf()},onHide:()=>{this.VA.ZBf()},width:320,title:Ba.a.instance.ga(1302),preventCloseCallback:Jb=>{this.VA.gCd();this.EAe=Jb}});Wa=Object(c.a)(new P.a,{container:Wa,paneProps:Sa});return Object(c.a)(new na.a,{contentProps:Wa,onOpen:()=>{this.VA.ny()}})}}Object(n.a)(ca,"ConditionalFormattingReactTaskPane",null,[464]);
class ba{constructor(Wa,Sa,yb,Ma,Bb){this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.conditionalFormatting=this.range=null;this.range=Sa;this.conditionalFormatting=Wa;this.dataBarFormat=yb;this.colorScaleFormat=Ma;this.iconSetFormat=Bb}getRange(){return this.range}}Object(n.a)(ba,"MacroRecorderRangeConditionalFormattingCreatedPayload",null,[115]);class ua{constructor(Wa,Sa){this.range=null;this.priority=0;this.range=Wa;this.priority=Sa}getRange(){return this.range}uwb(){return this.priority}}
Object(n.a)(ua,"MacroRecorderRangeConditionalFormattingRuleDeletedPayload",null,[115]);var wa=a(65),ia=a(515),xa=a(370),gb=a(171),va=a(50),sa=a(415),ab=a(37),Ua=a(109),nb=a(22),Ha=a(281),sb=a(341);class Qb{constructor(){this.newJSApiPriority=this.iconSetFormat=this.colorScaleFormat=this.dataBarFormat=this.customFormat=this.stopIfTrue=this.options=this.activeCell=this.ruleRangeSheetName=this.range=this.priority=this.addRuleType=this.guid=null}}Object(n.a)(Qb,"ConditionalFormattingEditableRule",null,
[]);class mb{constructor(){this.taskPaneExpandEvent=this.sheetProtectionOptionsChangedEvent=this.sheetDeletedEvent=this.sheetRenameEvent=null}}Object(n.a)(mb,"ConditionalFormattingNotification",null,[]);class Pb{constructor(){this.column=this.row=0}}Object(n.a)(Pb,"ConditionalFormattingRuleActiveCell",null,[]);class gc{constructor(){this.sheetName=null}}Object(n.a)(gc,"SheetDeletedEventArgs",null,[]);class Xb{constructor(){this.newSheetName=this.oldSheetName=null}}Object(n.a)(Xb,"SheetRenameEventArgs",
null,[]);class Ca{}Object(n.a)(Ca,"SheetProtectionOptionsChangedEventArgs",null,[]);class ra{}Object(n.a)(ra,"TaskPaneExpandEventArgs",null,[]);var ma=a(55),hb=a(240);class vb{constructor(Wa){this.Nsa=this.TFc=this.Y4d=this.Zy=null;this.Dnd=this.Owa=this.Tfc=!1;this.Z_c=[28];this.tcb=null;this.isInitialized=!1;this.vlf=this.yPb=this.yL=0;this.EHd=this.sWf=null;this.y6e=()=>{this.AB()};this.gCd=()=>{this.q$.Fu(this.Nsa,0,this.fU)};this.rDf=()=>{this.fPb(!1)};this.LCd=Sa=>{V.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&
2===this.yL?this.sendNotification({sheetProtectionOptionsChangedEvent:new Ca}):1===this.yL&&Sa&&(++this.yPb,this.IZd(this.yPb,[],3))};this.z6e=()=>{this.$Bf()};this.Sid=()=>{this.ZBf()};this.VSi=Sa=>{1===Sa&&1!==this.yL&&(this.yL=1,this.fPb());1!==Sa&&1===this.yL&&this.DIb();0===Sa&&(Da.a.od(this.$)?this.q$.w$():this.Zy.E_g());this.yL=Sa};this.sEf=(Sa,yb)=>{this.sendNotification(Object(c.a)(new mb,{sheetRenameEvent:Object(c.a)(new Xb,{oldSheetName:yb.oldName,newSheetName:yb.newName})}))};this.yD=
(Sa,yb)=>{this.sendNotification(Object(c.a)(new mb,{sheetDeletedEvent:Object(c.a)(new gc,{sheetName:yb.item.name})}))};this.Dg=()=>{1!==this.yL||this.Dod||W.g(this.$).inRangePicker||W.g(this.$).Fi||this.fPb()};this.onRuleFilteringOptionsChange=Sa=>{this.fU!==Sa&&(b.ULS.sendTraceTag(42824727,0,50,`ConditionalFormattingPaneManager.OnRuleFilteringOptionsChange: filtering option has changed to: ${Sa}`),this.fU=Sa,this.fPb())};this.onRuleHoverStateChange=(Sa,yb,Ma)=>{if(Sa){let Bb;({L6:Bb}=y.ab(Ma,this.$.listSeparator,
this.$.xa)).returnValue?W.g(this.$).ob.Ww(sb.a.mea(wa.d(this.$.oa),Bb),this.Z_c,!0):b.ULS.shipAssertTag(537948622,0,!1,"ConditionalFormattingPaneManager.OnRuleHoverStateChange: Failed to parse range when highlighting rule range")}else W.g(this.$).ob.Pg(this.Z_c)};this.onRuleDelete=Sa=>{this.deleteConditionalFormattingRules(61,this.selectedRanges,Sa)};this.onRuleDuplicate=Sa=>{this.Bjh(Sa)};this.onRuleAdded=Sa=>{const {appliedRange:yb,L6:Ma}=this.d3e(Sa.range,Sa.ruleRangeSheetName,"onRuleAdded");if(yb){var Bb=
{};Sa.activeCell?(Bb.FirstRow=Sa.activeCell.row,Bb.FirstColumn=Sa.activeCell.column):(Bb.FirstRow=yb.Ranges[0].FirstRow,Bb.FirstColumn=yb.Ranges[0].FirstColumn);var Nb=this.$Gb(Sa,!0),Ia=()=>new ba(Nb,yb,null,null,null);this.kBc();var jb=this.$.pa.va.Tb(),{ConditionalFormattingCommandHandler:Ob}=a(931);"HighlightWhen"===Ob.RDb&&Na.b("ConditionalFormatting_HighlightWhen_RuleCreated");Ob.RDb=null;Ob=this.rWf(yb,Ma);b.ULS.sendTraceTag(526930257,0,50,`ConditionalFormattingPaneManager.OnRuleAdded: Adding a new rule with: ${Ob}`);
xa.a(this.$.userOperationManager,(Jb,Kb,Qa)=>r(this.$.pa.va,this.$Gb(Sa,!1),yb,Bb,Ha.b(Jb,ha=>{Z.lvf(this.$,ha)}),Ha.a(Kb,Z.RFi),Qa,jb),Jb=>new gb.a(105,0,Jb,void 0,Ia),null)}};this.onRuleEdited=Sa=>{let yb;var Ma=null;if(Sa.range)if(({L6:Ob,sheetName:Ma}=y.ab(Sa.range,this.$.listSeparator,this.$.xa)).returnValue)if(y.V(Ob))b.ULS.shipAssertTag(574410754,0,!Ma||nb.a.equals(Ma,Sa.ruleRangeSheetName,!1),"ConditionalFormattingPaneManager.OnRuleEdited: Sheet name was modified in rule range, which is not allowed when editing range"),
yb=y.u(Sa.ruleRangeSheetName,null,Ob);else{b.ULS.shipAssertTag(557601051,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Range is invalid.");return}else{b.ULS.shipAssertTag(574410753,0,!1,"ConditionalFormattingPaneManager.OnRuleEdited: Failed to parse range when editing an existing rule");return}else yb={},yb.SheetName=Sa.ruleRangeSheetName;if(this.$.xa.contains(yb.SheetName)){var Bb={FirstRow:0,FirstColumn:0};this.kBc();var Nb=this.$.pa.va.Tb(),Ia=null;this.$.Cba&&(Ia=this.$Gb(Sa,!0));var jb=
()=>new ba(Ia,this.EHd,null,null,null);Ma=V.EwaSettings.$b()?Jb=>new gb.a(105,0,Jb,64,jb):Jb=>new ia.a(105,0,Jb,void 0,jb);if(Sa.range){var Ob=this.rWf(yb,Ob);b.ULS.sendTraceTag(526930256,0,50,`ConditionalFormattingPaneManager.OnRuleEdited: Editing a rule with: ${Ob}`)}xa.a(this.$.userOperationManager,(Jb,Kb,Qa)=>v(this.$.pa.va,Sa.guid,this.$Gb(Sa,!1),yb,Bb,Ha.b(Jb,ha=>{Z.CJi(this.$,this,ha)}),Ha.a(Kb,Z.BJi),Qa,Nb),Ma,null)}else b.ULS.shipAssertTag(557682696,1,!1,"ConditionalFormattingPaneManager.OnRuleEdited: sheet wasn't found, might be renamed or deleted.")};
this.onDeleteRulesByFilter=()=>{let Sa,yb;switch(this.fU){case 0:Sa=60;yb=this.selectedRanges;break;case 1:Sa=59;yb=y.p(this.$.xa.oa.name,"",0,0,0,0);break;default:b.ULS.sendTraceTag(590448070,0,10,`ConditionalFormattingPaneManager.OnClearRules with an unknown Rule Filtering: ${this.fU}`);return}this.deleteConditionalFormattingRules(Sa,yb,null)};this.aJi=Sa=>{Sa&&A.a(Sa)&&(Sa=z.a.xc(Sa.Errors),b.ULS.sendTraceTag(595092188,0,15,`ConditionalFormattingPaneManager.OnRuleDelete: request ended with errors: ${Sa}.`),
this.y_d())};this.yJi=Sa=>{Sa&&A.a(Sa)&&(Sa=z.a.xc(Sa.Errors),b.ULS.sendTraceTag(536966945,0,15,`ConditionalFormattingPaneManager.onDuplicateRuleSuccess: request ended with errors: ${Sa}.`),this.y_d())};this.$Ii=Sa=>{b.ULS.sendTraceTag(595116629,0,50,`ConditionalFormattingPaneManager.OnDeleteRuleFailure: status = ${Sa.data.status}, HTTP status = ${Sa.data.httpStatus}.`)};this.xJi=Sa=>{b.ULS.sendTraceTag(536966944,0,50,`ConditionalFormattingPaneManager.onDuplicateRuleFailure: status = ${Sa.data.status}, HTTP status = ${Sa.data.httpStatus}.`)};
this.setFocusOnToolbarFirstElement=()=>{Da.a.od(this.$)?l.UISurfaces.Tj().then(Sa=>{Sa.focusTabbedTaskPaneArea();return null}):this.Zy.setFocusOnToolbarFirstElement()};this.addNewRuleFromTaskPane=()=>{const {ConditionalFormattingCommandHandler:Sa}=a(931);b.ULS.sendTraceTag(573686988,0,50,"ConditionalFormattingPaneManager.AddNewRuleFromTaskPane");this.Sec(Sa.s6c)};this.Ec=(Sa,yb)=>{!yb.fg&&this.Tfc&&this.AB()};this.$=Wa;this.q$=new ca(this,this.$);this.$ld=this.$.Jb.Bc("UserAction","ConditionalFormattingTPInitialLoadStopwatch");
this.WX=new K(Wa);this.fU=this.VHe=0;Da.a.od(this.$)&&this.$.sk(this.Ec)}get colorPickerButtonController(){return this.Y4d}get borderMenuController(){return this.TFc}get selectedRanges(){return y.r(W.g(this.$).ha.sa.selectedRanges,this.$)}get Dod(){return 1===this.fU}IFe(Wa=null){if(Da.a.od(this.$)){const Sa=va.GetServiceTaskFactory.create(this.$.da,111,this.$.la,0),yb=va.GetServiceTaskFactory.Sa(this.$.da,296,468,0);ab.TaskExtensions.Aa(ab.TaskExtensions.Td([Sa,yb],this.$.la),()=>{this.taf(Sa.result,
yb.result);this.Sec(Wa)},this.$.la,3)}else if(this.Zy||this.isInitialized)this.Zy&&(this.Zy.qg(!0),this.Sec(Wa)),ma.Task.Ta(!0);else{this.isInitialized=!0;const Sa=va.GetServiceTaskFactory.Sa(this.$.da,248,249,0),yb=sa.a(this.$),Ma=[Sa,yb];let Bb=null,Nb=null;Bb=va.GetServiceTaskFactory.create(this.$.da,111,this.$.la,0);Ma.push(Bb);Nb=va.GetServiceTaskFactory.Sa(this.$.da,296,468,0);Ma.push(Nb);ab.TaskExtensions.Aa(ab.TaskExtensions.Td(Ma,this.$.la),()=>{this.Zy=Sa.result;yb.result.MQ(this.Zy);this.TGi();
this.Zy.qg(!0);this.taf(Bb.result,Nb.result);this.Sec(Wa)},this.$.la,3)}}TGi(){this.Nsa=this.Zy.CM();this.Zy.kM(this.y6e);this.Zy.QHg(this.gCd);this.Zy.NVc(this.Sid);this.Zy.OVc(this.z6e)}ny(){b.ULS.sendTraceTag(42824723,0,50,"ConditionalFormattingPaneManager.OnPaneOpen Begin of OnPaneOpen");this.Owa||(this.cO(),this.Owa=!0);this.Dnd=!0}AB(){this.hideTaskPane();this.Owa&&this.Sid(null,null);this.yL=0;this.fU=this.VHe;this.kBc()}DIb(){W.g(this.$).ob.zi(null,this.Z_c)}cO(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&
this.WX.yIg(this.LCd);this.WX.NFg(this.rDf);W.g(this.$).ha.uT(this.Dg);this.$.xa.YFa(this.sEf);this.$.xa.bY(this.yD)}fPb(Wa=!0){1===this.yL&&(V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&Wa&&!this.WX.Cnd()?this.LCd(!0):(++this.yPb,this.Dod||1!==this.WX.$Xe)?({F3b:Wa}=this.WX.getConditionalFormattingRules(this.Dod?null:this.selectedRanges.Ranges)).returnValue&&(this.ffg(),this.IZd(this.yPb,Wa,this.WX.$Xe)):(this.ffg(),this.aRj()))}ffg(){const Wa={};Wa.SheetName=
this.selectedRanges.SheetName;Wa.NamedObjectName=this.selectedRanges.NamedObjectName;Wa.Ranges=Array(this.selectedRanges.Ranges.length);for(let Sa=0;Sa<this.selectedRanges.Ranges.length;Sa++)Wa.Ranges[Sa]=this.selectedRanges.Ranges[Sa];this.EHd=Wa}aRj(){if(this.$.ea.fc){var Wa=this.selectedRanges;u(this.$.pa.va,!1,Wa,Sa=>{R(Sa,this.$,Wa.SheetName,this.yPb,(yb,Ma,Bb)=>{this.IZd(yb,Ma,Bb)})},Q,null,this.$.pa.va.Tb())}else b.ULS.sendTraceTag(592843217,0,10,"ConditionalFormattingPaneManager.UpdateConditionalFormattingRulesFromSelection: Session is not active.")}IZd(Wa,
Sa,yb){1===this.yL&&Wa>=this.vlf&&(this.q$.Fu(this.Nsa,this.yL,this.fU,Sa,void 0,yb),this.sWf=Sa,this.vlf=Wa)}$Bf(){this.Owa||(this.cO(),this.Owa=!0);Da.a.od(this.$)||(this.Dnd&&this.Zy.Y_f(),this.Zy.e0c());V.EwaSettings.isChangeGateEnabled("OfficeVSO:6008894_CFAddNewRuleRangePickerProtectedError")&&this.sendNotification({taskPaneExpandEvent:new ra})}ZBf(){this.Owa&&(this.pPj(),this.DIb(),this.Owa=!1,this.tcb=null)}TQi(){this.Owa&&(this.tcb=this.$.Jb.Bc("UserAction","ConditionalFormattingRibbonCommandRenderStopwatch"))}UQi(){this.tcb=
null}pPj(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:5926521_CFProtectedSheetErrorRuleManager")&&this.WX.kdj(this.LCd);this.WX.$aj(this.rDf);W.g(this.$)&&W.g(this.$).ha&&W.g(this.$).ha.IR(this.Dg);this.$.xa.VQa(this.sEf);this.$.xa.V6(this.yD)}sendNotification(Wa){2===this.yL&&this.q$.Fu(this.Nsa,2,this.fU,void 0,void 0,void 0,Wa)}deleteConditionalFormattingRules(Wa,Sa,yb){b.ULS.sendTraceTag(591925914,0,50,`ConditionalFormattingPaneManager.OnRuleDelete with type: ${Wa}, id: ${yb||"empty"}`);this.kBc();
const Ma=this.$.pa.va.Tb(),Bb=this.aKh(Wa,yb);let Nb;Nb=V.EwaSettings.$b()?Ia=>new gb.a(221,0,Ia,64,Bb):Ia=>new ia.a(221,0,Ia,void 0,Bb);xa.a(this.$.userOperationManager,(Ia,jb,Ob)=>t(this.$.pa.va,Wa,Sa,yb,Ha.b(Ia,this.aJi),Ha.a(jb,this.$Ii),Ob,Ma),Nb,null)}Bjh(Wa){let Sa=Wa.guid;Sa||b.ULS.sendTraceTag(536966946,0,10,"ConditionalFormattingPaneManager.duplicateConditionalFormattingRule with missing id!");const {appliedRange:yb}=this.d3e(Wa.range,Wa.ruleRangeSheetName,"duplicateConditionalFormattingRule");
if(yb){var Ma=this.$.pa.va.Tb(),Bb=this.$Gb(Wa,!0),Nb=()=>new ba(Bb,yb,Wa.dataBarFormat,Wa.colorScaleFormat,Wa.iconSetFormat);var Ia=V.EwaSettings.$b()?jb=>new gb.a(105,0,jb,64,Nb):jb=>new ia.a(105,0,jb,void 0,Nb);xa.a(this.$.userOperationManager,(jb,Ob,Jb)=>w(this.$.pa.va,Wa.ruleRangeSheetName,Sa,Ha.b(jb,this.yJi),Ha.a(Ob,this.xJi),Jb,Ma),Ia,null)}}aKh(Wa,Sa){let yb=-1,Ma=null;this.$.Cba&&V.EwaSettings.isChangeGateEnabled("OfficeVSO:4296101_MakerConditionalFormatDeleteByPriority")&&(Sa?1===this.fU?
{priority:yb,range:Ma}=this.QLh(Sa):(yb=this.SYe(this.sWf,Sa),Ma=this.EHd):Ma=59===Wa?y.r([],this.$):this.selectedRanges);return()=>new ua(Ma,yb)}d3e(Wa,Sa,yb){let Ma=null;if(({L6:Wa,sheetName:Ma}=y.ab(Wa,this.$.listSeparator,this.$.xa)).returnValue)if(y.V(Wa)){Sa=y.u(Ma||Sa,null,Wa);if(this.$.xa.contains(Sa.SheetName))return{appliedRange:Sa,L6:Wa};b.ULS.shipAssertTag(557682697,1,!1,`ConditionalFormattingPaneManager.${yb}: sheet wasn't found, might be renamed or deleted.`)}else b.ULS.shipAssertTag(557601052,
0,!1,`ConditionalFormattingPaneManager.${yb}: Range is invalid.`);else b.ULS.shipAssertTag(574410755,0,!1,`ConditionalFormattingPaneManager.${yb}: Failed to parse range when adding a new rule`)}SYe(Wa,Sa){for(let yb=0;yb<Wa.length;++yb)if(Wa[yb].ruleId===Sa)return Wa=yb;return 0}QLh(Wa){({F3b:Ma}=this.WX.getConditionalFormattingRules());var Sa=null;for(var yb of Ma)yb.ruleId===Wa&&(Sa=yb);Sa=y.X(Sa.ruleRange,this.$.listSeparator);var Ma=Array(Sa.length);for(yb=0;yb<Sa.length;++yb)Ma[yb]=y.j(Sa[yb]);
({F3b:Ma}=this.WX.getConditionalFormattingRules(Ma));Ma.sort(O);Wa=this.SYe(Ma,Wa);Sa=y.r(Sa,this.$);return{priority:Wa,range:Sa}}dispose(){Da.a.od(this.$)&&this.$.Gl(this.Ec);this.$=null;this.hideTaskPane();this.Zy&&(this.Zy.eO(this.y6e),this.Zy.Fcj(this.gCd),this.Zy.CKd(this.Sid),this.Zy.DKd(this.z6e),this.Zy=this.Nsa=null);this.q$=null;this.WX.dispose();this.WX=null}y_d(){1===this.yL&&this.fPb()}WXh(Wa){return 1==Wa.Ranges.length?(Wa=Wa.Ranges[0],Wa.FirstRow===Wa.LastRow?Wa.FirstColumn===Wa.LastColumn?
"Single Cell":"Row":Wa.FirstColumn===Wa.LastColumn?"Column":"Rectangle"):"Multi"}VXh(Wa){let Sa=null;for(const yb of Wa.Ranges){Wa=y.B(yb);const Ma=Object(hb.a)(this.$,Wa);Wa=null===Ma?"None":Ma.usedRange.contains(Wa)?"Containing":"Intersecting";Sa=null===Sa||Sa===Wa?Wa:"Intersecting"}return null===Sa?"None":Sa}P3e(Wa){return 100*Math.ceil(Wa/100)}rWf(Wa,Sa){const yb=this.WXh(Wa);Wa=this.VXh(Wa);Sa=this.P3e(y.b(Sa));const Ma=this.P3e(W.g(this.$).usedRange.bottom);return`rangeType ${yb} ; tableRelation: ${Wa} ; numOfCellsInRangeBucket: ${Sa} ; usedRangeRowsBucket: ${Ma}`}$Gb(Wa,
Sa){const yb=Wa.options;let Ma=null,Bb=yb.quickFormat?yb.quickFormat:0;6===Bb&&(Wa.customFormat?(Ma=this.wAh(Wa),Bb=6):(b.ULS.sendTraceTag(540615491,0,15,"ConditionalFormattingPaneManager.PrepareConditionalFormattingOptions: invalid custom format."),Bb=0));return Object(c.a)(new f,{Command:yb.command,QuickFormatType:Bb,CustomFormat:Ma,Formula1:yb.formula1&&Sa?Z.BJf(this.$,yb.formula1):yb.formula1,Formula2:yb.formula2&&Sa?Z.BJf(this.$,yb.formula2):yb.formula2,Value:yb.value||0,Unique:yb.unique||!1,
TimePeriodType:yb.timePeriod?yb.timePeriod:0,StopIfTrue:Wa.stopIfTrue||!1,Priority:Wa.priority||-1})}wAh(Wa){const Sa={};Sa.BackgroundColor=Wa.customFormat.backgroundColor;Sa.PreserveBackgroundColor=Wa.customFormat.preserveBackgroundColor||!1;Wa.customFormat.backgroundColorThemeInfo&&(Sa.BackgroundColorTheme={},Sa.BackgroundColorTheme.ThemeColorIndex=Wa.customFormat.backgroundColorThemeInfo.index,Sa.BackgroundColorTheme.ThemeColorRow=Wa.customFormat.backgroundColorThemeInfo.row);Sa.TextColor=Wa.customFormat.textColor;
Sa.PreserveTextColor=Wa.customFormat.preserveTextColor||!1;Wa.customFormat.textColorThemeInfo&&(Sa.TextColorTheme={},Sa.TextColorTheme.ThemeColorIndex=Wa.customFormat.textColorThemeInfo.index,Sa.TextColorTheme.ThemeColorRow=Wa.customFormat.textColorThemeInfo.row);Sa.IsTextBold=Wa.customFormat.isTextBold;Sa.IsTextItalic=Wa.customFormat.isTextItalic;Sa.IsTextStrikethrough=Wa.customFormat.isTextStrikethrough;Sa.IsTextUnderlined=Wa.customFormat.isTextUnderlined;Sa.IsTextDoubleUnderlined=Wa.customFormat.isTextDoubleUnderlined;
this.vAh(Wa,Sa);return Sa}vAh(Wa,Sa){Sa.BorderFormat={};if(Wa.customFormat.borderFormat){if(Sa.BorderFormat.Position=Wa.customFormat.borderFormat.position||15,Sa.BorderFormat.LineStyle=[Wa.customFormat.borderFormat.lineStyle[0],Wa.customFormat.borderFormat.lineStyle[1],Wa.customFormat.borderFormat.lineStyle[2],Wa.customFormat.borderFormat.lineStyle[3]],Sa.BorderFormat.Color=[B.a.pp(Wa.customFormat.borderFormat.color[0]).mS(),B.a.pp(Wa.customFormat.borderFormat.color[1]).mS(),B.a.pp(Wa.customFormat.borderFormat.color[2]).mS(),
B.a.pp(Wa.customFormat.borderFormat.color[3]).mS()],Sa.BorderFormat.Thickness=[0,0,0,0],Sa.BorderFormat.ThemeBorderColor=[null,null,null,null],Wa.customFormat.borderFormat.themeColor)for(let yb=0;yb<Wa.customFormat.borderFormat.themeColor.length;yb++)Wa.customFormat.borderFormat.themeColor[yb]&&(Sa.BorderFormat.ThemeBorderColor[yb]={},Sa.BorderFormat.ThemeBorderColor[yb].ThemeColorIndex=Wa.customFormat.borderFormat.themeColor[yb].index,Sa.BorderFormat.ThemeBorderColor[yb].ThemeColorRow=Wa.customFormat.borderFormat.themeColor[yb].row)}else Sa.BorderFormat.Position=
15,Sa.BorderFormat.LineStyle=[0,0,0,0],Sa.BorderFormat.Color=[0,0,0,0],Sa.BorderFormat.ThemeBorderColor=[null,null,null,null],Sa.BorderFormat.Thickness=[0,0,0,0]}kNi(){this.$ld&&(this.$ld.stop(),this.$ld=null)}USi(){this.tcb&&(this.tcb.stop(),this.tcb=null)}Sec(Wa){const Sa=Wa?2:1;Wa=this.VQh(Wa);this.Tfc?(this.q$.Dda(),2===Sa?this.q$.Fu(this.Nsa,2,this.fU,void 0,Wa):1!==this.yL&&this.q$.Fu(this.Nsa,1,this.fU)):(this.Tfc=!0,this.yL=Sa,this.q$.GI(this.Nsa,this.yL,this.fU,Wa))}hideTaskPane(){this.Dnd=
this.Tfc=!1;this.q$.cN()}VQh(Wa){if(!Wa)return null;const Sa=y.o(W.g(this.$).ha.sa.activeCell,this.$);return Object(c.a)(new Qb,{guid:null,addRuleType:Wa,activeCell:Object(c.a)(new Pb,{row:Sa.FirstRow,column:Sa.FirstColumn}),range:y.i(W.g(this.$).ha.sa.selectedRanges,this.$.listSeparator,this.$,!1,!1,!1),ruleRangeSheetName:Sa.SheetName})}taf(Wa,Sa){this.Y4d=Wa.r6g();Wa.U3e(!1,!1,!1,!1);this.TFc=Sa.NJh();this.aWj(this.TFc.getBorderLineStyleProps())}aWj(Wa){Ua.b(Wa,Sa=>"BorderStyleSolidLine"===Sa.key)&&
Ua.b(Wa,Sa=>"BorderStyleDashedLine"===Sa.key)&&Ua.b(Wa,Sa=>"BorderStyleDottedLine"===Sa.key)||b.ULS.sendTraceTag(540038171,0,10,"ConditionalFormattingPaneManager.VerifyCFBorderLineStyles: CF line styles are missing.")}kBc(){V.EwaSettings.isChangeGateEnabled("OfficeVSO:6122888_ConditionalFormattingSurvey")&&this.$.fd(2034864146,-1,0,null)}}Object(n.a)(vb,"ConditionalFormattingPaneManager",null,[]);var Va=a(24),db=a(77),oa=a(90);a.d(C,"ConditionalFormattingCommandHandler",function(){return Oa});class Oa{constructor(Wa){this.FEa=
null;this.Ra=new d.a;this.RDb=null;this.YIi=Sa=>{b.ULS.sendTraceTag(537167193,0,50,"ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback Clear CF rules from ribbon command");Sa&&A.a(Sa)&&(Sa=z.a.xc(Sa.Errors),b.ULS.sendTraceTag(589947023,0,15,`ConditionalFormattingCommandHandler.OnDeleteConditionalFormattingSuccessCallback: Clear CF rules request ended with errors: ${Sa}.`))};this.bxf=()=>{this.FEa&&this.FEa.TQi()};this.cxf=()=>{this.FEa&&this.FEa.UQi()};this.$=Wa;Oa.eXb=
!0}get C0g(){Oa.bHc||this.BRg();return Oa.bHc}get jHf(){this.FEa||(this.FEa=new vb(this.$));return this.FEa}Lc(){return!1}executeCommand(Wa,Sa,yb){Wa=ab.TaskExtensions.ak();if(-20558303===Sa.command)return Oa.eXb=!1,this.jHf.IFe(),Wa;let Ma=yb[db.a.Qc];2063445891===Sa.command&&(Ma=Oa.s6c,b.ULS.sendTraceTag(542782275,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromRibbon"),"HighlightWhen.2063445891"===yb[db.a.KDj]&&(this.RDb="HighlightWhen",Na.b("ConditionalFormatting_HighlightWhenButtonSelected")));
yb=this.PLh(Ma);switch(yb){case 12:case 13:case 8:case 9:case 10:case 11:case 1:case 2:case 4:case 5:case 3:case 7:case 6:Oa.eXb=!1;2063445891!==Sa.command&&b.ULS.sendTraceTag(573686991,0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleFromTaskPane");this.jHf.IFe(Ma);break;case 59:case 62:this.teh(yb);break;case 60:case 61:b.ULS.shipAssertTag(589947025,0,!1,"ConditionalFormattingCommandHandler.ExecuteCommand: Not expecting to execute command of type ConditionalFormattingCommand.DeleteCells or ConditionalFormattingCommand.DeleteRule from the Ribbon");
break;default:this.A6g(yb)}return Wa}dispose(){this.Ra.dispose()}Ac(Wa,Sa){Wa=!1;switch(Sa.command){case -20558303:Wa=this.$.isEditMode&&(V.EwaSettings.ma(375)||V.EwaSettings.ma(475));break;case 2063445891:case -300973317:case 97385776:Wa=this.$.isEditMode}return Wa}Oc(){return!1}iZe(){return y.r(W.g(this.$).ha.sa.selectedRanges,this.$)}z5f(){if(Oa.KAj){const Wa=new oa.a(-847286761,db.a.Gb,this.$.Kc,0,k.a.dW);this.$.Ka.Lb(Wa,{["InputMethod"]:db.a.Gb,CalloutName:1})}}A6g(Wa){b.ULS.sendTraceTag(573686989,
0,50,"ConditionalFormattingPaneManager.QuickAccessNewRuleNonCustom");this.bxf();const Sa=this.$.pa.va.Tb(),yb=y.o(W.g(this.$).ha.sa.activeCell,this.$),Ma=this.iZe(),Bb=Object(c.a)(new f,{Command:Wa,StopIfTrue:!1}),Nb=()=>new ba(Bb,Ma,null,null,null);"HighlightWhen"===this.RDb&&Na.b("ConditionalFormatting_HighlightWhen_RuleCreated");this.RDb=null;xa.a(this.$.userOperationManager,(Ia,jb,Ob)=>r(this.$.pa.va,Bb,Ma,yb,Ha.b(Ia,Jb=>{Z.lvf(this.$,Jb)}),Ha.a(jb,()=>{this.cxf()}),Ob,Sa),Ia=>new gb.a(105,0,
Ia,void 0,Nb),null);this.z5f()}teh(Wa){this.bxf();const Sa=this.$.pa.va.Tb();let yb,Ma;59===Wa?(Ma=y.r([],this.$),yb=y.q(new Va.Range(1,1,e.a.eh,e.a.ph,!1,!0),this.$)):Ma=yb=this.iZe();Object(c.a)(new f,{Command:62===Wa?60:Wa});const Bb=()=>new ua(Ma,-1);xa.a(this.$.userOperationManager,(Nb,Ia,jb)=>t(this.$.pa.va,Wa,yb,null,Ha.b(Nb,this.YIi),Ha.a(Ia,()=>{this.cxf()}),jb,Sa),Nb=>new gb.a(221,0,Nb,void 0,Bb),null);this.z5f()}PLh(Wa){return this.C0g[Wa]}BRg(){Oa.bHc={[Oa.s6c]:1,["HighlightCellsLT"]:2,
["HighlightCellsBetween"]:3,["HighlightCellsEQ"]:4,["HighlightCellsContains"]:5,["HighlightCellsDate"]:6,["HighlightCellsDupe"]:7,["TopBottomTop10"]:8,["TopBottomTop10P"]:9,["TopBottomBot10"]:10,["TopBottomBot10P"]:11,["TopBottomAA"]:12,["TopBottomBA"]:13,["DataBarsGradientFillBlue"]:15,["DataBarsGradientFillGreen"]:16,["DataBarsGradientFillRed"]:17,["DataBarsGradientFillOrange"]:18,["DataBarsGradientFillLightBlue"]:19,["DataBarsGradientFillPurple"]:20,["DataBarsSolidFillBlue"]:21,["DataBarsSolidFillGreen"]:22,
["DataBarsSolidFillRed"]:23,["DataBarsSolidFillOrange"]:24,["DataBarsSolidFillLightBlue"]:25,["DataBarsSolidFillPurple"]:26,["ColorScalesGYR"]:28,["ColorScalesRYG"]:27,["ColorScalesGWR"]:29,["ColorScalesRWG"]:30,["ColorScalesBWR"]:31,["ColorScalesRWB"]:32,["ColorScalesWR"]:35,["ColorScalesRW"]:36,["ColorScalesGW"]:38,["ColorScalesWG"]:37,["ColorScalesGY"]:33,["ColorScalesYG"]:34,["IconSetDirectional3Arrows"]:39,["IconSetDirectional3ArrowsGray"]:40,["IconSetDirectional3Triangles"]:57,["IconSetDirectional4ArrowsGray"]:48,
["IconSetDirectional4Arrows"]:47,["IconSetDirectional5ArrowsGray"]:53,["IconSetDirectional5Arrows"]:52,["IconSetShapes3TrafficLights1"]:42,["IconSetShapes3TrafficLights2"]:43,["IconSetShapes3Signs"]:44,["IconSetShapes4TrafficLights"]:51,["IconSetShapes4RedToBlack"]:49,["IconSetIndicators3Symbols"]:45,["IconSetIndicators3Symbols2"]:46,["IconSetIndicators3Flags"]:41,["IconSetRatings3Stars"]:56,["IconSetRatings4Rating"]:50,["IconSetRatings5Quarters"]:55,["IconSetRatings5Rating"]:54,["IconSetRatings5Boxes"]:58,
["ClearRulesClearCells"]:62,["ClearRulesClearSheet"]:59}}static get KAj(){return Oa.eXb}}Oa.bHc=null;Oa.eXb=!1;Oa.s6c="HighlightCellsGT";Object(n.a)(Oa,"ConditionalFormattingCommandHandler",null,[164,10])},937:function(n,C,a){n=a(0);class c{constructor(l){this.xtf=l;this.succeeded=!1;this.ffb=l?l.ffb:0;this.Pni=!1;this.length=this.bIj=0}}Object(n.a)(c,"TrieResult",null,[]);class b{constructor(l,m,u){this.gya=new c(null);this.Nxi=l;this.UCb=m;this.fpf=m+u-1}get result(){return this.gya}q1e(){let l;
return this.UCb<=this.fpf?(l=this.Nxi.charAt(this.UCb),++this.UCb,{returnValue:!0,ch:l}):{returnValue:!1,ch:"\x00"}}iJd(l,m,u){l&&(this.gya.Pni=!0,this.gya.bIj=m);this.gya.length=this.UCb;this.gya.succeeded=!0;this.gya.ffb=u;this.UCb!==this.fpf+1&&(this.gya=new c(this.gya))}}Object(n.a)(b,"LookUpStringVisitor",null,[674]);var d=a(1101);class f{constructor(){this.oye=this.wwe=this.ywe=this.vwe=this.xwe=this.EZc=this.DZc=this.GZc=this.CZc=0}}Object(n.a)(f,"TRIESTATS",null,[]);class e{constructor(){this.symbol=
this.eEb=0}}Object(n.a)(e,"TrieSymbol",null,[]);a.d(C,"a",function(){return k});class k{constructor(l,m){this.eI=null;this.Qkc=this.Dpf=this.Bpf=this.Fpf=this.xpf=this.Epf=this.Cpf=this.Gpf=this.ypf=0;this.ru=l;if(l.En(m,4)!==k.TGa)throw Error.argument("Input does not represent a trie");m+=4;this.jpf=1===l.En(m,4);m+=4;this.Exi=1===l.En(m,4);m+=4;this.Bxi=l.En(m,4);m+=4;if(l.En(m,4)){l=m+4;this.eI=this.a6i(l);this.ypf=m=l+k.ZTg;this.Gpf=m+=k.A1b*(this.eI.CZc+(this.eI.CZc%2?1:0));this.Cpf=m+=k.A1b*
(this.eI.GZc+(this.eI.GZc%2?1:0));this.Epf=m+=k.A1b*(this.eI.DZc+(this.eI.DZc%2?1:0));this.xpf=m+=k.A1b*(this.eI.EZc+(this.eI.EZc%2?1:0));this.Fpf=m+=k.IZc*this.eI.vwe;this.Bpf=m+=k.JZc*this.eI.ywe;this.Dpf=m+=k.JZc*this.eI.wwe;m+=k.JZc*this.eI.xwe;if(m!==l+this.eI.oye)throw Error.argument("Corrupted trie binary");this.Qkc=m}else this.eI=null}Fof(l,m,u,t){l=new b(l,m,u);this.Ghg(l,t);return l.result}X3e(l){if(this.jpf)if(l)--l;else return"";if(!this.eI)throw Error.argument("Invalid trieID");const m=
new d.a;m.Mr=0;this.eUa(m);const u=[];for(;;){if(m.Mr&k.cpa)if(l)--l;else return Array.add(u,m.QUa),String.fromCharCode.apply(null,u);const t=!!(m.Mr&k.rEc),w=this.d4a(m,!0);if(t||l<w){if(Array.add(u,m.QUa),!this.eUa(m))throw Error.argument("Invalid trieID");}else if(l-=w,!this.GOb(m))throw Error.argument("Invalid trieID");}}Ghg(l,m){let u=0;this.jpf&&(l.iJd(this.Exi,this.Bxi,0),++u);if(this.eI){var t=new d.a;t.Mr=0;if(this.eUa(t))for(;;){var w=void 0;if(!({ch:w}=l.q1e()).returnValue)break;m&&(w=
m(w));w=w.toString().charCodeAt(0);let r=!1;for(;!r;){const v=!!(t.Mr&k.cpa);if(t.QUa===w){if(r=!0,v&&l.iJd(!!(t.Mr&k.m2d),t.eAc,u),!this.eUa(t))return}else if(u+=this.d4a(t,!0),!this.GOb(t))return;v&&++u}}}}eUa(l){if(!l.Mr)return this.jYd(l),!0;if(!(l.Mr&k.qEc))return!1;l.fba=0;l.Pm=l.twa;this.jYd(l);return!0}GOb(l){if(l.Mr&k.rEc)return!1;this.jYd(l);return!0}d4a(l,m){return l.Mr&k.l2d?l.z1b:l.Mr&k.qEc?!m&&l.Mr&k.rEc?this.oMh(l):1:0}oMh(l){l=k.q1c(l);if(!this.eUa(l))return 0;let m=0;do l.Mr&k.cpa&&
++m,m+=this.d4a(l,!1);while(this.GOb(l));return m}jYd(l){l.Mr||(l.fba=0,l.Pm=this.Qkc);var m=this.e6b(this.ypf,l.Pm),u=m.symbol;l.Pm+=m.eEb;m=this.ru.En(this.xpf+k.IZc*u,k.IZc);l.QUa=m&65535;l.Mr=m>>16;l.Mr&k.l2d&&(l.z1b=this.kdh(l));l.Mr&k.m2d&&(m=this.e6b(this.Gpf,l.Pm),u=m.symbol,l.Pm+=m.eEb,l.eAc=this.ru.En(this.Fpf+4*u,4));l.Mr&k.olg?(l.twa=this.Qkc+((this.ru.na(l.Pm)<<8|this.ru.na(l.Pm+1))<<8|this.ru.na(l.Pm+2)),l.Pm+=3):l.Mr&k.plg?(l.twa=l.Pm,l.fba=l.twa):l.Mr&k.qlg?(m=this.e6b(this.Cpf,l.Pm),
u=m.symbol,l.Pm+=m.eEb,l.twa=this.Qkc+this.ru.En(this.Bpf+4*u,4)):l.Mr&k.qEc&&(m=this.e6b(this.Epf,l.Pm),u=m.symbol,l.Pm+=m.eEb,l.fba||(l.fba=l.Pm),l.fba+=this.ru.En(this.Dpf+4*u,4),l.twa=l.fba)}e6b(l,m){const u=new e;let t=0;for(;;){t+=this.ru.na(m);++m;++u.eEb;const w=this.ru.En(l,2);if(t<w)break;u.symbol+=w;t-=w;l+=2;t<<=8}u.symbol+=t;return u}kdh(l){let m=this.ru.na(l.Pm);192<=m?(m=(m&63)<<15|(this.ru.na(l.Pm+1)&127)<<8,m|=this.ru.na(l.Pm+2),l.Pm+=3):128<=m?(m=(m&127)<<8|this.ru.na(l.Pm+1),l.Pm+=
2):l.Pm+=1;return m}a6i(l){const m=new f;m.CZc=this.ru.En(l+12,2);m.GZc=this.ru.En(l+14,2);m.DZc=this.ru.En(l+16,2);m.EZc=this.ru.En(l+18,2);m.xwe=this.ru.En(l+24,4);m.vwe=this.ru.En(l+28,4);m.ywe=this.ru.En(l+32,4);m.wwe=this.ru.En(l+36,4);m.oye=this.ru.En(l+40,4);return m}static q1c(l){const m=new d.a;m.QUa=l.QUa;m.Mr=l.Mr;m.z1b=l.z1b;m.Pm=l.Pm;m.twa=l.twa;m.fba=l.fba;m.eAc=l.eAc;return m}}k.TGa=1654263084;k.ZTg=48;k.A1b=2;k.JZc=4;k.IZc=4;k.cpa=1;k.rEc=2;k.l2d=4;k.m2d=8;k.qEc=16;k.plg=64;k.qlg=
128;k.olg=256;Object(n.a)(k,"Trie",null,[679])},943:function(n,C,a){a.r(C);n=a(0);a(706);var c=a(729),b=a(702),d=a(4),f=a(107),e=a(25);class k{constructor(){this.PRc=0}C2i(v,y){this.PRc=window.performance.now();this.hQb(()=>{const x=window.performance.now(),B={};y.Ope&&(B.callback=z=>{v(z,OSF.StoreTypeEnum.MarketPlace,x)},d.AFrameworkApplication.vb.de(e.a.Uab,2,B));y.Ppe&&(B.callback=z=>{v(z,OSF.StoreTypeEnum.PrivateCatalog,x)},d.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",
!0)?B.storeType=10:B.storeType=OSF.StoreTypeEnum.PrivateCatalog,d.AFrameworkApplication.vb.de(e.a.Uab,2,B))},0,()=>{if(b.TellMeActor.instance.tc)b.TellMeActor.instance.tc.onError("AddinEntitlementsQuery:QueryEntitlementAsync","Query entitlements timeout after "+(window.performance.now()-this.PRc)+" ms")})}hQb(v,y=0,x=null){2!==d.AFrameworkApplication.vb.processAction(e.a.Uab,1)?(b.TellMeActor.instance.tc&&b.TellMeActor.instance.tc.GN(c.a.iJg,window.performance.now()-this.PRc),v()):20>y?d.AFrameworkApplication.Hi.Fg(new f.a(2,
1,500,()=>{this.hQb(v,y+1,x)})):x&&x()}static get instance(){k.Ma||(k.Ma=new k);return k.Ma}}k.Ma=null;Object(n.a)(k,"AddinEntitlementsQuery",null,[]);class l{constructor(){this.description=this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.Zsd=this.storeType=this.storeId=this.g2i=this.iconUrl=null}}Object(n.a)(l,"AddinInfo",null,[]);var m=a(709),u=a(711),t=a(710),w=a(701);a.d(C,"AddinResultsProvider",function(){return r});
class r{constructor(v){this.Wa=v;this.hLi=(y,x,B)=>{if(y){const z=y.errorCode;if(b.TellMeActor.instance.tc){const A={};A.StoreType=x;A.ErrorCode=z;A.AddinCount=y.value?y.value.length:0;b.TellMeActor.instance.tc.GN(c.a.kIh,window.performance.now()-B,A)}if(0===z&&y.value){r.iGa=r.iGa||{};y=y.value;for(const A of y)y=new l,y.displayName=A[0],y.id=A[1],y.description=A[2],y.targetType=A[3],y.appVersion=4<A.length?A[4]:"",y.assetId=5<A.length?A[5]:"",y.assetStoreId=6<A.length?A[6]:"",y.width=7<A.length?
A[7]:0,y.height=8<A.length?A[8]:0,y.iconUrl=9<A.length?A[9]:"",y.g2i=10<A.length?A[10]:"",y.storeId=11<A.length?A[11]:"",y.storeType=12<A.length?A[12]:"",this.Wa.fYf&&(y.Zsd=this.zRh(y)),r.iGa[y.id]=y,0<y.iconUrl.length&&appChrome.addInApi.registerAddinIcon("AddinIcon_"+y.id,y.iconUrl)}}};k.instance.C2i(this.hLi,this.Wa)}Xx(){return"Add-ins"}rF(){return 0===this.Wa.Rl?0:1===this.Wa.Rl?1:2}wv(v,y,x,B,z=null){x=new t.a(v);z&&!Array.contains(z,24)||w.a.mD(v)||(z=new u.a(24),z.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.cRh(v.Gd,z),x.Km(z));y.resultsUpdated(x)}cRh(v,y){if((v=this.slj(v))&&0<v.length){let x=0;v.forEach(B=>{if(!(3<++x)){var z="AddinSuggestion"+x,A={};A["default"]=0<B.iconUrl.length?"AddinIcon_"+B.id:"AppForOfficeLogo_20";var I=[];I.push(appChrome.actions.setControlLabel(z,B.displayName));I.push(appChrome.actions.setControlIconSet(z,A));I.push(appChrome.actions.setCompoundButtonCommandValueId(z,B.id));I.push(appChrome.actions.updateCompoundButtonDescription(z,B.description));appChrome.api.dispatch(I);
z=new m.a(z,25,void 0,void 0,1);z.s_b=Telemetry.PrivacyRules.GetPrivacyCompliantId(B.id,B.storeType,B.assetId,null,null,B.storeId);y.Qn(z)}})}}slj(v){if(!r.iGa)return null;const y=[],x=r.iGa;for(let z in x){var B=x[z];B&&(this.Wa.fYf?r.nzi(v,B)&&Array.add(y,B):0<=B.displayName.toLowerCase().indexOf(v.toLowerCase())?Array.add(y,B):this.Wa.Hmi&&0<=B.description.toLowerCase().indexOf(v.toLowerCase())&&Array.add(y,B))}return y}zRh(v){const y=r.T6f(v.displayName);this.Wa.jJg&&Array.addRange(y,r.T6f(v.description));
return y}static nzi(v,y){if(!y.Zsd)return!1;for(const x of v.split(" ")){v=!1;for(const B of y.Zsd)if(B.toLowerCase().startsWith(x.toLowerCase())){v=!0;break}if(!v)return!1}return!0}static T6f(v){const y=[];for(const x of v.split(" ")){v=0;for(let B=0;B<x.length;B++){const z=x.charAt(B);z.toString().toUpperCase()===z.toString()&&B>v&&(Array.add(y,x.substring(v,B)),v=B)}Array.add(y,x.substring(v,x.length));v&&Array.add(y,x.substring(0,x.length))}return y}}r.iGa=null;Object(n.a)(r,"AddinResultsProvider",
null,[478])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDSEsNext.kxta.js.map/031b6ad81e362a627f72cc984f93264c/EwaDSEsNext.kxta.js.map